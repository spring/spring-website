Binary files phpBB-3.0.10/adm/images/phpbb_logo.gif and phpbb/adm/images/phpbb_logo.gif differ
Binary files phpBB-3.0.10/adm/images/phpbb_logo.png and phpbb/adm/images/phpbb_logo.png differ
diff -ruN phpBB-3.0.10/adm/index.php phpbb/adm/index.php
--- phpBB-3.0.10/adm/index.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/adm/index.php	2013-09-28 03:20:51.000000000 +0200
@@ -199,6 +199,7 @@
 		'DEBUG_OUTPUT'		=> (defined('DEBUG')) ? $debug_output : '',
 		'TRANSLATION_INFO'	=> (!empty($user->lang['TRANSLATION_INFO'])) ? $user->lang['TRANSLATION_INFO'] : '',
 		'S_COPYRIGHT_HTML'	=> $copyright_html,
+		'CREDIT_LINE'		=> $user->lang('POWERED_BY', '<a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Group'),
 		'VERSION'			=> $config['version'])
 	);
 
@@ -448,6 +449,13 @@
 				}
 			break;
 
+			case 'email':
+				if (!preg_match('/^' . get_preg_expression('email') . '$/i', $cfg_array[$config_name]))
+				{
+					$error[] = $user->lang['EMAIL_INVALID_EMAIL'];
+				}
+			break;
+
 			// Absolute path
 			case 'script_path':
 				if (!$cfg_array[$config_name])
diff -ruN phpBB-3.0.10/adm/style/acp_profile.html phpbb/adm/style/acp_profile.html
--- phpBB-3.0.10/adm/style/acp_profile.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/adm/style/acp_profile.html	2013-09-28 03:20:51.000000000 +0200
@@ -64,6 +64,10 @@
 			<dd><input type="checkbox" class="radio" id="field_required" name="field_required" value="1"<!-- IF S_FIELD_REQUIRED --> checked="checked"<!-- ENDIF --> /></dd>
 		</dl>
 		<dl>
+			<dt><label for="field_show_novalue">{L_SHOW_NOVALUE_FIELD}:</label><br /><span>{L_SHOW_NOVALUE_FIELD_EXPLAIN}</span></dt>
+			<dd><input type="checkbox" class="radio" id="field_show_novalue" name="field_show_novalue" value="1"<!-- IF S_FIELD_SHOW_NOVALUE --> checked="checked"<!-- ENDIF --> /></dd>
+		</dl>
+		<dl>
 			<dt><label for="field_hide">{L_HIDE_PROFILE_FIELD}:</label><br /><span>{L_HIDE_PROFILE_FIELD_EXPLAIN}</span></dt>
 			<dd><input type="checkbox" class="radio" id="field_hide" name="field_hide" value="1"<!-- IF S_FIELD_HIDE --> checked="checked"<!-- ENDIF --> /></dd>
 		</dl>
diff -ruN phpBB-3.0.10/adm/style/acp_styles.html phpbb/adm/style/acp_styles.html
--- phpBB-3.0.10/adm/style/acp_styles.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/adm/style/acp_styles.html	2013-09-28 03:20:51.000000000 +0200
@@ -402,6 +402,12 @@
 		<td class="row3" colspan="{$COLSPAN}"><strong>{L_INSTALLED}</strong></td>
 	</tr>
 	<!-- BEGIN installed -->
+	<!-- IF installed.S_INACTIVE and not $INACTIVE_STYLES -->
+		<!-- DEFINE $INACTIVE_STYLES = 1 -->
+		<tr>
+			<td class="row3" colspan="{$COLSPAN}"><strong>{L_INACTIVE_STYLES}</strong></td>
+		</tr>
+	<!-- ENDIF -->
 	<tr>
 		<td><strong>{installed.NAME}</strong><!-- IF installed.S_DEFAULT_STYLE --> *<!-- ENDIF --></td>
 		<!-- IF S_STYLE -->
diff -ruN phpBB-3.0.10/adm/style/acp_users_overview.html phpbb/adm/style/acp_users_overview.html
--- phpBB-3.0.10/adm/style/acp_users_overview.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/adm/style/acp_users_overview.html	2013-09-28 03:20:51.000000000 +0200
@@ -135,19 +135,25 @@
 	</form>
 
 	<!-- IF not S_OWN_ACCOUNT -->
-	<form id="user_delete" method="post" action="{U_ACTION}">
-	<fieldset>
-		<legend>{L_DELETE_USER}</legend>
-		<dl>
-			<dt><label for="delete_type">{L_DELETE_USER}:</label><br /><span>{L_DELETE_USER_EXPLAIN}</span></dt>
-			<dd><select id="delete_type" name="delete_type"><option class="sep" value="">{L_SELECT_OPTION}</option><option value="retain">{L_RETAIN_POSTS}</option><option value="remove">{L_DELETE_POSTS}</option></select></dd>
-		</dl>
-		<p class="quick">
-			<input class="button1" type="submit" name="update" value="{L_SUBMIT}" />
-			<input type="hidden" name="delete" value="1" />
-			{S_FORM_TOKEN}
-		</p>
-	</fieldset>
-	</form>
+		<form id="user_delete" method="post" action="{U_ACTION}">
+			<fieldset>
+				<legend>{L_DELETE_USER}</legend>
+				<dl>
+					<dt><label for="delete_type">{L_DELETE_USER}:</label><br /><span>{L_DELETE_USER_EXPLAIN}</span></dt>
+					<dd>
+					<!-- IF USER_HAS_POSTS -->
+						<select id="delete_type" name="delete_type"><option class="sep" value="">{L_SELECT_OPTION}</option><option value="retain">{L_RETAIN_POSTS}</option><option value="remove">{L_DELETE_POSTS}</option></select>
+					<!-- ELSE -->
+						{L_USER_NO_POSTS_TO_DELETE}<input type="hidden" id="delete_type" name="delete_type" value="retain" />
+					<!-- ENDIF -->
+					</dd>
+				</dl>
+				<p class="quick">
+					<input class="button1" type="submit" name="update" value="{L_SUBMIT}" />
+					<input type="hidden" name="delete" value="1" />
+					{S_FORM_TOKEN}
+				</p>
+			</fieldset>
+		</form>
 	<!-- ENDIF -->
 <!-- ENDIF -->
diff -ruN phpBB-3.0.10/adm/style/admin.css phpbb/adm/style/admin.css
--- phpBB-3.0.10/adm/style/admin.css	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/adm/style/admin.css	2013-09-28 03:20:51.000000000 +0200
@@ -142,15 +142,15 @@
 #page-header {
 	clear: both;
 	text-align: right;
-	background: url("../images/phpbb_logo.gif") top left no-repeat;
-	height: 49px;
+	background: url("../images/phpbb_logo.png") top left no-repeat;
+	height: 54px;
 	font-size: 0.85em;
 	margin-bottom: 10px;
 }
 
 .rtl #page-header {
 	text-align: left;
-	background: url("../images/phpbb_logo.gif") top right no-repeat;
+	background: url("../images/phpbb_logo.png") top right no-repeat;
 }
 
 #page-header h1 {
diff -ruN phpBB-3.0.10/adm/style/install_footer.html phpbb/adm/style/install_footer.html
--- phpBB-3.0.10/adm/style/install_footer.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/adm/style/install_footer.html	2013-09-28 03:20:51.000000000 +0200
@@ -8,7 +8,7 @@
 	</div>
 
 	<div id="page-footer">
-		Powered by <a href="http://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Group
+		Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Group
 	</div>
 </div>
 
diff -ruN phpBB-3.0.10/adm/style/install_update_diff.html phpbb/adm/style/install_update_diff.html
--- phpBB-3.0.10/adm/style/install_update_diff.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/adm/style/install_update_diff.html	2013-09-28 03:20:51.000000000 +0200
@@ -15,12 +15,12 @@
 // <![CDATA[
 function resize_panel()
 {
-	var block = document.getElementById('codepanel');
+	var block = document.getElementById('diff_content');
 	var height;
 
 	if (window.innerHeight)
 	{
-		height = window.innerHeight - 150;
+		height = window.innerHeight - 200;
 		block.style.height = height + 'px';
 	}
 	else
@@ -119,6 +119,7 @@
 	overflow: hidden;
 	border-bottom: 1px solid #999;
 	table-layout: fixed;
+	background: transparent;
 }
 
 table.hrdiff th {
@@ -128,7 +129,8 @@
 	font-family: Verdana,Helvetica,sans-serif;
 	font-size: 11px;
 	border-bottom: 1px solid #999;
-	background: transparent;
+	border-right: 1px solid #999;
+	background: #D9D9D9;
 }
 
 table.hrdiff thead th {
@@ -142,29 +144,23 @@
 }
 
 table.hrdiff tbody th {
-	padding: 2em 1px 1px 1px;
 	font-size: 80%;
 	border-top: 1px solid #999;
 }
 
-table.hrdiff tbody td.old {
-	border-left: 1px solid #999;
-	border-right: 1px solid #999;
-}
-table.hrdiff tbody td.new {
+table.hrdiff tbody td {
 	border-right: 1px solid #999;
 }
 
 table.hrdiff td pre {
-	overflow: auto;
-	display: block;
-	width: 100%;
-	overflow: auto;
-	display: block;
+	font-family: "Consolas", monospace;
+	font-size: 1.1em;
+	white-space: pre-wrap;		/* css-3 */
+	word-wrap: break-word;		/* Internet Explorer 5.5+ */
 }
 
 table.hrdiff .unmodified {
-	background: #fff;
+	background: transparent;
 }
 
 table.hrdiff .added {
diff -ruN phpBB-3.0.10/adm/style/install_update.html phpbb/adm/style/install_update.html
--- phpBB-3.0.10/adm/style/install_update.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/adm/style/install_update.html	2013-09-28 03:20:51.000000000 +0200
@@ -43,6 +43,11 @@
 		<p>{WARNING_MSG}</p>
 	</div>
 	<!-- ENDIF -->
+	
+	<div class="errorbox" style="margin-top: 0;">
+		<h3>{L_NOTICE}</h3>
+		<p>{L_BACKUP_NOTICE}</p>
+	</div>
 
 	<form id="install_update" method="post" action="{U_ACTION}">
 
diff -ruN phpBB-3.0.10/adm/style/overall_footer.html phpbb/adm/style/overall_footer.html
--- phpBB-3.0.10/adm/style/overall_footer.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/adm/style/overall_footer.html	2013-09-28 03:20:51.000000000 +0200
@@ -9,7 +9,7 @@
 
 	<div id="page-footer">
 		<!-- IF S_COPYRIGHT_HTML -->
-			Powered by <a href="http://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Group
+			{CREDIT_LINE}
 			<!-- IF TRANSLATION_INFO --><br />{TRANSLATION_INFO}<!-- ENDIF -->
 		<!-- ENDIF -->
 
diff -ruN phpBB-3.0.10/adm/style/simple_footer.html phpbb/adm/style/simple_footer.html
--- phpBB-3.0.10/adm/style/simple_footer.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/adm/style/simple_footer.html	2013-09-28 03:20:51.000000000 +0200
@@ -5,7 +5,7 @@
 <div id="page-footer">
 
 	<!-- IF S_COPYRIGHT_HTML -->
-		<br />Powered by <a href="http://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Group
+		<br />{CREDIT_LINE}
 		<!-- IF TRANSLATION_INFO --><br />{TRANSLATION_INFO}<!-- ENDIF -->
 	<!-- ENDIF -->
 
diff -ruN phpBB-3.0.10/cache/data_acl_options.php phpbb/cache/data_acl_options.php
--- phpBB-3.0.10/cache/data_acl_options.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/cache/data_acl_options.php	2014-04-15 15:00:22.757414281 +0200
@@ -0,0 +1,4 @@
+<?php exit; ?>
+1429102822
+7648
+a:4:{s:5:"local";a:41:{s:2:"f_";i:0;s:10:"f_announce";i:1;s:8:"f_attach";i:2;s:8:"f_bbcode";i:3;s:6:"f_bump";i:4;s:8:"f_delete";i:5;s:10:"f_download";i:6;s:6:"f_edit";i:7;s:7:"f_email";i:8;s:7:"f_flash";i:9;s:7:"f_icons";i:10;s:13:"f_ignoreflood";i:11;s:5:"f_img";i:12;s:6:"f_list";i:13;s:11:"f_noapprove";i:14;s:6:"f_poll";i:15;s:6:"f_post";i:16;s:11:"f_postcount";i:17;s:7:"f_print";i:18;s:6:"f_read";i:19;s:7:"f_reply";i:20;s:8:"f_report";i:21;s:8:"f_search";i:22;s:6:"f_sigs";i:23;s:9:"f_smilies";i:24;s:8:"f_sticky";i:25;s:11:"f_subscribe";i:26;s:11:"f_user_lock";i:27;s:6:"f_vote";i:28;s:9:"f_votechg";i:29;s:2:"m_";i:30;s:9:"m_approve";i:31;s:11:"m_chgposter";i:32;s:8:"m_delete";i:33;s:6:"m_edit";i:34;s:6:"m_info";i:35;s:6:"m_lock";i:36;s:7:"m_merge";i:37;s:6:"m_move";i:38;s:8:"m_report";i:39;s:7:"m_split";i:40;}s:2:"id";a:118:{s:2:"f_";i:1;s:10:"f_announce";i:2;s:8:"f_attach";i:3;s:8:"f_bbcode";i:4;s:6:"f_bump";i:5;s:8:"f_delete";i:6;s:10:"f_download";i:7;s:6:"f_edit";i:8;s:7:"f_email";i:9;s:7:"f_flash";i:10;s:7:"f_icons";i:11;s:13:"f_ignoreflood";i:12;s:5:"f_img";i:13;s:6:"f_list";i:14;s:11:"f_noapprove";i:15;s:6:"f_poll";i:16;s:6:"f_post";i:17;s:11:"f_postcount";i:18;s:7:"f_print";i:19;s:6:"f_read";i:20;s:7:"f_reply";i:21;s:8:"f_report";i:22;s:8:"f_search";i:23;s:6:"f_sigs";i:24;s:9:"f_smilies";i:25;s:8:"f_sticky";i:26;s:11:"f_subscribe";i:27;s:11:"f_user_lock";i:28;s:6:"f_vote";i:29;s:9:"f_votechg";i:30;s:2:"m_";i:31;s:9:"m_approve";i:32;s:11:"m_chgposter";i:33;s:8:"m_delete";i:34;s:6:"m_edit";i:35;s:6:"m_info";i:36;s:6:"m_lock";i:37;s:7:"m_merge";i:38;s:6:"m_move";i:39;s:8:"m_report";i:40;s:7:"m_split";i:41;s:5:"m_ban";i:42;s:6:"m_warn";i:43;s:2:"a_";i:44;s:7:"a_aauth";i:45;s:8:"a_attach";i:46;s:12:"a_authgroups";i:47;s:11:"a_authusers";i:48;s:8:"a_backup";i:49;s:5:"a_ban";i:50;s:8:"a_bbcode";i:51;s:7:"a_board";i:52;s:6:"a_bots";i:53;s:11:"a_clearlogs";i:54;s:7:"a_email";i:55;s:7:"a_fauth";i:56;s:7:"a_forum";i:57;s:10:"a_forumadd";i:58;s:10:"a_forumdel";i:59;s:7:"a_group";i:60;s:10:"a_groupadd";i:61;s:10:"a_groupdel";i:62;s:7:"a_icons";i:63;s:8:"a_jabber";i:64;s:10:"a_language";i:65;s:7:"a_mauth";i:66;s:9:"a_modules";i:67;s:7:"a_names";i:68;s:9:"a_phpinfo";i:69;s:9:"a_profile";i:70;s:7:"a_prune";i:71;s:7:"a_ranks";i:72;s:9:"a_reasons";i:73;s:7:"a_roles";i:74;s:8:"a_search";i:75;s:8:"a_server";i:76;s:8:"a_styles";i:77;s:12:"a_switchperm";i:78;s:7:"a_uauth";i:79;s:6:"a_user";i:80;s:9:"a_userdel";i:81;s:10:"a_viewauth";i:82;s:10:"a_viewlogs";i:83;s:7:"a_words";i:84;s:2:"u_";i:85;s:8:"u_attach";i:86;s:11:"u_chgavatar";i:87;s:12:"u_chgcensors";i:88;s:10:"u_chgemail";i:89;s:8:"u_chggrp";i:90;s:9:"u_chgname";i:91;s:11:"u_chgpasswd";i:92;s:10:"u_download";i:93;s:12:"u_hideonline";i:94;s:13:"u_ignoreflood";i:95;s:8:"u_masspm";i:96;s:11:"u_pm_attach";i:97;s:11:"u_pm_bbcode";i:98;s:11:"u_pm_delete";i:99;s:13:"u_pm_download";i:100;s:9:"u_pm_edit";i:101;s:12:"u_pm_emailpm";i:102;s:10:"u_pm_flash";i:103;s:12:"u_pm_forward";i:104;s:8:"u_pm_img";i:105;s:12:"u_pm_printpm";i:106;s:12:"u_pm_smilies";i:107;s:8:"u_readpm";i:108;s:12:"u_savedrafts";i:109;s:8:"u_search";i:110;s:11:"u_sendemail";i:111;s:8:"u_sendim";i:112;s:8:"u_sendpm";i:113;s:5:"u_sig";i:114;s:12:"u_viewonline";i:115;s:13:"u_viewprofile";i:116;s:14:"u_masspm_group";i:117;s:8:"u_viewfs";i:118;}s:6:"option";a:118:{i:1;s:2:"f_";i:2;s:10:"f_announce";i:3;s:8:"f_attach";i:4;s:8:"f_bbcode";i:5;s:6:"f_bump";i:6;s:8:"f_delete";i:7;s:10:"f_download";i:8;s:6:"f_edit";i:9;s:7:"f_email";i:10;s:7:"f_flash";i:11;s:7:"f_icons";i:12;s:13:"f_ignoreflood";i:13;s:5:"f_img";i:14;s:6:"f_list";i:15;s:11:"f_noapprove";i:16;s:6:"f_poll";i:17;s:6:"f_post";i:18;s:11:"f_postcount";i:19;s:7:"f_print";i:20;s:6:"f_read";i:21;s:7:"f_reply";i:22;s:8:"f_report";i:23;s:8:"f_search";i:24;s:6:"f_sigs";i:25;s:9:"f_smilies";i:26;s:8:"f_sticky";i:27;s:11:"f_subscribe";i:28;s:11:"f_user_lock";i:29;s:6:"f_vote";i:30;s:9:"f_votechg";i:31;s:2:"m_";i:32;s:9:"m_approve";i:33;s:11:"m_chgposter";i:34;s:8:"m_delete";i:35;s:6:"m_edit";i:36;s:6:"m_info";i:37;s:6:"m_lock";i:38;s:7:"m_merge";i:39;s:6:"m_move";i:40;s:8:"m_report";i:41;s:7:"m_split";i:42;s:5:"m_ban";i:43;s:6:"m_warn";i:44;s:2:"a_";i:45;s:7:"a_aauth";i:46;s:8:"a_attach";i:47;s:12:"a_authgroups";i:48;s:11:"a_authusers";i:49;s:8:"a_backup";i:50;s:5:"a_ban";i:51;s:8:"a_bbcode";i:52;s:7:"a_board";i:53;s:6:"a_bots";i:54;s:11:"a_clearlogs";i:55;s:7:"a_email";i:56;s:7:"a_fauth";i:57;s:7:"a_forum";i:58;s:10:"a_forumadd";i:59;s:10:"a_forumdel";i:60;s:7:"a_group";i:61;s:10:"a_groupadd";i:62;s:10:"a_groupdel";i:63;s:7:"a_icons";i:64;s:8:"a_jabber";i:65;s:10:"a_language";i:66;s:7:"a_mauth";i:67;s:9:"a_modules";i:68;s:7:"a_names";i:69;s:9:"a_phpinfo";i:70;s:9:"a_profile";i:71;s:7:"a_prune";i:72;s:7:"a_ranks";i:73;s:9:"a_reasons";i:74;s:7:"a_roles";i:75;s:8:"a_search";i:76;s:8:"a_server";i:77;s:8:"a_styles";i:78;s:12:"a_switchperm";i:79;s:7:"a_uauth";i:80;s:6:"a_user";i:81;s:9:"a_userdel";i:82;s:10:"a_viewauth";i:83;s:10:"a_viewlogs";i:84;s:7:"a_words";i:85;s:2:"u_";i:86;s:8:"u_attach";i:87;s:11:"u_chgavatar";i:88;s:12:"u_chgcensors";i:89;s:10:"u_chgemail";i:90;s:8:"u_chggrp";i:91;s:9:"u_chgname";i:92;s:11:"u_chgpasswd";i:93;s:10:"u_download";i:94;s:12:"u_hideonline";i:95;s:13:"u_ignoreflood";i:96;s:8:"u_masspm";i:97;s:11:"u_pm_attach";i:98;s:11:"u_pm_bbcode";i:99;s:11:"u_pm_delete";i:100;s:13:"u_pm_download";i:101;s:9:"u_pm_edit";i:102;s:12:"u_pm_emailpm";i:103;s:10:"u_pm_flash";i:104;s:12:"u_pm_forward";i:105;s:8:"u_pm_img";i:106;s:12:"u_pm_printpm";i:107;s:12:"u_pm_smilies";i:108;s:8:"u_readpm";i:109;s:12:"u_savedrafts";i:110;s:8:"u_search";i:111;s:11:"u_sendemail";i:112;s:8:"u_sendim";i:113;s:8:"u_sendpm";i:114;s:5:"u_sig";i:115;s:12:"u_viewonline";i:116;s:13:"u_viewprofile";i:117;s:14:"u_masspm_group";i:118;s:8:"u_viewfs";}s:6:"global";a:88:{s:2:"m_";i:0;s:9:"m_approve";i:1;s:11:"m_chgposter";i:2;s:8:"m_delete";i:3;s:6:"m_edit";i:4;s:6:"m_info";i:5;s:6:"m_lock";i:6;s:7:"m_merge";i:7;s:6:"m_move";i:8;s:8:"m_report";i:9;s:7:"m_split";i:10;s:5:"m_ban";i:11;s:6:"m_warn";i:12;s:2:"a_";i:13;s:7:"a_aauth";i:14;s:8:"a_attach";i:15;s:12:"a_authgroups";i:16;s:11:"a_authusers";i:17;s:8:"a_backup";i:18;s:5:"a_ban";i:19;s:8:"a_bbcode";i:20;s:7:"a_board";i:21;s:6:"a_bots";i:22;s:11:"a_clearlogs";i:23;s:7:"a_email";i:24;s:7:"a_fauth";i:25;s:7:"a_forum";i:26;s:10:"a_forumadd";i:27;s:10:"a_forumdel";i:28;s:7:"a_group";i:29;s:10:"a_groupadd";i:30;s:10:"a_groupdel";i:31;s:7:"a_icons";i:32;s:8:"a_jabber";i:33;s:10:"a_language";i:34;s:7:"a_mauth";i:35;s:9:"a_modules";i:36;s:7:"a_names";i:37;s:9:"a_phpinfo";i:38;s:9:"a_profile";i:39;s:7:"a_prune";i:40;s:7:"a_ranks";i:41;s:9:"a_reasons";i:42;s:7:"a_roles";i:43;s:8:"a_search";i:44;s:8:"a_server";i:45;s:8:"a_styles";i:46;s:12:"a_switchperm";i:47;s:7:"a_uauth";i:48;s:6:"a_user";i:49;s:9:"a_userdel";i:50;s:10:"a_viewauth";i:51;s:10:"a_viewlogs";i:52;s:7:"a_words";i:53;s:2:"u_";i:54;s:8:"u_attach";i:55;s:11:"u_chgavatar";i:56;s:12:"u_chgcensors";i:57;s:10:"u_chgemail";i:58;s:8:"u_chggrp";i:59;s:9:"u_chgname";i:60;s:11:"u_chgpasswd";i:61;s:10:"u_download";i:62;s:12:"u_hideonline";i:63;s:13:"u_ignoreflood";i:64;s:8:"u_masspm";i:65;s:11:"u_pm_attach";i:66;s:11:"u_pm_bbcode";i:67;s:11:"u_pm_delete";i:68;s:13:"u_pm_download";i:69;s:9:"u_pm_edit";i:70;s:12:"u_pm_emailpm";i:71;s:10:"u_pm_flash";i:72;s:12:"u_pm_forward";i:73;s:8:"u_pm_img";i:74;s:12:"u_pm_printpm";i:75;s:12:"u_pm_smilies";i:76;s:8:"u_readpm";i:77;s:12:"u_savedrafts";i:78;s:8:"u_search";i:79;s:11:"u_sendemail";i:80;s:8:"u_sendim";i:81;s:8:"u_sendpm";i:82;s:5:"u_sig";i:83;s:12:"u_viewonline";i:84;s:13:"u_viewprofile";i:85;s:14:"u_masspm_group";i:86;s:8:"u_viewfs";i:87;}}
\ No newline at end of file
diff -ruN phpBB-3.0.10/cache/data_bots.php phpbb/cache/data_bots.php
--- phpBB-3.0.10/cache/data_bots.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/cache/data_bots.php	2014-04-15 15:00:22.737414281 +0200
@@ -0,0 +1,4 @@
+<?php exit; ?>
+1429102822
+93
+a:1:{i:0;a:3:{s:7:"user_id";s:5:"10794";s:9:"bot_agent";s:8:"bingbot/";s:6:"bot_ip";s:0:"";}}
\ No newline at end of file
diff -ruN phpBB-3.0.10/cache/data_cfg_imageset_spring.php phpbb/cache/data_cfg_imageset_spring.php
--- phpBB-3.0.10/cache/data_cfg_imageset_spring.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/cache/data_cfg_imageset_spring.php	2014-04-15 15:00:22.830414280 +0200
@@ -0,0 +1,4 @@
+<?php exit; ?>
+1429102822
+3993
+a:67:{s:4:"name";s:16:"subsilver2spring";s:9:"copyright";s:24:"&copy; phpBB Group, 2003";s:7:"version";s:6:"3.0.10";s:13:"img_site_logo";s:20:"site_logo.gif*94*170";s:14:"img_upload_bar";s:21:"upload_bar.gif*16*280";s:13:"img_poll_left";s:18:"poll_left.gif*12*4";s:15:"img_poll_center";s:20:"poll_center.gif*12*1";s:14:"img_poll_right";s:19:"poll_right.gif*12*4";s:15:"img_icon_friend";s:0:"";s:12:"img_icon_foe";s:0:"";s:14:"img_forum_link";s:20:"forum_link.gif*25*46";s:14:"img_forum_read";s:20:"forum_read.gif*25*46";s:21:"img_forum_read_locked";s:27:"forum_read_locked.gif*25*46";s:23:"img_forum_read_subforum";s:29:"forum_read_subforum.gif*25*46";s:16:"img_forum_unread";s:22:"forum_unread.gif*25*46";s:23:"img_forum_unread_locked";s:29:"forum_unread_locked.gif*25*46";s:25:"img_forum_unread_subforum";s:31:"forum_unread_subforum.gif*25*46";s:15:"img_topic_moved";s:21:"topic_moved.gif*18*19";s:14:"img_topic_read";s:20:"topic_read.gif*18*19";s:19:"img_topic_read_mine";s:25:"topic_read_mine.gif*18*19";s:18:"img_topic_read_hot";s:24:"topic_read_hot.gif*18*19";s:23:"img_topic_read_hot_mine";s:29:"topic_read_hot_mine.gif*18*19";s:21:"img_topic_read_locked";s:27:"topic_read_locked.gif*18*19";s:26:"img_topic_read_locked_mine";s:32:"topic_read_locked_mine.gif*18*19";s:16:"img_topic_unread";s:22:"topic_unread.gif*18*19";s:21:"img_topic_unread_mine";s:27:"topic_unread_mine.gif*18*19";s:20:"img_topic_unread_hot";s:26:"topic_unread_hot.gif*18*19";s:25:"img_topic_unread_hot_mine";s:31:"topic_unread_hot_mine.gif*18*19";s:23:"img_topic_unread_locked";s:29:"topic_unread_locked.gif*18*19";s:28:"img_topic_unread_locked_mine";s:34:"topic_unread_locked_mine.gif*18*19";s:15:"img_sticky_read";s:21:"sticky_read.gif*18*19";s:20:"img_sticky_read_mine";s:26:"sticky_read_mine.gif*18*19";s:22:"img_sticky_read_locked";s:28:"sticky_read_locked.gif*18*19";s:27:"img_sticky_read_locked_mine";s:33:"sticky_read_locked_mine.gif*18*19";s:17:"img_sticky_unread";s:23:"sticky_unread.gif*18*19";s:22:"img_sticky_unread_mine";s:28:"sticky_unread_mine.gif*18*19";s:24:"img_sticky_unread_locked";s:30:"sticky_unread_locked.gif*18*19";s:29:"img_sticky_unread_locked_mine";s:35:"sticky_unread_locked_mine.gif*18*19";s:17:"img_announce_read";s:23:"announce_read.gif*18*19";s:22:"img_announce_read_mine";s:28:"announce_read_mine.gif*18*19";s:24:"img_announce_read_locked";s:30:"announce_read_locked.gif*18*19";s:29:"img_announce_read_locked_mine";s:35:"announce_read_locked_mine.gif*18*19";s:19:"img_announce_unread";s:25:"announce_unread.gif*18*19";s:24:"img_announce_unread_mine";s:30:"announce_unread_mine.gif*18*19";s:26:"img_announce_unread_locked";s:32:"announce_unread_locked.gif*18*19";s:31:"img_announce_unread_locked_mine";s:37:"announce_unread_locked_mine.gif*18*19";s:15:"img_global_read";s:23:"announce_read.gif*18*19";s:20:"img_global_read_mine";s:28:"announce_read_mine.gif*18*19";s:22:"img_global_read_locked";s:30:"announce_read_locked.gif*18*19";s:27:"img_global_read_locked_mine";s:35:"announce_read_locked_mine.gif*18*19";s:17:"img_global_unread";s:25:"announce_unread.gif*18*19";s:22:"img_global_unread_mine";s:30:"announce_unread_mine.gif*18*19";s:24:"img_global_unread_locked";s:32:"announce_unread_locked.gif*18*19";s:29:"img_global_unread_locked_mine";s:37:"announce_unread_locked_mine.gif*18*19";s:17:"img_subforum_read";s:0:"";s:19:"img_subforum_unread";s:0:"";s:11:"img_pm_read";s:20:"topic_read.gif*18*19";s:13:"img_pm_unread";s:22:"topic_unread.gif*18*19";s:17:"img_icon_back_top";s:0:"";s:20:"img_icon_post_target";s:25:"icon_post_target.gif*9*12";s:27:"img_icon_post_target_unread";s:32:"icon_post_target_unread.gif*9*12";s:21:"img_icon_topic_attach";s:27:"icon_topic_attach.gif*18*14";s:21:"img_icon_topic_latest";s:26:"icon_topic_latest.gif*9*18";s:21:"img_icon_topic_newest";s:26:"icon_topic_newest.gif*9*18";s:23:"img_icon_topic_reported";s:29:"icon_topic_reported.gif*18*19";s:25:"img_icon_topic_unapproved";s:31:"icon_topic_unapproved.gif*18*19";s:8:"filetime";i:1397565078;}
\ No newline at end of file
diff -ruN phpBB-3.0.10/cache/data_cfg_template_spring.php phpbb/cache/data_cfg_template_spring.php
--- phpBB-3.0.10/cache/data_cfg_template_spring.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/cache/data_cfg_template_spring.php	2014-04-15 15:00:22.826414281 +0200
@@ -0,0 +1,4 @@
+<?php exit; ?>
+1429102822
+144
+a:4:{s:4:"name";s:16:"subsilver2spring";s:9:"copyright";s:24:"&copy; phpBB Group, 2003";s:7:"version";s:6:"3.0.10";s:8:"filetime";i:1397565078;}
\ No newline at end of file
diff -ruN phpBB-3.0.10/cache/data_cfg_theme_spring.php phpbb/cache/data_cfg_theme_spring.php
--- phpBB-3.0.10/cache/data_cfg_theme_spring.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/cache/data_cfg_theme_spring.php	2014-04-15 15:00:22.825414281 +0200
@@ -0,0 +1,4 @@
+<?php exit; ?>
+1429102822
+170
+a:5:{s:4:"name";s:16:"subsilver2spring";s:9:"copyright";s:24:"&copy; phpBB Group, 2003";s:7:"version";s:6:"3.0.10";s:14:"parse_css_file";b:0;s:8:"filetime";i:1397565078;}
\ No newline at end of file
diff -ruN phpBB-3.0.10/cache/data_global.php phpbb/cache/data_global.php
--- phpBB-3.0.10/cache/data_global.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/cache/data_global.php	2014-04-15 15:05:06.359411887 +0200
@@ -0,0 +1,13 @@
+<?php exit; ?>
+1429102822
+32
+mysqli_version
+s:10:"5.1.70-log";
+1429102822
+9238
+config
+a:277:{s:15:"active_sessions";s:1:"0";s:17:"allow_attachments";s:1:"1";s:15:"allow_autologin";s:1:"1";s:18:"allow_avatar_local";s:1:"0";s:19:"allow_avatar_remote";s:1:"0";s:19:"allow_avatar_upload";s:1:"1";s:12:"allow_bbcode";s:1:"1";s:15:"allow_birthdays";s:1:"1";s:15:"allow_bookmarks";s:1:"1";s:16:"allow_emailreuse";s:1:"0";s:18:"allow_forum_notify";s:1:"1";s:13:"allow_mass_pm";s:1:"1";s:16:"allow_name_chars";s:18:"USERNAME_CHARS_ANY";s:16:"allow_namechange";s:1:"0";s:15:"allow_nocensors";s:1:"0";s:15:"allow_pm_attach";s:1:"0";s:16:"allow_post_flash";s:1:"1";s:16:"allow_post_links";s:1:"1";s:13:"allow_privmsg";s:1:"1";s:9:"allow_sig";s:1:"0";s:16:"allow_sig_bbcode";s:1:"1";s:15:"allow_sig_flash";s:1:"0";s:13:"allow_sig_img";s:1:"1";s:15:"allow_sig_links";s:1:"1";s:12:"allow_sig_pm";s:1:"1";s:17:"allow_sig_smilies";s:1:"1";s:13:"allow_smilies";s:1:"1";s:18:"allow_topic_notify";s:1:"1";s:16:"attachment_quota";s:10:"5242880000";s:14:"auth_bbcode_pm";s:1:"1";s:13:"auth_flash_pm";s:1:"0";s:11:"auth_img_pm";s:1:"1";s:11:"auth_method";s:2:"db";s:15:"auth_smilies_pm";s:1:"1";s:15:"avatar_filesize";s:5:"10240";s:19:"avatar_gallery_path";s:22:"images/avatars/gallery";s:17:"avatar_max_height";s:2:"80";s:16:"avatar_max_width";s:2:"80";s:17:"avatar_min_height";s:2:"20";s:16:"avatar_min_width";s:2:"20";s:11:"avatar_path";s:21:"images/avatars/upload";s:11:"avatar_salt";s:32:"b53a3e6b726a730fec7b6f7cfae20298";s:13:"board_contact";s:14:"spring@it-l.eu";s:13:"board_disable";s:1:"0";s:17:"board_disable_msg";s:0:"";s:9:"board_dst";s:1:"0";s:11:"board_email";s:14:"spring@it-l.eu";s:16:"board_email_form";s:1:"0";s:15:"board_email_sig";s:23:"Thanks, The Spring team";s:17:"board_hide_emails";s:1:"1";s:14:"board_timezone";s:1:"1";s:13:"browser_check";s:1:"1";s:13:"bump_interval";s:2:"10";s:9:"bump_type";s:1:"d";s:8:"cache_gc";s:4:"7200";s:10:"captcha_gd";s:1:"1";s:27:"captcha_gd_foreground_noise";s:1:"0";s:17:"captcha_gd_x_grid";s:2:"10";s:17:"captcha_gd_y_grid";s:1:"7";s:11:"check_dnsbl";s:1:"0";s:13:"chg_passforce";s:1:"0";s:13:"cookie_domain";s:13:"springrts.com";s:11:"cookie_name";s:12:"phpbb3_tlsuc";s:11:"cookie_path";s:1:"/";s:13:"cookie_secure";s:1:"0";s:12:"coppa_enable";s:1:"0";s:9:"coppa_fax";s:0:"";s:10:"coppa_mail";s:0:"";s:11:"database_gc";s:6:"604800";s:18:"default_dateformat";s:10:"d M Y, H:i";s:13:"default_style";s:1:"5";s:19:"display_last_edited";s:1:"1";s:13:"display_order";s:1:"0";s:9:"edit_time";s:1:"0";s:14:"email_check_mx";s:1:"1";s:12:"email_enable";s:1:"1";s:19:"email_function_name";s:4:"mail";s:18:"email_package_size";s:2:"20";s:14:"enable_confirm";s:1:"1";s:15:"enable_pm_icons";s:1:"1";s:19:"enable_post_confirm";s:1:"1";s:14:"flood_interval";s:2:"15";s:17:"force_server_vars";s:1:"0";s:19:"form_token_lifetime";s:4:"7200";s:18:"form_token_mintime";s:1:"0";s:21:"form_token_sid_guests";s:1:"1";s:10:"forward_pm";s:1:"1";s:19:"forwarded_for_check";s:1:"0";s:18:"full_folder_action";s:1:"2";s:27:"fulltext_mysql_max_word_len";s:2:"84";s:27:"fulltext_mysql_min_word_len";s:1:"4";s:28:"fulltext_native_common_thres";s:1:"5";s:24:"fulltext_native_load_upd";s:1:"1";s:25:"fulltext_native_max_chars";s:2:"14";s:25:"fulltext_native_min_chars";s:1:"2";s:13:"gzip_compress";s:1:"1";s:13:"hot_threshold";s:2:"25";s:10:"icons_path";s:12:"images/icons";s:20:"img_create_thumbnail";s:1:"0";s:19:"img_display_inlined";s:1:"1";s:11:"img_imagick";s:9:"/usr/bin/";s:15:"img_link_height";s:4:"1500";s:14:"img_link_width";s:3:"500";s:14:"img_max_height";s:1:"0";s:19:"img_max_thumb_width";s:3:"400";s:13:"img_max_width";s:1:"0";s:22:"img_min_thumb_filesize";s:5:"12000";s:8:"ip_check";s:1:"3";s:10:"jab_enable";s:1:"0";s:8:"jab_host";s:0:"";s:12:"jab_password";s:0:"";s:16:"jab_package_size";s:2:"20";s:8:"jab_port";s:4:"5222";s:11:"jab_use_ssl";s:1:"0";s:12:"jab_username";s:0:"";s:12:"ldap_base_dn";s:0:"";s:10:"ldap_email";s:0:"";s:13:"ldap_password";s:0:"";s:9:"ldap_port";s:0:"";s:11:"ldap_server";s:0:"";s:8:"ldap_uid";s:0:"";s:9:"ldap_user";s:0:"";s:16:"ldap_user_filter";s:0:"";s:10:"limit_load";s:1:"0";s:17:"limit_search_load";s:1:"0";s:18:"load_anon_lastread";s:1:"0";s:14:"load_birthdays";s:1:"1";s:19:"load_cpf_memberlist";s:1:"0";s:20:"load_cpf_viewprofile";s:1:"1";s:18:"load_cpf_viewtopic";s:1:"0";s:16:"load_db_lastread";s:1:"1";s:13:"load_db_track";s:1:"1";s:12:"load_jumpbox";s:1:"1";s:15:"load_moderators";s:1:"1";s:11:"load_online";s:1:"1";s:18:"load_online_guests";s:1:"1";s:16:"load_online_time";s:1:"5";s:16:"load_onlinetrack";s:1:"1";s:11:"load_search";s:1:"1";s:15:"load_tplcompile";s:1:"1";s:18:"load_user_activity";s:1:"1";s:15:"max_attachments";s:1:"3";s:18:"max_attachments_pm";s:1:"1";s:18:"max_autologin_time";s:1:"0";s:12:"max_filesize";s:8:"10485760";s:15:"max_filesize_pm";s:6:"262144";s:18:"max_login_attempts";s:1:"3";s:14:"max_name_chars";s:2:"20";s:14:"max_pass_chars";s:2:"30";s:16:"max_poll_options";s:2:"20";s:14:"max_post_chars";s:5:"60000";s:18:"max_post_font_size";s:3:"200";s:19:"max_post_img_height";s:1:"0";s:18:"max_post_img_width";s:1:"0";s:16:"max_post_smilies";s:1:"0";s:13:"max_post_urls";s:1:"0";s:15:"max_quote_depth";s:1:"3";s:16:"max_reg_attempts";s:1:"5";s:13:"max_sig_chars";s:3:"300";s:17:"max_sig_font_size";s:3:"200";s:18:"max_sig_img_height";s:1:"0";s:17:"max_sig_img_width";s:1:"0";s:15:"max_sig_smilies";s:1:"0";s:12:"max_sig_urls";s:1:"5";s:14:"min_name_chars";s:1:"3";s:14:"min_pass_chars";s:1:"6";s:23:"min_search_author_chars";s:1:"3";s:12:"min_time_reg";s:2:"10";s:14:"min_time_terms";s:1:"0";s:19:"override_user_style";s:1:"0";s:12:"pass_complex";s:13:"PASS_TYPE_ANY";s:12:"pm_edit_time";s:1:"0";s:12:"pm_max_boxes";s:2:"20";s:11:"pm_max_msgs";s:4:"8000";s:14:"posts_per_page";s:2:"20";s:8:"print_pm";s:1:"1";s:14:"queue_interval";s:2:"60";s:10:"ranks_path";s:12:"images/ranks";s:18:"require_activation";s:1:"1";s:11:"script_path";s:6:"/phpbb";s:17:"search_block_size";s:3:"250";s:9:"search_gc";s:4:"7200";s:15:"search_interval";s:1:"0";s:25:"search_anonymous_interval";s:1:"0";s:11:"search_type";s:14:"fulltext_mysql";s:20:"search_store_results";s:4:"1800";s:17:"secure_allow_deny";s:1:"1";s:26:"secure_allow_empty_referer";s:1:"1";s:16:"secure_downloads";s:1:"0";s:11:"server_name";s:13:"springrts.com";s:11:"server_port";s:2:"80";s:15:"server_protocol";s:7:"http://";s:10:"session_gc";s:4:"3600";s:14:"session_length";s:5:"36000";s:9:"site_desc";s:41:"Open Source Realtime Strategy Game Engine";s:8:"sitename";s:18:"The Spring Project";s:12:"smilies_path";s:14:"images/smilies";s:16:"smtp_auth_method";s:5:"PLAIN";s:13:"smtp_delivery";s:1:"1";s:9:"smtp_host";s:9:"localhost";s:13:"smtp_password";s:0:"";s:9:"smtp_port";s:2:"25";s:13:"smtp_username";s:0:"";s:15:"topics_per_page";s:2:"25";s:13:"tpl_allow_php";s:1:"0";s:17:"upload_icons_path";s:19:"images/upload_icons";s:11:"upload_path";s:5:"files";s:7:"version";s:6:"3.0.12";s:20:"warnings_expire_days";s:2:"60";s:11:"warnings_gc";s:5:"14400";s:15:"board_startdate";s:10:"1092406263";s:12:"default_lang";s:2:"en";s:18:"referer_validation";s:1:"1";s:24:"check_attachment_content";s:1:"1";s:13:"mime_triggers";s:58:"body|head|html|img|plaintext|a href|pre|script|table|title";s:20:"enable_queue_trigger";s:1:"0";s:19:"queue_trigger_posts";s:1:"3";s:17:"pm_max_recipients";s:1:"0";s:12:"dbms_version";s:10:"5.1.70-log";s:10:"rss_enable";s:1:"0";s:18:"rss_overall_forums";s:1:"0";s:24:"rss_overall_forums_limit";s:2:"40";s:19:"rss_overall_threads";s:1:"0";s:25:"rss_overall_threads_limit";s:2:"30";s:17:"rss_overall_posts";s:1:"0";s:23:"rss_overall_posts_limit";s:2:"20";s:13:"rss_egosearch";s:1:"0";s:19:"rss_egosearch_limit";s:2:"10";s:9:"rss_forum";s:1:"0";s:10:"rss_thread";s:1:"0";s:11:"rss_news_id";s:0:"";s:14:"rss_characters";s:1:"0";s:21:"rss_allow_attachments";s:1:"1";s:14:"rss_image_size";s:3:"200";s:15:"rss_permissions";s:1:"0";s:20:"rss_board_statistics";s:1:"1";s:20:"rss_items_statistics";s:1:"1";s:14:"rss_pagination";s:1:"1";s:9:"rss_limit";s:2:"50";s:14:"rss_exclude_id";s:0:"";s:20:"allow_guests_view_fs";s:1:"1";s:15:"captcha_gd_wave";s:1:"0";s:19:"captcha_gd_3d_noise";s:1:"1";s:16:"captcha_gd_fonts";s:1:"1";s:15:"confirm_refresh";s:1:"1";s:23:"max_num_search_keywords";s:2:"10";s:14:"captcha_plugin";s:16:"phpbb_captcha_gd";s:11:"feed_enable";s:1:"1";s:10:"feed_limit";s:2:"10";s:19:"feed_overall_forums";s:1:"0";s:25:"feed_overall_forums_limit";s:2:"15";s:19:"feed_overall_topics";s:1:"0";s:25:"feed_overall_topics_limit";s:2:"15";s:10:"feed_forum";s:1:"1";s:10:"feed_topic";s:1:"1";s:20:"feed_item_statistics";s:1:"1";s:16:"smilies_per_page";s:2:"50";s:15:"allow_pm_report";s:1:"1";s:21:"new_member_post_limit";s:1:"0";s:24:"new_member_group_default";s:1:"0";s:12:"allow_avatar";s:1:"1";s:26:"allow_avatar_remote_upload";s:1:"0";s:14:"min_post_chars";s:1:"1";s:17:"allow_quick_reply";s:1:"1";s:11:"delete_time";s:1:"0";s:23:"questionnaire_unique_id";s:16:"fe56ba7ef8647884";s:12:"feed_overall";s:1:"1";s:14:"feed_http_auth";s:1:"0";s:15:"feed_limit_post";s:2:"10";s:16:"feed_limit_topic";s:2:"15";s:15:"feed_topics_new";s:1:"0";s:18:"feed_topics_active";s:1:"0";s:19:"load_unreads_search";s:1:"1";s:18:"ip_login_limit_max";s:2:"50";s:19:"ip_login_limit_time";s:5:"21600";s:28:"ip_login_limit_use_forwarded";s:1:"0";s:20:"email_max_chunk_size";s:2:"50";}
+1429103106
+83
+imageset_site_logo_md5
+a:1:{s:8:"spring::";s:32:"923b4e11c03a6216ad22560a401e31e6";}
\ No newline at end of file
diff -ruN phpBB-3.0.10/cache/data_hooks.php phpbb/cache/data_hooks.php
--- phpBB-3.0.10/cache/data_hooks.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/cache/data_hooks.php	2014-04-15 15:00:22.719414281 +0200
@@ -0,0 +1,4 @@
+<?php exit; ?>
+1429102822
+6
+a:0:{}
\ No newline at end of file
diff -ruN phpBB-3.0.10/cache/data_role_cache.php phpbb/cache/data_role_cache.php
--- phpBB-3.0.10/cache/data_role_cache.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/cache/data_role_cache.php	2014-04-15 15:00:22.777414281 +0200
@@ -0,0 +1,4 @@
+<?php exit; ?>
+1429102822
+4228
+a:25:{i:1;s:250:"a:27:{i:44;i:1;i:66;i:1;i:68;i:1;i:70;i:1;i:71;i:1;i:72;i:1;i:73;i:1;i:79;i:1;i:80;i:1;i:81;i:1;i:82;i:1;i:83;i:1;i:84;i:1;i:63;i:1;i:62;i:1;i:46;i:1;i:47;i:1;i:48;i:1;i:50;i:1;i:51;i:1;i:52;i:1;i:56;i:1;i:57;i:1;i:58;i:1;i:59;i:1;i:60;i:1;i:61;i:1;}";i:2;s:115:"a:12:{i:66;i:1;i:71;i:1;i:79;i:1;i:82;i:1;i:83;i:1;i:59;i:1;i:58;i:1;i:57;i:1;i:56;i:1;i:48;i:1;i:47;i:1;i:44;i:1;}";i:3;s:115:"a:12:{i:72;i:1;i:79;i:1;i:80;i:1;i:82;i:1;i:83;i:1;i:62;i:1;i:61;i:1;i:44;i:1;i:47;i:1;i:48;i:1;i:50;i:1;i:60;i:1;}";i:4;s:376:"a:41:{i:73;i:1;i:72;i:1;i:71;i:1;i:70;i:1;i:69;i:1;i:68;i:1;i:67;i:1;i:66;i:1;i:74;i:1;i:75;i:1;i:76;i:1;i:84;i:1;i:83;i:1;i:82;i:1;i:81;i:1;i:80;i:1;i:79;i:1;i:78;i:1;i:77;i:1;i:65;i:1;i:64;i:1;i:63;i:1;i:51;i:1;i:50;i:1;i:49;i:1;i:48;i:1;i:47;i:1;i:46;i:1;i:45;i:1;i:44;i:1;i:52;i:1;i:53;i:1;i:54;i:1;i:62;i:1;i:61;i:1;i:60;i:1;i:59;i:1;i:58;i:1;i:57;i:1;i:56;i:1;i:55;i:1;}";i:5;s:322:"a:33:{i:108;i:1;i:107;i:1;i:106;i:1;i:105;i:1;i:104;i:1;i:103;i:1;i:109;i:1;i:110;i:1;i:111;i:1;i:112;i:1;i:113;i:1;i:114;i:1;i:115;i:1;i:116;i:1;i:117;i:1;i:102;i:1;i:101;i:1;i:100;i:1;i:85;i:1;i:86;i:1;i:87;i:1;i:88;i:1;i:89;i:1;i:90;i:1;i:91;i:1;i:92;i:1;i:93;i:1;i:94;i:1;i:95;i:1;i:96;i:1;i:97;i:1;i:98;i:1;i:99;i:1;}";i:6;s:265:"a:27:{i:109;i:1;i:108;i:1;i:107;i:1;i:106;i:1;i:105;i:1;i:110;i:1;i:111;i:1;i:112;i:1;i:113;i:1;i:114;i:1;i:116;i:1;i:117;i:1;i:102;i:1;i:101;i:1;i:85;i:1;i:86;i:1;i:87;i:1;i:88;i:1;i:89;i:1;i:92;i:1;i:93;i:1;i:94;i:1;i:100;i:1;i:99;i:1;i:98;i:1;i:97;i:1;i:96;i:1;}";i:7;s:207:"a:21:{i:105;i:1;i:106;i:1;i:107;i:1;i:108;i:1;i:113;i:1;i:114;i:1;i:116;i:1;i:117;i:1;i:104;i:1;i:101;i:1;i:100;i:1;i:85;i:1;i:87;i:1;i:88;i:1;i:89;i:1;i:92;i:1;i:93;i:1;i:94;i:1;i:96;i:1;i:98;i:1;i:99;i:1;}";i:8;s:129:"a:13:{i:96;i:0;i:108;i:0;i:113;i:0;i:117;i:0;i:116;i:1;i:114;i:1;i:85;i:1;i:87;i:1;i:88;i:1;i:89;i:1;i:92;i:1;i:93;i:1;i:94;i:1;}";i:9;s:207:"a:21:{i:107;i:1;i:113;i:1;i:114;i:1;i:116;i:1;i:87;i:0;i:117;i:1;i:108;i:1;i:106;i:1;i:105;i:1;i:104;i:1;i:85;i:1;i:88;i:1;i:89;i:1;i:92;i:1;i:93;i:1;i:94;i:1;i:96;i:1;i:98;i:1;i:99;i:1;i:100;i:1;i:101;i:1;}";i:10;s:115:"a:12:{i:32;i:1;i:34;i:1;i:35;i:1;i:42;i:1;i:36;i:1;i:38;i:1;i:41;i:1;i:33;i:1;i:31;i:1;i:39;i:1;i:43;i:1;i:37;i:1;}";i:11;s:106:"a:11:{i:35;i:1;i:31;i:1;i:32;i:1;i:41;i:1;i:43;i:1;i:34;i:1;i:36;i:1;i:40;i:1;i:37;i:1;i:38;i:1;i:39;i:1;}";i:12;s:51:"a:5:{i:40;i:1;i:36;i:1;i:35;i:1;i:31;i:1;i:34;i:1;}";i:13;s:33:"a:3:{i:35;i:1;i:32;i:1;i:31;i:1;}";i:14;s:268:"a:30:{i:20;i:1;i:21;i:1;i:22;i:1;i:23;i:1;i:24;i:1;i:25;i:1;i:26;i:1;i:27;i:1;i:28;i:1;i:29;i:1;i:30;i:1;i:19;i:1;i:18;i:1;i:17;i:1;i:1;i:1;i:5;i:1;i:4;i:1;i:3;i:1;i:2;i:1;i:6;i:1;i:7;i:1;i:8;i:1;i:9;i:1;i:16;i:1;i:15;i:1;i:14;i:1;i:13;i:1;i:12;i:1;i:11;i:1;i:10;i:1;}";i:15;s:215:"a:24:{i:21;i:1;i:22;i:1;i:23;i:1;i:24;i:1;i:25;i:1;i:27;i:1;i:29;i:1;i:30;i:1;i:20;i:1;i:19;i:1;i:18;i:1;i:1;i:1;i:3;i:1;i:4;i:1;i:5;i:1;i:6;i:1;i:7;i:1;i:8;i:1;i:9;i:1;i:17;i:1;i:15;i:1;i:14;i:1;i:13;i:1;i:11;i:1;}";i:16;s:14:"a:1:{i:1;i:0;}";i:17;s:67:"a:7:{i:19;i:1;i:20;i:1;i:1;i:1;i:7;i:1;i:14;i:1;i:27;i:1;i:23;i:1;}";i:18;s:173:"a:19:{i:22;i:1;i:23;i:1;i:24;i:1;i:25;i:1;i:27;i:1;i:29;i:1;i:21;i:1;i:20;i:1;i:1;i:1;i:4;i:1;i:7;i:1;i:8;i:1;i:9;i:1;i:13;i:1;i:18;i:1;i:19;i:1;i:17;i:1;i:15;i:1;i:14;i:1;}";i:19;s:49:"a:5:{i:1;i:1;i:20;i:1;i:19;i:1;i:14;i:1;i:7;i:1;}";i:20;s:181:"a:20:{i:23;i:1;i:24;i:1;i:25;i:1;i:27;i:1;i:29;i:1;i:15;i:0;i:22;i:1;i:21;i:1;i:20;i:1;i:1;i:1;i:3;i:1;i:4;i:1;i:7;i:1;i:8;i:1;i:9;i:1;i:13;i:1;i:14;i:1;i:17;i:1;i:18;i:1;i:19;i:1;}";i:21;s:224:"a:25:{i:20;i:1;i:21;i:1;i:22;i:1;i:23;i:1;i:24;i:1;i:25;i:1;i:27;i:1;i:29;i:1;i:30;i:1;i:19;i:1;i:18;i:1;i:5;i:1;i:6;i:1;i:4;i:1;i:3;i:1;i:1;i:1;i:7;i:1;i:8;i:1;i:9;i:1;i:17;i:1;i:16;i:1;i:15;i:1;i:14;i:1;i:13;i:1;i:11;i:1;}";i:22;s:182:"a:20:{i:22;i:1;i:23;i:1;i:24;i:1;i:25;i:1;i:27;i:1;i:29;i:1;i:21;i:1;i:20;i:1;i:19;i:1;i:9;i:1;i:8;i:1;i:7;i:1;i:4;i:1;i:1;i:1;i:13;i:1;i:14;i:1;i:15;i:1;i:16;i:1;i:18;i:1;i:17;i:1;}";i:23;s:173:"a:19:{i:9;i:1;i:23;i:1;i:29;i:1;i:27;i:1;i:18;i:1;i:5;i:1;i:15;i:1;i:30;i:1;i:22;i:1;i:24;i:1;i:21;i:1;i:4;i:1;i:14;i:1;i:20;i:1;i:1;i:1;i:25;i:1;i:11;i:1;i:7;i:1;i:19;i:1;}";i:24;s:35:"a:3:{i:96;i:0;i:117;i:0;i:113;i:0;}";i:25;s:15:"a:1:{i:15;i:0;}";}
\ No newline at end of file
diff -ruN phpBB-3.0.10/cache/data_word_censors.php phpbb/cache/data_word_censors.php
--- phpBB-3.0.10/cache/data_word_censors.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/cache/data_word_censors.php	2014-04-15 15:00:22.869414280 +0200
@@ -0,0 +1,4 @@
+<?php exit; ?>
+1429102822
+6
+a:0:{}
\ No newline at end of file
diff -ruN phpBB-3.0.10/cache/sql_1a37f99398609f5c33923b0b2b7626f5.php phpbb/cache/sql_1a37f99398609f5c33923b0b2b7626f5.php
--- phpBB-3.0.10/cache/sql_1a37f99398609f5c33923b0b2b7626f5.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/cache/sql_1a37f99398609f5c33923b0b2b7626f5.php	2014-04-15 15:00:22.744414281 +0200
@@ -0,0 +1,5 @@
+<?php exit; ?>
+1397570422
+SELECT ban_ip, ban_userid, ban_email, ban_exclude, ban_give_reason, ban_end FROM phpbb3_banlist WHERE ban_email = '' AND (ban_userid = 1 OR ban_ip <> '')
+6
+a:0:{}
\ No newline at end of file
diff -ruN phpBB-3.0.10/cache/sql_9c9fe6e1280dfee3c82d451df6931416.php phpbb/cache/sql_9c9fe6e1280dfee3c82d451df6931416.php
--- phpBB-3.0.10/cache/sql_9c9fe6e1280dfee3c82d451df6931416.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/cache/sql_9c9fe6e1280dfee3c82d451df6931416.php	2014-04-15 15:00:22.866414280 +0200
@@ -0,0 +1,5 @@
+<?php exit; ?>
+1397570422
+SELECT m.*, u.user_colour, g.group_colour, g.group_type FROM (phpbb3_moderator_cache m) LEFT JOIN phpbb3_users u ON (m.user_id = u.user_id) LEFT JOIN phpbb3_groups g ON (m.group_id = g.group_id) WHERE m.display_on_index = 1
+6
+a:0:{}
\ No newline at end of file
diff -ruN phpBB-3.0.10/cache/sql_a026e7ab8bb5c0ab257d5a42922abb07.php phpbb/cache/sql_a026e7ab8bb5c0ab257d5a42922abb07.php
--- phpBB-3.0.10/cache/sql_a026e7ab8bb5c0ab257d5a42922abb07.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/cache/sql_a026e7ab8bb5c0ab257d5a42922abb07.php	2014-04-15 15:10:45.973409020 +0200
@@ -0,0 +1,5 @@
+<?php exit; ?>
+1397568045
+SELECT forum_id FROM phpbb3_forums WHERE forum_options & 2 <> 0 LIMIT 1
+39
+a:1:{i:0;a:1:{s:8:"forum_id";s:1:"2";}}
\ No newline at end of file
diff -ruN phpBB-3.0.10/cache/sql_e4646055f69bcd0cb7ef3bbff697ee0c.php phpbb/cache/sql_e4646055f69bcd0cb7ef3bbff697ee0c.php
--- phpBB-3.0.10/cache/sql_e4646055f69bcd0cb7ef3bbff697ee0c.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/cache/sql_e4646055f69bcd0cb7ef3bbff697ee0c.php	2014-04-15 15:00:26.345414251 +0200
@@ -0,0 +1,5 @@
+<?php exit; ?>
+1397567426
+SELECT forum_id, forum_name, parent_id, forum_type, left_id, right_id FROM phpbb3_forums ORDER BY left_id ASC
+11147
+a:64:{i:0;a:6:{s:8:"forum_id";s:2:"24";s:10:"forum_name";s:6:"Spring";s:9:"parent_id";s:1:"0";s:10:"forum_type";s:1:"0";s:7:"left_id";s:1:"1";s:8:"right_id";s:2:"22";}i:1;a:6:{s:8:"forum_id";s:2:"38";s:10:"forum_name";s:14:"Community News";s:9:"parent_id";s:2:"24";s:10:"forum_type";s:1:"1";s:7:"left_id";s:1:"2";s:8:"right_id";s:1:"5";}i:2;a:6:{s:8:"forum_id";s:2:"39";s:10:"forum_name";s:16:"News Submissions";s:9:"parent_id";s:2:"38";s:10:"forum_type";s:1:"1";s:7:"left_id";s:1:"3";s:8:"right_id";s:1:"4";}i:3;a:6:{s:8:"forum_id";s:1:"1";s:10:"forum_name";s:18:"General Discussion";s:9:"parent_id";s:2:"24";s:10:"forum_type";s:1:"1";s:7:"left_id";s:1:"6";s:8:"right_id";s:1:"7";}i:4;a:6:{s:8:"forum_id";s:2:"11";s:10:"forum_name";s:15:"Help &amp; Bugs";s:9:"parent_id";s:2:"24";s:10:"forum_type";s:1:"1";s:7:"left_id";s:1:"8";s:8:"right_id";s:1:"9";}i:5;a:6:{s:8:"forum_id";s:2:"16";s:10:"forum_name";s:10:"Game Lobby";s:9:"parent_id";s:2:"24";s:10:"forum_type";s:1:"1";s:7:"left_id";s:2:"10";s:8:"right_id";s:2:"15";}i:6;a:6:{s:8:"forum_id";s:2:"59";s:10:"forum_name";s:12:"Spring Clans";s:9:"parent_id";s:2:"16";s:10:"forum_type";s:1:"1";s:7:"left_id";s:2:"11";s:8:"right_id";s:2:"12";}i:7;a:6:{s:8:"forum_id";s:2:"64";s:10:"forum_name";s:13:"Lobby Clients";s:9:"parent_id";s:2:"16";s:10:"forum_type";s:1:"1";s:7:"left_id";s:2:"13";s:8:"right_id";s:2:"14";}i:8;a:6:{s:8:"forum_id";s:2:"20";s:10:"forum_name";s:5:"Linux";s:9:"parent_id";s:2:"24";s:10:"forum_type";s:1:"1";s:7:"left_id";s:2:"16";s:8:"right_id";s:2:"17";}i:9;a:6:{s:8:"forum_id";s:2:"65";s:10:"forum_name";s:8:"Mac OS X";s:9:"parent_id";s:2:"24";s:10:"forum_type";s:1:"1";s:7:"left_id";s:2:"18";s:8:"right_id";s:2:"19";}i:10;a:6:{s:8:"forum_id";s:2:"10";s:10:"forum_name";s:20:"Off Topic Discussion";s:9:"parent_id";s:2:"24";s:10:"forum_type";s:1:"1";s:7:"left_id";s:2:"20";s:8:"right_id";s:2:"21";}i:11;a:6:{s:8:"forum_id";s:2:"25";s:10:"forum_name";s:16:"Content Creation";s:9:"parent_id";s:1:"0";s:10:"forum_type";s:1:"0";s:7:"left_id";s:2:"23";s:8:"right_id";s:2:"76";}i:12;a:6:{s:8:"forum_id";s:2:"14";s:10:"forum_name";s:16:"Games &amp; Mods";s:9:"parent_id";s:2:"25";s:10:"forum_type";s:1:"1";s:7:"left_id";s:2:"24";s:8:"right_id";s:2:"27";}i:13;a:6:{s:8:"forum_id";s:2:"67";s:10:"forum_name";s:55:"Game &amp; Module Development Tutorials &amp; Resources";s:9:"parent_id";s:2:"14";s:10:"forum_type";s:1:"1";s:7:"left_id";s:2:"25";s:8:"right_id";s:2:"26";}i:14;a:6:{s:8:"forum_id";s:2:"13";s:10:"forum_name";s:12:"Map Creation";s:9:"parent_id";s:2:"25";s:10:"forum_type";s:1:"1";s:7:"left_id";s:2:"28";s:8:"right_id";s:2:"31";}i:15;a:6:{s:8:"forum_id";s:2:"56";s:10:"forum_name";s:29:"Map Tutorials &amp; Resources";s:9:"parent_id";s:2:"13";s:10:"forum_type";s:1:"1";s:7:"left_id";s:2:"29";s:8:"right_id";s:2:"30";}i:16;a:6:{s:8:"forum_id";s:1:"9";s:10:"forum_name";s:19:"Art &amp; Modelling";s:9:"parent_id";s:2:"25";s:10:"forum_type";s:1:"1";s:7:"left_id";s:2:"32";s:8:"right_id";s:2:"35";}i:17;a:6:{s:8:"forum_id";s:2:"57";s:10:"forum_name";s:51:"Modelling &amp; Texturing Tutorials &amp; Resources";s:9:"parent_id";s:1:"9";s:10:"forum_type";s:1:"1";s:7:"left_id";s:2:"33";s:8:"right_id";s:2:"34";}i:18;a:6:{s:8:"forum_id";s:2:"47";s:10:"forum_name";s:17:"Project Subforums";s:9:"parent_id";s:2:"25";s:10:"forum_type";s:1:"1";s:7:"left_id";s:2:"36";s:8:"right_id";s:2:"73";}i:19;a:6:{s:8:"forum_id";s:2:"43";s:10:"forum_name";s:12:"Kernel Panic";s:9:"parent_id";s:2:"47";s:10:"forum_type";s:1:"1";s:7:"left_id";s:2:"37";s:8:"right_id";s:2:"38";}i:20;a:6:{s:8:"forum_id";s:2:"42";s:10:"forum_name";s:21:"Complete Annihilation";s:9:"parent_id";s:2:"47";s:10:"forum_type";s:1:"1";s:7:"left_id";s:2:"39";s:8:"right_id";s:2:"40";}i:21;a:6:{s:8:"forum_id";s:2:"44";s:10:"forum_name";s:21:"Balanced Annihilation";s:9:"parent_id";s:2:"47";s:10:"forum_type";s:1:"1";s:7:"left_id";s:2:"41";s:8:"right_id";s:2:"42";}i:22;a:6:{s:8:"forum_id";s:2:"45";s:10:"forum_name";s:12:"Spring: 1944";s:9:"parent_id";s:2:"47";s:10:"forum_type";s:1:"1";s:7:"left_id";s:2:"43";s:8:"right_id";s:2:"44";}i:23;a:6:{s:8:"forum_id";s:2:"46";s:10:"forum_name";s:26:"Star Wars: Imperial Winter";s:9:"parent_id";s:2:"47";s:10:"forum_type";s:1:"1";s:7:"left_id";s:2:"45";s:8:"right_id";s:2:"46";}i:24;a:6:{s:8:"forum_id";s:2:"48";s:10:"forum_name";s:3:"XTA";s:9:"parent_id";s:2:"47";s:10:"forum_type";s:1:"1";s:7:"left_id";s:2:"47";s:8:"right_id";s:2:"48";}i:25;a:6:{s:8:"forum_id";s:2:"49";s:10:"forum_name";s:20:"Supreme Annihilation";s:9:"parent_id";s:2:"47";s:10:"forum_type";s:1:"1";s:7:"left_id";s:2:"49";s:8:"right_id";s:2:"50";}i:26;a:6:{s:8:"forum_id";s:2:"50";s:10:"forum_name";s:16:"Caydr's Projects";s:9:"parent_id";s:2:"47";s:10:"forum_type";s:1:"1";s:7:"left_id";s:2:"51";s:8:"right_id";s:2:"52";}i:27;a:6:{s:8:"forum_id";s:2:"51";s:10:"forum_name";s:13:"Evolution RTS";s:9:"parent_id";s:2:"47";s:10:"forum_type";s:1:"1";s:7:"left_id";s:2:"53";s:8:"right_id";s:2:"54";}i:28;a:6:{s:8:"forum_id";s:2:"53";s:10:"forum_name";s:15:"Argh's Projects";s:9:"parent_id";s:2:"47";s:10:"forum_type";s:1:"1";s:7:"left_id";s:2:"55";s:8:"right_id";s:2:"56";}i:29;a:6:{s:8:"forum_id";s:2:"54";s:10:"forum_name";s:10:"The Cursed";s:9:"parent_id";s:2:"47";s:10:"forum_type";s:1:"1";s:7:"left_id";s:2:"57";s:8:"right_id";s:2:"58";}i:30;a:6:{s:8:"forum_id";s:2:"55";s:10:"forum_name";s:4:"NOTA";s:9:"parent_id";s:2:"47";s:10:"forum_type";s:1:"1";s:7:"left_id";s:2:"59";s:8:"right_id";s:2:"60";}i:31;a:6:{s:8:"forum_id";s:2:"58";s:10:"forum_name";s:6:"Damned";s:9:"parent_id";s:2:"47";s:10:"forum_type";s:1:"1";s:7:"left_id";s:2:"61";s:8:"right_id";s:2:"62";}i:32;a:6:{s:8:"forum_id";s:2:"63";s:10:"forum_name";s:14:"Conflict Terra";s:9:"parent_id";s:2:"47";s:10:"forum_type";s:1:"1";s:7:"left_id";s:2:"63";s:8:"right_id";s:2:"64";}i:33;a:6:{s:8:"forum_id";s:2:"66";s:10:"forum_name";s:14:"Engines Of War";s:9:"parent_id";s:2:"47";s:10:"forum_type";s:1:"1";s:7:"left_id";s:2:"65";s:8:"right_id";s:2:"66";}i:34;a:6:{s:8:"forum_id";s:2:"68";s:10:"forum_name";s:12:"Spring Tanks";s:9:"parent_id";s:2:"47";s:10:"forum_type";s:1:"1";s:7:"left_id";s:2:"67";s:8:"right_id";s:2:"68";}i:35;a:6:{s:8:"forum_id";s:2:"69";s:10:"forum_name";s:10:"Journeywar";s:9:"parent_id";s:2:"47";s:10:"forum_type";s:1:"1";s:7:"left_id";s:2:"69";s:8:"right_id";s:2:"70";}i:36;a:6:{s:8:"forum_id";s:2:"70";s:10:"forum_name";s:18:"BattleTech: Legacy";s:9:"parent_id";s:2:"47";s:10:"forum_type";s:1:"1";s:7:"left_id";s:2:"71";s:8:"right_id";s:2:"72";}i:37;a:6:{s:8:"forum_id";s:2:"52";s:10:"forum_name";s:25:"Sound Effects &amp; Music";s:9:"parent_id";s:2:"25";s:10:"forum_type";s:1:"1";s:7:"left_id";s:2:"74";s:8:"right_id";s:2:"75";}i:38;a:6:{s:8:"forum_id";s:2:"28";s:10:"forum_name";s:11:"Development";s:9:"parent_id";s:1:"0";s:10:"forum_type";s:1:"0";s:7:"left_id";s:2:"77";s:8:"right_id";s:2:"96";}i:39;a:6:{s:8:"forum_id";s:1:"2";s:10:"forum_name";s:4:"News";s:9:"parent_id";s:2:"28";s:10:"forum_type";s:1:"1";s:7:"left_id";s:2:"78";s:8:"right_id";s:2:"79";}i:40;a:6:{s:8:"forum_id";s:2:"12";s:10:"forum_name";s:11:"Development";s:9:"parent_id";s:2:"28";s:10:"forum_type";s:1:"1";s:7:"left_id";s:2:"80";s:8:"right_id";s:2:"87";}i:41;a:6:{s:8:"forum_id";s:2:"22";s:10:"forum_name";s:30:"Dedicated Developer Discussion";s:9:"parent_id";s:2:"12";s:10:"forum_type";s:1:"1";s:7:"left_id";s:2:"81";s:8:"right_id";s:2:"82";}i:42;a:6:{s:8:"forum_id";s:2:"60";s:10:"forum_name";s:21:"Google Summer of Code";s:9:"parent_id";s:2:"12";s:10:"forum_type";s:1:"1";s:7:"left_id";s:2:"83";s:8:"right_id";s:2:"86";}i:43;a:6:{s:8:"forum_id";s:2:"61";s:10:"forum_name";s:22:"GSoC Project Proposals";s:9:"parent_id";s:2:"60";s:10:"forum_type";s:1:"1";s:7:"left_id";s:2:"84";s:8:"right_id";s:2:"85";}i:44;a:6:{s:8:"forum_id";s:2:"15";s:10:"forum_name";s:2:"AI";s:9:"parent_id";s:2:"28";s:10:"forum_type";s:1:"1";s:7:"left_id";s:2:"88";s:8:"right_id";s:2:"89";}i:45;a:6:{s:8:"forum_id";s:2:"21";s:10:"forum_name";s:16:"Feature Requests";s:9:"parent_id";s:2:"28";s:10:"forum_type";s:1:"1";s:7:"left_id";s:2:"90";s:8:"right_id";s:2:"91";}i:46;a:6:{s:8:"forum_id";s:2:"23";s:10:"forum_name";s:11:"Lua Scripts";s:9:"parent_id";s:2:"28";s:10:"forum_type";s:1:"1";s:7:"left_id";s:2:"92";s:8:"right_id";s:2:"93";}i:47;a:6:{s:8:"forum_id";s:2:"62";s:10:"forum_name";s:11:"Publication";s:9:"parent_id";s:2:"28";s:10:"forum_type";s:1:"1";s:7:"left_id";s:2:"94";s:8:"right_id";s:2:"95";}i:48;a:6:{s:8:"forum_id";s:2:"29";s:10:"forum_name";s:7:"Private";s:9:"parent_id";s:1:"0";s:10:"forum_type";s:1:"0";s:7:"left_id";s:2:"97";s:8:"right_id";s:3:"112";}i:49;a:6:{s:8:"forum_id";s:1:"3";s:10:"forum_name";s:18:"Private discussion";s:9:"parent_id";s:2:"29";s:10:"forum_type";s:1:"1";s:7:"left_id";s:2:"98";s:8:"right_id";s:2:"99";}i:50;a:6:{s:8:"forum_id";s:2:"17";s:10:"forum_name";s:23:"Private moderator forum";s:9:"parent_id";s:2:"29";s:10:"forum_type";s:1:"1";s:7:"left_id";s:3:"100";s:8:"right_id";s:3:"101";}i:51;a:6:{s:8:"forum_id";s:1:"4";s:10:"forum_name";s:12:"Team members";s:9:"parent_id";s:2:"29";s:10:"forum_type";s:1:"1";s:7:"left_id";s:3:"102";s:8:"right_id";s:3:"103";}i:52;a:6:{s:8:"forum_id";s:1:"5";s:10:"forum_name";s:12:"Site content";s:9:"parent_id";s:2:"29";s:10:"forum_type";s:1:"1";s:7:"left_id";s:3:"104";s:8:"right_id";s:3:"105";}i:53;a:6:{s:8:"forum_id";s:1:"8";s:10:"forum_name";s:9:"Downloads";s:9:"parent_id";s:2:"29";s:10:"forum_type";s:1:"1";s:7:"left_id";s:3:"106";s:8:"right_id";s:3:"107";}i:54;a:6:{s:8:"forum_id";s:2:"18";s:10:"forum_name";s:8:"Spam box";s:9:"parent_id";s:2:"29";s:10:"forum_type";s:1:"1";s:7:"left_id";s:3:"108";s:8:"right_id";s:3:"111";}i:55;a:6:{s:8:"forum_id";s:2:"40";s:10:"forum_name";s:17:"The Werewolf Game";s:9:"parent_id";s:2:"18";s:10:"forum_type";s:1:"1";s:7:"left_id";s:3:"109";s:8:"right_id";s:3:"110";}i:56;a:6:{s:8:"forum_id";s:2:"30";s:10:"forum_name";s:12:"Site content";s:9:"parent_id";s:1:"0";s:10:"forum_type";s:1:"0";s:7:"left_id";s:3:"113";s:8:"right_id";s:3:"128";}i:57;a:6:{s:8:"forum_id";s:2:"31";s:10:"forum_name";s:12:"Site content";s:9:"parent_id";s:2:"30";s:10:"forum_type";s:1:"1";s:7:"left_id";s:3:"114";s:8:"right_id";s:3:"127";}i:58;a:6:{s:8:"forum_id";s:2:"32";s:10:"forum_name";s:7:"Banners";s:9:"parent_id";s:2:"31";s:10:"forum_type";s:1:"1";s:7:"left_id";s:3:"115";s:8:"right_id";s:3:"116";}i:59;a:6:{s:8:"forum_id";s:2:"33";s:10:"forum_name";s:14:"Welcome images";s:9:"parent_id";s:2:"31";s:10:"forum_type";s:1:"1";s:7:"left_id";s:3:"117";s:8:"right_id";s:3:"118";}i:60;a:6:{s:8:"forum_id";s:2:"34";s:10:"forum_name";s:6:"Videos";s:9:"parent_id";s:2:"31";s:10:"forum_type";s:1:"1";s:7:"left_id";s:3:"119";s:8:"right_id";s:3:"120";}i:61;a:6:{s:8:"forum_id";s:2:"37";s:10:"forum_name";s:22:"Videos - contributions";s:9:"parent_id";s:2:"31";s:10:"forum_type";s:1:"1";s:7:"left_id";s:3:"121";s:8:"right_id";s:3:"122";}i:62;a:6:{s:8:"forum_id";s:2:"35";s:10:"forum_name";s:11:"Screenshots";s:9:"parent_id";s:2:"31";s:10:"forum_type";s:1:"1";s:7:"left_id";s:3:"123";s:8:"right_id";s:3:"124";}i:63;a:6:{s:8:"forum_id";s:2:"36";s:10:"forum_name";s:27:"Screenshots - contributions";s:9:"parent_id";s:2:"31";s:10:"forum_type";s:1:"1";s:7:"left_id";s:3:"125";s:8:"right_id";s:3:"126";}}
\ No newline at end of file
diff -ruN phpBB-3.0.10/cache/sql_eea78c245bb07d185a4d8938598fbf14.php phpbb/cache/sql_eea78c245bb07d185a4d8938598fbf14.php
--- phpBB-3.0.10/cache/sql_eea78c245bb07d185a4d8938598fbf14.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/cache/sql_eea78c245bb07d185a4d8938598fbf14.php	2014-04-15 15:00:22.842414280 +0200
@@ -0,0 +1,5 @@
+<?php exit; ?>
+1397570422
+SELECT * FROM phpbb3_styles_imageset_data WHERE imageset_id = 3 AND image_filename <> '' AND image_lang IN ('en', '')
+19293
+a:81:{i:0;a:7:{s:8:"image_id";s:3:"160";s:10:"image_name";s:9:"site_logo";s:14:"image_filename";s:13:"site_logo.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"94";s:11:"image_width";s:3:"170";s:11:"imageset_id";s:1:"3";}i:1;a:7:{s:8:"image_id";s:3:"161";s:10:"image_name";s:10:"upload_bar";s:14:"image_filename";s:14:"upload_bar.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"16";s:11:"image_width";s:3:"280";s:11:"imageset_id";s:1:"3";}i:2;a:7:{s:8:"image_id";s:3:"162";s:10:"image_name";s:9:"poll_left";s:14:"image_filename";s:13:"poll_left.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"12";s:11:"image_width";s:1:"4";s:11:"imageset_id";s:1:"3";}i:3;a:7:{s:8:"image_id";s:3:"163";s:10:"image_name";s:11:"poll_center";s:14:"image_filename";s:15:"poll_center.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"12";s:11:"image_width";s:1:"0";s:11:"imageset_id";s:1:"3";}i:4;a:7:{s:8:"image_id";s:3:"164";s:10:"image_name";s:10:"poll_right";s:14:"image_filename";s:14:"poll_right.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"12";s:11:"image_width";s:1:"4";s:11:"imageset_id";s:1:"3";}i:5;a:7:{s:8:"image_id";s:3:"165";s:10:"image_name";s:10:"forum_link";s:14:"image_filename";s:14:"forum_link.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"25";s:11:"image_width";s:2:"46";s:11:"imageset_id";s:1:"3";}i:6;a:7:{s:8:"image_id";s:3:"166";s:10:"image_name";s:10:"forum_read";s:14:"image_filename";s:14:"forum_read.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"25";s:11:"image_width";s:2:"46";s:11:"imageset_id";s:1:"3";}i:7;a:7:{s:8:"image_id";s:3:"167";s:10:"image_name";s:17:"forum_read_locked";s:14:"image_filename";s:21:"forum_read_locked.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"25";s:11:"image_width";s:2:"46";s:11:"imageset_id";s:1:"3";}i:8;a:7:{s:8:"image_id";s:3:"168";s:10:"image_name";s:19:"forum_read_subforum";s:14:"image_filename";s:23:"forum_read_subforum.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"25";s:11:"image_width";s:2:"46";s:11:"imageset_id";s:1:"3";}i:9;a:7:{s:8:"image_id";s:3:"169";s:10:"image_name";s:12:"forum_unread";s:14:"image_filename";s:16:"forum_unread.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"25";s:11:"image_width";s:2:"46";s:11:"imageset_id";s:1:"3";}i:10;a:7:{s:8:"image_id";s:3:"170";s:10:"image_name";s:19:"forum_unread_locked";s:14:"image_filename";s:23:"forum_unread_locked.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"25";s:11:"image_width";s:2:"46";s:11:"imageset_id";s:1:"3";}i:11;a:7:{s:8:"image_id";s:3:"171";s:10:"image_name";s:21:"forum_unread_subforum";s:14:"image_filename";s:25:"forum_unread_subforum.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"25";s:11:"image_width";s:2:"46";s:11:"imageset_id";s:1:"3";}i:12;a:7:{s:8:"image_id";s:3:"172";s:10:"image_name";s:11:"topic_moved";s:14:"image_filename";s:15:"topic_moved.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"18";s:11:"image_width";s:2:"19";s:11:"imageset_id";s:1:"3";}i:13;a:7:{s:8:"image_id";s:3:"173";s:10:"image_name";s:10:"topic_read";s:14:"image_filename";s:14:"topic_read.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"18";s:11:"image_width";s:2:"19";s:11:"imageset_id";s:1:"3";}i:14;a:7:{s:8:"image_id";s:3:"174";s:10:"image_name";s:15:"topic_read_mine";s:14:"image_filename";s:19:"topic_read_mine.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"18";s:11:"image_width";s:2:"19";s:11:"imageset_id";s:1:"3";}i:15;a:7:{s:8:"image_id";s:3:"175";s:10:"image_name";s:14:"topic_read_hot";s:14:"image_filename";s:18:"topic_read_hot.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"18";s:11:"image_width";s:2:"19";s:11:"imageset_id";s:1:"3";}i:16;a:7:{s:8:"image_id";s:3:"176";s:10:"image_name";s:19:"topic_read_hot_mine";s:14:"image_filename";s:23:"topic_read_hot_mine.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"18";s:11:"image_width";s:2:"19";s:11:"imageset_id";s:1:"3";}i:17;a:7:{s:8:"image_id";s:3:"177";s:10:"image_name";s:17:"topic_read_locked";s:14:"image_filename";s:21:"topic_read_locked.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"18";s:11:"image_width";s:2:"19";s:11:"imageset_id";s:1:"3";}i:18;a:7:{s:8:"image_id";s:3:"178";s:10:"image_name";s:22:"topic_read_locked_mine";s:14:"image_filename";s:26:"topic_read_locked_mine.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"18";s:11:"image_width";s:2:"19";s:11:"imageset_id";s:1:"3";}i:19;a:7:{s:8:"image_id";s:3:"179";s:10:"image_name";s:12:"topic_unread";s:14:"image_filename";s:16:"topic_unread.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"18";s:11:"image_width";s:2:"19";s:11:"imageset_id";s:1:"3";}i:20;a:7:{s:8:"image_id";s:3:"180";s:10:"image_name";s:17:"topic_unread_mine";s:14:"image_filename";s:21:"topic_unread_mine.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"18";s:11:"image_width";s:2:"19";s:11:"imageset_id";s:1:"3";}i:21;a:7:{s:8:"image_id";s:3:"181";s:10:"image_name";s:16:"topic_unread_hot";s:14:"image_filename";s:20:"topic_unread_hot.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"18";s:11:"image_width";s:2:"19";s:11:"imageset_id";s:1:"3";}i:22;a:7:{s:8:"image_id";s:3:"182";s:10:"image_name";s:21:"topic_unread_hot_mine";s:14:"image_filename";s:25:"topic_unread_hot_mine.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"18";s:11:"image_width";s:2:"19";s:11:"imageset_id";s:1:"3";}i:23;a:7:{s:8:"image_id";s:3:"183";s:10:"image_name";s:19:"topic_unread_locked";s:14:"image_filename";s:23:"topic_unread_locked.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"18";s:11:"image_width";s:2:"19";s:11:"imageset_id";s:1:"3";}i:24;a:7:{s:8:"image_id";s:3:"184";s:10:"image_name";s:24:"topic_unread_locked_mine";s:14:"image_filename";s:28:"topic_unread_locked_mine.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"18";s:11:"image_width";s:2:"19";s:11:"imageset_id";s:1:"3";}i:25;a:7:{s:8:"image_id";s:3:"185";s:10:"image_name";s:11:"sticky_read";s:14:"image_filename";s:15:"sticky_read.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"18";s:11:"image_width";s:2:"19";s:11:"imageset_id";s:1:"3";}i:26;a:7:{s:8:"image_id";s:3:"186";s:10:"image_name";s:16:"sticky_read_mine";s:14:"image_filename";s:20:"sticky_read_mine.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"18";s:11:"image_width";s:2:"19";s:11:"imageset_id";s:1:"3";}i:27;a:7:{s:8:"image_id";s:3:"187";s:10:"image_name";s:18:"sticky_read_locked";s:14:"image_filename";s:22:"sticky_read_locked.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"18";s:11:"image_width";s:2:"19";s:11:"imageset_id";s:1:"3";}i:28;a:7:{s:8:"image_id";s:3:"188";s:10:"image_name";s:23:"sticky_read_locked_mine";s:14:"image_filename";s:27:"sticky_read_locked_mine.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"18";s:11:"image_width";s:2:"19";s:11:"imageset_id";s:1:"3";}i:29;a:7:{s:8:"image_id";s:3:"189";s:10:"image_name";s:13:"sticky_unread";s:14:"image_filename";s:17:"sticky_unread.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"18";s:11:"image_width";s:2:"19";s:11:"imageset_id";s:1:"3";}i:30;a:7:{s:8:"image_id";s:3:"190";s:10:"image_name";s:18:"sticky_unread_mine";s:14:"image_filename";s:22:"sticky_unread_mine.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"18";s:11:"image_width";s:2:"19";s:11:"imageset_id";s:1:"3";}i:31;a:7:{s:8:"image_id";s:3:"191";s:10:"image_name";s:20:"sticky_unread_locked";s:14:"image_filename";s:24:"sticky_unread_locked.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"18";s:11:"image_width";s:2:"19";s:11:"imageset_id";s:1:"3";}i:32;a:7:{s:8:"image_id";s:3:"192";s:10:"image_name";s:25:"sticky_unread_locked_mine";s:14:"image_filename";s:29:"sticky_unread_locked_mine.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"18";s:11:"image_width";s:2:"19";s:11:"imageset_id";s:1:"3";}i:33;a:7:{s:8:"image_id";s:3:"193";s:10:"image_name";s:13:"announce_read";s:14:"image_filename";s:17:"announce_read.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"18";s:11:"image_width";s:2:"19";s:11:"imageset_id";s:1:"3";}i:34;a:7:{s:8:"image_id";s:3:"194";s:10:"image_name";s:18:"announce_read_mine";s:14:"image_filename";s:22:"announce_read_mine.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"18";s:11:"image_width";s:2:"19";s:11:"imageset_id";s:1:"3";}i:35;a:7:{s:8:"image_id";s:3:"195";s:10:"image_name";s:20:"announce_read_locked";s:14:"image_filename";s:24:"announce_read_locked.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"18";s:11:"image_width";s:2:"19";s:11:"imageset_id";s:1:"3";}i:36;a:7:{s:8:"image_id";s:3:"196";s:10:"image_name";s:25:"announce_read_locked_mine";s:14:"image_filename";s:29:"announce_read_locked_mine.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"18";s:11:"image_width";s:2:"19";s:11:"imageset_id";s:1:"3";}i:37;a:7:{s:8:"image_id";s:3:"197";s:10:"image_name";s:15:"announce_unread";s:14:"image_filename";s:19:"announce_unread.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"18";s:11:"image_width";s:2:"19";s:11:"imageset_id";s:1:"3";}i:38;a:7:{s:8:"image_id";s:3:"198";s:10:"image_name";s:20:"announce_unread_mine";s:14:"image_filename";s:24:"announce_unread_mine.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"18";s:11:"image_width";s:2:"19";s:11:"imageset_id";s:1:"3";}i:39;a:7:{s:8:"image_id";s:3:"199";s:10:"image_name";s:22:"announce_unread_locked";s:14:"image_filename";s:26:"announce_unread_locked.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"18";s:11:"image_width";s:2:"19";s:11:"imageset_id";s:1:"3";}i:40;a:7:{s:8:"image_id";s:3:"200";s:10:"image_name";s:27:"announce_unread_locked_mine";s:14:"image_filename";s:31:"announce_unread_locked_mine.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"18";s:11:"image_width";s:2:"19";s:11:"imageset_id";s:1:"3";}i:41;a:7:{s:8:"image_id";s:3:"201";s:10:"image_name";s:11:"global_read";s:14:"image_filename";s:17:"announce_read.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"18";s:11:"image_width";s:2:"19";s:11:"imageset_id";s:1:"3";}i:42;a:7:{s:8:"image_id";s:3:"202";s:10:"image_name";s:16:"global_read_mine";s:14:"image_filename";s:22:"announce_read_mine.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"18";s:11:"image_width";s:2:"19";s:11:"imageset_id";s:1:"3";}i:43;a:7:{s:8:"image_id";s:3:"203";s:10:"image_name";s:18:"global_read_locked";s:14:"image_filename";s:24:"announce_read_locked.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"18";s:11:"image_width";s:2:"19";s:11:"imageset_id";s:1:"3";}i:44;a:7:{s:8:"image_id";s:3:"204";s:10:"image_name";s:23:"global_read_locked_mine";s:14:"image_filename";s:29:"announce_read_locked_mine.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"18";s:11:"image_width";s:2:"19";s:11:"imageset_id";s:1:"3";}i:45;a:7:{s:8:"image_id";s:3:"205";s:10:"image_name";s:13:"global_unread";s:14:"image_filename";s:19:"announce_unread.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"18";s:11:"image_width";s:2:"19";s:11:"imageset_id";s:1:"3";}i:46;a:7:{s:8:"image_id";s:3:"206";s:10:"image_name";s:18:"global_unread_mine";s:14:"image_filename";s:24:"announce_unread_mine.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"18";s:11:"image_width";s:2:"19";s:11:"imageset_id";s:1:"3";}i:47;a:7:{s:8:"image_id";s:3:"207";s:10:"image_name";s:20:"global_unread_locked";s:14:"image_filename";s:26:"announce_unread_locked.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"18";s:11:"image_width";s:2:"19";s:11:"imageset_id";s:1:"3";}i:48;a:7:{s:8:"image_id";s:3:"208";s:10:"image_name";s:25:"global_unread_locked_mine";s:14:"image_filename";s:31:"announce_unread_locked_mine.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"18";s:11:"image_width";s:2:"19";s:11:"imageset_id";s:1:"3";}i:49;a:7:{s:8:"image_id";s:3:"209";s:10:"image_name";s:7:"pm_read";s:14:"image_filename";s:14:"topic_read.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"18";s:11:"image_width";s:2:"19";s:11:"imageset_id";s:1:"3";}i:50;a:7:{s:8:"image_id";s:3:"210";s:10:"image_name";s:9:"pm_unread";s:14:"image_filename";s:16:"topic_unread.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"18";s:11:"image_width";s:2:"19";s:11:"imageset_id";s:1:"3";}i:51;a:7:{s:8:"image_id";s:3:"211";s:10:"image_name";s:16:"icon_post_target";s:14:"image_filename";s:20:"icon_post_target.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:1:"9";s:11:"image_width";s:2:"12";s:11:"imageset_id";s:1:"3";}i:52;a:7:{s:8:"image_id";s:3:"212";s:10:"image_name";s:23:"icon_post_target_unread";s:14:"image_filename";s:27:"icon_post_target_unread.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:1:"9";s:11:"image_width";s:2:"12";s:11:"imageset_id";s:1:"3";}i:53;a:7:{s:8:"image_id";s:3:"213";s:10:"image_name";s:17:"icon_topic_attach";s:14:"image_filename";s:21:"icon_topic_attach.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"18";s:11:"image_width";s:2:"14";s:11:"imageset_id";s:1:"3";}i:54;a:7:{s:8:"image_id";s:3:"214";s:10:"image_name";s:17:"icon_topic_latest";s:14:"image_filename";s:21:"icon_topic_latest.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:1:"9";s:11:"image_width";s:2:"18";s:11:"imageset_id";s:1:"3";}i:55;a:7:{s:8:"image_id";s:3:"215";s:10:"image_name";s:17:"icon_topic_newest";s:14:"image_filename";s:21:"icon_topic_newest.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:1:"9";s:11:"image_width";s:2:"18";s:11:"imageset_id";s:1:"3";}i:56;a:7:{s:8:"image_id";s:3:"216";s:10:"image_name";s:19:"icon_topic_reported";s:14:"image_filename";s:23:"icon_topic_reported.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"18";s:11:"image_width";s:2:"19";s:11:"imageset_id";s:1:"3";}i:57;a:7:{s:8:"image_id";s:3:"217";s:10:"image_name";s:21:"icon_topic_unapproved";s:14:"image_filename";s:25:"icon_topic_unapproved.gif";s:10:"image_lang";s:0:"";s:12:"image_height";s:2:"18";s:11:"image_width";s:2:"19";s:11:"imageset_id";s:1:"3";}i:58;a:7:{s:8:"image_id";s:3:"218";s:10:"image_name";s:16:"icon_contact_aim";s:14:"image_filename";s:20:"icon_contact_aim.gif";s:10:"image_lang";s:2:"en";s:12:"image_height";s:1:"0";s:11:"image_width";s:1:"0";s:11:"imageset_id";s:1:"3";}i:59;a:7:{s:8:"image_id";s:3:"219";s:10:"image_name";s:18:"icon_contact_email";s:14:"image_filename";s:22:"icon_contact_email.gif";s:10:"image_lang";s:2:"en";s:12:"image_height";s:1:"0";s:11:"image_width";s:1:"0";s:11:"imageset_id";s:1:"3";}i:60;a:7:{s:8:"image_id";s:3:"220";s:10:"image_name";s:16:"icon_contact_icq";s:14:"image_filename";s:20:"icon_contact_icq.gif";s:10:"image_lang";s:2:"en";s:12:"image_height";s:1:"0";s:11:"image_width";s:1:"0";s:11:"imageset_id";s:1:"3";}i:61;a:7:{s:8:"image_id";s:3:"221";s:10:"image_name";s:19:"icon_contact_jabber";s:14:"image_filename";s:23:"icon_contact_jabber.gif";s:10:"image_lang";s:2:"en";s:12:"image_height";s:1:"0";s:11:"image_width";s:1:"0";s:11:"imageset_id";s:1:"3";}i:62;a:7:{s:8:"image_id";s:3:"222";s:10:"image_name";s:17:"icon_contact_msnm";s:14:"image_filename";s:21:"icon_contact_msnm.gif";s:10:"image_lang";s:2:"en";s:12:"image_height";s:1:"0";s:11:"image_width";s:1:"0";s:11:"imageset_id";s:1:"3";}i:63;a:7:{s:8:"image_id";s:3:"223";s:10:"image_name";s:15:"icon_contact_pm";s:14:"image_filename";s:19:"icon_contact_pm.gif";s:10:"image_lang";s:2:"en";s:12:"image_height";s:1:"0";s:11:"image_width";s:1:"0";s:11:"imageset_id";s:1:"3";}i:64;a:7:{s:8:"image_id";s:3:"224";s:10:"image_name";s:18:"icon_contact_yahoo";s:14:"image_filename";s:22:"icon_contact_yahoo.gif";s:10:"image_lang";s:2:"en";s:12:"image_height";s:1:"0";s:11:"image_width";s:1:"0";s:11:"imageset_id";s:1:"3";}i:65;a:7:{s:8:"image_id";s:3:"225";s:10:"image_name";s:16:"icon_contact_www";s:14:"image_filename";s:20:"icon_contact_www.gif";s:10:"image_lang";s:2:"en";s:12:"image_height";s:1:"0";s:11:"image_width";s:1:"0";s:11:"imageset_id";s:1:"3";}i:66;a:7:{s:8:"image_id";s:3:"226";s:10:"image_name";s:16:"icon_post_delete";s:14:"image_filename";s:20:"icon_post_delete.gif";s:10:"image_lang";s:2:"en";s:12:"image_height";s:1:"0";s:11:"image_width";s:1:"0";s:11:"imageset_id";s:1:"3";}i:67;a:7:{s:8:"image_id";s:3:"227";s:10:"image_name";s:14:"icon_post_edit";s:14:"image_filename";s:18:"icon_post_edit.gif";s:10:"image_lang";s:2:"en";s:12:"image_height";s:1:"0";s:11:"image_width";s:1:"0";s:11:"imageset_id";s:1:"3";}i:68;a:7:{s:8:"image_id";s:3:"228";s:10:"image_name";s:14:"icon_post_info";s:14:"image_filename";s:18:"icon_post_info.gif";s:10:"image_lang";s:2:"en";s:12:"image_height";s:1:"0";s:11:"image_width";s:1:"0";s:11:"imageset_id";s:1:"3";}i:69;a:7:{s:8:"image_id";s:3:"229";s:10:"image_name";s:15:"icon_post_quote";s:14:"image_filename";s:19:"icon_post_quote.gif";s:10:"image_lang";s:2:"en";s:12:"image_height";s:1:"0";s:11:"image_width";s:1:"0";s:11:"imageset_id";s:1:"3";}i:70;a:7:{s:8:"image_id";s:3:"230";s:10:"image_name";s:16:"icon_post_report";s:14:"image_filename";s:20:"icon_post_report.gif";s:10:"image_lang";s:2:"en";s:12:"image_height";s:1:"0";s:11:"image_width";s:1:"0";s:11:"imageset_id";s:1:"3";}i:71;a:7:{s:8:"image_id";s:3:"231";s:10:"image_name";s:16:"icon_user_online";s:14:"image_filename";s:20:"icon_user_online.gif";s:10:"image_lang";s:2:"en";s:12:"image_height";s:1:"0";s:11:"image_width";s:1:"0";s:11:"imageset_id";s:1:"3";}i:72;a:7:{s:8:"image_id";s:3:"232";s:10:"image_name";s:17:"icon_user_offline";s:14:"image_filename";s:21:"icon_user_offline.gif";s:10:"image_lang";s:2:"en";s:12:"image_height";s:1:"0";s:11:"image_width";s:1:"0";s:11:"imageset_id";s:1:"3";}i:73;a:7:{s:8:"image_id";s:3:"233";s:10:"image_name";s:17:"icon_user_profile";s:14:"image_filename";s:21:"icon_user_profile.gif";s:10:"image_lang";s:2:"en";s:12:"image_height";s:1:"0";s:11:"image_width";s:1:"0";s:11:"imageset_id";s:1:"3";}i:74;a:7:{s:8:"image_id";s:3:"234";s:10:"image_name";s:16:"icon_user_search";s:14:"image_filename";s:20:"icon_user_search.gif";s:10:"image_lang";s:2:"en";s:12:"image_height";s:1:"0";s:11:"image_width";s:1:"0";s:11:"imageset_id";s:1:"3";}i:75;a:7:{s:8:"image_id";s:3:"235";s:10:"image_name";s:14:"icon_user_warn";s:14:"image_filename";s:18:"icon_user_warn.gif";s:10:"image_lang";s:2:"en";s:12:"image_height";s:1:"0";s:11:"image_width";s:1:"0";s:11:"imageset_id";s:1:"3";}i:76;a:7:{s:8:"image_id";s:3:"236";s:10:"image_name";s:13:"button_pm_new";s:14:"image_filename";s:17:"button_pm_new.gif";s:10:"image_lang";s:2:"en";s:12:"image_height";s:1:"0";s:11:"image_width";s:1:"0";s:11:"imageset_id";s:1:"3";}i:77;a:7:{s:8:"image_id";s:3:"237";s:10:"image_name";s:15:"button_pm_reply";s:14:"image_filename";s:19:"button_pm_reply.gif";s:10:"image_lang";s:2:"en";s:12:"image_height";s:1:"0";s:11:"image_width";s:1:"0";s:11:"imageset_id";s:1:"3";}i:78;a:7:{s:8:"image_id";s:3:"238";s:10:"image_name";s:19:"button_topic_locked";s:14:"image_filename";s:23:"button_topic_locked.gif";s:10:"image_lang";s:2:"en";s:12:"image_height";s:1:"0";s:11:"image_width";s:1:"0";s:11:"imageset_id";s:1:"3";}i:79;a:7:{s:8:"image_id";s:3:"239";s:10:"image_name";s:16:"button_topic_new";s:14:"image_filename";s:20:"button_topic_new.gif";s:10:"image_lang";s:2:"en";s:12:"image_height";s:1:"0";s:11:"image_width";s:1:"0";s:11:"imageset_id";s:1:"3";}i:80;a:7:{s:8:"image_id";s:3:"240";s:10:"image_name";s:18:"button_topic_reply";s:14:"image_filename";s:22:"button_topic_reply.gif";s:10:"image_lang";s:2:"en";s:12:"image_height";s:1:"0";s:11:"image_width";s:1:"0";s:11:"imageset_id";s:1:"3";}}
\ No newline at end of file
diff -ruN phpBB-3.0.10/cache/sql_fc4b71d53473131c2560c45dc20b75a3.php phpbb/cache/sql_fc4b71d53473131c2560c45dc20b75a3.php
--- phpBB-3.0.10/cache/sql_fc4b71d53473131c2560c45dc20b75a3.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/cache/sql_fc4b71d53473131c2560c45dc20b75a3.php	2014-04-15 15:00:22.824414281 +0200
@@ -0,0 +1,5 @@
+<?php exit; ?>
+1397570422
+SELECT s.style_id, t.template_storedb, t.template_path, t.template_id, t.bbcode_bitfield, t.template_inherits_id, t.template_inherit_path, c.theme_path, c.theme_name, c.theme_storedb, c.theme_id, i.imageset_path, i.imageset_id, i.imageset_name FROM phpbb3_styles s, phpbb3_styles_template t, phpbb3_styles_theme c, phpbb3_styles_imageset i WHERE s.style_id = 5 AND t.template_id = s.template_id AND c.theme_id = s.theme_id AND i.imageset_id = s.imageset_id
+470
+a:1:{i:0;a:14:{s:8:"style_id";s:1:"5";s:16:"template_storedb";s:1:"0";s:13:"template_path";s:6:"spring";s:11:"template_id";s:1:"4";s:15:"bbcode_bitfield";s:4:"kNg=";s:20:"template_inherits_id";s:1:"0";s:21:"template_inherit_path";s:0:"";s:10:"theme_path";s:6:"spring";s:10:"theme_name";s:16:"subsilver2spring";s:13:"theme_storedb";s:1:"0";s:8:"theme_id";s:1:"4";s:13:"imageset_path";s:6:"spring";s:11:"imageset_id";s:1:"3";s:13:"imageset_name";s:16:"subsilver2spring";}}
\ No newline at end of file
diff -ruN phpBB-3.0.10/cache/tpl_spring_breadcrumbs.html.php phpbb/cache/tpl_spring_breadcrumbs.html.php
--- phpBB-3.0.10/cache/tpl_spring_breadcrumbs.html.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/cache/tpl_spring_breadcrumbs.html.php	2014-04-15 15:00:22.926414280 +0200
@@ -0,0 +1,8 @@
+<?php if (!defined('IN_PHPBB')) exit; ?><table class="tablebg" width="100%" cellspacing="1" cellpadding="0" style="margin-top: 0px;">
+	<tr>
+		<td class="row1">
+			<p class="breadcrumbs"><a href="<?php echo (isset($this->_rootref['U_INDEX'])) ? $this->_rootref['U_INDEX'] : ''; ?>"><?php echo ((isset($this->_rootref['L_INDEX'])) ? $this->_rootref['L_INDEX'] : ((isset($user->lang['INDEX'])) ? $user->lang['INDEX'] : '{ INDEX }')); ?></a><?php $_navlinks_count = (isset($this->_tpldata['navlinks'])) ? sizeof($this->_tpldata['navlinks']) : 0;if ($_navlinks_count) {for ($_navlinks_i = 0; $_navlinks_i < $_navlinks_count; ++$_navlinks_i){$_navlinks_val = &$this->_tpldata['navlinks'][$_navlinks_i]; ?> &#187; <a href="<?php echo $_navlinks_val['U_VIEW_FORUM']; ?>"><?php echo $_navlinks_val['FORUM_NAME']; ?></a><?php }} ?></p>
+			<p class="datetime"><?php echo (isset($this->_rootref['S_TIMEZONE'])) ? $this->_rootref['S_TIMEZONE'] : ''; ?></p>
+		</td>
+	</tr>
+	</table>
\ No newline at end of file
diff -ruN phpBB-3.0.10/cache/tpl_spring_captcha_default.html.php phpbb/cache/tpl_spring_captcha_default.html.php
--- phpBB-3.0.10/cache/tpl_spring_captcha_default.html.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/cache/tpl_spring_captcha_default.html.php	2014-04-15 15:02:30.037413207 +0200
@@ -0,0 +1,18 @@
+<?php if (!defined('IN_PHPBB')) exit; ?><tr>
+		<th colspan="2" valign="middle"><?php echo ((isset($this->_rootref['L_CONFIRM_CODE'])) ? $this->_rootref['L_CONFIRM_CODE'] : ((isset($user->lang['CONFIRM_CODE'])) ? $user->lang['CONFIRM_CODE'] : '{ CONFIRM_CODE }')); ?></th>
+	</tr>
+	<?php if ($this->_rootref['S_TYPE'] == (1)) {  ?>
+
+	<tr>
+		<td class="row3" colspan="2"><span class="gensmall"><?php echo ((isset($this->_rootref['L_CONFIRM_EXPLAIN'])) ? $this->_rootref['L_CONFIRM_EXPLAIN'] : ((isset($user->lang['CONFIRM_EXPLAIN'])) ? $user->lang['CONFIRM_EXPLAIN'] : '{ CONFIRM_EXPLAIN }')); ?></span></td>
+	</tr>
+	<?php } ?>	
+	<tr>
+		<td class="row1" colspan="2" align="center"><img src="<?php echo (isset($this->_rootref['CONFIRM_IMAGE_LINK'])) ? $this->_rootref['CONFIRM_IMAGE_LINK'] : ''; ?>" alt="<?php echo ((isset($this->_rootref['L_CONFIRM_CODE'])) ? $this->_rootref['L_CONFIRM_CODE'] : ((isset($user->lang['CONFIRM_CODE'])) ? $user->lang['CONFIRM_CODE'] : '{ CONFIRM_CODE }')); ?>" />
+		<input type="hidden" name="confirm_id" id="confirm_id" value="<?php echo (isset($this->_rootref['CONFIRM_ID'])) ? $this->_rootref['CONFIRM_ID'] : ''; ?>" /></td>
+	</tr>
+	<tr>
+		<td class="row1"><b class="genmed"><?php echo ((isset($this->_rootref['L_CONFIRM_CODE'])) ? $this->_rootref['L_CONFIRM_CODE'] : ((isset($user->lang['CONFIRM_CODE'])) ? $user->lang['CONFIRM_CODE'] : '{ CONFIRM_CODE }')); ?>:</b><br /><span class="gensmall"><?php echo ((isset($this->_rootref['L_CONFIRM_CODE_EXPLAIN'])) ? $this->_rootref['L_CONFIRM_CODE_EXPLAIN'] : ((isset($user->lang['CONFIRM_CODE_EXPLAIN'])) ? $user->lang['CONFIRM_CODE_EXPLAIN'] : '{ CONFIRM_CODE_EXPLAIN }')); ?></span></td>
+		<td class="row2"><input class="post" type="text" name="confirm_code" size="8" maxlength="8" />
+		<?php if ($this->_rootref['S_CONFIRM_REFRESH']) {  ?><input type="submit" name="refresh_vc" id="refresh_vc" class="btnlite" value="<?php echo ((isset($this->_rootref['L_VC_REFRESH'])) ? $this->_rootref['L_VC_REFRESH'] : ((isset($user->lang['VC_REFRESH'])) ? $user->lang['VC_REFRESH'] : '{ VC_REFRESH }')); ?>" /><?php } ?></td>
+	</tr>
\ No newline at end of file
diff -ruN phpBB-3.0.10/cache/tpl_spring_forumlist_body.html.php phpbb/cache/tpl_spring_forumlist_body.html.php
--- phpBB-3.0.10/cache/tpl_spring_forumlist_body.html.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/cache/tpl_spring_forumlist_body.html.php	2014-04-15 15:00:22.936414280 +0200
@@ -0,0 +1,91 @@
+<?php if (!defined('IN_PHPBB')) exit; ?><table class="tablebg" cellspacing="1" width="100%">
+<tr>
+	<td class="cat" colspan="5" align="<?php echo (isset($this->_rootref['S_CONTENT_FLOW_END'])) ? $this->_rootref['S_CONTENT_FLOW_END'] : ''; ?>"><?php if (! $this->_rootref['S_IS_BOT'] && $this->_rootref['U_MARK_FORUMS']) {  ?><a class="nav" href="<?php echo (isset($this->_rootref['U_MARK_FORUMS'])) ? $this->_rootref['U_MARK_FORUMS'] : ''; ?>"><?php echo ((isset($this->_rootref['L_MARK_FORUMS_READ'])) ? $this->_rootref['L_MARK_FORUMS_READ'] : ((isset($user->lang['MARK_FORUMS_READ'])) ? $user->lang['MARK_FORUMS_READ'] : '{ MARK_FORUMS_READ }')); ?></a><?php } ?>&nbsp;</td>
+</tr>
+<tr>
+	<th colspan="2">&nbsp;<?php echo ((isset($this->_rootref['L_FORUM'])) ? $this->_rootref['L_FORUM'] : ((isset($user->lang['FORUM'])) ? $user->lang['FORUM'] : '{ FORUM }')); ?>&nbsp;</th>
+	<th width="50">&nbsp;<?php echo ((isset($this->_rootref['L_TOPICS'])) ? $this->_rootref['L_TOPICS'] : ((isset($user->lang['TOPICS'])) ? $user->lang['TOPICS'] : '{ TOPICS }')); ?>&nbsp;</th>
+	<th width="50">&nbsp;<?php echo ((isset($this->_rootref['L_POSTS'])) ? $this->_rootref['L_POSTS'] : ((isset($user->lang['POSTS'])) ? $user->lang['POSTS'] : '{ POSTS }')); ?>&nbsp;</th>
+	<th>&nbsp;<?php echo ((isset($this->_rootref['L_LAST_POST'])) ? $this->_rootref['L_LAST_POST'] : ((isset($user->lang['LAST_POST'])) ? $user->lang['LAST_POST'] : '{ LAST_POST }')); ?>&nbsp;</th>
+</tr>
+<?php $_forumrow_count = (isset($this->_tpldata['forumrow'])) ? sizeof($this->_tpldata['forumrow']) : 0;if ($_forumrow_count) {for ($_forumrow_i = 0; $_forumrow_i < $_forumrow_count; ++$_forumrow_i){$_forumrow_val = &$this->_tpldata['forumrow'][$_forumrow_i]; if ($_forumrow_val['S_IS_CAT']) {  ?>
+
+		<tr>
+			<td class="cat" colspan="2"><h4><a href="<?php echo $_forumrow_val['U_VIEWFORUM']; ?>"><?php echo $_forumrow_val['FORUM_NAME']; ?></a></h4></td>
+			<td class="catdiv" colspan="3">&nbsp;</td>
+		</tr>
+	<?php } else if ($_forumrow_val['S_IS_LINK']) {  ?>
+
+		<tr>
+			<td class="row1" width="50" align="center"><?php echo $_forumrow_val['FORUM_FOLDER_IMG']; ?></td>
+			<td class="row1">
+				<?php if ($_forumrow_val['FORUM_IMAGE']) {  ?>
+
+					<div style="float: <?php echo (isset($this->_rootref['S_CONTENT_FLOW_BEGIN'])) ? $this->_rootref['S_CONTENT_FLOW_BEGIN'] : ''; ?>; margin-<?php echo (isset($this->_rootref['S_CONTENT_FLOW_END'])) ? $this->_rootref['S_CONTENT_FLOW_END'] : ''; ?>: 5px;"><?php echo $_forumrow_val['FORUM_IMAGE']; ?></div>
+				<?php } ?>
+
+				<a class="forumlink" href="<?php echo $_forumrow_val['U_VIEWFORUM']; ?>"><?php echo $_forumrow_val['FORUM_NAME']; ?></a>
+				<p class="forumdesc"><?php echo $_forumrow_val['FORUM_DESC']; ?></p>
+			</td>
+			<?php if ($_forumrow_val['CLICKS']) {  ?>
+
+				<td class="row2" colspan="3" align="center"><span class="genmed"><?php echo ((isset($this->_rootref['L_REDIRECTS'])) ? $this->_rootref['L_REDIRECTS'] : ((isset($user->lang['REDIRECTS'])) ? $user->lang['REDIRECTS'] : '{ REDIRECTS }')); ?>: <?php echo $_forumrow_val['CLICKS']; ?></span></td>
+			<?php } else { ?>
+
+				<td class="row2" colspan="3" align="center">&nbsp;</td>
+			<?php } ?>
+
+		</tr>
+	<?php } else { if ($_forumrow_val['S_NO_CAT']) {  ?>
+
+			<tr>
+				<td class="cat" colspan="2"><h4><?php echo ((isset($this->_rootref['L_FORUM'])) ? $this->_rootref['L_FORUM'] : ((isset($user->lang['FORUM'])) ? $user->lang['FORUM'] : '{ FORUM }')); ?></h4></td>
+				<td class="catdiv" colspan="3">&nbsp;</td>
+			</tr>
+		<?php } ?>
+
+		<tr>
+			<td class="row1" width="50" align="center"><?php echo $_forumrow_val['FORUM_FOLDER_IMG']; ?></td>
+			<td class="row1" width="100%">
+				<?php if ($_forumrow_val['FORUM_IMAGE']) {  ?>
+
+					<div style="float: <?php echo (isset($this->_rootref['S_CONTENT_FLOW_BEGIN'])) ? $this->_rootref['S_CONTENT_FLOW_BEGIN'] : ''; ?>; margin-<?php echo (isset($this->_rootref['S_CONTENT_FLOW_END'])) ? $this->_rootref['S_CONTENT_FLOW_END'] : ''; ?>: 5px;"><?php echo $_forumrow_val['FORUM_IMAGE']; ?></div>
+				<?php } ?>
+
+				<a class="forumlink" href="<?php echo $_forumrow_val['U_VIEWFORUM']; ?>"><?php echo $_forumrow_val['FORUM_NAME']; ?></a>
+				<p class="forumdesc"><?php echo $_forumrow_val['FORUM_DESC']; ?></p>
+				<?php if ($_forumrow_val['MODERATORS']) {  ?>
+
+					<!-- <p class="forumdesc"><strong><?php echo $_forumrow_val['L_MODERATOR_STR']; ?>:</strong> <?php echo $_forumrow_val['MODERATORS']; ?></p> -->
+				<?php } if ($_forumrow_val['SUBFORUMS'] && $_forumrow_val['S_LIST_SUBFORUMS']) {  ?>
+
+					<p class="forumdesc"><strong><?php echo $_forumrow_val['L_SUBFORUM_STR']; ?></strong> <?php echo $_forumrow_val['SUBFORUMS']; ?></p>
+				<?php } ?>
+
+			</td>
+			<td class="row2" align="center"><p class="topicdetails"><?php echo $_forumrow_val['TOPICS']; ?></p></td>
+			<td class="row2" align="center"><p class="topicdetails"><?php echo $_forumrow_val['POSTS']; ?></p></td>
+			<td class="row2" align="center" nowrap="nowrap">
+				<?php if ($_forumrow_val['LAST_POST_TIME']) {  ?>
+
+					<p class="topicdetails"><?php if ($_forumrow_val['U_UNAPPROVED_TOPICS']) {  ?><a href="<?php echo $_forumrow_val['U_UNAPPROVED_TOPICS']; ?>"><?php echo (isset($this->_rootref['UNAPPROVED_IMG'])) ? $this->_rootref['UNAPPROVED_IMG'] : ''; ?></a>&nbsp;<?php } echo $_forumrow_val['LAST_POST_TIME']; ?></p>
+					<p class="topicdetails"><?php echo $_forumrow_val['LAST_POSTER_FULL']; ?>
+
+						<?php if (! $this->_rootref['S_IS_BOT']) {  ?><a href="<?php echo $_forumrow_val['U_LAST_POST']; ?>"><?php echo (isset($this->_rootref['LAST_POST_IMG'])) ? $this->_rootref['LAST_POST_IMG'] : ''; ?></a><?php } ?>
+
+					</p>
+				<?php } else { ?>
+
+					<p class="topicdetails"><?php echo ((isset($this->_rootref['L_NO_POSTS'])) ? $this->_rootref['L_NO_POSTS'] : ((isset($user->lang['NO_POSTS'])) ? $user->lang['NO_POSTS'] : '{ NO_POSTS }')); ?></p>
+				<?php } ?>
+
+			</td>
+		</tr>
+	<?php } }} else { ?>
+
+	<tr>
+		<td class="row1" colspan="5" align="center"><p class="gensmall"><?php echo ((isset($this->_rootref['L_NO_FORUMS'])) ? $this->_rootref['L_NO_FORUMS'] : ((isset($user->lang['NO_FORUMS'])) ? $user->lang['NO_FORUMS'] : '{ NO_FORUMS }')); ?></p></td>
+	</tr>
+<?php } ?>
+
+</table>
\ No newline at end of file
diff -ruN phpBB-3.0.10/cache/tpl_spring_index_body.html.php phpbb/cache/tpl_spring_index_body.html.php
--- phpBB-3.0.10/cache/tpl_spring_index_body.html.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/cache/tpl_spring_index_body.html.php	2014-04-15 15:00:22.943414280 +0200
@@ -0,0 +1,108 @@
+<?php if (!defined('IN_PHPBB')) exit; $this->_tpl_include('overall_header.html'); if ($this->_rootref['U_MCP']) {  ?>
+
+	<div id="pageheader">
+		<p class="linkmcp">[ <a href="<?php echo (isset($this->_rootref['U_MCP'])) ? $this->_rootref['U_MCP'] : ''; ?>"><?php echo ((isset($this->_rootref['L_MCP'])) ? $this->_rootref['L_MCP'] : ((isset($user->lang['MCP'])) ? $user->lang['MCP'] : '{ MCP }')); ?></a> ]</p>
+	</div>
+
+	<br clear="all" /><br />
+<?php } $this->_tpl_include('forumlist_body.html'); if (! $this->_rootref['S_IS_BOT'] || $this->_rootref['U_TEAM']) {  ?>
+
+<span class="gensmall"><?php if (! $this->_rootref['S_IS_BOT']) {  ?><a href="<?php echo (isset($this->_rootref['U_DELETE_COOKIES'])) ? $this->_rootref['U_DELETE_COOKIES'] : ''; ?>"><?php echo ((isset($this->_rootref['L_DELETE_COOKIES'])) ? $this->_rootref['L_DELETE_COOKIES'] : ((isset($user->lang['DELETE_COOKIES'])) ? $user->lang['DELETE_COOKIES'] : '{ DELETE_COOKIES }')); ?></a><?php } if (! $this->_rootref['S_IS_BOT'] && $this->_rootref['U_TEAM']) {  ?> | <?php } if ($this->_rootref['U_TEAM']) {  ?><a href="<?php echo (isset($this->_rootref['U_TEAM'])) ? $this->_rootref['U_TEAM'] : ''; ?>"><?php echo ((isset($this->_rootref['L_THE_TEAM'])) ? $this->_rootref['L_THE_TEAM'] : ((isset($user->lang['THE_TEAM'])) ? $user->lang['THE_TEAM'] : '{ THE_TEAM }')); ?></a><?php } ?></span><br />
+<?php } ?>
+
+
+<br clear="all" />
+
+<?php $this->_tpl_include('breadcrumbs.html'); if ($this->_rootref['S_DISPLAY_ONLINE_LIST']) {  ?>
+
+	<br clear="all" />
+
+	<table class="tablebg" width="100%" cellspacing="1">
+	<tr>
+		<td class="cat" colspan="2"><?php if ($this->_rootref['U_VIEWONLINE']) {  ?><h4><a href="<?php echo (isset($this->_rootref['U_VIEWONLINE'])) ? $this->_rootref['U_VIEWONLINE'] : ''; ?>"><?php echo ((isset($this->_rootref['L_WHO_IS_ONLINE'])) ? $this->_rootref['L_WHO_IS_ONLINE'] : ((isset($user->lang['WHO_IS_ONLINE'])) ? $user->lang['WHO_IS_ONLINE'] : '{ WHO_IS_ONLINE }')); ?></a></h4><?php } else { ?><h4><?php echo ((isset($this->_rootref['L_WHO_IS_ONLINE'])) ? $this->_rootref['L_WHO_IS_ONLINE'] : ((isset($user->lang['WHO_IS_ONLINE'])) ? $user->lang['WHO_IS_ONLINE'] : '{ WHO_IS_ONLINE }')); ?></h4><?php } ?></td>
+	</tr>
+	<tr>
+	<?php if ($this->_rootref['LEGEND']) {  ?>
+
+		<td class="row1" rowspan="2" align="center" valign="middle"><img src="<?php echo (isset($this->_rootref['T_THEME_PATH'])) ? $this->_rootref['T_THEME_PATH'] : ''; ?>/images/whosonline.gif" alt="<?php echo ((isset($this->_rootref['L_WHO_IS_ONLINE'])) ? $this->_rootref['L_WHO_IS_ONLINE'] : ((isset($user->lang['WHO_IS_ONLINE'])) ? $user->lang['WHO_IS_ONLINE'] : '{ WHO_IS_ONLINE }')); ?>" /></td>
+	<?php } else { ?>
+
+		<td class="row1" align="center" valign="middle"><img src="<?php echo (isset($this->_rootref['T_THEME_PATH'])) ? $this->_rootref['T_THEME_PATH'] : ''; ?>/images/whosonline.gif" alt="<?php echo ((isset($this->_rootref['L_WHO_IS_ONLINE'])) ? $this->_rootref['L_WHO_IS_ONLINE'] : ((isset($user->lang['WHO_IS_ONLINE'])) ? $user->lang['WHO_IS_ONLINE'] : '{ WHO_IS_ONLINE }')); ?>" /></td>
+	<?php } ?>
+
+		<td class="row1" width="100%"><span class="genmed"><?php echo (isset($this->_rootref['TOTAL_USERS_ONLINE'])) ? $this->_rootref['TOTAL_USERS_ONLINE'] : ''; ?> (<?php echo ((isset($this->_rootref['L_ONLINE_EXPLAIN'])) ? $this->_rootref['L_ONLINE_EXPLAIN'] : ((isset($user->lang['ONLINE_EXPLAIN'])) ? $user->lang['ONLINE_EXPLAIN'] : '{ ONLINE_EXPLAIN }')); ?>)<br /><?php echo (isset($this->_rootref['RECORD_USERS'])) ? $this->_rootref['RECORD_USERS'] : ''; ?><br /><br /><?php echo (isset($this->_rootref['LOGGED_IN_USER_LIST'])) ? $this->_rootref['LOGGED_IN_USER_LIST'] : ''; ?></span></td>
+	</tr>
+	<?php if ($this->_rootref['LEGEND']) {  ?>
+
+		<tr>
+			<td class="row1"><b class="gensmall"><?php echo ((isset($this->_rootref['L_LEGEND'])) ? $this->_rootref['L_LEGEND'] : ((isset($user->lang['LEGEND'])) ? $user->lang['LEGEND'] : '{ LEGEND }')); ?> :: <?php echo (isset($this->_rootref['LEGEND'])) ? $this->_rootref['LEGEND'] : ''; ?></b></td>
+		</tr>
+	<?php } ?>
+
+	</table>
+<?php } if ($this->_rootref['S_DISPLAY_BIRTHDAY_LIST']) {  ?>
+
+	<br clear="all" />
+
+	<table class="tablebg" width="100%" cellspacing="1">
+	<tr>
+		<td class="cat" colspan="2"><h4><?php echo ((isset($this->_rootref['L_BIRTHDAYS'])) ? $this->_rootref['L_BIRTHDAYS'] : ((isset($user->lang['BIRTHDAYS'])) ? $user->lang['BIRTHDAYS'] : '{ BIRTHDAYS }')); ?></h4></td>
+	</tr>
+	<tr>
+		<td class="row1" align="center" valign="middle"><img src="<?php echo (isset($this->_rootref['T_THEME_PATH'])) ? $this->_rootref['T_THEME_PATH'] : ''; ?>/images/whosonline.gif" alt="<?php echo ((isset($this->_rootref['L_BIRTHDAYS'])) ? $this->_rootref['L_BIRTHDAYS'] : ((isset($user->lang['BIRTHDAYS'])) ? $user->lang['BIRTHDAYS'] : '{ BIRTHDAYS }')); ?>" /></td>
+		<td class="row1" width="100%"><p class="genmed"><?php if ($this->_rootref['BIRTHDAY_LIST']) {  echo ((isset($this->_rootref['L_CONGRATULATIONS'])) ? $this->_rootref['L_CONGRATULATIONS'] : ((isset($user->lang['CONGRATULATIONS'])) ? $user->lang['CONGRATULATIONS'] : '{ CONGRATULATIONS }')); ?>: <b><?php echo (isset($this->_rootref['BIRTHDAY_LIST'])) ? $this->_rootref['BIRTHDAY_LIST'] : ''; ?></b><?php } else { echo ((isset($this->_rootref['L_NO_BIRTHDAYS'])) ? $this->_rootref['L_NO_BIRTHDAYS'] : ((isset($user->lang['NO_BIRTHDAYS'])) ? $user->lang['NO_BIRTHDAYS'] : '{ NO_BIRTHDAYS }')); } ?></p></td>
+	</tr>
+	</table>
+<?php } ?>
+
+
+<br clear="all" />
+
+<table class="tablebg" width="100%" cellspacing="1">
+<tr>
+	<td class="cat" colspan="2"><h4><?php echo ((isset($this->_rootref['L_STATISTICS'])) ? $this->_rootref['L_STATISTICS'] : ((isset($user->lang['STATISTICS'])) ? $user->lang['STATISTICS'] : '{ STATISTICS }')); ?></h4></td>
+</tr>
+<tr>
+	<td class="row1"><img src="<?php echo (isset($this->_rootref['T_THEME_PATH'])) ? $this->_rootref['T_THEME_PATH'] : ''; ?>/images/whosonline.gif" alt="<?php echo ((isset($this->_rootref['L_STATISTICS'])) ? $this->_rootref['L_STATISTICS'] : ((isset($user->lang['STATISTICS'])) ? $user->lang['STATISTICS'] : '{ STATISTICS }')); ?>" /></td>
+	<td class="row1" width="100%" valign="middle"><p class="genmed"><?php echo (isset($this->_rootref['TOTAL_POSTS'])) ? $this->_rootref['TOTAL_POSTS'] : ''; ?> | <?php echo (isset($this->_rootref['TOTAL_TOPICS'])) ? $this->_rootref['TOTAL_TOPICS'] : ''; ?> | <?php echo (isset($this->_rootref['TOTAL_USERS'])) ? $this->_rootref['TOTAL_USERS'] : ''; ?> | <?php echo (isset($this->_rootref['NEWEST_USER'])) ? $this->_rootref['NEWEST_USER'] : ''; ?></p></td>
+</tr>
+</table>
+
+<?php if (! $this->_rootref['S_USER_LOGGED_IN'] && ! $this->_rootref['S_IS_BOT']) {  ?>
+
+	<br clear="all" />
+
+	<form method="post" action="<?php echo (isset($this->_rootref['S_LOGIN_ACTION'])) ? $this->_rootref['S_LOGIN_ACTION'] : ''; ?>">
+
+	<table class="tablebg" width="100%" cellspacing="1">
+	<tr>
+		<td class="cat"><h4><a href="<?php echo (isset($this->_rootref['U_LOGIN_LOGOUT'])) ? $this->_rootref['U_LOGIN_LOGOUT'] : ''; ?>"><?php echo ((isset($this->_rootref['L_LOGIN_LOGOUT'])) ? $this->_rootref['L_LOGIN_LOGOUT'] : ((isset($user->lang['LOGIN_LOGOUT'])) ? $user->lang['LOGIN_LOGOUT'] : '{ LOGIN_LOGOUT }')); ?></a></h4></td>
+	</tr>
+	<tr>
+		<td class="row1" align="center"><span class="genmed"><?php echo ((isset($this->_rootref['L_USERNAME'])) ? $this->_rootref['L_USERNAME'] : ((isset($user->lang['USERNAME'])) ? $user->lang['USERNAME'] : '{ USERNAME }')); ?>:</span> <input class="post" type="text" name="username" size="10" />&nbsp; <span class="genmed"><?php echo ((isset($this->_rootref['L_PASSWORD'])) ? $this->_rootref['L_PASSWORD'] : ((isset($user->lang['PASSWORD'])) ? $user->lang['PASSWORD'] : '{ PASSWORD }')); ?>:</span> <input class="post" type="password" name="password" size="10" />&nbsp; <?php if ($this->_rootref['S_AUTOLOGIN_ENABLED']) {  ?> <span class="gensmall"><?php echo ((isset($this->_rootref['L_LOG_ME_IN'])) ? $this->_rootref['L_LOG_ME_IN'] : ((isset($user->lang['LOG_ME_IN'])) ? $user->lang['LOG_ME_IN'] : '{ LOG_ME_IN }')); ?></span> <input type="checkbox" class="radio" name="autologin" /><?php } ?>&nbsp; <input type="submit" class="btnmain" name="login" value="<?php echo ((isset($this->_rootref['L_LOGIN'])) ? $this->_rootref['L_LOGIN'] : ((isset($user->lang['LOGIN'])) ? $user->lang['LOGIN'] : '{ LOGIN }')); ?>" /></td>
+	</tr>
+	</table>
+	<?php echo (isset($this->_rootref['S_LOGIN_REDIRECT'])) ? $this->_rootref['S_LOGIN_REDIRECT'] : ''; ?>
+
+	<?php echo (isset($this->_rootref['S_FORM_TOKEN'])) ? $this->_rootref['S_FORM_TOKEN'] : ''; ?>
+
+	</form>
+<?php } ?>
+
+
+<br clear="all" />
+
+<table class="legend">
+<tr>
+	<td width="20" align="center"><?php echo (isset($this->_rootref['FORUM_UNREAD_IMG'])) ? $this->_rootref['FORUM_UNREAD_IMG'] : ''; ?></td>
+	<td><span class="gensmall"><?php echo ((isset($this->_rootref['L_UNREAD_POSTS'])) ? $this->_rootref['L_UNREAD_POSTS'] : ((isset($user->lang['UNREAD_POSTS'])) ? $user->lang['UNREAD_POSTS'] : '{ UNREAD_POSTS }')); ?></span></td>
+	<td>&nbsp;&nbsp;</td>
+	<td width="20" align="center"><?php echo (isset($this->_rootref['FORUM_IMG'])) ? $this->_rootref['FORUM_IMG'] : ''; ?></td>
+	<td><span class="gensmall"><?php echo ((isset($this->_rootref['L_NO_UNREAD_POSTS'])) ? $this->_rootref['L_NO_UNREAD_POSTS'] : ((isset($user->lang['NO_UNREAD_POSTS'])) ? $user->lang['NO_UNREAD_POSTS'] : '{ NO_UNREAD_POSTS }')); ?></span></td>
+	<td>&nbsp;&nbsp;</td>
+	<td width="20" align="center"><?php echo (isset($this->_rootref['FORUM_LOCKED_IMG'])) ? $this->_rootref['FORUM_LOCKED_IMG'] : ''; ?></td>
+	<td><span class="gensmall"><?php echo ((isset($this->_rootref['L_FORUM_LOCKED'])) ? $this->_rootref['L_FORUM_LOCKED'] : ((isset($user->lang['FORUM_LOCKED'])) ? $user->lang['FORUM_LOCKED'] : '{ FORUM_LOCKED }')); ?></span></td>
+</tr>
+</table>
+
+<?php $this->_tpl_include('overall_footer.html'); ?>
\ No newline at end of file
diff -ruN phpBB-3.0.10/cache/tpl_spring_jumpbox.html.php phpbb/cache/tpl_spring_jumpbox.html.php
--- phpBB-3.0.10/cache/tpl_spring_jumpbox.html.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/cache/tpl_spring_jumpbox.html.php	2014-04-15 15:00:26.375414251 +0200
@@ -0,0 +1,20 @@
+<?php if (!defined('IN_PHPBB')) exit; if ($this->_rootref['S_DISPLAY_JUMPBOX']) {  ?>
+
+	<form method="post" name="jumpbox" action="<?php echo (isset($this->_rootref['S_JUMPBOX_ACTION'])) ? $this->_rootref['S_JUMPBOX_ACTION'] : ''; ?>" onsubmit="if(document.jumpbox.f.value == -1){return false;}">
+
+	<table cellspacing="0" cellpadding="0" border="0">
+	<tr>
+		<td nowrap="nowrap"><span class="gensmall"><?php if ($this->_rootref['S_IN_MCP'] && $this->_rootref['S_MERGE_SELECT']) {  echo ((isset($this->_rootref['L_SELECT_TOPICS_FROM'])) ? $this->_rootref['L_SELECT_TOPICS_FROM'] : ((isset($user->lang['SELECT_TOPICS_FROM'])) ? $user->lang['SELECT_TOPICS_FROM'] : '{ SELECT_TOPICS_FROM }')); } else if ($this->_rootref['S_IN_MCP']) {  echo ((isset($this->_rootref['L_MODERATE_FORUM'])) ? $this->_rootref['L_MODERATE_FORUM'] : ((isset($user->lang['MODERATE_FORUM'])) ? $user->lang['MODERATE_FORUM'] : '{ MODERATE_FORUM }')); } else { echo ((isset($this->_rootref['L_JUMP_TO'])) ? $this->_rootref['L_JUMP_TO'] : ((isset($user->lang['JUMP_TO'])) ? $user->lang['JUMP_TO'] : '{ JUMP_TO }')); } ?>:</span>&nbsp;<select name="f" onchange="if(this.options[this.selectedIndex].value != -1){ document.forms['jumpbox'].submit() }">
+
+		<?php $_jumpbox_forums_count = (isset($this->_tpldata['jumpbox_forums'])) ? sizeof($this->_tpldata['jumpbox_forums']) : 0;if ($_jumpbox_forums_count) {for ($_jumpbox_forums_i = 0; $_jumpbox_forums_i < $_jumpbox_forums_count; ++$_jumpbox_forums_i){$_jumpbox_forums_val = &$this->_tpldata['jumpbox_forums'][$_jumpbox_forums_i]; if ($_jumpbox_forums_val['S_FORUM_COUNT'] == (1)) {  ?><option value="-1">------------------</option><?php } ?>
+
+			<option value="<?php echo $_jumpbox_forums_val['FORUM_ID']; ?>"<?php echo $_jumpbox_forums_val['SELECTED']; ?>><?php $_level_count = (isset($_jumpbox_forums_val['level'])) ? sizeof($_jumpbox_forums_val['level']) : 0;if ($_level_count) {for ($_level_i = 0; $_level_i < $_level_count; ++$_level_i){$_level_val = &$_jumpbox_forums_val['level'][$_level_i]; ?>&nbsp; &nbsp;<?php }} echo $_jumpbox_forums_val['FORUM_NAME']; ?></option>
+		<?php }} ?>
+
+
+		</select>&nbsp;<input class="btnlite" type="submit" value="<?php echo ((isset($this->_rootref['L_GO'])) ? $this->_rootref['L_GO'] : ((isset($user->lang['GO'])) ? $user->lang['GO'] : '{ GO }')); ?>" /></td>
+	</tr>
+	</table>
+
+	</form>
+<?php } ?>
\ No newline at end of file
diff -ruN phpBB-3.0.10/cache/tpl_spring_login_body.html.php phpbb/cache/tpl_spring_login_body.html.php
--- phpBB-3.0.10/cache/tpl_spring_login_body.html.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/cache/tpl_spring_login_body.html.php	2014-04-15 15:00:26.377414251 +0200
@@ -0,0 +1,126 @@
+<?php if (!defined('IN_PHPBB')) exit; $this->_tpl_include('overall_header.html'); ?>
+
+
+<form action="<?php echo (isset($this->_rootref['S_LOGIN_ACTION'])) ? $this->_rootref['S_LOGIN_ACTION'] : ''; ?>" method="post">
+
+<table class="tablebg" width="100%" cellspacing="1">
+<tr>
+	<?php if (! $this->_rootref['S_ADMIN_AUTH']) {  ?>
+
+		<th colspan="2"><?php echo ((isset($this->_rootref['L_LOGIN'])) ? $this->_rootref['L_LOGIN'] : ((isset($user->lang['LOGIN'])) ? $user->lang['LOGIN'] : '{ LOGIN }')); ?></th>
+	<?php } else { ?>
+
+		<th><?php echo (isset($this->_rootref['LOGIN_EXPLAIN'])) ? $this->_rootref['LOGIN_EXPLAIN'] : ''; ?></th>
+	<?php } ?>
+
+</tr>
+<?php if ($this->_rootref['LOGIN_EXPLAIN'] && ! $this->_rootref['S_ADMIN_AUTH']) {  ?>
+
+	<tr>
+		<td class="row3" colspan="2" align="center"><span class="gensmall"><?php echo (isset($this->_rootref['LOGIN_EXPLAIN'])) ? $this->_rootref['LOGIN_EXPLAIN'] : ''; ?></span></td>
+	</tr>
+<?php } ?>
+
+<tr><?php if (! $this->_rootref['S_ADMIN_AUTH'] && $this->_rootref['S_REGISTER_ENABLED']) {  ?>
+
+	<td class="row1" width="50%">
+		<p class="genmed"><?php echo ((isset($this->_rootref['L_LOGIN_INFO'])) ? $this->_rootref['L_LOGIN_INFO'] : ((isset($user->lang['LOGIN_INFO'])) ? $user->lang['LOGIN_INFO'] : '{ LOGIN_INFO }')); ?></p>
+
+		<p class="genmed" align="center">
+			<a href="<?php echo (isset($this->_rootref['U_TERMS_USE'])) ? $this->_rootref['U_TERMS_USE'] : ''; ?>"><?php echo ((isset($this->_rootref['L_TERMS_USE'])) ? $this->_rootref['L_TERMS_USE'] : ((isset($user->lang['TERMS_USE'])) ? $user->lang['TERMS_USE'] : '{ TERMS_USE }')); ?></a> | <a href="<?php echo (isset($this->_rootref['U_PRIVACY'])) ? $this->_rootref['U_PRIVACY'] : ''; ?>"><?php echo ((isset($this->_rootref['L_PRIVACY'])) ? $this->_rootref['L_PRIVACY'] : ((isset($user->lang['PRIVACY'])) ? $user->lang['PRIVACY'] : '{ PRIVACY }')); ?></a>
+		</p>
+	</td>
+	<?php } ?>
+
+	<td <?php if (! $this->_rootref['S_ADMIN_AUTH']) {  ?>class="row2"<?php } else { ?>class="row1"<?php } ?>>
+	
+		<table align="center" cellspacing="1" cellpadding="4" style="width: 100%;">
+		<?php if ($this->_rootref['LOGIN_ERROR']) {  ?>
+
+			<tr>
+				<td class="gensmall" colspan="2" align="center"><span class="error"><?php echo (isset($this->_rootref['LOGIN_ERROR'])) ? $this->_rootref['LOGIN_ERROR'] : ''; ?></span></td>
+			</tr>
+		<?php } ?>
+
+
+		<tr>
+			<td valign="top" <?php if ($this->_rootref['S_ADMIN_AUTH']) {  ?>style="width: 50%; text-align: <?php echo (isset($this->_rootref['S_CONTENT_FLOW_END'])) ? $this->_rootref['S_CONTENT_FLOW_END'] : ''; ?>;"<?php } ?>><b class="gensmall"><?php echo ((isset($this->_rootref['L_USERNAME'])) ? $this->_rootref['L_USERNAME'] : ((isset($user->lang['USERNAME'])) ? $user->lang['USERNAME'] : '{ USERNAME }')); ?>:</b></td>
+			<td><input class="post" type="text" name="<?php echo (isset($this->_rootref['USERNAME_CREDENTIAL'])) ? $this->_rootref['USERNAME_CREDENTIAL'] : ''; ?>" size="25" value="<?php echo (isset($this->_rootref['USERNAME'])) ? $this->_rootref['USERNAME'] : ''; ?>" tabindex="1" />
+				<?php if (! $this->_rootref['S_ADMIN_AUTH'] && $this->_rootref['S_REGISTER_ENABLED']) {  ?>
+
+					<br /><a class="gensmall" href="<?php echo (isset($this->_rootref['U_REGISTER'])) ? $this->_rootref['U_REGISTER'] : ''; ?>"><?php echo ((isset($this->_rootref['L_REGISTER'])) ? $this->_rootref['L_REGISTER'] : ((isset($user->lang['REGISTER'])) ? $user->lang['REGISTER'] : '{ REGISTER }')); ?></a>
+				<?php } ?>
+
+			</td>
+		</tr>
+		<tr>
+			<td valign="top" <?php if ($this->_rootref['S_ADMIN_AUTH']) {  ?>style="width: 50%; text-align: <?php echo (isset($this->_rootref['S_CONTENT_FLOW_END'])) ? $this->_rootref['S_CONTENT_FLOW_END'] : ''; ?>;"<?php } ?>><b class="gensmall"><?php echo ((isset($this->_rootref['L_PASSWORD'])) ? $this->_rootref['L_PASSWORD'] : ((isset($user->lang['PASSWORD'])) ? $user->lang['PASSWORD'] : '{ PASSWORD }')); ?>:</b></td>
+			<td>
+				<input class="post" type="password" name="<?php echo (isset($this->_rootref['PASSWORD_CREDENTIAL'])) ? $this->_rootref['PASSWORD_CREDENTIAL'] : ''; ?>" size="25" tabindex="2" />
+				<?php if ($this->_rootref['U_SEND_PASSWORD']) {  ?><br /><a class="gensmall" href="<?php echo (isset($this->_rootref['U_SEND_PASSWORD'])) ? $this->_rootref['U_SEND_PASSWORD'] : ''; ?>"><?php echo ((isset($this->_rootref['L_FORGOT_PASS'])) ? $this->_rootref['L_FORGOT_PASS'] : ((isset($user->lang['FORGOT_PASS'])) ? $user->lang['FORGOT_PASS'] : '{ FORGOT_PASS }')); ?></a><?php } if ($this->_rootref['U_RESEND_ACTIVATION'] && ! $this->_rootref['S_ADMIN_AUTH']) {  ?><br /><a class="gensmall" href="<?php echo (isset($this->_rootref['U_RESEND_ACTIVATION'])) ? $this->_rootref['U_RESEND_ACTIVATION'] : ''; ?>"><?php echo ((isset($this->_rootref['L_RESEND_ACTIVATION'])) ? $this->_rootref['L_RESEND_ACTIVATION'] : ((isset($user->lang['RESEND_ACTIVATION'])) ? $user->lang['RESEND_ACTIVATION'] : '{ RESEND_ACTIVATION }')); ?></a><?php } ?>
+
+			</td>
+		</tr>
+		<?php if ($this->_rootref['S_DISPLAY_FULL_LOGIN']) {  if ($this->_rootref['S_AUTOLOGIN_ENABLED']) {  ?>
+
+			<tr>
+				<td>&nbsp;</td>
+				<td><input type="checkbox" class="radio" name="autologin" tabindex="3" /> <span class="gensmall"><?php echo ((isset($this->_rootref['L_LOG_ME_IN'])) ? $this->_rootref['L_LOG_ME_IN'] : ((isset($user->lang['LOG_ME_IN'])) ? $user->lang['LOG_ME_IN'] : '{ LOG_ME_IN }')); ?></span></td>
+			</tr>
+			<?php } ?>
+
+			<tr>
+				<td>&nbsp;</td>
+				<td><input type="checkbox" class="radio" name="viewonline" tabindex="4" /> <span class="gensmall"><?php echo ((isset($this->_rootref['L_HIDE_ME'])) ? $this->_rootref['L_HIDE_ME'] : ((isset($user->lang['HIDE_ME'])) ? $user->lang['HIDE_ME'] : '{ HIDE_ME }')); ?></span></td>
+			</tr>
+		<?php } ?>
+
+		</table>
+	</td>
+</tr>
+
+<?php if ($this->_rootref['CAPTCHA_TEMPLATE'] && $this->_rootref['S_CONFIRM_CODE']) {  ?>
+
+</table>
+<table class="tablebg" width="100%" cellspacing="1">
+		
+	<?php if (isset($this->_rootref['CAPTCHA_TEMPLATE'])) { $this->_tpl_include($this->_rootref['CAPTCHA_TEMPLATE']); } } ?>
+
+
+<?php echo (isset($this->_rootref['S_LOGIN_REDIRECT'])) ? $this->_rootref['S_LOGIN_REDIRECT'] : ''; ?>
+
+<tr>
+	<td class="cat" <?php if (! $this->_rootref['S_ADMIN_AUTH'] || $this->_rootref['S_CONFIRM_CODE']) {  ?>colspan="2"<?php } ?> align="center"><?php echo (isset($this->_rootref['S_HIDDEN_FIELDS'])) ? $this->_rootref['S_HIDDEN_FIELDS'] : ''; ?><input type="submit" name="login" class="btnmain" value="<?php echo ((isset($this->_rootref['L_LOGIN'])) ? $this->_rootref['L_LOGIN'] : ((isset($user->lang['LOGIN'])) ? $user->lang['LOGIN'] : '{ LOGIN }')); ?>" tabindex="5" /></td>
+</tr>
+</table>
+<?php echo (isset($this->_rootref['S_FORM_TOKEN'])) ? $this->_rootref['S_FORM_TOKEN'] : ''; ?>
+
+</form>
+
+<br clear="all" />
+
+<?php $this->_tpl_include('breadcrumbs.html'); ?>
+
+
+<br clear="all" />
+
+<div align="<?php echo (isset($this->_rootref['S_CONTENT_FLOW_END'])) ? $this->_rootref['S_CONTENT_FLOW_END'] : ''; ?>"><?php $this->_tpl_include('jumpbox.html'); ?></div>
+
+<script type="text/javascript">
+// <![CDATA[
+	(function()
+	{
+		var elements = document.getElementsByName("<?php if ($this->_rootref['S_ADMIN_AUTH']) {  echo (isset($this->_rootref['PASSWORD_CREDENTIAL'])) ? $this->_rootref['PASSWORD_CREDENTIAL'] : ''; } else { echo (isset($this->_rootref['USERNAME_CREDENTIAL'])) ? $this->_rootref['USERNAME_CREDENTIAL'] : ''; } ?>");
+		for (var i = 0; i < elements.length; ++i)
+		{
+			if (elements[i].tagName.toLowerCase() == 'input')
+			{
+				elements[i].focus();
+				break;
+			}
+		}
+	})();
+// ]]>
+</script>
+
+<?php $this->_tpl_include('overall_footer.html'); ?>
\ No newline at end of file
diff -ruN phpBB-3.0.10/cache/tpl_spring_overall_footer.html.php phpbb/cache/tpl_spring_overall_footer.html.php
--- phpBB-3.0.10/cache/tpl_spring_overall_footer.html.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/cache/tpl_spring_overall_footer.html.php	2014-04-15 15:00:22.942414280 +0200
@@ -0,0 +1,23 @@
+<?php if (!defined('IN_PHPBB')) exit; if (! $this->_rootref['S_IS_BOT']) {  echo (isset($this->_rootref['RUN_CRON_TASK'])) ? $this->_rootref['RUN_CRON_TASK'] : ''; } ?>
+
+</div>
+
+<div id="wrapfooter">
+	<?php if ($this->_rootref['U_ACP']) {  ?><span class="gensmall">[ <a href="<?php echo (isset($this->_rootref['U_ACP'])) ? $this->_rootref['U_ACP'] : ''; ?>"><?php echo ((isset($this->_rootref['L_ACP'])) ? $this->_rootref['L_ACP'] : ((isset($user->lang['ACP'])) ? $user->lang['ACP'] : '{ ACP }')); ?></a> ]</span><br /><br /><?php } ?>
+
+	<span class="copyright">Powered by <a href="http://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Group
+	<?php if ($this->_rootref['TRANSLATION_INFO']) {  ?><br /><?php echo (isset($this->_rootref['TRANSLATION_INFO'])) ? $this->_rootref['TRANSLATION_INFO'] : ''; } if ($this->_rootref['DEBUG_OUTPUT']) {  ?><br /><bdo dir="ltr">[ <?php echo (isset($this->_rootref['DEBUG_OUTPUT'])) ? $this->_rootref['DEBUG_OUTPUT'] : ''; ?> ]</bdo><?php } ?></span>
+</div>
+
+</td>
+<td bgcolor="#20292E" class="headertd"><img src="/images/pixel.gif" height="10" width="1" alt="" /><br /></td>
+</tr></table>
+        
+        
+</td></tr>
+
+<?php $this->_tpl_include('../../../../templates/footer.html'); ?>
+
+<script type="text/javascript" src="<?php echo (isset($this->_rootref['ROOT_PATH'])) ? $this->_rootref['ROOT_PATH'] : ''; ?>/mobiquo/tapatalkdetect.js"></script>
+</body>
+</html>
\ No newline at end of file
diff -ruN phpBB-3.0.10/cache/tpl_spring_overall_header.html.php phpbb/cache/tpl_spring_overall_header.html.php
--- phpBB-3.0.10/cache/tpl_spring_overall_header.html.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/cache/tpl_spring_overall_header.html.php	2014-04-15 15:00:22.928414280 +0200
@@ -0,0 +1,204 @@
+<?php if (!defined('IN_PHPBB')) exit; ?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
+<html xmlns="http://www.w3.org/1999/xhtml" dir="<?php echo (isset($this->_rootref['S_CONTENT_DIRECTION'])) ? $this->_rootref['S_CONTENT_DIRECTION'] : ''; ?>" lang="<?php echo (isset($this->_rootref['S_USER_LANG'])) ? $this->_rootref['S_USER_LANG'] : ''; ?>" xml:lang="<?php echo (isset($this->_rootref['S_USER_LANG'])) ? $this->_rootref['S_USER_LANG'] : ''; ?>">
+<head>
+
+<meta http-equiv="content-type" content="text/html; charset=<?php echo (isset($this->_rootref['S_CONTENT_ENCODING'])) ? $this->_rootref['S_CONTENT_ENCODING'] : ''; ?>" />
+<meta http-equiv="content-language" content="<?php echo (isset($this->_rootref['S_USER_LANG'])) ? $this->_rootref['S_USER_LANG'] : ''; ?>" />
+<meta http-equiv="content-style-type" content="text/css" />
+<meta http-equiv="imagetoolbar" content="no" />
+<meta name="resource-type" content="document" />
+<meta name="distribution" content="global" />
+<meta name="keywords" content="" />
+<meta name="description" content="" />
+<?php echo (isset($this->_rootref['META'])) ? $this->_rootref['META'] : ''; ?>
+
+<title><?php echo (isset($this->_rootref['SITENAME'])) ? $this->_rootref['SITENAME'] : ''; ?> &bull; <?php if ($this->_rootref['S_IN_MCP']) {  echo ((isset($this->_rootref['L_MCP'])) ? $this->_rootref['L_MCP'] : ((isset($user->lang['MCP'])) ? $user->lang['MCP'] : '{ MCP }')); ?> &bull; <?php } else if ($this->_rootref['S_IN_UCP']) {  echo ((isset($this->_rootref['L_UCP'])) ? $this->_rootref['L_UCP'] : ((isset($user->lang['UCP'])) ? $user->lang['UCP'] : '{ UCP }')); ?> &bull; <?php } echo (isset($this->_rootref['PAGE_TITLE'])) ? $this->_rootref['PAGE_TITLE'] : ''; ?></title>
+
+<?php if ($this->_rootref['S_ENABLE_FEEDS']) {  if ($this->_rootref['S_ENABLE_FEEDS_OVERALL']) {  ?><link rel="alternate" type="application/atom+xml" title="<?php echo ((isset($this->_rootref['L_FEED'])) ? $this->_rootref['L_FEED'] : ((isset($user->lang['FEED'])) ? $user->lang['FEED'] : '{ FEED }')); ?> - <?php echo (isset($this->_rootref['SITENAME'])) ? $this->_rootref['SITENAME'] : ''; ?>" href="<?php echo (isset($this->_rootref['U_FEED'])) ? $this->_rootref['U_FEED'] : ''; ?>" /><?php } if ($this->_rootref['S_ENABLE_FEEDS_NEWS']) {  ?><link rel="alternate" type="application/atom+xml" title="<?php echo ((isset($this->_rootref['L_FEED'])) ? $this->_rootref['L_FEED'] : ((isset($user->lang['FEED'])) ? $user->lang['FEED'] : '{ FEED }')); ?> - <?php echo ((isset($this->_rootref['L_FEED_NEWS'])) ? $this->_rootref['L_FEED_NEWS'] : ((isset($user->lang['FEED_NEWS'])) ? $user->lang['FEED_NEWS'] : '{ FEED_NEWS }')); ?>" href="<?php echo (isset($this->_rootref['U_FEED'])) ? $this->_rootref['U_FEED'] : ''; ?>?mode=news" /><?php } if ($this->_rootref['S_ENABLE_FEEDS_FORUMS']) {  ?><link rel="alternate" type="application/atom+xml" title="<?php echo ((isset($this->_rootref['L_FEED'])) ? $this->_rootref['L_FEED'] : ((isset($user->lang['FEED'])) ? $user->lang['FEED'] : '{ FEED }')); ?> - <?php echo ((isset($this->_rootref['L_ALL_FORUMS'])) ? $this->_rootref['L_ALL_FORUMS'] : ((isset($user->lang['ALL_FORUMS'])) ? $user->lang['ALL_FORUMS'] : '{ ALL_FORUMS }')); ?>" href="<?php echo (isset($this->_rootref['U_FEED'])) ? $this->_rootref['U_FEED'] : ''; ?>?mode=forums" /><?php } if ($this->_rootref['S_ENABLE_FEEDS_TOPICS']) {  ?><link rel="alternate" type="application/atom+xml" title="<?php echo ((isset($this->_rootref['L_FEED'])) ? $this->_rootref['L_FEED'] : ((isset($user->lang['FEED'])) ? $user->lang['FEED'] : '{ FEED }')); ?> - <?php echo ((isset($this->_rootref['L_FEED_TOPICS_NEW'])) ? $this->_rootref['L_FEED_TOPICS_NEW'] : ((isset($user->lang['FEED_TOPICS_NEW'])) ? $user->lang['FEED_TOPICS_NEW'] : '{ FEED_TOPICS_NEW }')); ?>" href="<?php echo (isset($this->_rootref['U_FEED'])) ? $this->_rootref['U_FEED'] : ''; ?>?mode=topics" /><?php } if ($this->_rootref['S_ENABLE_FEEDS_TOPICS_ACTIVE']) {  ?><link rel="alternate" type="application/atom+xml" title="<?php echo ((isset($this->_rootref['L_FEED'])) ? $this->_rootref['L_FEED'] : ((isset($user->lang['FEED'])) ? $user->lang['FEED'] : '{ FEED }')); ?> - <?php echo ((isset($this->_rootref['L_FEED_TOPICS_ACTIVE'])) ? $this->_rootref['L_FEED_TOPICS_ACTIVE'] : ((isset($user->lang['FEED_TOPICS_ACTIVE'])) ? $user->lang['FEED_TOPICS_ACTIVE'] : '{ FEED_TOPICS_ACTIVE }')); ?>" href="<?php echo (isset($this->_rootref['U_FEED'])) ? $this->_rootref['U_FEED'] : ''; ?>?mode=topics_active" /><?php } if ($this->_rootref['S_ENABLE_FEEDS_FORUM'] && $this->_rootref['S_FORUM_ID']) {  ?><link rel="alternate" type="application/atom+xml" title="<?php echo ((isset($this->_rootref['L_FEED'])) ? $this->_rootref['L_FEED'] : ((isset($user->lang['FEED'])) ? $user->lang['FEED'] : '{ FEED }')); ?> - <?php echo ((isset($this->_rootref['L_FORUM'])) ? $this->_rootref['L_FORUM'] : ((isset($user->lang['FORUM'])) ? $user->lang['FORUM'] : '{ FORUM }')); ?> - <?php echo (isset($this->_rootref['FORUM_NAME'])) ? $this->_rootref['FORUM_NAME'] : ''; ?>" href="<?php echo (isset($this->_rootref['U_FEED'])) ? $this->_rootref['U_FEED'] : ''; ?>?f=<?php echo (isset($this->_rootref['S_FORUM_ID'])) ? $this->_rootref['S_FORUM_ID'] : ''; ?>" /><?php } if ($this->_rootref['S_ENABLE_FEEDS_TOPIC'] && $this->_rootref['S_TOPIC_ID']) {  ?><link rel="alternate" type="application/atom+xml" title="<?php echo ((isset($this->_rootref['L_FEED'])) ? $this->_rootref['L_FEED'] : ((isset($user->lang['FEED'])) ? $user->lang['FEED'] : '{ FEED }')); ?> - <?php echo ((isset($this->_rootref['L_TOPIC'])) ? $this->_rootref['L_TOPIC'] : ((isset($user->lang['TOPIC'])) ? $user->lang['TOPIC'] : '{ TOPIC }')); ?> - <?php echo (isset($this->_rootref['TOPIC_TITLE'])) ? $this->_rootref['TOPIC_TITLE'] : ''; ?>" href="<?php echo (isset($this->_rootref['U_FEED'])) ? $this->_rootref['U_FEED'] : ''; ?>?f=<?php echo (isset($this->_rootref['S_FORUM_ID'])) ? $this->_rootref['S_FORUM_ID'] : ''; ?>&amp;t=<?php echo (isset($this->_rootref['S_TOPIC_ID'])) ? $this->_rootref['S_TOPIC_ID'] : ''; ?>" /><?php } } ?>
+
+
+<link rel="stylesheet" href="<?php echo (isset($this->_rootref['T_STYLESHEET_LINK'])) ? $this->_rootref['T_STYLESHEET_LINK'] : ''; ?>" type="text/css" />
+<link rel="stylesheet" href="/stylesv1.css" type="text/css" />
+
+<script type="text/javascript">
+// <![CDATA[
+<?php if ($this->_rootref['S_USER_PM_POPUP'] && $this->_rootref['S_NEW_PM']) {  ?>
+
+	popup('<?php echo (isset($this->_rootref['UA_POPUP_PM'])) ? $this->_rootref['UA_POPUP_PM'] : ''; ?>', 400, 225, '_phpbbprivmsg');
+<?php } ?>
+
+
+function popup(url, width, height, name)
+{
+	if (!name)
+	{
+		name = '_popup';
+	}
+
+	window.open(url.replace(/&amp;/g, '&'), name, 'height=' + height + ',resizable=yes,scrollbars=yes,width=' + width);
+	return false;
+}
+
+function jumpto()
+{
+	var page = prompt('<?php echo ((isset($this->_rootref['LA_JUMP_PAGE'])) ? $this->_rootref['LA_JUMP_PAGE'] : ((isset($this->_rootref['L_JUMP_PAGE'])) ? addslashes($this->_rootref['L_JUMP_PAGE']) : ((isset($user->lang['JUMP_PAGE'])) ? addslashes($user->lang['JUMP_PAGE']) : '{ JUMP_PAGE }'))); ?>:', '<?php echo (isset($this->_rootref['ON_PAGE'])) ? $this->_rootref['ON_PAGE'] : ''; ?>');
+	var per_page = '<?php echo (isset($this->_rootref['PER_PAGE'])) ? $this->_rootref['PER_PAGE'] : ''; ?>';
+	var base_url = '<?php echo (isset($this->_rootref['A_BASE_URL'])) ? $this->_rootref['A_BASE_URL'] : ''; ?>';
+
+	if (page !== null && !isNaN(page) && page == Math.floor(page) && page > 0)
+	{
+		if (base_url.indexOf('?') == -1)
+		{
+			document.location.href = base_url + '?start=' + ((page - 1) * per_page);
+		}
+		else
+		{
+			document.location.href = base_url.replace(/&amp;/g, '&') + '&start=' + ((page - 1) * per_page);
+		}
+	}
+}
+
+/**
+* Find a member
+*/
+function find_username(url)
+{
+	popup(url, 760, 570, '_usersearch');
+	return false;
+}
+
+/**
+* Mark/unmark checklist
+* id = ID of parent container, name = name prefix, state = state [true/false]
+*/
+function marklist(id, name, state)
+{
+	var parent = document.getElementById(id);
+	if (!parent)
+	{
+		eval('parent = document.' + id);
+	}
+
+	if (!parent)
+	{
+		return;
+	}
+
+	var rb = parent.getElementsByTagName('input');
+	
+	for (var r = 0; r < rb.length; r++)
+	{
+		if (rb[r].name.substr(0, name.length) == name)
+		{
+			rb[r].checked = state;
+		}
+	}
+}
+
+<?php if (sizeof($this->_tpldata['_file'])) {  ?>
+
+
+	/**
+	* Play quicktime file by determining it's width/height
+	* from the displayed rectangle area
+	*
+	* Only defined if there is a file block present.
+	*/
+	function play_qt_file(obj)
+	{
+		var rectangle = obj.GetRectangle();
+
+		if (rectangle)
+		{
+			rectangle = rectangle.split(',')
+			var x1 = parseInt(rectangle[0]);
+			var x2 = parseInt(rectangle[2]);
+			var y1 = parseInt(rectangle[1]);
+			var y2 = parseInt(rectangle[3]);
+
+			var width = (x1 < 0) ? (x1 * -1) + x2 : x2 - x1;
+			var height = (y1 < 0) ? (y1 * -1) + y2 : y2 - y1;
+		}
+		else
+		{
+			var width = 200;
+			var height = 0;
+		}
+
+		obj.width = width;
+		obj.height = height + 16;
+
+		obj.SetControllerVisible(true);
+
+		obj.Play();
+	}
+<?php } ?>
+
+
+// ]]>
+</script>
+</head>
+<body class="<?php echo (isset($this->_rootref['S_CONTENT_DIRECTION'])) ? $this->_rootref['S_CONTENT_DIRECTION'] : ''; ?>">
+
+<?php $this->_tpl_include('../../../../templates/header.html'); ?>
+
+
+<tr><td class="headertd">
+<table border="0" cellpadding="0" cellspacing="0" width="100%">
+<tr><td bgcolor="#20292E" class="headertd"><img src="/images/pixel.gif" height="10" width="1" alt=""/><br /></td>
+<td bgcolor="#C8D2DA" width="100%" class="headertd"> <!-- 4C626F -->
+
+<a name="top"></a>
+
+<div id="wrapheader">
+
+<!--	<div id="logodesc">
+		<table width="100%" cellspacing="0">
+		<tr>
+			<td><a href="<?php echo (isset($this->_rootref['U_INDEX'])) ? $this->_rootref['U_INDEX'] : ''; ?>"><?php echo (isset($this->_rootref['SITE_LOGO_IMG'])) ? $this->_rootref['SITE_LOGO_IMG'] : ''; ?></a></td>
+			<td width="100%" align="center"><h1><?php echo (isset($this->_rootref['SITENAME'])) ? $this->_rootref['SITENAME'] : ''; ?></h1><span class="gen"><?php echo (isset($this->_rootref['SITE_DESCRIPTION'])) ? $this->_rootref['SITE_DESCRIPTION'] : ''; ?></span></td>
+		</tr>
+		</table>
+	</div> -->
+
+	<div id="menubar">
+		<table width="100%" cellspacing="0">
+		<tr>
+			<td class="genmed">
+				<?php if (! $this->_rootref['S_IS_BOT']) {  ?><a href="<?php echo (isset($this->_rootref['U_LOGIN_LOGOUT'])) ? $this->_rootref['U_LOGIN_LOGOUT'] : ''; ?>"><img src="<?php echo (isset($this->_rootref['T_THEME_PATH'])) ? $this->_rootref['T_THEME_PATH'] : ''; ?>/images/icon_mini_login.gif" width="12" height="13" alt="*" /> <?php echo ((isset($this->_rootref['L_LOGIN_LOGOUT'])) ? $this->_rootref['L_LOGIN_LOGOUT'] : ((isset($user->lang['LOGIN_LOGOUT'])) ? $user->lang['LOGIN_LOGOUT'] : '{ LOGIN_LOGOUT }')); ?></a>&nbsp;<?php } if ($this->_rootref['U_RESTORE_PERMISSIONS']) {  ?> &nbsp;<a href="<?php echo (isset($this->_rootref['U_RESTORE_PERMISSIONS'])) ? $this->_rootref['U_RESTORE_PERMISSIONS'] : ''; ?>"><img src="<?php echo (isset($this->_rootref['T_THEME_PATH'])) ? $this->_rootref['T_THEME_PATH'] : ''; ?>/images/icon_mini_login.gif" width="12" height="13" alt="*" /> <?php echo ((isset($this->_rootref['L_RESTORE_PERMISSIONS'])) ? $this->_rootref['L_RESTORE_PERMISSIONS'] : ((isset($user->lang['RESTORE_PERMISSIONS'])) ? $user->lang['RESTORE_PERMISSIONS'] : '{ RESTORE_PERMISSIONS }')); ?></a><?php } if ($this->_rootref['S_BOARD_DISABLED'] && $this->_rootref['S_USER_LOGGED_IN']) {  ?> &nbsp;<span style="color: red;"><?php echo ((isset($this->_rootref['L_BOARD_DISABLED'])) ? $this->_rootref['L_BOARD_DISABLED'] : ((isset($user->lang['BOARD_DISABLED'])) ? $user->lang['BOARD_DISABLED'] : '{ BOARD_DISABLED }')); ?></span><?php } if (! $this->_rootref['S_IS_BOT']) {  if ($this->_rootref['S_USER_LOGGED_IN']) {  if ($this->_rootref['S_DISPLAY_PM']) {  ?> &nbsp;<a href="<?php echo (isset($this->_rootref['U_PRIVATEMSGS'])) ? $this->_rootref['U_PRIVATEMSGS'] : ''; ?>"><img src="<?php echo (isset($this->_rootref['T_THEME_PATH'])) ? $this->_rootref['T_THEME_PATH'] : ''; ?>/images/icon_mini_message.gif" width="12" height="13" alt="*" /> <?php echo (isset($this->_rootref['PRIVATE_MESSAGE_INFO'])) ? $this->_rootref['PRIVATE_MESSAGE_INFO'] : ''; if ($this->_rootref['PRIVATE_MESSAGE_INFO_UNREAD']) {  ?>, <?php echo (isset($this->_rootref['PRIVATE_MESSAGE_INFO_UNREAD'])) ? $this->_rootref['PRIVATE_MESSAGE_INFO_UNREAD'] : ''; } ?></a><?php } } else if ($this->_rootref['S_REGISTER_ENABLED'] && ! ( $this->_rootref['S_SHOW_COPPA'] || $this->_rootref['S_REGISTRATION'] )) {  ?> &nbsp;<a href="<?php echo (isset($this->_rootref['U_REGISTER'])) ? $this->_rootref['U_REGISTER'] : ''; ?>"><img src="<?php echo (isset($this->_rootref['T_THEME_PATH'])) ? $this->_rootref['T_THEME_PATH'] : ''; ?>/images/icon_mini_register.gif" width="12" height="13" alt="*" /> <?php echo ((isset($this->_rootref['L_REGISTER'])) ? $this->_rootref['L_REGISTER'] : ((isset($user->lang['REGISTER'])) ? $user->lang['REGISTER'] : '{ REGISTER }')); ?></a>
+					<?php } } ?>
+
+			</td>
+			<td class="genmed" align="<?php echo (isset($this->_rootref['S_CONTENT_FLOW_END'])) ? $this->_rootref['S_CONTENT_FLOW_END'] : ''; ?>">
+				<a href="<?php echo (isset($this->_rootref['U_FAQ'])) ? $this->_rootref['U_FAQ'] : ''; ?>"><img src="<?php echo (isset($this->_rootref['T_THEME_PATH'])) ? $this->_rootref['T_THEME_PATH'] : ''; ?>/images/icon_mini_faq.gif" width="12" height="13" alt="*" /> <?php echo ((isset($this->_rootref['L_FAQ'])) ? $this->_rootref['L_FAQ'] : ((isset($user->lang['FAQ'])) ? $user->lang['FAQ'] : '{ FAQ }')); ?></a>
+				<?php if ($this->_rootref['S_DISPLAY_SEARCH']) {  ?>&nbsp; &nbsp;<a href="<?php echo (isset($this->_rootref['U_SEARCH'])) ? $this->_rootref['U_SEARCH'] : ''; ?>"><img src="<?php echo (isset($this->_rootref['T_THEME_PATH'])) ? $this->_rootref['T_THEME_PATH'] : ''; ?>/images/icon_mini_search.gif" width="12" height="13" alt="*" /> <?php echo ((isset($this->_rootref['L_SEARCH'])) ? $this->_rootref['L_SEARCH'] : ((isset($user->lang['SEARCH'])) ? $user->lang['SEARCH'] : '{ SEARCH }')); ?></a><?php } if (! $this->_rootref['S_IS_BOT']) {  if ($this->_rootref['S_DISPLAY_MEMBERLIST']) {  ?>&nbsp; &nbsp;<a href="<?php echo (isset($this->_rootref['U_MEMBERLIST'])) ? $this->_rootref['U_MEMBERLIST'] : ''; ?>"><img src="<?php echo (isset($this->_rootref['T_THEME_PATH'])) ? $this->_rootref['T_THEME_PATH'] : ''; ?>/images/icon_mini_members.gif" width="12" height="13" alt="*" /> <?php echo ((isset($this->_rootref['L_MEMBERLIST'])) ? $this->_rootref['L_MEMBERLIST'] : ((isset($user->lang['MEMBERLIST'])) ? $user->lang['MEMBERLIST'] : '{ MEMBERLIST }')); ?></a><?php } if ($this->_rootref['S_USER_LOGGED_IN']) {  ?>&nbsp; &nbsp;<a href="<?php echo (isset($this->_rootref['U_PROFILE'])) ? $this->_rootref['U_PROFILE'] : ''; ?>"><img src="<?php echo (isset($this->_rootref['T_THEME_PATH'])) ? $this->_rootref['T_THEME_PATH'] : ''; ?>/images/icon_mini_profile.gif" width="12" height="13" alt="*" /> <?php echo ((isset($this->_rootref['L_PROFILE'])) ? $this->_rootref['L_PROFILE'] : ((isset($user->lang['PROFILE'])) ? $user->lang['PROFILE'] : '{ PROFILE }')); ?></a><?php } } ?>
+
+			</td>
+		</tr>
+
+		</table>
+	</div>
+
+</div>
+
+<div id="wrapcentre">
+
+	<?php if ($this->_rootref['S_DISPLAY_SEARCH']) {  ?>
+
+	<p class="searchbar">
+		<span style="float: <?php echo (isset($this->_rootref['S_CONTENT_FLOW_BEGIN'])) ? $this->_rootref['S_CONTENT_FLOW_BEGIN'] : ''; ?>;"><a href="<?php echo (isset($this->_rootref['U_SEARCH_UNANSWERED'])) ? $this->_rootref['U_SEARCH_UNANSWERED'] : ''; ?>"><?php echo ((isset($this->_rootref['L_SEARCH_UNANSWERED'])) ? $this->_rootref['L_SEARCH_UNANSWERED'] : ((isset($user->lang['SEARCH_UNANSWERED'])) ? $user->lang['SEARCH_UNANSWERED'] : '{ SEARCH_UNANSWERED }')); ?></a> | <a href="<?php echo (isset($this->_rootref['U_SEARCH_ACTIVE_TOPICS'])) ? $this->_rootref['U_SEARCH_ACTIVE_TOPICS'] : ''; ?>"><?php echo ((isset($this->_rootref['L_SEARCH_ACTIVE_TOPICS'])) ? $this->_rootref['L_SEARCH_ACTIVE_TOPICS'] : ((isset($user->lang['SEARCH_ACTIVE_TOPICS'])) ? $user->lang['SEARCH_ACTIVE_TOPICS'] : '{ SEARCH_ACTIVE_TOPICS }')); ?></a></span>
+		<?php if ($this->_rootref['S_USER_LOGGED_IN'] || $this->_rootref['S_LOAD_UNREADS']) {  ?>
+
+		<span style="float: <?php echo (isset($this->_rootref['S_CONTENT_FLOW_END'])) ? $this->_rootref['S_CONTENT_FLOW_END'] : ''; ?>;"><?php if ($this->_rootref['S_LOAD_UNREADS']) {  ?><a href="<?php echo (isset($this->_rootref['U_SEARCH_UNREAD'])) ? $this->_rootref['U_SEARCH_UNREAD'] : ''; ?>"><?php echo ((isset($this->_rootref['L_SEARCH_UNREAD'])) ? $this->_rootref['L_SEARCH_UNREAD'] : ((isset($user->lang['SEARCH_UNREAD'])) ? $user->lang['SEARCH_UNREAD'] : '{ SEARCH_UNREAD }')); ?></a><?php if ($this->_rootref['S_USER_LOGGED_IN']) {  ?> | <?php } } if ($this->_rootref['S_USER_LOGGED_IN']) {  ?><a href="<?php echo (isset($this->_rootref['U_SEARCH_NEW'])) ? $this->_rootref['U_SEARCH_NEW'] : ''; ?>"><?php echo ((isset($this->_rootref['L_SEARCH_NEW'])) ? $this->_rootref['L_SEARCH_NEW'] : ((isset($user->lang['SEARCH_NEW'])) ? $user->lang['SEARCH_NEW'] : '{ SEARCH_NEW }')); ?></a> | <a href="<?php echo (isset($this->_rootref['U_SEARCH_SELF'])) ? $this->_rootref['U_SEARCH_SELF'] : ''; ?>"><?php echo ((isset($this->_rootref['L_SEARCH_SELF'])) ? $this->_rootref['L_SEARCH_SELF'] : ((isset($user->lang['SEARCH_SELF'])) ? $user->lang['SEARCH_SELF'] : '{ SEARCH_SELF }')); ?></a><?php } ?></span>
+		<?php } ?>
+
+	</p>
+	<?php } ?>
+
+
+	<br style="clear: both;" /><br />
+
+	<?php $this->_tpl_include('breadcrumbs.html'); ?>
+
+
+	<br />
\ No newline at end of file
diff -ruN phpBB-3.0.10/cache/tpl_spring_............templates.footer.html.php phpbb/cache/tpl_spring_............templates.footer.html.php
--- phpBB-3.0.10/cache/tpl_spring_............templates.footer.html.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/cache/tpl_spring_............templates.footer.html.php	2014-04-15 15:00:22.941414280 +0200
@@ -0,0 +1,8 @@
+<?php if (!defined('IN_PHPBB')) exit; ?><tr valign="bottom">
+    <td class="bottombar" align="right">
+      Site layout created by <a href="http://springrts.com/phpbb/memberlist.php?mode=viewprofile&amp;u=4760" class="bottomlink">Roflcopter</a> et al.
+    </td>
+  </tr>
+</table>
+</div>
+</div>
\ No newline at end of file
diff -ruN phpBB-3.0.10/cache/tpl_spring_............templates.header.html.php phpbb/cache/tpl_spring_............templates.header.html.php
--- phpBB-3.0.10/cache/tpl_spring_............templates.header.html.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/cache/tpl_spring_............templates.header.html.php	2014-04-15 15:00:22.921414280 +0200
@@ -0,0 +1,116 @@
+<?php if (!defined('IN_PHPBB')) exit; ?><script type="text/javascript">
+// <![CDATA[
+	function getAdvent(year) {
+		var d = new Date(new Date(year + '-12-24 00:00:00').getTime() - 3 * 7 * 24 * 60 * 60 * 1000);
+		while (d.getDay() != 0) {
+			d = new Date(d.getTime() - 24 * 60 * 60 * 1000);
+		}
+		return d;
+	}
+	function get7thJanuar(year) {
+		return new Date(year + '-01-07 00:00:00');
+	}
+	function getEaster(year) {
+		var a = year % 19;
+		var b = Math.floor(year / 100);
+		var c = year % 100;
+		var d = Math.floor(b / 4);
+		var e = b % 4;
+		var f = Math.floor((b + 8) / 25);
+		var g = Math.floor((b - f + 1) / 3);
+		var h = (19 * a + b - d - g + 15) % 30;
+		var i = Math.floor(c / 4);
+		var k = c % 4;
+		var l = (32 + 2 * e + 2 * i - h - k) % 7;
+		var m = Math.floor((a + 11 * h + 22 * l) / 451);
+		var n0 = (h + l + 7 * m + 114)
+		var n = Math.floor(n0 / 31) - 1;
+		var p = n0 % 31 + 1;
+		return new Date(year,n,p);
+	}
+
+	// Christmas
+	var currentTime = new Date();
+	var advent_date = new getAdvent(currentTime.getFullYear());
+	var jan7th_date = new get7thJanuar(currentTime.getFullYear());
+	var easter_date = getEaster(currentTime.getFullYear());
+
+	if ((currentTime >= advent_date) || (currentTime < jan7th_date)) {
+		document.write("<link rel=\"stylesheet\" href=\"/style_xmas.css\" type=\"text/css\"/>");
+	}
+	if (currentTime.getMonth() == 4 && currentTime.getDate() == 17) {
+		document.write("<link rel=\"stylesheet\" href=\"/style_csd.css\" type=\"text/css\"/>");
+	}
+	if (currentTime.getMonth() == easter_date.getMonth() && currentTime.getDate() == easter_date.getDate() ) {
+		document.write("<link rel=\"stylesheet\" href=\"/style_easter.css\" type=\"text/css\"/>");
+	}
+// ]]>
+</script>
+
+<div id="wrapper">
+	<div id="header">
+		<div class="banner">
+			<div class="topbannershadow" style="float: left;"></div>
+			<div class="topbannerbg">
+				<div id="topbannerfade"></div>
+				<a id="toplogo" href="/"></a>
+			</div>
+		</div>
+
+		<div id="menu">
+			<ul>
+				<li class="headermenuleft" id="spm_home">
+					<a href="/" class="menubar headermenuleftlink">
+						<img src="/images/homie.gif" width="11" height="10" border="0" alt="" style="margin-right: 5px" />
+						Home
+					</a>
+				</li>
+
+				<li class="headermenu" id="spm_about">
+					<a href="/wiki/About" class="menubar headermenulink">About</a>
+				</li>
+
+				<li class="headermenu" id="spm_games">
+					<a href="/wiki/Games" class="menubar headermenulink">Games</a>
+				</li>
+
+				<li class="headermenu" id="spm_dev">
+					<a href="/wiki/Engine_Development" class="menubar headermenulink">Development</a>
+				</li>
+
+				<li class="headermenu" id="spm_media">
+					<a href="/media.php" class="menubar headermenulink">Media</a>
+				</li>
+
+				<li class="headermenu" id="spm_help">
+					<a href="/wiki/FAQ" class="menubar headermenulink">Help</a>
+				</li>
+
+				<li class="headermenu" id="spm_forums">
+					<a href="/phpbb" class="menubar headermenulink">Forums</a>
+				</li>
+
+				<li class="headermenu" id="spm_wiki">
+					<a href="/wiki" class="menubar headermenulink">Wiki</a>
+				</li>
+
+				<li class="headermenu" id="spm_bugtracker">
+					<a href="/mantis" class="menubar headermenulink">Report a bug</a>
+				</li>
+
+				<li class="headermenuright" id="spm_download">
+					<a href="/wiki/Download" class="menubar headermenurightlink">
+						<img src="/images/download.gif" width="11" height="10" border="0" alt="" style="margin-right: 5px" />
+						Download
+					</a>
+				</li>
+			</ul>
+		</div>
+	</div>
+
+	<div id="maincontentwrapper">
+
+	<table border="0" cellspacing="0" cellpadding="0" align="center" width="100%">
+		<tr>
+			<td class="locationbar" height="25"><?php echo (isset($this->_rootref['PAGE_TITLE'])) ? $this->_rootref['PAGE_TITLE'] : ''; ?></td>
+		</tr>
\ No newline at end of file
diff -ruN phpBB-3.0.10/common.php phpbb/common.php
--- phpBB-3.0.10/common.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/common.php	2013-09-28 03:20:51.000000000 +0200
@@ -26,6 +26,8 @@
 if (!defined('PHPBB_INSTALLED'))
 {
 	// Redirect the user to the installer
+	require($phpbb_root_path . 'includes/functions.' . $phpEx);
+
 	// We have to generate a full HTTP/1.1 header here since we can't guarantee to have any of the information
 	// available as used by the redirect function
 	$server_name = (!empty($_SERVER['HTTP_HOST'])) ? strtolower($_SERVER['HTTP_HOST']) : ((!empty($_SERVER['SERVER_NAME'])) ? $_SERVER['SERVER_NAME'] : getenv('SERVER_NAME'));
@@ -38,10 +40,13 @@
 		$script_name = (!empty($_SERVER['REQUEST_URI'])) ? $_SERVER['REQUEST_URI'] : getenv('REQUEST_URI');
 	}
 
+	// $phpbb_root_path accounts for redirects from e.g. /adm
+	$script_path = trim(dirname($script_name)) . '/' . $phpbb_root_path . 'install/index.' . $phpEx;
 	// Replace any number of consecutive backslashes and/or slashes with a single slash
 	// (could happen on some proxy setups and/or Windows servers)
-	$script_path = trim(dirname($script_name)) . '/install/index.' . $phpEx;
 	$script_path = preg_replace('#[\\\\/]{2,}#', '/', $script_path);
+	// Eliminate . and .. from the path
+	$script_path = phpbb_clean_path($script_path);
 
 	$url = (($secure) ? 'https://' : 'http://') . $server_name;
 
diff -ruN phpBB-3.0.10/config.php phpbb/config.php
--- phpBB-3.0.10/config.php	2012-01-01 16:14:53.000000000 +0100
+++ phpbb/config.php	2014-04-15 14:31:18.652429005 +0200
@@ -0,0 +1,20 @@
+<?php
+// phpBB 3.0.x auto-generated configuration file
+// Do not change anything in this file!
+$dbms = 'mysqli';
+$dbport = '';
+
+include(dirname(__FILE__) . '/../../springpw.php');
+$dbhost = $spring_dbhost;
+$dbname = $spring_dbname;
+$dbuser = $spring_dbuser;
+$dbpasswd = $spring_dbpass;
+
+$table_prefix = 'phpbb3_';
+$acm_type = 'file';
+$load_extensions = '';
+
+@define('PHPBB_INSTALLED', true);
+// @define('DEBUG', true);
+// @define('DEBUG_EXTRA', true);
+?>
diff -ruN phpBB-3.0.10/docs/auth_api.html phpbb/docs/auth_api.html
--- phpBB-3.0.10/docs/auth_api.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/docs/auth_api.html	2013-09-28 03:20:51.000000000 +0200
@@ -200,7 +200,7 @@
 $auth->acl_clear_prefetch($user_id);
 </pre></div>
 
-	<p>This method returns void.</p>
+	<p>This method returns null.</p>
 
 	<a name="acl_get_list"></a><h3>2.viii. acl_get_list</h3>
 
@@ -275,7 +275,7 @@
 
 		<div class="content">
 
-	<p>This application is opensource software released under the <a href="http://opensource.org/licenses/gpl-license.php">GPL</a>. Please see source code and the docs directory for more details. This package and its contents are Copyright (c) <a href="http://www.phpbb.com/">phpBB Group</a>, All Rights Reserved.</p>
+	<p>This application is opensource software released under the <a href="http://opensource.org/licenses/gpl-2.0.php">GNU General Public License v2</a>. Please see source code and the docs directory for more details. This package and its contents are Copyright (c) <a href="https://www.phpbb.com/">phpBB Group</a>, All Rights Reserved.</p>
 
 		</div>
 
diff -ruN phpBB-3.0.10/docs/AUTHORS phpbb/docs/AUTHORS
--- phpBB-3.0.10/docs/AUTHORS	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/docs/AUTHORS	2013-09-28 03:20:51.000000000 +0200
@@ -13,7 +13,7 @@
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
-* along with this program. If not, see <http://opensource.org/licenses/gpl-license.php>.
+* along with this program. If not, see <http://opensource.org/licenses/gpl-2.0.php>
 *
 */
 
@@ -22,15 +22,11 @@
 
 phpBB Lead Developer:  naderman (Nils Adermann)
 
-phpBB Developers:      Acyd Burn (Meik Sievertsen) [Lead 09/2005 - 01/2010]
-                       bantu (Andreas Fischer)
-                       ckwalsh (Cullen Walsh)
-                       igorw (Igor Wiedler)
-                       kellanved (Henry Sudhof)
+phpBB Developers:      bantu (Andreas Fischer)
+                       EXreaction (Nathan Guse)
+                       dhruv.goel92 (Dhruv Goel)
+                       imkingdavid (David King)
                        nickvergessen (Joas Schilling)
-                       Oleg (Oleg Pudeyev)
-                       rxu (Ruslan Uzdenov)
-                       ToonArmy (Chris Smith)
 
 Contributions by:      leviatan21 (Gabriel Vazquez)
                        Raimon (Raimon Meuldijk)
@@ -39,19 +35,28 @@
 
 -- Former Contributors --
 
-phpBB Project Manager: theFinn (James Atkinson) [Founder - 04/2007]
+phpBB Project Manager: theFinn (James Atkinson)      [Founder - 04/2007]
                        SHS` (Jonathan Stanley)
 
-phpBB Lead Developer:  psoTFX (Paul S. Owen) [2001 - 09/2005]
+phpBB Lead Developer:  Acyd Burn (Meik Sievertsen)   [09/2005 - 01/2010]
+                       psoTFX (Paul S. Owen)         [2001 - 09/2005]
 
 phpBB Developers:      A_Jelly_Doughnut (Josh Woody) [01/2010 - 11/2010]
+                       Acyd Burn (Meik Sievertsen)   [02/2003 - 09/2005]
                        APTX (Marek A. Ruszczyski)   [12/2007 - 04/2011]
+                       Arty (Vjacheslav Trushkin)    [02/2012 - 07/2012]
                        Ashe (Ludovic Arnaud)         [10/2002 - 11/2003, 06/2006 - 10/2006]
                        BartVB (Bart van Bragt)       [11/2000 - 03/2006]
+                       ckwalsh (Cullen Walsh)        [01/2010 - 07/2011]
                        DavidMJ (David M.)            [12/2005 - 08/2009]
                        dhn (Dominik Drscher)        [05/2007 - 01/2011]
                        GrahamJE (Graham Eames)       [09/2005 - 11/2006]
+                       kellanved (Henry Sudhof)      [04/2007 - 03/2011]
+                       igorw (Igor Wiedler)          [08/2010 - 02/2013]
+                       Oleg (Oleg Pudeyev)           [01/2011 - 05/2013]
+                       rxu (Ruslan Uzdenov)          [04/2010 - 12/2012]
                        TerraFrost (Jim Wigginton)    [04/2009 - 01/2011]
+                       ToonArmy (Chris Smith)        [06/2008 - 11/2011]
                        Vic D'Elfant (Vic D'Elfant)   [04/2007 - 04/2009]
 
 -- Copyrights --
diff -ruN phpBB-3.0.10/docs/CHANGELOG.html phpbb/docs/CHANGELOG.html
--- phpBB-3.0.10/docs/CHANGELOG.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/docs/CHANGELOG.html	2013-09-28 03:20:51.000000000 +0200
@@ -53,6 +53,8 @@
 <ol>
 	<li><a href="#changelog">Changelog</a>
 	<ol style="list-style-type: lower-roman;">
+		<li><a href="#v3011">Changes since 3.0.11</a></li>
+		<li><a href="#v3010">Changes since 3.0.10</a></li>
 		<li><a href="#v309">Changes since 3.0.9</a></li>
 		<li><a href="#v308">Changes since 3.0.8</a></li>
 		<li><a href="#v307-PL1">Changes since 3.0.7-PL1</a></li>
@@ -91,7 +93,287 @@
 
 		<div class="content">
 
-	<a name="v309"></a><h3>1.i. Changes since 3.0.9</h3>
+	<a name="v3011"></a><h3>1.i. Changes since 3.0.11</h3>
+
+<h4>Bug</h4>
+<ul>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-6723">PHPBB3-6723</a>] - Empty message in deleted messages in PM history</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-7262">PHPBB3-7262</a>] - Clarify docs about is_dynamic not being updated by set_config()</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-8319">PHPBB3-8319</a>] - LOCAL_URL not enforced in bbcodes</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-9551">PHPBB3-9551</a>] - Mysql fulltext index creation fails due to partial collation change</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-9975">PHPBB3-9975</a>] - Hard coded language in sessions.php</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10184">PHPBB3-10184</a>] - Bots can be sent private messages</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10491">PHPBB3-10491</a>] - Fatal error in functional tests when server returns 404</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10568">PHPBB3-10568</a>] - Modify the trigger language when you edit a PM</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10602">PHPBB3-10602</a>] - A bug in mail queue processing</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10661">PHPBB3-10661</a>] - UCP &gt; PM &gt; Compose &gt; enumerated recipients &gt; BCC group misses a &amp;nbsp; (prosilver)</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10678">PHPBB3-10678</a>] - Provide Firebird, Oracle, and increased MSSQL support in unit tests</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10772">PHPBB3-10772</a>] - trigger_error is using the default style</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10789">PHPBB3-10789</a>] - PM print template (prosilver) with unnecessary variables</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10820">PHPBB3-10820</a>] - Display images directly in IE9 and 10 instead of download</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10828">PHPBB3-10828</a>] - PostgreSQL dbal tests try to connect to the database named as user specified in configuration</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10838">PHPBB3-10838</a>] - Functional tests are not mentioned in RUNNING_TESTS.txt</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10840">PHPBB3-10840</a>] - If you add a member to a group, the form_token can be set to 0 if the creation_time is 0 too. Maybe even if creation_time is unchanged.</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10848">PHPBB3-10848</a>] - Wrong redirect to installer from acp</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10850">PHPBB3-10850</a>] - create_schema_files.php is not creating the oracle or postgres' schema file properly</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10879">PHPBB3-10879</a>] - prosilver: attachment-link will be displayed wrong, when filename is too long </li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10880">PHPBB3-10880</a>] - m_approve should not imply f_noapprove</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10896">PHPBB3-10896</a>] - board_email &amp; board_contact are not validated as email addresses in ACP</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10897">PHPBB3-10897</a>] - Bot Definitions are outdated</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10918">PHPBB3-10918</a>] - docs/INSTALL.html claims there are tar.gz packages</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10943">PHPBB3-10943</a>] - Search Box should display keywords entered by the user</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10967">PHPBB3-10967</a>] - PHPBB_USE_BOARD_URL_PATH not implemented in posting_gen_topic_icons</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10986">PHPBB3-10986</a>] - Invalid email message ids because config variable server_name is used even when force server URL settings is disabled</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10995">PHPBB3-10995</a>] - Return value of $db-&gt;sql_fetchrow() on empty tables is not consistent on mssqlnative</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10996">PHPBB3-10996</a>] - Travis tests fail on Postgres because database does not exist</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11034">PHPBB3-11034</a>] - The functional test case framework does not install a full board each time</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11066">PHPBB3-11066</a>] - MSSQLnative driver contains debug code error_reporting(E_ALL)</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11069">PHPBB3-11069</a>] - missing closing span in subsilver2 simple_footer.html</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11081">PHPBB3-11081</a>] - Duplicated /TD in styles/subsilver2/template/catpcha_qa.html</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11093">PHPBB3-11093</a>] - acp_users_overview.html has a wrongly placed &lt;/dd&gt;</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11094">PHPBB3-11094</a>] - prosilver: searching for users: no textbox for Jabber</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11105">PHPBB3-11105</a>] - Missing mandatory space in meta http-equiv=refresh</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11112">PHPBB3-11112</a>] - phpBB Footer Link should be SSL</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11122">PHPBB3-11122</a>] - Update docs/AUTHORS for 3.0.12-RC1</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11144">PHPBB3-11144</a>] - {FORUM_NAME} is not filled in login mask when logging into a password protected forum</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11145">PHPBB3-11145</a>] - ATTACHED_IMAGE_NOT_IMAGE thrown because of file limit in php.ini</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11158">PHPBB3-11158</a>] - modules table lacks acl_u_sig for signature module</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11159">PHPBB3-11159</a>] - Coding guidelines: static public</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11164">PHPBB3-11164</a>] - Composer not finding symfony/config in PHP 5.3.3</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11178">PHPBB3-11178</a>] - database_update.php should not set error_reporting to E_ALL</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11186">PHPBB3-11186</a>] - Database unit tests fail on windows using sqlite2</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11190">PHPBB3-11190</a>] - Functional tests do not clear the cache between each test</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11196">PHPBB3-11196</a>] - /includes/session.php sends 401 HTTP status with &quot;Not authorized&quot; instead of &quot;Unauthorized&quot;</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11219">PHPBB3-11219</a>] - Database sequences are not updated for tests using fixtures with auto_incremented columns</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11227">PHPBB3-11227</a>] - @return void -&gt; @return null</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11233">PHPBB3-11233</a>] - Anonymous can be selected as a PM recipient</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11248">PHPBB3-11248</a>] - CRLF line endings</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11262">PHPBB3-11262</a>] - .lock files are not in .gitignore</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11265">PHPBB3-11265</a>] - Functional tests do not assert that board installation succeeded</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11269">PHPBB3-11269</a>] - Travis functional test case errors</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11278">PHPBB3-11278</a>] - Firebird tables are not removed correctly on 3.0.9-rc1 update</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11291">PHPBB3-11291</a>] - &quot;Could not open input file: ../composer.phar&quot; error during phing's create-package</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11292">PHPBB3-11292</a>] - Newlines removed in display of PM reports, no clickable links in PM reports</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11301">PHPBB3-11301</a>] - &quot;String offset cast occured&quot; error on PHP 5.4</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11304">PHPBB3-11304</a>] - check_form_key breaks in tests when form is submitted in the same second it is retrieved</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11343">PHPBB3-11343</a>] - Loose string comparison during new password activation</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11355">PHPBB3-11355</a>] - Incorrect error message when no user selected for action on group membership management page</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11358">PHPBB3-11358</a>] - Success message even withot selecting a user and performing a group operation</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11361">PHPBB3-11361</a>] - &quot;Array to string conversion&quot; error in $user-&gt;format_date()</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11493">PHPBB3-11493</a>] - Functional tests should fail if any debug output is made</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11517">PHPBB3-11517</a>] - Numbering is wrong in coding guidelines</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11536">PHPBB3-11536</a>] - Installer incorrectly removes /install from script_path</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11537">PHPBB3-11537</a>] - UCP group manage page's error box differs heavily from the rest of the UCP</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11538">PHPBB3-11538</a>] - SQL error on UCP groups manage page caused by setting color to 7 characters long string</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11544">PHPBB3-11544</a>] - Add admin_login() to 3.0 functional test case</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11545">PHPBB3-11545</a>] - is_absolute() should not depend on DIRECTORY_SEPARATOR</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11546">PHPBB3-11546</a>] - is_absolute() throws E_NOTICE for empty string</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11547">PHPBB3-11547</a>] - Test fixtures do not support utf8 characters</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11548">PHPBB3-11548</a>] - Untranslated TOO_SHORT in UCP &quot;Manage Groups&quot;</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11566">PHPBB3-11566</a>] - Reporting a post should require a captcha to be solved by guests</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11568">PHPBB3-11568</a>] - Functional tests fail with retrieving install pages using file_get_contents</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11575">PHPBB3-11575</a>] - phpbb_dbal_order_lower_test::test_cross_join should be called test_order_lower</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11578">PHPBB3-11578</a>] - Missing underscore after function prefix in validate_data()</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11579">PHPBB3-11579</a>] - Add unit tests for validate_data()</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11580">PHPBB3-11580</a>] - Avoid API Limit from composer downloads on github</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11588">PHPBB3-11588</a>] - install/install_update.php should use version.phpbb.com instead of www</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11590">PHPBB3-11590</a>] - Close database connections from tests whenever possible</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11601">PHPBB3-11601</a>] - Allow manual resync of database columns in unit tests not only on fixture load</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11603">PHPBB3-11603</a>] - git-tools use invalid api urls</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11604">PHPBB3-11604</a>] - Functional tests fail when phpBB can not create the config file</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11617">PHPBB3-11617</a>] - Missing U_ACTION in acp_captcha.php</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11618">PHPBB3-11618</a>] - Template tests fail on some systems due to a PHP error in glob()</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11619">PHPBB3-11619</a>] - get_remote_file() should use HTTP 1.0</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11630">PHPBB3-11630</a>] - Improvements to the PHP lint pre-commit hook</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11644">PHPBB3-11644</a>] - Skip phpbb_dbal_order_lower_test on MySQL 5.6</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11662">PHPBB3-11662</a>] - &quot;occured&quot; should be &quot;occurred&quot;</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11670">PHPBB3-11670</a>] - Replace trademark  with  on &quot;Welcome to phpBB&quot; install page</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11674">PHPBB3-11674</a>] - Do not include vendor folder if there are no dependencies.</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11524">PHPBB3-11524</a>] - MySQL Upgrader throws warnings on PHP 5.4</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11720">PHPBB3-11720</a>] - Reporting posts leads to white page error</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11769">PHPBB3-11769</a>] - Wrong poster in subscription email when poster is using the Quote button</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11775">PHPBB3-11775</a>] - Error while moving posts to a new topic</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11802">PHPBB3-11802</a>] - Undefined variable $browser in /download/file.php</li>
+</ul>
+<h4>Improvement</h4>
+<ul>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-8743">PHPBB3-8743</a>] - New topic / reply notifications do not contain author's name.</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10050">PHPBB3-10050</a>] - subsilver2: Do not show &quot;Mark topics as read&quot; when there are no topics</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10205">PHPBB3-10205</a>] - More informative reporting of errors when database connection fails (MySQL and others)</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10716">PHPBB3-10716</a>] - PHP-parse all php files as part of the test suite</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10841">PHPBB3-10841</a>] - Disable style and language selectors if there's only one installed.</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10854">PHPBB3-10854</a>] - sql server drop default constraint when dropping column </li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10865">PHPBB3-10865</a>] - Updated and Added to docs/INSTALL.html</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10873">PHPBB3-10873</a>] - Change language entry for deleted PMs</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10981">PHPBB3-10981</a>] - Upgrade Goutte and use Composer for Installation</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11131">PHPBB3-11131</a>] - Phrasing &amp; semantics of Board settings</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11162">PHPBB3-11162</a>] - Get rid of $db-&gt;sql_return_on_error(true) trickery when splitting/merging topics</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11192">PHPBB3-11192</a>] - Add Tebibyte to get_formatted_filesize()</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11202">PHPBB3-11202</a>] - Add response status checks to functional tests</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11220">PHPBB3-11220</a>] - Improve tooltip explaining the [list=] - BBcode</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11238">PHPBB3-11238</a>] - Specify goutte version</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11285">PHPBB3-11285</a>] - Use more granularity in dependency checks in compress test</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11293">PHPBB3-11293</a>] - Prefer mysqli over mysql due to php 5.5 alpha 2 deprecating mysql</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11294">PHPBB3-11294</a>] - Update extension list in running tests doc</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11368">PHPBB3-11368</a>] - Latest pm reports row count</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11583">PHPBB3-11583</a>] - InnoDB supports FULLTEXT index since MySQL 5.6.4.</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11740">PHPBB3-11740</a>] - Update link in FAQ to Ideas Centre</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11873">PHPBB3-11873</a>] - Prevent expensive hash computation in phpbb_check_hash() by rejecting very long passwords</li>
+</ul>
+<h4>Sub-task</h4>
+<ul>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10974">PHPBB3-10974</a>] - Move tests/mock_user.php to tests/mock/user.php</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11009">PHPBB3-11009</a>] - Backport phing build.xml from develop to develop-olympus so it uses composer.</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11540">PHPBB3-11540</a>] - Add unit tests for (phpbb_)is_absolute()</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11541">PHPBB3-11541</a>] - Add unit tests for style_select() in functions.php</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11542">PHPBB3-11542</a>] - Add unit tests for language_select() in functions.php</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11543">PHPBB3-11543</a>] - Add unit tests for obtain online functions in functions.php</li>
+</ul>
+<h4>Task</h4>
+<ul>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10877">PHPBB3-10877</a>] - Have bamboo generate and publish a phpBB package for every build.</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11045">PHPBB3-11045</a>] - Add unit tests for the compress class</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11059">PHPBB3-11059</a>] - Fix README logo</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11060">PHPBB3-11060</a>] - Fix travis.yml pyrus config</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11240">PHPBB3-11240</a>] - Turn on PHPUnit's verbose mode on Travis</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11324">PHPBB3-11324</a>] - Add PHP 5.5 environment on Travis-CI</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11337">PHPBB3-11337</a>] - Run functional tests on Travis CI</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11513">PHPBB3-11513</a>] - Install PHPUnit via Composer's require-dev to simplify test running (no need for pear)</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11526">PHPBB3-11526</a>] - Increase composer minimum-stability from beta to stable</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11527">PHPBB3-11527</a>] - Upgrade composer.phar to 1.0.0-alpha7</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11529">PHPBB3-11529</a>] - Rename RUNNING_TESTS file to .md file to render it on GitHub</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11576">PHPBB3-11576</a>] - Make phpBB Test Suite MySQL behave at least as strict as phpBB MySQL driver</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11671">PHPBB3-11671</a>] - Add phing/phing to composer.json</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11752">PHPBB3-11752</a>] - Update phpBB.com URLs to https in email templates</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-11753">PHPBB3-11753</a>] - Upgrade mysql_upgrader.php schema data.</li>
+</ul>
+
+	<a name="v3010"></a><h3>1.ii. Changes since 3.0.10</h3>
+
+<h4>Bug</h4>
+<ul>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-7432">PHPBB3-7432</a>] - Unclear language for Inactive Users on ACP main page</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-8652">PHPBB3-8652</a>] - Duplicate Emails Sent When Subscribed to Forum and Topic</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-9079">PHPBB3-9079</a>] - Display backtrace on all E_USER_ERROR errors, not only SQL errors (when DEBUG_EXTRA is enabled)</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-9084">PHPBB3-9084</a>] - Unable to display 'option equal to non entered value' if dropdown CPF is not required</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-9089">PHPBB3-9089</a>] - PM message title box not accessible via Tab key</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-9220">PHPBB3-9220</a>] - Blue border width when table in a div</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-9681">PHPBB3-9681</a>] - Password length not in security settings</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-9813">PHPBB3-9813</a>] - fulltext_native.php on innodb loading deadly slow for big indexes</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-9831">PHPBB3-9831</a>] - Cannot change default of Boolean checkbox custom profile field</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10094">PHPBB3-10094</a>] - Clear cache before phpBB installation</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10129">PHPBB3-10129</a>] - Missing apostrophes in ACP user management -&gt; permissions</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10349">PHPBB3-10349</a>] - Unit tests do not remove comments from schemas</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10399">PHPBB3-10399</a>] - Special characters aren't parsed in style component variables</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10401">PHPBB3-10401</a>] - auth_ldap has an incorrect return value in login_ldap()</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10407">PHPBB3-10407</a>] - Incorrect check for empty image file paths during conversion</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10428">PHPBB3-10428</a>] - optionget/optionset functions in session.php and acp_users.php incorrectly check whether $data is at its default value</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10456">PHPBB3-10456</a>] - Subsilver2 does not define $CAPTCHA_TAB_INDEX</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10508">PHPBB3-10508</a>] - Marking forums as read displays misleading language</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10511">PHPBB3-10511</a>] - Grammar defect in permissions language</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10512">PHPBB3-10512</a>] - Test failure when no default timezone is set in php</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10532">PHPBB3-10532</a>] - Out of range $start causes a page with no search results but with pagination</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10538">PHPBB3-10538</a>] - Special character are not correctly parsed for SMTP protocol</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10542">PHPBB3-10542</a>] - Incorrect class=&quot;postlink&quot; in styles/subsilver2/template/faq_body.html</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10546">PHPBB3-10546</a>] - Argument missing for adm_back_link() in acp_captcha.php</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10561">PHPBB3-10561</a>] - All users can choose deactivated styles.</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10569">PHPBB3-10569</a>] - template/ucp_main_front.html does not correctly handle active topic with the name &quot;0&quot;</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10580">PHPBB3-10580</a>] - Default tz in registration dropdown not the same as the board default tz</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10589">PHPBB3-10589</a>] - user_birthday does not use table alias in $leap_year_birthdays variable definition</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10605">PHPBB3-10605</a>] - Orpahned privmsgs are left in the prvmsgs table, with no ties in privmsgs_to table</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10606">PHPBB3-10606</a>] - $s_hidden_fields -&gt; incorrect array name (3 files affected)</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10611">PHPBB3-10611</a>] - Add a check for selected tables existence for ACP database backup tool</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10615">PHPBB3-10615</a>] - Static calls in utf normalizer yield E_STRICT spam on php 5.4</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10630">PHPBB3-10630</a>] - Prune Users produced unnecessarily long query; Got a packet bigger than 'max_allowed_packet' bytes</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10633">PHPBB3-10633</a>] - Users are able to get the real filename of attachment</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10639">PHPBB3-10639</a>] - negative value of ranks message</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10658">PHPBB3-10658</a>] - Rank-item is not shown on team-list</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10675">PHPBB3-10675</a>] - Use more descriptive message when disk is out of space</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10684">PHPBB3-10684</a>] - Function user_notification() prevents notifications for users with stale bans</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10689">PHPBB3-10689</a>] - Bug in the popup &quot; Find a member&quot; when select by letter.</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10691">PHPBB3-10691</a>] - Search index creation CLI script incorrectly calculates indexing speed</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10699">PHPBB3-10699</a>] - Long h2 title breaks div.minitabs in MCP</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10708">PHPBB3-10708</a>] - After a conversion, passwords with UTF8 characters do not work when user_pass_convert is set.</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10717">PHPBB3-10717</a>] - memberlist_view.html: including admin defined profile fields doesnt work</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10723">PHPBB3-10723</a>] - Do not use SQLite on PHP 5.4 in Tests on Travis</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10731">PHPBB3-10731</a>] - JS function addquote() works incorrectly in Opera</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10751">PHPBB3-10751</a>] - MS SQL Error when searching Admin Log</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10760">PHPBB3-10760</a>] - In pre-commit git hook, syntax error is thrown, but is not specifically described</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10767">PHPBB3-10767</a>] - Git hooks do not work properly with git GUIs</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10774">PHPBB3-10774</a>] - db_tools::create_unique_index does not use specified index names on MySQL</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10790">PHPBB3-10790</a>] - Strict comparison on user_id for sending pms</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10797">PHPBB3-10797</a>] - Template var for user rank not filled</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10835">PHPBB3-10835</a>] - Misleading message in UCP when no permission to change password</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10846">PHPBB3-10846</a>] - Missing alias for MAX(post_id) in SQL query in acp_main.php</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10849">PHPBB3-10849</a>] - Missing BBCode Help Text in subsilver2</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10858">PHPBB3-10858</a>] - $db-&gt;sql_fetchfield returns false with mssqlnative</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10860">PHPBB3-10860</a>] - Side-by-side diff styling javascript bug</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10881">PHPBB3-10881</a>] - Some files use 0xA9 as the copyright symbol which is neither ASCII nor the UTF8 copyright symbol.</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10887">PHPBB3-10887</a>] - Auto increment tests depend on varbinary handling</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10889">PHPBB3-10889</a>] - Default value for c_char_size in database unit tests is an empty string instead of a char(4)</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10890">PHPBB3-10890</a>] - test_sql_fetchrow_returns_false_when_empty() fails on MSSQL and Oracle</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10908">PHPBB3-10908</a>] - No remote avatar size limit results in files limited only by PHP memory limit</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10913">PHPBB3-10913</a>] - Admin is logged out when accessing any url under adm/ without session id</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10441">PHPBB3-10441</a>] - Update to docs/README.html</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10773">PHPBB3-10773</a>] - ACP phpBB logo needs registered trademark symbol</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10935">PHPBB3-10935</a>] - Limit number of PM rules per user</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10937">PHPBB3-10937</a>] - Comment removal functions: Backward compatibility broken</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10950">PHPBB3-10950</a>] - Deleting user with undelivered PMs causes SQL error</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10952">PHPBB3-10952</a>] - includes/constants.php version number incorrect</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10965">PHPBB3-10965</a>] - Dropdown CPF now shows in profile when no value is selected</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10978">PHPBB3-10978</a>] - Typo in prosilvers ucp_groups_membership.html</li>
+</ul>
+<h4>Improvement</h4>
+<ul>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-8599">PHPBB3-8599</a>] - Add &quot;Select All&quot; to &quot;Add multiple smilies&quot; screen</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-8636">PHPBB3-8636</a>] - Add resync option to topic_view moderation page</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-9876">PHPBB3-9876</a>] - Names and descriptions for roles &quot;Newly registered User&quot; in &quot;User roles&quot; and &quot;Forum roles&quot; must be different</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-9914">PHPBB3-9914</a>] - Add backup warning to Automatic DB Updater</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-9916">PHPBB3-9916</a>] - License in header not linking to version 2 of GNU GPL</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10093">PHPBB3-10093</a>] - Make commit-msg hook always not fatal</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10162">PHPBB3-10162</a>] - Allow TLDs over 6 characters in email addresses</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10280">PHPBB3-10280</a>] - Change the ACP user activation display</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10308">PHPBB3-10308</a>] - Disable Retain/Delete Posts selection if the user has no posts.</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10453">PHPBB3-10453</a>] - PM viewmessage page is misplacing the online icon</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10492">PHPBB3-10492</a>] - Port functional tests to develop-olympus</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10507">PHPBB3-10507</a>] - Sort installed styles list in admin control panel - styles</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10550">PHPBB3-10550</a>] - Sort not installed styles list in admin control panel - styles</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10563">PHPBB3-10563</a>] - ACP usability improvement: show deactivated styles below active styles in styles list</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10565">PHPBB3-10565</a>] - Performance: Unneeded GROUP BY in update_forum_tracking_info</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10607">PHPBB3-10607</a>] - phpBB Credit Line Hardcoded</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10653">PHPBB3-10653</a>] - Add ability to count table rows to database abstraction layer</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10730">PHPBB3-10730</a>] - Add label tags around &quot;select&quot; text in post splitting UI in MCP</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10764">PHPBB3-10764</a>] - FAQ mentions SourceForge</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10812">PHPBB3-10812</a>] - Installer should not display register globals UI for php 5.4+</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10815">PHPBB3-10815</a>] - Enable Feeds by default</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10819">PHPBB3-10819</a>] - Improve side-by-side diff styling</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10834">PHPBB3-10834</a>] - Backport general development language changes in readme files</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10836">PHPBB3-10836</a>] - Enable Avatars by default</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10891">PHPBB3-10891</a>] - Allow specifying test config file name via environment variable</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10892">PHPBB3-10892</a>] - Cosmetic improvements to RUNNING_TESTS.txt</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10898">PHPBB3-10898</a>] - Do not write ?&gt; into config.php to avoid whitespace output</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10925">PHPBB3-10925</a>] - Clarify that SQLite3 is not supported for phpBB 3.0.x</li>
+</ul>
+<h4>New Feature</h4>
+<ul>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10616">PHPBB3-10616</a>] - Add template inheritance by default</li>
+</ul>
+<h4>Sub-task</h4>
+<ul>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10907">PHPBB3-10907</a>] - Mark (var)binary tests as incomplete on non-MySQL DBMSes</li>
+</ul>
+<h4>Task</h4>
+<ul>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-9896">PHPBB3-9896</a>] - Update links in docs/readme.html</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10434">PHPBB3-10434</a>] - Add a script that allows creating a search index from CLI</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10455">PHPBB3-10455</a>] - Remove NOTE from header files</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10694">PHPBB3-10694</a>] - Update notification in ACP (Olympus) for increase of minimum PHP version to 5.3.2</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10718">PHPBB3-10718</a>] - Add Travis CI</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10788">PHPBB3-10788</a>] - Update docs/AUTHORS for 3.0.11-RC1</li>
+<li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10909">PHPBB3-10909</a>] - Update Travis Test Configuration: Travis no longer supports PHP 5.3.2</li>
+</ul>
+
+	<a name="v309"></a><h3>1.iii. Changes since 3.0.9</h3>
 
 <h4>Bug</h4>
 <ul>
@@ -227,7 +509,7 @@
 <li>[<a href="http://tracker.phpbb.com/browse/PHPBB3-10480">PHPBB3-10480</a>] - Automate changelog building</li>
 </ul>
 
-	<a name="v308"></a><h3>1.ii. Changes since 3.0.8</h3>
+	<a name="v308"></a><h3>1.iv. Changes since 3.0.8</h3>
 
 <h4>        Bug
 </h4>
@@ -595,7 +877,7 @@
 </ul>
 
 
-	<a name="v307-PL1"></a><h3>1.iii. Changes since 3.0.7-PL1</h3>
+	<a name="v307-PL1"></a><h3>1.v. Changes since 3.0.7-PL1</h3>
 <h4>        Security
 </h4>
 <ul>
@@ -1053,13 +1335,13 @@
 </ul>
 
 
-	<a name="v307"></a><h3>1.iiv. Changes since 3.0.7</h3>
+	<a name="v307"></a><h3>1.vi. Changes since 3.0.7</h3>
 
 	<ul>
 		<li>[Sec] Do not expose forum content of forums with ACL entries but no actual permission in ATOM Feeds. (Bug #58595)</li>
 	</ul>
 
-	<a name="v306"></a><h3>1.v. Changes since 3.0.6</h3>
+	<a name="v306"></a><h3>1.vii. Changes since 3.0.6</h3>
 
 	<ul>
 		<li>[Fix] Allow ban reason and length to be selected and copied in ACP and subsilver2 MCP. (Bug #51095)</li>
@@ -1163,7 +1445,7 @@
 
 	</ul>
 
-	<a name="v305"></a><h3>1.vi. Changes since 3.0.5</h3>
+	<a name="v305"></a><h3>1.viii. Changes since 3.0.5</h3>
 
 	<ul>
 		<li>[Fix] Allow whitespaces in avatar gallery names. (Bug #44955)</li>
@@ -1385,7 +1667,7 @@
 		<li>[Feature] Send anonymous statistical information to phpBB on installation and update (optional).</li>
 	</ul>
 
-	<a name="v304"></a><h3>1.vii. Changes since 3.0.4</h3>
+	<a name="v304"></a><h3>1.ix. Changes since 3.0.4</h3>
 
 	<ul>
 		<li>[Fix] Delete user entry from ban list table upon user deletion (Bug #40015 - Patch by TerraFrost)</li>
@@ -1474,7 +1756,7 @@
 		<li>[Sec] Only use forum id supplied for posting if global announcement detected. (Reported by nickvergessen)</li>
 	</ul>
 
-	<a name="v303"></a><h3>1.viii. Changes since 3.0.3</h3>
+	<a name="v303"></a><h3>1.x. Changes since 3.0.3</h3>
 
 	<ul>
 		<li>[Fix] Allow mixed-case template directories to be inherited (Bug #36725)</li>
@@ -1506,7 +1788,7 @@
 		<li>[Sec] Ask for forum password if post within passworded forum quoted in private message. (Reported by nickvergessen)</li>
 	</ul>
 
-	<a name="v302"></a><h3>1.ix. Changes since 3.0.2</h3>
+	<a name="v302"></a><h3>1.xi. Changes since 3.0.2</h3>
 
 	<ul>
 		<li>[Fix] Correctly set topic starter if first post in topic removed (Bug #30575 - Patch by blueray2048)</li>
@@ -1605,7 +1887,7 @@
 		<li>[Sec Precaution] Stricter validation of the HTTP_HOST header (Thanks to Techie-Micheal et al for pointing out possible issues in derived code)</li>
 	</ul>
 
-	<a name="v301"></a><h3>1.x. Changes since 3.0.1</h3>
+	<a name="v301"></a><h3>1.xii. Changes since 3.0.1</h3>
 
 	<ul>
 		<li>[Fix] Ability to set permissions on non-mysql dbms (Bug #24955)</li>
@@ -1653,7 +1935,7 @@
 		<li>[Sec] Only allow urls gone through redirect() being used within login_box(). (thanks nookieman)</li>
 	</ul>
 
-	<a name="v300"></a><h3>1.xi Changes since 3.0.0</h3>
+	<a name="v300"></a><h3>1.xiii Changes since 3.0.0</h3>
 
 	<ul>
 		<li>[Change] Validate birthdays (Bug #15004)</li>
@@ -1724,7 +2006,7 @@
 		<li>[Fix] Find and display colliding usernames correctly when converting from one database to another (Bug #23925)</li>
 	</ul>
 
-	<a name="v30rc8"></a><h3>1.xii. Changes since 3.0.RC8</h3>
+	<a name="v30rc8"></a><h3>1.xiv. Changes since 3.0.RC8</h3>
 
 	<ul>
 		<li>[Fix] Cleaned usernames contain only single spaces, so &quot;a_name&quot; and &quot;a__name&quot; are treated as the same name (Bug #15634)</li>
@@ -1733,7 +2015,7 @@
 		<li>[Fix] Call garbage_collection() within database updater to correctly close connections (affects Oracle for example)</li>
 	</ul>
 
-	<a name="v30rc7"></a><h3>1.xiii. Changes since 3.0.RC7</h3>
+	<a name="v30rc7"></a><h3>1.xv. Changes since 3.0.RC7</h3>
 
 	<ul>
 		<li>[Fix] Fixed MSSQL related bug in the update system</li>
@@ -1768,7 +2050,7 @@
 		<li>[Fix] No duplication of active topics (Bug #15474)</li>
 	</ul>
 
-	<a name="v30rc6"></a><h3>1.xiv. Changes since 3.0.RC6</h3>
+	<a name="v30rc6"></a><h3>1.xvi. Changes since 3.0.RC6</h3>
 
 	<ul>
 		<li>[Fix] Submitting language changes using acp_language (Bug #14736)</li>
@@ -1778,7 +2060,7 @@
 		<li>[Fix] Able to request new password (Bug #14743)</li>
 	</ul>
 
-	<a name="v30rc5"></a><h3>1.xv. Changes since 3.0.RC5</h3>
+	<a name="v30rc5"></a><h3>1.xvii. Changes since 3.0.RC5</h3>
 
 	<ul>
 		<li>[Feature] Removing constant PHPBB_EMBEDDED in favor of using an exit_handler(); the constant was meant to achive this more or less.</li>
@@ -1841,7 +2123,7 @@
 		<li>[Sec] New password hashing mechanism for storing passwords (#i42)</li>
 	</ul>
 
-	<a name="v30rc4"></a><h3>1.xvi. Changes since 3.0.RC4</h3>
+	<a name="v30rc4"></a><h3>1.xviii. Changes since 3.0.RC4</h3>
 
 	<ul>
 		<li>[Fix] MySQL, PostgreSQL and SQLite related database fixes (Bug #13862)</li>
@@ -1892,7 +2174,7 @@
 		<li>[Fix] odbc_autocommit causing existing result sets to be dropped (Bug #14182)</li>
 	</ul>
 
-	<a name="v30rc3"></a><h3>1.xvii. Changes since 3.0.RC3</h3>
+	<a name="v30rc3"></a><h3>1.xix. Changes since 3.0.RC3</h3>
 
 	<ul>
 		<li>[Fix] Fixing some subsilver2 and prosilver style issues</li>
@@ -2001,7 +2283,7 @@
 
 	</ul>
 
-	<a name="v30rc2"></a><h3>1.xviii. Changes since 3.0.RC2</h3>
+	<a name="v30rc2"></a><h3>1.xx. Changes since 3.0.RC2</h3>
 
 	<ul>
 		<li>[Fix] Re-allow searching within the memberlist</li>
@@ -2047,7 +2329,7 @@
 
 	</ul>
 
-	<a name="v30rc1"></a><h3>1.xix. Changes since 3.0.RC1</h3>
+	<a name="v30rc1"></a><h3>1.xxi. Changes since 3.0.RC1</h3>
 
 	<ul>
 		<li>[Fix] (X)HTML issues within the templates (Bug #11255, #11255)</li>
@@ -2182,7 +2464,7 @@
 
 		<div class="content">
 
-	<p>This application is opensource software released under the <a href="http://opensource.org/licenses/gpl-license.php">GPL</a>. Please see source code and the docs directory for more details. This package and its contents are Copyright (c) <a href="http://www.phpbb.com/">phpBB Group</a>, All Rights Reserved.</p>
+	<p>This application is opensource software released under the <a href="http://opensource.org/licenses/gpl-2.0.php">GNU General Public License v2</a>. Please see source code and the docs directory for more details. This package and its contents are Copyright (c) <a href="https://www.phpbb.com/">phpBB Group</a>, All Rights Reserved.</p>
 
 		</div>
 
diff -ruN phpBB-3.0.10/docs/coding-guidelines.html phpbb/docs/coding-guidelines.html
--- phpBB-3.0.10/docs/coding-guidelines.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/docs/coding-guidelines.html	2013-09-28 03:20:51.000000000 +0200
@@ -129,9 +129,8 @@
 /**
 *
 * @package {PACKAGENAME}
-* @version &#36;Id: &#36;
 * @copyright (c) 2007 phpBB Group
-* @license http://opensource.org/licenses/gpl-license.php GNU Public License
+* @license http://opensource.org/licenses/gpl-2.0.php GNU General Public License v2
 *
 */
 	</pre></div>
@@ -957,6 +956,8 @@
 	<h4>Login checks/redirection: </h4>
 	<p>To show a forum login box use <code>login_forum_box($forum_data)</code>, else use the <code>login_box()</code> function.</p>
 
+	<p><code>$forum_data</code> should contain at least the <code>forum_id</code> and <code>forum_password</code> fields. If the field <code>forum_name</code> is available, then it is displayed on the forum login page.</p>
+
 	<p>The <code>login_box()</code> function can have a redirect as the first parameter. As a thumb of rule, specify an empty string if you want to redirect to the users current location, else do not add the <code>$SID</code> to the redirect string (for example within the ucp/login we redirect to the board index because else the user would be redirected to the login screen).</p>
 
 	<h4>Sensitive Operations: </h4>
@@ -1190,7 +1191,7 @@
 <span class="comment">&lt;!-- INCLUDEPHP somefile&#46;php --&gt;</span>
 </pre></div>
 
-<p>it will be included and executed inline.<br /><br />A note, it is very much encouraged that template designers do not include PHP. The ability to include raw PHP was introduced primarily to allow end users to include banner code, etc. without modifying multiple files (as with 2.0.x). It was not intended for general use ... hence <!-- w --><a href="http://www.phpbb.com">www.phpbb.com</a><!-- w --> will <strong>not</strong> make available template sets which include PHP. And by default templates will have PHP disabled (the admin will need to specifically activate PHP for a template).</p>
+<p>it will be included and executed inline.<br /><br />A note, it is very much encouraged that template designers do not include PHP. The ability to include raw PHP was introduced primarily to allow end users to include banner code, etc. without modifying multiple files (as with 2.0.x). It was not intended for general use ... hence <!-- w --><a href="https://www.phpbb.com">www.phpbb.com</a><!-- w --> will <strong>not</strong> make available template sets which include PHP. And by default templates will have PHP disabled (the admin will need to specifically activate PHP for a template).</p>
 
 <h4>Conditionals/Control structures</h4>
 <p>The most significant addition to 3.0.x are conditions or control structures, &quot;if something then do this else do that&quot;. The system deployed is very similar to Smarty. This may confuse some people at first but it offers great potential and great flexibility with a little imagination. In their most simple form these constructs take the form:</p>
@@ -2315,14 +2316,14 @@
 
 	<hr />
 
-<a name="disclaimer"></a><h2>8. Copyright and disclaimer</h2>
+<a name="disclaimer"></a><h2>7. Copyright and disclaimer</h2>
 
 	<div class="paragraph">
 		<div class="inner"><span class="corners-top"><span></span></span>
 
 		<div class="content">
 
-	<p>This application is opensource software released under the <a href="http://opensource.org/licenses/gpl-license.php">GPL</a>. Please see source code and the docs directory for more details. This package and its contents are Copyright (c) <a href="http://www.phpbb.com/">phpBB Group</a>, All Rights Reserved.</p>
+	<p>This application is opensource software released under the <a href="http://opensource.org/licenses/gpl-2.0.php">GNU General Public License v2</a>. Please see source code and the docs directory for more details. This package and its contents are Copyright (c) <a href="https://www.phpbb.com/">phpBB Group</a>, All Rights Reserved.</p>
 
 		</div>
 
diff -ruN phpBB-3.0.10/docs/FAQ.html phpbb/docs/FAQ.html
--- phpBB-3.0.10/docs/FAQ.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/docs/FAQ.html	2013-09-28 03:20:51.000000000 +0200
@@ -89,7 +89,7 @@
 
 <p>There are people, companies (unrelated to your hosting provider), etc. that will install your forum, either for free or for a payment. We do not recommend you make use of these offers. Unless the service is provided by your hosting company you will have to divulge passwords and other sensitive details. If you did not know how to use an ATM would you give a passer-by your bank card and PIN and ask them to show you what to do? No, probably not! The same applies to your hosting account details!</p>
 
-<p>We think a better solution is for you to carefully read the enclosed documentation, read through our knowledge base at <a href="http://www.phpbb.com/">www.phpbb.com</a> and if necessary ask for help on any thing you get stuck on. However, the decision is yours but please note we may not offer support if we believe you have had the board installed by a third party. In such cases you should direct your questions to that company or person/s.</p>
+<p>We think a better solution is for you to carefully read the enclosed documentation, read through our knowledge base at <a href="https://www.phpbb.com/">www.phpbb.com</a> and if necessary ask for help on any thing you get stuck on. However, the decision is yours but please note we may not offer support if we believe you have had the board installed by a third party. In such cases you should direct your questions to that company or person/s.</p>
 
 		</div>
 
@@ -110,7 +110,7 @@
 
 		<div class="content">
 
-<p>We provide the software, we have absolutely nothing to do with any board that runs it (beyond phpbb.com of course!) and we also do not host any site. The GPL grants the user an unlimited right of use subject to their adherence of that licence. Therefore we cannot prevent, dictate, control or otherwise limit the use of phpBB software. So please do not contact us for such matters.</p>
+<p>We provide the software, we have absolutely nothing to do with any board that runs it (beyond phpbb.com of course!) and we also do not host any site. The GPL grants the user an unlimited right of use subject to their adherence of that license. Therefore we cannot prevent, dictate, control or otherwise limit the use of phpBB software. So please do not contact us for such matters.</p>
 
 <p>If you have a problem with a given board please take it up with them, not us. We are not and cannot be held legally responsible for any third party use of this software (much like Microsoft et al cannot be held responsible for the use of Windows in illegal activities, etc.). Additionally we do <strong>not</strong> track the use of phpBB software in any way. So please do not ask us for details on a &quot;given&quot; board we will not be able to help you. If any law firms or lawyers out there send us writs, cease and desist orders, etc. for third party website use of this software we reserve the right to charge for time wasted dealing with such issues...</p>
 
@@ -150,7 +150,7 @@
 
 		<div class="content">
 
-<p>This error will occur if phpBB cannot send mail. phpBB can send email two ways; using the PHP <code>mail()</code> function or directly via SMTP. Some hosting providers limit the <code>mail()</code> function to prevent its use in spamming, others may rename it or limit its functionality. If the <code>mail()</code> function got renamed, you are able to enter the correct name within the administration control panel. In either case you may need to make use of SMTP. This requires that you have access to such a facility, e.g. your hosting provider may provide one (perhaps requiring specific written authorisation), etc. Please see <a href="http://www.phpbb.com/">www.phpbb.com</a> for additional help on this matter.</p>
+<p>This error will occur if phpBB cannot send mail. phpBB can send email two ways; using the PHP <code>mail()</code> function or directly via SMTP. Some hosting providers limit the <code>mail()</code> function to prevent its use in spamming, others may rename it or limit its functionality. If the <code>mail()</code> function got renamed, you are able to enter the correct name within the administration control panel. In either case you may need to make use of SMTP. This requires that you have access to such a facility, e.g. your hosting provider may provide one (perhaps requiring specific written authorisation), etc. Please see <a href="https://www.phpbb.com/">www.phpbb.com</a> for additional help on this matter.</p>
 
 <p>If you do require SMTP services please do not ask (on our forums or elsewhere) for someone to provide you with one. Open relays are now things of the past thanks to the unthinking spammers out there. Therefore you are unlikely to find someone willing to offer you (free) services.</p>
 
@@ -250,7 +250,7 @@
 
 		<div class="content">
 
-<p>Please read the paragraph about permissions in our extensive <a href="http://www.phpbb.com/support/documentation/3.0/">online documentation</a>.</p>
+<p>Please read the paragraph about permissions in our extensive <a href="https://www.phpbb.com/support/documentation/3.0/">online documentation</a>.</p>
 
 		</div>
 
@@ -306,11 +306,11 @@
 
 		<div class="content">
 
-<p>Please read our <a href="http://www.phpbb.com/support/documentation/3.0/">extensive user documentation</a> first, it may just explain what you want to know.</p>
+<p>Please read our <a href="https://www.phpbb.com/support/documentation/3.0/">extensive user documentation</a> first, it may just explain what you want to know.</p>
 
 <p>Feel free to search our community forum for the information you require. <strong>PLEASE DO NOT</strong> post your question without having first used search, chances are someone has already asked and answered your question. You can find our board here:</p>
 
-<p><a href="http://www.phpbb.com">www.phpbb.com</a></p>
+<p><a href="https://www.phpbb.com">www.phpbb.com</a></p>
 
 		</div>
 
@@ -328,7 +328,7 @@
 
 		<div class="content">
 
-	<p>This application is opensource software released under the <a href="http://opensource.org/licenses/gpl-license.php">GPL</a>. Please see source code and the docs directory for more details. This package and its contents are Copyright (c) <a href="http://www.phpbb.com/">phpBB Group</a>, All Rights Reserved.</p>
+	<p>This application is opensource software released under the <a href="http://opensource.org/licenses/gpl-2.0.php">GNU General Public License v2</a>. Please see source code and the docs directory for more details. This package and its contents are Copyright (c) <a href="https://www.phpbb.com/">phpBB Group</a>, All Rights Reserved.</p>
 
 		</div>
 
diff -ruN phpBB-3.0.10/docs/hook_system.html phpbb/docs/hook_system.html
--- phpBB-3.0.10/docs/hook_system.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/docs/hook_system.html	2013-09-28 03:20:51.000000000 +0200
@@ -867,7 +867,7 @@
 
 		<div class="content">
 
-	<p>This application is opensource software released under the <a href="http://opensource.org/licenses/gpl-license.php">GPL</a>. Please see source code and the docs directory for more details. This package and its contents are Copyright (c) <a href="http://www.phpbb.com/">phpBB Group</a>, All Rights Reserved.</p>
+	<p>This application is opensource software released under the <a href="http://opensource.org/licenses/gpl-2.0.php">GNU General Public License v2</a>. Please see source code and the docs directory for more details. This package and its contents are Copyright (c) <a href="https://www.phpbb.com/">phpBB Group</a>, All Rights Reserved.</p>
 
 		</div>
 
diff -ruN phpBB-3.0.10/docs/INSTALL.html phpbb/docs/INSTALL.html
--- phpBB-3.0.10/docs/INSTALL.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/docs/INSTALL.html	2013-09-28 03:20:51.000000000 +0200
@@ -46,7 +46,7 @@
 
 <p>This document will walk you through the basics on installing, updating and converting the forum software.</p>
 
-<p>A basic overview of running phpBB3 can be found in the accompanying <a href="README.html">README</a> file. Please ensure you read that document in addition to this! For more detailed information on using, installing, updating and converting phpBB3 you should read <a href="http://www.phpbb.com/support/documentation/3.0/">the documentation</a> available online.</p>
+<p>A basic overview of running phpBB3 can be found in the accompanying <a href="README.html">README</a> file. Please ensure you read that document in addition to this! For more detailed information on using, installing, updating and converting phpBB3 you should read <a href="https://www.phpbb.com/support/documentation/3.0/">the documentation</a> available online.</p>
 
 <h1>Install</h1>
 
@@ -62,7 +62,7 @@
 	<li><a href="#update">Updating from stable releases of phpBB 3.0.x</a>
 	<ol style="list-style-type: lower-roman;">
 		<li><a href="#update_full">Full package</a></li>
-		<li><a href="#update_files">Changed files only</a></li>
+		<li><a href="#update_files">Changed files</a></li>
 		<li><a href="#update_patch">Patch file</a></li>
 		<li><a href="#update_auto">Automatic update package</a></li>
 		<li><a href="#update_all">All package types</a></li>
@@ -82,7 +82,8 @@
 		<li><a href="#webserver_configuration">Webserver configuration</a></li>
 	</ol>
 	</li>
-	<li><a href="#disclaimer">Disclaimer</a></li>
+	<li><a href="#anti_spam">Anti-Spam Measures</a></li>
+	<li><a href="#disclaimer">Copyright and disclaimer</a></li>
 </ol>
 
 		</div>
@@ -107,10 +108,10 @@
 		<li>Change the permissions on config.php to be writable by all (666 or -rw-rw-rw- within your FTP Client)</li>
 		<li>Change the permissions on the following directories to be writable by all (777 or -rwxrwxrwx within your FTP Client):<br />
 			<code>store/</code>, <code>cache/</code>, <code>files/</code> and <code>images/avatars/upload/</code>.</li>
-		<li>Using your web browser visit the location you placed phpBB3 with the addition of install/index.php or pointing directly to install/, e.g. http://www.mydomain.com/phpBB3/install/, http://www.mydomain.com/forum/install/ etc.</li>
-		<li>Click the <em>INSTALL</em> tab, follow the steps and fill out all the requested information.</li>
+		<li>Point your web browser to the location where you uploaded the phpBB3 files with the addition of <code>install/index.php</code> or simply <code>install/</code>, e.g. <code>http://www.example.com/phpBB3/install/index.php</code>, <code>http://www.example.com/forum/install/</code>.</li>
+		<li>Click the <strong><em>INSTALL</em></strong> tab, follow the steps and fill out all the requested information.</li>
 		<li>Change the permissions on config.php to be writable only by yourself (644 or -rw-r--r-- within your FTP Client)</li>
-		<li>phpBB3 should now be available, please <strong>MAKE SURE</strong> you read at least <a href="#postinstall">Section 6</a> below for important, security related post-installation instructions.</li>
+		<li>phpBB3 should now be available, please <strong>MAKE SURE</strong> you read at least <a href="#postinstall">Section 6</a> below for important, security related post-installation instructions, and also take note of <a href="#anti_spam">Section 7</a> regarding anti-spam measures.</li>
 	</ol>
 
 	<p>If you experienced problems or do not know how to proceed with any of the steps above please read the rest of this document.</p>
@@ -131,7 +132,7 @@
 
 		<div class="content">
 
-	<p>phpBB3 has a few requirements which must be met before you are able to install and use it.</p>
+	<p>phpBB 3.0.x has a few requirements which must be met before you are able to install and use it.</p>
 
 	<ul>
 		<li>A webserver or web hosting account running on any major Operating System with support for PHP</li>
@@ -139,15 +140,15 @@
 		<ul>
 			<li>MySQL 3.23 or above (MySQLi supported)</li>
 			<li>PostgreSQL 7.3+</li>
-			<li>SQLite 2.8.2+</li>
+			<li>SQLite 2.8.2+ (SQLite 3 is not supported)</li>
 			<li>Firebird 2.1+</li>
-			<li>MS SQL Server 2000 or above (directly or via ODBC)</li>
+			<li>MS SQL Server 2000 or above (directly or via ODBC or the native adapter)</li>
 			<li>Oracle</li>
 		</ul>
 		</li>
-		<li><strong>PHP 4.3.3+ (>=4.3.3, >4.4.x, >5.x.x, >6.0-dev (compatible))</strong> with support for the database you intend to use.</li>
-		<li>getimagesize() function need to be enabled.</li>
-		<li>These optional presence of the following modules within PHP will provide access to additional features, but they are not required.
+		<li><strong>PHP (>=4.3.3, >=4.4.0, >=5.0.0)</strong> with support for the database you intend to use.</li>
+		<li>getimagesize() function must be enabled.</li>
+		<li>Presence of the following modules within PHP will provide access to additional features, but they are not required:
 		<ul>
 			<li>zlib Compression support</li>
 			<li>Remote FTP support</li>
@@ -158,7 +159,7 @@
 		</li>
 	</ul>
 
-	<p>If your server or hosting account does not meet the requirements above we are afraid phpBB3 is not for you.</p>
+	<p>If your server or hosting account does not meet the requirements above then you will be unable to install phpBB 3.0.x.</p>
 
 		</div>
 
@@ -178,21 +179,21 @@
 
 	<p>Installation of phpBB3 will vary according to your server and database. If you have <em>shell access</em> to your account (via telnet or ssh for example) you may want to upload the entire phpBB3 archive (in binary mode!) to a directory on your host and unarchive it there.</p>
 
-	<p>If you do not have shell access or do not wish to use it you will need to decompress the phpBB3 archive to a local directory on your system using your favourite compression program, e.g. winzip, rar, zip, etc. From there you must FTP <strong>ALL</strong> the files it contains (being sure to retain the directory structure and filenames) to your host. Please ensure that the cases of filenames are retained, do <strong>NOT</strong> force filenames to all lower or upper case doing so will cause errors later.</p>
+	<p>If you do not have shell access or do not wish to use it, you will need to decompress the phpBB3 archive to a local directory on your system using your favourite compression program, e.g. winzip, rar, zip, etc. From there you must FTP <strong>ALL</strong> the files it contains (being sure to retain the directory structure and filenames) to your host. Please ensure that the cases of filenames are retained, do <strong>NOT</strong> force filenames to all lower or upper case as doing so will cause errors later.</p>
 
-	<p>All .php, .inc, .sql, .cfg, .html and .txt files should be uploaded in <strong>ASCII</strong> mode, while all graphics should be uploaded in <strong>BINARY</strong> mode. If you are unfamiliar with what this means please refer to your FTP client documentation. In most cases this is all handled transparantly by your ftp client but if you encounter problems later you should be sure the files where uploaded correctly as described here.</p>
+	<p>All .php, .sql, .cfg, .css, .js, .html, .htaccess and .txt files should be uploaded in <strong>ASCII</strong> mode, while all graphics should be uploaded in <strong>BINARY</strong> mode. If you are unfamiliar with what this means please refer to your FTP client documentation. In most cases this is all handled transparantly by your ftp client, but if you encounter problems later you should be sure the files were uploaded correctly as described here.</p>
 
-	<p>phpBB3 comes supplied with english as its standard language. However a number of separate packs for different languages are available. If you are not a native english speaker you may wish to install one or more of these packages before continuing. The installation process below will allow you to select a default language from those available (you can of course change this default at a later stage). For more details of language packs, where to obtain them and how to install them please see the <a href="README.html#i18n">README</a>.</p>
+	<p>phpBB3 comes supplied with British English as its standard language. However, a number of separate packs for different languages are available. If you are not a native English speaker you may wish to install one or more of these packages before continuing. The installation process below will allow you to select a default language from those available (you can, of course, change this default at a later stage). For more details on language packs, where to obtain them and how to install them please see the <a href="README.html#i18n">README</a>.</p>
 
-	<p>Once all the files have been uploaded to your site you should point your browser at this location with the addition of <code>install/</code>. For example if your domain name is <em>www.mydomain.tld</em> and you placed phpBB3 in a directory /phpBB3 off your web root you would enter <em>http://www.mydomain.tld/phpBB3/install/</em> or (alternatively) <em>http://www.mydomain.tld/phpBB3/install/index.php</em> into your browser. When you have done this you should see the phpBB3 Installation screen appear.</p>
+	<p>Once all the files have been uploaded to your site, you should point your browser at this location with the addition of <code>/install/</code>. For example, if your domain name is <code>www.example.com</code> and you placed the phpBB3 files in the directory <code>/phpBB3</code> off your web root you would enter <code>http://www.example.com/phpBB3/install/</code> or (alternatively) <code>http://www.example.com/phpBB3/install/index.php</code> into your browser. When you have done this, you should see the <strong><em>phpBB3 Introduction</em></strong> screen appear.</p>
 
 	<h4>Introduction:</h4>
 
-	<p>The installation screen gives you a short introduction into phpBB. It allows you to read the license phpBB3 is released under (General Public License) and provides information about how you can receive support. To start the installation, use the <em>Install</em> button.</p>
+	<p>The initial screen gives you a short introduction into phpBB. It allows you to read the license phpBB3 is released under (General Public License v2) and provides information about how you can receive support. To start the installation, use the <strong><em>INSTALL</em></strong> tab.</p>
 
 	<h4>Requirements</h4>
 
-	<p>The first page you will see after starting the installation is the Requirements list. phpBB3 checks automatically whether everything that it needs to run properly is installed on your server. You need to have at least the minimum PHP version installed, and at least one database available to continue the installation. Also important, is that all shown folders are available and do have the correct permissions. Please see the description of each section to find out whether they are optional or required for phpBB3 to run. If everything is in order, you can continue the installation with <em>Start Install</em>.</p>
+	<p>The first page you will see after starting the installation is the Requirements list. phpBB3 automatically checks whether everything that it needs to run properly is installed on your server. You need to have at least the minimum PHP version installed, and at least one database available to continue the installation. Also important, is that all shown folders are available and have the correct permissions. Please see the description of each section to find out whether they are optional or required for phpBB3 to run. If everything is in order, you can continue the installation with <em>Start Install</em>.</p>
 
 	<h4>Database settings</h4>
 
@@ -210,33 +211,33 @@
 		<p><strong>Note:</strong> if you are installing using SQLite, you should enter the full path to your database file in the DSN field and leave the username and password fields blank. For security reasons, you should make sure that the database file is not stored in a location accessible from the web.</p>
 	</div>
 
-	<p>You don't need to change the Prefix for tables in database setting, unless you plan on using multipe phpBB installations on one database. In this case you can use a different prefix for each installation to make it work.</p>
+	<p>You don't need to change the Prefix for tables in database setting, unless you plan on using multipe phpBB installations on one database. In this case, you can use a different prefix for each installation to make it work.</p>
 
-	<p>After you entered your details, you can continue with the Proceed to next step button. Now phpBB3 will check whether the data you entered will lead to a successful database connection and whether tables with the same prefix already exist.</p>
+	<p>After you entered your details, you can continue with the <em>Proceed to next step</em> button. Now phpBB3 will check whether the data you entered will lead to a successful database connection and whether tables with the same prefix already exist.</p>
 
 	<p>A <em>Could not connect to the database</em> error means that you didn't enter the database data correctly and it is not possible for phpBB to connect. Make sure that everything you entered is in order and try again. Again, if you are unsure about your database settings, please contact your host.</p>
 
 	<p>If you installed another version of phpBB before on the same database with the same prefix, phpBB will inform you and you just need to enter a different database prefix.</p>
 
-	<p>If you see the Successful Connection message, you can continue to the next step.</p>
+	<p>If you see the <em>Successful Connection</em> message, you can continue to the next step.</p>
 
 	<h4>Administrator details</h4>
 
-	<p>Now you have to create your administration user. This user will have full administration access and he/she will be the first user on your forum. All fields on this page are required. You can also set the default language of your forum on this page. In a vanilla phpBB3 installation we only include English. You can download further languages from <a href="http://www.phpbb.com/">www.phpbb.com</a>, and add them before installing or later.</p>
+	<p>Now you have to create your administration user. This user will have full administration access and he/she will be the first user on your forum. All fields on this page are required. You can also set the default language of your forum on this page. In a vanilla phpBB3 installation, we only include British English. You can download further languages from <a href="https://www.phpbb.com/">www.phpbb.com</a>, and add them before installing or later.</p>
 
 	<h4>Configuration file</h4>
 
-	<p>In this step, phpBB will try to write the configuration file automatically. The forum needs the configuration to run properly. It contains all database settings, so without it, phpBB will not be able to access the database.</p>
+	<p>In this step, phpBB will try to write the configuration file automatically. The forum needs the configuration file in order to operate. It contains all the database settings, so without it, phpBB will not be able to access the database.</p>
 
-	<p>Usually writing the configuration file automatically works fine. But in some cases it can fail due to wrong file permissions, for instance. In this case, you need to upload the file manually. phpBB asks you to download the config.php file and tells you what to do with it. Please read the instructions carefully. After you have uploaded the file, use <em>Done</em> to get to the last step. If <em>Done</em> returns you to the same page as before, and does not return a success message, you did not upload the file correctly.</p>
+	<p>Usually, writing the configuration file automatically works fine. If the file permissions are not set correctly, this process can fail. In this case, you need to upload the file manually. phpBB asks you to download the <code>config.php</code> file and tells you what to do with it. Please read the instructions carefully. After you have uploaded the file, use <em>Done</em> to get to the last step. If <em>Done</em> returns you to the same page as before, and does not return a success message, you did not upload the file correctly.</p>
 
 	<h4>Advanced settings</h4>
 
-	<p>The Advanced settings allow you to set some parameters of the board configuration. They are optional, and you can always change them later. So if you are not sure what these settings mean, proceed to the final step and finish the installation.</p>
+	<p>The Advanced settings allow you to set additional parameters of the board configuration. They are optional and you can always change them later. So, even if you are not sure what these settings mean, you can still proceed to the final step and finish the installation.</p>
 
-	<p>If the installation was successful, you can now use the Login button to visit the Administration Control Panel. Congratulations, you have installed phpBB3 successfully. But there is still work ahead!</p>
+	<p>If the installation was successful, you can now use the <em>Login</em> button to visit the Administration Control Panel. Congratulations, you have installed phpBB successfully. But there is still work ahead!</p>
 
-	<p>If you are unable to get phpBB3 installed even after reading this guide, please look at the support section to find out where you can ask for further assistance.</p>
+	<p>If you are unable to get phpBB3 installed even after reading this guide, please look at the support section of the installer's introduction page to find out where you can ask for further assistance.</p>
 
 	<p>At this point if you are converting from phpBB 2.0.x, you should refer to the <a href="#convert">conversion steps</a> for further information. If not, you should remove the install directory from your server as you will only be able to access the Administration Control Panel whilst it is present.</p>
 
@@ -256,55 +257,55 @@
 
 		<div class="content">
 
-<p>If you are currently using a stable release of phpBB3 updating to this version is straightforward. You would have downloaded one of four packages and your choice determines what you need to do. <strong>Please Note</strong>: That before updating we heavily recommend you do a <em>full backup of your database and existing phpBB3 files</em>! If you are unsure how to achieve this please ask your hosting provider for advice.</p>
+<p>If you are currently using a stable release of phpBB3, updating to this version is straightforward. You would have downloaded one of four packages and your choice determines what you need to do. <strong>Note</strong>: Before updating, we heavily recommend you do a <em>full backup of your database and existing phpBB3 files</em>! If you are unsure how to achieve this please ask your hosting provider for advice.</p>
 
 <p><strong>Please make sure you update your phpBB3 source files too, even if you run the <code>database_update.php</code> file.</strong></p>
 
 <a name="update_full"></a><h3>4.i. Full package</h3>
 
-	<p>The full package is normally meant for new installations only, but if you want to replace all source files this package comes in handy.</p>
+	<p>The full package is normally meant for new installations only, but if you want to replace all source files, this package comes in handy.</p>
 
-	<p>First you should make a copy of your existing <em>config.php</em> file, keep it in a safe place! Next delete all the existing phpBB3 files, you may want to leave your <code>files/</code> and <code>images/</code> directory in place. You can leave alternative styles in-place too. With this complete you can upload the new phpBB3 files (see <a href="#install">New installation</a> for details if necessary). Once complete copy back your saved <em>config.php</em>, replacing the new one. Another method is to just <strong>replace</strong> the existing files with the files from the full package - though make sure you do <strong>not</strong> overwrite your config.php file.</p>
+	<p>First, you should make a copy of your existing <code>config.php</code> file; keep it in a safe place! Next, delete all the existing phpBB3 files, you may want to leave your <code>files/</code> and <code>images/</code> directorie in place. You can leave alternative styles in place too. With this complete, you can upload the new phpBB files (see <a href="#install">New installation</a> for details if necessary). Once complete, copy back your saved <code>config.php</code>, replacing the new one. Another method is to just <strong>replace</strong> the existing files with the files from the full package - though make sure you do <strong>not</strong> overwrite your config.php file.</p>
 
-	<p>You should now run <code>install/database_update.php</code> which, depending on your previous version, will make a number of database changes. You may receive <em>FAILURES</em> during this procedure, they should not be a cause for concern unless you see an actual <em>ERROR</em>, in which case the script will stop (in this case you should seek help via our forums or bug tracker).</p>
+	<p>You should now run <code>install/database_update.php</code> which, depending on your previous version, will make a number of database changes. You may receive <em>FAILURES</em> during this procedure. They should not be a cause for concern unless you see an actual <em>ERROR</em>, in which case the script will stop (in this case you should seek help via our forums or bug tracker).</p>
 
-	<p>Once the install/database_update.php has completed you may proceed to the Administration Control Panel and check remove the install directory as advised.</p>
+	<p>Once <code>install/database_update.php</code> has completed, you may proceed to the Administration Control Panel and then remove the install directory as advised.</p>
 
-<a name="update_files"></a><h3>4.ii. Changed files only</h3>
+<a name="update_files"></a><h3>4.ii. Changed files</h3>
 
-	<p>This package is meant for those wanting to only replace changed files from a previous version to the latest version. This package normally contains the changed files from up to five previous versions.</p>
+	<p>This package is meant for those wanting to only replace the files that were changed between a previous version and the latest version.</p>
 
-	<p>This package contains a number of archives, each contains the files changed from a given release to the latest version. You should select the appropriate archive for your current version, e.g. if you currently have <samp>3.0.9</samp> you should select the phpBB-3.0.9_to_3.0.10.zip/tar.gz file.</p>
+	<p>This package contains a number of archives, each contains the files changed from a given release to the latest version. You should select the appropriate archive for your current version, e.g. if you currently have <strong>3.0.11</strong> you should select the appropriate <code>phpBB-3.0.12-files.zip/tar.bz2</code> file.</p>
 
-	<p>The directory structure has been preserved enabling you (if you wish) to simply upload the contents of the archive to the appropriate location on your server, i.e. simply overwrite the existing files with the new versions. Do not forget that if you have installed any MODs these files will overwrite the originals possibly destroying them in the process. You will need to re-add MODs to any affected file before uploading.</p>
+	<p>The directory structure has been preserved, enabling you (if you wish) to simply upload the uncompressed contents of the archive to the appropriate location on your server, i.e. simply overwrite the existing files with the new versions. Do not forget that if you have installed any modifications (MODs) these files will overwrite the originals, possibly destroying them in the process. You will need to re-add MODs to any affected file before uploading.</p>
 
-	<p>As for the other update procedures you should run <b>install/database_update.php</b> after you have finished updating the files. This will update your database schema and increment the version number.</p>
+	<p>As for the other update procedures, you should run <code>install/database_update.php</code> after you have finished updating the files. This will update your database schema and increment the version number.</p>
 
 <a name="update_patch"></a><h3>4.iii. Patch file</h3>
 
-	<p>The patch file package is for those wanting to update through the patch application, and being comfortable with it.</p>
+	<p>The patch file package is for those wanting to update through the patch application, and should only be used by those who are comfortable with it.</p>
 
-	<p>The patch file is one solution for those with many Modifications (MODs) or other changes who do not want to re-add them back to all the changed files if they use the method explained above. To use this you will need command line access to a standard UNIX type <strong>patch</strong> application. If you do not have access to such an application but still want to use this update approach, we strongly recommend the <a href="#update_auto">Automatic update package</a> explained below. It is also the recommended update method.</p>
+	<p>The patch file is one solution for those with many Modifications (MODs) or other changes and do not want to re-add them back to all the changed files. To use this you will need command line access to a standard UNIX type <strong>patch</strong> application. If you do not have access to such an application, but still want to use this update approach, we strongly recommend the <a href="#update_auto">Automatic update package</a> explained below. It is also the recommended update method.</p>
 
-	<p>A number of patch files are provided to allow you to update from previous stable releases. Select the correct patch, e.g. if your current version is <samp>3.0.9</samp> you need the phpBB-3.0.9_to_3.0.10.patch file. Place the correct patch in the parent directory containing the phpBB3 core files (i.e. index.php, viewforum.php, etc.). With this done you should run the following command: <strong>patch -cl -d [PHPBB DIRECTORY] -p1 &lt; [PATCH NAME]</strong> (where PHPBB DIRECTORY is the directory name your phpBB Installation resides in, for example phpBB3, and where PATCH NAME is the relevant filename of the selected patch file). This should complete quickly, hopefully without any HUNK FAILED comments.</p>
+	<p>A number of patch files are provided to allow you to update from previous stable releases. Select the correct patch, e.g. if your current version is <strong>3.0.11</strong>, you need the <code>phpBB-3.0.12-patch.zip/tar.bz2</code> file. Place the correct patch in the parent directory containing the phpBB core files (i.e. index.php, viewforum.php, etc.). With this done you should run the following command: <code>patch -cl -d [PHPBB DIRECTORY] -p1 &lt; [PATCH NAME]</code> (where PHPBB DIRECTORY is the directory name your phpBB Installation resides in, for example phpBB, and where PATCH NAME is the relevant filename of the selected patch file). This should complete quickly, hopefully without any HUNK FAILED comments.</p>
 
-	<p>If you do get failures you should look at using the <a href="#update_files">Changed files only</a> package to replace the files which failed to patch, please note that you will need to manually re-add any Modifications (MODs) to these particular files. Alternatively if you know how you can examine the .rej files to determine what failed where and make manual adjustments to the relevant source.</p>
+	<p>If you do get failures, you should look at using the <a href="#update_files">Changed Files</a> package to replace the files which failed to patch. Please note that you will need to manually re-add any MODs to these particular files. Alternatively, if you know how, you can examine the .rej files to determine what failed where and make manual adjustments to the relevant source.</p>
 
-	<p>You should of course delete the patch file (or files) after use. As for the other update procedures you should run <code>install/database_update.php</code> after you have finished updating the files. This will update your database schema and data (if appropriate) and increment the version number.</p>
+	<p>You should, of course, delete the patch file (or files) after use. As for the other update procedures, you should run <code>install/database_update.php</code> after you have finished updating the files. This will update your database schema and data (if appropriate) and increment the version number.</p>
 
 <a name="update_auto"></a><h3>4.iv. Automatic update package</h3>
 
-	<p>This update method is the recommended method for updating. This package allows detecting changed files automatically and merges changes if needed.</p>
+	<p>This update method is the recommended method for updating. This package detects changed files automatically and merges in changes if needed.</p>
 
-	<p>The automatic update package contains - contrary to the others - only the information required to update the previous release version to the latest available version. These packages are meant for use with the automatic update tool.</p>
+	<p>The automatic update package will update the board from a given version to the latest version. A number of automatic update files are available, and you should choose the one that corresponds to the version of the board that you are currently running. For example, if your current version is <strong>3.0.11</strong>, you need the <code>phpBB-3.0.11_to_3.0.12.zip/tar.bz2</code> file.</p>
 
-	<p>To perform the update, either follow the instructions from the <code>Administration Control Panel-&gt;System</code> Tab - this should point out that you are running an outdated version and will guide you through the update - or follow the instructions listed below.</p>
+	<p>To perform the update, either follow the instructions from the <strong>Administration Control Panel-&gt;System</strong> Tab - this should point out that you are running an outdated version and will guide you through the update - or follow the instructions listed below.</p>
 
 	<ul>
-		<li>Go to the <a href="http://www.phpbb.com/downloads/">downloads page</a> and download the latest update package listed there, matching your current version.</li>
-		<li>Upload the archives contents to your phpBB installation - only the install folder is required. Upload the whole install folder, retaining the file structure.</li>
+		<li>Go to the <a href="https://www.phpbb.com/downloads/">downloads page</a> and download the latest update package listed there, matching your current version.</li>
+		<li>Upload the uncompressed archive contents to your phpBB installation - only the install folder is required. Upload the whole install folder, retaining the file structure.</li>
 		<li>After the install folder is present, phpBB3 will go offline automatically.</li>
-		<li>Point your browser to the install directory, for example <samp>http://www.example.com/phpBB3/install/</samp></li>
+		<li>Point your browser to the install directory, for example <code>http://www.example.com/phpBB3/install/</code></li>
 		<li>Choose the "Update" Tab and follow the instructions</li>
 	</ul>
 
@@ -312,7 +313,9 @@
 
 <a name="update_all"></a><h3>4.v. All package types</h3>
 
-	<p>If you have non-English language packs installed you may want to see if a new version has been made available. A number of missing strings may have been added which, though not essential, may be beneficial to users. Please note that at this time not all language packs have been updated so you should be prepared to periodically check for updates.</p>
+	<p>If you have non-English language packs installed, you may want to see if a new version has been made available. A number of missing strings may have been added which, though not essential, may be beneficial to users. Please note that at this time not all language packs have been updated so you should be prepared to periodically check for updates.</p>
+
+	<p>These update methods will only update the standard styles, <code>prosilver</code> and <code>subsilver2</code>, any other styles you have installed for your board will usually also need to be updated.</p>
 
 		</div>
 
@@ -334,47 +337,47 @@
 
 <a name="prereq"></a><h3>5.i. Requirements before converting</h3>
 
-	<p>Before converting we heavily recommend you do a <em>full backup of your database and files</em>! If you are unsure how to achieve this please ask your hosting provider for advice. You basically need to follow the basic instructions given for <a href="#install">New installations</a>. Please <strong>do not</strong> overwrite any old files - install phpBB3 at a different location.</p>
+	<p>Before converting, we heavily recommend you do a <em>full backup of your database and files</em>! If you are unsure how to achieve this, please ask your hosting provider for advice. You basically need to follow the instructions given for <a href="#install">New installations</a>. Please <strong>do not</strong> overwrite any old files - install phpBB3 at a different location.</p>
 
 	<p>Once you made a backup of everything and also have a brand new phpBB3 installation, you can now begin the conversion.</p>
 
-	<p>Note that the conversion requires CREATE and DROP privileges for the phpBB3's database user account.</p>
+	<p>Note that the conversion requires <code>CREATE</code> and <code>DROP</code> privileges for the phpBB3 database user account.</p>
 
 <a name="conversion"></a><h3>5.ii. Converting</h3>
 
-	<p>To begin the conversion visit the install folder of your phpBB3 installation (the same as you have done for installing). Now you will see a new tab <em>Convert</em>. Click this tab.</p>
+	<p>To begin the conversion, visit the <code>install/</code> folder of your phpBB3 installation (the same as you have done for installing). Now you will see a new tab <em>Convert</em>. Click this tab.</p>
 
-	<p>As with install the conversion is automated. Your previous 2.0.x database tables will not be changed as well as the original 2.0.x files remaining unaltered. The conversion is actually only filling your phpBB3 database tables and copying additional data over to your phpBB3 installation. This has the benefit that if something goes wrong you are able to either re-run the conversion or continue a conversion, while your old board is still accessible. We really recommend you disable your old installation while converting, else you may have inconsistent data after the conversion.</p>
+	<p>As with install, the conversion is automated. Your previous 2.0.x database tables will not be changed and the original 2.0.x files will remain unaltered. The conversion is actually only filling your phpBB3 database tables and copying additional data over to your phpBB3 installation. This has the benefit that if something goes wrong, you are able to either re-run the conversion or continue a conversion, while your old board is still accessible. We really recommend that you disable your old installation while converting, else you may have inconsistent data after the conversion.</p>
 
-	<p>Please note that this conversion process may take quite some time and depending on your hosting provider this may result in it failing (due to web server or other timeout issues). If this is the case you should ask your provider if they are willing to allow the convert script to temporarily exceed their limits (be nice and they will probably be quite helpful).</p>
+	<p>Please note that this conversion process may take quite some time and depending on your hosting provider this may result in it failing (due to web server resource limits or other timeout issues). If this is the case, you should ask your provider if they are willing to allow the convert script to temporarily exceed their limits (be nice and they will probably be quite helpful). If your host is unwilling to increase the limits to run the convertor, please see this article for performing the conversion on your local machine: <a href="https://www.phpbb.com/kb/article/offline-conversions/">Knowledge Base - Offline Conversions</a></p>
 
-	<p>Once completed your board should be immediately available. If you encountered errors you should report the problems to our bug tracker or seek help via our forums (see <a href="README.html">README</a> for details).</p>
+	<p>Once completed, your board should be immediately available. If you encountered errors, you should report the problems to our bug tracker or seek help via our forums (see <a href="README.html">README</a> for details).</p>
 
 <a name="postreq"></a><h3>5.iii. Things to do after conversion</h3>
 
-	<p>After successful conversion there may be a few items you need to do - apart from checking if the installation is accessible and everything displayed correctly.</p>
+	<p>After a successful conversion, there may be a few items you need to do - apart from checking if the installation is accessible and everything displayed correctly.</p>
 
-	<p>The first thing you may want to do is going to the administration control panel and checking every configuration item within the general tab. Thereafter you may want to adjust the forum descriptions/names if you entered HTML there. You also may want to access the other administrative sections, e.g. adjusting permissions, smilies, icons, ranks, etc.</p>
+	<p>The first thing you may want to do is to go to the administration control panel and check every configuration item within the general tab. Thereafter, you may want to adjust the forum descriptions/names if you entered HTML there. You also may want to access the other administrative sections, e.g. adjusting permissions, smilies, icons, ranks, etc.</p>
 
-	<p>Within the conversion the search index has not been created or transferred. This means after conversion you are not able to find any matches if you want to search for something. We recommend you rebuild your search index within <code>Admin -&gt; Maintenance -&gt; Database -&gt; Search Index</code>.</p>
+	<p>During the conversion, the search index is not created or transferred. This means after conversion you are not able to find any matches if you want to search for something. We recommend you rebuild your search index within <strong>Administration Control Panel -&gt; Maintenance -&gt; Database -&gt; Search Index</strong>.</p>
 
 	<p>After verifying the settings in the ACP, you can delete the install directory to enable the board. The board will stay disabled until you do so.</p>
 
-	<p>Once you are pleased with your new installation you may want to give it the name of your old installation, changing the directory name. With phpBB3 this is possible without any problems - but you may still want to check your cookie settings within the administration panel, if the cookie path need to be adjusted prior to renaming.</p>
+	<p>Once you are pleased with your new installation, you may want to give it the name of your old installation, changing the directory name. With phpBB3 this is possible without any problems, but you may still want to check your cookie settings within the administration panel; in case your cookie path needs to be adjusted prior to renaming.</p>
 
 <a name="convprob"></a><h3>5.iv. Common conversion problems</h3>
 
 	<p><strong>Broken non-latin characters</strong> The conversion script assumes that the database encoding in the source phpBB2 matches the encoding defined in the <code>lang_main.php</code> file of the default language pack of the source installation. Edit that file to match the database's encoding and re-start the conversion procedure.</p>
 
-	<p><strong>http 500 / white pages</strong> The conversion is a load-heavy procedure. Restrictions imposed by some server hosting providers can cause problems. The most common causes are: too low values for the php settings <code>memory_limit</code> and <code>max_execution_time</code>. Limits on the allowed CPU time are also a frequent cause for such errors, as are caps on the number of database queries allowed. If you cannot change such settings, then contact your hosting provider or run the conversion procedure on a different computer. The phpBB.com forums are also an excellent location to ask for support.</p>
+	<p><strong>http 500 / white pages</strong> The conversion is a load-heavy procedure. Restrictions imposed by some server hosting providers can cause problems. The most common causes are: values too low for the PHP settings <code>memory_limit</code> and <code>max_execution_time</code>. Limits on the allowed CPU time are also a frequent cause for such errors, as are limits on the number of database queries allowed. If you cannot change such settings, then contact your hosting provider or run the conversion procedure on a different computer. The phpBB.com forums are also an excellent location to ask for support.</p>
 
-	<p><strong>Password conversion</strong> Due to the utf-8 based handling of passwords in phpBB3, it is not always possible to transfer all passwords. For passwords "lost in translation" the easiest workaround is to use the "forgotten password" function.</p>
+	<p><strong>Password conversion</strong> Due to the utf-8 based handling of passwords in phpBB3, it is not always possible to transfer all passwords. For passwords "lost in translation" the easiest workaround is to use the <em>I forgot my password</em> link on the login page.</p>
 
-	<p><strong>Path to your former board</strong> The converter expects the relative path to your old board's files. So, - for instance - if the old board is located at <code>http://www.yourdomain.com/forum</code> and the phpBB3 installation is located at <code>http://www.yourdomain.com/phpBB3</code>, then the correct value would be <code>../forum</code>. Note that the webserver user must be able to access the source installation's files.</p>
+	<p><strong>Path to your former board</strong> The convertor expects the relative path to your old board's files. So, for instance, if the old board is located at <code>http://www.yourdomain.com/forum</code> and the phpBB3 installation is located at <code>http://www.yourdomain.com/phpBB3</code>, then the correct value would be <code>../forum</code>. Note that the webserver user must be able to access the source installation's files.</p>
 
 	<p><strong>Missing images</strong> If your default board language's language pack does not include all images, then some images might be missing in your installation. Always use a complete language pack as default language.</p>
 
-	<p><strong>Smilies</strong> During the conversion you might see warnings about image files where the copying failed. That can happen if the old board's smilies have the same file names as those on the new board. Copy those files manually after the conversion, if you want to continue using the old smilies.</p>
+	<p><strong>Smilies</strong> During the conversion you might see warnings about image files where the copying failed. This can happen if the old board's smilies have the same file names as those on the new board. Copy those files manually after the conversion, if you want to continue using the old smilies.</p>
 
 
 		</div>
@@ -393,28 +396,44 @@
 
 		<div class="content">
 
-	<p>Once you have successfully installed phpBB3 you <strong>MUST</strong> ensure you remove the entire install/ directory. Leaving the install directory in place is a <em>very serious potential security issue</em> which may lead to deletion or alteration of files, etc. Please note that until this directory is removed, phpBB3 will not operate and a warning message will be displayed. Beyond this <strong>essential</strong> deletion, you may also wish to delete the docs/ directories if you wish.</p>
+	<p>Once you have successfully installed phpBB3 you <strong>MUST</strong> ensure you remove the entire <code>install/</code> directory. Leaving the install directory in place is a <em>very serious potential security issue</em> which may lead to deletion or alteration of files, etc. Please note that until this directory is removed, phpBB will not operate and a warning message will be displayed. Beyond this <strong>essential</strong> deletion, you may also wish to delete the docs/ directory if you wish.</p>
 
-	<p>With these directories deleted you should proceed to the administration panel. Depending on how the installation completed you may have been directed there automatically. If not, login as the administrator you specified during install/conversion and click the <strong>Administration Panel</strong> link at the bottom of any page. Ensure that details specified in <code>Admin -&gt; General</code> are correct!</p>
+	<p>With these directories deleted, you should proceed to the administration panel. Depending on how the installation completed, you may have been directed there automatically. If not, login as the administrator you specified during install/conversion and click the <strong>Administration Control Panel</strong> link at the bottom of any page. Ensure that details specified on the <strong>General</strong> tab are correct!</p>
 
 <a name="avatars"></a><h3>6.i. Uploadable avatars</h3>
 
 	<p>phpBB3 supports several methods for allowing users to select their own <em>avatar</em> (an avatar is a small image generally unique to a user and displayed just below their username in posts).</p>
 
-	<p>Two of these options allow users to upload an avatar from their machine or a remote location (via a URL). If you wish to enable this function you should first ensure the correct paths for uploadeable avatars is set in <code>Admin -&gt; General -&gt; Board Configuration -&gt; Avatar settings</code>. By default this is <em>images/avatars/uploads</em> but you can set it to whatever you like, just ensure the configuration setting is updated. You must also ensure this directory can be written to by the webserver. Usually this means you have to alter its permissions to allow anyone to read and write to. Exactly how you should do this depends on your ftp client or server operating system.</p>
+	<p>Two of these options allow users to upload an avatar from their machine or a remote location (via a URL). If you wish to enable this function you should first ensure the correct path for uploadable avatars is set in <strong>Administration Control Panel -&gt; General -&gt; Board Configuration -&gt; Avatar settings</strong>. By default this is <code>images/avatars/uploads</code>, but you can set it to whatever you like, just ensure the configuration setting is updated. You must also ensure this directory can be written to by the webserver. Usually this means you have to alter its permissions to allow anyone to read and write to it. Exactly how you should do this depends on your FTP client or server operating system.</p>
 
-	<p>On UNIX systems for example you set the directory to a+rwx (or ugo+rwx or even 777). This can be done from a command line on your server using chmod or via your FTP client (using the Change Permissions, chmod or other Permissions dialoge box, see your FTP clients documentation for help). Most FTP clients list permissions in the form of User (Read, Write, Execute), Group (Read, Write, Execute) and Other (Read, Write, Execute). You need to tick all of these boxes to set correct permissions.</p>
+	<p>On UNIX systems, for example, you set the directory to a+rwx (or ugo+rwx or even 777). This can be done from a command line on your server using chmod or via your FTP client (using the Change Permissions, chmod or other Permissions dialog box, see your FTP client's documentation for help). Most FTP clients list permissions in the form of User (Read, Write, Execute), Group (Read, Write, Execute) and Other (Read, Write, Execute). You need to tick all of these boxes to set correct permissions.</p>
 
-	<p>On Windows system you need to ensure the directory is not write-protected and that it has global write permissions (see your servers documentation or contact your hosting provider if you are unsure on how to achieve this).</p>
+	<p>On Windows systems, you need to ensure the directory is not write-protected and that it has global write permissions (see your server's documentation or contact your hosting provider if you are unsure on how to achieve this).</p>
 
-	<p>Please be aware that setting a directories permissions to global write access is a potential security issue. While it is unlikely that anything nasty will occur (such as all the avatars being deleted) there are always people out there to cause trouble. Therefore you should monitor this directory and if possible make regular backups.</p>
+	<p>Please be aware that setting a directory's permissions to global write access is a potential security issue. While it is unlikely that anything nasty will occur (such as all the avatars being deleted) there are always people out there to cause trouble. Therefore you should monitor this directory and if possible make regular backups.</p>
 
 <a name="webserver_configuration"></a><h3>6.ii. Webserver configuration</h3>
 
-	<p>Depending on your web server you may have to configure your server to deny web access to the <code>cache/</code>, <code>files/</code>, <code>store/</code> and other directories. This is to prevent users from accessing sensitive files.</p>
+	<p>Depending on your web server, you may have to configure your server to deny web access to the <code>cache/</code>, <code>files/</code>, <code>store/</code> and other directories. This is to prevent users from accessing sensitive files.</p>
+
+	<p>For <strong>Apache</strong> there are <code>.htaccess</code> files already in place to do this for you. Similarly, for <strong>Windows</strong> based servers using <strong>IIS</strong> there are <code>web.config</code> files already in place to do this for you. For other webservers, you will have to adjust the configuration yourself. Sample files for <strong>nginx</strong> and <strong>lighttpd</strong> to help you get started may be found in <code>docs/</code> directory.</p>
 
-	<p>For <strong>apache</strong> there are <code>.htaccess</code> files already in place to do this for you. For other webservers you will have to adjust the configuration yourself. Sample files for <strong>nginx</strong> and <strong>lighttpd</strong> to help you get started may be found in docs directory.</p>
+		</div>
 
+		<div class="back2top"><a href="#wrap" class="top">Back to Top</a></div>
+
+		<span class="corners-bottom"><span></span></span></div>
+	</div>
+
+	<hr />
+
+<a name="anti_spam"></a><h2>7. Anti-Spam Measures</h2>
+		
+		<div class="paragraph">
+		<div class="inner"><span class="corners-top"><span></span></span>
+
+		<div class="content">
+	<p>Like any online site that allows user input, your board could be subject to unwanted posts; often referred to as <a href="http://en.wikipedia.org/wiki/Forum_spam">forum spam</a>. The vast majority of these attacks will be from automated computer programs known as <a href="http://en.wikipedia.org/wiki/Spambot">spambots</a>. The attacks, generally, are not personal as the spammers are just trying to find accessible targets. phpBB has a number of anti-spam measures built in, including a range of CAPTCHAs. However, administrators are strongly urged to read and follow the advice for <a href="https://www.phpbb.com/support/spam/">Preventing Spam in phpBB</a> as soon as possible after completing the installation of your board.</p>
 		</div>
 
 		<div class="back2top"><a href="#wrap" class="top">Back to Top</a></div>
@@ -424,14 +443,14 @@
 
 	<hr />
 
-<a name="disclaimer"></a><h2>7. Copyright and disclaimer</h2>
+<a name="disclaimer"></a><h2>8. Copyright and disclaimer</h2>
 
 	<div class="paragraph">
 		<div class="inner"><span class="corners-top"><span></span></span>
 
 		<div class="content">
 
-	<p>This application is opensource software released under the <a href="http://opensource.org/licenses/gpl-license.php">GPL</a>. Please see source code and the docs directory for more details. This package and its contents are Copyright (c) <a href="http://www.phpbb.com/">phpBB Group</a>, All Rights Reserved.</p>
+	<p>This application is opensource software released under the <a href="http://opensource.org/licenses/gpl-2.0.php">GNU General Public License v2</a>. Please see the source code and <code>docs/</code> directory for more details. This package and its contents are Copyright &copy; <a href="https://www.phpbb.com/">phpBB Group</a>, All Rights Reserved.</p>
 
 		</div>
 
diff -ruN phpBB-3.0.10/docs/README.html phpbb/docs/README.html
--- phpBB-3.0.10/docs/README.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/docs/README.html	2013-09-28 03:20:51.000000000 +0200
@@ -41,7 +41,7 @@
 
 <!-- BEGIN DOCUMENT -->
 
-	<p>Thank you for downloading phpBB3. This README will guide through the basics of installation and operation of phpBB3. Please ensure you read this and the accompanying documentation fully <strong>before</strong> proceeding with the installation.</p>
+	<p>Thank you for downloading phpBB3. This README will guide you through the basics of installation and operation of phpBB3. Please ensure you read this and the accompanying documentation fully <strong>before</strong> proceeding with the installation.</p>
 
 	<h1>Readme</h1>
 
@@ -54,7 +54,7 @@
 				<li><a href="#install">Installing phpBB3</a></li>
 				<li><a href="#run">Running phpBB3</a>
 				<ol style="list-style-type: lower-roman;">
-					<li><a href="#i18n">Internationalisation (i18n)</a></li>
+					<li><a href="#i18n">Languages (Internationalisation - i18n)</a></li>
 					<li><a href="#styles">Styles</a></li>
 					<li><a href="#mods">Modifications</a></li>
 				</ol>
@@ -62,12 +62,13 @@
 				<li><a href="#help">Getting help with phpBB3</a>
 				<ol style="list-style-type: lower-roman;">
 					<li><a href="#docs">Documentation</a></li>
+					<li><a href="#kb">Knowledge Base</a></li>
 					<li><a href="#website">Community Forums</a></li>
-					<li><a href="#irc">Internet Relay Chat</a></li>
+					<li><a href="#irc">Internet Relay Chat (IRC)</a></li>
 				</ol>
 				</li>
 				<li><a href="#status">Status of this version</a></li>
-				<li><a href="#bugs">Reporting Bugs</a>
+				<li><a href="#bugs">Reporting bugs</a>
 				<ol style="list-style-type: lower-roman;">
 					<li><a href="#securitybugs">Security related bugs</a></li>
 				</ol>
@@ -91,11 +92,11 @@
 
 		<div class="content">
 
-	<p>Installation, update and conversion instructions can be found in the <a href="INSTALL.html">INSTALL</a> document contained in this distribution. If you are intending to convert from a previous phpBB 2.0.x installation we highly recommend you backup any existing data before proceeding!</p>
+	<p>Installation, update and conversion instructions can be found in the <a href="INSTALL.html">INSTALL</a> document in this directory. If you are intending on converting from a phpBB 2.0.x installation we highly recommend that you backup any existing data before proceeding!</p>
 
 	<p>Users of phpBB3 Beta versions cannot directly update.</p>
 
-	<p>Please note that we won't support the following installation types:</p>
+	<p>Please note that we don't support the following installation types:</p>
 	<ul>
 		<li>Updates from phpBB3 Beta versions to phpBB3 RC1 and higher</li>
 		<li>Conversions from phpBB 2.0.x to phpBB3 Beta versions</li>
@@ -106,8 +107,9 @@
 
 	<ul>
 		<li>Updates from phpBB3 RC1 to the latest version</li>
+		<li>Note: if using the <em>Automatic Update Package</em>, updates are supported from phpBB 3.0.2 onward. To update a pre-3.0.2 installation, first update to 3.0.2 and then update to the current version.</li>
 		<li>Conversions from phpBB 2.0.x to the latest version</li>
-		<li>New installations of phpBB3 - always only the latest released version</li>
+		<li>New installations of phpBB3 - only the latest released version</li>
 	</ul>
 
 		</div>
@@ -126,41 +128,41 @@
 
 		<div class="content">
 
-	<p>Once installed phpBB is easily managed by both admin and moderator control panels. If you need help or advice with phpBB please see <a href="#help">Section 3</a> below.</p>
+	<p>Once installed, phpBB is easily managed via the Administration and Moderator Control Panels. If you need help or advice with phpBB, please see <a href="#help">Section 3</a> below.</p>
 
-	<a name="i18n"></a><h3>2.i. Internationalisation (i18n)</h3>
+	<a name="i18n"></a><h3>2.i. Languages (Internationalisation - i18n)</h3>
 
-	<p>A number of language packs and style localisations are available. You can find them on our official download page:</p>
+	<p>A number of language packs with included style localisations are available. You can find them listed in the <a href="https://www.phpbb.com/languages/">Language Packs</a> pages of our downloads section or from the <a href="https://www.phpbb.com/customise/db/language_packs-25/">Language Packs</a> section of the <a href="https://www.phpbb.com/customise/db/">Customisation Database</a>.</p>
 
-	<p><a href="http://www.phpbb.com/downloads/">http://www.phpbb.com/downloads/</a></p>
+	<p>For more information about language packs, please see: <a href="https://www.phpbb.com/languages/">https://www.phpbb.com/languages/</a></p>
 
-	<p>This is the <em>official</em> location for all supported language sets. If you download a package from a 3rd party site you do so with the understanding that we cannot offer support. So please, do not ask for help in these cases!</p>
+	<p>This is the <em>official</em> location for all supported language sets. If you download a package from a 3rd party site you do so with the understanding that we cannot offer support. Please do not ask for support if you download a language pack from a 3rd party site.</p>
 
-	<p>Installation of these packages is straightforward, simply download the required language pack and unarchive it into the <samp>languages/</samp> folder. Please ensure you retain the directory structure when doing this! Once uploaded go to the <code>Admin-&gt;System-&gt;Language Packs</code> and install the now appeared new language pack. To install the style imageset you should download the imageset for your language and unarchive the file/s into the relevant imageset directory (styles/prosilver/imageset or styles/subsilver2/imageset), again you must retain the directory structure. Once installed the imageset will become immediately available.</p>
+	<p>Installation of these packages is straightforward: simply download the required language pack, uncompress (unzip) it and via FTP transfer the included <code>language</code> and <code>styles</code> folders to the root of your board installation. The language can then be installed via the Administration Control Panel of your board: <code>System tab -&gt; General Tasks -&gt; Language packs</code>. A more detailed description of the process is in the Knowledge Base article, <a href="https://www.phpbb.com/kb/article/how-to-install-a-language-pack/">How to Install a Language Pack</a>.</p>
 
-	<p>If your language is not available please visit our forums where you will find a topic listing translations currently available or in preparation. This topic also gives you information should you wish to volunteer to translate a language not currently listed.</p>
+	<p>If your language is not available, please visit our <a href="https://www.phpbb.com/community/viewforum.php?f=66">[3.0.x] Translations</a> forum where you will find topics on translations in progress. Should you wish to volunteer to translate a language not currently available or assist in maintaining an existing language pack, you can <a href="https://www.phpbb.com/languages/apply.php">Apply to become a translator</a>.</p>
 
 	<a name="styles"></a><h3>2.ii. Styles</h3>
 
-	<p>Although phpBB Group are rather proud of the included styles we realise that it may not be to everyones tastes. Therefore phpBB3 allows styles to be switched with relative ease. Firstly you need to locate and download a style you like. We maintain such a site at</p>
+	<p>Although the phpBB Group is rather proud of the included styles, we realise that they may not be to everyone's taste. Therefore, phpBB3 allows styles to be switched with relative ease. First, you need to locate and download a style you like. You can find them listed in the <a href="https://www.phpbb.com/customise/db/styles-2/">Styles</a> section of our <a href="https://www.phpbb.com/customise/db/">Customisation Database</a>.</p>
 
-	<p><a href="http://www.phpbb.com/styles/">http://www.phpbb.com/styles/</a></p>
+	<p>For more information about styles, please see: <a href="https://www.phpbb.com/styles/">https://www.phpbb.com/styles/</a></p>
 
-	<p><strong>Please note</strong> that 3rd party styles downloaded for versions of phpBB2 will <strong>not</strong> work in phpBB3.</p>
+	<p><strong>Please note</strong> that 3rd party styles downloaded for versions of phpBB2 will <strong>not</strong> work in phpBB3. It is also important to ensure that the style is updated to match the current version of the phpBB software you are using.</p>
 
-	<p>Once you have downloaded a style the usual next step is to unarchive (or upload the unarchived contents of) the package into your <samp>styles/</samp> directory. You then need to visit <code>Administration -&gt; Styles</code>, you should see the new style available, click install and it will become available for all your users.</p>
+	<p>Once you have downloaded a style, the usual next step is to unarchive (or upload the unarchived contents of) the package into your <code>styles/</code> directory. You then need to visit <code>Administration Control Panel -&gt; Styles tab</code> where you should see the new style available. Click &quot;Install&quot; to install the style.</p>
 
-	<p><strong>Please note</strong> that if you create your own style or modify existing ones, please remember to enable the &quot;Recompile stale style components&quot; setting within the <code>Admin-&gt;General-&gt;Load Settings</code> screen. This setting allows the cache to detect changes made to the style and automatically refresh it. If this setting is disabled, you will not see your changes taking effect.</p>
+	<p><strong>Please note</strong> that to improve efficiency, the software caches certain data. For this reason, if you create your own style or modify existing ones, please remember to &quot;Refresh&quot; the appropriate style components <code>Administration Control Panel -&gt; Styles tab -&gt; Style Components</code> screen. You may also need to reload the page you have changed in your web browser to overcome browser caching. If the changed components are not refreshed you will not see your changes taking effect.</p>
 
 	<a name="mods"></a><h3>2.iii. Modifications</h3>
 
-	<p>Although not officially supported by phpBB Group, phpBB has a thriving modification scene. These third party modifications to the standard phpBB extend its capabilities still further and can be found at:</p>
+	<p>Although not officially supported by the phpBB Group, phpBB has a thriving modification scene. These third party modifications to the standard phpBB software, known as <strong>MODs</strong>, extend its capabilities still further. You can browse through many of the MODs in the <a href="https://www.phpbb.com/customise/db/modifications-1/">Modifications</a> section of our <a href="https://www.phpbb.com/customise/db/">Customisation Database</a>.</p>
 
-	<p><a href="http://www.phpbb.com/mods/">http://www.phpbb.com/mods/</a></p>
+	<p>For more information about MODs, please see: <a href="https://www.phpbb.com/mods/">https://www.phpbb.com/mods/</a></p>
 
-	<p><strong>Please remember</strong> that any bugs or other issues that occur after you have added any modification should <strong>NOT</strong> be reported to the bug tracker (see below). First remove the modification and see if the problem is resolved.</p>
+	<p><strong>Please remember</strong> that any bugs or other issues that occur after you have added any modification should <strong>NOT</strong> be reported to the bug tracker (see below). First remove the MOD and see if the problem is resolved. Any support for a MOD should only be sought in the &quot;Discussion/Support&quot; forum for that MOD.</p>
 
-	<p>Also remember that any modifications which modify the database in any way may render upgrading your forum to future versions more difficult unless we state otherwise. With all this said many users have and continue to utilise many of the mods already available with great success.</p>
+	<p>Also remember that any modifications, particularly those which modify the database in any way, may render upgrading your forum to future versions more difficult. With all this said, many users have and continue to utilise many of the MODs already available with great success.</p>
 
 		</div>
 
@@ -178,27 +180,35 @@
 
 		<div class="content">
 
-	<p>phpBB3 can seem a little daunting to new users in places, particularly with regard the permission system. The first thing you should do is check the <a href="FAQ.html">FAQ</a> which covers a few basic getting started questions. If you need additional help there are several places you should look.</p>
+	<p>phpBB3 can sometimes seem a little daunting to new users, particularly with regards to the permission system. The first thing you should do is check the <a href="FAQ.html">FAQ</a>, which covers a few basic getting started questions. If you need additional help there are several places you can find it.</p>
 
 	<a name="docs"></a><h3>3.i. phpBB3 Documentation</h3>
 
-	<p>A comprehensive documentation is now available online and can be accessed from the following location:</p>
+	<p>Comprehensive documentation is now available on the phpBB website:</p>
 
-	<p><a href="http://www.phpbb.com/support/documentation/3.0/">http://www.phpbb.com/support/documentation/3.0/</a></p>
+	<p><a href="https://www.phpbb.com/support/documentation/3.0/">https://www.phpbb.com/support/documentation/3.0/</a></p>
 
-	<p>This covers everything from installation through setting permissions and managing users.</p>
+	<p>This covers everything from installation to setting permissions and managing users.</p>
 
-	<a name="website"></a><h3>3.ii. Community Forums</h3>
+	<a name="kb"></a><h3>3.ii. Knowledge Base</h3>
 
-	<p>phpBB Group maintains a thriving community where a number of people have generously decided to donate their time to help support users. This site can be found at:</p>
+	<p>The Knowledge Base consists of a number of detailed articles on some common issues phpBB users may encounter while using the product. The Knowledge Base can be found at:</p>
 
-	<p><a href="http://www.phpbb.com/">http://www.phpbb.com/</a></p>
+	<p><a href="https://www.phpbb.com/kb/">https://www.phpbb.com/kb/</a></p>
 
-	<p>If you do seek help via our forums please be sure to do a Search before posting. This may well save both you and us time and allow the developer, moderator and support groups to spend more time responding to people with unknown issues and problems. Please also remember that phpBB is an entirely volunteer effort, no one receives any compensation for the time they give, this includes moderators as well as developers. So please be respectful and mindful when awaiting responses.</p>
+	<a name="website"></a><h3>3.iii. Community Forums</h3>
 
-	<a name="irc"></a><h3>3.iii Internet Relay Chat</h3>
+	<p>The phpBB Group maintains a thriving community where a number of people have generously decided to donate their time to help support users. This site can be found at:</p>
 
-	<p>Another place you may find help is our IRC channel. This operates on the Freenode IRC network, <em>irc.freenode.net</em> and the channel is <em>#phpbb</em> and can be accessed by any good IRC client such as mIRC, XChat, etc. Again, please do not abuse this service and be respectful of other users.</p>
+	<p><a href="https://www.phpbb.com/community/">https://www.phpbb.com/community/</a></p>
+
+	<p>If you do seek help via our forums please be sure to do a search before posting; if someone has experienced the issue before, then you may find that your question has already been answered. Please remember that phpBB is entirely staffed by volunteers, no one receives any compensation for the time they give, including moderators as well as developers; please be respectful and mindful when awaiting responses and receiving support.</p>
+
+	<a name="irc"></a><h3>3.iv Internet Relay Chat</h3>
+
+	<p>Another place you may find help is our IRC channel. This operates on the Freenode IRC network, <a href="irc://irc.freenode.net">irc.freenode.net</a> and the channel is <em>#phpbb</em> and can be accessed by any decent IRC client such as mIRC, XChat, etc. Again, please do not abuse this service and be respectful of other users.</p>
+
+	<p>There are other IRC channels available, please see <a href="https://www.phpbb.com/support/irc/">https://www.phpbb.com/support/irc/</a> for the complete list.</p>
 
 		</div>
 
@@ -216,13 +226,13 @@
 
 		<div class="content">
 
-	<p>This is the third stable release of phpBB. The 3.0.x line is essentially feature frozen, with only point releases seeing fixes for bugs and security issues, though feature alterations and minor feature additions may be done if deemed absolutely required. Our next major release will be phpBB 3.2 and the planning phase has begun (the unstable development version is 3.1). Please do not post questions asking when 3.2 will be available, no release date has been set.</p>
+	<p>This is the third stable release of phpBB. The 3.0.x line is essentially feature frozen, with only point releases seeing fixes for bugs and security issues, though feature alterations and minor feature additions may be done if deemed absolutely required. Our next major release will be phpBB 3.1. Please do not post questions asking when 3.1 will be available, no release date has been set.</p>
 
-	<p>For those interested in the development of phpBB should keep an eye on the community forums to see how things are progressing:</p>
+	<p>Those interested in the development of phpBB should keep an eye on the development forums to see how things are progressing:</p>
 
 	<p><a href="http://area51.phpbb.com/phpBB/">http://area51.phpbb.com/phpBB/</a></p>
 
-	<p>Please note that this forum should <strong>NOT</strong> be used to obtain support for or ask questions about phpBB 2.0.x or phpBB 3.0.x, the main community forums are the place for this. Any such posts will be locked and go unanswered.</p>
+	<p>Please note that the development forums should <strong>NOT</strong> be used to seek support for or ask questions about phpBB 2.0.x or phpBB 3.0.x, the main community forums are the place for this. Any such posts will be locked and go unanswered.</p>
 
 		</div>
 
@@ -240,20 +250,20 @@
 
 		<div class="content">
 
-	<p>The phpBB Group uses a bug tracking system to store, list and manage all reported bugs, it can be found at the location listed below. Please <strong>DO NOT</strong> post bug reports to our forums, they will be locked. In addition please <strong>DO NOT</strong> use the bug tracker for support requests. Posting such a request will only see you directed to the support forums (while taking time away from working on real bugs).</p>
+	<p>The phpBB Group uses a bug tracking system to store, list and manage all reported bugs, it can be found at the location listed below. Please <strong>DO NOT</strong> post bug reports to our forums. In addition please <strong>DO NOT</strong> use the bug tracker for support requests. Posting such a request will only see you directed to the support forums (while taking time away from working on real bugs).</p>
 
-	<p><a href="http://tracker.phpbb.com/">http://tracker.phpbb.com/</a></p>
+	<p><a href="http://tracker.phpbb.com/browse/PHPBB3">http://tracker.phpbb.com/browse/PHPBB3</a></p>
 
 	<p>While we very much appreciate receiving bug reports (the more reports the more stable phpBB will be) we ask you carry out a few steps before adding new entries:</p>
 
 	<ul>
-		<li>Firstly determine if your bug is reproduceable, how to determine this depends on the bug in question. Only if the bug is reproduceable it is likely to be a problem with phpBB3 (or in some way connected). If something cannot be reproduced it may turn out to have been your hosting provider working on something, a user doing something silly, etc. Bug reports for non-reproduceable events can slow down our attempts to fix real, reproduceable issues<br /><br /></li>
-		<li>Next please read or search through the existing bug reports to see if <em>your</em> bug (or one very similar to it) is already listed. If it is please add to that existing bug rather than creating a new duplicate entry (all this does is slow us down).<br /><br /></li>
-		<li>Check the forums (use search!) to see if people have discussed anything that sounds similar to what you are seeing. However, as noted above please <strong>DO NOT</strong> post your particular bug to the forum unless it's non-reproduceable or you are sure it's related to something you have done rather phpBB3<br /><br /></li>
+		<li>First, determine if your bug is reproduceable; how to determine this depends on the bug in question. Only if the bug is reproduceable is it likely to be a problem with phpBB3 (or in some way connected). If something cannot be reproduced it may turn out to have been your hosting provider working on something, a user doing something silly, etc. Bug reports for non-reproduceable events can slow down our attempts to fix real, reproduceable issues<br /><br /></li>
+		<li>Next, please read or search through the existing bug reports to see if <em>your</em> bug (or one very similar to it) is already listed. If it is please add to that existing bug rather than creating a new duplicate entry (all this does is slow us down).<br /><br /></li>
+		<li>Check the forums (use search!) to see if people have discussed anything that sounds similar to what you are seeing. However, as noted above please <strong>DO NOT</strong> post your particular bug to the forum unless it's non-reproduceable or you are sure it&rsquo;s related to something you have done rather than phpBB3<br /><br /></li>
 		<li>If no existing bug exists then please feel free to add it</li>
 	</ul>
 
-	<p>If you do post a new bug (i.e. one that isn't already listed in the bug tracker) firstly make sure you have logged in (your username and password are the same as for the community forums) then please include the following details:</p>
+	<p>If you do post a new bug (i.e. one that isn't already listed in the bug tracker) first make sure that you have logged in (your username and password are the same as for the community forums) then please include the following details:</p>
 
 	<ul>
 		<li>Your server type/version, e.g. Apache 1.3.28, IIS 4, Sambar, etc.</li>
@@ -261,9 +271,11 @@
 		<li>DB type/version, e.g. MySQL 4.0.1, PostgreSQL 7.3.2, MSSQL Server 2000 SP1, etc.</li>
 	</ul>
 
-	<p>The relevant database type/version is listed within the administration control panel</p>
+	<p>The relevant database type/version is listed within the administration control panel.</p>
+
+	<p>Please be as detailed as you can in your report, and if possible, list the steps required to duplicate the problem. If you have a patch that fixes the issue, please attach it to the ticket or submit a pull request to our repository <a href="https://github.com/phpbb/phpbb3">on GitHub</a>.</p>
 
-	<p>Please also be as detailed as you can in your report, if possible list the steps required to duplicate the problem. If you have a patch that fixes the issue, please attach it to the ticket or submit a pull request <a href="https://github.com/phpbb/phpbb3">on GitHub</a>.</p>
+	<p>If you create a patch, it is very much appreciated (but not required) if you follow the phpBB coding guidelines. Please note that the coding guidelines are somewhat different between different versions of phpBB. For phpBB 3.0.x the coding guidelines may be found here: <a href="http://area51.phpbb.com/docs/30x/coding-guidelines.html">http://area51.phpbb.com/docs/30x/coding-guidelines.html</a></p>
 
 	<p>Once a bug has been submitted you will be emailed any follow up comments added to it. <strong>Please</strong> if you are requested to supply additional information, do so! It is frustrating for us to receive bug reports, ask for additional information but get nothing. In these cases we have a policy of closing the bug, which may leave a very real problem in place. Obviously we would rather not have this situation arise.</p>
 
@@ -271,7 +283,7 @@
 
 	<p>If you find a potential security related vulnerability in phpBB please <strong>DO NOT</strong> post it to the bug tracker, public forums, etc.! Doing so may allow unscrupulous users to take advantage of it before we have time to put a fix in place. All security related bugs should be sent to our security tracker:</p>
 
-	<p><a href="http://www.phpbb.com/security/">http://www.phpbb.com/security/</a></p>
+	<p><a href="https://www.phpbb.com/security/">https://www.phpbb.com/security/</a></p>
 
 		</div>
 
@@ -289,11 +301,11 @@
 
 		<div class="content">
 
-	<p>This list is not complete but does represent those bugs which may effect users on a wider scale. Other bugs listed in the tracker have typically been shown to be limited to certain setups or methods of installation, updating and/or conversions.</p>
+	<p>This list is not complete but does represent those bugs which may affect users on a wider scale. Other bugs listed in the tracker have typically been shown to be limited to certain setups or methods of installation, updating and/or conversions.</p>
 
 	<ul>
-		<li>Conversions may fail to complete on large boards under some hosts</li>
-		<li>Updates may fail to complete on large update sets under some hosts</li>
+		<li>Conversions may fail to complete on large boards under some hosts.</li>
+		<li>Updates may fail to complete on large update sets under some hosts.</li>
 		<li>Smilies placed directly after bbcode tags will not get parsed. Smilies always need to be separated by spaces.</li>
 	</ul>
 
@@ -313,11 +325,11 @@
 
 		<div class="content">
 
-	<p>phpBB is no longer supported on PHP3 due to several compatibility issues and we recommend that you upgrade to the latest stable release of PHP5 to run phpBB. The minimum version required is PHP 4.3.3.</p>
+	<p>phpBB is no longer supported on PHP3 due to several compatibility issues and we recommend that you upgrade to the latest stable release of PHP5 to run phpBB. The minimum version required is PHP 4.3.3. The minimum version that will be required for phpBB 3.1 is PHP 5.3.3.</p>
 
-	<p>Please remember that running any application on a developmental version of PHP can lead to strange/unexpected results which may appear to be bugs in the application (which may not be true). Therefore we recommend you upgrade to the newest stable version of PHP before running phpBB3. If you are running a developmental version of PHP please check any bugs you find on a system running a stable release before submitting.</p>
+	<p>Please remember that running any application on a development (unstable, e.g. a beta release) version of PHP can lead to strange/unexpected results which may appear to be bugs in the application. Therefore, we recommend you upgrade to the newest stable version of PHP before running phpBB3. If you are running a development version of PHP please check any bugs you find on a system running a stable release before submitting.</p>
 
-	<p>This board has been developed and tested under Linux and Windows (amongst others) running Apache using MySQL 3.23, 4.x, 5.x, MSSQL Server 2000, PostgreSQL 7.x, Oracle 8, SQLite and Firebird. Versions of PHP used range from 4.3.3 to 6.0.0-dev without problem. </p>
+	<p>This board has been developed and tested under Linux and Windows (amongst others) running Apache using MySQL 3.23, 4.x, 5.x, MSSQL Server 2000, PostgreSQL 7.x, Oracle 8, SQLite 2 and Firebird. Versions of PHP used range from 4.3.3 to 5.4.x without problem. </p>
 
 <a name="phpsec"></a><h3>7.i. Notice on PHP security issues</h3>
 
@@ -339,7 +351,7 @@
 
 		<div class="content">
 
-	<p>This application is opensource software released under the <a href="http://opensource.org/licenses/gpl-license.php">GPL</a>. Please see source code and the docs directory for more details. This package and its contents are Copyright (c) <a href="http://www.phpbb.com/">phpBB Group</a>, All Rights Reserved.</p>
+	<p>This application is opensource software released under the <a href="http://opensource.org/licenses/gpl-2.0.php">GNU General Public License v2</a>. Please see source code and the docs directory for more details. This package and its contents are Copyright &copy; <a href="https://www.phpbb.com/">phpBB Group</a>, All Rights Reserved.</p>
 
 		</div>
 
diff -ruN phpBB-3.0.10/download/file.php phpbb/download/file.php
--- phpBB-3.0.10/download/file.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/download/file.php	2013-09-28 03:20:51.000000000 +0200
@@ -170,7 +170,7 @@
 	if (!$attachment['in_message'])
 	{
 		//
-		$sql = 'SELECT p.forum_id, f.forum_password, f.parent_id
+		$sql = 'SELECT p.forum_id, f.forum_name, f.forum_password, f.parent_id
 			FROM ' . POSTS_TABLE . ' p, ' . FORUMS_TABLE . ' f
 			WHERE p.post_id = ' . $attachment['post_msg_id'] . '
 				AND p.forum_id = f.forum_id';
@@ -285,7 +285,7 @@
 	$db->sql_query($sql);
 }
 
-if ($display_cat == ATTACHMENT_CATEGORY_IMAGE && $mode === 'view' && (strpos($attachment['mimetype'], 'image') === 0) && ((strpos(strtolower($user->browser), 'msie') !== false) && (strpos(strtolower($user->browser), 'msie 8.0') === false)))
+if ($display_cat == ATTACHMENT_CATEGORY_IMAGE && $mode === 'view' && (strpos($attachment['mimetype'], 'image') === 0) && (strpos(strtolower($user->browser), 'msie') !== false) && !phpbb_is_greater_ie_version($user->browser, 7))
 {
 	wrap_img_in_html(append_sid($phpbb_root_path . 'download/file.' . $phpEx, 'id=' . $attachment['attach_id']), $attachment['real_filename']);
 	file_gc();
@@ -343,8 +343,8 @@
 
 		$image_data = @getimagesize($file_path);
 		header('Content-Type: ' . image_type_to_mime_type($image_data[2]));
-
-		if (strpos(strtolower($browser), 'msie') !== false && strpos(strtolower($browser), 'msie 8.0') === false)
+			
+		if ((strpos(strtolower($browser), 'msie') !== false) && !phpbb_is_greater_ie_version($browser, 7))
 		{
 			header('Content-Disposition: attachment; ' . header_filename($file));
 
@@ -424,7 +424,7 @@
 	if (!@file_exists($filename))
 	{
 		send_status_line(404, 'Not Found');
-		trigger_error($user->lang['ERROR_NO_ATTACHMENT'] . '<br /><br />' . sprintf($user->lang['FILE_NOT_FOUND_404'], $filename));
+		trigger_error('ERROR_NO_ATTACHMENT');
 	}
 
 	// Correct the mime type - we force application/octetstream for all files, except images
@@ -477,10 +477,9 @@
 	*/
 
 	// Send out the Headers. Do not set Content-Disposition to inline please, it is a security measure for users using the Internet Explorer.
-	$is_ie8 = (strpos(strtolower($user->browser), 'msie 8.0') !== false);
 	header('Content-Type: ' . $attachment['mimetype']);
-
-	if ($is_ie8)
+		
+	if (phpbb_is_greater_ie_version($user->browser, 7))
 	{
 		header('X-Content-Type-Options: nosniff');
 	}
@@ -492,7 +491,7 @@
 	}
 	else
 	{
-		if (empty($user->browser) || (!$is_ie8 && (strpos(strtolower($user->browser), 'msie') !== false)))
+		if (empty($user->browser) || ((strpos(strtolower($user->browser), 'msie') !== false) && !phpbb_is_greater_ie_version($user->browser, 7)))
 		{
 			header('Content-Disposition: attachment; ' . header_filename(htmlspecialchars_decode($attachment['real_filename'])));
 			if (empty($user->browser) || (strpos(strtolower($user->browser), 'msie 6.0') !== false))
@@ -503,7 +502,7 @@
 		else
 		{
 			header('Content-Disposition: ' . ((strpos($attachment['mimetype'], 'image') === 0) ? 'inline' : 'attachment') . '; ' . header_filename(htmlspecialchars_decode($attachment['real_filename'])));
-			if ($is_ie8 && (strpos($attachment['mimetype'], 'image') !== 0))
+			if (phpbb_is_greater_ie_version($user->browser, 7) && (strpos($attachment['mimetype'], 'image') !== 0))
 			{
 				header('X-Download-Options: noopen');
 			}
@@ -680,7 +679,8 @@
 {
 	// let's see if we have to send the file at all
 	$last_load 	=  isset($_SERVER['HTTP_IF_MODIFIED_SINCE']) ? strtotime(trim($_SERVER['HTTP_IF_MODIFIED_SINCE'])) : false;
-	if ((strpos(strtolower($browser), 'msie 6.0') === false) && (strpos(strtolower($browser), 'msie 8.0') === false))
+		
+	if (strpos(strtolower($browser), 'msie 6.0') === false && !phpbb_is_greater_ie_version($browser, 7))
 	{
 		if ($last_load !== false && $last_load >= $stamp)
 		{
@@ -709,4 +709,25 @@
 	exit;
 }
 
+/**
+* Check if the browser is internet explorer version 7+
+*
+* @param string $user_agent	User agent HTTP header
+* @param int $version IE version to check against
+*
+* @return bool true if internet explorer version is greater than $version
+*/
+function phpbb_is_greater_ie_version($user_agent, $version)
+{
+	if (preg_match('/msie (\d+)/', strtolower($user_agent), $matches))
+	{
+		$ie_version = (int) $matches[1];
+		return ($ie_version > $version);
+	}
+	else
+	{
+		return false;
+	}
+}
+
 ?>
\ No newline at end of file
diff -ruN phpBB-3.0.10/feedcreator.class.php phpbb/feedcreator.class.php
--- phpBB-3.0.10/feedcreator.class.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/feedcreator.class.php	2014-04-15 14:31:18.657429005 +0200
@@ -0,0 +1,1541 @@
+<?php
+/***************************************************************************
+
+FeedCreator class v1.7.2
+originally (c) Kai Blankenhorn
+www.bitfolge.de
+kaib@bitfolge.de
+v1.3 work by Scott Reynen (scott@randomchaos.com) and Kai Blankenhorn
+v1.5 OPML support by Dirk Clemens
+
+This library is free software; you can redistribute it and/or
+modify it under the terms of the GNU Lesser General Public
+License as published by the Free Software Foundation; either
+version 2.1 of the License, or (at your option) any later version.
+
+This library is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+Lesser General Public License for more details.
+
+You should have received a copy of the GNU Lesser General Public
+License along with this library; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+
+****************************************************************************
+
+
+Changelog:
+
+v1.7.2	10-11-04
+	license changed to LGPL
+
+v1.7.1
+	fixed a syntax bug
+	fixed left over debug code
+
+v1.7	07-18-04
+	added HTML and JavaScript feeds (configurable via CSS) (thanks to Pascal Van Hecke)
+	added HTML descriptions for all feed formats (thanks to Pascal Van Hecke)
+	added a switch to select an external stylesheet (thanks to Pascal Van Hecke)
+	changed default content-type to application/xml
+	added character encoding setting
+	fixed numerous smaller bugs (thanks to Sren Fuhrmann of golem.de)
+	improved changing ATOM versions handling (thanks to August Trometer)
+	improved the UniversalFeedCreator's useCached method (thanks to Sren Fuhrmann of golem.de)
+	added charset output in HTTP headers (thanks to Sren Fuhrmann of golem.de)
+	added Slashdot namespace to RSS 1.0 (thanks to Sren Fuhrmann of golem.de)
+
+v1.6	05-10-04
+	added stylesheet to RSS 1.0 feeds
+	fixed generator comment (thanks Kevin L. Papendick and Tanguy Pruvot)
+	fixed RFC822 date bug (thanks Tanguy Pruvot)
+	added TimeZone customization for RFC8601 (thanks Tanguy Pruvot)
+	fixed Content-type could be empty (thanks Tanguy Pruvot)
+	fixed author/creator in RSS1.0 (thanks Tanguy Pruvot)
+
+v1.6 beta	02-28-04
+	added Atom 0.3 support (not all features, though)
+	improved OPML 1.0 support (hopefully - added more elements)
+	added support for arbitrary additional elements (use with caution)
+	code beautification :-)
+	considered beta due to some internal changes
+
+v1.5.1	01-27-04
+	fixed some RSS 1.0 glitches (thanks to Stphane Vanpoperynghe)
+	fixed some inconsistencies between documentation and code (thanks to Timothy Martin)
+
+v1.5	01-06-04
+	added support for OPML 1.0
+	added more documentation
+
+v1.4	11-11-03
+	optional feed saving and caching
+	improved documentation
+	minor improvements
+
+v1.3    10-02-03
+	renamed to FeedCreator, as it not only creates RSS anymore
+	added support for mbox
+	tentative support for echo/necho/atom/pie/???
+        
+v1.2    07-20-03
+	intelligent auto-truncating of RSS 0.91 attributes
+	don't create some attributes when they're not set
+	documentation improved
+	fixed a real and a possible bug with date conversions
+	code cleanup
+
+v1.1    06-29-03
+	added images to feeds
+	now includes most RSS 0.91 attributes
+	added RSS 2.0 feeds
+
+v1.0    06-24-03
+	initial release
+
+
+
+***************************************************************************/
+
+/*** GENERAL USAGE *********************************************************
+
+include("feedcreator.class.php"); 
+
+$rss = new UniversalFeedCreator(); 
+$rss->useCached(); // use cached version if age<1 hour
+$rss->title = "PHP news"; 
+$rss->description = "daily news from the PHP scripting world"; 
+
+//optional
+$rss->descriptionTruncSize = 500;
+$rss->descriptionHtmlSyndicated = true;
+
+$rss->link = "http://www.dailyphp.net/news"; 
+$rss->syndicationURL = "http://www.dailyphp.net/".$_SERVER["PHP_SELF"]; 
+
+$image = new FeedImage(); 
+$image->title = "dailyphp.net logo"; 
+$image->url = "http://www.dailyphp.net/images/logo.gif"; 
+$image->link = "http://www.dailyphp.net"; 
+$image->description = "Feed provided by dailyphp.net. Click to visit."; 
+
+//optional
+$image->descriptionTruncSize = 500;
+$image->descriptionHtmlSyndicated = true;
+
+$rss->image = $image; 
+
+// get your news items from somewhere, e.g. your database: 
+mysql_select_db($dbHost, $dbUser, $dbPass); 
+$res = mysql_query("SELECT * FROM news ORDER BY newsdate DESC"); 
+while ($data = mysql_fetch_object($res)) { 
+    $item = new FeedItem(); 
+    $item->title = $data->title; 
+    $item->link = $data->url; 
+    $item->description = $data->short; 
+    
+    //optional
+    item->descriptionTruncSize = 500;
+    item->descriptionHtmlSyndicated = true;
+
+    $item->date = $data->newsdate; 
+    $item->source = "http://www.dailyphp.net"; 
+    $item->author = "John Doe"; 
+     
+    $rss->addItem($item); 
+} 
+
+// valid format strings are: RSS0.91, RSS1.0, RSS2.0, PIE0.1 (deprecated),
+// MBOX, OPML, ATOM, ATOM0.3, HTML, JS
+echo $rss->saveFeed("RSS1.0", "news/feed.xml");
+
+
+***************************************************************************
+*          A little setup                                                 *
+**************************************************************************/
+
+// your local timezone, set to "" to disable or for GMT
+define("TIME_ZONE","+01:00");
+
+
+
+
+/**
+ * Version string.
+ **/
+define("FEEDCREATOR_VERSION", "FeedCreator 1.7.2");
+
+
+
+/**
+ * A FeedItem is a part of a FeedCreator feed.
+ *
+ * @author Kai Blankenhorn <kaib@bitfolge.de>
+ * @since 1.3
+ */
+class FeedItem extends HtmlDescribable {
+	/**
+	 * Mandatory attributes of an item.
+	 */
+	var $title, $description, $link;
+	
+	/**
+	 * Optional attributes of an item.
+	 */
+	var $author, $authorEmail, $image, $category, $comments, $guid, $source, $creator;
+	
+	/**
+	 * Publishing date of an item. May be in one of the following formats:
+	 *
+	 *	RFC 822:
+	 *	"Mon, 20 Jan 03 18:05:41 +0400"
+	 *	"20 Jan 03 18:05:41 +0000"
+	 *
+	 *	ISO 8601:
+	 *	"2003-01-20T18:05:41+04:00"
+	 *
+	 *	Unix:
+	 *	1043082341
+	 */
+	var $date;
+	
+	/**
+	 * Any additional elements to include as an assiciated array. All $key => $value pairs
+	 * will be included unencoded in the feed item in the form
+	 *     <$key>$value</$key>
+	 * Again: No encoding will be used! This means you can invalidate or enhance the feed
+	 * if $value contains markup. This may be abused to embed tags not implemented by
+	 * the FeedCreator class used.
+	 */
+	var $additionalElements = Array();
+
+	// on hold
+	// var $source;
+}
+
+
+
+/**
+ * An FeedImage may be added to a FeedCreator feed.
+ * @author Kai Blankenhorn <kaib@bitfolge.de>
+ * @since 1.3
+ */
+class FeedImage extends HtmlDescribable {
+	/**
+	 * Mandatory attributes of an image.
+	 */
+	var $title, $url, $link;
+	
+	/**
+	 * Optional attributes of an image.
+	 */
+	var $width, $height, $description;
+}
+
+
+
+/**
+ * An HtmlDescribable is an item within a feed that can have a description that may
+ * include HTML markup.
+ */
+class HtmlDescribable {
+	/**
+	 * Indicates whether the description field should be rendered in HTML.
+	 */
+	var $descriptionHtmlSyndicated;
+	
+	/**
+	 * Indicates whether and to how many characters a description should be truncated.
+	 */
+	var $descriptionTruncSize;
+	
+	/**
+	 * Returns a formatted description field, depending on descriptionHtmlSyndicated and
+	 * $descriptionTruncSize properties
+	 * @return    string    the formatted description  
+	 */
+	function getDescription() {
+		$descriptionField = new FeedHtmlField($this->description);
+		$descriptionField->syndicateHtml = $this->descriptionHtmlSyndicated;
+		$descriptionField->truncSize = $this->descriptionTruncSize;
+		return $descriptionField->output();
+	}
+
+}
+
+
+/**
+ * An FeedHtmlField describes and generates
+ * a feed, item or image html field (probably a description). Output is 
+ * generated based on $truncSize, $syndicateHtml properties.
+ * @author Pascal Van Hecke <feedcreator.class.php@vanhecke.info>
+ * @version 1.6
+ */
+class FeedHtmlField {
+	/**
+	 * Mandatory attributes of a FeedHtmlField.
+	 */
+	var $rawFieldContent;
+	
+	/**
+	 * Optional attributes of a FeedHtmlField.
+	 * 
+	 */
+	var $truncSize, $syndicateHtml;
+	
+	/**
+	 * Creates a new instance of FeedHtmlField.
+	 * @param  $string: if given, sets the rawFieldContent property
+	 */
+	function FeedHtmlField($parFieldContent) {
+		if ($parFieldContent) {
+			$this->rawFieldContent = $parFieldContent;
+		}
+	}
+		
+		
+	/**
+	 * Creates the right output, depending on $truncSize, $syndicateHtml properties.
+	 * @return string    the formatted field
+	 */
+	function output() {
+		// when field available and syndicated in html we assume 
+		// - valid html in $rawFieldContent and we enclose in CDATA tags
+		// - no truncation (truncating risks producing invalid html)
+		if (!$this->rawFieldContent) {
+			$result = "";
+		}	elseif ($this->syndicateHtml) {
+			$result = "<![CDATA[".$this->rawFieldContent."]]>";
+		} else {
+			if ($this->truncSize and is_int($this->truncSize)) {
+				$result = FeedCreator::iTrunc(htmlspecialchars($this->rawFieldContent),$this->truncSize);
+			} else {
+				$result = htmlspecialchars($this->rawFieldContent);
+			}
+		}
+		return $result;
+	}
+
+}
+
+
+
+/**
+ * UniversalFeedCreator lets you choose during runtime which
+ * format to build.
+ * For general usage of a feed class, see the FeedCreator class
+ * below or the example above.
+ *
+ * @since 1.3
+ * @author Kai Blankenhorn <kaib@bitfolge.de>
+ */
+class UniversalFeedCreator extends FeedCreator {
+	var $_feed;
+	
+	function _setFormat($format) {
+		switch (strtoupper($format)) {
+			
+			case "2.0":
+				// fall through
+			case "RSS2.0":
+				$this->_feed = new RSSCreator20();
+				break;
+			
+			case "1.0":
+				// fall through
+			case "RSS1.0":
+				$this->_feed = new RSSCreator10();
+				break;
+			
+			case "0.91":
+				// fall through
+			case "RSS0.91":
+				$this->_feed = new RSSCreator091();
+				break;
+			
+			case "PIE0.1":
+				$this->_feed = new PIECreator01();
+				break;
+			
+			case "MBOX":
+				$this->_feed = new MBOXCreator();
+				break;
+			
+			case "OPML":
+				$this->_feed = new OPMLCreator();
+				break;
+				
+			case "ATOM":
+				// fall through: always the latest ATOM version
+				
+			case "ATOM0.3":
+				$this->_feed = new AtomCreator03();
+				break;
+				
+			case "HTML":
+				$this->_feed = new HTMLCreator();
+				break;
+			
+			case "JS":
+				// fall through
+			case "JAVASCRIPT":
+				$this->_feed = new JSCreator();
+				break;
+			
+			default:
+				$this->_feed = new RSSCreator091();
+				break;
+		}
+        
+		$vars = get_object_vars($this);
+		foreach ($vars as $key => $value) {
+			// prevent overwriting of properties "contentType", "encoding"; do not copy "_feed" itself
+			if (!in_array($key, array("_feed", "contentType", "encoding"))) {
+				$this->_feed->{$key} = $this->{$key};
+			}
+		}
+	}
+	
+	/**
+	 * Creates a syndication feed based on the items previously added.
+	 *
+	 * @see        FeedCreator::addItem()
+	 * @param    string    format    format the feed should comply to. Valid values are:
+	 *			"PIE0.1", "mbox", "RSS0.91", "RSS1.0", "RSS2.0", "OPML", "ATOM0.3", "HTML", "JS"
+	 * @return    string    the contents of the feed.
+	 */
+	function createFeed($format = "RSS0.91") {
+		$this->_setFormat($format);
+		return $this->_feed->createFeed();
+	}
+	
+	
+	
+	/**
+	 * Saves this feed as a file on the local disk. After the file is saved, an HTTP redirect
+	 * header may be sent to redirect the use to the newly created file.
+	 * @since 1.4
+	 * 
+	 * @param	string	format	format the feed should comply to. Valid values are:
+	 *			"PIE0.1" (deprecated), "mbox", "RSS0.91", "RSS1.0", "RSS2.0", "OPML", "ATOM", "ATOM0.3", "HTML", "JS"
+	 * @param	string	filename	optional	the filename where a recent version of the feed is saved. If not specified, the filename is $_SERVER["PHP_SELF"] with the extension changed to .xml (see _generateFilename()).
+	 * @param	boolean	displayContents	optional	send the content of the file or not. If true, the file will be sent in the body of the response.
+	 */
+	function saveFeed($format="RSS0.91", $filename="", $displayContents=true) {
+		$this->_setFormat($format);
+		$this->_feed->saveFeed($filename, $displayContents);
+	}
+
+
+   /**
+    * Turns on caching and checks if there is a recent version of this feed in the cache.
+    * If there is, an HTTP redirect header is sent.
+    * To effectively use caching, you should create the FeedCreator object and call this method
+    * before anything else, especially before you do the time consuming task to build the feed
+    * (web fetching, for example).
+    *
+    * @param   string   format   format the feed should comply to. Valid values are:
+    *       "PIE0.1" (deprecated), "mbox", "RSS0.91", "RSS1.0", "RSS2.0", "OPML", "ATOM0.3".
+    * @param filename   string   optional the filename where a recent version of the feed is saved. If not specified, the filename is $_SERVER["PHP_SELF"] with the extension changed to .xml (see _generateFilename()).
+    * @param timeout int      optional the timeout in seconds before a cached version is refreshed (defaults to 3600 = 1 hour)
+    */
+   function useCached($format="RSS0.91", $filename="", $timeout=3600) {
+      $this->_setFormat($format);
+      $this->_feed->useCached($filename, $timeout);
+   }
+
+}
+
+
+/**
+ * FeedCreator is the abstract base implementation for concrete
+ * implementations that implement a specific format of syndication.
+ *
+ * @abstract
+ * @author Kai Blankenhorn <kaib@bitfolge.de>
+ * @since 1.4
+ */
+class FeedCreator extends HtmlDescribable {
+
+	/**
+	 * Mandatory attributes of a feed.
+	 */
+	var $title, $description, $link;
+	
+	
+	/**
+	 * Optional attributes of a feed.
+	 */
+	var $syndicationURL, $image, $language, $copyright, $pubDate, $lastBuildDate, $editor, $editorEmail, $webmaster, $category, $docs, $ttl, $rating, $skipHours, $skipDays;
+
+	/**
+	* The url of the external xsl stylesheet used to format the naked rss feed.
+	* Ignored in the output when empty.
+	*/
+	var $xslStyleSheet = "";
+	
+	
+	/**
+	 * @access private
+	 */
+	var $items = Array();
+ 	
+	
+	/**
+	 * This feed's MIME content type.
+	 * @since 1.4
+	 * @access private
+	 */
+	var $contentType = "application/xml";
+	
+	
+	/**
+	 * This feed's character encoding.
+	 * @since 1.6.1
+	 **/
+	var $encoding = "ISO-8859-1";
+	
+	
+	/**
+	 * Any additional elements to include as an assiciated array. All $key => $value pairs
+	 * will be included unencoded in the feed in the form
+	 *     <$key>$value</$key>
+	 * Again: No encoding will be used! This means you can invalidate or enhance the feed
+	 * if $value contains markup. This may be abused to embed tags not implemented by
+	 * the FeedCreator class used.
+	 */
+	var $additionalElements = Array();
+   
+    
+	/**
+	 * Adds an FeedItem to the feed.
+	 *
+	 * @param object FeedItem $item The FeedItem to add to the feed.
+	 * @access public
+	 */
+	function addItem($item) {
+		$this->items[] = $item;
+	}
+	
+	
+	/**
+	 * Truncates a string to a certain length at the most sensible point.
+	 * First, if there's a '.' character near the end of the string, the string is truncated after this character.
+	 * If there is no '.', the string is truncated after the last ' ' character.
+	 * If the string is truncated, " ..." is appended.
+	 * If the string is already shorter than $length, it is returned unchanged.
+	 * 
+	 * @static
+	 * @param string    string A string to be truncated.
+	 * @param int        length the maximum length the string should be truncated to
+	 * @return string    the truncated string
+	 */
+	function iTrunc($string, $length) {
+		if (strlen($string)<=$length) {
+			return $string;
+		}
+		
+		$pos = strrpos($string,".");
+		if ($pos>=$length-4) {
+			$string = substr($string,0,$length-4);
+			$pos = strrpos($string,".");
+		}
+		if ($pos>=$length*0.4) {
+			return substr($string,0,$pos+1)." ...";
+		}
+		
+		$pos = strrpos($string," ");
+		if ($pos>=$length-4) {
+			$string = substr($string,0,$length-4);
+			$pos = strrpos($string," ");
+		}
+		if ($pos>=$length*0.4) {
+			return substr($string,0,$pos)." ...";
+		}
+		
+		return substr($string,0,$length-4)." ...";
+			
+	}
+	
+	
+	/**
+	 * Creates a comment indicating the generator of this feed.
+	 * The format of this comment seems to be recognized by
+	 * Syndic8.com.
+	 */
+	function _createGeneratorComment() {
+		return "<!-- generator=\"".FEEDCREATOR_VERSION."\" -->\n";
+	}
+	
+	
+	/**
+	 * Creates a string containing all additional elements specified in
+	 * $additionalElements.
+	 * @param	elements	array	an associative array containing key => value pairs
+	 * @param indentString	string	a string that will be inserted before every generated line
+	 * @return    string    the XML tags corresponding to $additionalElements
+	 */
+	function _createAdditionalElements($elements, $indentString="") {
+		$ae = "";
+		if (is_array($elements)) {
+			foreach($elements AS $key => $value) {
+				$ae.= $indentString."<$key>$value</$key>\n";
+			}
+		}
+		return $ae;
+	}
+	
+	function _createStylesheetReferences() {
+		$xml = "";
+		if ($this->cssStyleSheet) $xml .= "<?xml-stylesheet href=\"".$this->cssStyleSheet."\" type=\"text/css\"?>\n";
+		if ($this->xslStyleSheet) $xml .= "<?xml-stylesheet href=\"".$this->xslStyleSheet."\" type=\"text/xsl\"?>\n";
+		return $xml;
+	}
+	
+	
+	/**
+	 * Builds the feed's text.
+	 * @abstract
+	 * @return    string    the feed's complete text 
+	 */
+	function createFeed() {
+	}
+	
+	/**
+	 * Generate a filename for the feed cache file. The result will be $_SERVER["PHP_SELF"] with the extension changed to .xml.
+	 * For example:
+	 * 
+	 * echo $_SERVER["PHP_SELF"]."\n";
+	 * echo FeedCreator::_generateFilename();
+	 * 
+	 * would produce:
+	 * 
+	 * /rss/latestnews.php
+	 * latestnews.xml
+	 *
+	 * @return string the feed cache filename
+	 * @since 1.4
+	 * @access private
+	 */
+	function _generateFilename() {
+		$fileInfo = pathinfo($_SERVER["PHP_SELF"]);
+		return substr($fileInfo["basename"],0,-(strlen($fileInfo["extension"])+1)).".xml";
+	}
+	
+	
+	/**
+	 * @since 1.4
+	 * @access private
+	 */
+	function _redirect($filename) {
+		// attention, heavily-commented-out-area
+		
+		// maybe use this in addition to file time checking
+		//Header("Expires: ".date("r",time()+$this->_timeout));
+		
+		/* no caching at all, doesn't seem to work as good:
+		Header("Cache-Control: no-cache");
+		Header("Pragma: no-cache");
+		*/
+		
+		// HTTP redirect, some feed readers' simple HTTP implementations don't follow it
+		//Header("Location: ".$filename);
+
+		Header("Content-Type: ".$this->contentType."; charset=".$this->encoding."; filename=".basename($filename));
+		Header("Content-Disposition: inline; filename=".basename($filename));
+		readfile($filename, "r");
+		die();
+	}
+    
+	/**
+	 * Turns on caching and checks if there is a recent version of this feed in the cache.
+	 * If there is, an HTTP redirect header is sent.
+	 * To effectively use caching, you should create the FeedCreator object and call this method
+	 * before anything else, especially before you do the time consuming task to build the feed
+	 * (web fetching, for example).
+	 * @since 1.4
+	 * @param filename	string	optional	the filename where a recent version of the feed is saved. If not specified, the filename is $_SERVER["PHP_SELF"] with the extension changed to .xml (see _generateFilename()).
+	 * @param timeout	int		optional	the timeout in seconds before a cached version is refreshed (defaults to 3600 = 1 hour)
+	 */
+	function useCached($filename="", $timeout=3600) {
+		$this->_timeout = $timeout;
+		if ($filename=="") {
+			$filename = $this->_generateFilename();
+		}
+		if (file_exists($filename) AND (time()-filemtime($filename) < $timeout)) {
+			$this->_redirect($filename);
+		}
+	}
+	
+	
+	/**
+	 * Saves this feed as a file on the local disk. After the file is saved, a redirect
+	 * header may be sent to redirect the user to the newly created file.
+	 * @since 1.4
+	 * 
+	 * @param filename	string	optional	the filename where a recent version of the feed is saved. If not specified, the filename is $_SERVER["PHP_SELF"] with the extension changed to .xml (see _generateFilename()).
+	 * @param redirect	boolean	optional	send an HTTP redirect header or not. If true, the user will be automatically redirected to the created file.
+	 */
+	function saveFeed($filename="", $displayContents=true) {
+		if ($filename=="") {
+			$filename = $this->_generateFilename();
+		}
+		$feedFile = fopen($filename, "w+");
+		if ($feedFile) {
+			fputs($feedFile,$this->createFeed());
+			fclose($feedFile);
+			if ($displayContents) {
+				$this->_redirect($filename);
+			}
+		} else {
+			echo "<br /><b>Error creating feed file, please check write permissions.</b><br />";
+		}
+	}
+	
+}
+
+
+/**
+ * FeedDate is an internal class that stores a date for a feed or feed item.
+ * Usually, you won't need to use this.
+ */
+class FeedDate {
+	var $unix;
+	
+	/**
+	 * Creates a new instance of FeedDate representing a given date.
+	 * Accepts RFC 822, ISO 8601 date formats as well as unix time stamps.
+	 * @param mixed $dateString optional the date this FeedDate will represent. If not specified, the current date and time is used.
+	 */
+	function FeedDate($dateString="") {
+		if ($dateString=="") $dateString = date("r");
+		
+		if (is_integer($dateString)) {
+			$this->unix = $dateString;
+			return;
+		}
+		if (preg_match("~(?:(?:Mon|Tue|Wed|Thu|Fri|Sat|Sun),\\s+)?(\\d{1,2})\\s+([a-zA-Z]{3})\\s+(\\d{4})\\s+(\\d{2}):(\\d{2}):(\\d{2})\\s+(.*)~",$dateString,$matches)) {
+			$months = Array("Jan"=>1,"Feb"=>2,"Mar"=>3,"Apr"=>4,"May"=>5,"Jun"=>6,"Jul"=>7,"Aug"=>8,"Sep"=>9,"Oct"=>10,"Nov"=>11,"Dec"=>12);
+			$this->unix = mktime($matches[4],$matches[5],$matches[6],$months[$matches[2]],$matches[1],$matches[3]);
+			if (substr($matches[7],0,1)=='+' OR substr($matches[7],0,1)=='-') {
+				$tzOffset = (substr($matches[7],0,3) * 60 + substr($matches[7],-2)) * 60;
+			} else {
+				if (strlen($matches[7])==1) {
+					$oneHour = 3600;
+					$ord = ord($matches[7]);
+					if ($ord < ord("M")) {
+						$tzOffset = (ord("A") - $ord - 1) * $oneHour;
+					} elseif ($ord >= ord("M") AND $matches[7]!="Z") {
+						$tzOffset = ($ord - ord("M")) * $oneHour;
+					} elseif ($matches[7]=="Z") {
+						$tzOffset = 0;
+					}
+				}
+				switch ($matches[7]) {
+					case "UT":
+					case "GMT":	$tzOffset = 0;
+				}
+			}
+			$this->unix += $tzOffset;
+			return;
+		}
+		if (preg_match("~(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})(.*)~",$dateString,$matches)) {
+			$this->unix = mktime($matches[4],$matches[5],$matches[6],$matches[2],$matches[3],$matches[1]);
+			if (substr($matches[7],0,1)=='+' OR substr($matches[7],0,1)=='-') {
+				$tzOffset = (substr($matches[7],0,3) * 60 + substr($matches[7],-2)) * 60;
+			} else {
+				if ($matches[7]=="Z") {
+					$tzOffset = 0;
+				}
+			}
+			$this->unix += $tzOffset;
+			return;
+		}
+		$this->unix = 0;
+	}
+
+	/**
+	 * Gets the date stored in this FeedDate as an RFC 822 date.
+	 *
+	 * @return a date in RFC 822 format
+	 */
+	function rfc822() {
+		//return gmdate("r",$this->unix);
+		$date = gmdate("D, d M Y H:i:s", $this->unix);
+		if (TIME_ZONE!="") $date .= " ".str_replace(":","",TIME_ZONE);
+		return $date;
+	}
+	
+	/**
+	 * Gets the date stored in this FeedDate as an ISO 8601 date.
+	 *
+	 * @return a date in ISO 8601 format
+	 */
+	function iso8601() {
+		$date = gmdate("Y-m-d\TH:i:sO",$this->unix);
+		$date = substr($date,0,22) . ':' . substr($date,-2);
+		if (TIME_ZONE!="") $date = str_replace("+00:00",TIME_ZONE,$date);
+		return $date;
+	}
+	
+	/**
+	 * Gets the date stored in this FeedDate as unix time stamp.
+	 *
+	 * @return a date as a unix time stamp
+	 */
+	function unix() {
+		return $this->unix;
+	}
+}
+
+
+/**
+ * RSSCreator10 is a FeedCreator that implements RDF Site Summary (RSS) 1.0.
+ *
+ * @see http://www.purl.org/rss/1.0/
+ * @since 1.3
+ * @author Kai Blankenhorn <kaib@bitfolge.de>
+ */
+class RSSCreator10 extends FeedCreator {
+
+	/**
+	 * Builds the RSS feed's text. The feed will be compliant to RDF Site Summary (RSS) 1.0.
+	 * The feed will contain all items previously added in the same order.
+	 * @return    string    the feed's complete text 
+	 */
+	function createFeed() {     
+		$feed = "<?xml version=\"1.0\" encoding=\"".$this->encoding."\"?>\n";
+		$feed.= $this->_createGeneratorComment();
+		if ($this->cssStyleSheet=="") {
+			$cssStyleSheet = "http://www.w3.org/2000/08/w3c-synd/style.css";
+		}
+		$feed.= $this->_createStylesheetReferences();
+		$feed.= "<rdf:RDF\n";
+		$feed.= "    xmlns=\"http://purl.org/rss/1.0/\"\n";
+		$feed.= "    xmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\"\n"; 
+		$feed.= "    xmlns:slash=\"http://purl.org/rss/1.0/modules/slash/\"\n";
+		$feed.= "    xmlns:dc=\"http://purl.org/dc/elements/1.1/\">\n";
+		$feed.= "    <channel rdf:about=\"".$this->syndicationURL."\">\n";
+		$feed.= "        <title>".htmlspecialchars($this->title)."</title>\n";
+		$feed.= "        <description>".htmlspecialchars($this->description)."</description>\n";
+		$feed.= "        <link>".$this->link."</link>\n";
+		if ($this->image!=null) {
+			$feed.= "        <image rdf:resource=\"".$this->image->url."\" />\n";
+		}
+		$now = new FeedDate();
+		$feed.= "       <dc:date>".htmlspecialchars($now->iso8601())."</dc:date>\n";
+		$feed.= "        <items>\n";
+		$feed.= "            <rdf:Seq>\n";
+		for ($i=0;$i<count($this->items);$i++) {
+			$feed.= "                <rdf:li rdf:resource=\"".htmlspecialchars($this->items[$i]->link)."\"/>\n";
+		}
+		$feed.= "            </rdf:Seq>\n";
+		$feed.= "        </items>\n";
+		$feed.= "    </channel>\n";
+		if ($this->image!=null) {
+			$feed.= "    <image rdf:about=\"".$this->image->url."\">\n";
+			$feed.= "        <title>".$this->image->title."</title>\n";
+			$feed.= "        <link>".$this->image->link."</link>\n";
+			$feed.= "        <url>".$this->image->url."</url>\n";
+			$feed.= "    </image>\n";
+		}
+		$feed.= $this->_createAdditionalElements($this->additionalElements, "    ");
+		
+		for ($i=0;$i<count($this->items);$i++) {
+			$feed.= "    <item rdf:about=\"".htmlspecialchars($this->items[$i]->link)."\">\n";
+			//$feed.= "        <dc:type>Posting</dc:type>\n";
+			$feed.= "        <dc:format>text/html</dc:format>\n";
+			if ($this->items[$i]->date!=null) {
+				$itemDate = new FeedDate($this->items[$i]->date);
+				$feed.= "        <dc:date>".htmlspecialchars($itemDate->iso8601())."</dc:date>\n";
+			}
+			if ($this->items[$i]->source!="") {
+				$feed.= "        <dc:source>".htmlspecialchars($this->items[$i]->source)."</dc:source>\n";
+			}
+			if ($this->items[$i]->author!="") {
+				$feed.= "        <dc:creator>".htmlspecialchars($this->items[$i]->author)."</dc:creator>\n";
+			}
+			$feed.= "        <title>".htmlspecialchars(strip_tags(strtr($this->items[$i]->title,"\n\r","  ")))."</title>\n";
+			$feed.= "        <link>".htmlspecialchars($this->items[$i]->link)."</link>\n";
+			$feed.= "        <description>".htmlspecialchars($this->items[$i]->description)."</description>\n";
+			$feed.= $this->_createAdditionalElements($this->items[$i]->additionalElements, "        ");
+			$feed.= "    </item>\n";
+		}
+		$feed.= "</rdf:RDF>\n";
+		return $feed;
+	}
+}
+
+
+
+/**
+ * RSSCreator091 is a FeedCreator that implements RSS 0.91 Spec, revision 3.
+ *
+ * @see http://my.netscape.com/publish/formats/rss-spec-0.91.html
+ * @since 1.3
+ * @author Kai Blankenhorn <kaib@bitfolge.de>
+ */
+class RSSCreator091 extends FeedCreator {
+
+	/**
+	 * Stores this RSS feed's version number.
+	 * @access private
+	 */
+	var $RSSVersion;
+
+	function RSSCreator091() {
+		$this->_setRSSVersion("0.91");
+		$this->contentType = "application/rss+xml";
+	}
+	
+	/**
+	 * Sets this RSS feed's version number.
+	 * @access private
+	 */
+	function _setRSSVersion($version) {
+		$this->RSSVersion = $version;
+	}
+
+	/**
+	 * Builds the RSS feed's text. The feed will be compliant to RDF Site Summary (RSS) 1.0.
+	 * The feed will contain all items previously added in the same order.
+	 * @return    string    the feed's complete text 
+	 */
+	function createFeed() {
+		$feed = "<?xml version=\"1.0\" encoding=\"".$this->encoding."\"?>\n";
+		$feed.= $this->_createGeneratorComment();
+		$feed.= $this->_createStylesheetReferences();
+		$feed.= "<rss version=\"".$this->RSSVersion."\">\n"; 
+		$feed.= "    <channel>\n";
+		$feed.= "        <title>".FeedCreator::iTrunc(htmlspecialchars($this->title),100)."</title>\n";
+		$this->descriptionTruncSize = 500;
+		$feed.= "        <description>".$this->getDescription()."</description>\n";
+		$feed.= "        <link>".$this->link."</link>\n";
+		$now = new FeedDate();
+		$feed.= "        <lastBuildDate>".htmlspecialchars($now->rfc822())."</lastBuildDate>\n";
+		$feed.= "        <generator>".FEEDCREATOR_VERSION."</generator>\n";
+
+		if ($this->image!=null) {
+			$feed.= "        <image>\n";
+			$feed.= "            <url>".$this->image->url."</url>\n"; 
+			$feed.= "            <title>".FeedCreator::iTrunc(htmlspecialchars($this->image->title),100)."</title>\n"; 
+			$feed.= "            <link>".$this->image->link."</link>\n";
+			if ($this->image->width!="") {
+				$feed.= "            <width>".$this->image->width."</width>\n";
+			}
+			if ($this->image->height!="") {
+				$feed.= "            <height>".$this->image->height."</height>\n";
+			}
+			if ($this->image->description!="") {
+				$feed.= "            <description>".$this->image->getDescription()."</description>\n";
+			}
+			$feed.= "        </image>\n";
+		}
+		if ($this->language!="") {
+			$feed.= "        <language>".$this->language."</language>\n";
+		}
+		if ($this->copyright!="") {
+			$feed.= "        <copyright>".FeedCreator::iTrunc(htmlspecialchars($this->copyright),100)."</copyright>\n";
+		}
+		if ($this->editor!="") {
+			$feed.= "        <managingEditor>".FeedCreator::iTrunc(htmlspecialchars($this->editor),100)."</managingEditor>\n";
+		}
+		if ($this->webmaster!="") {
+			$feed.= "        <webMaster>".FeedCreator::iTrunc(htmlspecialchars($this->webmaster),100)."</webMaster>\n";
+		}
+		if ($this->pubDate!="") {
+			$pubDate = new FeedDate($this->pubDate);
+			$feed.= "        <pubDate>".htmlspecialchars($pubDate->rfc822())."</pubDate>\n";
+		}
+		if ($this->category!="") {
+			$feed.= "        <category>".htmlspecialchars($this->category)."</category>\n";
+		}
+		if ($this->docs!="") {
+			$feed.= "        <docs>".FeedCreator::iTrunc(htmlspecialchars($this->docs),500)."</docs>\n";
+		}
+		if ($this->ttl!="") {
+			$feed.= "        <ttl>".htmlspecialchars($this->ttl)."</ttl>\n";
+		}
+		if ($this->rating!="") {
+			$feed.= "        <rating>".FeedCreator::iTrunc(htmlspecialchars($this->rating),500)."</rating>\n";
+		}
+		if ($this->skipHours!="") {
+			$feed.= "        <skipHours>".htmlspecialchars($this->skipHours)."</skipHours>\n";
+		}
+		if ($this->skipDays!="") {
+			$feed.= "        <skipDays>".htmlspecialchars($this->skipDays)."</skipDays>\n";
+		}
+		$feed.= $this->_createAdditionalElements($this->additionalElements, "    ");
+
+		for ($i=0;$i<count($this->items);$i++) {
+			$feed.= "        <item>\n";
+			$feed.= "            <title>".FeedCreator::iTrunc(htmlspecialchars(strip_tags($this->items[$i]->title)),100)."</title>\n";
+			$feed.= "            <link>".htmlspecialchars($this->items[$i]->link)."</link>\n";
+			$feed.= "            <description>".$this->items[$i]->getDescription()."</description>\n";
+			
+			if ($this->items[$i]->author!="") {
+				$feed.= "            <author>".htmlspecialchars($this->items[$i]->author)."</author>\n";
+			}
+			/*
+			// on hold
+			if ($this->items[$i]->source!="") {
+					$feed.= "            <source>".htmlspecialchars($this->items[$i]->source)."</source>\n";
+			}
+			*/
+			if ($this->items[$i]->category!="") {
+				$feed.= "            <category>".htmlspecialchars($this->items[$i]->category)."</category>\n";
+			}
+			if ($this->items[$i]->comments!="") {
+				$feed.= "            <comments>".htmlspecialchars($this->items[$i]->comments)."</comments>\n";
+			}
+			if ($this->items[$i]->date!="") {
+			$itemDate = new FeedDate($this->items[$i]->date);
+				$feed.= "            <pubDate>".htmlspecialchars($itemDate->rfc822())."</pubDate>\n";
+			}
+			if ($this->items[$i]->guid!="") {
+				$feed.= "            <guid>".htmlspecialchars($this->items[$i]->guid)."</guid>\n";
+			}
+			$feed.= $this->_createAdditionalElements($this->items[$i]->additionalElements, "        ");
+			$feed.= "        </item>\n";
+		}
+		$feed.= "    </channel>\n";
+		$feed.= "</rss>\n";
+		return $feed;
+	}
+}
+
+
+
+/**
+ * RSSCreator20 is a FeedCreator that implements RDF Site Summary (RSS) 2.0.
+ *
+ * @see http://backend.userland.com/rss
+ * @since 1.3
+ * @author Kai Blankenhorn <kaib@bitfolge.de>
+ */
+class RSSCreator20 extends RSSCreator091 {
+
+    function RSSCreator20() {
+        parent::_setRSSVersion("2.0");
+    }
+    
+}
+
+
+/**
+ * PIECreator01 is a FeedCreator that implements the emerging PIE specification,
+ * as in http://intertwingly.net/wiki/pie/Syntax.
+ *
+ * @deprecated
+ * @since 1.3
+ * @author Scott Reynen <scott@randomchaos.com> and Kai Blankenhorn <kaib@bitfolge.de>
+ */
+class PIECreator01 extends FeedCreator {
+	
+	function PIECreator01() {
+		$this->encoding = "utf-8";
+	}
+    
+	function createFeed() {
+		$feed = "<?xml version=\"1.0\" encoding=\"".$this->encoding."\"?>\n";
+		$feed.= $this->_createStylesheetReferences();
+		$feed.= "<feed version=\"0.1\" xmlns=\"http://example.com/newformat#\">\n"; 
+		$feed.= "    <title>".FeedCreator::iTrunc(htmlspecialchars($this->title),100)."</title>\n";
+		$this->truncSize = 500;
+		$feed.= "    <subtitle>".$this->getDescription()."</subtitle>\n";
+		$feed.= "    <link>".$this->link."</link>\n";
+		for ($i=0;$i<count($this->items);$i++) {
+			$feed.= "    <entry>\n";
+			$feed.= "        <title>".FeedCreator::iTrunc(htmlspecialchars(strip_tags($this->items[$i]->title)),100)."</title>\n";
+			$feed.= "        <link>".htmlspecialchars($this->items[$i]->link)."</link>\n";
+			$itemDate = new FeedDate($this->items[$i]->date);
+			$feed.= "        <created>".htmlspecialchars($itemDate->iso8601())."</created>\n";
+			$feed.= "        <issued>".htmlspecialchars($itemDate->iso8601())."</issued>\n";
+			$feed.= "        <modified>".htmlspecialchars($itemDate->iso8601())."</modified>\n";
+			$feed.= "        <id>".htmlspecialchars($this->items[$i]->guid)."</id>\n";
+			if ($this->items[$i]->author!="") {
+				$feed.= "        <author>\n";
+				$feed.= "            <name>".htmlspecialchars($this->items[$i]->author)."</name>\n";
+				if ($this->items[$i]->authorEmail!="") {
+					$feed.= "            <email>".$this->items[$i]->authorEmail."</email>\n";
+				}
+				$feed.="        </author>\n";
+			}
+			$feed.= "        <content type=\"text/html\" xml:lang=\"en-us\">\n";
+			$feed.= "            <div xmlns=\"http://www.w3.org/1999/xhtml\">".$this->items[$i]->getDescription()."</div>\n";
+			$feed.= "        </content>\n";
+			$feed.= "    </entry>\n";
+		}
+		$feed.= "</feed>\n";
+		return $feed;
+	}
+}
+
+
+/**
+ * AtomCreator03 is a FeedCreator that implements the atom specification,
+ * as in http://www.intertwingly.net/wiki/pie/FrontPage.
+ * Please note that just by using AtomCreator03 you won't automatically
+ * produce valid atom files. For example, you have to specify either an editor
+ * for the feed or an author for every single feed item.
+ *
+ * Some elements have not been implemented yet. These are (incomplete list):
+ * author URL, item author's email and URL, item contents, alternate links, 
+ * other link content types than text/html. Some of them may be created with
+ * AtomCreator03::additionalElements.
+ *
+ * @see FeedCreator#additionalElements
+ * @since 1.6
+ * @author Kai Blankenhorn <kaib@bitfolge.de>, Scott Reynen <scott@randomchaos.com>
+ */
+class AtomCreator03 extends FeedCreator {
+
+	function AtomCreator03() {
+		$this->contentType = "application/atom+xml";
+		$this->encoding = "utf-8";
+	}
+	
+	function createFeed() {
+		$feed = "<?xml version=\"1.0\" encoding=\"".$this->encoding."\"?>\n";
+		$feed.= $this->_createGeneratorComment();
+		$feed.= $this->_createStylesheetReferences();
+		$feed.= "<feed version=\"0.3\" xmlns=\"http://purl.org/atom/ns#\"";
+		if ($this->language!="") {
+			$feed.= " xml:lang=\"".$this->language."\"";
+		}
+		$feed.= ">\n"; 
+		$feed.= "    <title>".htmlspecialchars($this->title)."</title>\n";
+		$feed.= "    <tagline>".htmlspecialchars($this->description)."</tagline>\n";
+		$feed.= "    <link rel=\"alternate\" type=\"text/html\" href=\"".htmlspecialchars($this->link)."\"/>\n";
+		$feed.= "    <id>".htmlspecialchars($this->link)."</id>\n";
+		$now = new FeedDate();
+		$feed.= "    <modified>".htmlspecialchars($now->iso8601())."</modified>\n";
+		if ($this->editor!="") {
+			$feed.= "    <author>\n";
+			$feed.= "        <name>".$this->editor."</name>\n";
+			if ($this->editorEmail!="") {
+				$feed.= "        <email>".$this->editorEmail."</email>\n";
+			}
+			$feed.= "    </author>\n";
+		}
+		$feed.= "    <generator>".FEEDCREATOR_VERSION."</generator>\n";
+		$feed.= $this->_createAdditionalElements($this->additionalElements, "    ");
+		for ($i=0;$i<count($this->items);$i++) {
+			$feed.= "    <entry>\n";
+			$feed.= "        <title>".htmlspecialchars(strip_tags($this->items[$i]->title))."</title>\n";
+			$feed.= "        <link rel=\"alternate\" type=\"text/html\" href=\"".htmlspecialchars($this->items[$i]->link)."\"/>\n";
+			if ($this->items[$i]->date=="") {
+				$this->items[$i]->date = time();
+			}
+			$itemDate = new FeedDate($this->items[$i]->date);
+			$feed.= "        <created>".htmlspecialchars($itemDate->iso8601())."</created>\n";
+			$feed.= "        <issued>".htmlspecialchars($itemDate->iso8601())."</issued>\n";
+			$feed.= "        <modified>".htmlspecialchars($itemDate->iso8601())."</modified>\n";
+			$feed.= "        <id>".htmlspecialchars($this->items[$i]->link)."</id>\n";
+			$feed.= $this->_createAdditionalElements($this->items[$i]->additionalElements, "        ");
+			if ($this->items[$i]->author!="") {
+				$feed.= "        <author>\n";
+				$feed.= "            <name>".htmlspecialchars($this->items[$i]->author)."</name>\n";
+				$feed.= "        </author>\n";
+			}
+			if ($this->items[$i]->description!="") {
+				$feed.= "        <summary>".htmlspecialchars($this->items[$i]->description)."</summary>\n";
+			}
+			$feed.= "    </entry>\n";
+		}
+		$feed.= "</feed>\n";
+		return $feed;
+	}
+}
+
+
+/**
+ * MBOXCreator is a FeedCreator that implements the mbox format
+ * as described in http://www.qmail.org/man/man5/mbox.html
+ *
+ * @since 1.3
+ * @author Kai Blankenhorn <kaib@bitfolge.de>
+ */
+class MBOXCreator extends FeedCreator {
+
+	function MBOXCreator() {
+		$this->contentType = "text/plain";
+		$this->encoding = "ISO-8859-15";
+	}
+    
+	function qp_enc($input = "", $line_max = 76) { 
+		$hex = array('0','1','2','3','4','5','6','7','8','9','A','B','C','D','E','F'); 
+		$lines = preg_split("/(?:\r\n|\r|\n)/", $input); 
+		$eol = "\r\n"; 
+		$escape = "="; 
+		$output = ""; 
+		while( list(, $line) = each($lines) ) { 
+			//$line = rtrim($line); // remove trailing white space -> no =20\r\n necessary 
+			$linlen = strlen($line); 
+			$newline = ""; 
+			for($i = 0; $i < $linlen; $i++) { 
+				$c = substr($line, $i, 1); 
+				$dec = ord($c); 
+				if ( ($dec == 32) && ($i == ($linlen - 1)) ) { // convert space at eol only 
+					$c = "=20"; 
+				} elseif ( ($dec == 61) || ($dec < 32 ) || ($dec > 126) ) { // always encode "\t", which is *not* required 
+					$h2 = floor($dec/16); $h1 = floor($dec%16); 
+					$c = $escape.$hex["$h2"].$hex["$h1"]; 
+				} 
+				if ( (strlen($newline) + strlen($c)) >= $line_max ) { // CRLF is not counted 
+					$output .= $newline.$escape.$eol; // soft line break; " =\r\n" is okay 
+					$newline = ""; 
+				} 
+				$newline .= $c; 
+			} // end of for 
+			$output .= $newline.$eol; 
+		} 
+		return trim($output); 
+	}
+	
+
+	/**
+	 * Builds the MBOX contents.
+	 * @return    string    the feed's complete text 
+	 */
+	function createFeed() {
+		for ($i=0;$i<count($this->items);$i++) {
+			if ($this->items[$i]->author!="") {
+				$from = $this->items[$i]->author;
+			} else {
+				$from = $this->title;
+			}
+			$itemDate = new FeedDate($this->items[$i]->date);
+			$feed.= "From ".strtr(MBOXCreator::qp_enc($from)," ","_")." ".date("D M d H:i:s Y",$itemDate->unix())."\n";
+			$feed.= "Content-Type: text/plain;\n";
+			$feed.= "	charset=\"".$this->encoding."\"\n";
+			$feed.= "Content-Transfer-Encoding: quoted-printable\n";
+			$feed.= "Content-Type: text/plain\n";
+			$feed.= "From: \"".MBOXCreator::qp_enc($from)."\"\n";
+			$feed.= "Date: ".$itemDate->rfc822()."\n";
+			$feed.= "Subject: ".MBOXCreator::qp_enc(FeedCreator::iTrunc($this->items[$i]->title,100))."\n";
+			$feed.= "\n";
+			$body = chunk_split(MBOXCreator::qp_enc($this->items[$i]->description));
+			$feed.= preg_replace("~\nFrom ([^\n]*)(\n?)~","\n>From $1$2\n",$body);
+			$feed.= "\n";
+			$feed.= "\n";
+		}
+		return $feed;
+	}
+	
+	/**
+	 * Generate a filename for the feed cache file. Overridden from FeedCreator to prevent XML data types.
+	 * @return string the feed cache filename
+	 * @since 1.4
+	 * @access private
+	 */
+	function _generateFilename() {
+		$fileInfo = pathinfo($_SERVER["PHP_SELF"]);
+		return substr($fileInfo["basename"],0,-(strlen($fileInfo["extension"])+1)).".mbox";
+	}
+}
+
+
+/**
+ * OPMLCreator is a FeedCreator that implements OPML 1.0.
+ * 
+ * @see http://opml.scripting.com/spec
+ * @author Dirk Clemens, Kai Blankenhorn
+ * @since 1.5
+ */
+class OPMLCreator extends FeedCreator {
+
+	function OPMLCreator() {
+		$this->encoding = "utf-8";
+	}
+    
+	function createFeed() {     
+		$feed = "<?xml version=\"1.0\" encoding=\"".$this->encoding."\"?>\n";
+		$feed.= $this->_createGeneratorComment();
+		$feed.= $this->_createStylesheetReferences();
+		$feed.= "<opml xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\n";
+		$feed.= "    <head>\n";
+		$feed.= "        <title>".htmlspecialchars($this->title)."</title>\n";
+		if ($this->pubDate!="") {
+			$date = new FeedDate($this->pubDate);
+			$feed.= "         <dateCreated>".$date->rfc822()."</dateCreated>\n";
+		}
+		if ($this->lastBuildDate!="") {
+			$date = new FeedDate($this->lastBuildDate);
+			$feed.= "         <dateModified>".$date->rfc822()."</dateModified>\n";
+		}
+		if ($this->editor!="") {
+			$feed.= "         <ownerName>".$this->editor."</ownerName>\n";
+		}
+		if ($this->editorEmail!="") {
+			$feed.= "         <ownerEmail>".$this->editorEmail."</ownerEmail>\n";
+		}
+		$feed.= "    </head>\n";
+		$feed.= "    <body>\n";
+		for ($i=0;$i<count($this->items);$i++) {
+			$feed.= "    <outline type=\"rss\" ";
+			$title = htmlspecialchars(strip_tags(strtr($this->items[$i]->title,"\n\r","  ")));
+			$feed.= " title=\"".$title."\"";
+			$feed.= " text=\"".$title."\"";
+			//$feed.= " description=\"".htmlspecialchars($this->items[$i]->description)."\"";
+			$feed.= " url=\"".htmlspecialchars($this->items[$i]->link)."\"";
+			$feed.= "/>\n";
+		}
+		$feed.= "    </body>\n";
+		$feed.= "</opml>\n";
+		return $feed;
+	}
+}
+
+
+
+/**
+ * HTMLCreator is a FeedCreator that writes an HTML feed file to a specific 
+ * location, overriding the createFeed method of the parent FeedCreator.
+ * The HTML produced can be included over http by scripting languages, or serve
+ * as the source for an IFrame.
+ * All output by this class is embedded in <div></div> tags to enable formatting
+ * using CSS. 
+ *
+ * @author Pascal Van Hecke
+ * @since 1.7
+ */
+class HTMLCreator extends FeedCreator {
+
+	var $contentType = "text/html";
+	
+	/**
+	 * Contains HTML to be output at the start of the feed's html representation.
+	 */
+	var $header;
+	
+	/**
+	 * Contains HTML to be output at the end of the feed's html representation.
+	 */
+	var $footer ;
+	
+	/**
+	 * Contains HTML to be output between entries. A separator is only used in 
+	 * case of multiple entries.
+	 */
+	var $separator;
+	
+	/**
+	 * Used to prefix the stylenames to make sure they are unique 
+	 * and do not clash with stylenames on the users' page.
+	 */
+	var $stylePrefix;
+	
+	/**
+	 * Determines whether the links open in a new window or not.
+	 */
+	var $openInNewWindow = true;
+	
+	var $imageAlign ="right";
+	
+	/**
+	 * In case of very simple output you may want to get rid of the style tags,
+	 * hence this variable.  There's no equivalent on item level, but of course you can 
+	 * add strings to it while iterating over the items ($this->stylelessOutput .= ...)
+	 * and when it is non-empty, ONLY the styleless output is printed, the rest is ignored
+	 * in the function createFeed().
+	 */
+	var $stylelessOutput ="";
+
+	/**
+	 * Writes the HTML.
+	 * @return    string    the scripts's complete text 
+	 */
+	function createFeed() {
+		// if there is styleless output, use the content of this variable and ignore the rest
+		if ($this->stylelessOutput!="") {
+			return $this->stylelessOutput;
+		}
+		
+		//if no stylePrefix is set, generate it yourself depending on the script name
+		if ($this->stylePrefix=="") {
+			$this->stylePrefix = str_replace(".", "_", $this->_generateFilename())."_";
+		}
+
+		//set an openInNewWindow_token_to be inserted or not
+		if ($this->openInNewWindow) {
+			$targetInsert = " target='_blank'";
+		}
+		
+		// use this array to put the lines in and implode later with "document.write" javascript
+		$feedArray = array();
+		if ($this->image!=null) {
+			$imageStr = "<a href='".$this->image->link."'".$targetInsert.">".
+							"<img src='".$this->image->url."' border='0' alt='".
+							FeedCreator::iTrunc(htmlspecialchars($this->image->title),100).
+							"' align='".$this->imageAlign."' ";
+			if ($this->image->width) {
+				$imageStr .=" width='".$this->image->width. "' ";
+			}
+			if ($this->image->height) {
+				$imageStr .=" height='".$this->image->height."' ";
+			}
+			$imageStr .="/></a>";
+			$feedArray[] = $imageStr;
+		}
+		
+		if ($this->title) {
+			$feedArray[] = "<div class='".$this->stylePrefix."title'><a href='".$this->link."' ".$targetInsert." class='".$this->stylePrefix."title'>".
+				FeedCreator::iTrunc(htmlspecialchars($this->title),100)."</a></div>";
+		}
+		if ($this->getDescription()) {
+			$feedArray[] = "<div class='".$this->stylePrefix."description'>".
+				str_replace("]]>", "", str_replace("<![CDATA[", "", $this->getDescription())).
+				"</div>";
+		}
+		
+		if ($this->header) {
+			$feedArray[] = "<div class='".$this->stylePrefix."header'>".$this->header."</div>";
+		}
+		
+		for ($i=0;$i<count($this->items);$i++) {
+			if ($this->separator and $i > 0) {
+				$feedArray[] = "<div class='".$this->stylePrefix."separator'>".$this->separator."</div>";
+			}
+			
+			if ($this->items[$i]->title) {
+				if ($this->items[$i]->link) {
+					$feedArray[] = 
+						"<div class='".$this->stylePrefix."item_title'><a href='".$this->items[$i]->link."' class='".$this->stylePrefix.
+						"item_title'".$targetInsert.">".FeedCreator::iTrunc(htmlspecialchars(strip_tags($this->items[$i]->title)),100).
+						"</a></div>";
+				} else {
+					$feedArray[] = 
+						"<div class='".$this->stylePrefix."item_title'>".
+						FeedCreator::iTrunc(htmlspecialchars(strip_tags($this->items[$i]->title)),100).
+						"</div>";
+				}
+			}
+			if ($this->items[$i]->getDescription()) {
+				$feedArray[] = 
+				"<div class='".$this->stylePrefix."item_description'>".
+					str_replace("]]>", "", str_replace("<![CDATA[", "", $this->items[$i]->getDescription())).
+					"</div>";
+			}
+		}
+		if ($this->footer) {
+			$feedArray[] = "<div class='".$this->stylePrefix."footer'>".$this->footer."</div>";
+		}
+		
+		$feed= "".join($feedArray, "\r\n");
+		return $feed;
+	}
+    
+	/**
+	 * Overrrides parent to produce .html extensions
+	 *
+	 * @return string the feed cache filename
+	 * @since 1.4
+	 * @access private
+	 */
+	function _generateFilename() {
+		$fileInfo = pathinfo($_SERVER["PHP_SELF"]);
+		return substr($fileInfo["basename"],0,-(strlen($fileInfo["extension"])+1)).".html";
+	}
+}	
+
+
+/**
+ * JSCreator is a class that writes a js file to a specific 
+ * location, overriding the createFeed method of the parent HTMLCreator.
+ *
+ * @author Pascal Van Hecke
+ */
+class JSCreator extends HTMLCreator {
+	var $contentType = "text/javascript";
+	
+	/**
+	 * writes the javascript
+	 * @return    string    the scripts's complete text 
+	 */
+	function createFeed() 
+	{
+		$feed = parent::createFeed();
+		$feedArray = explode("\n",$feed);
+		
+		$jsFeed = "";
+		foreach ($feedArray as $value) {
+			$jsFeed .= "document.write('".trim(addslashes($value))."');\n";
+		}
+		return $jsFeed;
+	}
+    
+	/**
+	 * Overrrides parent to produce .js extensions
+	 *
+	 * @return string the feed cache filename
+	 * @since 1.4
+	 * @access private
+	 */
+	function _generateFilename() {
+		$fileInfo = pathinfo($_SERVER["PHP_SELF"]);
+		return substr($fileInfo["basename"],0,-(strlen($fileInfo["extension"])+1)).".js";
+	}
+	
+}	
+
+
+
+/*** TEST SCRIPT *********************************************************
+
+//include("feedcreator.class.php"); 
+
+$rss = new UniversalFeedCreator(); 
+$rss->useCached(); 
+$rss->title = "PHP news"; 
+$rss->description = "daily news from the PHP scripting world"; 
+
+//optional
+//$rss->descriptionTruncSize = 500;
+//$rss->descriptionHtmlSyndicated = true;
+//$rss->xslStyleSheet = "http://feedster.com/rss20.xsl";
+
+$rss->link = "http://www.dailyphp.net/news"; 
+$rss->feedURL = "http://www.dailyphp.net/".$PHP_SELF; 
+
+$image = new FeedImage(); 
+$image->title = "dailyphp.net logo"; 
+$image->url = "http://www.dailyphp.net/images/logo.gif"; 
+$image->link = "http://www.dailyphp.net"; 
+$image->description = "Feed provided by dailyphp.net. Click to visit."; 
+
+//optional
+$image->descriptionTruncSize = 500;
+$image->descriptionHtmlSyndicated = true;
+
+$rss->image = $image; 
+
+// get your news items from somewhere, e.g. your database: 
+//mysql_select_db($dbHost, $dbUser, $dbPass); 
+//$res = mysql_query("SELECT * FROM news ORDER BY newsdate DESC"); 
+//while ($data = mysql_fetch_object($res)) { 
+	$item = new FeedItem(); 
+	$item->title = "This is an the test title of an item"; 
+	$item->link = "http://localhost/item/"; 
+	$item->description = "<b>description in </b><br/>HTML"; 
+	
+	//optional
+	//item->descriptionTruncSize = 500;
+	$item->descriptionHtmlSyndicated = true;
+	
+	$item->date = time(); 
+	$item->source = "http://www.dailyphp.net"; 
+	$item->author = "John Doe"; 
+	 
+	$rss->addItem($item); 
+//} 
+
+// valid format strings are: RSS0.91, RSS1.0, RSS2.0, PIE0.1, MBOX, OPML, ATOM0.3, HTML, JS
+echo $rss->saveFeed("RSS0.91", "feed.xml"); 
+
+
+
+***************************************************************************/
+
+?>
diff -ruN phpBB-3.0.10/includes/acm/acm_apc.php phpbb/includes/acm/acm_apc.php
--- phpBB-3.0.10/includes/acm/acm_apc.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/acm/acm_apc.php	2013-09-28 03:20:51.000000000 +0200
@@ -33,7 +33,7 @@
 	/**
 	* Purge cache data
 	*
-	* @return void
+	* @return null
 	*/
 	function purge()
 	{
diff -ruN phpBB-3.0.10/includes/acm/acm_eaccelerator.php phpbb/includes/acm/acm_eaccelerator.php
--- phpBB-3.0.10/includes/acm/acm_eaccelerator.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/acm/acm_eaccelerator.php	2013-09-28 03:20:51.000000000 +0200
@@ -37,7 +37,7 @@
 	/**
 	* Purge cache data
 	*
-	* @return void
+	* @return null
 	*/
 	function purge()
 	{
@@ -54,7 +54,7 @@
 	/**
 	 * Perform cache garbage collection
 	 *
-	 * @return void
+	 * @return null
 	 */
 	function tidy()
 	{
diff -ruN phpBB-3.0.10/includes/acm/acm_memcache.php phpbb/includes/acm/acm_memcache.php
--- phpBB-3.0.10/includes/acm/acm_memcache.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/acm/acm_memcache.php	2013-09-28 03:20:51.000000000 +0200
@@ -71,7 +71,7 @@
 	/**
 	* Unload the cache resources
 	*
-	* @return void
+	* @return null
 	*/
 	function unload()
 	{
@@ -83,7 +83,7 @@
 	/**
 	* Purge cache data
 	*
-	* @return void
+	* @return null
 	*/
 	function purge()
 	{
diff -ruN phpBB-3.0.10/includes/acm/acm_redis.php phpbb/includes/acm/acm_redis.php
--- phpBB-3.0.10/includes/acm/acm_redis.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/acm/acm_redis.php	2013-09-28 03:20:51.000000000 +0200
@@ -80,7 +80,7 @@
 	/**
 	* Unload the cache resources
 	*
-	* @return void
+	* @return null
 	*/
 	function unload()
 	{
@@ -92,7 +92,7 @@
 	/**
 	* Purge cache data
 	*
-	* @return void
+	* @return null
 	*/
 	function purge()
 	{
diff -ruN phpBB-3.0.10/includes/acm/acm_wincache.php phpbb/includes/acm/acm_wincache.php
--- phpBB-3.0.10/includes/acm/acm_wincache.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/acm/acm_wincache.php	2013-09-28 03:20:51.000000000 +0200
@@ -32,7 +32,7 @@
 	/**
 	* Purge cache data
 	*
-	* @return void
+	* @return null
 	*/
 	function purge()
 	{
diff -ruN phpBB-3.0.10/includes/acm/acm_xcache.php phpbb/includes/acm/acm_xcache.php
--- phpBB-3.0.10/includes/acm/acm_xcache.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/acm/acm_xcache.php	2013-09-28 03:20:51.000000000 +0200
@@ -48,7 +48,7 @@
 	/**
 	* Purge cache data
 	*
-	* @return void
+	* @return null
 	*/
 	function purge()
 	{
diff -ruN phpBB-3.0.10/includes/acp/acp_bbcodes.php phpbb/includes/acp/acp_bbcodes.php
--- phpBB-3.0.10/includes/acp/acp_bbcodes.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/acp/acp_bbcodes.php	2013-09-28 03:20:51.000000000 +0200
@@ -113,8 +113,8 @@
 				{
 					$template->assign_block_vars('token', array(
 						'TOKEN'		=> '{' . $token . '}',
-						'EXPLAIN'	=> $token_explain)
-					);
+						'EXPLAIN'	=> ($token === 'LOCAL_URL') ? sprintf($token_explain, generate_board_url() . '/') : $token_explain,
+					));
 				}
 
 				return;
@@ -345,6 +345,9 @@
 			'LOCAL_URL'	 => array(
 				'!(' . str_replace(array('!', '\#'), array('\!', '#'), get_preg_expression('relative_url')) . ')!e'	=>	"\$this->bbcode_specialchars('$1')"
 			),
+			'RELATIVE_URL'	=> array(
+				'!(' . str_replace(array('!', '\#'), array('\!', '#'), get_preg_expression('relative_url')) . ')!e'	=>	"\$this->bbcode_specialchars('$1')"
+			),
 			'EMAIL' => array(
 				'!(' . get_preg_expression('email') . ')!ie'	=>	"\$this->bbcode_specialchars('$1')"
 			),
@@ -371,6 +374,7 @@
 		$sp_tokens = array(
 			'URL'	 => '(?i)((?:' . str_replace(array('!', '\#'), array('\!', '#'), get_preg_expression('url')) . ')|(?:' . str_replace(array('!', '\#'), array('\!', '#'), get_preg_expression('www_url')) . '))(?-i)',
 			'LOCAL_URL'	 => '(?i)(' . str_replace(array('!', '\#'), array('\!', '#'), get_preg_expression('relative_url')) . ')(?-i)',
+			'RELATIVE_URL'	 => '(?i)(' . str_replace(array('!', '\#'), array('\!', '#'), get_preg_expression('relative_url')) . ')(?-i)',
 			'EMAIL' => '(' . get_preg_expression('email') . ')',
 			'TEXT' => '(.*?)',
 			'SIMPLETEXT' => '([a-zA-Z0-9-+.,_ ]+)',
@@ -427,7 +431,11 @@
 				$fp_replace = str_replace($token, $replace, $fp_replace);
 
 				$sp_match = str_replace(preg_quote($token, '!'), $sp_tokens[$token_type], $sp_match);
-				$sp_replace = str_replace($token, '${' . ($n + 1) . '}', $sp_replace);
+
+				// Prepend the board url to local relative links
+				$replace_prepend = ($token_type === 'LOCAL_URL') ? generate_board_url() . '/' : '';
+
+				$sp_replace = str_replace($token, $replace_prepend . '${' . ($n + 1) . '}', $sp_replace);
 			}
 
 			$fp_match = '!' . $fp_match . '!' . $modifiers;
diff -ruN phpBB-3.0.10/includes/acp/acp_board.php phpbb/includes/acp/acp_board.php
--- phpBB-3.0.10/includes/acp/acp_board.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/acp/acp_board.php	2013-09-28 03:20:51.000000000 +0200
@@ -234,7 +234,7 @@
 						'max_name_chars'		=> array('lang' => 'USERNAME_LENGTH', 'validate' => 'int:8:180', 'type' => false, 'method' => false, 'explain' => false,),
 						'max_pass_chars'		=> array('lang' => 'PASSWORD_LENGTH', 'validate' => 'int:8:255', 'type' => false, 'method' => false, 'explain' => false,),
 
-						'require_activation'	=> array('lang' => 'ACC_ACTIVATION',	'validate' => 'int',	'type' => 'custom', 'method' => 'select_acc_activation', 'explain' => true),
+						'require_activation'	=> array('lang' => 'ACC_ACTIVATION',	'validate' => 'int',	'type' => 'select', 'method' => 'select_acc_activation', 'explain' => true),
 						'new_member_post_limit'	=> array('lang' => 'NEW_MEMBER_POST_LIMIT', 'validate' => 'int:0:255', 'type' => 'text:4:4', 'explain' => true, 'append' => ' ' . $user->lang['POSTS']),
 						'new_member_group_default'=> array('lang' => 'NEW_MEMBER_GROUP_DEFAULT', 'validate' => 'bool', 'type' => 'radio:yes_no', 'explain' => true),
 						'min_name_chars'		=> array('lang' => 'USERNAME_LENGTH',	'validate' => 'int:1',	'type' => 'custom:5:180', 'method' => 'username_length', 'explain' => true),
@@ -383,6 +383,8 @@
 						'referer_validation'	=> array('lang' => 'REFERER_VALID',		'validate' => 'int:0:3','type' => 'custom', 'method' => 'select_ref_check', 'explain' => true),
 						'check_dnsbl'			=> array('lang' => 'CHECK_DNSBL',			'validate' => 'bool',	'type' => 'radio:yes_no', 'explain' => true),
 						'email_check_mx'		=> array('lang' => 'EMAIL_CHECK_MX',		'validate' => 'bool',	'type' => 'radio:yes_no', 'explain' => true),
+						'max_pass_chars'		=> array('lang' => 'PASSWORD_LENGTH', 'validate' => 'int:8:255', 'type' => false, 'method' => false, 'explain' => false,),
+						'min_pass_chars'		=> array('lang' => 'PASSWORD_LENGTH',	'validate' => 'int:1',	'type' => 'custom', 'method' => 'password_length', 'explain' => true),
 						'pass_complex'			=> array('lang' => 'PASSWORD_TYPE',			'validate' => 'string',	'type' => 'select', 'method' => 'select_password_chars', 'explain' => true),
 						'chg_passforce'			=> array('lang' => 'FORCE_PASS_CHANGE',		'validate' => 'int:0',	'type' => 'text:3:3', 'explain' => true, 'append' => ' ' . $user->lang['DAYS']),
 						'max_login_attempts'	=> array('lang' => 'MAX_LOGIN_ATTEMPTS',	'validate' => 'int:0',	'type' => 'text:3:3', 'explain' => true),
@@ -406,8 +408,8 @@
 						'board_email_form'		=> array('lang' => 'BOARD_EMAIL_FORM',		'validate' => 'bool',	'type' => 'radio:enabled_disabled', 'explain' => true),
 						'email_function_name'	=> array('lang' => 'EMAIL_FUNCTION_NAME',	'validate' => 'string',	'type' => 'text:20:50', 'explain' => true),
 						'email_package_size'	=> array('lang' => 'EMAIL_PACKAGE_SIZE',	'validate' => 'int:0',	'type' => 'text:5:5', 'explain' => true),
-						'board_contact'			=> array('lang' => 'CONTACT_EMAIL',			'validate' => 'string',	'type' => 'text:25:100', 'explain' => true),
-						'board_email'			=> array('lang' => 'ADMIN_EMAIL',			'validate' => 'string',	'type' => 'text:25:100', 'explain' => true),
+						'board_contact'			=> array('lang' => 'CONTACT_EMAIL',			'validate' => 'email',	'type' => 'text:25:100', 'explain' => true),
+						'board_email'			=> array('lang' => 'ADMIN_EMAIL',			'validate' => 'email',	'type' => 'text:25:100', 'explain' => true),
 						'board_email_sig'		=> array('lang' => 'EMAIL_SIG',				'validate' => 'string',	'type' => 'textarea:5:30', 'explain' => true),
 						'board_hide_emails'		=> array('lang' => 'BOARD_HIDE_EMAILS',		'validate' => 'bool',	'type' => 'radio:yes_no', 'explain' => true),
 
@@ -768,24 +770,28 @@
 	/**
 	* Select account activation method
 	*/
-	function select_acc_activation($value, $key = '')
+	function select_acc_activation($selected_value, $value)
 	{
 		global $user, $config;
 
-		$radio_ary = array(
-			USER_ACTIVATION_DISABLE => 'ACC_DISABLE',
-			USER_ACTIVATION_NONE => 'ACC_NONE',
+		$act_ary = array(
+		  'ACC_DISABLE' => USER_ACTIVATION_DISABLE,
+		  'ACC_NONE' => USER_ACTIVATION_NONE,
 		);
-
 		if ($config['email_enable'])
 		{
-			$radio_ary[USER_ACTIVATION_SELF] = 'ACC_USER';
-			$radio_ary[USER_ACTIVATION_ADMIN] = 'ACC_ADMIN';
-		}
+			$act_ary['ACC_USER'] = USER_ACTIVATION_SELF;
+			$act_ary['ACC_ADMIN'] = USER_ACTIVATION_ADMIN;
+		}		
+		$act_options = '';
 
-		$radio_text = h_radio('config[require_activation]', $radio_ary, $value, 'require_activation', $key, '<br />');
+		foreach ($act_ary as $key => $value)
+		{
+			$selected = ($selected_value == $value) ? ' selected="selected"' : '';
+			$act_options .= '<option value="' . $value . '"' . $selected . '>' . $user->lang[$key] . '</option>';
+		}
 
-		return $radio_text;
+		return $act_options;
 	}
 
 	/**
diff -ruN phpBB-3.0.10/includes/acp/acp_captcha.php phpbb/includes/acp/acp_captcha.php
--- phpBB-3.0.10/includes/acp/acp_captcha.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/acp/acp_captcha.php	2013-09-28 03:20:51.000000000 +0200
@@ -96,7 +96,7 @@
 			}
 			else if ($submit)
 			{
-				trigger_error($user->lang['FORM_INVALID'] . adm_back_link(), E_USER_WARNING);
+				trigger_error($user->lang['FORM_INVALID'] . adm_back_link($this->u_action), E_USER_WARNING);
 			}
 			else
 			{
@@ -124,6 +124,8 @@
 					'CAPTCHA_PREVIEW_TPL'	=> $demo_captcha->get_demo_template($id),
 					'S_CAPTCHA_HAS_CONFIG'	=> $demo_captcha->has_config(),
 					'CAPTCHA_SELECT'		=> $captcha_select,
+
+					'U_ACTION'				=> $this->u_action,
 				));
 			}
 		}
diff -ruN phpBB-3.0.10/includes/acp/acp_database.php phpbb/includes/acp/acp_database.php
--- phpBB-3.0.10/includes/acp/acp_database.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/acp/acp_database.php	2013-09-28 03:20:51.000000000 +0200
@@ -21,6 +21,7 @@
 */
 class acp_database
 {
+	var $db_tools;
 	var $u_action;
 
 	function main($id, $mode)
@@ -28,6 +29,12 @@
 		global $cache, $db, $user, $auth, $template, $table_prefix;
 		global $config, $phpbb_root_path, $phpbb_admin_path, $phpEx;
 
+		if (!class_exists('phpbb_db_tools'))
+		{
+			require($phpbb_root_path . 'includes/db/db_tools.' . $phpEx);
+		}
+		$this->db_tools = new phpbb_db_tools($db);
+
 		$user->add_lang('acp/database');
 
 		$this->tpl_name = 'acp_database';
@@ -50,7 +57,7 @@
 				{
 					case 'download':
 						$type	= request_var('type', '');
-						$table	= request_var('table', array(''));
+						$table	= array_intersect($this->db_tools->sql_list_tables(), request_var('table', array('')));
 						$format	= request_var('method', '');
 						$where	= request_var('where', '');
 
@@ -173,8 +180,7 @@
 					break;
 
 					default:
-						include($phpbb_root_path . 'includes/functions_install.' . $phpEx);
-						$tables = get_tables($db);
+						$tables = $this->db_tools->sql_list_tables();
 						asort($tables);
 						foreach ($tables as $table_name)
 						{
diff -ruN phpBB-3.0.10/includes/acp/acp_groups.php phpbb/includes/acp/acp_groups.php
--- phpBB-3.0.10/includes/acp/acp_groups.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/acp/acp_groups.php	2013-09-28 03:20:51.000000000 +0200
@@ -80,6 +80,11 @@
 			case 'approve':
 			case 'demote':
 			case 'promote':
+				if (!check_form_key($form_key))
+				{
+					trigger_error($user->lang['FORM_INVALID'] . adm_back_link($this->u_action), E_USER_WARNING);
+				}
+
 				if (!$group_id)
 				{
 					trigger_error($user->lang['NO_GROUP'] . adm_back_link($this->u_action), E_USER_WARNING);
@@ -120,48 +125,64 @@
 				{
 					trigger_error($user->lang['NO_GROUP'] . adm_back_link($this->u_action), E_USER_WARNING);
 				}
+				else if (empty($mark_ary))
+				{
+					trigger_error($user->lang['NO_USERS'] . adm_back_link($this->u_action . '&amp;action=list&amp;g=' . $group_id), E_USER_WARNING);
+				}
+
+				if (confirm_box(true))
+				{
+					$group_name = ($group_row['group_type'] == GROUP_SPECIAL) ? $user->lang['G_' . $group_row['group_name']] : $group_row['group_name'];
+					group_user_attributes('default', $group_id, $mark_ary, false, $group_name, $group_row);	
+					trigger_error($user->lang['GROUP_DEFS_UPDATED'] . adm_back_link($this->u_action . '&amp;action=list&amp;g=' . $group_id));
+				}
+				else
+				{
+					confirm_box(false, $user->lang['CONFIRM_OPERATION'], build_hidden_fields(array(
+						'mark'		=> $mark_ary,
+						'g'			=> $group_id,
+						'i'			=> $id,
+						'mode'		=> $mode,
+						'action'	=> $action))
+					);
+				}
+			break;
 
+			case 'set_default_on_all':
 				if (confirm_box(true))
 				{
 					$group_name = ($group_row['group_type'] == GROUP_SPECIAL) ? $user->lang['G_' . $group_row['group_name']] : $group_row['group_name'];
 
-					if (!sizeof($mark_ary))
+					$start = 0;
+
+					do
 					{
-						$start = 0;
+						$sql = 'SELECT user_id
+							FROM ' . USER_GROUP_TABLE . "
+							WHERE group_id = $group_id
+							ORDER BY user_id";
+						$result = $db->sql_query_limit($sql, 200, $start);
 
-						do
+						$mark_ary = array();
+						if ($row = $db->sql_fetchrow($result))
 						{
-							$sql = 'SELECT user_id
-								FROM ' . USER_GROUP_TABLE . "
-								WHERE group_id = $group_id
-								ORDER BY user_id";
-							$result = $db->sql_query_limit($sql, 200, $start);
-
-							$mark_ary = array();
-							if ($row = $db->sql_fetchrow($result))
+							do
 							{
-								do
-								{
-									$mark_ary[] = $row['user_id'];
-								}
-								while ($row = $db->sql_fetchrow($result));
+								$mark_ary[] = $row['user_id'];
+							}
+							while ($row = $db->sql_fetchrow($result));
 
-								group_user_attributes('default', $group_id, $mark_ary, false, $group_name, $group_row);
+							group_user_attributes('default', $group_id, $mark_ary, false, $group_name, $group_row);
 
-								$start = (sizeof($mark_ary) < 200) ? 0 : $start + 200;
-							}
-							else
-							{
-								$start = 0;
-							}
-							$db->sql_freeresult($result);
+							$start = (sizeof($mark_ary) < 200) ? 0 : $start + 200;
 						}
-						while ($start);
-					}
-					else
-					{
-						group_user_attributes('default', $group_id, $mark_ary, false, $group_name, $group_row);
+						else
+						{
+							$start = 0;
+						}
+						$db->sql_freeresult($result);
 					}
+					while ($start);
 
 					trigger_error($user->lang['GROUP_DEFS_UPDATED'] . adm_back_link($this->u_action . '&amp;action=list&amp;g=' . $group_id));
 				}
@@ -175,10 +196,13 @@
 						'action'	=> $action))
 					);
 				}
-
 			break;
 
 			case 'deleteusers':
+				if (empty($mark_ary))
+				{
+					trigger_error($user->lang['NO_USERS'] . adm_back_link($this->u_action . '&amp;action=list&amp;g=' . $group_id), E_USER_WARNING);
+				}
 			case 'delete':
 				if (!$group_id)
 				{
@@ -233,6 +257,11 @@
 			break;
 
 			case 'addusers':
+				if (!check_form_key($form_key))
+				{
+					trigger_error($user->lang['FORM_INVALID'] . adm_back_link($this->u_action), E_USER_WARNING);
+				}
+
 				if (!$group_id)
 				{
 					trigger_error($user->lang['NO_GROUP'] . adm_back_link($this->u_action), E_USER_WARNING);
@@ -394,13 +423,21 @@
 						}
 					}
 
-					// Validate the length of "Maximum number of allowed recipients per private message" setting.
-					// We use 16777215 as a maximum because it matches MySQL unsigned mediumint maximum value
-					// which is the lowest amongst DBMSes supported by phpBB3
-					if ($max_recipients_error = validate_data($submit_ary, array('max_recipients' => array('num', false, 0, 16777215))))
+					/*
+					* Validate the length of "Maximum number of allowed recipients per
+					* private message" setting. We use 16777215 as a maximum because it matches
+					* MySQL unsigned mediumint maximum value which is the lowest amongst DBMSes
+					* supported by phpBB3. Also validate the submitted colour value.
+					*/
+					$validation_checks = array(
+						'max_recipients' => array('num', false, 0, 16777215),
+						'colour'	=> array('hex_colour', true),
+					);
+
+					if ($validation_error = validate_data($submit_ary, $validation_checks))
 					{
 						// Replace "error" string with its real, localised form
-						$error = array_merge($error, array_map(array(&$user, 'lang'), $max_recipients_error));
+						$error = array_merge($error, $validation_error);
 					}
 
 					if (!sizeof($error))
@@ -493,6 +530,7 @@
 
 					if (sizeof($error))
 					{
+						$error = array_map(array(&$user, 'lang'), $error);
 						$group_rank = $submit_ary['rank'];
 
 						$group_desc_data = array(
@@ -683,7 +721,7 @@
 					'U_ACTION'			=> $this->u_action . "&amp;g=$group_id",
 					'U_BACK'			=> $this->u_action,
 					'U_FIND_USERNAME'	=> append_sid("{$phpbb_root_path}memberlist.$phpEx", 'mode=searchuser&amp;form=list&amp;field=usernames'),
-					'U_DEFAULT_ALL'		=> "{$this->u_action}&amp;action=default&amp;g=$group_id",
+					'U_DEFAULT_ALL'		=> "{$this->u_action}&amp;action=set_default_on_all&amp;g=$group_id",
 				));
 
 				// Grab the members
@@ -795,4 +833,4 @@
 	}
 }
 
-?>
\ No newline at end of file
+?>
diff -ruN phpBB-3.0.10/includes/acp/acp_main.php phpbb/includes/acp/acp_main.php
--- phpBB-3.0.10/includes/acp/acp_main.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/acp/acp_main.php	2013-09-28 03:20:51.000000000 +0200
@@ -201,7 +201,7 @@
 						// No maximum post id? :o
 						if (!$max_post_id)
 						{
-							$sql = 'SELECT MAX(post_id)
+							$sql = 'SELECT MAX(post_id) as max_post_id
 								FROM ' . POSTS_TABLE;
 							$result = $db->sql_query($sql);
 							$max_post_id = (int) $db->sql_fetchfield('max_post_id');
@@ -398,11 +398,11 @@
 		// Version check
 		$user->add_lang('install');
 
-		if ($auth->acl_get('a_server') && version_compare(PHP_VERSION, '5.2.0', '<'))
+		if ($auth->acl_get('a_server') && version_compare(PHP_VERSION, '5.3.3', '<'))
 		{
 			$template->assign_vars(array(
 				'S_PHP_VERSION_OLD'	=> true,
-				'L_PHP_VERSION_OLD'	=> sprintf($user->lang['PHP_VERSION_OLD'], '<a href="http://www.phpbb.com/community/viewtopic.php?f=14&amp;t=1958605">', '</a>'),
+				'L_PHP_VERSION_OLD'	=> sprintf($user->lang['PHP_VERSION_OLD'], '<a href="https://www.phpbb.com/community/viewtopic.php?f=14&amp;t=2152375">', '</a>'),
 			));
 		}
 
diff -ruN phpBB-3.0.10/includes/acp/acp_profile.php phpbb/includes/acp/acp_profile.php
--- phpBB-3.0.10/includes/acp/acp_profile.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/acp/acp_profile.php	2013-09-28 03:20:51.000000000 +0200
@@ -365,6 +365,7 @@
 					$field_row = array_merge($default_values[$field_type], array(
 						'field_ident'		=> str_replace(' ', '_', utf8_clean_string(request_var('field_ident', '', true))),
 						'field_required'	=> 0,
+						'field_show_novalue'=> 0,
 						'field_hide'		=> 0,
 						'field_show_profile'=> 0,
 						'field_no_view'		=> 0,
@@ -380,7 +381,7 @@
 
 				// $exclude contains the data we gather in each step
 				$exclude = array(
-					1	=> array('field_ident', 'lang_name', 'lang_explain', 'field_option_none', 'field_show_on_reg', 'field_show_on_vt', 'field_required', 'field_hide', 'field_show_profile', 'field_no_view'),
+					1	=> array('field_ident', 'lang_name', 'lang_explain', 'field_option_none', 'field_show_on_reg', 'field_show_on_vt', 'field_required', 'field_show_novalue', 'field_hide', 'field_show_profile', 'field_no_view'),
 					2	=> array('field_length', 'field_maxlen', 'field_minlen', 'field_validation', 'field_novalue', 'field_default_value'),
 					3	=> array('l_lang_name', 'l_lang_explain', 'l_lang_default_value', 'l_lang_options')
 				);
@@ -405,6 +406,7 @@
 				// Visibility Options...
 				$visibility_ary = array(
 					'field_required',
+					'field_show_novalue',
 					'field_show_on_reg',
 					'field_show_on_vt',
 					'field_show_profile',
@@ -504,11 +506,34 @@
 							}
 						}
 					}
-					/* else if ($field_type == FIELD_BOOL && $key == 'field_default_value')
+					else if ($field_type == FIELD_BOOL && $key == 'field_default_value')
 					{
-						// Get the number of options if this key is 'field_maxlen'
-						$var = request_var('field_default_value', 0);
-					}*/
+						// 'field_length' == 1 defines radio buttons. Possible values are 1 or 2 only.
+						// 'field_length' == 2 defines checkbox. Possible values are 0 or 1 only.
+						// If we switch the type on step 2, we have to adjust field value.
+						// 1 is a common value for the checkbox and radio buttons.
+
+						// Adjust unchecked checkbox value.
+						// If we return or save settings from 2nd/3rd page
+						// and the checkbox is unchecked, set the value to 0.
+						if (isset($_REQUEST['step']) && !isset($_REQUEST[$key]))
+						{
+							$var = 0;
+						}
+
+						// If we switch to the checkbox type but former radio buttons value was 2,
+						// which is not the case for the checkbox, set it to 0 (unchecked).
+						if ($cp->vars['field_length'] == 2 && $var == 2)
+						{
+							$var = 0;
+						}
+						// If we switch to the radio buttons but the former checkbox value was 0,
+						// which is not the case for the radio buttons, set it to 0.
+						else if ($cp->vars['field_length'] == 1 && $var == 0)
+						{
+							$var = 2;
+						}
+					}
 					else if ($field_type == FIELD_INT && $key == 'field_default_value')
 					{
 						// Permit an empty string
@@ -676,6 +701,10 @@
 						{
 							$_new_key_ary[$key] = utf8_normalize_nfc(request_var($key, array(array('')), true));
 						}
+						else if ($field_type == FIELD_BOOL && $key == 'field_default_value')
+						{
+							$_new_key_ary[$key] =  request_var($key, $cp->vars[$key]);
+						}
 						else
 						{
 							if (!isset($_REQUEST[$key]))
@@ -730,6 +759,7 @@
 						$template->assign_vars(array(
 							'S_STEP_ONE'		=> true,
 							'S_FIELD_REQUIRED'	=> ($cp->vars['field_required']) ? true : false,
+							'S_FIELD_SHOW_NOVALUE'=> ($cp->vars['field_show_novalue']) ? true : false,
 							'S_SHOW_ON_REG'		=> ($cp->vars['field_show_on_reg']) ? true : false,
 							'S_SHOW_ON_VT'		=> ($cp->vars['field_show_on_vt']) ? true : false,
 							'S_FIELD_HIDE'		=> ($cp->vars['field_hide']) ? true : false,
@@ -1046,6 +1076,7 @@
 			'field_default_value'	=> $cp->vars['field_default_value'],
 			'field_validation'		=> $cp->vars['field_validation'],
 			'field_required'		=> $cp->vars['field_required'],
+			'field_show_novalue'	=> $cp->vars['field_show_novalue'],
 			'field_show_on_reg'		=> $cp->vars['field_show_on_reg'],
 			'field_show_on_vt'		=> $cp->vars['field_show_on_vt'],
 			'field_hide'			=> $cp->vars['field_hide'],
diff -ruN phpBB-3.0.10/includes/acp/acp_ranks.php phpbb/includes/acp/acp_ranks.php
--- phpBB-3.0.10/includes/acp/acp_ranks.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/acp/acp_ranks.php	2013-09-28 03:20:51.000000000 +0200
@@ -52,7 +52,7 @@
 				}
 				$rank_title = utf8_normalize_nfc(request_var('title', '', true));
 				$special_rank = request_var('special_rank', 0);
-				$min_posts = ($special_rank) ? 0 : request_var('min_posts', 0);
+				$min_posts = ($special_rank) ? 0 : max(0, request_var('min_posts', 0));
 				$rank_image = request_var('rank_image', '');
 
 				// The rank image has to be a jpg, gif or png
diff -ruN phpBB-3.0.10/includes/acp/acp_send_statistics.php phpbb/includes/acp/acp_send_statistics.php
--- phpBB-3.0.10/includes/acp/acp_send_statistics.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/acp/acp_send_statistics.php	2013-09-28 03:20:51.000000000 +0200
@@ -29,7 +29,7 @@
 	{
 		global $config, $template, $phpbb_admin_path, $phpEx;
 
-		$collect_url = "http://www.phpbb.com/stats/receive_stats.php";
+		$collect_url = "https://www.phpbb.com/stats/receive_stats.php";
 
 		$this->tpl_name = 'acp_send_statistics';
 		$this->page_title = 'ACP_SEND_STATISTICS';
diff -ruN phpBB-3.0.10/includes/acp/acp_styles.php phpbb/includes/acp/acp_styles.php
--- phpBB-3.0.10/includes/acp/acp_styles.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/acp/acp_styles.php	2013-09-28 03:20:51.000000000 +0200
@@ -99,11 +99,11 @@
 		$this->template_cfg .= '
 # Some configuration options
 
-#
-# You can use this function to inherit templates from another template.
-# The template of the given name has to be installed.
-# Templates cannot inherit from inheriting templates.
-#';
+# Template inheritance
+# See http://blog.phpbb.com/2008/07/31/templating-just-got-easier/
+# Set value to empty or this template name to ignore template inheritance.
+inherit_from = {INHERIT_FROM}
+';
 
 		$this->imageset_keys = array(
 			'logos' => array(
@@ -540,12 +540,14 @@
 		global $user, $template, $db, $config, $phpbb_root_path, $phpEx;
 
 		$sql_from = '';
+		$sql_sort = 'LOWER(' . $mode . '_name)';
 		$style_count = array();
 
 		switch ($mode)
 		{
 			case 'style':
 				$sql_from = STYLES_TABLE;
+				$sql_sort = 'style_active DESC, ' . $sql_sort;
 
 				$sql = 'SELECT user_style, COUNT(user_style) AS style_count
 					FROM ' . USERS_TABLE . '
@@ -571,6 +573,9 @@
 			case 'imageset':
 				$sql_from = STYLES_IMAGESET_TABLE;
 			break;
+			
+			default:
+				trigger_error($user->lang['NO_MODE'] . adm_back_link($this->u_action), E_USER_WARNING);
 		}
 
 		$l_prefix = strtoupper($mode);
@@ -594,7 +599,8 @@
 		);
 
 		$sql = "SELECT *
-			FROM $sql_from";
+			FROM $sql_from
+			ORDER BY $sql_sort ASC";
 		$result = $db->sql_query($sql);
 
 		$installed = array();
@@ -630,6 +636,8 @@
 
 				'NAME'					=> $row[$mode . '_name'],
 				'STYLE_COUNT'			=> ($mode == 'style' && isset($style_count[$row['style_id']])) ? $style_count[$row['style_id']] : 0,
+
+				'S_INACTIVE'			=> ($mode == 'style' && !$row['style_active']) ? true : false,
 				)
 			);
 		}
@@ -659,7 +667,9 @@
 
 						if ($name && !in_array($name, $installed))
 						{
-							$new_ary[] = array(
+							// The array key is used for sorting later on.
+							// $file is appended because $name doesn't have to be unique.
+							$new_ary[$name . $file] = array(
 								'path'		=> $file,
 								'name'		=> $name,
 								'copyright'	=> $items['copyright'],
@@ -675,6 +685,8 @@
 
 		if (sizeof($new_ary))
 		{
+			ksort($new_ary);
+
 			foreach ($new_ary as $cfg)
 			{
 				$template->assign_block_vars('uninstalled', array(
@@ -2039,9 +2051,7 @@
 			// Export template core code
 			if ($mode == 'template' || $inc_template)
 			{
-				$template_cfg = str_replace(array('{MODE}', '{NAME}', '{COPYRIGHT}', '{VERSION}'), array($mode, $style_row['template_name'], $style_row['template_copyright'], $config['version']), $this->template_cfg);
-
-				$use_template_name = '';
+				$use_template_name = $style_row['template_name'];
 
 				// Add the inherit from variable, depending on it's use...
 				if ($style_row['template_inherits_id'])
@@ -2055,7 +2065,8 @@
 					$db->sql_freeresult($result);
 				}
 
-				$template_cfg .= ($use_template_name) ? "\ninherit_from = $use_template_name" : "\n#inherit_from = ";
+				$template_cfg = str_replace(array('{MODE}', '{NAME}', '{COPYRIGHT}', '{VERSION}', '{INHERIT_FROM}'), array($mode, $style_row['template_name'], $style_row['template_copyright'], $config['version'], $use_template_name), $this->template_cfg);
+
 				$template_cfg .= "\n\nbbcode_bitfield = {$style_row['bbcode_bitfield']}";
 
 				$data[] = array(
diff -ruN phpBB-3.0.10/includes/acp/acp_update.php phpbb/includes/acp/acp_update.php
--- phpBB-3.0.10/includes/acp/acp_update.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/acp/acp_update.php	2013-09-28 03:20:51.000000000 +0200
@@ -39,7 +39,7 @@
 
 		$info = obtain_latest_version_info(request_var('versioncheck_force', false));
 
-		if ($info === false)
+		if (empty($info))
 		{
 			trigger_error('VERSIONCHECK_FAIL', E_USER_WARNING);
 		}
diff -ruN phpBB-3.0.10/includes/acp/acp_users.php phpbb/includes/acp/acp_users.php
--- phpBB-3.0.10/includes/acp/acp_users.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/acp/acp_users.php	2013-09-28 03:20:51.000000000 +0200
@@ -1009,6 +1009,13 @@
 				$user_row['posts_in_queue'] = (int) $db->sql_fetchfield('posts_in_queue');
 				$db->sql_freeresult($result);
 
+				$sql = 'SELECT post_id
+					FROM ' . POSTS_TABLE . '
+					WHERE poster_id = '. $user_id;
+				$result = $db->sql_query_limit($sql, 1);
+				$user_row['user_has_posts'] = (bool) $db->sql_fetchfield('post_id');
+				$db->sql_freeresult($result);
+
 				$template->assign_vars(array(
 					'L_NAME_CHARS_EXPLAIN'		=> sprintf($user->lang[$config['allow_name_chars'] . '_EXPLAIN'], $config['min_name_chars'], $config['max_name_chars']),
 					'L_CHANGE_PASSWORD_EXPLAIN'	=> sprintf($user->lang[$config['pass_complex'] . '_EXPLAIN'], $config['min_pass_chars'], $config['max_pass_chars']),
@@ -1036,6 +1043,7 @@
 					'USER_EMAIL'		=> $user_row['user_email'],
 					'USER_WARNINGS'		=> $user_row['user_warnings'],
 					'USER_POSTS'		=> $user_row['user_posts'],
+					'USER_HAS_POSTS'	=> $user_row['user_has_posts'],
 					'USER_INACTIVE_REASON'	=> $inactive_reason,
 				));
 
@@ -2339,47 +2347,62 @@
 	}
 
 	/**
-	* Optionset replacement for this module based on $user->optionset
+	* Set option bit field for user options in a user row array.
+	*
+	* Optionset replacement for this module based on $user->optionset.
+	*
+	* @param array $user_row Row from the users table.
+	* @param int $key Option key, as defined in $user->keyoptions property.
+	* @param bool $value True to set the option, false to clear the option.
+	* @param int $data Current bit field value, or false to use $user_row['user_options']
+	* @return int|bool If $data is false, the bit field is modified and
+	*                  written back to $user_row['user_options'], and
+	*                  return value is true if the bit field changed and
+	*                  false otherwise. If $data is not false, the new
+	*                  bitfield value is returned.
 	*/
 	function optionset(&$user_row, $key, $value, $data = false)
 	{
 		global $user;
 
-		$var = ($data) ? $data : $user_row['user_options'];
+		$var = ($data !== false) ? $data : $user_row['user_options'];
 
-		if ($value && !($var & 1 << $user->keyoptions[$key]))
-		{
-			$var += 1 << $user->keyoptions[$key];
-		}
-		else if (!$value && ($var & 1 << $user->keyoptions[$key]))
-		{
-			$var -= 1 << $user->keyoptions[$key];
-		}
-		else
-		{
-			return ($data) ? $var : false;
-		}
+		$new_var = phpbb_optionset($user->keyoptions[$key], $value, $var);
 
-		if (!$data)
+		if ($data === false)
 		{
-			$user_row['user_options'] = $var;
-			return true;
+			if ($new_var != $var)
+			{
+				$user_row['user_options'] = $new_var;
+				return true;
+			}
+			else
+			{
+				return false;
+			}
 		}
 		else
 		{
-			return $var;
+			return $new_var;
 		}
 	}
 
 	/**
-	* Optionget replacement for this module based on $user->optionget
+	* Get option bit field from user options in a user row array.
+	*
+	* Optionget replacement for this module based on $user->optionget.
+	*
+	* @param array $user_row Row from the users table.
+	* @param int $key option key, as defined in $user->keyoptions property.
+	* @param int $data bit field value to use, or false to use $user_row['user_options']
+	* @return bool true if the option is set in the bit field, false otherwise
 	*/
 	function optionget(&$user_row, $key, $data = false)
 	{
 		global $user;
 
-		$var = ($data) ? $data : $user_row['user_options'];
-		return ($var & 1 << $user->keyoptions[$key]) ? true : false;
+		$var = ($data !== false) ? $data : $user_row['user_options'];
+		return phpbb_optionget($user->keyoptions[$key], $var);
 	}
 }
 
diff -ruN phpBB-3.0.10/includes/auth/auth_db.php phpbb/includes/auth/auth_db.php
--- phpBB-3.0.10/includes/auth/auth_db.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/auth/auth_db.php	2013-09-28 03:20:51.000000000 +0200
@@ -163,7 +163,7 @@
 		$password_old_format = (!STRIP) ? addslashes($password_old_format) : $password_old_format;
 		$password_new_format = '';
 
-		set_var($password_new_format, stripslashes($password_old_format), 'string');
+		set_var($password_new_format, stripslashes($password_old_format), 'string', true);
 
 		if ($password == $password_new_format)
 		{
diff -ruN phpBB-3.0.10/includes/auth/auth_ldap.php phpbb/includes/auth/auth_ldap.php
--- phpBB-3.0.10/includes/auth/auth_ldap.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/auth/auth_ldap.php	2013-09-28 03:20:51.000000000 +0200
@@ -156,7 +156,11 @@
 	{
 		if (!@ldap_bind($ldap, htmlspecialchars_decode($config['ldap_user']), htmlspecialchars_decode($config['ldap_password'])))
 		{
-			return $user->lang['LDAP_NO_SERVER_CONNECTION'];
+			return array(
+				'status'		=> LOGIN_ERROR_EXTERNAL_AUTH,
+				'error_msg'		=> 'LDAP_NO_SERVER_CONNECTION',
+				'user_row'		=> array('user_id' => ANONYMOUS),
+			);
 		}
 	}
 
diff -ruN phpBB-3.0.10/includes/captcha/captcha_non_gd.php phpbb/includes/captcha/captcha_non_gd.php
--- phpBB-3.0.10/includes/captcha/captcha_non_gd.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/captcha/captcha_non_gd.php	2013-09-28 03:20:51.000000000 +0200
@@ -119,7 +119,7 @@
 		$new_line = '';
 
 		$end = strlen($scanline) - ceil($width/2);
-		for ($i = floor($width/2); $i < $end; $i++)
+		for ($i = (int) floor($width / 2); $i < $end; $i++)
 		{
 			$pixel = ord($scanline{$i});
 
diff -ruN phpBB-3.0.10/includes/captcha/plugins/captcha_abstract.php phpbb/includes/captcha/plugins/captcha_abstract.php
--- phpBB-3.0.10/includes/captcha/plugins/captcha_abstract.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/captcha/plugins/captcha_abstract.php	2014-04-15 14:31:18.659429005 +0200
@@ -98,10 +98,14 @@
 			$link = append_sid($phpbb_root_path . 'ucp.' . $phpEx,  'mode=confirm&amp;confirm_id=' . $this->confirm_id . '&amp;type=' . $this->type);
 			$explain = $user->lang(($this->type != CONFIRM_POST) ? 'CONFIRM_EXPLAIN' : 'POST_CONFIRM_EXPLAIN', '<a href="mailto:' . htmlspecialchars($config['board_contact']) . '">', '</a>');
 
+			$captcha = '<div style="background-image:url(\'' . $link . '\'); width:360px; height:96px"></div>';
+
 			$template->assign_vars(array(
 				'CONFIRM_IMAGE_LINK'		=> $link,
-				'CONFIRM_IMAGE'				=> '<img src="' . $link . '" />',
-				'CONFIRM_IMG'				=> '<img src="' . $link . '" />',
+				//'CONFIRM_IMAGE'				=> '<img src="' . $link . '" />',
+				//'CONFIRM_IMG'				=> '<img src="' . $link . '" />',
+				'CONFIRM_IMAGE'				=> $captcha,
+				'CONFIRM_IMG'				=> $captcha,
 				'CONFIRM_ID'				=> $this->confirm_id,
 				'S_CONFIRM_CODE'			=> true,
 				'S_TYPE'					=> $this->type,
@@ -377,4 +381,4 @@
 
 }
 
-?>
\ No newline at end of file
+?>
diff -ruN phpBB-3.0.10/includes/constants.php phpbb/includes/constants.php
--- phpBB-3.0.10/includes/constants.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/constants.php	2013-09-28 03:20:51.000000000 +0200
@@ -25,7 +25,7 @@
 */
 
 // phpBB Version
-define('PHPBB_VERSION', '3.0.10');
+define('PHPBB_VERSION', '3.0.12');
 
 // QA-related
 // define('PHPBB_QA', 1);
@@ -157,6 +157,7 @@
 define('CONFIRM_REG', 1);
 define('CONFIRM_LOGIN', 2);
 define('CONFIRM_POST', 3);
+define('CONFIRM_REPORT', 4);
 
 // Categories - Attachments
 define('ATTACHMENT_CATEGORY_NONE', 0);
diff -ruN phpBB-3.0.10/includes/db/dbal.php phpbb/includes/db/dbal.php
--- phpBB-3.0.10/includes/db/dbal.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/db/dbal.php	2013-09-28 03:20:51.000000000 +0200
@@ -195,6 +195,49 @@
 	}
 
 	/**
+	* Seek to given row number
+	* rownum is zero-based
+	*/
+	function sql_rowseek($rownum, &$query_id)
+	{
+		global $cache;
+
+		if ($query_id === false)
+		{
+			$query_id = $this->query_result;
+		}
+
+		if (isset($cache->sql_rowset[$query_id]))
+		{
+			return $cache->sql_rowseek($rownum, $query_id);
+		}
+
+		if ($query_id === false)
+		{
+			return false;
+		}
+
+		$this->sql_freeresult($query_id);
+		$query_id = $this->sql_query($this->last_query_text);
+
+		if ($query_id === false)
+		{
+			return false;
+		}
+
+		// We do not fetch the row for rownum == 0 because then the next resultset would be the second row
+		for ($i = 0; $i < $rownum; $i++)
+		{
+			if (!$this->sql_fetchrow($query_id))
+			{
+				return false;
+			}
+		}
+
+		return true;
+	}
+
+	/**
 	* Fetch field
 	* if rownum is false, the current row is used, else it is pointing to the row (zero-based)
 	*/
@@ -458,6 +501,18 @@
 	}
 
 	/**
+	* Run LOWER() on DB column of type text (i.e. neither varchar nor char).
+	*
+	* @param string $column_name	The column name to use
+	*
+	* @return string				A SQL statement like "LOWER($column_name)"
+	*/
+	function sql_lower_text($column_name)
+	{
+		return "LOWER($column_name)";
+	}
+
+	/**
 	* Run more than one insert statement.
 	*
 	* @param string $table table name to run the statements on
@@ -662,12 +717,7 @@
 			// The DEBUG_EXTRA constant is for development only!
 			if ((isset($auth) && $auth->acl_get('a_')) || defined('IN_INSTALL') || defined('DEBUG_EXTRA'))
 			{
-				// Print out a nice backtrace...
-				$backtrace = get_backtrace();
-
 				$message .= ($sql) ? '<br /><br />SQL<br /><br />' . htmlspecialchars($sql) : '';
-				$message .= ($backtrace) ? '<br /><br />BACKTRACE<br />' . $backtrace : '';
-				$message .= '<br />';
 			}
 			else
 			{
@@ -777,7 +827,7 @@
 							</div>
 						</div>
 						<div id="page-footer">
-							Powered by <a href="http://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Group
+							Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Group
 						</div>
 					</div>
 					</body>
@@ -905,6 +955,41 @@
 
 		return true;
 	}
+
+	/**
+	* Gets the estimated number of rows in a specified table.
+	*
+	* @param string $table_name		Table name
+	*
+	* @return string				Number of rows in $table_name.
+	*								Prefixed with ~ if estimated (otherwise exact).
+	*
+	* @access public
+	*/
+	function get_estimated_row_count($table_name)
+	{
+		return $this->get_row_count($table_name);
+	}
+
+	/**
+	* Gets the exact number of rows in a specified table.
+	*
+	* @param string $table_name		Table name
+	*
+	* @return string				Exact number of rows in $table_name.
+	*
+	* @access public
+	*/
+	function get_row_count($table_name)
+	{
+		$sql = 'SELECT COUNT(*) AS rows_total
+			FROM ' . $this->sql_escape($table_name);
+		$result = $this->sql_query($sql);
+		$rows_total = $this->sql_fetchfield('rows_total');
+		$this->sql_freeresult($result);
+
+		return $rows_total;
+	}
 }
 
 /**
diff -ruN phpBB-3.0.10/includes/db/db_tools.php phpbb/includes/db/db_tools.php
--- phpBB-3.0.10/includes/db/db_tools.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/db/db_tools.php	2013-09-28 03:20:51.000000000 +0200
@@ -1819,6 +1819,22 @@
 
 			case 'mssql':
 			case 'mssqlnative':
+				// remove default cosntraints first
+				// http://msdn.microsoft.com/en-us/library/aa175912%28v=sql.80%29.aspx
+				$statements[] = "DECLARE @drop_default_name VARCHAR(100), @cmd VARCHAR(1000)
+					SET @drop_default_name =
+						(SELECT so.name FROM sysobjects so
+						JOIN sysconstraints sc ON so.id = sc.constid
+						WHERE object_name(so.parent_obj) = '{$table_name}'
+							AND so.xtype = 'D'
+							AND sc.colid = (SELECT colid FROM syscolumns
+								WHERE id = object_id('{$table_name}')
+									AND name = '{$column_name}'))
+					IF @drop_default_name <> ''
+					BEGIN
+						SET @cmd = 'ALTER TABLE [{$table_name}] DROP CONSTRAINT [' + @drop_default_name + ']'
+						EXEC(@cmd)
+					END";
 				$statements[] = 'ALTER TABLE [' . $table_name . '] DROP COLUMN [' . $column_name . ']';
 			break;
 
@@ -2115,7 +2131,7 @@
 
 			case 'mysql_40':
 			case 'mysql_41':
-				$statements[] = 'ALTER TABLE ' . $table_name . ' ADD UNIQUE INDEX (' . implode(', ', $column) . ')';
+				$statements[] = 'ALTER TABLE ' . $table_name . ' ADD UNIQUE INDEX ' . $index_name . '(' . implode(', ', $column) . ')';
 			break;
 
 			case 'mssql':
diff -ruN phpBB-3.0.10/includes/db/firebird.php phpbb/includes/db/firebird.php
--- phpBB-3.0.10/includes/db/firebird.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/db/firebird.php	2013-09-28 03:20:51.000000000 +0200
@@ -360,49 +360,6 @@
 	}
 
 	/**
-	* Seek to given row number
-	* rownum is zero-based
-	*/
-	function sql_rowseek($rownum, &$query_id)
-	{
-		global $cache;
-
-		if ($query_id === false)
-		{
-			$query_id = $this->query_result;
-		}
-
-		if (isset($cache->sql_rowset[$query_id]))
-		{
-			return $cache->sql_rowseek($rownum, $query_id);
-		}
-
-		if ($query_id === false)
-		{
-			return;
-		}
-
-		$this->sql_freeresult($query_id);
-		$query_id = $this->sql_query($this->last_query_text);
-
-		if ($query_id === false)
-		{
-			return false;
-		}
-
-		// We do not fetch the row for rownum == 0 because then the next resultset would be the second row
-		for ($i = 0; $i < $rownum; $i++)
-		{
-			if (!$this->sql_fetchrow($query_id))
-			{
-				return false;
-			}
-		}
-
-		return true;
-	}
-
-	/**
 	* Get last inserted id after insert statement
 	*/
 	function sql_nextid()
diff -ruN phpBB-3.0.10/includes/db/mssqlnative.php phpbb/includes/db/mssqlnative.php
--- phpBB-3.0.10/includes/db/mssqlnative.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/db/mssqlnative.php	2013-09-28 03:20:51.000000000 +0200
@@ -199,16 +199,18 @@
 	var $m_insert_id = NULL;
 	var $last_query_text = '';
 	var $query_options = array();
+	var $connect_error = '';
 
 	/**
 	* Connect to server
 	*/
 	function sql_connect($sqlserver, $sqluser, $sqlpassword, $database, $port = false, $persistency = false, $new_link = false)
 	{
-		# Test for driver support, to avoid suppressed fatal error
+		// Test for driver support, to avoid suppressed fatal error
 		if (!function_exists('sqlsrv_connect'))
 		{
-			trigger_error('Native MS SQL Server driver for PHP is missing or needs to be updated. Version 1.1 or later is required to install phpBB3. You can download the driver from: http://www.microsoft.com/sqlserver/2005/en/us/PHP-Driver.aspx\n', E_USER_ERROR);
+			$this->connect_error = 'Native MS SQL Server driver for PHP is missing or needs to be updated. Version 1.1 or later is required to install phpBB3. You can download the driver from: http://www.microsoft.com/sqlserver/2005/en/us/PHP-Driver.aspx';
+			return $this->sql_error('');
 		}
 
 		//set up connection variables
@@ -219,7 +221,6 @@
 		$this->server = $sqlserver . (($port) ? $port_delimiter . $port : '');
 
 		//connect to database
-		error_reporting(E_ALL);
 		$this->db_connect_id = sqlsrv_connect($this->server, array(
 			'Database' => $this->dbname,
 			'UID' => $this->user,
@@ -436,25 +437,7 @@
 				unset($row['line2'], $row['line3']);
 			}
 		}
-		return $row;
-	}
-
-	/**
-	* Seek to given row number
-	* rownum is zero-based
-	*/
-	function sql_rowseek($rownum, &$query_id)
-	{
-		global $cache;
-
-		if (isset($cache->sql_rowset[$query_id]))
-		{
-			return $cache->sql_rowseek($rownum, $query_id);
-		}
-
-		$seek = new result_mssqlnative($query_id);
-		$row = $seek->seek($rownum);
-		return ($row = $seek->fetch()) ? $row : false;
+		return (sizeof($row)) ? $row : false;
 	}
 
 	/**
@@ -511,6 +494,14 @@
 	}
 
 	/**
+	* {@inheritDoc}
+	*/
+	function sql_lower_text($column_name)
+	{
+		return "LOWER(SUBSTRING($column_name, 1, DATALENGTH($column_name)))";
+	}
+
+	/**
 	* Build LIKE expression
 	* @access private
 	*/
@@ -525,31 +516,43 @@
 	*/
 	function _sql_error()
 	{
-		$errors = @sqlsrv_errors(SQLSRV_ERR_ERRORS);
-		$error_message = '';
-		$code = 0;
-
-		if ($errors != null)
+		if (function_exists('sqlsrv_errors'))
 		{
-			foreach ($errors as $error)
+			$errors = @sqlsrv_errors(SQLSRV_ERR_ERRORS);
+			$error_message = '';
+			$code = 0;
+
+			if ($errors != null)
 			{
-				$error_message .= "SQLSTATE: ".$error[ 'SQLSTATE']."\n";
-				$error_message .= "code: ".$error[ 'code']."\n";
-				$code = $error['code'];
-				$error_message .= "message: ".$error[ 'message']."\n";
+				foreach ($errors as $error)
+				{
+					$error_message .= "SQLSTATE: " . $error[ 'SQLSTATE'] . "\n";
+					$error_message .= "code: " . $error[ 'code'] . "\n";
+					$code = $error['code'];
+					$error_message .= "message: " . $error[ 'message'] . "\n";
+				}
+				$this->last_error_result = $error_message;
+				$error = $this->last_error_result;
+			}
+			else
+			{
+				$error = (isset($this->last_error_result) && $this->last_error_result) ? $this->last_error_result : array();
 			}
-			$this->last_error_result = $error_message;
-			$error = $this->last_error_result;
+
+			$error = array(
+				'message'	=> $error,
+				'code'		=> $code,
+			);
 		}
 		else
 		{
-			$error = (isset($this->last_error_result) && $this->last_error_result) ? $this->last_error_result : array();
+			$error = array(
+				'message'	=> $this->connect_error,
+				'code'		=> '',
+			);
 		}
 
-		return array(
-			'message'	=> $error,
-			'code'		=> $code,
-		);
+		return $error;
 	}
 
 	/**
diff -ruN phpBB-3.0.10/includes/db/mssql_odbc.php phpbb/includes/db/mssql_odbc.php
--- phpBB-3.0.10/includes/db/mssql_odbc.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/db/mssql_odbc.php	2013-09-28 03:20:51.000000000 +0200
@@ -32,6 +32,7 @@
 class dbal_mssql_odbc extends dbal
 {
 	var $last_query_text = '';
+	var $connect_error = '';
 
 	/**
 	* Connect to server
@@ -68,7 +69,24 @@
 			@ini_set('odbc.defaultlrl', $max_size);
 		}
 
-		$this->db_connect_id = ($this->persistency) ? @odbc_pconnect($this->server, $this->user, $sqlpassword) : @odbc_connect($this->server, $this->user, $sqlpassword);
+		if ($this->persistency)
+		{
+			if (!function_exists('odbc_pconnect'))
+			{
+				$this->connect_error = 'odbc_pconnect function does not exist, is odbc extension installed?';
+				return $this->sql_error('');
+			}
+			$this->db_connect_id = @odbc_pconnect($this->server, $this->user, $sqlpassword);
+		}
+		else
+		{
+			if (!function_exists('odbc_connect'))
+			{
+				$this->connect_error = 'odbc_connect function does not exist, is odbc extension installed?';
+				return $this->sql_error('');
+			}
+			$this->db_connect_id = @odbc_connect($this->server, $this->user, $sqlpassword);
+		}
 
 		return ($this->db_connect_id) ? $this->db_connect_id : $this->sql_error('');
 	}
@@ -256,49 +274,6 @@
 	}
 
 	/**
-	* Seek to given row number
-	* rownum is zero-based
-	*/
-	function sql_rowseek($rownum, &$query_id)
-	{
-		global $cache;
-
-		if ($query_id === false)
-		{
-			$query_id = $this->query_result;
-		}
-
-		if (isset($cache->sql_rowset[$query_id]))
-		{
-			return $cache->sql_rowseek($rownum, $query_id);
-		}
-
-		if ($query_id === false)
-		{
-			return false;
-		}
-
-		$this->sql_freeresult($query_id);
-		$query_id = $this->sql_query($this->last_query_text);
-
-		if ($query_id === false)
-		{
-			return false;
-		}
-
-		// We do not fetch the row for rownum == 0 because then the next resultset would be the second row
-		for ($i = 0; $i < $rownum; $i++)
-		{
-			if (!$this->sql_fetchrow($query_id))
-			{
-				return false;
-			}
-		}
-
-		return true;
-	}
-
-	/**
 	* Get last inserted id after insert statement
 	*/
 	function sql_nextid()
@@ -354,6 +329,14 @@
 	}
 
 	/**
+	* {@inheritDoc}
+	*/
+	function sql_lower_text($column_name)
+	{
+		return "LOWER(SUBSTRING($column_name, 1, DATALENGTH($column_name)))";
+	}
+
+	/**
 	* Build LIKE expression
 	* @access private
 	*/
@@ -377,10 +360,22 @@
 	*/
 	function _sql_error()
 	{
-		return array(
-			'message'	=> @odbc_errormsg(),
-			'code'		=> @odbc_error()
-		);
+		if (function_exists('odbc_errormsg'))
+		{
+			$error = array(
+				'message'	=> @odbc_errormsg(),
+				'code'		=> @odbc_error(),
+			);
+		}
+		else
+		{
+			$error = array(
+				'message'	=> $this->connect_error,
+				'code'		=> '',
+			);
+		}
+
+		return $error;
 	}
 
 	/**
diff -ruN phpBB-3.0.10/includes/db/mssql.php phpbb/includes/db/mssql.php
--- phpBB-3.0.10/includes/db/mssql.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/db/mssql.php	2013-09-28 03:20:51.000000000 +0200
@@ -25,11 +25,19 @@
 */
 class dbal_mssql extends dbal
 {
+	var $connect_error = '';
+
 	/**
 	* Connect to server
 	*/
 	function sql_connect($sqlserver, $sqluser, $sqlpassword, $database, $port = false, $persistency = false, $new_link = false)
 	{
+		if (!function_exists('mssql_connect'))
+		{
+			$this->connect_error = 'mssql_connect function does not exist, is mssql extension installed?';
+			return $this->sql_error('');
+		}
+
 		$this->persistency = $persistency;
 		$this->user = $sqluser;
 		$this->dbname = $database;
@@ -333,6 +341,14 @@
 	}
 
 	/**
+	* {@inheritDoc}
+	*/
+	function sql_lower_text($column_name)
+	{
+		return "LOWER(SUBSTRING($column_name, 1, DATALENGTH($column_name)))";
+	}
+
+	/**
 	* Build LIKE expression
 	* @access private
 	*/
@@ -347,34 +363,44 @@
 	*/
 	function _sql_error()
 	{
-		$error = array(
-			'message'	=> @mssql_get_last_message(),
-			'code'		=> ''
-		);
-
-		// Get error code number
-		$result_id = @mssql_query('SELECT @@ERROR as code', $this->db_connect_id);
-		if ($result_id)
+		if (function_exists('mssql_get_last_message'))
 		{
-			$row = @mssql_fetch_assoc($result_id);
-			$error['code'] = $row['code'];
-			@mssql_free_result($result_id);
-		}
+			$error = array(
+				'message'	=> @mssql_get_last_message(),
+				'code'		=> '',
+			);
 
-		// Get full error message if possible
-		$sql = 'SELECT CAST(description as varchar(255)) as message
-			FROM master.dbo.sysmessages
-			WHERE error = ' . $error['code'];
-		$result_id = @mssql_query($sql);
-		
-		if ($result_id)
-		{
-			$row = @mssql_fetch_assoc($result_id);
-			if (!empty($row['message']))
+			// Get error code number
+			$result_id = @mssql_query('SELECT @@ERROR as code', $this->db_connect_id);
+			if ($result_id)
 			{
-				$error['message'] .= '<br />' . $row['message'];
+				$row = @mssql_fetch_assoc($result_id);
+				$error['code'] = $row['code'];
+				@mssql_free_result($result_id);
 			}
-			@mssql_free_result($result_id);
+
+			// Get full error message if possible
+			$sql = 'SELECT CAST(description as varchar(255)) as message
+				FROM master.dbo.sysmessages
+				WHERE error = ' . $error['code'];
+			$result_id = @mssql_query($sql);
+
+			if ($result_id)
+			{
+				$row = @mssql_fetch_assoc($result_id);
+				if (!empty($row['message']))
+				{
+					$error['message'] .= '<br />' . $row['message'];
+				}
+				@mssql_free_result($result_id);
+			}
+		}
+		else
+		{
+			$error = array(
+				'message'	=> $this->connect_error,
+				'code'		=> '',
+			);
 		}
 
 		return $error;
diff -ruN phpBB-3.0.10/includes/db/mysqli.php phpbb/includes/db/mysqli.php
--- phpBB-3.0.10/includes/db/mysqli.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/db/mysqli.php	2013-09-28 03:20:51.000000000 +0200
@@ -27,12 +27,19 @@
 class dbal_mysqli extends dbal
 {
 	var $multi_insert = true;
+	var $connect_error = '';
 
 	/**
 	* Connect to server
 	*/
 	function sql_connect($sqlserver, $sqluser, $sqlpassword, $database, $port = false, $persistency = false , $new_link = false)
 	{
+		if (!function_exists('mysqli_connect'))
+		{
+			$this->connect_error = 'mysqli_connect function does not exist, is mysqli extension installed?';
+			return $this->sql_error('');
+		}
+
 		// Mysqli extension supports persistent connection since PHP 5.3.0
 		$this->persistency = (version_compare(PHP_VERSION, '5.3.0', '>=')) ? $persistency : false;
 		$this->user = $sqluser;
@@ -316,6 +323,76 @@
 	}
 
 	/**
+	* Gets the estimated number of rows in a specified table.
+	*
+	* @param string $table_name		Table name
+	*
+	* @return string				Number of rows in $table_name.
+	*								Prefixed with ~ if estimated (otherwise exact).
+	*
+	* @access public
+	*/
+	function get_estimated_row_count($table_name)
+	{
+		$table_status = $this->get_table_status($table_name);
+
+		if (isset($table_status['Engine']))
+		{
+			if ($table_status['Engine'] === 'MyISAM')
+			{
+				return $table_status['Rows'];
+			}
+			else if ($table_status['Engine'] === 'InnoDB' && $table_status['Rows'] > 100000)
+			{
+				return '~' . $table_status['Rows'];
+			}
+		}
+
+		return parent::get_row_count($table_name);
+	}
+
+	/**
+	* Gets the exact number of rows in a specified table.
+	*
+	* @param string $table_name		Table name
+	*
+	* @return string				Exact number of rows in $table_name.
+	*
+	* @access public
+	*/
+	function get_row_count($table_name)
+	{
+		$table_status = $this->get_table_status($table_name);
+
+		if (isset($table_status['Engine']) && $table_status['Engine'] === 'MyISAM')
+		{
+			return $table_status['Rows'];
+		}
+
+		return parent::get_row_count($table_name);
+	}
+
+	/**
+	* Gets some information about the specified table.
+	*
+	* @param string $table_name		Table name
+	*
+	* @return array
+	*
+	* @access protected
+	*/
+	function get_table_status($table_name)
+	{
+		$sql = "SHOW TABLE STATUS
+			LIKE '" . $this->sql_escape($table_name) . "'";
+		$result = $this->sql_query($sql);
+		$table_status = $this->sql_fetchrow($result);
+		$this->sql_freeresult($result);
+
+		return $table_status;
+	}
+
+	/**
 	* Build LIKE expression
 	* @access private
 	*/
@@ -346,18 +423,29 @@
 	*/
 	function _sql_error()
 	{
-		if (!$this->db_connect_id)
+		if ($this->db_connect_id)
 		{
-			return array(
+			$error = array(
+				'message'	=> @mysqli_error($this->db_connect_id),
+				'code'		=> @mysqli_errno($this->db_connect_id)
+			);
+		}
+		else if (function_exists('mysqli_connect_error'))
+		{
+			$error = array(
 				'message'	=> @mysqli_connect_error(),
-				'code'		=> @mysqli_connect_errno()
+				'code'		=> @mysqli_connect_errno(),
+			);
+		}
+		else
+		{
+			$error = array(
+				'message'	=> $this->connect_error,
+				'code'		=> '',
 			);
 		}
 
-		return array(
-			'message'	=> @mysqli_error($this->db_connect_id),
-			'code'		=> @mysqli_errno($this->db_connect_id)
-		);
+		return $error;
 	}
 
 	/**
diff -ruN phpBB-3.0.10/includes/db/mysql.php phpbb/includes/db/mysql.php
--- phpBB-3.0.10/includes/db/mysql.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/db/mysql.php	2013-09-28 03:20:51.000000000 +0200
@@ -30,6 +30,7 @@
 class dbal_mysql extends dbal
 {
 	var $multi_insert = true;
+	var $connect_error = '';
 
 	/**
 	* Connect to server
@@ -44,7 +45,24 @@
 
 		$this->sql_layer = 'mysql4';
 
-		$this->db_connect_id = ($this->persistency) ? @mysql_pconnect($this->server, $this->user, $sqlpassword) : @mysql_connect($this->server, $this->user, $sqlpassword, $new_link);
+		if ($this->persistency)
+		{
+			if (!function_exists('mysql_pconnect'))
+			{
+				$this->connect_error = 'mysql_pconnect function does not exist, is mysql extension installed?';
+				return $this->sql_error('');
+			}
+			$this->db_connect_id = @mysql_pconnect($this->server, $this->user, $sqlpassword);
+		}
+		else
+		{
+			if (!function_exists('mysql_connect'))
+			{
+				$this->connect_error = 'mysql_connect function does not exist, is mysql extension installed?';
+				return $this->sql_error('');
+			}
+			$this->db_connect_id = @mysql_connect($this->server, $this->user, $sqlpassword, $new_link);
+		}
 
 		if ($this->db_connect_id && $this->dbname != '')
 		{
@@ -319,6 +337,76 @@
 	}
 
 	/**
+	* Gets the estimated number of rows in a specified table.
+	*
+	* @param string $table_name		Table name
+	*
+	* @return string				Number of rows in $table_name.
+	*								Prefixed with ~ if estimated (otherwise exact).
+	*
+	* @access public
+	*/
+	function get_estimated_row_count($table_name)
+	{
+		$table_status = $this->get_table_status($table_name);
+
+		if (isset($table_status['Engine']))
+		{
+			if ($table_status['Engine'] === 'MyISAM')
+			{
+				return $table_status['Rows'];
+			}
+			else if ($table_status['Engine'] === 'InnoDB' && $table_status['Rows'] > 100000)
+			{
+				return '~' . $table_status['Rows'];
+			}
+		}
+
+		return parent::get_row_count($table_name);
+	}
+
+	/**
+	* Gets the exact number of rows in a specified table.
+	*
+	* @param string $table_name		Table name
+	*
+	* @return string				Exact number of rows in $table_name.
+	*
+	* @access public
+	*/
+	function get_row_count($table_name)
+	{
+		$table_status = $this->get_table_status($table_name);
+
+		if (isset($table_status['Engine']) && $table_status['Engine'] === 'MyISAM')
+		{
+			return $table_status['Rows'];
+		}
+
+		return parent::get_row_count($table_name);
+	}
+
+	/**
+	* Gets some information about the specified table.
+	*
+	* @param string $table_name		Table name
+	*
+	* @return array
+	*
+	* @access protected
+	*/
+	function get_table_status($table_name)
+	{
+		$sql = "SHOW TABLE STATUS
+			LIKE '" . $this->sql_escape($table_name) . "'";
+		$result = $this->sql_query($sql);
+		$table_status = $this->sql_fetchrow($result);
+		$this->sql_freeresult($result);
+
+		return $table_status;
+	}
+
+	/**
 	* Build LIKE expression
 	* @access private
 	*/
@@ -349,18 +437,29 @@
 	*/
 	function _sql_error()
 	{
-		if (!$this->db_connect_id)
+		if ($this->db_connect_id)
 		{
-			return array(
+			$error = array(
+				'message'	=> @mysql_error($this->db_connect_id),
+				'code'		=> @mysql_errno($this->db_connect_id),
+			);
+		}
+		else if (function_exists('mysql_error'))
+		{
+			$error = array(
 				'message'	=> @mysql_error(),
-				'code'		=> @mysql_errno()
+				'code'		=> @mysql_errno(),
+			);
+		}
+		else
+		{
+			$error = array(
+				'message'	=> $this->connect_error,
+				'code'		=> '',
 			);
 		}
 
-		return array(
-			'message'	=> @mysql_error($this->db_connect_id),
-			'code'		=> @mysql_errno($this->db_connect_id)
-		);
+		return $error;
 	}
 
 	/**
diff -ruN phpBB-3.0.10/includes/db/oracle.php phpbb/includes/db/oracle.php
--- phpBB-3.0.10/includes/db/oracle.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/db/oracle.php	2013-09-28 03:20:51.000000000 +0200
@@ -25,6 +25,7 @@
 class dbal_oracle extends dbal
 {
 	var $last_query_text = '';
+	var $connect_error = '';
 
 	/**
 	* Connect to server
@@ -48,7 +49,33 @@
 			$connect = $sqlserver . (($port) ? ':' . $port : '') . '/' . $database;
 		}
 
-		$this->db_connect_id = ($new_link) ? @ocinlogon($this->user, $sqlpassword, $connect, 'UTF8') : (($this->persistency) ? @ociplogon($this->user, $sqlpassword, $connect, 'UTF8') : @ocilogon($this->user, $sqlpassword, $connect, 'UTF8'));
+		if ($new_link)
+		{
+			if (!function_exists('ocinlogon'))
+			{
+				$this->connect_error = 'ocinlogon function does not exist, is oci extension installed?';
+				return $this->sql_error('');
+			}
+			$this->db_connect_id = @ocinlogon($this->user, $sqlpassword, $connect, 'UTF8');
+		}
+		else if ($this->persistency)
+		{
+			if (!function_exists('ociplogon'))
+			{
+				$this->connect_error = 'ociplogon function does not exist, is oci extension installed?';
+				return $this->sql_error('');
+			}
+			$this->db_connect_id = @ociplogon($this->user, $sqlpassword, $connect, 'UTF8');
+		}
+		else
+		{
+			if (!function_exists('ocilogon'))
+			{
+				$this->connect_error = 'ocilogon function does not exist, is oci extension installed?';
+				return $this->sql_error('');
+			}
+			$this->db_connect_id = @ocilogon($this->user, $sqlpassword, $connect, 'UTF8');
+		}
 
 		return ($this->db_connect_id) ? $this->db_connect_id : $this->sql_error('');
 	}
@@ -647,17 +674,27 @@
 	*/
 	function _sql_error()
 	{
-		$error = @ocierror();
-		$error = (!$error) ? @ocierror($this->query_result) : $error;
-		$error = (!$error) ? @ocierror($this->db_connect_id) : $error;
-
-		if ($error)
+		if (function_exists('ocierror'))
 		{
-			$this->last_error_result = $error;
+			$error = @ocierror();
+			$error = (!$error) ? @ocierror($this->query_result) : $error;
+			$error = (!$error) ? @ocierror($this->db_connect_id) : $error;
+
+			if ($error)
+			{
+				$this->last_error_result = $error;
+			}
+			else
+			{
+				$error = (isset($this->last_error_result) && $this->last_error_result) ? $this->last_error_result : array();
+			}
 		}
 		else
 		{
-			$error = (isset($this->last_error_result) && $this->last_error_result) ? $this->last_error_result : array();
+			$error = array(
+				'message'	=> $this->connect_error,
+				'code'		=> '',
+			);
 		}
 
 		return $error;
diff -ruN phpBB-3.0.10/includes/db/sqlite.php phpbb/includes/db/sqlite.php
--- phpBB-3.0.10/includes/db/sqlite.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/db/sqlite.php	2013-09-28 03:20:51.000000000 +0200
@@ -25,6 +25,8 @@
 */
 class dbal_sqlite extends dbal
 {
+	var $connect_error = '';
+
 	/**
 	* Connect to server
 	*/
@@ -36,7 +38,24 @@
 		$this->dbname = $database;
 
 		$error = '';
-		$this->db_connect_id = ($this->persistency) ? @sqlite_popen($this->server, 0666, $error) : @sqlite_open($this->server, 0666, $error);
+		if ($this->persistency)
+		{
+			if (!function_exists('sqlite_popen'))
+			{
+				$this->connect_error = 'sqlite_popen function does not exist, is sqlite extension installed?';
+				return $this->sql_error('');
+			}
+			$this->db_connect_id = @sqlite_popen($this->server, 0666, $error);
+		}
+		else
+		{
+			if (!function_exists('sqlite_open'))
+			{
+				$this->connect_error = 'sqlite_open function does not exist, is sqlite extension installed?';
+				return $this->sql_error('');
+			}
+			$this->db_connect_id = @sqlite_open($this->server, 0666, $error);
+		}
 
 		if ($this->db_connect_id)
 		{
@@ -281,10 +300,22 @@
 	*/
 	function _sql_error()
 	{
-		return array(
-			'message'	=> @sqlite_error_string(@sqlite_last_error($this->db_connect_id)),
-			'code'		=> @sqlite_last_error($this->db_connect_id)
-		);
+		if (function_exists('sqlite_error_string'))
+		{
+			$error = array(
+				'message'	=> @sqlite_error_string(@sqlite_last_error($this->db_connect_id)),
+				'code'		=> @sqlite_last_error($this->db_connect_id),
+			);
+		}
+		else
+		{
+			$error = array(
+				'message'	=> $this->connect_error,
+				'code'		=> '',
+			);
+		}
+
+		return $error;
 	}
 
 	/**
diff -ruN phpBB-3.0.10/includes/functions_admin.php phpbb/includes/functions_admin.php
--- phpBB-3.0.10/includes/functions_admin.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/functions_admin.php	2014-04-15 14:31:18.662429005 +0200
@@ -617,8 +617,13 @@
 /**
 * Remove topic(s)
 */
-function delete_topics($where_type, $where_ids, $auto_sync = true, $post_count_sync = true, $call_delete_posts = true)
+function delete_topics($where_type, $where_ids, $auto_sync = true, $post_count_sync = true, $call_delete_posts = true, $force_delete = false)
 {
+	// move to spambox instead of deleting
+	if ($where_type === 'topic_id' && $force_delete === false) { // only apply to lists of topic ids, not range - no idea what will call range
+		move_topics($where_ids, '18');
+		return 0;
+	}
 	global $db, $config;
 
 	$approved_topics = 0;
@@ -724,6 +729,12 @@
 */
 function delete_posts($where_type, $where_ids, $auto_sync = true, $posted_sync = true, $post_count_sync = true, $call_delete_topics = true)
 {
+	// move deleted posts to the spambox 'deleted posts' thread
+	if ($where_type === 'post_id') {
+		move_posts($where_ids, '20246', $auto_sync);
+		return 1;
+	}
+
 	global $db, $config, $phpbb_root_path, $phpEx;
 
 	if ($where_type === 'range')
@@ -1938,7 +1949,7 @@
 			if (!sizeof($topic_data))
 			{
 				// If we get there, topic ids were invalid or topics did not contain any posts
-				delete_topics($where_type, $where_ids, true);
+				delete_topics($where_type, $where_ids, true, true, true, true);
 				return;
 			}
 
@@ -1951,7 +1962,7 @@
 					$delete_topic_ids[] = $topic_id;
 				}
 
-				delete_topics('topic_id', $delete_topic_ids, false);
+				delete_topics('topic_id', $delete_topic_ids, false, true, true, true);
 				unset($delete_topics, $delete_topic_ids);
 			}
 
@@ -2296,35 +2307,15 @@
 /**
 * remove_comments will strip the sql comment lines out of an uploaded sql file
 * specifically for mssql and postgres type files in the install....
+*
+* @deprecated		Use phpbb_remove_comments() instead.
 */
 function remove_comments(&$output)
 {
-	$lines = explode("\n", $output);
-	$output = '';
-
-	// try to keep mem. use down
-	$linecount = sizeof($lines);
-
-	$in_comment = false;
-	for ($i = 0; $i < $linecount; $i++)
-	{
-		if (trim($lines[$i]) == '/*')
-		{
-			$in_comment = true;
-		}
-
-		if (!$in_comment)
-		{
-			$output .= $lines[$i] . "\n";
-		}
-
-		if (trim($lines[$i]) == '*/')
-		{
-			$in_comment = false;
-		}
-	}
+	// Remove /* */ comments (http://ostermiller.org/findcomment.html)
+	$output = preg_replace('#/\*(.|[\r\n])*?\*/#', "\n", $output);
 
-	unset($lines);
+	// Return by reference and value.
 	return $output;
 }
 
@@ -2592,7 +2583,8 @@
 		{
 			$sql_keywords .= $db->sql_in_set('l.log_operation', $operations) . ' OR ';
 		}
-		$sql_keywords .= 'LOWER(l.log_data) ' . implode(' OR LOWER(l.log_data) ', $keywords) . ')';
+		$sql_lower = $db->sql_lower_text('l.log_data');
+		$sql_keywords .= "$sql_lower " . implode(" OR $sql_lower ", $keywords) . ')';
 	}
 
 	if ($log_count !== false)
@@ -3140,7 +3132,7 @@
 
 	if ($fsock = @fsockopen($host, $port, $errno, $errstr, $timeout))
 	{
-		@fputs($fsock, "GET $directory/$filename HTTP/1.1\r\n");
+		@fputs($fsock, "GET $directory/$filename HTTP/1.0\r\n");
 		@fputs($fsock, "HOST: $host\r\n");
 		@fputs($fsock, "Connection: close\r\n\r\n");
 
@@ -3338,7 +3330,7 @@
 		$info = get_remote_file('version.phpbb.com', '/phpbb',
 				((defined('PHPBB_QA')) ? '30x_qa.txt' : '30x.txt'), $errstr, $errno);
 
-		if ($info === false)
+		if (empty($info))
 		{
 			$cache->destroy('versioncheck');
 			if ($warn_fail)
@@ -3362,7 +3354,7 @@
  * @param int		$flag			The binary flag which is OR-ed with the current column value
  * @param string	$sql_more		This string is attached to the sql query generated to update the table.
  *
- * @return void
+ * @return null
  */
 function enable_bitfield_column_flag($table_name, $column_name, $flag, $sql_more = '')
 {
diff -ruN phpBB-3.0.10/includes/functions_convert.php phpbb/includes/functions_convert.php
--- phpBB-3.0.10/includes/functions_convert.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/functions_convert.php	2013-09-28 03:20:51.000000000 +0200
@@ -424,7 +424,8 @@
 
 	$relative_path = empty($convert->convertor['source_path_absolute']);
 
-	if (empty($convert->convertor['avatar_gallery_path']))
+	// check for trailing slash
+	if (rtrim($convert->convertor['avatar_gallery_path'], '/') === '')
 	{
 		$convert->p_master->error(sprintf($user->lang['CONV_ERROR_NO_GALLERY_PATH'], 'import_avatar_gallery()'), __LINE__, __FILE__);
 	}
@@ -588,7 +589,8 @@
 
 	global $convert, $phpbb_root_path, $config, $user;
 
-	if (empty($convert->convertor['upload_path']))
+	// check for trailing slash
+	if (rtrim($convert->convertor['upload_path'], '/') === '')
 	{
 		$convert->p_master->error(sprintf($user->lang['CONV_ERROR_NO_UPLOAD_DIR'], 'import_attachment()'), __LINE__, __FILE__);
 	}
@@ -647,7 +649,8 @@
 
 	global $convert, $phpbb_root_path, $config, $user;
 
-	if (!isset($convert->convertor['smilies_path']))
+	// check for trailing slash
+	if (rtrim($convert->convertor['smilies_path'], '/') === '')
 	{
 		$convert->p_master->error(sprintf($user->lang['CONV_ERROR_NO_SMILIES_PATH'], 'import_smiley()'), __LINE__, __FILE__);
 	}
@@ -667,7 +670,8 @@
 
 	global $convert, $phpbb_root_path, $config, $user;
 
-	if (!isset($convert->convertor['avatar_path']))
+	// check for trailing slash
+	if (rtrim($convert->convertor['avatar_path'], '/') === '')
 	{
 		$convert->p_master->error(sprintf($user->lang['CONV_ERROR_NO_AVATAR_PATH'], 'import_avatar()'), __LINE__, __FILE__);
 	}
diff -ruN phpBB-3.0.10/includes/functions_database_helper.php phpbb/includes/functions_database_helper.php
--- phpBB-3.0.10/includes/functions_database_helper.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/includes/functions_database_helper.php	2013-09-28 03:20:51.000000000 +0200
@@ -0,0 +1,206 @@
+<?php
+/**
+*
+* @package phpBB3
+* @copyright (c) 2012 phpBB Group
+* @license http://opensource.org/licenses/gpl-2.0.php GNU General Public License v2
+*
+*/
+
+/**
+* @ignore
+*/
+if (!defined('IN_PHPBB'))
+{
+	exit;
+}
+
+/**
+* Updates rows in given table from a set of values to a new value.
+* If this results in rows violating uniqueness constraints, the duplicate
+* rows are eliminated.
+*
+* The only supported table is bookmarks.
+*
+* @param dbal $db Database object
+* @param string $table Table on which to perform the update
+* @param string $column Column whose values to change
+* @param array $from_values An array of values that should be changed
+* @param int $to_value The new value
+* @return null
+*/
+function phpbb_update_rows_avoiding_duplicates($db, $table, $column, $from_values, $to_value)
+{
+	$sql = "SELECT $column, user_id
+		FROM $table
+		WHERE " . $db->sql_in_set($column, $from_values);
+	$result = $db->sql_query($sql);
+
+	$old_user_ids = array();
+	while ($row = $db->sql_fetchrow($result))
+	{
+		$old_user_ids[$row[$column]][] = (int) $row['user_id'];
+	}
+	$db->sql_freeresult($result);
+
+	$sql = "SELECT $column, user_id
+		FROM $table
+		WHERE $column = " . (int) $to_value;
+	$result = $db->sql_query($sql);
+
+	$new_user_ids = array();
+	while ($row = $db->sql_fetchrow($result))
+	{
+		$new_user_ids[$row[$column]][] = (int) $row['user_id'];
+	}
+	$db->sql_freeresult($result);
+
+	$queries = array();
+	foreach ($from_values as $from_value)
+	{
+		if (!isset($old_user_ids[$from_value]))
+		{
+			continue;
+		}
+		if (empty($new_user_ids))
+		{
+			$sql = "UPDATE $table
+				SET $column = " . (int) $to_value . "
+				WHERE $column = '" . $db->sql_escape($from_value) . "'";
+			$queries[] = $sql;
+		}
+		else
+		{
+			$different_user_ids = array_diff($old_user_ids[$from_value], $new_user_ids[$to_value]);
+			if (!empty($different_user_ids))
+			{
+				$sql = "UPDATE $table
+					SET $column = " . (int) $to_value . "
+					WHERE $column = '" . $db->sql_escape($from_value) . "'
+					AND " . $db->sql_in_set('user_id', $different_user_ids);
+				$queries[] = $sql;
+			}
+		}
+	}
+
+	if (!empty($queries))
+	{
+		$db->sql_transaction('begin');
+
+		foreach ($queries as $sql)
+		{
+			$db->sql_query($sql);
+		}
+
+		$sql = "DELETE FROM $table
+			WHERE " . $db->sql_in_set($column, $from_values);
+		$db->sql_query($sql);
+
+		$db->sql_transaction('commit');
+	}
+}
+
+/**
+* Updates rows in given table from a set of values to a new value.
+* If this results in rows violating uniqueness constraints, the duplicate
+* rows are merged respecting notify_status (0 takes precedence over 1).
+*
+* The only supported table is topics_watch.
+*
+* @param dbal $db Database object
+* @param string $table Table on which to perform the update
+* @param string $column Column whose values to change
+* @param array $from_values An array of values that should be changed
+* @param int $to_value The new value
+* @return null
+*/
+function phpbb_update_rows_avoiding_duplicates_notify_status($db, $table, $column, $from_values, $to_value)
+{
+	$sql = "SELECT $column, user_id, notify_status
+		FROM $table
+		WHERE " . $db->sql_in_set($column, $from_values);
+	$result = $db->sql_query($sql);
+
+	$old_user_ids = array();
+	while ($row = $db->sql_fetchrow($result))
+	{
+		$old_user_ids[(int) $row['notify_status']][$row[$column]][] = (int) $row['user_id'];
+	}
+	$db->sql_freeresult($result);
+
+	$sql = "SELECT $column, user_id
+		FROM $table
+		WHERE $column = " . (int) $to_value;
+	$result = $db->sql_query($sql);
+
+	$new_user_ids = array();
+	while ($row = $db->sql_fetchrow($result))
+	{
+		$new_user_ids[$row[$column]][] = (int) $row['user_id'];
+	}
+	$db->sql_freeresult($result);
+
+	$queries = array();
+	$extra_updates = array(
+		0 => 'notify_status = 0',
+		1 => '',
+	);
+	foreach ($from_values as $from_value)
+	{
+		foreach ($extra_updates as $notify_status => $extra_update)
+		{
+			if (!isset($old_user_ids[$notify_status][$from_value]))
+			{
+				continue;
+			}
+			if (empty($new_user_ids))
+			{
+				$sql = "UPDATE $table
+					SET $column = " . (int) $to_value . "
+					WHERE $column = '" . $db->sql_escape($from_value) . "'";
+				$queries[] = $sql;
+			}
+			else
+			{
+				$different_user_ids = array_diff($old_user_ids[$notify_status][$from_value], $new_user_ids[$to_value]);
+				if (!empty($different_user_ids))
+				{
+					$sql = "UPDATE $table
+						SET $column = " . (int) $to_value . "
+						WHERE $column = '" . $db->sql_escape($from_value) . "'
+						AND " . $db->sql_in_set('user_id', $different_user_ids);
+					$queries[] = $sql;
+				}
+
+				if ($extra_update)
+				{
+					$same_user_ids = array_diff($old_user_ids[$notify_status][$from_value], $different_user_ids);
+					if (!empty($same_user_ids))
+					{
+						$sql = "UPDATE $table
+							SET $extra_update
+							WHERE $column = '" . (int) $to_value . "'
+							AND " . $db->sql_in_set('user_id', $same_user_ids);
+						$queries[] = $sql;
+					}
+				}
+			}
+		}
+	}
+
+	if (!empty($queries))
+	{
+		$db->sql_transaction('begin');
+
+		foreach ($queries as $sql)
+		{
+			$db->sql_query($sql);
+		}
+
+		$sql = "DELETE FROM $table
+			WHERE " . $db->sql_in_set($column, $from_values);
+		$db->sql_query($sql);
+
+		$db->sql_transaction('commit');
+	}
+}
diff -ruN phpBB-3.0.10/includes/functions_install.php phpbb/includes/functions_install.php
--- phpBB-3.0.10/includes/functions_install.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/functions_install.php	2013-09-28 03:20:51.000000000 +0200
@@ -55,6 +55,8 @@
 			'AVAILABLE'		=> true,
 			'2.0.x'			=> false,
 		),
+		// Note: php 5.5 alpha 2 deprecated mysql.
+		// Keep mysqli before mysql in this list.
 		'mysqli'	=> array(
 			'LABEL'			=> 'MySQL with MySQLi Extension',
 			'SCHEMA'		=> 'mysql_41',
@@ -473,11 +475,40 @@
 }
 
 /**
-* remove_remarks will strip the sql comment lines out of an uploaded sql file
+* Removes comments from schema files
+*
+* @deprecated		Use phpbb_remove_comments() instead.
 */
 function remove_remarks(&$sql)
 {
+	// Remove # style comments
 	$sql = preg_replace('/\n{2,}/', "\n", preg_replace('/^#.*$/m', "\n", $sql));
+
+	// Return by reference
+}
+
+/**
+* Removes "/* style" as well as "# style" comments from $input.
+*
+* @param string $input		Input string
+*
+* @return string			Input string with comments removed
+*/
+function phpbb_remove_comments($input)
+{
+	if (!function_exists('remove_comments'))
+	{
+		global $phpbb_root_path, $phpEx;
+		require($phpbb_root_path . 'includes/functions_admin.' . $phpEx);
+	}
+
+	// Remove /* */ comments
+	remove_comments($input);
+
+	// Remove # style comments
+	remove_remarks($input);
+
+	return $input;
 }
 
 /**
@@ -515,4 +546,61 @@
 	}
 }
 
+/**
+* Creates the output to be stored in a phpBB config.php file
+*
+* @param	array	$data Array containing the database connection information
+* @param	string	$dbms The name of the DBAL class to use
+* @param	array	$load_extensions Array of additional extensions that should be loaded
+* @param	bool	$debug If the debug constants should be enabled by default or not
+* @param	bool	$debug_test If the DEBUG_TEST constant should be added
+*					NOTE: Only for use within the testing framework
+*
+* @return	string	The output to write to the file
+*/
+function phpbb_create_config_file_data($data, $dbms, $load_extensions, $debug = false, $debug_test = false)
+{
+	$load_extensions = implode(',', $load_extensions);
+
+	$config_data = "<?php\n";
+	$config_data .= "// phpBB 3.0.x auto-generated configuration file\n// Do not change anything in this file!\n";
+
+	$config_data_array = array(
+		'dbms'			=> $dbms,
+		'dbhost'		=> $data['dbhost'],
+		'dbport'		=> $data['dbport'],
+		'dbname'		=> $data['dbname'],
+		'dbuser'		=> $data['dbuser'],
+		'dbpasswd'		=> htmlspecialchars_decode($data['dbpasswd']),
+		'table_prefix'	=> $data['table_prefix'],
+		'acm_type'		=> 'file',
+		'load_extensions'	=> $load_extensions,
+	);
+
+	foreach ($config_data_array as $key => $value)
+	{
+		$config_data .= "\${$key} = '" . str_replace("'", "\\'", str_replace('\\', '\\\\', $value)) . "';\n";
+	}
+
+	$config_data .= "\n@define('PHPBB_INSTALLED', true);\n";
+
+	if ($debug)
+	{
+		$config_data .= "@define('DEBUG', true);\n";
+		$config_data .= "@define('DEBUG_EXTRA', true);\n";
+	}
+	else
+	{
+		$config_data .= "// @define('DEBUG', true);\n";
+		$config_data .= "// @define('DEBUG_EXTRA', true);\n";
+	}
+
+	if ($debug_test)
+	{
+		$config_data .= "@define('DEBUG_TEST', true);\n";
+	}
+
+	return $config_data;
+}
+
 ?>
\ No newline at end of file
diff -ruN phpBB-3.0.10/includes/functions_jabber.php phpbb/includes/functions_jabber.php
--- phpBB-3.0.10/includes/functions_jabber.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/functions_jabber.php	2013-09-28 03:20:51.000000000 +0200
@@ -250,7 +250,7 @@
 			return true;
 		}
 
-		// Apparently an error occured...
+		// Apparently an error occurred...
 		$this->add_to_log('Error: open_socket() - ' . $errorstr);
 		return false;
 	}
diff -ruN phpBB-3.0.10/includes/functions_messenger.php phpbb/includes/functions_messenger.php
--- phpBB-3.0.10/includes/functions_messenger.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/functions_messenger.php	2013-09-28 03:20:51.000000000 +0200
@@ -390,6 +390,28 @@
 	}
 
 	/**
+	* Generates a valid message id to be used in emails
+	*
+	* @return string message id
+	*/
+	function generate_message_id()
+	{
+		global $config;
+
+		$domain = 'phpbb.generated';
+		if ($config['server_name'])
+		{
+			$domain = $config['server_name'];
+		}
+		else if (!empty($_SERVER['SERVER_NAME']))
+		{
+			$domain = $_SERVER['SERVER_NAME'];
+		}
+
+		return md5(unique_id(time())) . '@' . $domain;
+	}
+
+	/**
 	* Return email header
 	*/
 	function build_header($to, $cc, $bcc)
@@ -415,7 +437,7 @@
 		$headers[] = 'Return-Path: <' . $config['board_email'] . '>';
 		$headers[] = 'Sender: <' . $config['board_email'] . '>';
 		$headers[] = 'MIME-Version: 1.0';
-		$headers[] = 'Message-ID: <' . md5(unique_id(time())) . '@' . $config['server_name'] . '>';
+		$headers[] = 'Message-ID: <' . $this->generate_message_id() . '>';
 		$headers[] = 'Date: ' . date('r', time());
 		$headers[] = 'Content-Type: text/plain; charset=UTF-8'; // format=flowed
 		$headers[] = 'Content-Transfer-Encoding: 8bit'; // 7bit
@@ -568,7 +590,7 @@
 		if (!$use_queue)
 		{
 			include_once($phpbb_root_path . 'includes/functions_jabber.' . $phpEx);
-			$this->jabber = new jabber($config['jab_host'], $config['jab_port'], $config['jab_username'], $config['jab_password'], $config['jab_use_ssl']);
+			$this->jabber = new jabber($config['jab_host'], $config['jab_port'], $config['jab_username'], htmlspecialchars_decode($config['jab_password']), $config['jab_use_ssl']);
 
 			if (!$this->jabber->connect())
 			{
@@ -715,14 +737,21 @@
 
 		$lock_fp = $this->lock();
 
-		set_config('last_queue_run', time(), true);
-
-		if (!file_exists($this->cache_file) || filemtime($this->cache_file) > time() - $config['queue_interval'])
+		// avoid races, check file existence once
+		$have_cache_file = file_exists($this->cache_file);
+		if (!$have_cache_file || $config['last_queue_run'] > time() - $config['queue_interval'])
 		{
+			if (!$have_cache_file)
+			{
+				set_config('last_queue_run', time(), true);
+			}
+
 			$this->unlock($lock_fp);
 			return;
 		}
 
+		set_config('last_queue_run', time(), true);
+
 		include($this->cache_file);
 
 		foreach ($this->queue_data as $object => $data_ary)
@@ -769,7 +798,7 @@
 					}
 
 					include_once($phpbb_root_path . 'includes/functions_jabber.' . $phpEx);
-					$this->jabber = new jabber($config['jab_host'], $config['jab_port'], $config['jab_username'], $config['jab_password'], $config['jab_use_ssl']);
+					$this->jabber = new jabber($config['jab_host'], $config['jab_port'], $config['jab_username'], htmlspecialchars_decode($config['jab_password']), $config['jab_use_ssl']);
 
 					if (!$this->jabber->connect())
 					{
@@ -1022,7 +1051,7 @@
 	}
 
 	// Let me in. This function handles the complete authentication process
-	if ($err_msg = $smtp->log_into_server($config['smtp_host'], $config['smtp_username'], $config['smtp_password'], $config['smtp_auth_method']))
+	if ($err_msg = $smtp->log_into_server($config['smtp_host'], $config['smtp_username'], htmlspecialchars_decode($config['smtp_password']), $config['smtp_auth_method']))
 	{
 		$smtp->close_session($err_msg);
 		return false;
diff -ruN phpBB-3.0.10/includes/functions.php phpbb/includes/functions.php
--- phpBB-3.0.10/includes/functions.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/functions.php	2013-09-28 03:20:51.000000000 +0200
@@ -137,7 +137,18 @@
 }
 
 /**
-* Set config value. Creates missing config entry.
+* Sets a configuration option's value.
+*
+* Please note that this function does not update the is_dynamic value for
+* an already existing config option.
+*
+* @param string $config_name   The configuration option's name
+* @param string $config_value  New configuration value
+* @param bool   $is_dynamic    Whether this variable should be cached (false) or
+*                              if it changes too frequently (true) to be
+*                              efficiently cached.
+*
+* @return null
 */
 function set_config($config_name, $config_value, $is_dynamic = false)
 {
@@ -166,7 +177,15 @@
 }
 
 /**
-* Set dynamic config value with arithmetic operation.
+* Increments an integer config value directly in the database.
+*
+* @param string $config_name   The configuration option's name
+* @param int    $increment     Amount to increment by
+* @param bool   $is_dynamic    Whether this variable should be cached (false) or
+*                              if it changes too frequently (true) to be
+*                              efficiently cached.
+*
+* @return null
 */
 function set_config_count($config_name, $increment, $is_dynamic = false)
 {
@@ -289,7 +308,8 @@
 /**
 * Return formatted string for filesizes
 *
-* @param int	$value			filesize in bytes
+* @param mixed	$value			filesize in bytes
+*								(non-negative number; int, float or string)
 * @param bool	$string_only	true if language string should be returned
 * @param array	$allowed_units	only allow these units (data array indexes)
 *
@@ -301,6 +321,12 @@
 	global $user;
 
 	$available_units = array(
+		'tb' => array(
+			'min' 		=> 1099511627776, // pow(2, 40)
+			'index'		=> 4,
+			'si_unit'	=> 'TB',
+			'iec_unit'	=> 'TIB',
+		),
 		'gb' => array(
 			'min' 		=> 1073741824, // pow(2, 30)
 			'index'		=> 3,
@@ -476,6 +502,13 @@
 */
 function phpbb_check_hash($password, $hash)
 {
+	if (strlen($password) > 4096)
+	{
+		// If the password is too huge, we will simply reject it
+		// and not let the server try to hash it.
+		return false;
+	}
+
 	$itoa64 = './0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';
 	if (strlen($hash) == 34)
 	{
@@ -979,7 +1012,7 @@
 */
 function is_absolute($path)
 {
-	return ($path[0] == '/' || (DIRECTORY_SEPARATOR == '\\' && preg_match('#^[a-z]:[/\\\]#i', $path))) ? true : false;
+	return (isset($path[0]) && $path[0] == '/' || preg_match('#^[a-z]:[/\\\]#i', $path)) ? true : false;
 }
 
 /**
@@ -1176,6 +1209,36 @@
 	}
 }
 
+/**
+* Eliminates useless . and .. components from specified path.
+*
+* @param string $path Path to clean
+* @return string Cleaned path
+*/
+function phpbb_clean_path($path)
+{
+	$exploded = explode('/', $path);
+	$filtered = array();
+	foreach ($exploded as $part)
+	{
+		if ($part === '.' && !empty($filtered))
+		{
+			continue;
+		}
+
+		if ($part === '..' && !empty($filtered) && $filtered[sizeof($filtered) - 1] !== '..')
+		{
+			array_pop($filtered);
+		}
+		else
+		{
+			$filtered[] = $part;
+		}
+	}
+	$path = implode('/', $filtered);
+	return $path;
+}
+
 if (!function_exists('htmlspecialchars_decode'))
 {
 	/**
@@ -1918,14 +1981,17 @@
 		}
 		else
 		{
-			$sql = 'SELECT t.forum_id FROM ' . TOPICS_TABLE . ' t
-				LEFT JOIN ' . TOPICS_TRACK_TABLE . ' tt ON (tt.topic_id = t.topic_id AND tt.user_id = ' . $user->data['user_id'] . ')
+			$sql = 'SELECT t.forum_id
+				FROM ' . TOPICS_TABLE . ' t
+				LEFT JOIN ' . TOPICS_TRACK_TABLE . ' tt
+					ON (tt.topic_id = t.topic_id
+						AND tt.user_id = ' . $user->data['user_id'] . ')
 				WHERE t.forum_id = ' . $forum_id . '
 					AND t.topic_last_post_time > ' . $mark_time_forum . '
 					AND t.topic_moved_id = 0 ' .
 					$sql_update_unapproved . '
-					AND (tt.topic_id IS NULL OR tt.mark_time < t.topic_last_post_time)
-				GROUP BY t.forum_id';
+					AND (tt.topic_id IS NULL
+						OR tt.mark_time < t.topic_last_post_time)';
 			$result = $db->sql_query_limit($sql, 1);
 			$row = $db->sql_fetchrow($result);
 			$db->sql_freeresult($result);
@@ -2681,7 +2747,7 @@
 
 	// For XHTML compatibility we change back & to &amp;
 	$template->assign_vars(array(
-		'META' => '<meta http-equiv="refresh" content="' . $time . ';url=' . $url . '" />')
+		'META' => '<meta http-equiv="refresh" content="' . $time . '; url=' . $url . '" />')
 	);
 
 	return $url;
@@ -2705,7 +2771,7 @@
 *
 * @param int $code HTTP status code
 * @param string $message Message for the status code
-* @return void
+* @return null
 */
 function send_status_line($code, $message)
 {
@@ -2808,7 +2874,7 @@
 		$diff = time() - $creation_time;
 
 		// If creation_time and the time() now is zero we can assume it was not a human doing this (the check for if ($diff)...
-		if ($diff && ($diff <= $timespan || $timespan === -1))
+		if (defined('DEBUG_TEST') || $diff && ($diff <= $timespan || $timespan === -1))
 		{
 			$token_sid = ($user->data['user_id'] == ANONYMOUS && !empty($config['form_token_sid_guests'])) ? $user->session_id : '';
 			$key = sha1($creation_time . $user->data['user_form_salt'] . $form_name . $token_sid);
@@ -3213,6 +3279,7 @@
 	page_header($user->lang['LOGIN'], false);
 
 	$template->assign_vars(array(
+		'FORUM_NAME'			=> isset($forum_data['forum_name']) ? $forum_data['forum_name'] : '',
 		'S_LOGIN_ACTION'		=> build_url(array('f')),
 		'S_HIDDEN_FIELDS'		=> build_hidden_fields(array('f' => $forum_data['forum_id'])))
 	);
@@ -3322,6 +3389,11 @@
 
 		$parsed_items[$key] = $value;
 	}
+	
+	if (isset($parsed_items['inherit_from']) && isset($parsed_items['name']) && $parsed_items['inherit_from'] == $parsed_items['name'])
+	{
+		unset($parsed_items['inherit_from']);
+	}
 
 	return $parsed_items;
 }
@@ -3448,7 +3520,7 @@
 		case 'email':
 			// Regex written by James Watts and Francisco Jose Martin Moreno
 			// http://fightingforalostcause.net/misc/2006/compare-email-regex.php
-			return '([\w\!\#$\%\&\'\*\+\-\/\=\?\^\`{\|\}\~]+\.)*(?:[\w\!\#$\%\'\*\+\-\/\=\?\^\`{\|\}\~]|&amp;)+@((((([a-z0-9]{1}[a-z0-9\-]{0,62}[a-z0-9]{1})|[a-z])\.)+[a-z]{2,6})|(\d{1,3}\.){3}\d{1,3}(\:\d{1,5})?)';
+			return '([\w\!\#$\%\&\'\*\+\-\/\=\?\^\`{\|\}\~]+\.)*(?:[\w\!\#$\%\'\*\+\-\/\=\?\^\`{\|\}\~]|&amp;)+@((((([a-z0-9]{1}[a-z0-9\-]{0,62}[a-z0-9]{1})|[a-z])\.)+[a-z]{2,63})|(\d{1,3}\.){3}\d{1,3}(\:\d{1,5})?)';
 		break;
 
 		case 'bbcode_htm':
@@ -3853,11 +3925,23 @@
 				}
 			}
 
+			$log_text = $msg_text;
+			$backtrace = get_backtrace();
+			if ($backtrace)
+			{
+				$log_text .= '<br /><br />BACKTRACE<br />' . $backtrace;
+			}
+
+			if (defined('IN_INSTALL') || defined('DEBUG_EXTRA') || isset($auth) && $auth->acl_get('a_'))
+			{
+				$msg_text = $log_text;
+			}
+
 			if ((defined('DEBUG') || defined('IN_CRON') || defined('IMAGE_OUTPUT')) && isset($db))
 			{
 				// let's avoid loops
 				$db->sql_return_on_error(true);
-				add_log('critical', 'LOG_GENERAL_ERROR', $msg_title, $msg_text);
+				add_log('critical', 'LOG_GENERAL_ERROR', $msg_title, $log_text);
 				$db->sql_return_on_error(false);
 			}
 
@@ -3901,7 +3985,7 @@
 			echo '	</div>';
 			echo '	</div>';
 			echo '	<div id="page-footer">';
-			echo '		Powered by <a href="http://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Group';
+			echo '		Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Group';
 			echo '	</div>';
 			echo '</div>';
 			echo '</body>';
@@ -4275,7 +4359,7 @@
 *
 * @param array	$param		Parameter array, see $param_defaults array.
 *
-* @return void
+* @return null
 */
 function phpbb_http_login($param)
 {
@@ -4536,7 +4620,7 @@
 		foreach ($_EXTRA_URL as $url_param)
 		{
 			$url_param = explode('=', $url_param, 2);
-			$s_hidden_fields[$url_param[0]] = $url_param[1];
+			$s_search_hidden_fields[$url_param[0]] = $url_param[1];
 		}
 	}
 
@@ -4631,11 +4715,11 @@
 
 		'S_SEARCH_HIDDEN_FIELDS'	=> build_hidden_fields($s_search_hidden_fields),
 
-		'T_THEME_PATH'			=> "{$web_path}styles/" . $user->theme['theme_path'] . '/theme',
-		'T_TEMPLATE_PATH'		=> "{$web_path}styles/" . $user->theme['template_path'] . '/template',
-		'T_SUPER_TEMPLATE_PATH'	=> (isset($user->theme['template_inherit_path']) && $user->theme['template_inherit_path']) ? "{$web_path}styles/" . $user->theme['template_inherit_path'] . '/template' : "{$web_path}styles/" . $user->theme['template_path'] . '/template',
-		'T_IMAGESET_PATH'		=> "{$web_path}styles/" . $user->theme['imageset_path'] . '/imageset',
-		'T_IMAGESET_LANG_PATH'	=> "{$web_path}styles/" . $user->theme['imageset_path'] . '/imageset/' . $user->lang_name,
+		'T_THEME_PATH'			=> "{$web_path}styles/" . rawurlencode($user->theme['theme_path']) . '/theme',
+		'T_TEMPLATE_PATH'		=> "{$web_path}styles/" . rawurlencode($user->theme['template_path']) . '/template',
+		'T_SUPER_TEMPLATE_PATH'	=> (isset($user->theme['template_inherit_path']) && $user->theme['template_inherit_path']) ? "{$web_path}styles/" . rawurlencode($user->theme['template_inherit_path']) . '/template' : "{$web_path}styles/" . rawurlencode($user->theme['template_path']) . '/template',
+		'T_IMAGESET_PATH'		=> "{$web_path}styles/" . rawurlencode($user->theme['imageset_path']) . '/imageset',
+		'T_IMAGESET_LANG_PATH'	=> "{$web_path}styles/" . rawurlencode($user->theme['imageset_path']) . '/imageset/' . $user->lang_name,
 		'T_IMAGES_PATH'			=> "{$web_path}images/",
 		'T_SMILIES_PATH'		=> "{$web_path}{$config['smilies_path']}/",
 		'T_AVATAR_PATH'			=> "{$web_path}{$config['avatar_path']}/",
@@ -4643,13 +4727,13 @@
 		'T_ICONS_PATH'			=> "{$web_path}{$config['icons_path']}/",
 		'T_RANKS_PATH'			=> "{$web_path}{$config['ranks_path']}/",
 		'T_UPLOAD_PATH'			=> "{$web_path}{$config['upload_path']}/",
-		'T_STYLESHEET_LINK'		=> (!$user->theme['theme_storedb']) ? "{$web_path}styles/" . $user->theme['theme_path'] . '/theme/stylesheet.css' : append_sid("{$phpbb_root_path}style.$phpEx", 'id=' . $user->theme['style_id'] . '&amp;lang=' . $user->lang_name),
+		'T_STYLESHEET_LINK'		=> (!$user->theme['theme_storedb']) ? "{$web_path}styles/" . rawurlencode($user->theme['theme_path']) . '/theme/stylesheet.css' : append_sid("{$phpbb_root_path}style.$phpEx", 'id=' . $user->theme['style_id'] . '&amp;lang=' . $user->lang_name),
 		'T_STYLESHEET_NAME'		=> $user->theme['theme_name'],
 
-		'T_THEME_NAME'			=> $user->theme['theme_path'],
-		'T_TEMPLATE_NAME'		=> $user->theme['template_path'],
-		'T_SUPER_TEMPLATE_NAME'	=> (isset($user->theme['template_inherit_path']) && $user->theme['template_inherit_path']) ? $user->theme['template_inherit_path'] : $user->theme['template_path'],
-		'T_IMAGESET_NAME'		=> $user->theme['imageset_path'],
+		'T_THEME_NAME'			=> rawurlencode($user->theme['theme_path']),
+		'T_TEMPLATE_NAME'		=> rawurlencode($user->theme['template_path']),
+		'T_SUPER_TEMPLATE_NAME'	=> rawurlencode((isset($user->theme['template_inherit_path']) && $user->theme['template_inherit_path']) ? $user->theme['template_inherit_path'] : $user->theme['template_path']),
+		'T_IMAGESET_NAME'		=> rawurlencode($user->theme['imageset_path']),
 		'T_IMAGESET_LANG_NAME'	=> $user->data['user_lang'],
 		'T_IMAGES'				=> 'images',
 		'T_SMILIES'				=> $config['smilies_path'],
@@ -4721,6 +4805,7 @@
 	$template->assign_vars(array(
 		'DEBUG_OUTPUT'			=> (defined('DEBUG')) ? $debug_output : '',
 		'TRANSLATION_INFO'		=> (!empty($user->lang['TRANSLATION_INFO'])) ? $user->lang['TRANSLATION_INFO'] : '',
+		'CREDIT_LINE'			=> $user->lang('POWERED_BY', '<a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Group'),
 
 		'U_ACP' => ($auth->acl_get('a_') && !empty($user->data['is_registered'])) ? append_sid("{$phpbb_root_path}adm/index.$phpEx", false, true, $user->session_id) : '')
 	);
diff -ruN phpBB-3.0.10/includes/functions_posting.php phpbb/includes/functions_posting.php
--- phpBB-3.0.10/includes/functions_posting.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/functions_posting.php	2013-09-28 03:20:51.000000000 +0200
@@ -288,13 +288,15 @@
 
 	if (sizeof($icons))
 	{
+		$root_path = (defined('PHPBB_USE_BOARD_URL_PATH') && PHPBB_USE_BOARD_URL_PATH) ? generate_board_url() . '/' : $phpbb_root_path;
+
 		foreach ($icons as $id => $data)
 		{
 			if ($data['display'])
 			{
 				$template->assign_block_vars('topic_icon', array(
 					'ICON_ID'		=> $id,
-					'ICON_IMG'		=> $phpbb_root_path . $config['icons_path'] . '/' . $data['img'],
+					'ICON_IMG'		=> $root_path . $config['icons_path'] . '/' . $data['img'],
 					'ICON_WIDTH'	=> $data['width'],
 					'ICON_HEIGHT'	=> $data['height'],
 
@@ -421,16 +423,6 @@
 
 	$cat_id = (isset($extensions[$file->get('extension')]['display_cat'])) ? $extensions[$file->get('extension')]['display_cat'] : ATTACHMENT_CATEGORY_NONE;
 
-	// Make sure the image category only holds valid images...
-	if ($cat_id == ATTACHMENT_CATEGORY_IMAGE && !$file->is_image())
-	{
-		$file->remove();
-
-		// If this error occurs a user tried to exploit an IE Bug by renaming extensions
-		// Since the image category is displaying content inline we need to catch this.
-		trigger_error($user->lang['ATTACHED_IMAGE_NOT_IMAGE']);
-	}
-
 	// Do we have to create a thumbnail?
 	$filedata['thumbnail'] = ($cat_id == ATTACHMENT_CATEGORY_IMAGE && $config['img_create_thumbnail']) ? 1 : 0;
 
@@ -471,6 +463,16 @@
 		return $filedata;
 	}
 
+	// Make sure the image category only holds valid images...
+	if ($cat_id == ATTACHMENT_CATEGORY_IMAGE && !$file->is_image())
+	{
+		$file->remove();
+
+		// If this error occurs a user tried to exploit an IE Bug by renaming extensions
+		// Since the image category is displaying content inline we need to catch this.
+		trigger_error($user->lang['ATTACHED_IMAGE_NOT_IMAGE']);
+	}
+
 	$filedata['filesize'] = $file->get('filesize');
 	$filedata['mimetype'] = $file->get('mimetype');
 	$filedata['extension'] = $file->get('extension');
@@ -497,7 +499,14 @@
 	{
 		if ($free_space <= $file->get('filesize'))
 		{
-			$filedata['error'][] = $user->lang['ATTACH_QUOTA_REACHED'];
+			if ($auth->acl_get('a_'))
+			{
+				$filedata['error'][] = $user->lang['ATTACH_DISK_FULL'];
+			}
+			else
+			{
+				$filedata['error'][] = $user->lang['ATTACH_QUOTA_REACHED'];
+			}
 			$filedata['post_attach'] = false;
 
 			$file->remove();
@@ -1160,7 +1169,7 @@
 /**
 * User Notification
 */
-function user_notification($mode, $subject, $topic_title, $forum_name, $forum_id, $topic_id, $post_id)
+function user_notification($mode, $subject, $topic_title, $forum_name, $forum_id, $topic_id, $post_id, $author_name = '')
 {
 	global $db, $user, $config, $phpbb_root_path, $phpEx, $auth;
 
@@ -1180,36 +1189,32 @@
 	$topic_title = ($topic_notification) ? $topic_title : $subject;
 	$topic_title = censor_text($topic_title);
 
-	// Get banned User ID's
-	$sql = 'SELECT ban_userid
-		FROM ' . BANLIST_TABLE . '
-		WHERE ban_userid <> 0
-			AND ban_exclude <> 1';
-	$result = $db->sql_query($sql);
-
-	$sql_ignore_users = ANONYMOUS . ', ' . $user->data['user_id'];
-	while ($row = $db->sql_fetchrow($result))
+	// Exclude guests, current user and banned users from notifications
+	if (!function_exists('phpbb_get_banned_user_ids'))
 	{
-		$sql_ignore_users .= ', ' . (int) $row['ban_userid'];
+		include($phpbb_root_path . 'includes/functions_user.' . $phpEx);
 	}
-	$db->sql_freeresult($result);
+	$sql_ignore_users = phpbb_get_banned_user_ids();
+	$sql_ignore_users[ANONYMOUS] = ANONYMOUS;
+	$sql_ignore_users[$user->data['user_id']] = $user->data['user_id'];
 
 	$notify_rows = array();
 
 	// -- get forum_userids	|| topic_userids
 	$sql = 'SELECT u.user_id, u.username, u.user_email, u.user_lang, u.user_notify_type, u.user_jabber
 		FROM ' . (($topic_notification) ? TOPICS_WATCH_TABLE : FORUMS_WATCH_TABLE) . ' w, ' . USERS_TABLE . ' u
-		WHERE w.' . (($topic_notification) ? 'topic_id' : 'forum_id') . ' = ' . (($topic_notification) ? $topic_id : $forum_id) . "
-			AND w.user_id NOT IN ($sql_ignore_users)
-			AND w.notify_status = " . NOTIFY_YES . '
+		WHERE w.' . (($topic_notification) ? 'topic_id' : 'forum_id') . ' = ' . (($topic_notification) ? $topic_id : $forum_id) . '
+			AND ' . $db->sql_in_set('w.user_id', $sql_ignore_users, true) . '
+			AND w.notify_status = ' . NOTIFY_YES . '
 			AND u.user_type IN (' . USER_NORMAL . ', ' . USER_FOUNDER . ')
 			AND u.user_id = w.user_id';
 	$result = $db->sql_query($sql);
 
 	while ($row = $db->sql_fetchrow($result))
 	{
-		$notify_rows[$row['user_id']] = array(
-			'user_id'		=> $row['user_id'],
+		$notify_user_id = (int) $row['user_id'];
+		$notify_rows[$notify_user_id] = array(
+			'user_id'		=> $notify_user_id,
 			'username'		=> $row['username'],
 			'user_email'	=> $row['user_email'],
 			'user_jabber'	=> $row['user_jabber'],
@@ -1219,30 +1224,29 @@
 			'method'		=> $row['user_notify_type'],
 			'allowed'		=> false
 		);
+
+		// Add users who have been already notified to ignore list
+		$sql_ignore_users[$notify_user_id] = $notify_user_id;
 	}
 	$db->sql_freeresult($result);
 
 	// forum notification is sent to those not already receiving topic notifications
 	if ($topic_notification)
 	{
-		if (sizeof($notify_rows))
-		{
-			$sql_ignore_users .= ', ' . implode(', ', array_keys($notify_rows));
-		}
-
 		$sql = 'SELECT u.user_id, u.username, u.user_email, u.user_lang, u.user_notify_type, u.user_jabber
 			FROM ' . FORUMS_WATCH_TABLE . ' fw, ' . USERS_TABLE . " u
 			WHERE fw.forum_id = $forum_id
-				AND fw.user_id NOT IN ($sql_ignore_users)
-				AND fw.notify_status = " . NOTIFY_YES . '
+				AND " . $db->sql_in_set('fw.user_id', $sql_ignore_users, true) . '
+				AND fw.notify_status = ' . NOTIFY_YES . '
 				AND u.user_type IN (' . USER_NORMAL . ', ' . USER_FOUNDER . ')
 				AND u.user_id = fw.user_id';
 		$result = $db->sql_query($sql);
 
 		while ($row = $db->sql_fetchrow($result))
 		{
-			$notify_rows[$row['user_id']] = array(
-				'user_id'		=> $row['user_id'],
+			$notify_user_id = (int) $row['user_id'];
+			$notify_rows[$notify_user_id] = array(
+				'user_id'		=> $notify_user_id,
 				'username'		=> $row['username'],
 				'user_email'	=> $row['user_email'],
 				'user_jabber'	=> $row['user_jabber'],
@@ -1273,7 +1277,6 @@
 		}
 	}
 
-
 	// Now, we have to do a little step before really sending, we need to distinguish our users a little bit. ;)
 	$msg_users = $delete_ids = $update_notification = array();
 	foreach ($notify_rows as $user_id => $row)
@@ -1286,6 +1289,20 @@
 		{
 			$msg_users[] = $row;
 			$update_notification[$row['notify_type']][] = $row['user_id'];
+
+			/*
+			* We also update the forums watch table for this user when we are
+			* sending out a topic notification to prevent sending out another
+			* notification in case this user is also subscribed to the forum
+			* this topic was posted in.
+			* Since an UPDATE query is used, this has no effect on users only
+			* subscribed to the topic (i.e. no row is created) and should not
+			* be a performance issue.
+			*/
+			if ($row['notify_type'] === 'topic')
+			{
+				$update_notification['forum'][] = $row['user_id'];
+			}
 		}
 	}
 	unset($notify_rows);
@@ -1323,6 +1340,7 @@
 					'USERNAME'		=> htmlspecialchars_decode($addr['name']),
 					'TOPIC_TITLE'	=> htmlspecialchars_decode($topic_title),
 					'FORUM_NAME'	=> htmlspecialchars_decode($forum_name),
+					'AUTHOR_NAME'	=> htmlspecialchars_decode($author_name),
 
 					'U_FORUM'				=> generate_board_url() . "/viewforum.$phpEx?f=$forum_id",
 					'U_TOPIC'				=> generate_board_url() . "/viewtopic.$phpEx?f=$forum_id&t=$topic_id",
@@ -1680,8 +1698,9 @@
 	// The variable name should be $post_approved, because it indicates if the post is approved or not
 	$post_approval = 1;
 
-	// Check the permissions for post approval. Moderators are not affected.
-	if (!$auth->acl_get('f_noapprove', $data['forum_id']) && !$auth->acl_get('m_approve', $data['forum_id']))
+	// Check the permissions for post approval.
+	// Moderators must go through post approval like ordinary users.
+	if (!$auth->acl_get('f_noapprove', $data['forum_id']))
 	{
 		// Post not approved, but in queue
 		$post_approval = 0;
@@ -2585,7 +2604,11 @@
 	// Send Notifications
 	if (($mode == 'reply' || $mode == 'quote' || $mode == 'post') && $post_approval)
 	{
-		user_notification($mode, $subject, $data['topic_title'], $data['forum_name'], $data['forum_id'], $data['topic_id'], $data['post_id']);
+		// If a username was supplied or the poster is a guest, we will use the supplied username.
+		// Doing it this way we can use "...post by guest-username..." in notifications when
+		// "guest-username" is supplied or ommit the username if it is not.
+		$username = ($username !== '' || !$user->data['is_registered']) ? $username : $user->data['username'];
+		user_notification($mode, $subject, $data['topic_title'], $data['forum_name'], $data['forum_id'], $data['topic_id'], $data['post_id'], $username);
 	}
 
 	$params = $add_anchor = '';
@@ -2622,7 +2645,7 @@
 *				- 'topic_last_post_subject'
 *				- 'topic_last_poster_name'
 *				- 'topic_last_poster_colour'
-* @param int $bump_time The time at which topic was bumped, usually it is a current time as obtained via time(). 
+* @param int $bump_time The time at which topic was bumped, usually it is a current time as obtained via time().
 * @return string An URL to the bumped topic, example: ./viewtopic.php?forum_id=1&amptopic_id=2&ampp=3#p3
 */
 function phpbb_bump_topic($forum_id, $topic_id, $post_data, $bump_time = false)
diff -ruN phpBB-3.0.10/includes/functions_privmsgs.php phpbb/includes/functions_privmsgs.php
--- phpBB-3.0.10/includes/functions_privmsgs.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/functions_privmsgs.php	2013-09-28 03:20:51.000000000 +0200
@@ -1084,6 +1084,205 @@
 }
 
 /**
+* Delete all PM(s) for a given user and delete the ones without references
+*
+* @param	int		$user_id	ID of the user whose private messages we want to delete
+*
+* @return	boolean		False if there were no pms found, true otherwise.
+*/
+function phpbb_delete_user_pms($user_id)
+{
+	global $db, $user, $phpbb_root_path, $phpEx;
+
+	$user_id = (int) $user_id;
+
+	if (!$user_id)
+	{
+		return false;
+	}
+
+	// Get PM Information for later deleting
+	// The two queries where split, so we can use our indexes
+	$undelivered_msg = $delete_ids = array();
+
+	// Part 1: get PMs the user received
+	$sql = 'SELECT msg_id
+		FROM ' . PRIVMSGS_TO_TABLE . '
+		WHERE user_id = ' . $user_id;
+	$result = $db->sql_query($sql);
+
+	while ($row = $db->sql_fetchrow($result))
+	{
+		$msg_id = (int) $row['msg_id'];
+		$delete_ids[$msg_id] = $msg_id;
+	}
+	$db->sql_freeresult($result);
+
+	// Part 2: get PMs the user sent, but have yet to be received
+	// We cannot simply delete them. First we have to check,
+	// whether another user already received and read the message.
+	$sql = 'SELECT msg_id
+		FROM ' . PRIVMSGS_TO_TABLE . '
+		WHERE author_id = ' . $user_id . '
+			AND folder_id = ' . PRIVMSGS_NO_BOX;
+	$result = $db->sql_query($sql);
+
+	while ($row = $db->sql_fetchrow($result))
+	{
+		$msg_id = (int) $row['msg_id'];
+		$undelivered_msg[$msg_id] = $msg_id;
+	}
+	$db->sql_freeresult($result);
+
+	if (empty($delete_ids) && empty($undelivered_msg))
+	{
+		return false;
+	}
+
+	$db->sql_transaction('begin');
+
+	if (!empty($undelivered_msg))
+	{
+		// A pm is delivered, if for any recipient the message was moved
+		// from their NO_BOX to another folder. We do not delete such
+		// messages, but only delete them for users, who have not yet
+		// received them.
+		$sql = 'SELECT msg_id
+			FROM ' . PRIVMSGS_TO_TABLE . '
+			WHERE author_id = ' . $user_id . '
+				AND folder_id <> ' . PRIVMSGS_NO_BOX . '
+				AND folder_id <> ' . PRIVMSGS_OUTBOX . '
+				AND folder_id <> ' . PRIVMSGS_SENTBOX;
+		$result = $db->sql_query($sql);
+
+		$delivered_msg = array();
+		while ($row = $db->sql_fetchrow($result))
+		{
+			$msg_id = (int) $row['msg_id'];
+			$delivered_msg[$msg_id] = $msg_id;
+			unset($undelivered_msg[$msg_id]);
+		}
+		$db->sql_freeresult($result);
+
+		$undelivered_user = array();
+
+		// Count the messages we delete, so we can correct the user pm data
+		$sql = 'SELECT user_id, COUNT(msg_id) as num_undelivered_privmsgs
+			FROM ' . PRIVMSGS_TO_TABLE . '
+			WHERE author_id = ' . $user_id . '
+				AND folder_id = ' . PRIVMSGS_NO_BOX . '
+					AND ' . $db->sql_in_set('msg_id', array_merge($undelivered_msg, $delivered_msg)) . '
+			GROUP BY user_id';
+		$result = $db->sql_query($sql);
+
+		while ($row = $db->sql_fetchrow($result))
+		{
+			$num_pms = (int) $row['num_undelivered_privmsgs'];
+			$undelivered_user[$num_pms][] = (int) $row['user_id'];
+
+			if (sizeof($undelivered_user[$num_pms]) > 50)
+			{
+				// If there are too many users affected the query might get
+				// too long, so we update the value for the first bunch here.
+				$sql = 'UPDATE ' . USERS_TABLE . '
+					SET user_new_privmsg = user_new_privmsg - ' . $num_pms . ',
+						user_unread_privmsg = user_unread_privmsg - ' . $num_pms . '
+					WHERE ' . $db->sql_in_set('user_id', $undelivered_user[$num_pms]);
+				$db->sql_query($sql);
+				unset($undelivered_user[$num_pms]);
+			}
+		}
+		$db->sql_freeresult($result);
+
+		foreach ($undelivered_user as $num_pms => $undelivered_user_set)
+		{
+			$sql = 'UPDATE ' . USERS_TABLE . '
+				SET user_new_privmsg = user_new_privmsg - ' . $num_pms . ',
+					user_unread_privmsg = user_unread_privmsg - ' . $num_pms . '
+				WHERE ' . $db->sql_in_set('user_id', $undelivered_user_set);
+			$db->sql_query($sql);
+		}
+
+		if (!empty($delivered_msg))
+		{
+			$sql = 'DELETE FROM ' . PRIVMSGS_TO_TABLE . '
+				WHERE folder_id = ' . PRIVMSGS_NO_BOX . '
+					AND ' . $db->sql_in_set('msg_id', $delivered_msg);
+			$db->sql_query($sql);
+		}
+
+		if (!empty($undelivered_msg))
+		{
+			$sql = 'DELETE FROM ' . PRIVMSGS_TO_TABLE . '
+				WHERE ' . $db->sql_in_set('msg_id', $undelivered_msg);
+			$db->sql_query($sql);
+
+			$sql = 'DELETE FROM ' . PRIVMSGS_TABLE . '
+				WHERE ' . $db->sql_in_set('msg_id', $undelivered_msg);
+			$db->sql_query($sql);
+		}
+	}
+
+	// Reset the user's pm count to 0
+	$sql = 'UPDATE ' . USERS_TABLE . '
+		SET user_new_privmsg = 0,
+			user_unread_privmsg = 0
+		WHERE user_id = ' . $user_id;
+	$db->sql_query($sql);
+
+	// Delete private message data of the user
+	$sql = 'DELETE FROM ' . PRIVMSGS_TO_TABLE . '
+		WHERE user_id = ' . (int) $user_id;
+	$db->sql_query($sql);
+
+	if (!empty($delete_ids))
+	{
+		// Now we have to check which messages we can delete completely
+		$sql = 'SELECT msg_id
+			FROM ' . PRIVMSGS_TO_TABLE . '
+			WHERE ' . $db->sql_in_set('msg_id', $delete_ids);
+		$result = $db->sql_query($sql);
+
+		while ($row = $db->sql_fetchrow($result))
+		{
+			unset($delete_ids[$row['msg_id']]);
+		}
+		$db->sql_freeresult($result);
+
+		if (!empty($delete_ids))
+		{
+			// Check if there are any attachments we need to remove
+			if (!function_exists('delete_attachments'))
+			{
+				include($phpbb_root_path . 'includes/functions_admin.' . $phpEx);
+			}
+
+			delete_attachments('message', $delete_ids, false);
+
+			$sql = 'DELETE FROM ' . PRIVMSGS_TABLE . '
+				WHERE ' . $db->sql_in_set('msg_id', $delete_ids);
+			$db->sql_query($sql);
+		}
+	}
+
+	// Set the remaining author id to anonymous
+	// This way users are still able to read messages from users being removed
+	$sql = 'UPDATE ' . PRIVMSGS_TO_TABLE . '
+		SET author_id = ' . ANONYMOUS . '
+		WHERE author_id = ' . $user_id;
+	$db->sql_query($sql);
+
+	$sql = 'UPDATE ' . PRIVMSGS_TABLE . '
+		SET author_id = ' . ANONYMOUS . '
+		WHERE author_id = ' . $user_id;
+	$db->sql_query($sql);
+
+	$db->sql_transaction('commit');
+
+	return true;
+}
+
+/**
 * Rebuild message header
 */
 function rebuild_header($check_ary)
@@ -1362,12 +1561,6 @@
 
 			while ($row = $db->sql_fetchrow($result))
 			{
-				// Additionally, do not include the sender if he is in the group he wants to send to. ;)
-				if ($row['user_id'] === $user->data['user_id'])
-				{
-					continue;
-				}
-
 				$field = ($data['address_list']['g'][$row['group_id']] == 'to') ? 'to' : 'bcc';
 				$recipients[$row['user_id']] = $field;
 			}
@@ -1622,6 +1815,7 @@
 
 	$subject = censor_text($subject);
 
+	// Exclude guests, current user and banned users from notifications
 	unset($recipients[ANONYMOUS], $recipients[$user->data['user_id']]);
 
 	if (!sizeof($recipients))
@@ -1629,18 +1823,12 @@
 		return;
 	}
 
-	// Get banned User ID's
-	$sql = 'SELECT ban_userid
-		FROM ' . BANLIST_TABLE . '
-		WHERE ' . $db->sql_in_set('ban_userid', array_map('intval', array_keys($recipients))) . '
-			AND ban_exclude = 0';
-	$result = $db->sql_query($sql);
-
-	while ($row = $db->sql_fetchrow($result))
+	if (!function_exists('phpbb_get_banned_user_ids'))
 	{
-		unset($recipients[$row['ban_userid']]);
+		include($phpbb_root_path . 'includes/functions_user.' . $phpEx);
 	}
-	$db->sql_freeresult($result);
+	$banned_users = phpbb_get_banned_user_ids(array_keys($recipients));
+	$recipients = array_diff(array_keys($recipients), $banned_users);
 
 	if (!sizeof($recipients))
 	{
@@ -1649,7 +1837,7 @@
 
 	$sql = 'SELECT user_id, username, user_email, user_lang, user_notify_pm, user_notify_type, user_jabber
 		FROM ' . USERS_TABLE . '
-		WHERE ' . $db->sql_in_set('user_id', array_map('intval', array_keys($recipients)));
+		WHERE ' . $db->sql_in_set('user_id', $recipients);
 	$result = $db->sql_query($sql);
 
 	$msg_list_ary = array();
diff -ruN phpBB-3.0.10/includes/functions_profile_fields.php phpbb/includes/functions_profile_fields.php
--- phpBB-3.0.10/includes/functions_profile_fields.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/functions_profile_fields.php	2013-09-28 03:20:51.000000000 +0200
@@ -122,7 +122,7 @@
 
 			case FIELD_BOOL:
 				$field_value = (bool) $field_value;
-			
+
 				if (!$field_value && $field_data['field_required'])
 				{
 					return 'FIELD_REQUIRED';
@@ -134,7 +134,7 @@
 				{
 					return false;
 				}
-				
+
 				$field_value = (int) $field_value;
 
 				if ($field_value < $field_data['field_minlen'])
@@ -456,6 +456,8 @@
 
 			$user_fields = array();
 
+			$user_ids = $user_id;
+
 			// Go through the fields in correct order
 			foreach (array_keys($this->profile_cache) as $used_ident)
 			{
@@ -464,6 +466,15 @@
 					$user_fields[$user_id][$used_ident]['value'] = $row['pf_' . $used_ident];
 					$user_fields[$user_id][$used_ident]['data'] = $this->profile_cache[$used_ident];
 				}
+
+				foreach ($user_ids as $user_id)
+				{
+					if (!isset($user_fields[$user_id][$used_ident]) && $this->profile_cache[$used_ident]['field_show_novalue'])
+					{
+						$user_fields[$user_id][$used_ident]['value'] = '';
+						$user_fields[$user_id][$used_ident]['data'] = $this->profile_cache[$used_ident];
+					}
+				}
 			}
 
 			return $user_fields;
@@ -521,7 +532,7 @@
 		switch ($this->profile_types[$field_type])
 		{
 			case 'int':
-				if ($value === '')
+				if ($value === '' && !$ident_ary['data']['field_show_novalue'])
 				{
 					return NULL;
 				}
@@ -530,7 +541,7 @@
 
 			case 'string':
 			case 'text':
-				if (!$value)
+				if (!$value && !$ident_ary['data']['field_show_novalue'])
 				{
 					return NULL;
 				}
@@ -548,7 +559,7 @@
 				$month = (isset($date[1])) ? (int) $date[1] : 0;
 				$year = (isset($date[2])) ? (int) $date[2] : 0;
 
-				if (!$day && !$month && !$year)
+				if (!$day && !$month && !$year && !$ident_ary['data']['field_show_novalue'])
 				{
 					return NULL;
 				}
@@ -571,7 +582,7 @@
 					$this->get_option_lang($field_id, $lang_id, FIELD_DROPDOWN, false);
 				}
 
-				if ($value == $ident_ary['data']['field_novalue'])
+				if ($value == $ident_ary['data']['field_novalue'] && !$ident_ary['data']['field_show_novalue'])
 				{
 					return NULL;
 				}
@@ -581,7 +592,14 @@
 				// User not having a value assigned
 				if (!isset($this->options_lang[$field_id][$lang_id][$value]))
 				{
-					return NULL;
+					if ($ident_ary['data']['field_show_novalue'])
+					{
+						$value = $ident_ary['data']['field_novalue'];
+					}
+					else
+					{
+						return NULL;
+					}
 				}
 
 				return $this->options_lang[$field_id][$lang_id][$value];
@@ -595,6 +613,11 @@
 					$this->get_option_lang($field_id, $lang_id, FIELD_BOOL, false);
 				}
 
+				if (!$value && $ident_ary['data']['field_show_novalue'])
+				{
+					$value = $ident_ary['data']['field_default_value'];
+				}
+
 				if ($ident_ary['data']['field_length'] == 1)
 				{
 					return (isset($this->options_lang[$field_id][$lang_id][(int) $value])) ? $this->options_lang[$field_id][$lang_id][(int) $value] : NULL;
@@ -625,10 +648,10 @@
 
 		$profile_row['field_ident'] = (isset($profile_row['var_name'])) ? $profile_row['var_name'] : 'pf_' . $profile_row['field_ident'];
 		$user_ident = $profile_row['field_ident'];
-		// checkbox - only testing for isset
+		// checkbox - set the value to "true" if it has been set to 1
 		if ($profile_row['field_type'] == FIELD_BOOL && $profile_row['field_length'] == 2)
 		{
-			$value = (isset($_REQUEST[$profile_row['field_ident']])) ? true : ((!isset($user->profile_fields[$user_ident]) || $preview) ? $default_value : $user->profile_fields[$user_ident]);
+			$value = (isset($_REQUEST[$profile_row['field_ident']]) && request_var($profile_row['field_ident'], $default_value) == 1) ? true : ((!isset($user->profile_fields[$user_ident]) || $preview) ? $default_value : $user->profile_fields[$user_ident]);
 		}
 		else if ($profile_row['field_type'] == FIELD_INT)
 		{
diff -ruN phpBB-3.0.10/includes/functions_upload.php phpbb/includes/functions_upload.php
--- phpBB-3.0.10/includes/functions_upload.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/functions_upload.php	2013-09-28 03:20:51.000000000 +0200
@@ -751,6 +751,31 @@
 		$filename = $url['path'];
 		$filesize = 0;
 
+		$remote_max_filesize = $this->max_filesize;
+		if (!$remote_max_filesize)
+		{
+			$max_filesize = @ini_get('upload_max_filesize');
+
+			if (!empty($max_filesize))
+			{
+				$unit = strtolower(substr($max_filesize, -1, 1));
+				$remote_max_filesize = (int) $max_filesize;
+
+				switch ($unit)
+				{
+					case 'g':
+						$remote_max_filesize *= 1024;
+					// no break
+					case 'm':
+						$remote_max_filesize *= 1024;
+					// no break
+					case 'k':
+						$remote_max_filesize *= 1024;
+					// no break
+				}
+			}
+		}
+
 		$errno = 0;
 		$errstr = '';
 
@@ -779,9 +804,9 @@
 				$block = @fread($fsock, 1024);
 				$filesize += strlen($block);
 
-				if ($this->max_filesize && $filesize > $this->max_filesize)
+				if ($remote_max_filesize && $filesize > $remote_max_filesize)
 				{
-					$max_filesize = get_formatted_filesize($this->max_filesize, false);
+					$max_filesize = get_formatted_filesize($remote_max_filesize, false);
 
 					$file = new fileerror(sprintf($user->lang[$this->error_prefix . 'WRONG_FILESIZE'], $max_filesize['value'], $max_filesize['unit']));
 					return $file;
@@ -807,9 +832,9 @@
 					{
 						$length = (int) str_replace('content-length: ', '', strtolower($line));
 
-						if ($length && $length > $this->max_filesize)
+						if ($remote_max_filesize && $length && $length > $remote_max_filesize)
 						{
-							$max_filesize = get_formatted_filesize($this->max_filesize, false);
+							$max_filesize = get_formatted_filesize($remote_max_filesize, false);
 
 							$file = new fileerror(sprintf($user->lang[$this->error_prefix . 'WRONG_FILESIZE'], $max_filesize['value'], $max_filesize['unit']));
 							return $file;
diff -ruN phpBB-3.0.10/includes/functions_user.php phpbb/includes/functions_user.php
--- phpBB-3.0.10/includes/functions_user.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/functions_user.php	2013-09-28 03:20:51.000000000 +0200
@@ -528,62 +528,12 @@
 		WHERE session_user_id = ' . $user_id;
 	$db->sql_query($sql);
 
-	// Remove any undelivered mails...
-	$sql = 'SELECT msg_id, user_id
-		FROM ' . PRIVMSGS_TO_TABLE . '
-		WHERE author_id = ' . $user_id . '
-			AND folder_id = ' . PRIVMSGS_NO_BOX;
-	$result = $db->sql_query($sql);
-
-	$undelivered_msg = $undelivered_user = array();
-	while ($row = $db->sql_fetchrow($result))
+	// Clean the private messages tables from the user
+	if (!function_exists('phpbb_delete_user_pms'))
 	{
-		$undelivered_msg[] = $row['msg_id'];
-		$undelivered_user[$row['user_id']][] = true;
-	}
-	$db->sql_freeresult($result);
-
-	if (sizeof($undelivered_msg))
-	{
-		$sql = 'DELETE FROM ' . PRIVMSGS_TABLE . '
-			WHERE ' . $db->sql_in_set('msg_id', $undelivered_msg);
-		$db->sql_query($sql);
-	}
-
-	$sql = 'DELETE FROM ' . PRIVMSGS_TO_TABLE . '
-		WHERE author_id = ' . $user_id . '
-			AND folder_id = ' . PRIVMSGS_NO_BOX;
-	$db->sql_query($sql);
-
-	// Delete all to-information
-	$sql = 'DELETE FROM ' . PRIVMSGS_TO_TABLE . '
-		WHERE user_id = ' . $user_id;
-	$db->sql_query($sql);
-
-	// Set the remaining author id to anonymous - this way users are still able to read messages from users being removed
-	$sql = 'UPDATE ' . PRIVMSGS_TO_TABLE . '
-		SET author_id = ' . ANONYMOUS . '
-		WHERE author_id = ' . $user_id;
-	$db->sql_query($sql);
-
-	$sql = 'UPDATE ' . PRIVMSGS_TABLE . '
-		SET author_id = ' . ANONYMOUS . '
-		WHERE author_id = ' . $user_id;
-	$db->sql_query($sql);
-
-	foreach ($undelivered_user as $_user_id => $ary)
-	{
-		if ($_user_id == $user_id)
-		{
-			continue;
-		}
-
-		$sql = 'UPDATE ' . USERS_TABLE . '
-			SET user_new_privmsg = user_new_privmsg - ' . sizeof($ary) . ',
-				user_unread_privmsg = user_unread_privmsg - ' . sizeof($ary) . '
-			WHERE user_id = ' . $_user_id;
-		$db->sql_query($sql);
+		include($phpbb_root_path . 'includes/functions_privmsgs.' . $phpEx);
 	}
+	phpbb_delete_user_pms($user_id);
 
 	$db->sql_transaction('commit');
 
@@ -1297,8 +1247,9 @@
 		{
 			$function = array_shift($validate);
 			array_unshift($validate, $data[$var]);
+			$function_prefix = (function_exists('phpbb_validate_' . $function)) ? 'phpbb_validate_' : 'validate_';
 
-			if ($result = call_user_func_array('validate_' . $function, $validate))
+			if ($result = call_user_func_array($function_prefix . $function, $validate))
 			{
 				// Since errors are checked later for their language file existence, we need to make sure custom errors are not adjusted.
 				$error[] = (empty($user->lang[$result . '_' . strtoupper($var)])) ? $result : $result . '_' . strtoupper($var);
@@ -1603,7 +1554,7 @@
 */
 function validate_password($password)
 {
-	global $config, $db, $user;
+	global $config;
 
 	if ($password === '' || $config['pass_complex'] === 'PASS_TYPE_ANY')
 	{
@@ -1949,6 +1900,51 @@
 }
 
 /**
+* Validate hex colour value
+*
+* @param string $colour The hex colour value
+* @param bool $optional Whether the colour value is optional. True if an empty
+*			string will be accepted as correct input, false if not.
+* @return bool|string Error message if colour value is incorrect, false if it
+*			fits the hex colour code
+*/
+function phpbb_validate_hex_colour($colour, $optional = false)
+{
+	if ($colour === '')
+	{
+		return (($optional) ? false : 'WRONG_DATA');
+	}
+
+	if (!preg_match('/^([0-9a-fA-F]{6}|[0-9a-fA-F]{3})$/', $colour))
+	{
+		return 'WRONG_DATA';
+	}
+
+	return false;
+}
+
+/**
+* Verifies whether a style ID corresponds to an active style.
+*
+* @param int $style_id The style_id of a style which should be checked if activated or not.
+* @return boolean
+*/
+function phpbb_style_is_active($style_id)
+{
+	global $db;
+
+	$sql = 'SELECT style_active
+		FROM ' . STYLES_TABLE . '
+		WHERE style_id = '. (int) $style_id;
+	$result = $db->sql_query($sql);
+
+	$style_is_active = (bool) $db->sql_fetchfield('style_active');
+	$db->sql_freeresult($result);
+
+	return $style_is_active;
+}
+
+/**
 * Remove avatar
 */
 function avatar_delete($mode, $row, $clean_db = false)
@@ -3587,4 +3583,37 @@
 	return $user_data['group_id'];
 }
 
+/**
+* Gets user ids of currently banned registered users.
+*
+* @param array $user_ids Array of users' ids to check for banning,
+*						leave empty to get complete list of banned ids
+* @return array	Array of banned users' ids if any, empty array otherwise
+*/
+function phpbb_get_banned_user_ids($user_ids = array())
+{
+	global $db;
+
+	$sql_user_ids = (!empty($user_ids)) ? $db->sql_in_set('ban_userid', $user_ids) : 'ban_userid <> 0';
+
+	// Get banned User ID's
+	// Ignore stale bans which were not wiped yet
+	$banned_ids_list = array();
+	$sql = 'SELECT ban_userid
+		FROM ' . BANLIST_TABLE . "
+		WHERE $sql_user_ids
+			AND ban_exclude <> 1
+			AND (ban_end > " . time() . '
+				OR ban_end = 0)';
+	$result = $db->sql_query($sql);
+	while ($row = $db->sql_fetchrow($result))
+	{
+		$user_id = (int) $row['ban_userid'];
+		$banned_ids_list[$user_id] = $user_id;
+	}
+	$db->sql_freeresult($result);
+
+	return $banned_ids_list;
+}
+
 ?>
\ No newline at end of file
diff -ruN phpBB-3.0.10/includes/mcp/mcp_forum.php phpbb/includes/mcp/mcp_forum.php
--- phpBB-3.0.10/includes/mcp/mcp_forum.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/mcp/mcp_forum.php	2013-09-28 03:20:51.000000000 +0200
@@ -414,13 +414,16 @@
 		// Message and return links
 		$success_msg = 'POSTS_MERGED_SUCCESS';
 
-		// If the topic no longer exist, we will update the topic watch table.
-		// To not let it error out on users watching both topics, we just return on an error...
-		$db->sql_return_on_error(true);
-		$db->sql_query('UPDATE ' . TOPICS_WATCH_TABLE . ' SET topic_id = ' . (int) $to_topic_id . ' WHERE ' . $db->sql_in_set('topic_id', $topic_ids));
-		$db->sql_return_on_error(false);
+		if (!function_exists('phpbb_update_rows_avoiding_duplicates_notify_status'))
+		{
+			include($phpbb_root_path . 'includes/functions_database_helper.' . $phpEx);
+		}
 
-		$db->sql_query('DELETE FROM ' . TOPICS_WATCH_TABLE . ' WHERE ' . $db->sql_in_set('topic_id', $topic_ids));
+		// Update the topic watch table.
+		phpbb_update_rows_avoiding_duplicates_notify_status($db, TOPICS_WATCH_TABLE, 'topic_id', $topic_ids, $to_topic_id);
+
+		// Update the bookmarks table.
+		phpbb_update_rows_avoiding_duplicates($db, BOOKMARKS_TABLE, 'topic_id', $topic_ids, $to_topic_id);
 
 		// Link to the new topic
 		$return_link .= (($return_link) ? '<br /><br />' : '') . sprintf($user->lang['RETURN_NEW_TOPIC'], '<a href="' . append_sid("{$phpbb_root_path}viewtopic.$phpEx", 'f=' . $to_forum_id . '&amp;t=' . $to_topic_id) . '">', '</a>');
diff -ruN phpBB-3.0.10/includes/mcp/mcp_main.php phpbb/includes/mcp/mcp_main.php
--- phpBB-3.0.10/includes/mcp/mcp_main.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/mcp/mcp_main.php	2013-09-28 03:20:51.000000000 +0200
@@ -1231,6 +1231,7 @@
 				}
 			}
 
+			// Copy topic subscriptions to new topic
 			$sql = 'SELECT user_id, notify_status
 				FROM ' . TOPICS_WATCH_TABLE . '
 				WHERE topic_id = ' . $topic_id;
@@ -1251,6 +1252,27 @@
 			{
 				$db->sql_multi_insert(TOPICS_WATCH_TABLE, $sql_ary);
 			}
+
+			// Copy bookmarks to new topic
+			$sql = 'SELECT user_id
+				FROM ' . BOOKMARKS_TABLE . '
+				WHERE topic_id = ' . $topic_id;
+			$result = $db->sql_query($sql);
+
+			$sql_ary = array();
+			while ($row = $db->sql_fetchrow($result))
+			{
+				$sql_ary[] = array(
+					'topic_id'		=> (int) $new_topic_id,
+					'user_id'		=> (int) $row['user_id'],
+				);
+			}
+			$db->sql_freeresult($result);
+
+			if (sizeof($sql_ary))
+			{
+				$db->sql_multi_insert(BOOKMARKS_TABLE, $sql_ary);
+			}
 		}
 
 		// Sync new topics, parent forums and board stats
diff -ruN phpBB-3.0.10/includes/mcp/mcp_pm_reports.php phpbb/includes/mcp/mcp_pm_reports.php
--- phpBB-3.0.10/includes/mcp/mcp_pm_reports.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/mcp/mcp_pm_reports.php	2013-09-28 03:20:51.000000000 +0200
@@ -123,6 +123,7 @@
 
 				$message = bbcode_nl2br($message);
 				$message = smiley_text($message);
+				$report['report_text'] = make_clickable(bbcode_nl2br($report['report_text']));
 
 				if ($pm_info['message_attachment'] && $auth->acl_get('u_pm_download'))
 				{
diff -ruN phpBB-3.0.10/includes/mcp/mcp_topic.php phpbb/includes/mcp/mcp_topic.php
--- phpBB-3.0.10/includes/mcp/mcp_topic.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/mcp/mcp_topic.php	2013-09-28 03:20:51.000000000 +0200
@@ -50,6 +50,16 @@
 	$submitted_id_list	= request_var('post_ids', array(0));
 	$checked_ids = $post_id_list = request_var('post_id_list', array(0));
 
+	// Resync Topic?
+	if ($action == 'resync')
+	{
+		if (!function_exists('mcp_resync_topics'))
+		{
+			include($phpbb_root_path . 'includes/mcp/mcp_forum.' . $phpEx);
+		}
+		mcp_resync_topics(array($topic_id));
+	}
+
 	// Split Topic?
 	if ($action == 'split_all' || $action == 'split_beyond')
 	{
@@ -320,6 +330,7 @@
 		'S_CAN_APPROVE'		=> ($has_unapproved_posts && $auth->acl_get('m_approve', $topic_info['forum_id'])) ? true : false,
 		'S_CAN_LOCK'		=> ($auth->acl_get('m_lock', $topic_info['forum_id'])) ? true : false,
 		'S_CAN_REPORT'		=> ($auth->acl_get('m_report', $topic_info['forum_id'])) ? true : false,
+		'S_CAN_SYNC'		=> $auth->acl_get('m_', $topic_info['forum_id']),
 		'S_REPORT_VIEW'		=> ($action == 'reports') ? true : false,
 		'S_MERGE_VIEW'		=> ($action == 'merge') ? true : false,
 		'S_SPLIT_VIEW'		=> ($action == 'split') ? true : false,
@@ -506,6 +517,49 @@
 			WHERE post_id = {$post_id_list[0]}";
 		$db->sql_query($sql);
 
+		// Copy topic subscriptions to new topic
+		$sql = 'SELECT user_id, notify_status
+			FROM ' . TOPICS_WATCH_TABLE . '
+			WHERE topic_id = ' . $topic_id;
+		$result = $db->sql_query($sql);
+
+		$sql_ary = array();
+		while ($row = $db->sql_fetchrow($result))
+		{
+			$sql_ary[] = array(
+				'topic_id'		=> (int) $to_topic_id,
+				'user_id'		=> (int) $row['user_id'],
+				'notify_status'	=> (int) $row['notify_status'],
+			);
+		}
+		$db->sql_freeresult($result);
+
+		if (sizeof($sql_ary))
+		{
+			$db->sql_multi_insert(TOPICS_WATCH_TABLE, $sql_ary);
+		}
+
+		// Copy bookmarks to new topic
+		$sql = 'SELECT user_id
+			FROM ' . BOOKMARKS_TABLE . '
+			WHERE topic_id = ' . $topic_id;
+		$result = $db->sql_query($sql);
+
+		$sql_ary = array();
+		while ($row = $db->sql_fetchrow($result))
+		{
+			$sql_ary[] = array(
+				'topic_id'		=> (int) $to_topic_id,
+				'user_id'		=> (int) $row['user_id'],
+			);
+		}
+		$db->sql_freeresult($result);
+
+		if (sizeof($sql_ary))
+		{
+			$db->sql_multi_insert(BOOKMARKS_TABLE, $sql_ary);
+		}
+
 		$success_msg = 'TOPIC_SPLIT_SUCCESS';
 
 		// Update forum statistics
@@ -608,13 +662,16 @@
 		}
 		else
 		{
+			if (!function_exists('phpbb_update_rows_avoiding_duplicates_notify_status'))
+			{
+				include($phpbb_root_path . 'includes/functions_database_helper.' . $phpEx);
+			}
+
 			// If the topic no longer exist, we will update the topic watch table.
-			// To not let it error out on users watching both topics, we just return on an error...
-			$db->sql_return_on_error(true);
-			$db->sql_query('UPDATE ' . TOPICS_WATCH_TABLE . ' SET topic_id = ' . (int) $to_topic_id . ' WHERE topic_id = ' . (int) $topic_id);
-			$db->sql_return_on_error(false);
+			phpbb_update_rows_avoiding_duplicates_notify_status($db, TOPICS_WATCH_TABLE, 'topic_id', array($topic_id), $to_topic_id);
 
-			$db->sql_query('DELETE FROM ' . TOPICS_WATCH_TABLE . ' WHERE topic_id = ' . (int) $topic_id);
+			// If the topic no longer exist, we will update the bookmarks table.
+			phpbb_update_rows_avoiding_duplicates($db, BOOKMARKS_TABLE, 'topic_id', array($topic_id), $to_topic_id);
 		}
 
 		// Link to the new topic
diff -ruN phpBB-3.0.10/includes/mcp/mcp_warn.php phpbb/includes/mcp/mcp_warn.php
--- phpBB-3.0.10/includes/mcp/mcp_warn.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/mcp/mcp_warn.php	2013-09-28 03:20:51.000000000 +0200
@@ -308,7 +308,7 @@
 			include($phpbb_root_path . 'includes/functions_display.' . $phpEx);
 		}
 
-		$rank_title = $rank_img = '';
+		get_user_rank($user_row['user_rank'], $user_row['user_posts'], $rank_title, $rank_img, $rank_img_src);
 		$avatar_img = get_user_avatar($user_row['user_avatar'], $user_row['user_avatar_type'], $user_row['user_avatar_width'], $user_row['user_avatar_height']);
 
 		$template->assign_vars(array(
@@ -413,7 +413,7 @@
 			include($phpbb_root_path . 'includes/functions_display.' . $phpEx);
 		}
 
-		$rank_title = $rank_img = '';
+		get_user_rank($user_row['user_rank'], $user_row['user_posts'], $rank_title, $rank_img, $rank_img_src);
 		$avatar_img = get_user_avatar($user_row['user_avatar'], $user_row['user_avatar_type'], $user_row['user_avatar_width'], $user_row['user_avatar_height']);
 
 		// OK, they didn't submit a warning so lets build the page for them to do so
diff -ruN phpBB-3.0.10/includes/questionnaire/questionnaire.php phpbb/includes/questionnaire/questionnaire.php
--- phpBB-3.0.10/includes/questionnaire/questionnaire.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/questionnaire/questionnaire.php	2013-09-28 03:20:51.000000000 +0200
@@ -71,7 +71,7 @@
 	/**
 	* Collect info into the data property.
 	*
-	* @return	void
+	* @return	null
 	*/
 	function collect()
 	{
diff -ruN phpBB-3.0.10/includes/search/fulltext_mysql.php phpbb/includes/search/fulltext_mysql.php
--- phpBB-3.0.10/includes/search/fulltext_mysql.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/search/fulltext_mysql.php	2013-09-28 03:20:51.000000000 +0200
@@ -86,9 +86,16 @@
 			$engine = $info['Type'];
 		}
 
-		if ($engine != 'MyISAM')
+		$fulltext_supported =
+			$engine === 'MyISAM' ||
+			// FULLTEXT is supported on InnoDB since MySQL 5.6.4 according to
+			// http://dev.mysql.com/doc/refman/5.6/en/innodb-storage-engine.html
+			$engine === 'InnoDB' &&
+			phpbb_version_compare($db->sql_server_info(true), '5.6.4', '>=');
+
+		if (!$fulltext_supported)
 		{
-			return $user->lang['FULLTEXT_MYSQL_NOT_MYISAM'];
+			return $user->lang['FULLTEXT_MYSQL_NOT_SUPPORTED'];
 		}
 
 		$sql = 'SHOW VARIABLES
@@ -707,7 +714,7 @@
 	*/
 	function index_remove($post_ids, $author_ids, $forum_ids)
 	{
-		$this->destroy_cache(array(), $author_ids);
+		$this->destroy_cache(array(), array_unique($author_ids));
 	}
 
 	/**
@@ -747,7 +754,7 @@
 		{
 			if ($db->sql_layer == 'mysqli' || version_compare($db->sql_server_info(true), '4.1.3', '>='))
 			{
-				//$alter[] = 'MODIFY post_subject varchar(100) COLLATE utf8_unicode_ci DEFAULT \'\' NOT NULL';
+				$alter[] = 'MODIFY post_subject varchar(255) COLLATE utf8_unicode_ci DEFAULT \'\' NOT NULL';
 			}
 			else
 			{
@@ -896,11 +903,7 @@
 		}
 		$db->sql_freeresult($result);
 
-		$sql = 'SELECT COUNT(post_id) as total_posts
-			FROM ' . POSTS_TABLE;
-		$result = $db->sql_query($sql);
-		$this->stats['total_posts'] = (int) $db->sql_fetchfield('total_posts');
-		$db->sql_freeresult($result);
+		$this->stats['total_posts'] = empty($this->stats) ? 0 : $db->get_estimated_row_count(POSTS_TABLE);
 	}
 
 	/**
diff -ruN phpBB-3.0.10/includes/search/fulltext_native.php phpbb/includes/search/fulltext_native.php
--- phpBB-3.0.10/includes/search/fulltext_native.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/search/fulltext_native.php	2013-09-28 03:20:51.000000000 +0200
@@ -1334,7 +1334,7 @@
 			$db->sql_query($sql);
 		}
 
-		$this->destroy_cache(array_unique($word_texts), $author_ids);
+		$this->destroy_cache(array_unique($word_texts), array_unique($author_ids));
 	}
 
 	/**
@@ -1461,17 +1461,8 @@
 	{
 		global $db;
 
-		$sql = 'SELECT COUNT(*) as total_words
-			FROM ' . SEARCH_WORDLIST_TABLE;
-		$result = $db->sql_query($sql);
-		$this->stats['total_words'] = (int) $db->sql_fetchfield('total_words');
-		$db->sql_freeresult($result);
-
-		$sql = 'SELECT COUNT(*) as total_matches
-			FROM ' . SEARCH_WORDMATCH_TABLE;
-		$result = $db->sql_query($sql);
-		$this->stats['total_matches'] = (int) $db->sql_fetchfield('total_matches');
-		$db->sql_freeresult($result);
+		$this->stats['total_words']		= $db->get_estimated_row_count(SEARCH_WORDLIST_TABLE);
+		$this->stats['total_matches']	= $db->get_estimated_row_count(SEARCH_WORDMATCH_TABLE);
 	}
 
 	/**
diff -ruN phpBB-3.0.10/includes/search/search.php phpbb/includes/search/search.php
--- phpBB-3.0.10/includes/search/search.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/search/search.php	2013-09-28 03:20:51.000000000 +0200
@@ -295,7 +295,7 @@
 			$sql_where = '';
 			foreach ($authors as $author)
 			{
-				$sql_where .= (($sql_where) ? ' OR ' : '') . 'search_authors LIKE \'% ' . (int) $author . ' %\'';
+				$sql_where .= (($sql_where) ? ' OR ' : '') . 'search_authors ' . $db->sql_like_expression($db->any_char . ' ' . (int) $author . ' ' . $db->any_char);
 			}
 
 			$sql = 'SELECT search_key
diff -ruN phpBB-3.0.10/includes/session.php phpbb/includes/session.php
--- phpBB-3.0.10/includes/session.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/session.php	2013-09-28 03:20:51.000000000 +0200
@@ -322,8 +322,15 @@
 			}
 		}
 
-		// Is session_id is set or session_id is set and matches the url param if required
-		if (!empty($this->session_id) && (!defined('NEED_SID') || (isset($_GET['sid']) && $this->session_id === $_GET['sid'])))
+		// if no session id is set, redirect to index.php
+		if (defined('NEED_SID') && (!isset($_GET['sid']) || $this->session_id !== $_GET['sid']))
+		{
+			send_status_line(401, 'Unauthorized');
+			redirect(append_sid("{$phpbb_root_path}index.$phpEx"));
+		}
+
+		// if session id is set
+		if (!empty($this->session_id))
 		{
 			$sql = 'SELECT u.*, s.*
 				FROM ' . SESSIONS_TABLE . ' s, ' . USERS_TABLE . " u
@@ -1507,7 +1514,6 @@
 
 	// Able to add new options (up to id 31)
 	var $keyoptions = array('viewimg' => 0, 'viewflash' => 1, 'viewsmilies' => 2, 'viewsigs' => 3, 'viewavatars' => 4, 'viewcensors' => 5, 'attachsig' => 6, 'bbcode' => 8, 'smilies' => 9, 'popuppm' => 10, 'sig_bbcode' => 15, 'sig_smilies' => 16, 'sig_links' => 17);
-	var $keyvalues = array();
 
 	/**
 	* Constructor to set the lang path
@@ -1655,7 +1661,7 @@
 
 		if (!$this->theme)
 		{
-			trigger_error('Could not get style data', E_USER_ERROR);
+			trigger_error('NO_STYLE_DATA', E_USER_ERROR);
 		}
 
 		// Now parse the cfg file and cache it
@@ -2150,7 +2156,8 @@
 				'is_short'		=> strpos($format, '|'),
 				'format_short'	=> substr($format, 0, strpos($format, '|')) . '||' . substr(strrchr($format, '|'), 1),
 				'format_long'	=> str_replace('|', '', $format),
-				'lang'			=> $this->lang['datetime'],
+				// Filter out values that are not strings (e.g. arrays) for strtr().
+				'lang'			=> array_filter($this->lang['datetime'], 'is_string'),
 			);
 
 			// Short representation of month in format? Some languages use different terms for the long and short format of May
@@ -2337,47 +2344,51 @@
 	}
 
 	/**
-	* Get option bit field from user options
+	* Get option bit field from user options.
+	*
+	* @param int $key option key, as defined in $keyoptions property.
+	* @param int $data bit field value to use, or false to use $this->data['user_options']
+	* @return bool true if the option is set in the bit field, false otherwise
 	*/
 	function optionget($key, $data = false)
 	{
-		if (!isset($this->keyvalues[$key]))
-		{
-			$var = ($data) ? $data : $this->data['user_options'];
-			$this->keyvalues[$key] = ($var & 1 << $this->keyoptions[$key]) ? true : false;
-		}
-
-		return $this->keyvalues[$key];
+		$var = ($data !== false) ? $data : $this->data['user_options'];
+		return phpbb_optionget($this->keyoptions[$key], $var);
 	}
 
 	/**
-	* Set option bit field for user options
+	* Set option bit field for user options.
+	*
+	* @param int $key Option key, as defined in $keyoptions property.
+	* @param bool $value True to set the option, false to clear the option.
+	* @param int $data Current bit field value, or false to use $this->data['user_options']
+	* @return int|bool If $data is false, the bit field is modified and
+	*                  written back to $this->data['user_options'], and
+	*                  return value is true if the bit field changed and
+	*                  false otherwise. If $data is not false, the new
+	*                  bitfield value is returned.
 	*/
 	function optionset($key, $value, $data = false)
 	{
-		$var = ($data) ? $data : $this->data['user_options'];
+		$var = ($data !== false) ? $data : $this->data['user_options'];
 
-		if ($value && !($var & 1 << $this->keyoptions[$key]))
-		{
-			$var += 1 << $this->keyoptions[$key];
-		}
-		else if (!$value && ($var & 1 << $this->keyoptions[$key]))
-		{
-			$var -= 1 << $this->keyoptions[$key];
-		}
-		else
-		{
-			return ($data) ? $var : false;
-		}
+		$new_var = phpbb_optionset($this->keyoptions[$key], $value, $var);
 
-		if (!$data)
+		if ($data === false)
 		{
-			$this->data['user_options'] = $var;
-			return true;
+			if ($new_var != $var)
+			{
+				$this->data['user_options'] = $new_var;
+				return true;
+			}
+			else
+			{
+				return false;
+			}
 		}
 		else
 		{
-			return $var;
+			return $new_var;
 		}
 	}
 
diff -ruN phpBB-3.0.10/includes/startup.php phpbb/includes/startup.php
--- phpBB-3.0.10/includes/startup.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/startup.php	2013-09-28 03:20:51.000000000 +0200
@@ -19,7 +19,23 @@
 {
 	define('E_DEPRECATED', 8192);
 }
-error_reporting(E_ALL & ~E_NOTICE & ~E_DEPRECATED);
+$level = E_ALL & ~E_NOTICE & ~E_DEPRECATED;
+if (version_compare(PHP_VERSION, '5.4.0-dev', '>='))
+{
+	// PHP 5.4 adds E_STRICT to E_ALL.
+	// Our utf8 normalizer triggers E_STRICT output on PHP 5.4.
+	// Unfortunately it cannot be made E_STRICT-clean while
+	// continuing to work on PHP 4.
+	// Therefore, in phpBB 3.0.x we disable E_STRICT on PHP 5.4+,
+	// while phpBB 3.1 will fix utf8 normalizer.
+	// E_STRICT is defined starting with PHP 5
+	if (!defined('E_STRICT'))
+	{
+		define('E_STRICT', 2048);
+	}
+	$level &= ~E_STRICT;
+}
+error_reporting($level);
 
 /*
 * Remove variables created by register_globals from the global scope
diff -ruN phpBB-3.0.10/includes/ucp/info/ucp_profile.php phpbb/includes/ucp/info/ucp_profile.php
--- phpBB-3.0.10/includes/ucp/info/ucp_profile.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/ucp/info/ucp_profile.php	2013-09-28 03:20:51.000000000 +0200
@@ -21,7 +21,7 @@
 			'version'	=> '1.0.0',
 			'modes'		=> array(
 				'profile_info'	=> array('title' => 'UCP_PROFILE_PROFILE_INFO', 'auth' => '', 'cat' => array('UCP_PROFILE')),
-				'signature'		=> array('title' => 'UCP_PROFILE_SIGNATURE', 'auth' => '', 'cat' => array('UCP_PROFILE')),
+				'signature'		=> array('title' => 'UCP_PROFILE_SIGNATURE', 'auth' => 'acl_u_sig', 'cat' => array('UCP_PROFILE')),
 				'avatar'		=> array('title' => 'UCP_PROFILE_AVATAR', 'auth' => 'cfg_allow_avatar && (cfg_allow_avatar_local || cfg_allow_avatar_remote || cfg_allow_avatar_upload || cfg_allow_avatar_remote_upload)', 'cat' => array('UCP_PROFILE')),
 				'reg_details'	=> array('title' => 'UCP_PROFILE_REG_DETAILS', 'auth' => '', 'cat' => array('UCP_PROFILE')),
 			),
diff -ruN phpBB-3.0.10/includes/ucp/ucp_activate.php phpbb/includes/ucp/ucp_activate.php
--- phpBB-3.0.10/includes/ucp/ucp_activate.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/ucp/ucp_activate.php	2013-09-28 03:20:51.000000000 +0200
@@ -51,7 +51,7 @@
 			trigger_error('ALREADY_ACTIVATED');
 		}
 
-		if (($user_row['user_inactive_reason'] ==  INACTIVE_MANUAL) || $user_row['user_actkey'] != $key)
+		if ($user_row['user_inactive_reason'] == INACTIVE_MANUAL || $user_row['user_actkey'] !== $key)
 		{
 			trigger_error('WRONG_ACTIVATION');
 		}
diff -ruN phpBB-3.0.10/includes/ucp/ucp_groups.php phpbb/includes/ucp/ucp_groups.php
--- phpBB-3.0.10/includes/ucp/ucp_groups.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/ucp/ucp_groups.php	2013-09-28 03:20:51.000000000 +0200
@@ -595,6 +595,13 @@
 								$error[] = $user->lang['FORM_INVALID'];
 							}
 
+							// Validate submitted colour value
+							if ($colour_error = validate_data($submit_ary, array('colour'	=> array('hex_colour', true))))
+							{
+								// Replace "error" string with its real, localised form
+								$error = array_merge($error, $colour_error);
+							}
+
 							if (!sizeof($error))
 							{
 								// Only set the rank, colour, etc. if it's changed or if we're adding a new
@@ -635,6 +642,7 @@
 
 							if (sizeof($error))
 							{
+								$error = array_map(array(&$user, 'lang'), $error);
 								$group_rank = $submit_ary['rank'];
 
 								$group_desc_data = array(
diff -ruN phpBB-3.0.10/includes/ucp/ucp_pm_compose.php phpbb/includes/ucp/ucp_pm_compose.php
--- phpBB-3.0.10/includes/ucp/ucp_pm_compose.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/ucp/ucp_pm_compose.php	2013-09-28 03:20:51.000000000 +0200
@@ -271,19 +271,16 @@
 			// Passworded forum?
 			if ($post['forum_id'])
 			{
-				$sql = 'SELECT forum_password
+				$sql = 'SELECT forum_id, forum_name, forum_password
 					FROM ' . FORUMS_TABLE . '
 					WHERE forum_id = ' . (int) $post['forum_id'];
 				$result = $db->sql_query($sql);
-				$forum_password = (string) $db->sql_fetchfield('forum_password');
+				$forum_data = $db->sql_fetchrow($result);
 				$db->sql_freeresult($result);
 
-				if ($forum_password)
+				if (!empty($forum_data['forum_password']))
 				{
-					login_forum_box(array(
-						'forum_id'			=> $post['forum_id'],
-						'forum_password'	=> $forum_password,
-					));
+					login_forum_box($forum_data);
 				}
 			}
 		}
@@ -359,7 +356,7 @@
 		$message_attachment = 0;
 		$message_text = $message_subject = '';
 
-		if ($to_user_id && $action == 'post')
+		if ($to_user_id && $to_user_id != ANONYMOUS && $action == 'post')
 		{
 			$address_list['u'][$to_user_id] = 'to';
 		}
@@ -755,7 +752,8 @@
 			$return_box_lang = ($action === 'post' || $action === 'edit') ? 'PM_OUTBOX' : 'PM_INBOX';
 
 
-			$message = $user->lang['MESSAGE_STORED'] . '<br /><br />' . sprintf($user->lang['VIEW_PRIVATE_MESSAGE'], '<a href="' . $return_message_url . '">', '</a>');
+			$save_message = ($action === 'edit') ? $user->lang['MESSAGE_EDITED'] : $user->lang['MESSAGE_STORED'];
+			$message = $save_message . '<br /><br />' . $user->lang('VIEW_PRIVATE_MESSAGE', '<a href="' . $return_message_url . '">', '</a>');
 
 			$last_click_type = 'CLICK_RETURN_FOLDER';
 			if ($folder_url)
diff -ruN phpBB-3.0.10/includes/ucp/ucp_pm_options.php phpbb/includes/ucp/ucp_pm_options.php
--- phpBB-3.0.10/includes/ucp/ucp_pm_options.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/ucp/ucp_pm_options.php	2013-09-28 03:20:51.000000000 +0200
@@ -328,10 +328,23 @@
 				trigger_error('RULE_ALREADY_DEFINED');
 			}
 
+			// Prevent users from flooding the rules table
+			$sql = 'SELECT COUNT(rule_id) AS num_rules
+				FROM ' . PRIVMSGS_RULES_TABLE . '
+				WHERE user_id = ' . (int) $user->data['user_id'];
+			$result = $db->sql_query($sql);
+			$num_rules = (int) $db->sql_fetchfield('num_rules');
+			$db->sql_freeresult($result);
+
+			if ($num_rules >= 5000)
+			{
+				trigger_error('RULE_LIMIT_REACHED');
+			}
+
 			$sql = 'INSERT INTO ' . PRIVMSGS_RULES_TABLE . ' ' . $db->sql_build_array('INSERT', $rule_ary);
 			$db->sql_query($sql);
 
-			// Update users message rules
+			// Set the user_message_rules bit
 			$sql = 'UPDATE ' . USERS_TABLE . '
 				SET user_message_rules = 1
 				WHERE user_id = ' . $user->data['user_id'];
@@ -378,7 +391,7 @@
 			$row = $db->sql_fetchrow($result);
 			$db->sql_freeresult($result);
 
-			// Update users message rules
+			// Unset the user_message_rules bit
 			if (!$row)
 			{
 				$sql = 'UPDATE ' . USERS_TABLE . '
diff -ruN phpBB-3.0.10/includes/ucp/ucp_prefs.php phpbb/includes/ucp/ucp_prefs.php
--- phpBB-3.0.10/includes/ucp/ucp_prefs.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/ucp/ucp_prefs.php	2013-09-28 03:20:51.000000000 +0200
@@ -61,7 +61,14 @@
 
 				if ($submit)
 				{
-					$data['style'] = ($config['override_user_style']) ? $config['default_style'] : $data['style'];
+					if ($config['override_user_style'])
+					{
+						$data['style'] = (int) $config['default_style'];
+					}
+					else if (!phpbb_style_is_active($data['style']))
+					{
+						$data['style'] = (int) $user->data['user_style'];
+					}
 
 					$error = validate_data($data, array(
 						'dateformat'	=> array('string', false, 1, 30),
@@ -127,6 +134,35 @@
 				}
 				$dateformat_options .= '>' . $user->lang['CUSTOM_DATEFORMAT'] . '</option>';
 
+				// check if there are any user-selectable languages
+				$sql = 'SELECT COUNT(lang_id) as languages_count
+								FROM ' . LANG_TABLE;
+				$result = $db->sql_query($sql);
+				if ($db->sql_fetchfield('languages_count') > 1)
+				{
+					$s_more_languages = true;
+				}
+				else
+				{
+					$s_more_languages = false;
+				}
+				$db->sql_freeresult($result);
+
+				// check if there are any user-selectable styles
+				$sql = 'SELECT COUNT(style_id) as styles_count
+								FROM ' . STYLES_TABLE . '
+								WHERE style_active = 1';
+				$result = $db->sql_query($sql);
+				if ($db->sql_fetchfield('styles_count') > 1)
+				{
+					$s_more_styles = true;
+				}
+				else
+				{
+					$s_more_styles = false;
+				}
+				$db->sql_freeresult($result);
+
 				$template->assign_vars(array(
 					'ERROR'				=> (sizeof($error)) ? implode('<br />', $error) : '',
 
@@ -148,6 +184,9 @@
 					'DEFAULT_DATEFORMAT'	=> $config['default_dateformat'],
 					'A_DEFAULT_DATEFORMAT'	=> addslashes($config['default_dateformat']),
 
+					'S_MORE_LANGUAGES'	=> $s_more_languages,
+					'S_MORE_STYLES'			=> $s_more_styles,
+
 					'S_LANG_OPTIONS'		=> language_select($data['lang']),
 					'S_STYLE_OPTIONS'		=> ($config['override_user_style']) ? '' : style_select($data['style']),
 					'S_TZ_OPTIONS'			=> tz_select($data['tz'], true),
diff -ruN phpBB-3.0.10/includes/ucp/ucp_register.php phpbb/includes/ucp/ucp_register.php
--- phpBB-3.0.10/includes/ucp/ucp_register.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/ucp/ucp_register.php	2013-09-28 03:20:51.000000000 +0200
@@ -165,24 +165,8 @@
 			$captcha->init(CONFIRM_REG);
 		}
 
-		// Try to manually determine the timezone and adjust the dst if the server date/time complies with the default setting +/- 1
-		$timezone = date('Z') / 3600;
-		$is_dst = date('I');
-
-		if ($config['board_timezone'] == $timezone || $config['board_timezone'] == ($timezone - 1))
-		{
-			$timezone = ($is_dst) ? $timezone - 1 : $timezone;
-
-			if (!isset($user->lang['tz_zones'][(string) $timezone]))
-			{
-				$timezone = $config['board_timezone'];
-			}
-		}
-		else
-		{
-			$is_dst = $config['board_dst'];
-			$timezone = $config['board_timezone'];
-		}
+		$is_dst = $config['board_dst'];
+		$timezone = $config['board_timezone'];
 
 		$data = array(
 			'username'			=> utf8_normalize_nfc(request_var('username', '', true)),
diff -ruN phpBB-3.0.10/includes/utf/utf_normalizer.php phpbb/includes/utf/utf_normalizer.php
--- phpBB-3.0.10/includes/utf/utf_normalizer.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/includes/utf/utf_normalizer.php	2014-04-15 14:31:18.665429005 +0200
@@ -151,7 +151,8 @@
 	* @param	string	&$str	Unchecked UTF string
 	* @return	string			The string, validated and in normal form
 	*/
-	function nfkc(&$str)
+	// TVO 2012/07/04: Added 'static' to get rid of PHP warnings in the wiki. (Auth_phpBB plugin?)
+	static function nfkc(&$str)
 	{
 		$pos = strspn($str, UTF8_ASCII_RANGE);
 		$len = strlen($str);
@@ -1513,4 +1514,4 @@
 	}
 }
 
-?>
\ No newline at end of file
+?>
diff -ruN phpBB-3.0.10/index.php phpbb/index.php
--- phpBB-3.0.10/index.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/index.php	2013-09-28 03:20:51.000000000 +0200
@@ -89,7 +89,7 @@
 	$leap_year_birthdays = '';
 	if ($now['mday'] == 28 && $now['mon'] == 2 && !$user->format_date(time(), 'L'))
 	{
-		$leap_year_birthdays = " OR user_birthday LIKE '" . $db->sql_escape(sprintf('%2d-%2d-', 29, 2)) . "%'";
+		$leap_year_birthdays = " OR u.user_birthday LIKE '" . $db->sql_escape(sprintf('%2d-%2d-', 29, 2)) . "%'";
 	}
 
 	$sql = 'SELECT u.user_id, u.username, u.user_colour, u.user_birthday
diff -ruN phpBB-3.0.10/language/en/acp/attachments.php phpbb/language/en/acp/attachments.php
--- phpBB-3.0.10/language/en/acp/attachments.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/language/en/acp/attachments.php	2013-09-28 03:20:51.000000000 +0200
@@ -57,7 +57,7 @@
 	'ATTACH_EXT_GROUPS_URL'				=> 'Extension groups',
 	'ATTACH_ID'							=> 'ID',
 	'ATTACH_MAX_FILESIZE'				=> 'Maximum file size',
-	'ATTACH_MAX_FILESIZE_EXPLAIN'		=> 'Maximum size of each file, with 0 being unlimited.',
+	'ATTACH_MAX_FILESIZE_EXPLAIN'		=> 'Maximum size of each file. If this value is 0, the uploadable filesize is only limited by your PHP configuration.',
 	'ATTACH_MAX_PM_FILESIZE'			=> 'Maximum file size messaging',
 	'ATTACH_MAX_PM_FILESIZE_EXPLAIN'	=> 'Maximum size of each file, with 0 being unlimited, attached to a private message.',
 	'ATTACH_ORPHAN_URL'					=> 'Orphan attachments',
diff -ruN phpBB-3.0.10/language/en/acp/board.php phpbb/language/en/acp/board.php
--- phpBB-3.0.10/language/en/acp/board.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/language/en/acp/board.php	2013-09-28 03:20:51.000000000 +0200
@@ -53,7 +53,7 @@
 	'SYSTEM_TIMEZONE'				=> 'Guest timezone',
 	'SYSTEM_TIMEZONE_EXPLAIN'			=> 'Timezone to use for displaying times to users who are not logged in (guests, bots). Logged in users set their timezone during registration and can change it in their user control panel.',
 	'WARNINGS_EXPIRE'				=> 'Warning duration',
-	'WARNINGS_EXPIRE_EXPLAIN'		=> 'Number of days that will elapse before the warning will automatically expire from a users record. Set this value to 0 to make warnings permanent.',
+	'WARNINGS_EXPIRE_EXPLAIN'		=> 'Number of days that will elapse before a warning will automatically expire from a users record. Set this value to 0 to make warnings permanent.',
 ));
 
 // Board Features
@@ -108,7 +108,7 @@
 	'MAX_AVATAR_SIZE'				=> 'Maximum avatar dimensions',
 	'MAX_AVATAR_SIZE_EXPLAIN'		=> 'Width x Height in pixels.',
 	'MAX_FILESIZE'					=> 'Maximum avatar file size',
-	'MAX_FILESIZE_EXPLAIN'			=> 'For uploaded avatar files.',
+	'MAX_FILESIZE_EXPLAIN'			=> 'For uploaded avatar files. If this value is 0, the uploaded filesize is only limited by your PHP configuration.',
 	'MIN_AVATAR_SIZE'				=> 'Minimum avatar dimensions',
 	'MIN_AVATAR_SIZE_EXPLAIN'		=> 'Width x Height in pixels.',
 ));
diff -ruN phpBB-3.0.10/language/en/acp/common.php phpbb/language/en/acp/common.php
--- phpBB-3.0.10/language/en/acp/common.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/language/en/acp/common.php	2013-09-28 03:20:51.000000000 +0200
@@ -96,10 +96,10 @@
 	'ACP_GLOBAL_MODERATORS'			=> 'Global moderators',
 	'ACP_GLOBAL_PERMISSIONS'		=> 'Global permissions',
 	'ACP_GROUPS'					=> 'Groups',
-	'ACP_GROUPS_FORUM_PERMISSIONS'	=> 'Groups forum permissions',
+	'ACP_GROUPS_FORUM_PERMISSIONS'	=> 'Group forum permissions',
 	'ACP_GROUPS_MANAGE'				=> 'Manage groups',
 	'ACP_GROUPS_MANAGEMENT'			=> 'Group management',
-	'ACP_GROUPS_PERMISSIONS'		=> 'Groups permissions',
+	'ACP_GROUPS_PERMISSIONS'		=> 'Group permissions',
 
 	'ACP_ICONS'					=> 'Topic icons',
 	'ACP_ICONS_SMILIES'			=> 'Topic icons/smilies',
@@ -172,9 +172,9 @@
 	'ACP_THEMES'				=> 'Themes',
 
 	'ACP_UPDATE'					=> 'Updating',
-	'ACP_USERS_FORUM_PERMISSIONS'	=> 'Users forum permissions',
+	'ACP_USERS_FORUM_PERMISSIONS'	=> 'User forum permissions',
 	'ACP_USERS_LOGS'				=> 'User logs',
-	'ACP_USERS_PERMISSIONS'			=> 'Users permissions',
+	'ACP_USERS_PERMISSIONS'			=> 'User permissions',
 	'ACP_USER_ATTACH'				=> 'Attachments',
 	'ACP_USER_AVATAR'				=> 'Avatar',
 	'ACP_USER_FEEDBACK'				=> 'Feedback',
@@ -292,7 +292,7 @@
 
 // PHP info
 $lang = array_merge($lang, array(
-	'ACP_PHP_INFO_EXPLAIN'	=> 'This page lists information on the version of PHP installed on this server. It includes details of loaded modules, available variables and default settings. This information may be useful when diagnosing problems. Please be aware that some hosting companies will limit what information is displayed here for security reasons. You are advised to not give out any details on this page except when asked by <a href="http://www.phpbb.com/about/team/">official team members</a> on the support forums.',
+	'ACP_PHP_INFO_EXPLAIN'	=> 'This page lists information on the version of PHP installed on this server. It includes details of loaded modules, available variables and default settings. This information may be useful when diagnosing problems. Please be aware that some hosting companies will limit what information is displayed here for security reasons. You are advised to not give out any details on this page except when asked by <a href="https://www.phpbb.com/about/team/">official team members</a> on the support forums.',
 
 	'NO_PHPINFO_AVAILABLE'	=> 'Information about your PHP configuration is unable to be determined. Phpinfo() has been disabled for security reasons.',
 ));
@@ -405,7 +405,7 @@
 	'INACTIVE_REASON_UNKNOWN'		=> 'Unknown',
 	'INACTIVE_USERS'				=> 'Inactive users',
 	'INACTIVE_USERS_EXPLAIN'		=> 'This is a list of users who have registered but whose accounts are inactive. You can activate, delete or remind (by sending an e-mail) these users if you wish.',
-	'INACTIVE_USERS_EXPLAIN_INDEX'	=> 'This is a list of the last 10 registered users who have inactive accounts. A full list is available from the appropriate menu item or by following the link below from where you can activate, delete or remind (by sending an e-mail) these users if you wish.',
+	'INACTIVE_USERS_EXPLAIN_INDEX'	=> 'This is a list of the last 10 registered users who have inactive accounts. Accounts are inactive either because account activation was enabled in user registration settings and these users accounts have not yet been activated, or because these accounts have been deactivated. A full list is available by following the link below from where you can activate, delete or remind (by sending an e-mail) these users if you wish.',
 
 	'NO_INACTIVE_USERS'	=> 'No inactive users',
 
@@ -572,7 +572,7 @@
 	'LOG_FORUM_MOVE_UP'						=> '<strong>Moved forum</strong> %1$s <strong>above</strong> %2$s',
 	'LOG_FORUM_SYNC'						=> '<strong>Re-synchronised forum</strong><br /> %s',
 
-	'LOG_GENERAL_ERROR'	=> '<strong>A general error occured</strong>: %1$s <br /> %2$s',
+	'LOG_GENERAL_ERROR'	=> '<strong>A general error occurred</strong>: %1$s <br /> %2$s',
 
 	'LOG_GROUP_CREATED'		=> '<strong>New usergroup created</strong><br /> %s',
 	'LOG_GROUP_DEFAULTS'	=> '<strong>Group %1$s made default for members</strong><br /> %2$s',
diff -ruN phpBB-3.0.10/language/en/acp/permissions.php phpbb/language/en/acp/permissions.php
--- phpBB-3.0.10/language/en/acp/permissions.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/language/en/acp/permissions.php	2013-09-28 03:20:51.000000000 +0200
@@ -40,10 +40,10 @@
 		<p>Permissions are highly granular and grouped into four major sections, which are:</p>
 
 		<h2>Global Permissions</h2>
-		<p>These are used to control access on a global level and apply to the entire bulletin board. They are further divided into Users Permissions, Groups Permissions, Administrators and Global Moderators.</p>
+		<p>These are used to control access on a global level and apply to the entire bulletin board. They are further divided into User Permissions, Group Permissions, Administrators and Global Moderators.</p>
 
 		<h2>Forum Based Permissions</h2>
-		<p>These are used to control access on a per forum basis. They are further divided into Forum Permissions, Forum Moderators, Users Forum Permissions and Groups Forum Permissions.</p>
+		<p>These are used to control access on a per forum basis. They are further divided into Forum Permissions, Forum Moderators, User Forum Permissions and Group Forum Permissions.</p>
 
 		<h2>Permission Roles</h2>
 		<p>These are used to create different sets of permissions for the different permission types later being able to be assigned on a role-based basis. The default roles should cover the administration of bulletin boards large and small, though within each of the four divisions, you can add/edit/delete roles as you see fit.</p>
@@ -53,7 +53,7 @@
 
 		<br />
 
-		<p>For further information on setting up and managing permissions on your phpBB3 board, please see <a href="http://www.phpbb.com/support/documentation/3.0/quickstart/quick_permissions.html">Chapter 1.5 of our Quick Start Guide</a>.</p>
+		<p>For further information on setting up and managing permissions on your phpBB3 board, please see <a href="https://www.phpbb.com/support/documentation/3.0/quickstart/quick_permissions.html">Chapter 1.5 of our Quick Start Guide</a>.</p>
 	',
 
 	'ACL_NEVER'				=> 'Never',
@@ -83,13 +83,13 @@
 	'ACP_FORUM_PERMISSIONS_COPY_EXPLAIN'		=> 'Here you can copy forum permissions from one forum to one or more other forums.',
 	'ACP_GLOBAL_MODERATORS_EXPLAIN'				=> 'Here you can assign global moderator permissions to users or groups. These moderators are like ordinary moderators except they have access to every forum on your board.',
 	'ACP_GROUPS_FORUM_PERMISSIONS_EXPLAIN'		=> 'Here you can assign forum permissions to groups.',
-	'ACP_GROUPS_PERMISSIONS_EXPLAIN'			=> 'Here you can assign global permissions to groups - user permissions, global moderator permissions and administrator permissions. User permissions include capabilities such as the use of avatars, sending private messages, et cetera; global moderator permissions such as approving posts, manage topics, manage bans, et cetera and lastly administrator permissions such as altering permissions, define custom BBCodes, manage forums, et cetera. Individual users permissions should only be changed in rare occasions, the preferred method is putting users in groups and assigning the groups permissions.',
+	'ACP_GROUPS_PERMISSIONS_EXPLAIN'			=> 'Here you can assign global permissions to groups - user permissions, global moderator permissions and administrator permissions. User permissions include capabilities such as the use of avatars, sending private messages, et cetera; global moderator permissions such as approving posts, manage topics, manage bans, et cetera and lastly administrator permissions such as altering permissions, define custom BBCodes, manage forums, et cetera. Individual user permissions should only be changed in rare occasions, the preferred method is putting users in groups and assigning the group permissions.',
 	'ACP_ADMIN_ROLES_EXPLAIN'					=> 'Here you are able to manage the roles for administrative permissions. Roles are effective permissions, if you change a role the items having this role assigned will change its permissions too.',
 	'ACP_FORUM_ROLES_EXPLAIN'					=> 'Here you are able to manage the roles for forum permissions. Roles are effective permissions, if you change a role the items having this role assigned will change its permissions too.',
 	'ACP_MOD_ROLES_EXPLAIN'						=> 'Here you are able to manage the roles for moderative permissions. Roles are effective permissions, if you change a role the items having this role assigned will change its permissions too.',
 	'ACP_USER_ROLES_EXPLAIN'					=> 'Here you are able to manage the roles for user permissions. Roles are effective permissions, if you change a role the items having this role assigned will change its permissions too.',
 	'ACP_USERS_FORUM_PERMISSIONS_EXPLAIN'		=> 'Here you can assign forum permissions to users.',
-	'ACP_USERS_PERMISSIONS_EXPLAIN'				=> 'Here you can assign global permissions to users - user permissions, global moderator permissions and administrator permissions. User permissions include capabilities such as the use of avatars, sending private messages, et cetera; global moderator permissions such as approving posts, manage topics, manage bans, et cetera and lastly administrator permissions such as altering permissions, define custom BBCodes, manage forums, et cetera. To alter these settings for large numbers of users the Group permissions system is the preferred method. Users permissions should only be changed in rare occasions, the preferred method is putting users in groups and assigning the groups permissions.',
+	'ACP_USERS_PERMISSIONS_EXPLAIN'				=> 'Here you can assign global permissions to users - user permissions, global moderator permissions and administrator permissions. User permissions include capabilities such as the use of avatars, sending private messages, et cetera; global moderator permissions such as approving posts, manage topics, manage bans, et cetera and lastly administrator permissions such as altering permissions, define custom BBCodes, manage forums, et cetera. To alter these settings for large numbers of users the Group permissions system is the preferred method. User permissions should only be changed in rare occasions, the preferred method is putting users in groups and assigning the group permissions.',
 	'ACP_VIEW_ADMIN_PERMISSIONS_EXPLAIN'		=> 'Here you can view the effective administrative permissions assigned to the selected users/groups.',
 	'ACP_VIEW_GLOBAL_MOD_PERMISSIONS_EXPLAIN'	=> 'Here you can view the global moderative permissions assigned to the selected users/groups.',
 	'ACP_VIEW_FORUM_PERMISSIONS_EXPLAIN'		=> 'Here you can view the forum permissions assigned to the selected users/groups and forums.',
@@ -171,7 +171,7 @@
 	'ROLE_FORUM_POLLS'			=> 'Standard Access + Polls',
 	'ROLE_FORUM_READONLY'		=> 'Read Only Access',
 	'ROLE_FORUM_STANDARD'		=> 'Standard Access',
-	'ROLE_FORUM_NEW_MEMBER'		=> 'Newly registered User',
+	'ROLE_FORUM_NEW_MEMBER'		=> 'Newly Registered User Access',
 	'ROLE_MOD_FULL'				=> 'Full Moderator',
 	'ROLE_MOD_QUEUE'			=> 'Queue Moderator',
 	'ROLE_MOD_SIMPLE'			=> 'Simple Moderator',
@@ -181,7 +181,7 @@
 	'ROLE_USER_NOAVATAR'		=> 'No Avatar',
 	'ROLE_USER_NOPM'			=> 'No Private Messages',
 	'ROLE_USER_STANDARD'		=> 'Standard Features',
-	'ROLE_USER_NEW_MEMBER'		=> 'Newly registered User',
+	'ROLE_USER_NEW_MEMBER'		=> 'Newly Registered User Features',
 
 
 	'ROLE_DESCRIPTION_ADMIN_FORUM'			=> 'Can access the forum management and forum permission settings.',
@@ -225,8 +225,8 @@
 	'SELECT_TYPE'					=> 'Select type',
 	'SET_PERMISSIONS'				=> 'Set permissions',
 	'SET_ROLE_PERMISSIONS'			=> 'Set role permissions',
-	'SET_USERS_PERMISSIONS'			=> 'Set users permissions',
-	'SET_USERS_FORUM_PERMISSIONS'	=> 'Set users forum permissions',
+	'SET_USERS_PERMISSIONS'			=> 'Set user permissions',
+	'SET_USERS_FORUM_PERMISSIONS'	=> 'Set user forum permissions',
 
 	'TRACE_DEFAULT'					=> 'By default every permission is <samp>NO</samp> (unset). So the permission can be overwritten by other settings.',
 	'TRACE_FOR'						=> 'Trace for',
@@ -273,7 +273,7 @@
 	'TRACE_WHO'								=> 'Who',
 	'TRACE_TOTAL'							=> 'Total',
 
-	'USERS_NOT_ASSIGNED'			=> 'No user assigned to this role',
+	'USERS_NOT_ASSIGNED'			=> 'No users are assigned to this role',
 	'USER_IS_MEMBER_OF_DEFAULT'		=> 'is a member of the following pre-defined groups',
 	'USER_IS_MEMBER_OF_CUSTOM'		=> 'is a member of the following user defined groups',
 
diff -ruN phpBB-3.0.10/language/en/acp/posting.php phpbb/language/en/acp/posting.php
--- phpBB-3.0.10/language/en/acp/posting.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/language/en/acp/posting.php	2013-09-28 03:20:51.000000000 +0200
@@ -83,7 +83,8 @@
 		'NUMBER'		=> 'Any series of digits',
 		'EMAIL'			=> 'A valid e-mail address',
 		'URL'			=> 'A valid URL using any protocol (http, ftp, etc cannot be used for javascript exploits). If none is given, http:// is prefixed to the string.',
-		'LOCAL_URL'		=> 'A local URL. The URL must be relative to the topic page and cannot contain a server name or protocol.',
+		'LOCAL_URL'		=> 'A local URL. The URL must be relative to the topic page and cannot contain a server name or protocol, as links are prefixed with %s',
+		'RELATIVE_URL'	=> 'A relative URL. You can use this to match parts of a URL, but be careful: a full URL is a valid relative URL. When you want to use relative URLs of your board, use the LOCAL_URL token.',
 		'COLOR'			=> 'A HTML colour, can be either in the numeric form <samp>#FF1234</samp> or a <a href="http://www.w3.org/TR/CSS21/syndata.html#value-def-color">CSS colour keyword</a> such as <samp>fuchsia</samp> or <samp>InactiveBorder</samp>'
 	)
 ));
diff -ruN phpBB-3.0.10/language/en/acp/profile.php phpbb/language/en/acp/profile.php
--- phpBB-3.0.10/language/en/acp/profile.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/language/en/acp/profile.php	2013-09-28 03:20:51.000000000 +0200
@@ -131,6 +131,8 @@
 
 	'SAVE'							=> 'Save',
 	'SECOND_OPTION'					=> 'Second option',
+	'SHOW_NOVALUE_FIELD'			=> 'Show field if no value was selected',
+	'SHOW_NOVALUE_FIELD_EXPLAIN'	=> 'Determines if the profile field should be displayed if no value was selected for optional fields or if no value has been selected yet for required fields.',
 	'STEP_1_EXPLAIN_CREATE'			=> 'Here you can enter the first basic parameters of your new profile field. This information is needed for the second step where youll be able to set remaining options and tweak your profile field further.',
 	'STEP_1_EXPLAIN_EDIT'			=> 'Here you can change the basic parameters of your profile field. The relevant options are re-calculated within the second step.',
 	'STEP_1_TITLE_CREATE'			=> 'Add profile field',
diff -ruN phpBB-3.0.10/language/en/acp/search.php phpbb/language/en/acp/search.php
--- phpBB-3.0.10/language/en/acp/search.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/language/en/acp/search.php	2013-09-28 03:20:51.000000000 +0200
@@ -53,7 +53,7 @@
 	'DELETING_INDEX_IN_PROGRESS_EXPLAIN'	=> 'The search backend is currently cleaning its index. This can take a few minutes.',
 
 	'FULLTEXT_MYSQL_INCOMPATIBLE_VERSION'	=> 'The MySQL fulltext backend can only be used with MySQL4 and above.',
-	'FULLTEXT_MYSQL_NOT_MYISAM'				=> 'MySQL fulltext indexes can only be used with MyISAM tables.',
+	'FULLTEXT_MYSQL_NOT_SUPPORTED'			=> 'MySQL fulltext indexes can only be used with MyISAM or InnoDB tables. MySQL 5.6.4 or later is required for fulltext indexes on InnoDB tables.',
 	'FULLTEXT_MYSQL_TOTAL_POSTS'			=> 'Total number of indexed posts',
 	'FULLTEXT_MYSQL_MBSTRING'				=> 'Support for non-latin UTF-8 characters using mbstring:',
 	'FULLTEXT_MYSQL_PCRE'					=> 'Support for non-latin UTF-8 characters using PCRE:',
diff -ruN phpBB-3.0.10/language/en/acp/styles.php phpbb/language/en/acp/styles.php
--- phpBB-3.0.10/language/en/acp/styles.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/language/en/acp/styles.php	2013-09-28 03:20:51.000000000 +0200
@@ -267,6 +267,7 @@
 	'IMG_USER_ICON9'		=> 'User defined image 9',
 	'IMG_USER_ICON10'		=> 'User defined image 10',
 
+	'INACTIVE_STYLES'			=> 'Inactive styles',
 	'INCLUDE_DIMENSIONS'		=> 'Include dimensions',
 	'INCLUDE_IMAGESET'			=> 'Include imageset',
 	'INCLUDE_TEMPLATE'			=> 'Include template',
diff -ruN phpBB-3.0.10/language/en/acp/users.php phpbb/language/en/acp/users.php
--- phpBB-3.0.10/language/en/acp/users.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/language/en/acp/users.php	2013-09-28 03:20:51.000000000 +0200
@@ -59,7 +59,7 @@
 
 	'DELETE_POSTS'			=> 'Delete posts',
 	'DELETE_USER'			=> 'Delete user',
-	'DELETE_USER_EXPLAIN'	=> 'Please note that deleting a user is final, they cannot be recovered.',
+	'DELETE_USER_EXPLAIN'	=> 'Please note that deleting a user is final, they cannot be recovered. Unread private messages sent by this user will be deleted and will not be available to their recipients.',
 
 	'FORCE_REACTIVATION_SUCCESS'	=> 'Successfully forced reactivation.',
 	'FOUNDER'						=> 'Founder',
@@ -124,6 +124,7 @@
 	'USER_GROUP_SPECIAL'			=> 'Pre-defined groups user is a member of',
 	'USER_LIFTED_NR'				=> 'Successfully removed the users newly registered status.',
 	'USER_NO_ATTACHMENTS'			=> 'There are no attached files to display.',
+	'USER_NO_POSTS_TO_DELETE'			=> 'The user has no posts to retain or delete.',
 	'USER_OUTBOX_EMPTIED'			=> 'Successfully emptied users private message outbox.',
 	'USER_OUTBOX_EMPTY'				=> 'The users private message outbox was already empty.',
 	'USER_OVERVIEW_UPDATED'			=> 'User details updated.',
diff -ruN phpBB-3.0.10/language/en/common.php phpbb/language/en/common.php
--- phpBB-3.0.10/language/en/common.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/language/en/common.php	2013-09-28 03:20:51.000000000 +0200
@@ -160,6 +160,7 @@
 	'EDIT_POST'							=> 'Edit post',
 	'EMAIL'								=> 'E-mail', // Short form for EMAIL_ADDRESS
 	'EMAIL_ADDRESS'						=> 'E-mail address',
+	'EMAIL_INVALID_EMAIL'				=> 'The e-mail address you entered is invalid.',
 	'EMAIL_SMTP_ERROR_RESPONSE'			=> 'Ran into problems sending e-mail at <strong>Line %1$s</strong>. Response: %2$s.',
 	'EMPTY_SUBJECT'						=> 'You must specify a subject when posting a new topic.',
 	'EMPTY_MESSAGE_SUBJECT'				=> 'You must specify a subject when composing a new message.',
@@ -171,8 +172,8 @@
 	'ERR_JAB_AUTH'						=> 'Could not authorise on Jabber server.',
 	'ERR_JAB_CONNECT'					=> 'Could not connect to Jabber server.',
 	'ERR_UNABLE_TO_LOGIN'				=> 'The specified username or password is incorrect.',
-	'ERR_UNWATCHING'					=> 'An error occured while trying to unsubscribe.',
-	'ERR_WATCHING'						=> 'An error occured while trying to subscribe.',
+	'ERR_UNWATCHING'					=> 'An error occurred while trying to unsubscribe.',
+	'ERR_WATCHING'						=> 'An error occurred while trying to subscribe.',
 	'ERR_WRONG_PATH_TO_PHPBB'			=> 'The phpBB path specified appears to be invalid.',
 	'EXPAND_VIEW'						=> 'Expand view',
 	'EXTENSION'							=> 'Extension',
@@ -191,7 +192,7 @@
 	'FORM_INVALID'			=> 'The submitted form was invalid. Try submitting again.',
 	'FORUM'					=> 'Forum',
 	'FORUMS'				=> 'Forums',
-	'FORUMS_MARKED'			=> 'The selected forums have been marked read.',
+	'FORUMS_MARKED'			=> 'Forums have been marked read.',
 	'FORUM_CAT'				=> 'Forum category',
 	'FORUM_INDEX'			=> 'Board index',
 	'FORUM_LINK'			=> 'Forum link',
@@ -297,7 +298,7 @@
 	'LAST_VISIT'						=> 'Last visit',
 	'LDAP_NO_LDAP_EXTENSION'			=> 'LDAP extension not available.',
 	'LDAP_NO_SERVER_CONNECTION'			=> 'Could not connect to LDAP server.',
-	'LDAP_SEARCH_FAILED'				=> 'An error occured while searching the LDAP directory.',
+	'LDAP_SEARCH_FAILED'				=> 'An error occurred while searching the LDAP directory.',
 	'LEGEND'							=> 'Legend',
 	'LOCATION'							=> 'Location',
 	'LOCK_POST'							=> 'Lock post',
@@ -390,6 +391,7 @@
 	'NO_POSTS_TIME_FRAME'		=> 'No posts exist inside this topic for the selected time frame.',
 	'NO_FEED_ENABLED'			=> 'Feeds are not available on this board.',
 	'NO_FEED'					=> 'The requested feed is not available.',
+	'NO_STYLE_DATA'				=> 'Could not get style data',
 	'NO_SUBJECT'				=> 'No subject specified',								// Used for posts having no subject defined but displayed within management pages.
 	'NO_SUCH_SEARCH_MODULE'		=> 'The specified search backend doesnt exist.',
 	'NO_SUPPORTED_AUTH_METHODS'	=> 'No supported authentication methods.',
@@ -450,6 +452,7 @@
 	'POST_TIME'				=> 'Post time',
 	'POST_TOPIC'			=> 'Post a new topic',
 	'POST_UNAPPROVED'		=> 'This post is waiting for approval',
+	'POWERED_BY'			=> 'Powered by %s',
 	'PREVIEW'				=> 'Preview',
 	'PREVIOUS'				=> 'Previous',		// Used in pagination
 	'PREVIOUS_STEP'			=> 'Previous',
@@ -459,6 +462,7 @@
 	'PRIVATE_MESSAGING'		=> 'Private messaging',
 	'PROFILE'				=> 'User Control Panel',
 
+	'RANK'						=> 'Rank',
 	'READING_FORUM'				=> 'Viewing topics in %s',
 	'READING_GLOBAL_ANNOUNCE'	=> 'Reading global announcement',
 	'READING_LINK'				=> 'Following forum link %s',
@@ -566,9 +570,11 @@
 	'SUBJECT'					=> 'Subject',
 	'SUBMIT'					=> 'Submit',
 
+	'TB'				=> 'TB',
 	'TERMS_USE'			=> 'Terms of use',
 	'TEST_CONNECTION'	=> 'Test connection',
 	'THE_TEAM'			=> 'The team',
+	'TIB'				=> 'TiB',
 	'TIME'				=> 'Time',
 	
 	'TOO_LARGE'						=> 'The value you entered is too large.',
@@ -716,6 +722,7 @@
 	'WHO_IS_ONLINE'		=> 'Who is online',
 	'WRONG_PASSWORD'	=> 'You entered an incorrect password.',
 
+	'WRONG_DATA_COLOUR'			=> 'The colour value you entered is invalid.',
 	'WRONG_DATA_ICQ'			=> 'The number you entered is not a valid ICQ number.',
 	'WRONG_DATA_JABBER'			=> 'The name you entered is not a valid Jabber account name.',
 	'WRONG_DATA_LANG'			=> 'The language you specified is not valid.',
diff -ruN phpBB-3.0.10/language/en/email/forum_notify.txt phpbb/language/en/email/forum_notify.txt
--- phpBB-3.0.10/language/en/email/forum_notify.txt	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/language/en/email/forum_notify.txt	2013-09-28 03:20:51.000000000 +0200
@@ -2,7 +2,7 @@
 
 Hello {USERNAME},
 
-You are receiving this notification because you are watching the forum, "{FORUM_NAME}" at "{SITENAME}". This forum has received a new reply to the topic "{TOPIC_TITLE}" since your last visit. You can use the following link to view the last unread reply, no more notifications will be sent until you visit the topic.
+You are receiving this notification because you are watching the forum, "{FORUM_NAME}" at "{SITENAME}". This forum has received a new reply to the topic "{TOPIC_TITLE}"<!-- IF AUTHOR_NAME !== '' --> by {AUTHOR_NAME}<!-- ENDIF --> since your last visit. You can use the following link to view the last unread reply, no more notifications will be sent until you visit the topic.
 
 {U_NEWEST_POST}
 
diff -ruN phpBB-3.0.10/language/en/email/installed.txt phpbb/language/en/email/installed.txt
--- phpBB-3.0.10/language/en/email/installed.txt	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/language/en/email/installed.txt	2013-09-28 03:20:51.000000000 +0200
@@ -12,7 +12,7 @@
 Board URL: {U_BOARD}
 ----------------------------
 
-Useful information regarding the phpBB software can be found in the docs folder of your installation and on phpBB.com's support page - http://www.phpbb.com/support/
+Useful information regarding the phpBB software can be found in the docs folder of your installation and on phpBB.com's support page - https://www.phpbb.com/support/
 
 In order to keep your board safe and secure, we highly recommended keeping current with software releases. For your convenience, a mailing list is available at the page referenced above.
 
diff -ruN phpBB-3.0.10/language/en/email/newtopic_notify.txt phpbb/language/en/email/newtopic_notify.txt
--- phpBB-3.0.10/language/en/email/newtopic_notify.txt	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/language/en/email/newtopic_notify.txt	2013-09-28 03:20:51.000000000 +0200
@@ -2,7 +2,7 @@
 
 Hello {USERNAME},
 
-You are receiving this notification because you are watching the forum, "{FORUM_NAME}" at "{SITENAME}". This forum has received a new topic since your last visit, "{TOPIC_TITLE}". You can use the following link to view the forum, no more notifications will be sent until you visit the forum.
+You are receiving this notification because you are watching the forum, "{FORUM_NAME}" at "{SITENAME}". This forum has received a new topic<!-- IF AUTHOR_NAME !== '' --> by {AUTHOR_NAME}<!-- ENDIF --> since your last visit, "{TOPIC_TITLE}". You can use the following link to view the forum, no more notifications will be sent until you visit the forum.
 
 {U_FORUM}
 
diff -ruN phpBB-3.0.10/language/en/email/topic_notify.txt phpbb/language/en/email/topic_notify.txt
--- phpBB-3.0.10/language/en/email/topic_notify.txt	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/language/en/email/topic_notify.txt	2013-09-28 03:20:51.000000000 +0200
@@ -2,7 +2,7 @@
 
 Hello {USERNAME},
 
-You are receiving this notification because you are watching the topic, "{TOPIC_TITLE}" at "{SITENAME}". This topic has received a reply since your last visit. You can use the following link to view the replies made, no more notifications will be sent until you visit the topic.
+You are receiving this notification because you are watching the topic, "{TOPIC_TITLE}" at "{SITENAME}". This topic has received a reply<!-- IF AUTHOR_NAME !== '' --> by {AUTHOR_NAME}<!-- ENDIF --> since your last visit. You can use the following link to view the replies made, no more notifications will be sent until you visit the topic.
 
 If you want to view the newest post made since your last visit, click the following link:
 {U_NEWEST_POST}
diff -ruN phpBB-3.0.10/language/en/help_faq.php phpbb/language/en/help_faq.php
--- phpBB-3.0.10/language/en/help_faq.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/language/en/help_faq.php	2013-09-28 03:20:51.000000000 +0200
@@ -329,11 +329,11 @@
 	),
 	array(
 		0 => 'Who wrote this bulletin board?',
-		1 => 'This software (in its unmodified form) is produced, released and is copyright <a href="http://www.phpbb.com/">phpBB Group</a>. It is made available under the GNU General Public License and may be freely distributed. See the link for more details.'
+		1 => 'This software (in its unmodified form) is produced, released and is copyright <a href="https://www.phpbb.com/">phpBB Group</a>. It is made available under the GNU General Public License and may be freely distributed. See the link for more details.'
 	),
 	array(
 		0 => 'Why isnt X feature available?',
-		1 => 'This software was written by and licensed through phpBB Group. If you believe a feature needs to be added, please visit the phpbb.com website and see what phpBB Group have to say. Please do not post feature requests to the board at phpbb.com, the group uses SourceForge to handle tasking of new features. Please read through the forums and see what, if any, our position may already be for a feature and then follow the procedure given there.'
+		1 => 'This software was written by and licensed through phpBB Group. If you believe a feature needs to be added please visit the <a href="https://www.phpbb.com/ideas/">phpBB Ideas Centre</a>, where you can upvote existing ideas or suggest new features.'
 	),
 	array(
 		0 => 'Who do I contact about abusive and/or legal matters related to this board?',
diff -ruN phpBB-3.0.10/language/en/install.php phpbb/language/en/install.php
--- phpBB-3.0.10/language/en/install.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/language/en/install.php	2013-09-28 03:20:51.000000000 +0200
@@ -52,6 +52,7 @@
 	'BLANK_PREFIX_FOUND'			=> 'A scan of your tables has shown a valid installation using no table prefix.',
 	'BOARD_NOT_INSTALLED'			=> 'No installation found',
 	'BOARD_NOT_INSTALLED_EXPLAIN'	=> 'The phpBB Unified Convertor Framework requires a default installation of phpBB3 to function, please <a href="%s">proceed by first installing phpBB3</a>.',
+	'BACKUP_NOTICE'					=> 'Please backup your board before updating in case any problems arise during the update process.',
 
 	'CATEGORY'					=> 'Category',
 	'CACHE_STORE'				=> 'Cache type',
@@ -79,7 +80,7 @@
 	'CONTINUE_OLD_CONVERSION'	=> 'Continue previously started conversion',
 	'CONVERT'					=> 'Convert',
 	'CONVERT_COMPLETE'			=> 'Conversion completed',
-	'CONVERT_COMPLETE_EXPLAIN'	=> 'You have now successfully converted your board to phpBB 3.0. You can now login and <a href="../">access your board</a>. Please ensure that the settings were transferred correctly before enabling your board by deleting the install directory. Remember that help on using phpBB is available online via the <a href="http://www.phpbb.com/support/documentation/3.0/">Documentation</a> and the <a href="http://www.phpbb.com/community/viewforum.php?f=46">support forums</a>.',
+	'CONVERT_COMPLETE_EXPLAIN'	=> 'You have now successfully converted your board to phpBB 3.0. You can now login and <a href="../">access your board</a>. Please ensure that the settings were transferred correctly before enabling your board by deleting the install directory. Remember that help on using phpBB is available online via the <a href="https://www.phpbb.com/support/documentation/3.0/">Documentation</a> and the <a href="https://www.phpbb.com/community/viewforum.php?f=46">support forums</a>.',
 	'CONVERT_INTRO'				=> 'Welcome to the phpBB Unified Convertor Framework',
 	'CONVERT_INTRO_BODY'		=> 'From here, you are able to import data from other (installed) board systems. The list below shows all the conversion modules currently available. If there is no convertor shown in this list for the board software you wish to convert from, please check our website where further conversion modules may be available for download.',
 	'CONVERT_NEW_CONVERSION'	=> 'New conversion',
@@ -193,7 +194,7 @@
 		<h2>Convert an existing board to phpBB3</h2>
 		<p>The phpBB Unified Convertor Framework supports the conversion of phpBB 2.0.x and other board systems to phpBB3. If you have an existing board that you wish to convert, please <a href="%2$s">proceed to the convertor</a>.</p>
 		<h2>Go live with your phpBB3!</h2>
-		<p>Clicking the button below will take you to a form for submitting statistical data to phpBB in your Administration Control Panel (ACP). We would appreciate it if you could help us by sending that information. Afterwards you should take some time to examine the options available to you. Remember that help is available online via the <a href="http://www.phpbb.com/support/documentation/3.0/">Documentation</a>, <a href="%3$s">README</a> and the <a href="http://www.phpbb.com/community/viewforum.php?f=46">Support Forums</a>.</p><p><strong>Please delete, move or rename the install directory before using your board. While this directory exists, only the Administration Control Panel (ACP) will be accessible.</strong>',
+		<p>Clicking the button below will take you to a form for submitting statistical data to phpBB in your Administration Control Panel (ACP). We would appreciate it if you could help us by sending that information. Afterwards you should take some time to examine the options available to you. Remember that help is available online via the <a href="https://www.phpbb.com/support/documentation/3.0/">Documentation</a>, <a href="%3$s">README</a> and the <a href="https://www.phpbb.com/community/viewforum.php?f=46">Support Forums</a>.</p><p><strong>Please delete, move or rename the install directory before using your board. While this directory exists, only the Administration Control Panel (ACP) will be accessible.</strong>',
 	'INSTALL_INTRO'				=> 'Welcome to Installation',
 
 	'INSTALL_INTRO_BODY'		=> 'With this option, it is possible to install phpBB3 onto your server.</p><p>In order to proceed, you will need your database settings. If you do not know your database settings, please contact your host and ask for them. You will not be able to continue without them. You need:</p>
@@ -276,7 +277,7 @@
 	'MAKE_FOLDER_WRITABLE'		=> 'Please make sure that this folder exists and is writable by the webserver then try again:<br /><strong>%s</strong>.',
 	'MAKE_FOLDERS_WRITABLE'		=> 'Please make sure that these folders exist and are writable by the webserver then try again:<br /><strong>%s</strong>.',
 
-	'MYSQL_SCHEMA_UPDATE_REQUIRED'	=> 'Your MySQL database schema for phpBB is outdated. phpBB detected a schema for MySQL 3.x/4.x, but the server runs on MySQL %2$s.<br /><strong>Before you proceed the update, you need to upgrade the schema.</strong><br /><br />Please refer to the <a href="http://www.phpbb.com/kb/article/doesnt-have-a-default-value-errors/">Knowledge Base article about upgrading the MySQL schema</a>. If you encounter problems, please use <a href="http://www.phpbb.com/community/viewforum.php?f=46">our support forums</a>.',
+	'MYSQL_SCHEMA_UPDATE_REQUIRED'	=> 'Your MySQL database schema for phpBB is outdated. phpBB detected a schema for MySQL 3.x/4.x, but the server runs on MySQL %2$s.<br /><strong>Before you proceed the update, you need to upgrade the schema.</strong><br /><br />Please refer to the <a href="https://www.phpbb.com/kb/article/doesnt-have-a-default-value-errors/">Knowledge Base article about upgrading the MySQL schema</a>. If you encounter problems, please use <a href="https://www.phpbb.com/community/viewforum.php?f=46">our support forums</a>.',
 
 	'NAMING_CONFLICT'			=> 'Naming conflict: %s and %s are both aliases<br /><br />%s',
 	'NEXT_STEP'					=> 'Proceed to next step',
@@ -287,7 +288,7 @@
 	'NO_LOCATION'				=> 'Cannot determine location. If you know Imagemagick is installed, you may specify the location later within your administration control panel',
 	'NO_TABLES_FOUND'			=> 'No tables found.',
 
-	'OVERVIEW_BODY'				=> 'Welcome to phpBB3!<br /><br />phpBB is the most widely used open source bulletin board solution in the world. phpBB3 is the latest installment in a package line started in 2000. Like its predecessors, phpBB3 is feature-rich, user-friendly, and fully supported by the phpBB Team. phpBB3 greatly improves on what made phpBB2 popular, and adds commonly requested features that were not present in previous versions. We hope it exceeds your expectations.<br /><br />This installation system will guide you through installing phpBB3, updating to the latest version of phpBB3 from past releases, as well as converting to phpBB3 from a different discussion board system (including phpBB2). For more information, we encourage you to read <a href="../docs/INSTALL.html">the installation guide</a>.<br /><br />To read the phpBB3 license or learn about obtaining support and our stance on it, please select the respective options from the side menu. To continue, please select the appropriate tab above.',
+	'OVERVIEW_BODY'				=> 'Welcome to phpBB3!<br /><br />phpBB is the most widely used open source bulletin board solution in the world. phpBB3 is the latest installment in a package line started in 2000. Like its predecessors, phpBB3 is feature-rich, user-friendly, and fully supported by the phpBB Team. phpBB3 greatly improves on what made phpBB2 popular, and adds commonly requested features that were not present in previous versions. We hope it exceeds your expectations.<br /><br />This installation system will guide you through installing phpBB3, updating to the latest version of phpBB3 from past releases, as well as converting to phpBB3 from a different discussion board system (including phpBB2). For more information, we encourage you to read <a href="../docs/INSTALL.html">the installation guide</a>.<br /><br />To read the phpBB3 license or learn about obtaining support and our stance on it, please select the respective options from the side menu. To continue, please select the appropriate tab above.',
 
 	'PCRE_UTF_SUPPORT'				=> 'PCRE UTF-8 support',
 	'PCRE_UTF_SUPPORT_EXPLAIN'		=> 'phpBB will <strong>not</strong> run if your PHP installation is not compiled with UTF-8 support in the PCRE extension.',
@@ -344,7 +345,7 @@
 	'SUB_LICENSE'				=> 'License',
 	'SUB_SUPPORT'				=> 'Support',
 	'SUCCESSFUL_CONNECT'		=> 'Successful connection',
-	'SUPPORT_BODY'				=> 'Full support will be provided for the current stable release of phpBB3, free of charge. This includes:</p><ul><li>installation</li><li>configuration</li><li>technical questions</li><li>problems relating to potential bugs in the software</li><li>updating from Release Candidate (RC) versions to the latest stable version</li><li>converting from phpBB 2.0.x to phpBB3</li><li>converting from other discussion board software to phpBB3 (please see the <a href="http://www.phpbb.com/community/viewforum.php?f=65">Convertors Forum</a>)</li></ul><p>We encourage users still running beta versions of phpBB3 to replace their installation with a fresh copy of the latest version.</p><h2>MODs / Styles</h2><p>For issues relating to MODs, please post in the appropriate <a href="http://www.phpbb.com/community/viewforum.php?f=81">Modifications Forum</a>.<br />For issues relating to styles, templates and imagesets, please post in the appropriate <a href="http://www.phpbb.com/community/viewforum.php?f=80">Styles Forum</a>.<br /><br />If your question relates to a specific package, please post directly in the topic dedicated to the package.</p><h2>Obtaining Support</h2><p><a href="http://www.phpbb.com/community/viewtopic.php?f=14&amp;t=571070">The phpBB Welcome Package</a><br /><a href="http://www.phpbb.com/support/">Support Section</a><br /><a href="http://www.phpbb.com/support/documentation/3.0/quickstart/">Quick Start Guide</a><br /><br />To ensure you stay up to date with the latest news and releases, why not <a href="http://www.phpbb.com/support/">subscribe to our mailing list</a>?<br /><br />',
+	'SUPPORT_BODY'				=> 'Full support will be provided for the current stable release of phpBB3, free of charge. This includes:</p><ul><li>installation</li><li>configuration</li><li>technical questions</li><li>problems relating to potential bugs in the software</li><li>updating from Release Candidate (RC) versions to the latest stable version</li><li>converting from phpBB 2.0.x to phpBB3</li><li>converting from other discussion board software to phpBB3 (please see the <a href="https://www.phpbb.com/community/viewforum.php?f=65">Convertors Forum</a>)</li></ul><p>We encourage users still running beta versions of phpBB3 to replace their installation with a fresh copy of the latest version.</p><h2>MODs / Styles</h2><p>For issues relating to MODs, please post in the appropriate <a href="https://www.phpbb.com/community/viewforum.php?f=81">Modifications Forum</a>.<br />For issues relating to styles, templates and imagesets, please post in the appropriate <a href="https://www.phpbb.com/community/viewforum.php?f=80">Styles Forum</a>.<br /><br />If your question relates to a specific package, please post directly in the topic dedicated to the package.</p><h2>Obtaining Support</h2><p><a href="https://www.phpbb.com/community/viewtopic.php?f=14&amp;t=571070">The phpBB Welcome Package</a><br /><a href="https://www.phpbb.com/support/">Support Section</a><br /><a href="https://www.phpbb.com/support/documentation/3.0/quickstart/">Quick Start Guide</a><br /><br />To ensure you stay up to date with the latest news and releases, why not <a href="https://www.phpbb.com/support/">subscribe to our mailing list</a>?<br /><br />',
 	'SYNC_FORUMS'				=> 'Starting to synchronise forums',
 	'SYNC_POST_COUNT'			=> 'Synchronising post_counts',
 	'SYNC_POST_COUNT_ID'		=> 'Synchronising post_counts from <var>entry</var> %1$s to %2$s.',
@@ -362,7 +363,7 @@
 	'UNAVAILABLE'				=> 'Unavailable',
 	'UNWRITABLE'				=> 'Unwritable',
 	'UPDATE_TOPICS_POSTED'		=> 'Generating topics posted information',
-	'UPDATE_TOPICS_POSTED_ERR'	=> 'An error occured while generating topics posted information. You can retry this step in the ACP after the conversion process is completed.',
+	'UPDATE_TOPICS_POSTED_ERR'	=> 'An error occurred while generating topics posted information. You can retry this step in the ACP after the conversion process is completed.',
 	'VERIFY_OPTIONS'			=> 'Verifying conversion options',
 	'VERSION'					=> 'Version',
 
@@ -467,7 +468,7 @@
 	'NO_ERRORS'						=> 'No errors',
 	'NO_UPDATE_FILES'				=> 'Not updating the following files',
 	'NO_UPDATE_FILES_EXPLAIN'		=> 'The following files are new or modified but the directory they normally reside in could not be found on your installation. If this list contains files to other directories than language/ or styles/ than you may have modified your directory structure and the update may be incomplete.',
-	'NO_UPDATE_FILES_OUTDATED'		=> 'No valid update directory was found, please make sure you uploaded the relevant files.<br /><br />Your installation does <strong>not</strong> seem to be up to date. Updates are available for your version of phpBB %1$s, please visit <a href="http://www.phpbb.com/downloads/" rel="external">http://www.phpbb.com/downloads/</a> to obtain the correct package to update from Version %2$s to Version %3$s.',
+	'NO_UPDATE_FILES_OUTDATED'		=> 'No valid update directory was found, please make sure you uploaded the relevant files.<br /><br />Your installation does <strong>not</strong> seem to be up to date. Updates are available for your version of phpBB %1$s, please visit <a href="https://www.phpbb.com/downloads/" rel="external">https://www.phpbb.com/downloads/</a> to obtain the correct package to update from Version %2$s to Version %3$s.',
 	'NO_UPDATE_FILES_UP_TO_DATE'	=> 'Your version is up to date. There is no need to run the update tool. If you want to make an integrity check on your files make sure you uploaded the correct update files.',
 	'NO_UPDATE_INFO'				=> 'Update file information could not be found.',
 	'NO_UPDATES_REQUIRED'			=> 'No updates required',
@@ -535,7 +536,7 @@
 		<p>The recommended way of updating your installation listed here is only valid for the automatic update package. You are also able to update your installation using the methods listed within the INSTALL.html document. The steps for updating phpBB3 automatically are:</p>
 
 		<ul style="margin-left: 20px; font-size: 1.1em;">
-			<li>Go to the <a href="http://www.phpbb.com/downloads/" title="http://www.phpbb.com/downloads/">phpBB.com downloads page</a> and download the "Automatic Update Package" archive.<br /><br /></li>
+			<li>Go to the <a href="https://www.phpbb.com/downloads/" title="https://www.phpbb.com/downloads/">phpBB.com downloads page</a> and download the "Automatic Update Package" archive.<br /><br /></li>
 			<li>Unpack the archive.<br /><br /></li>
 			<li>Upload the complete uncompressed install folder to your phpBB root directory (where your config.php file is).<br /><br /></li>
 		</ul>
diff -ruN phpBB-3.0.10/language/en/memberlist.php phpbb/language/en/memberlist.php
--- phpBB-3.0.10/language/en/memberlist.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/language/en/memberlist.php	2013-09-28 03:20:51.000000000 +0200
@@ -110,7 +110,6 @@
 
 	'POST_IP'				=> 'Posted from IP/domain',
 
-	'RANK'					=> 'Rank',
 	'REAL_NAME'				=> 'Recipient name',
 	'RECIPIENT'				=> 'Recipient',
 	'REMOVE_FOE'			=> 'Remove foe',
diff -ruN phpBB-3.0.10/language/en/posting.php phpbb/language/en/posting.php
--- phpBB-3.0.10/language/en/posting.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/language/en/posting.php	2013-09-28 03:20:51.000000000 +0200
@@ -42,6 +42,7 @@
 	'ADD_POLL'					=> 'Poll creation',
 	'ADD_POLL_EXPLAIN'			=> 'If you do not want to add a poll to your topic leave the fields blank.',
 	'ALREADY_DELETED'			=> 'Sorry but this message is already deleted.',
+	'ATTACH_DISK_FULL'			=> 'There is not enough free disk space to post this attachment.',
 	'ATTACH_QUOTA_REACHED'		=> 'Sorry, the board attachment quota has been reached.',
 	'ATTACH_SIG'				=> 'Attach a signature (signatures can be altered via the UCP)',
 
@@ -53,9 +54,9 @@
 	'BBCODE_IS_OFF'				=> '%sBBCode%s is <em>OFF</em>',
 	'BBCODE_IS_ON'				=> '%sBBCode%s is <em>ON</em>',
 	'BBCODE_I_HELP'				=> 'Italic text: [i]text[/i]',
-	'BBCODE_L_HELP'				=> 'List: [list]text[/list]',
-	'BBCODE_LISTITEM_HELP'		=> 'List item: [*]text[/*]',
-	'BBCODE_O_HELP'				=> 'Ordered list: [list=]text[/list]',
+	'BBCODE_L_HELP'				=> 'List: [list][*]text[/list]', 
+	'BBCODE_LISTITEM_HELP'		=> 'List item: [*]text',
+	'BBCODE_O_HELP'				=> 'Ordered list: e.g. [list=1][*]First point[/list] or [list=a][*]Point a[/list]',
 	'BBCODE_P_HELP'				=> 'Insert image: [img]http://image_url[/img]',
 	'BBCODE_Q_HELP'				=> 'Quote text: [quote]text[/quote]',
 	'BBCODE_S_HELP'				=> 'Font colour: [color=red]text[/color]  Tip: you can also use color=#FF0000',
diff -ruN phpBB-3.0.10/language/en/search.php phpbb/language/en/search.php
--- phpBB-3.0.10/language/en/search.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/language/en/search.php	2013-09-28 03:20:51.000000000 +0200
@@ -77,6 +77,7 @@
 
 	'SEARCHED_FOR'				=> 'Search term used',
 	'SEARCHED_TOPIC'			=> 'Searched topic',
+	'SEARCHED_QUERY'			=> 'Searched query',
 	'SEARCH_ALL_TERMS'			=> 'Search for all terms or use query as entered',
 	'SEARCH_ANY_TERMS'			=> 'Search for any terms',
 	'SEARCH_AUTHOR'				=> 'Search for author',
diff -ruN phpBB-3.0.10/language/en/ucp.php phpbb/language/en/ucp.php
--- phpBB-3.0.10/language/en/ucp.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/language/en/ucp.php	2013-09-28 03:20:51.000000000 +0200
@@ -39,7 +39,7 @@
 $lang = array_merge($lang, array(
 	'TERMS_OF_USE_CONTENT'	=> 'By accessing %1$s (hereinafter we, us, our, %1$s, %2$s), you agree to be legally bound by the following terms. If you do not agree to be legally bound by all of the following terms then please do not access and/or use %1$s. We may change these at any time and well do our utmost in informing you, though it would be prudent to review this regularly yourself as your continued usage of %1$s after changes mean you agree to be legally bound by these terms as they are updated and/or amended.<br />
 	<br />
-	Our forums are powered by phpBB (hereinafter they, them, their, phpBB software, www.phpbb.com, phpBB Group, phpBB Teams) which is a bulletin board solution released under the <a href="http://opensource.org/licenses/gpl-license.php">General Public License</a> (hereinafter GPL) and can be downloaded from <a href="http://www.phpbb.com/">www.phpbb.com</a>. The phpBB software only facilitates internet based discussions, the phpBB Group are not responsible for what we allow and/or disallow as permissible content and/or conduct. For further information about phpBB, please see: <a href="http://www.phpbb.com/">http://www.phpbb.com/</a>.<br />
+	Our forums are powered by phpBB (hereinafter they, them, their, phpBB software, www.phpbb.com, phpBB Group, phpBB Teams) which is a bulletin board solution released under the <a href="http://opensource.org/licenses/gpl-license.php">General Public License</a> (hereinafter GPL) and can be downloaded from <a href="https://www.phpbb.com/">www.phpbb.com</a>. The phpBB software only facilitates internet based discussions, the phpBB Group are not responsible for what we allow and/or disallow as permissible content and/or conduct. For further information about phpBB, please see: <a href="https://www.phpbb.com/">https://www.phpbb.com/</a>.<br />
 	<br />
 	You agree not to post any abusive, obscene, vulgar, slanderous, hateful, threatening, sexually-orientated or any other material that may violate any laws be it of your country, the country where %1$s is hosted or International Law. Doing so may lead to you being immediately and permanently banned, with notification of your Internet Service Provider if deemed required by us. The IP address of all posts are recorded to aid in enforcing these conditions. You agree that %1$s have the right to remove, edit, move or close any topic at any time should we see fit. As a user you agree to any information you have entered to being stored in a database. While this information will not be disclosed to any third party without your consent, neither %1$s nor phpBB shall be held responsible for any hacking attempt that may lead to the data being compromised.
 	',
@@ -137,7 +137,8 @@
 	'CREATE_FOLDER'				=> 'Add folder',
 	'CURRENT_IMAGE'				=> 'Current image',
 	'CURRENT_PASSWORD'			=> 'Current password',
-	'CURRENT_PASSWORD_EXPLAIN'	=> 'You must confirm your current password if you wish to change it, alter your e-mail address or username.',
+	'CURRENT_PASSWORD_EXPLAIN'	=> 'You must enter your current password if you wish to alter your email address or username.',
+	'CURRENT_CHANGE_PASSWORD_EXPLAIN' => 'To change your password, your email address, or your username, you must enter your current password.',
 	'CUR_PASSWORD_EMPTY'		=> 'You did not enter your current password.',
 	'CUR_PASSWORD_ERROR'		=> 'The current password you entered is incorrect.',
 	'CUSTOM_DATEFORMAT'			=> 'Custom',
@@ -175,7 +176,6 @@
 
 	'EDIT_DRAFT_EXPLAIN'		=> 'Here you are able to edit your draft. Drafts do not contain attachment and poll information.',
 	'EMAIL_BANNED_EMAIL'		=> 'The e-mail address you entered is not allowed to be used.',
-	'EMAIL_INVALID_EMAIL'		=> 'The e-mail address you entered is invalid.',
 	'EMAIL_REMIND'				=> 'This must be the e-mail address associated with your account. If you have not changed this via your user control panel then it is the e-mail address you registered your account with.',
 	'EMAIL_TAKEN_EMAIL'			=> 'The entered e-mail address is already in use.',
 	'EMPTY_DRAFT'				=> 'You must enter a message to submit your changes.',
@@ -256,8 +256,9 @@
 	'MESSAGE_BY_AUTHOR'				=> 'by',
 	'MESSAGE_COLOURS'				=> 'Message colours',
 	'MESSAGE_DELETED'				=> 'Message successfully deleted.',
+	'MESSAGE_EDITED'				=> 'Message successfully edited.',
 	'MESSAGE_HISTORY'				=> 'Message history',
-	'MESSAGE_REMOVED_FROM_OUTBOX'	=> 'This message has been removed by its author before it was delivered.',
+	'MESSAGE_REMOVED_FROM_OUTBOX'	=> 'This message was deleted by its author.',
 	'MESSAGE_SENT_ON'				=> 'on',
 	'MESSAGE_STORED'				=> 'This message has been sent successfully.',
 	'MESSAGE_TO'					=> 'To',
@@ -387,6 +388,7 @@
 	'RULE_ADDED'						=> 'Rule successfully added.',
 	'RULE_ALREADY_DEFINED'				=> 'This rule was defined previously.',
 	'RULE_DELETED'						=> 'Rule successfully removed.',
+	'RULE_LIMIT_REACHED'				=> 'You cannot add more PM rules. You have reached the maximum number of rules.',
 	'RULE_NOT_DEFINED'					=> 'Rule not correctly specified.',
 	'RULE_REMOVED_MESSAGE'				=> 'One private message had been removed due to private message filters.',
 	'RULE_REMOVED_MESSAGES'				=> '%d private messages were removed due to private message filters.',
diff -ruN phpBB-3.0.10/memberlist.php phpbb/memberlist.php
--- phpBB-3.0.10/memberlist.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/memberlist.php	2013-09-28 03:20:51.000000000 +0200
@@ -62,11 +62,6 @@
 $sort_key = request_var('sk', $default_key);
 $sort_dir = request_var('sd', 'a');
 
-
-// Grab rank information for later
-$ranks = $cache->obtain_ranks();
-
-
 // What do you want to do today? ... oops, I think that line is taken ...
 switch ($mode)
 {
@@ -1221,21 +1216,16 @@
 			// Misusing the avatar function for displaying group avatars...
 			$avatar_img = get_user_avatar($group_row['group_avatar'], $group_row['group_avatar_type'], $group_row['group_avatar_width'], $group_row['group_avatar_height'], 'GROUP_AVATAR');
 
+			// ... same for group rank
 			$rank_title = $rank_img = $rank_img_src = '';
 			if ($group_row['group_rank'])
 			{
-				if (isset($ranks['special'][$group_row['group_rank']]))
+				get_user_rank($group_row['group_rank'], false, $rank_title, $rank_img, $rank_img_src);
+
+				if ($rank_img)
 				{
-					$rank_title = $ranks['special'][$group_row['group_rank']]['rank_title'];
+					$rank_img .= '<br />';
 				}
-				$rank_img = (!empty($ranks['special'][$group_row['group_rank']]['rank_image'])) ? '<img src="' . $config['ranks_path'] . '/' . $ranks['special'][$group_row['group_rank']]['rank_image'] . '" alt="' . $ranks['special'][$group_row['group_rank']]['rank_title'] . '" title="' . $ranks['special'][$group_row['group_rank']]['rank_title'] . '" /><br />' : '';
-				$rank_img_src = (!empty($ranks['special'][$group_row['group_rank']]['rank_image'])) ? $config['ranks_path'] . '/' . $ranks['special'][$group_row['group_rank']]['rank_image'] : '';
-			}
-			else
-			{
-				$rank_title = '';
-				$rank_img = '';
-				$rank_img_src = '';
 			}
 
 			$template->assign_vars(array(
@@ -1346,6 +1336,7 @@
 		if ($mode)
 		{
 			$params[] = "mode=$mode";
+			$u_first_char_params[] = "mode=$mode";
 		}
 		$sort_params[] = "mode=$mode";
 
diff -ruN phpBB-3.0.10/mobiquo/config/config.php phpbb/mobiquo/config/config.php
--- phpBB-3.0.10/mobiquo/config/config.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/config/config.php	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,51 @@
+<?php
+/**
+*
+* @copyright (c) 2009 Quoord Systems Limited
+* @license http://opensource.org/licenses/gpl-license.php GNU Public License
+*
+*/
+
+defined('IN_MOBIQUO') or exit;
+
+foreach($_COOKIE as $key => $value) $_REQUEST[$key] = $value;
+
+$mobiquo_config = get_mobiquo_config();
+$phpEx = $mobiquo_config['php_extension'];
+$phpbb_root_path = dirname(dirname(dirname(__FILE__))).'/';
+
+function get_mobiquo_config() 
+{
+    $config_file = './config/config.txt';
+    file_exists($config_file) or exit('config.txt does not exists');
+    
+    if(function_exists('file_get_contents')){
+        $tmp = file_get_contents($config_file);
+    }else{
+        $handle = fopen($config_file, 'rb');
+        $tmp = fread($handle, filesize($config_file));
+        fclose($handle);
+    }
+    
+    // remove comments by /*xxxx*/ or //xxxx
+    $tmp = preg_replace('/\/\*.*?\*\/|\/\/.*?(\n)/si','$1',$tmp);
+    $tmpData = preg_split("/\s*\n/", $tmp, -1, PREG_SPLIT_NO_EMPTY);
+    
+    $mobiquo_config = array();
+    foreach ($tmpData as $d){
+        list($key, $value) = preg_split("/=/", $d, 2); // value string may also have '='
+        $key = trim($key);
+        $value = trim($value);
+        if ($key == 'hide_forum_id')
+        {
+            $value = preg_split('/\s*,\s*/', $value, -1, PREG_SPLIT_NO_EMPTY);
+            count($value) and $mobiquo_config[$key] = $value;
+        }
+        else
+        {
+            strlen($value) and $mobiquo_config[$key] = $value;
+        }
+    }
+    
+    return $mobiquo_config;
+}
diff -ruN phpBB-3.0.10/mobiquo/config/config.txt phpbb/mobiquo/config/config.txt
--- phpBB-3.0.10/mobiquo/config/config.txt	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/config/config.txt	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,41 @@
+api_level = 3
+version = pb30_3.3.1
+is_open = 1
+guest_okay = 1
+
+php_extension = php
+reg_url = ucp.php?mode=register
+
+hide_forum_id =
+
+check_dnsbl = 1
+
+disable_search = 0
+disable_latest = 0
+disable_bbcode = 0
+
+report_post = 1
+report_pm = 1
+mark_read = 1
+mark_forum = 1
+goto_unread = 1
+goto_post = 1
+get_latest_topic = 1
+no_refresh_on_post = 1
+get_id_by_url = 1
+
+mod_approve = 1
+mod_delete = 0
+mod_report = 1
+
+soft_delete = 0
+delete_reason = 0
+
+emoji = 1
+user_id = 1
+multi_quote = 1
+pm_load = 1
+subscribe_load = 1
+participated_forum = 1
+anonymous = 1
+advanced_search = 1
\ No newline at end of file
diff -ruN phpBB-3.0.10/mobiquo/config/index.html phpbb/mobiquo/config/index.html
--- phpBB-3.0.10/mobiquo/config/index.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/config/index.html	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,8 @@
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
+<HTML>
+ <HEAD>
+  <TITLE>Redirecting...</TITLE>
+<meta HTTP-EQUIV="REFRESH" content="0; url=/"> </HEAD>
+<BODY>  
+</BODY>
+</HTML>
Binary files phpBB-3.0.10/mobiquo/emoji/E001.png and phpbb/mobiquo/emoji/E001.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E002.png and phpbb/mobiquo/emoji/E002.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E003.png and phpbb/mobiquo/emoji/E003.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E004.png and phpbb/mobiquo/emoji/E004.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E005.png and phpbb/mobiquo/emoji/E005.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E006.png and phpbb/mobiquo/emoji/E006.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E007.png and phpbb/mobiquo/emoji/E007.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E008.png and phpbb/mobiquo/emoji/E008.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E009.png and phpbb/mobiquo/emoji/E009.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E00A.png and phpbb/mobiquo/emoji/E00A.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E00B.png and phpbb/mobiquo/emoji/E00B.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E00C.png and phpbb/mobiquo/emoji/E00C.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E00D.png and phpbb/mobiquo/emoji/E00D.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E00E.png and phpbb/mobiquo/emoji/E00E.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E00F.png and phpbb/mobiquo/emoji/E00F.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E010.png and phpbb/mobiquo/emoji/E010.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E011.png and phpbb/mobiquo/emoji/E011.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E012.png and phpbb/mobiquo/emoji/E012.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E013.png and phpbb/mobiquo/emoji/E013.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E014.png and phpbb/mobiquo/emoji/E014.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E015.png and phpbb/mobiquo/emoji/E015.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E016.png and phpbb/mobiquo/emoji/E016.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E017.png and phpbb/mobiquo/emoji/E017.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E018.png and phpbb/mobiquo/emoji/E018.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E019.png and phpbb/mobiquo/emoji/E019.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E01A.png and phpbb/mobiquo/emoji/E01A.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E01B.png and phpbb/mobiquo/emoji/E01B.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E01C.png and phpbb/mobiquo/emoji/E01C.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E01D.png and phpbb/mobiquo/emoji/E01D.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E01E.png and phpbb/mobiquo/emoji/E01E.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E01F.png and phpbb/mobiquo/emoji/E01F.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E020.png and phpbb/mobiquo/emoji/E020.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E021.png and phpbb/mobiquo/emoji/E021.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E022.png and phpbb/mobiquo/emoji/E022.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E023.png and phpbb/mobiquo/emoji/E023.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E024.png and phpbb/mobiquo/emoji/E024.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E025.png and phpbb/mobiquo/emoji/E025.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E026.png and phpbb/mobiquo/emoji/E026.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E027.png and phpbb/mobiquo/emoji/E027.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E028.png and phpbb/mobiquo/emoji/E028.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E029.png and phpbb/mobiquo/emoji/E029.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E02A.png and phpbb/mobiquo/emoji/E02A.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E02B.png and phpbb/mobiquo/emoji/E02B.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E02C.png and phpbb/mobiquo/emoji/E02C.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E02D.png and phpbb/mobiquo/emoji/E02D.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E02E.png and phpbb/mobiquo/emoji/E02E.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E02F.png and phpbb/mobiquo/emoji/E02F.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E030.png and phpbb/mobiquo/emoji/E030.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E031.png and phpbb/mobiquo/emoji/E031.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E032.png and phpbb/mobiquo/emoji/E032.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E033.png and phpbb/mobiquo/emoji/E033.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E034.png and phpbb/mobiquo/emoji/E034.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E035.png and phpbb/mobiquo/emoji/E035.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E036.png and phpbb/mobiquo/emoji/E036.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E037.png and phpbb/mobiquo/emoji/E037.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E038.png and phpbb/mobiquo/emoji/E038.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E039.png and phpbb/mobiquo/emoji/E039.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E03A.png and phpbb/mobiquo/emoji/E03A.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E03B.png and phpbb/mobiquo/emoji/E03B.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E03C.png and phpbb/mobiquo/emoji/E03C.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E03D.png and phpbb/mobiquo/emoji/E03D.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E03E.png and phpbb/mobiquo/emoji/E03E.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E03F.png and phpbb/mobiquo/emoji/E03F.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E040.png and phpbb/mobiquo/emoji/E040.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E041.png and phpbb/mobiquo/emoji/E041.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E042.png and phpbb/mobiquo/emoji/E042.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E043.png and phpbb/mobiquo/emoji/E043.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E044.png and phpbb/mobiquo/emoji/E044.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E045.png and phpbb/mobiquo/emoji/E045.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E046.png and phpbb/mobiquo/emoji/E046.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E047.png and phpbb/mobiquo/emoji/E047.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E048.png and phpbb/mobiquo/emoji/E048.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E049.png and phpbb/mobiquo/emoji/E049.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E04A.png and phpbb/mobiquo/emoji/E04A.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E04B.png and phpbb/mobiquo/emoji/E04B.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E04C.png and phpbb/mobiquo/emoji/E04C.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E04D.png and phpbb/mobiquo/emoji/E04D.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E04E.png and phpbb/mobiquo/emoji/E04E.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E04F.png and phpbb/mobiquo/emoji/E04F.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E050.png and phpbb/mobiquo/emoji/E050.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E051.png and phpbb/mobiquo/emoji/E051.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E052.png and phpbb/mobiquo/emoji/E052.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E053.png and phpbb/mobiquo/emoji/E053.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E054.png and phpbb/mobiquo/emoji/E054.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E055.png and phpbb/mobiquo/emoji/E055.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E056.png and phpbb/mobiquo/emoji/E056.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E057.png and phpbb/mobiquo/emoji/E057.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E058.png and phpbb/mobiquo/emoji/E058.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E059.png and phpbb/mobiquo/emoji/E059.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E05A.png and phpbb/mobiquo/emoji/E05A.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E101.png and phpbb/mobiquo/emoji/E101.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E102.png and phpbb/mobiquo/emoji/E102.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E103.png and phpbb/mobiquo/emoji/E103.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E104.png and phpbb/mobiquo/emoji/E104.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E105.png and phpbb/mobiquo/emoji/E105.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E106.png and phpbb/mobiquo/emoji/E106.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E107.png and phpbb/mobiquo/emoji/E107.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E108.png and phpbb/mobiquo/emoji/E108.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E109.png and phpbb/mobiquo/emoji/E109.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E10A.png and phpbb/mobiquo/emoji/E10A.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E10B.png and phpbb/mobiquo/emoji/E10B.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E10C.png and phpbb/mobiquo/emoji/E10C.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E10D.png and phpbb/mobiquo/emoji/E10D.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E10E.png and phpbb/mobiquo/emoji/E10E.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E10F.png and phpbb/mobiquo/emoji/E10F.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E110.png and phpbb/mobiquo/emoji/E110.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E111.png and phpbb/mobiquo/emoji/E111.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E112.png and phpbb/mobiquo/emoji/E112.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E113.png and phpbb/mobiquo/emoji/E113.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E114.png and phpbb/mobiquo/emoji/E114.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E115.png and phpbb/mobiquo/emoji/E115.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E116.png and phpbb/mobiquo/emoji/E116.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E117.png and phpbb/mobiquo/emoji/E117.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E118.png and phpbb/mobiquo/emoji/E118.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E119.png and phpbb/mobiquo/emoji/E119.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E11A.png and phpbb/mobiquo/emoji/E11A.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E11B.png and phpbb/mobiquo/emoji/E11B.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E11C.png and phpbb/mobiquo/emoji/E11C.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E11D.png and phpbb/mobiquo/emoji/E11D.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E11E.png and phpbb/mobiquo/emoji/E11E.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E11F.png and phpbb/mobiquo/emoji/E11F.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E120.png and phpbb/mobiquo/emoji/E120.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E121.png and phpbb/mobiquo/emoji/E121.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E122.png and phpbb/mobiquo/emoji/E122.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E123.png and phpbb/mobiquo/emoji/E123.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E124.png and phpbb/mobiquo/emoji/E124.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E125.png and phpbb/mobiquo/emoji/E125.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E126.png and phpbb/mobiquo/emoji/E126.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E127.png and phpbb/mobiquo/emoji/E127.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E128.png and phpbb/mobiquo/emoji/E128.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E129.png and phpbb/mobiquo/emoji/E129.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E12A.png and phpbb/mobiquo/emoji/E12A.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E12B.png and phpbb/mobiquo/emoji/E12B.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E12C.png and phpbb/mobiquo/emoji/E12C.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E12D.png and phpbb/mobiquo/emoji/E12D.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E12E.png and phpbb/mobiquo/emoji/E12E.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E12F.png and phpbb/mobiquo/emoji/E12F.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E130.png and phpbb/mobiquo/emoji/E130.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E131.png and phpbb/mobiquo/emoji/E131.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E132.png and phpbb/mobiquo/emoji/E132.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E133.png and phpbb/mobiquo/emoji/E133.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E134.png and phpbb/mobiquo/emoji/E134.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E135.png and phpbb/mobiquo/emoji/E135.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E136.png and phpbb/mobiquo/emoji/E136.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E137.png and phpbb/mobiquo/emoji/E137.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E138.png and phpbb/mobiquo/emoji/E138.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E139.png and phpbb/mobiquo/emoji/E139.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E13A.png and phpbb/mobiquo/emoji/E13A.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E13B.png and phpbb/mobiquo/emoji/E13B.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E13C.png and phpbb/mobiquo/emoji/E13C.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E13D.png and phpbb/mobiquo/emoji/E13D.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E13E.png and phpbb/mobiquo/emoji/E13E.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E13F.png and phpbb/mobiquo/emoji/E13F.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E140.png and phpbb/mobiquo/emoji/E140.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E141.png and phpbb/mobiquo/emoji/E141.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E142.png and phpbb/mobiquo/emoji/E142.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E143.png and phpbb/mobiquo/emoji/E143.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E144.png and phpbb/mobiquo/emoji/E144.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E145.png and phpbb/mobiquo/emoji/E145.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E146.png and phpbb/mobiquo/emoji/E146.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E147.png and phpbb/mobiquo/emoji/E147.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E148.png and phpbb/mobiquo/emoji/E148.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E149.png and phpbb/mobiquo/emoji/E149.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E14A.png and phpbb/mobiquo/emoji/E14A.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E14B.png and phpbb/mobiquo/emoji/E14B.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E14C.png and phpbb/mobiquo/emoji/E14C.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E14D.png and phpbb/mobiquo/emoji/E14D.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E14E.png and phpbb/mobiquo/emoji/E14E.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E14F.png and phpbb/mobiquo/emoji/E14F.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E150.png and phpbb/mobiquo/emoji/E150.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E151.png and phpbb/mobiquo/emoji/E151.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E152.png and phpbb/mobiquo/emoji/E152.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E153.png and phpbb/mobiquo/emoji/E153.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E154.png and phpbb/mobiquo/emoji/E154.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E155.png and phpbb/mobiquo/emoji/E155.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E156.png and phpbb/mobiquo/emoji/E156.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E157.png and phpbb/mobiquo/emoji/E157.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E158.png and phpbb/mobiquo/emoji/E158.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E159.png and phpbb/mobiquo/emoji/E159.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E15A.png and phpbb/mobiquo/emoji/E15A.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E201.png and phpbb/mobiquo/emoji/E201.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E202.png and phpbb/mobiquo/emoji/E202.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E203.png and phpbb/mobiquo/emoji/E203.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E204.png and phpbb/mobiquo/emoji/E204.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E205.png and phpbb/mobiquo/emoji/E205.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E206.png and phpbb/mobiquo/emoji/E206.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E207.png and phpbb/mobiquo/emoji/E207.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E208.png and phpbb/mobiquo/emoji/E208.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E209.png and phpbb/mobiquo/emoji/E209.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E20A.png and phpbb/mobiquo/emoji/E20A.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E20B.png and phpbb/mobiquo/emoji/E20B.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E20C.png and phpbb/mobiquo/emoji/E20C.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E20D.png and phpbb/mobiquo/emoji/E20D.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E20E.png and phpbb/mobiquo/emoji/E20E.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E20F.png and phpbb/mobiquo/emoji/E20F.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E210.png and phpbb/mobiquo/emoji/E210.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E211.png and phpbb/mobiquo/emoji/E211.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E212.png and phpbb/mobiquo/emoji/E212.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E213.png and phpbb/mobiquo/emoji/E213.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E214.png and phpbb/mobiquo/emoji/E214.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E215.png and phpbb/mobiquo/emoji/E215.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E216.png and phpbb/mobiquo/emoji/E216.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E217.png and phpbb/mobiquo/emoji/E217.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E218.png and phpbb/mobiquo/emoji/E218.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E219.png and phpbb/mobiquo/emoji/E219.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E21A.png and phpbb/mobiquo/emoji/E21A.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E21B.png and phpbb/mobiquo/emoji/E21B.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E21C.png and phpbb/mobiquo/emoji/E21C.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E21D.png and phpbb/mobiquo/emoji/E21D.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E21E.png and phpbb/mobiquo/emoji/E21E.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E21F.png and phpbb/mobiquo/emoji/E21F.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E220.png and phpbb/mobiquo/emoji/E220.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E221.png and phpbb/mobiquo/emoji/E221.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E222.png and phpbb/mobiquo/emoji/E222.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E223.png and phpbb/mobiquo/emoji/E223.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E224.png and phpbb/mobiquo/emoji/E224.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E225.png and phpbb/mobiquo/emoji/E225.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E226.png and phpbb/mobiquo/emoji/E226.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E227.png and phpbb/mobiquo/emoji/E227.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E228.png and phpbb/mobiquo/emoji/E228.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E229.png and phpbb/mobiquo/emoji/E229.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E22A.png and phpbb/mobiquo/emoji/E22A.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E22B.png and phpbb/mobiquo/emoji/E22B.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E22C.png and phpbb/mobiquo/emoji/E22C.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E22D.png and phpbb/mobiquo/emoji/E22D.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E22E.png and phpbb/mobiquo/emoji/E22E.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E22F.png and phpbb/mobiquo/emoji/E22F.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E230.png and phpbb/mobiquo/emoji/E230.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E231.png and phpbb/mobiquo/emoji/E231.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E232.png and phpbb/mobiquo/emoji/E232.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E233.png and phpbb/mobiquo/emoji/E233.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E234.png and phpbb/mobiquo/emoji/E234.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E235.png and phpbb/mobiquo/emoji/E235.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E236.png and phpbb/mobiquo/emoji/E236.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E237.png and phpbb/mobiquo/emoji/E237.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E238.png and phpbb/mobiquo/emoji/E238.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E239.png and phpbb/mobiquo/emoji/E239.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E23A.png and phpbb/mobiquo/emoji/E23A.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E23B.png and phpbb/mobiquo/emoji/E23B.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E23C.png and phpbb/mobiquo/emoji/E23C.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E23D.png and phpbb/mobiquo/emoji/E23D.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E23E.png and phpbb/mobiquo/emoji/E23E.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E23F.png and phpbb/mobiquo/emoji/E23F.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E240.png and phpbb/mobiquo/emoji/E240.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E241.png and phpbb/mobiquo/emoji/E241.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E242.png and phpbb/mobiquo/emoji/E242.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E243.png and phpbb/mobiquo/emoji/E243.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E244.png and phpbb/mobiquo/emoji/E244.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E245.png and phpbb/mobiquo/emoji/E245.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E246.png and phpbb/mobiquo/emoji/E246.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E247.png and phpbb/mobiquo/emoji/E247.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E248.png and phpbb/mobiquo/emoji/E248.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E249.png and phpbb/mobiquo/emoji/E249.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E24A.png and phpbb/mobiquo/emoji/E24A.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E24B.png and phpbb/mobiquo/emoji/E24B.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E24C.png and phpbb/mobiquo/emoji/E24C.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E24D.png and phpbb/mobiquo/emoji/E24D.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E24E.png and phpbb/mobiquo/emoji/E24E.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E24F.png and phpbb/mobiquo/emoji/E24F.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E250.png and phpbb/mobiquo/emoji/E250.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E251.png and phpbb/mobiquo/emoji/E251.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E252.png and phpbb/mobiquo/emoji/E252.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E253.png and phpbb/mobiquo/emoji/E253.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E301.png and phpbb/mobiquo/emoji/E301.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E302.png and phpbb/mobiquo/emoji/E302.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E303.png and phpbb/mobiquo/emoji/E303.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E304.png and phpbb/mobiquo/emoji/E304.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E305.png and phpbb/mobiquo/emoji/E305.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E306.png and phpbb/mobiquo/emoji/E306.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E307.png and phpbb/mobiquo/emoji/E307.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E308.png and phpbb/mobiquo/emoji/E308.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E309.png and phpbb/mobiquo/emoji/E309.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E30A.png and phpbb/mobiquo/emoji/E30A.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E30B.png and phpbb/mobiquo/emoji/E30B.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E30C.png and phpbb/mobiquo/emoji/E30C.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E30D.png and phpbb/mobiquo/emoji/E30D.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E30E.png and phpbb/mobiquo/emoji/E30E.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E30F.png and phpbb/mobiquo/emoji/E30F.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E310.png and phpbb/mobiquo/emoji/E310.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E311.png and phpbb/mobiquo/emoji/E311.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E312.png and phpbb/mobiquo/emoji/E312.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E313.png and phpbb/mobiquo/emoji/E313.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E314.png and phpbb/mobiquo/emoji/E314.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E315.png and phpbb/mobiquo/emoji/E315.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E316.png and phpbb/mobiquo/emoji/E316.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E317.png and phpbb/mobiquo/emoji/E317.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E318.png and phpbb/mobiquo/emoji/E318.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E319.png and phpbb/mobiquo/emoji/E319.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E31A.png and phpbb/mobiquo/emoji/E31A.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E31B.png and phpbb/mobiquo/emoji/E31B.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E31C.png and phpbb/mobiquo/emoji/E31C.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E31D.png and phpbb/mobiquo/emoji/E31D.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E31E.png and phpbb/mobiquo/emoji/E31E.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E31F.png and phpbb/mobiquo/emoji/E31F.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E320.png and phpbb/mobiquo/emoji/E320.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E321.png and phpbb/mobiquo/emoji/E321.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E322.png and phpbb/mobiquo/emoji/E322.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E323.png and phpbb/mobiquo/emoji/E323.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E324.png and phpbb/mobiquo/emoji/E324.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E325.png and phpbb/mobiquo/emoji/E325.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E326.png and phpbb/mobiquo/emoji/E326.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E327.png and phpbb/mobiquo/emoji/E327.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E328.png and phpbb/mobiquo/emoji/E328.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E329.png and phpbb/mobiquo/emoji/E329.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E32A.png and phpbb/mobiquo/emoji/E32A.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E32B.png and phpbb/mobiquo/emoji/E32B.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E32C.png and phpbb/mobiquo/emoji/E32C.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E32D.png and phpbb/mobiquo/emoji/E32D.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E32E.png and phpbb/mobiquo/emoji/E32E.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E32F.png and phpbb/mobiquo/emoji/E32F.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E330.png and phpbb/mobiquo/emoji/E330.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E331.png and phpbb/mobiquo/emoji/E331.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E332.png and phpbb/mobiquo/emoji/E332.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E333.png and phpbb/mobiquo/emoji/E333.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E334.png and phpbb/mobiquo/emoji/E334.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E335.png and phpbb/mobiquo/emoji/E335.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E336.png and phpbb/mobiquo/emoji/E336.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E337.png and phpbb/mobiquo/emoji/E337.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E338.png and phpbb/mobiquo/emoji/E338.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E339.png and phpbb/mobiquo/emoji/E339.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E33A.png and phpbb/mobiquo/emoji/E33A.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E33B.png and phpbb/mobiquo/emoji/E33B.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E33C.png and phpbb/mobiquo/emoji/E33C.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E33D.png and phpbb/mobiquo/emoji/E33D.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E33E.png and phpbb/mobiquo/emoji/E33E.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E33F.png and phpbb/mobiquo/emoji/E33F.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E340.png and phpbb/mobiquo/emoji/E340.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E341.png and phpbb/mobiquo/emoji/E341.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E342.png and phpbb/mobiquo/emoji/E342.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E343.png and phpbb/mobiquo/emoji/E343.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E344.png and phpbb/mobiquo/emoji/E344.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E345.png and phpbb/mobiquo/emoji/E345.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E346.png and phpbb/mobiquo/emoji/E346.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E347.png and phpbb/mobiquo/emoji/E347.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E348.png and phpbb/mobiquo/emoji/E348.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E349.png and phpbb/mobiquo/emoji/E349.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E34A.png and phpbb/mobiquo/emoji/E34A.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E34B.png and phpbb/mobiquo/emoji/E34B.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E34C.png and phpbb/mobiquo/emoji/E34C.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E34D.png and phpbb/mobiquo/emoji/E34D.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E401.png and phpbb/mobiquo/emoji/E401.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E402.png and phpbb/mobiquo/emoji/E402.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E403.png and phpbb/mobiquo/emoji/E403.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E404.png and phpbb/mobiquo/emoji/E404.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E405.png and phpbb/mobiquo/emoji/E405.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E406.png and phpbb/mobiquo/emoji/E406.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E407.png and phpbb/mobiquo/emoji/E407.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E408.png and phpbb/mobiquo/emoji/E408.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E409.png and phpbb/mobiquo/emoji/E409.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E40A.png and phpbb/mobiquo/emoji/E40A.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E40B.png and phpbb/mobiquo/emoji/E40B.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E40C.png and phpbb/mobiquo/emoji/E40C.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E40D.png and phpbb/mobiquo/emoji/E40D.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E40E.png and phpbb/mobiquo/emoji/E40E.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E40F.png and phpbb/mobiquo/emoji/E40F.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E410.png and phpbb/mobiquo/emoji/E410.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E411.png and phpbb/mobiquo/emoji/E411.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E412.png and phpbb/mobiquo/emoji/E412.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E413.png and phpbb/mobiquo/emoji/E413.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E414.png and phpbb/mobiquo/emoji/E414.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E415.png and phpbb/mobiquo/emoji/E415.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E416.png and phpbb/mobiquo/emoji/E416.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E417.png and phpbb/mobiquo/emoji/E417.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E418.png and phpbb/mobiquo/emoji/E418.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E419.png and phpbb/mobiquo/emoji/E419.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E41A.png and phpbb/mobiquo/emoji/E41A.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E41B.png and phpbb/mobiquo/emoji/E41B.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E41C.png and phpbb/mobiquo/emoji/E41C.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E41D.png and phpbb/mobiquo/emoji/E41D.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E41E.png and phpbb/mobiquo/emoji/E41E.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E41F.png and phpbb/mobiquo/emoji/E41F.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E420.png and phpbb/mobiquo/emoji/E420.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E421.png and phpbb/mobiquo/emoji/E421.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E422.png and phpbb/mobiquo/emoji/E422.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E423.png and phpbb/mobiquo/emoji/E423.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E424.png and phpbb/mobiquo/emoji/E424.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E425.png and phpbb/mobiquo/emoji/E425.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E426.png and phpbb/mobiquo/emoji/E426.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E427.png and phpbb/mobiquo/emoji/E427.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E428.png and phpbb/mobiquo/emoji/E428.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E429.png and phpbb/mobiquo/emoji/E429.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E42A.png and phpbb/mobiquo/emoji/E42A.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E42B.png and phpbb/mobiquo/emoji/E42B.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E42C.png and phpbb/mobiquo/emoji/E42C.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E42D.png and phpbb/mobiquo/emoji/E42D.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E42E.png and phpbb/mobiquo/emoji/E42E.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E42F.png and phpbb/mobiquo/emoji/E42F.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E430.png and phpbb/mobiquo/emoji/E430.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E431.png and phpbb/mobiquo/emoji/E431.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E432.png and phpbb/mobiquo/emoji/E432.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E433.png and phpbb/mobiquo/emoji/E433.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E434.png and phpbb/mobiquo/emoji/E434.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E435.png and phpbb/mobiquo/emoji/E435.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E436.png and phpbb/mobiquo/emoji/E436.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E437.png and phpbb/mobiquo/emoji/E437.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E438.png and phpbb/mobiquo/emoji/E438.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E439.png and phpbb/mobiquo/emoji/E439.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E43A.png and phpbb/mobiquo/emoji/E43A.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E43B.png and phpbb/mobiquo/emoji/E43B.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E43C.png and phpbb/mobiquo/emoji/E43C.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E43D.png and phpbb/mobiquo/emoji/E43D.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E43E.png and phpbb/mobiquo/emoji/E43E.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E43F.png and phpbb/mobiquo/emoji/E43F.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E440.png and phpbb/mobiquo/emoji/E440.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E441.png and phpbb/mobiquo/emoji/E441.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E442.png and phpbb/mobiquo/emoji/E442.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E443.png and phpbb/mobiquo/emoji/E443.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E444.png and phpbb/mobiquo/emoji/E444.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E445.png and phpbb/mobiquo/emoji/E445.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E446.png and phpbb/mobiquo/emoji/E446.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E447.png and phpbb/mobiquo/emoji/E447.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E448.png and phpbb/mobiquo/emoji/E448.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E449.png and phpbb/mobiquo/emoji/E449.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E44A.png and phpbb/mobiquo/emoji/E44A.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E44B.png and phpbb/mobiquo/emoji/E44B.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E44C.png and phpbb/mobiquo/emoji/E44C.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E501.png and phpbb/mobiquo/emoji/E501.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E502.png and phpbb/mobiquo/emoji/E502.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E503.png and phpbb/mobiquo/emoji/E503.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E504.png and phpbb/mobiquo/emoji/E504.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E505.png and phpbb/mobiquo/emoji/E505.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E506.png and phpbb/mobiquo/emoji/E506.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E507.png and phpbb/mobiquo/emoji/E507.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E508.png and phpbb/mobiquo/emoji/E508.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E509.png and phpbb/mobiquo/emoji/E509.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E50A.png and phpbb/mobiquo/emoji/E50A.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E50B.png and phpbb/mobiquo/emoji/E50B.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E50C.png and phpbb/mobiquo/emoji/E50C.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E50D.png and phpbb/mobiquo/emoji/E50D.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E50E.png and phpbb/mobiquo/emoji/E50E.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E50F.png and phpbb/mobiquo/emoji/E50F.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E510.png and phpbb/mobiquo/emoji/E510.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E511.png and phpbb/mobiquo/emoji/E511.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E512.png and phpbb/mobiquo/emoji/E512.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E513.png and phpbb/mobiquo/emoji/E513.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E514.png and phpbb/mobiquo/emoji/E514.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E515.png and phpbb/mobiquo/emoji/E515.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E516.png and phpbb/mobiquo/emoji/E516.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E517.png and phpbb/mobiquo/emoji/E517.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E518.png and phpbb/mobiquo/emoji/E518.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E519.png and phpbb/mobiquo/emoji/E519.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E51A.png and phpbb/mobiquo/emoji/E51A.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E51B.png and phpbb/mobiquo/emoji/E51B.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E51C.png and phpbb/mobiquo/emoji/E51C.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E51D.png and phpbb/mobiquo/emoji/E51D.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E51E.png and phpbb/mobiquo/emoji/E51E.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E51F.png and phpbb/mobiquo/emoji/E51F.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E520.png and phpbb/mobiquo/emoji/E520.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E521.png and phpbb/mobiquo/emoji/E521.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E522.png and phpbb/mobiquo/emoji/E522.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E523.png and phpbb/mobiquo/emoji/E523.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E524.png and phpbb/mobiquo/emoji/E524.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E525.png and phpbb/mobiquo/emoji/E525.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E526.png and phpbb/mobiquo/emoji/E526.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E527.png and phpbb/mobiquo/emoji/E527.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E528.png and phpbb/mobiquo/emoji/E528.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E529.png and phpbb/mobiquo/emoji/E529.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E52A.png and phpbb/mobiquo/emoji/E52A.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E52B.png and phpbb/mobiquo/emoji/E52B.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E52C.png and phpbb/mobiquo/emoji/E52C.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E52D.png and phpbb/mobiquo/emoji/E52D.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E52E.png and phpbb/mobiquo/emoji/E52E.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E52F.png and phpbb/mobiquo/emoji/E52F.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E530.png and phpbb/mobiquo/emoji/E530.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E531.png and phpbb/mobiquo/emoji/E531.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E532.png and phpbb/mobiquo/emoji/E532.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E533.png and phpbb/mobiquo/emoji/E533.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E534.png and phpbb/mobiquo/emoji/E534.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E535.png and phpbb/mobiquo/emoji/E535.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E536.png and phpbb/mobiquo/emoji/E536.png differ
Binary files phpBB-3.0.10/mobiquo/emoji/E537.png and phpbb/mobiquo/emoji/E537.png differ
diff -ruN phpBB-3.0.10/mobiquo/env_setting.php phpbb/mobiquo/env_setting.php
--- phpBB-3.0.10/mobiquo/env_setting.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/env_setting.php	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,383 @@
+<?php
+
+defined('IN_MOBIQUO') or exit;
+
+mobi_parse_requrest();
+
+if (in_array($request_method, array('login', 'logout_user', 'get_config')))
+{
+    define('IN_CHECK_BAN', 1);
+}
+
+include('./include/user.class.php');
+$user = new tapa_user;
+$user->session_begin();
+$auth->acl($user->data);
+$user->setup();
+$phpbb_home = generate_board_url().'/';
+$can_subscribe = ($config['email_enable'] || $config['jab_enable']) && $config['allow_topic_notify'] && $user->data['is_registered'];
+
+header('Mobiquo_is_login:'.($user->data['is_registered'] ? 'true' : 'false'));
+
+if ($user->data['user_new_privmsg'])
+{
+    include_once($phpbb_root_path . 'includes/functions_privmsgs.' . $phpEx);
+    place_pm_into_folder($global_privmsgs_rules);
+}
+
+$request_file = $request_method;
+
+switch ($request_method)
+{
+    case 'get_thread':
+        $request_file = 'viewtopic';
+        $_GET['st'] = 0;
+        $_GET['sk'] = 't';
+        $_GET['sd'] = 'a';
+        $_GET['t'] = $request_params[0];
+        list($_GET['start'], $_GET['limit']) = process_page($request_params[1], $request_params[2]);
+        $return_html = isset($request_params[3]) ? $request_params[3] : false;
+        break;
+    case 'get_thread_by_unread':
+        $request_file = 'viewtopic';
+        $_GET['st'] = 0;
+        $_GET['sk'] = 't';
+        $_GET['sd'] = 'a';
+        $_GET['t'] = $request_params[0];
+        $_GET['limit'] = $request_params[1];
+        $_GET['view'] = 'unread';
+        $return_html = isset($request_params[2]) ? $request_params[2] : false;
+        break;
+    case 'get_thread_by_post':
+        $request_file = 'viewtopic';
+        $_GET['st'] = 0;
+        $_GET['sk'] = 't';
+        $_GET['sd'] = 'a';
+        $_GET['p'] = $request_params[0];
+        $_GET['limit'] = $request_params[1];
+        $return_html = isset($request_params[2]) ? $request_params[2] : false;
+        break;
+    
+    
+    case 'search':
+        $include_topic_num = true;
+        $search_filter = $request_params[0];
+        $_GET['page'] = isset($search_filter['page']) ? $search_filter['page'] : 1;
+        $_GET['perpage'] = isset($search_filter['perpage']) ? $search_filter['perpage'] : 20;
+        $_GET['submit'] = 'Search';
+        $_GET['sr'] = isset($search_filter['showposts']) && $search_filter['showposts'] ? 'posts' : 'topics';
+        $_GET['sf'] = isset($search_filter['titleonly']) && $search_filter['titleonly'] ? 'titleonly' : 'all';
+        isset($search_filter['searchid']) && $_GET['searchid'] = $search_filter['searchid'];
+        isset($search_filter['keywords']) && $_GET['keywords'] = $search_filter['keywords'];
+        isset($search_filter['searchuser']) && $_GET['author'] = $search_filter['searchuser'];
+        isset($search_filter['userid']) && $_GET['author_id'] = $search_filter['userid'];
+        isset($search_filter['forumid']) && $_GET['fid'] = array($search_filter['forumid']);
+        
+        if (isset($search_filter['threadid']))
+        {
+            $_GET['t'] = $search_filter['threadid'];
+            $_GET['sf'] = 'msgonly';
+            $_GET['showresults'] = 'posts';
+        }
+        
+        if (isset($search_filter['searchtime']) && is_numeric($search_filter['searchtime']))
+        {
+            $_GET['st'] = $search_filter['searchtime']/86400;
+        }
+        
+        if (isset($search_filter['only_in']) && is_array($search_filter['only_in']))
+        {
+            $_GET['fid'] = array_map('intval', $search_filter['only_in']);
+        }
+        
+        if (isset($search_filter['not_in']) && is_array($search_filter['not_in']))
+        {
+            $_GET['exclude'] = array_map('intval', $search_filter['not_in']);
+        }
+        break;
+    case 'search_topic':
+        $include_topic_num = true;
+        $request_file = 'search';
+        process_page($request_params[1], $request_params[2]);
+        $_GET['page'] = $page;
+        $_GET['perpage'] = $limit;
+        $_GET['submit'] = 'Search';
+        $_GET['sr'] = 'topics';
+        $_GET['sf'] = 'all';
+        $_GET['keywords'] = $request_params[0];
+        break;
+    case 'search_post':
+        $include_topic_num = true;
+        $request_file = 'search';
+        process_page($request_params[1], $request_params[2]);
+        $_GET['page'] = $page;
+        $_GET['perpage'] = $limit;
+        $_GET['submit'] = 'Search';
+        $_GET['sr'] = 'posts';
+        $_GET['sf'] = 'all';
+        $_GET['keywords'] = $request_params[0];
+        break;
+    case 'get_latest_topic':
+        $include_topic_num = true;
+        $request_file = 'search';
+        process_page($request_params[0], $request_params[1]);
+        $_GET['page'] = $page;
+        $_GET['perpage'] = $limit;
+        $_GET['search_id'] = 'latesttopics';
+        
+        if (isset($request_params[3]['only_in']) && is_array($request_params[3]['only_in']))
+        {
+            $_GET['fid'] = array_map('intval', $request_params[3]['only_in']);
+        }
+        
+        if (isset($request_params[3]['not_in']) && is_array($request_params[3]['not_in']))
+        {
+            $_GET['exclude'] = array_map('intval', $request_params[3]['not_in']);
+        }
+        break;
+    case 'get_unread_topic':
+        $include_topic_num = true;
+        $request_file = 'search';
+        process_page($request_params[0], $request_params[1]);
+        $_GET['page'] = $page;
+        $_GET['perpage'] = $limit;
+        $_GET['search_id'] = 'unreadposts';
+        
+        if (isset($request_params[3]['only_in']) && is_array($request_params[3]['only_in']))
+        {
+            $_GET['fid'] = array_map('intval', $request_params[3]['only_in']);
+        }
+        
+        if (isset($request_params[3]['not_in']) && is_array($request_params[3]['not_in']))
+        {
+            $_GET['exclude'] = array_map('intval', $request_params[3]['not_in']);
+        }
+        break;
+    case 'get_participated_topic':
+        $include_topic_num = true;
+        $request_file = 'search';
+        process_page($request_params[1], $request_params[2]);
+        $_GET['page'] = $page;
+        $_GET['perpage'] = $limit;
+        $_GET['sr'] = 'topics';
+        $_GET['submit'] = 'Search';
+        $_GET['search_id'] = 'tt_user_search';
+        
+        if (isset($request_params[4]) && $request_params[4]) {
+            $_GET['author_id'] = intval($request_params[4]);
+        } else if (isset($request_params[0]) && $request_params[0]) {
+            $_GET['author'] = $request_params[0];
+        } else {
+            $_GET['search_id'] = 'egosearch';
+        }
+        break;
+    case 'get_user_topic':
+        $request_file = 'search';
+        $_GET['page'] = 1;
+        $_GET['perpage'] = 50;
+        $_GET['sr'] = 'topics';
+        $_GET['submit'] = 'Search';
+        $_GET['sf'] = 'firstpost';
+        $_GET['search_id'] = 'tt_user_search';
+        
+        if (isset($request_params[1]) && $request_params[1]) {
+            $_GET['author_id'] = intval($request_params[1]);
+        } else if (isset($request_params[0]) && $request_params[0]) {
+            $_GET['author'] = $request_params[0];
+        } else {
+            $_GET['search_id'] = 'egosearch';
+        }
+        break;
+    case 'get_user_reply_post':
+        $request_file = 'search';
+        $_GET['page'] = 1;
+        $_GET['perpage'] = 50;
+        $_GET['sr'] = 'posts';
+        $_GET['submit'] = 'Search';
+        $_GET['search_id'] = 'tt_user_search';
+        
+        if (isset($request_params[1]) && $request_params[1]) {
+            $_GET['author_id'] = intval($request_params[1]);
+        } else if (isset($request_params[0]) && $request_params[0]) {
+            $_GET['author'] = $request_params[0];
+        } else {
+            $_GET['search_id'] = 'egosearch';
+        }
+        break;
+    case 'get_subscribed_topic':
+        $include_topic_num = true;
+        $request_file = 'search';
+        process_page($request_params[0], $request_params[1]);
+        $_GET['page'] = $page;
+        $_GET['perpage'] = $limit;
+        $_GET['search_id'] = 'subscribedtopics';
+    
+    
+    case 'thank_post':
+        $_GET['thanks'] = $request_params[0];
+        $_GET['p'] = $request_params[0];
+        $request_file = 'viewtopic';
+        break;
+        
+    case 'm_stick_topic':
+        $_GET['t'] = $request_params[0];
+        $_GET['quickmod'] = 1;
+        $_GET['confirm_key'] = $user->data['user_last_confirm_key'] = $user->session_id;
+        $_POST['topic_id_list'] = array($request_params[0]);
+        $_POST['action'] = $request_params[1] == 1 ? 'make_sticky' : 'make_normal';
+        $_POST['user_id'] = $user->data['user_id'];
+        $_POST['confirm_uid'] = $user->data['user_id'];
+        $_POST['sess'] = $user->session_id;
+        $_POST['confirm'] = $user->lang['YES'];
+        break;
+    case 'm_close_topic':
+        $_GET['t'] = $request_params[0];
+        $_GET['quickmod'] = 1;
+        $_GET['confirm_key'] = $user->data['user_last_confirm_key'] = $user->session_id;
+        $_POST['topic_id_list'] = array($request_params[0]);
+        $_POST['action'] = $request_params[1] == 2 ? 'lock' : 'unlock';
+        $_POST['user_id'] = $user->data['user_id'];
+        $_POST['confirm_uid'] = $user->data['user_id'];
+        $_POST['sess'] = $user->session_id;
+        $_POST['confirm'] = $user->lang['YES'];
+        break;
+    case 'm_delete_topic':
+        $_GET['t'] = $request_params[0];
+        $_GET['quickmod'] = 1;
+        $_GET['confirm_key'] = $user->data['user_last_confirm_key'] = $user->session_id;
+        $_POST['topic_id_list'] = array($request_params[0]);
+        $_POST['action'] = 'delete_topic';
+        $_POST['user_id'] = $user->data['user_id'];
+        $_POST['confirm_uid'] = $user->data['user_id'];
+        $_POST['sess'] = $user->session_id;
+        $_POST['confirm'] = $user->lang['YES'];
+        break;
+    case 'm_delete_post':
+        $request_file = 'delete_post';
+        $_GET['p'] = $request_params[0];
+        break;
+    case 'm_move_topic':
+        $_GET['t'] = $request_params[0];
+        $_GET['quickmod'] = 1;
+        $_GET['confirm_key'] = $user->data['user_last_confirm_key'] = $user->session_id;
+        $_POST['to_forum_id'] = $request_params[1];
+        $_POST['topic_id_list'] = array($request_params[0]);
+        $_POST['action'] = 'move';
+        $_POST['user_id'] = $user->data['user_id'];
+        $_POST['confirm_uid'] = $user->data['user_id'];
+        $_POST['sess'] = $user->session_id;
+        $_POST['confirm'] = $user->lang['YES'];
+        break;
+    case 'm_move_post':
+        if (empty($request_params[1])) {
+            $_POST['action'] = 'split_all';
+            $_POST['to_forum_id'] = $request_params[3];
+            $_POST['subject'] = $request_params[2];
+        } else {
+            $_POST['action'] = 'merge_posts';
+            $_POST['to_topic_id'] = $request_params[1];
+        }
+        $_GET['p'] = $request_params[0];
+        $_GET['confirm_key'] = $user->data['user_last_confirm_key'] = $user->session_id;
+        $_POST['i'] = 'main';
+        $_POST['mode'] = 'topic_view';
+        $_POST['post_id_list'] = array($request_params[0]);
+        $_POST['user_id'] = $user->data['user_id'];
+        $_POST['confirm_uid'] = $user->data['user_id'];
+        $_POST['sess'] = $user->session_id;
+        $_POST['confirm'] = $user->lang['YES'];
+        break;
+    case 'm_merge_topic':
+        $_GET['t'] = $request_params[0];
+        $_GET['confirm_key'] = $user->data['user_last_confirm_key'] = $user->session_id;
+        $_POST['i'] = 'main';
+        $_POST['mode'] = 'forum_view';
+        $_POST['topic_id_list'] = array($request_params[0]);
+        $_POST['action'] = 'merge_topics';
+        $_POST['to_topic_id'] = $request_params[1];
+        $_POST['user_id'] = $user->data['user_id'];
+        $_POST['confirm_uid'] = $user->data['user_id'];
+        $_POST['sess'] = $user->session_id;
+        $_POST['confirm'] = $user->lang['YES'];
+        break;
+    case 'm_approve_topic':
+        $_GET['t'] = $request_params[0];
+        $_GET['confirm_key'] = $user->data['user_last_confirm_key'] = $user->session_id;
+        $_POST['notify_poster'] = 'on';
+        $_POST['i'] = 'queue';
+        $_POST['mode'] = 'unapproved_topics';
+        $_POST['action'] = 'approve';
+        $_POST['user_id'] = $user->data['user_id'];
+        $_POST['confirm_uid'] = $user->data['user_id'];
+        $_POST['sess'] = $user->session_id;
+        $_POST['confirm'] = $user->lang['YES'];
+        break;
+    case 'm_approve_post':
+        $_GET['p'] = $request_params[0];
+        $_GET['confirm_key'] = $user->data['user_last_confirm_key'] = $user->session_id;
+        $_POST['notify_poster'] = 'on';
+        $_POST['i'] = 'queue';
+        $_POST['post_id_list'] = array($request_params[0]);
+        $_POST['mode'] = 'unapproved_topics';
+        $_POST['action'] = 'approve';
+        $_POST['user_id'] = $user->data['user_id'];
+        $_POST['confirm_uid'] = $user->data['user_id'];
+        $_POST['sess'] = $user->session_id;
+        $_POST['confirm'] = $user->lang['YES'];
+        break;
+    case 'm_ban_user':
+        if ($request_params[1] == 2) {
+            $_POST['unbansubmit'] = 1;
+        } else {
+            $_POST['ban'] = $request_params[0];
+            $_POST['bansubmit'] = 1;
+            $_POST['banreason'] = $request_params[2];
+        }
+        $_GET['confirm_key'] = $user->data['user_last_confirm_key'] = $user->session_id;
+        $_POST['i'] = 'ban';
+        $_POST['user_id'] = $user->data['user_id'];
+        $_POST['confirm_uid'] = $user->data['user_id'];
+        $_POST['sess'] = $user->session_id;
+        $_POST['confirm'] = $user->lang['YES'];
+        break;
+    case 'm_get_moderate_topic':
+        if ($params_num == 2) {
+            process_page($request_params[0], $request_params[1]);
+        } elseif ($params_num == 3) {
+            process_page($request_params[1], $request_params[2]);
+        } else {
+            $start = 0;
+            $limit = 50;
+        }
+        $config['topics_per_page'] = $limit;
+        $_GET['start'] = $start;
+        $_GET['i'] = 'queue';
+        $_GET['mode'] = 'unapproved_topics';
+        break;
+    case 'm_get_moderate_post':
+        if ($params_num == 2) {
+            process_page($request_params[0], $request_params[1]);
+        } elseif ($params_num == 3) {
+            process_page($request_params[1], $request_params[2]);
+        } else {
+            $start = 0;
+            $limit = 50;
+        }
+        $config['topics_per_page'] = $limit;
+        $_GET['start'] = $start;
+        $_GET['i'] = 'queue';
+        $_GET['mode'] = 'unapproved_posts';
+        break;
+    case 'm_get_report_post':
+        process_page($request_params[0], $request_params[1]);
+        $config['topics_per_page'] = $limit;
+        $_GET['start'] = $start;
+        $_GET['i'] = 'reports';
+        $_GET['mode'] = 'reports';
+        break;
+}
+
+foreach($_GET  as $key => $value) $_REQUEST[$key] = $value;
+foreach($_POST as $key => $value) $_REQUEST[$key] = $value;
+
+error_reporting(MOBIQUO_DEBUG);
diff -ruN phpBB-3.0.10/mobiquo/forum_icons/index.html phpbb/mobiquo/forum_icons/index.html
--- phpBB-3.0.10/mobiquo/forum_icons/index.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/forum_icons/index.html	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,8 @@
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
+<HTML>
+ <HEAD>
+  <TITLE>Redirecting...</TITLE>
+<meta HTTP-EQUIV="REFRESH" content="0; url=/"> </HEAD>
+<BODY>  
+</BODY>
+</HTML>
diff -ruN phpBB-3.0.10/mobiquo/function/create_message.php phpbb/mobiquo/function/create_message.php
--- phpBB-3.0.10/mobiquo/function/create_message.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/function/create_message.php	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,227 @@
+<?php
+/**
+*
+* @copyright (c) 2009, 2010, 2011 Quoord Systems Limited
+* @license http://opensource.org/licenses/gpl-2.0.php GNU Public License (GPLv2)
+*
+*/
+
+defined('IN_MOBIQUO') or exit;
+
+function create_message_func($xmlrpc_params)
+{
+    global $db, $user, $auth, $config, $phpbb_root_path, $phpEx;
+    
+    $user->setup('ucp');
+    
+    include_once($phpbb_root_path . 'includes/functions_privmsgs.' . $phpEx);
+    include_once($phpbb_root_path . 'includes/ucp/ucp_pm_compose.' . $phpEx);
+    
+    if (!$user->data['is_registered']) trigger_error('LOGIN_EXPLAIN_UCP');
+    if (!$config['allow_privmsg']) trigger_error('Module not accessible');
+    
+    // Flood check
+    $current_time = time();
+    $last_post_time = $user->data['user_lastpost_time'];
+
+    if ($last_post_time && ($current_time - $last_post_time) < intval($config['flood_interval']))
+    {
+        trigger_error('FLOOD_ERROR');
+    }
+    
+    $params = php_xmlrpc_decode($xmlrpc_params);
+    
+    if (!is_array($params[0]) || empty($params[0]) || !isset($params[1]) || utf8_clean_string($params[1]) === '' || !isset($params[2]))
+    {
+        trigger_error('Required paramerter missing');
+    }
+    else
+    {
+        $user_name  = $params[0];
+        $_REQUEST['subject'] = $params[1];
+        $_REQUEST['message'] = $params[2];
+        $subject    = utf8_normalize_nfc(request_var('subject', '', true));
+        $text_body  = utf8_normalize_nfc(request_var('message', '', true));
+    }
+    
+    $action = 'post';   // default action
+    if (isset($params[3]))
+    {
+        if ($params[3] == 1)
+        {
+            $action = 'reply';
+            $msg_id = intval($params[4]);
+        }
+        else if ($params[3] == 2)
+        {
+            $action = 'forword';
+            $msg_id = intval($params[4]);
+        }
+        
+        if (!$msg_id) trigger_error('NO_MESSAGE');
+    }
+    
+    if (($action == 'post' || $action == 'reply')  && (!$auth->acl_get('u_sendpm')))
+    {
+        trigger_error('NO_AUTH_SEND_MESSAGE');
+    }
+    
+    if ($action == 'forward' && (!$config['forward_pm'] || !$auth->acl_get('u_pm_forward')))
+    {
+        trigger_error('NO_AUTH_FORWARD_MESSAGE');
+    }    
+    
+    // Do NOT use request_var or specialchars here
+    $address_list = array('u' => array());
+    
+    foreach($user_name as $msg_to_name)
+    {
+        $user_id = get_user_id_by_name(trim($msg_to_name));
+
+        if ($user_id)
+        {
+            $address_list['u'][$user_id] = 'to';
+        }
+        else
+        {
+            trigger_error('PM_NO_USERS');
+        }
+    }
+    
+    $sql = '';
+    
+    // What is all this following SQL for? Well, we need to know
+    // some basic information in all cases before we do anything.
+    if ($action != 'post')
+    {
+        $sql = 'SELECT t.folder_id, p.*, u.username as quote_username
+                FROM ' . PRIVMSGS_TO_TABLE . ' t, ' . PRIVMSGS_TABLE . ' p, ' . USERS_TABLE . ' u
+                WHERE t.user_id = ' . $user->data['user_id'] . "
+                AND p.author_id = u.user_id
+                AND t.msg_id = p.msg_id
+                AND p.msg_id = $msg_id";
+    }
+
+    if ($sql)
+    {
+        $result = $db->sql_query($sql);
+        $post = $db->sql_fetchrow($result);
+        $db->sql_freeresult($result);
+
+        if (!$post)
+        {
+            trigger_error('NO_MESSAGE');
+        }
+
+        if (!$post['author_id'] || $post['author_id'] == ANONYMOUS)
+        {
+            trigger_error('NO_AUTHOR');
+        }
+    }
+    
+    include($phpbb_root_path . 'includes/message_parser.' . $phpEx);
+    $message_parser = new parse_message();
+
+    // Get maximum number of allowed recipients
+    $sql = 'SELECT MAX(g.group_max_recipients) as max_recipients
+        FROM ' . GROUPS_TABLE . ' g, ' . USER_GROUP_TABLE . ' ug
+        WHERE ug.user_id = ' . $user->data['user_id'] . '
+            AND ug.user_pending = 0
+            AND ug.group_id = g.group_id';
+    $result = $db->sql_query($sql);
+    $max_recipients = (int) $db->sql_fetchfield('max_recipients');
+    $db->sql_freeresult($result);
+
+    $max_recipients = (!$max_recipients) ? $config['pm_max_recipients'] : $max_recipients;
+
+    // If this is a quote/reply "to all"... we may increase the max_recpients to the number of original recipients
+    if (($action == 'reply' || $action == 'quote') && $max_recipients)
+    {
+        // We try to include every previously listed member from the TO Header
+        $list = rebuild_header(array('to' => $post['to_address']));
+
+        // Can be an empty array too ;)
+        $list = (!empty($list['u'])) ? $list['u'] : array();
+        $list[$post['author_id']] = 'to';
+
+        if (isset($list[$user->data['user_id']]))
+        {
+            unset($list[$user->data['user_id']]);
+        }
+
+        $max_recipients = ($max_recipients < sizeof($list)) ? sizeof($list) : $max_recipients;
+
+        unset($list);
+    }
+    
+    // Handle User/Group adding/removing
+    handle_message_list_actions($address_list, $error, $remove_u, $remove_g, $add_to, $add_bcc);
+    
+    if ($error)
+    {
+        $error_msg = trim(strip_tags(implode("\n", $error)));
+        trigger_error($error_msg);
+    }
+
+    // Check mass pm to group permission
+    if ((!$config['allow_mass_pm'] || !$auth->acl_get('u_masspm_group')) && !empty($address_list['g']))
+    {
+        $address_list = array();
+        trigger_error('NO_AUTH_GROUP_MESSAGE');
+    }
+
+    // Check mass pm to users permission
+    if ((!$config['allow_mass_pm'] || !$auth->acl_get('u_masspm')) && num_recipients($address_list) > 1)
+    {
+        $address_list = get_recipients($address_list, 1);
+        trigger_error('TOO_MANY_RECIPIENTS');
+    }
+
+    // Check for too many recipients
+    if (!empty($address_list['u']) && $max_recipients && sizeof($address_list['u']) > $max_recipients)
+    {
+        $address_list = get_recipients($address_list, $max_recipients);
+        trigger_error('TOO_MANY_RECIPIENTS');
+    }
+    
+    $enable_bbcode  = ($config['allow_bbcode'] && $config['auth_bbcode_pm'] && $auth->acl_get('u_pm_bbcode')) ? true : false;
+    $enable_smilies = ($config['allow_smilies'] && $config['auth_smilies_pm'] && $auth->acl_get('u_pm_smilies')) ? true : false;
+    $img_status     = ($config['auth_img_pm'] && $auth->acl_get('u_pm_img')) ? true : false;
+    $flash_status   = ($config['auth_flash_pm'] && $auth->acl_get('u_pm_flash')) ? true : false;
+    $enable_urls    = true;
+    $enable_sig     = false;
+
+    $message_parser->message = $text_body;
+
+    // Parse message
+    $message_parser->parse($enable_bbcode, ($config['allow_post_links']) ? $enable_urls : false, $enable_smilies, $img_status, $flash_status, true, $config['allow_post_links']);
+
+    $pm_data = array(
+        'msg_id'                => (int) $msg_id,
+        'from_user_id'          => $user->data['user_id'],
+        'from_user_ip'          => $user->ip,
+        'from_username'         => $user->data['username'],
+        'reply_from_root_level' => (isset($post['root_level'])) ? (int) $post['root_level'] : 0,
+        'reply_from_msg_id'     => (int) $msg_id,
+        'icon_id'               => 0,
+        'enable_sig'            => (bool) $enable_sig,
+        'enable_bbcode'         => (bool) $enable_bbcode,
+        'enable_smilies'        => (bool) $enable_smilies,
+        'enable_urls'           => (bool) $enable_urls,
+        'bbcode_bitfield'       => $message_parser->bbcode_bitfield,
+        'bbcode_uid'            => $message_parser->bbcode_uid,
+        'message'               => $message_parser->message,
+        'attachment_data'       => $message_parser->attachment_data,
+        'filename_data'         => $message_parser->filename_data,
+        'address_list'          => $address_list
+    );
+    
+    $msg_id = submit_pm($action, $subject, $pm_data);
+
+    $result = new xmlrpcval(array(
+        'result' => new xmlrpcval($msg_id ? true : false, 'boolean'),
+        'msg_id' => new xmlrpcval($msg_id, 'string'),
+    ), 'struct');
+    
+    return new xmlrpcresp($result);
+}
diff -ruN phpBB-3.0.10/mobiquo/function/delete_message.php phpbb/mobiquo/function/delete_message.php
--- phpBB-3.0.10/mobiquo/function/delete_message.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/function/delete_message.php	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,45 @@
+<?php
+/**
+*
+* @copyright (c) 2009, 2010, 2011 Quoord Systems Limited
+* @license http://opensource.org/licenses/gpl-2.0.php GNU Public License (GPLv2)
+*
+*/
+
+defined('IN_MOBIQUO') or exit;
+
+function delete_message_func($xmlrpc_params)
+{
+    global $db, $user, $config, $phpbb_root_path, $phpEx;
+    
+    $user->setup('ucp');
+    
+    $params = php_xmlrpc_decode($xmlrpc_params);
+    
+    // get folder id from parameters
+    $msg_id = intval($params[0]);
+    $user_id = $user->data['user_id'];
+    
+    if (!$msg_id) trigger_error('NO_MESSAGE');
+    if (!$user->data['is_registered']) trigger_error('LOGIN_EXPLAIN_UCP');
+    
+    // Is PM disabled?
+    if (!$config['allow_privmsg']) trigger_error('Module not accessible');
+    
+    $sql = 'SELECT folder_id
+            FROM ' . PRIVMSGS_TO_TABLE . "
+            WHERE user_id = $user_id
+            AND msg_id = $msg_id";
+    $result = $db->sql_query_limit($sql, 1);
+    $folder_id = (int) $db->sql_fetchfield('folder_id');
+    $db->sql_freeresult($result);
+    
+    include_once($phpbb_root_path . 'includes/functions_privmsgs.' . $phpEx);
+    $result = delete_pm($user_id, $msg_id, $folder_id);
+    $response = new xmlrpcval(array(
+        'result'      => new xmlrpcval($result, 'boolean'),
+        'result_text' => new xmlrpcval($result ? '' : 'Delete message failed', 'base64'),
+    ), 'struct');
+    
+    return new xmlrpcresp($response);
+}
diff -ruN phpBB-3.0.10/mobiquo/function/delete_post.php phpbb/mobiquo/function/delete_post.php
--- phpBB-3.0.10/mobiquo/function/delete_post.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/function/delete_post.php	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,141 @@
+<?php
+/**
+*
+* @copyright (c) 2009, 2010, 2011 Quoord Systems Limited
+* @license http://opensource.org/licenses/gpl-2.0.php GNU Public License (GPLv2)
+*
+*/
+
+defined('IN_MOBIQUO') or exit;
+include($phpbb_root_path . 'includes/functions_posting.' . $phpEx);
+
+$post_id = request_var('p', 0);
+
+if (!$post_id)
+{
+    $user->setup('posting');
+    trigger_error('NO_POST');
+}
+
+// Force forum id
+$sql = 'SELECT forum_id
+    FROM ' . POSTS_TABLE . '
+    WHERE post_id = ' . $post_id;
+$result = $db->sql_query($sql);
+$forum_id = (int) $db->sql_fetchfield('forum_id');
+$db->sql_freeresult($result);
+
+if (!$forum_id) trigger_error('NO_FORUM');
+
+$sql = 'SELECT f.*, t.*, p.*, u.username, u.username_clean, u.user_sig, u.user_sig_bbcode_uid, u.user_sig_bbcode_bitfield
+    FROM ' . POSTS_TABLE . ' p, ' . TOPICS_TABLE . ' t, ' . FORUMS_TABLE . ' f, ' . USERS_TABLE . " u
+    WHERE p.post_id = $post_id
+        AND t.topic_id = p.topic_id
+        AND u.user_id = p.poster_id
+        AND (f.forum_id = t.forum_id
+            OR f.forum_id = $forum_id)" .
+        (($auth->acl_get('m_approve', $forum_id)) ? '' : 'AND p.post_approved = 1');
+
+$result = $db->sql_query($sql);
+$post_data = $db->sql_fetchrow($result);
+$db->sql_freeresult($result);
+
+if (!$post_data)
+{
+    $user->setup('posting');
+    trigger_error('NO_POST');
+}
+
+$user->setup(array('posting', 'mcp', 'viewtopic'), $post_data['forum_style']);
+
+// Use post_row values in favor of submitted ones...
+$forum_id   = (!empty($post_data['forum_id'])) ? (int) $post_data['forum_id'] : (int) $forum_id;
+$topic_id   = (!empty($post_data['topic_id'])) ? (int) $post_data['topic_id'] : (int) $topic_id;
+$post_id    = (!empty($post_data['post_id'])) ? (int) $post_data['post_id'] : (int) $post_id;
+
+if ($post_data['forum_password'] && !check_forum_password($forum_id))
+{
+    trigger_error('LOGIN_FORUM');
+}
+
+// Check permissions
+if ($user->data['is_bot'] || $user->data['user_id'] == ANONYMOUS)
+{
+    trigger_error('USER_CANNOT_DELETE');
+}
+
+// Is the user able to read within this forum?
+if (!$auth->acl_get('f_read', $forum_id))
+{
+    trigger_error('USER_CANNOT_READ');
+}
+
+if (!$user->data['is_registered'] || !$auth->acl_gets('f_delete', 'm_delete', $forum_id))
+{
+    trigger_error('USER_CANNOT_DELETE');
+}
+
+// Forum/Topic locked?
+if (($post_data['forum_status'] == ITEM_LOCKED || (isset($post_data['topic_status']) && $post_data['topic_status'] == ITEM_LOCKED)) && !$auth->acl_get('m_edit', $forum_id))
+{
+    trigger_error(($post_data['forum_status'] == ITEM_LOCKED) ? 'FORUM_LOCKED' : 'TOPIC_LOCKED');
+}
+
+// If moderator removing post or user itself removing post, present a confirmation screen
+if ($auth->acl_get('m_delete', $forum_id) || ($post_data['poster_id'] == $user->data['user_id'] && $user->data['is_registered'] && $auth->acl_get('f_delete', $forum_id) && $post_id == $post_data['topic_last_post_id'] && !$post_data['post_edit_locked'] && ($post_data['post_time'] > time() - ($config['delete_time'] * 60) || !$config['delete_time'])))
+{
+    $data = array(
+        'topic_first_post_id'   => $post_data['topic_first_post_id'],
+        'topic_last_post_id'    => $post_data['topic_last_post_id'],
+        'topic_replies_real'    => $post_data['topic_replies_real'],
+        'topic_approved'        => $post_data['topic_approved'],
+        'topic_type'            => $post_data['topic_type'],
+        'post_approved'         => $post_data['post_approved'],
+        'post_reported'         => $post_data['post_reported'],
+        'post_time'             => $post_data['post_time'],
+        'poster_id'             => $post_data['poster_id'],
+        'post_postcount'        => $post_data['post_postcount']
+    );
+
+    $next_post_id = delete_post($forum_id, $topic_id, $post_id, $data);
+    
+    // delete thanks on this post
+    if (file_exists($phpbb_root_path . 'includes/functions_thanks.' . $phpEx))
+    {
+        if (!function_exists('delete_post_thanks'))
+        {
+            include($phpbb_root_path . 'includes/functions_thanks.' . $phpEx);
+        }
+    
+        if (function_exists('delete_post_thanks'))
+        {
+            delete_post_thanks($post_id);
+        }
+    }
+    
+    $post_username = ($post_data['poster_id'] == ANONYMOUS && !empty($post_data['post_username'])) ? $post_data['post_username'] : $post_data['username'];
+
+    if ($next_post_id === false)
+    {
+        add_log('mod', $forum_id, $topic_id, 'LOG_DELETE_TOPIC', $post_data['topic_title'], $post_username);
+    }
+    else
+    {
+        add_log('mod', $forum_id, $topic_id, 'LOG_DELETE_POST', $post_data['post_subject'], $post_username);
+    }
+}
+else
+{
+    // If we are here the user is not able to delete - present the correct error message
+    if ($post_data['poster_id'] != $user->data['user_id'] && $auth->acl_get('f_delete', $forum_id))
+    {
+        trigger_error('DELETE_OWN_POSTS');
+    }
+    
+    if ($post_data['poster_id'] == $user->data['user_id'] && $auth->acl_get('f_delete', $forum_id) && $post_id != $post_data['topic_last_post_id'])
+    {
+        trigger_error('CANNOT_DELETE_REPLIED');
+    }
+    
+    trigger_error('USER_CANNOT_DELETE');
+}
\ No newline at end of file
diff -ruN phpBB-3.0.10/mobiquo/function/get_board_stat.php phpbb/mobiquo/function/get_board_stat.php
--- phpBB-3.0.10/mobiquo/function/get_board_stat.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/function/get_board_stat.php	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,28 @@
+<?php
+/**
+*
+* @copyright (c) 2009, 2010, 2011 Quoord Systems Limited
+* @license http://opensource.org/licenses/gpl-2.0.php GNU Public License (GPLv2)
+*
+*/
+
+defined('IN_MOBIQUO') or exit;
+
+function get_board_stat_func() 
+{    
+    global $config;
+    
+    $online_info = obtain_users_online();
+    
+    $board_stat = array(
+        'total_threads' => new xmlrpcval($config['num_topics'], 'int'),
+        'total_posts'   => new xmlrpcval($config['num_posts'], 'int'),
+        'total_members' => new xmlrpcval($config['num_users'], 'int'),
+        'guest_online'  => new xmlrpcval($online_info['guests_online'], 'int'),
+        'total_online'  => new xmlrpcval($online_info['total_online'], 'int')
+    );
+    
+    $response = new xmlrpcval($board_stat, 'struct');
+    
+    return new xmlrpcresp($response);
+}
diff -ruN phpBB-3.0.10/mobiquo/function/get_box_info.php phpbb/mobiquo/function/get_box_info.php
--- phpBB-3.0.10/mobiquo/function/get_box_info.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/function/get_box_info.php	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,137 @@
+<?php
+/**
+*
+* @copyright (c) 2009, 2010, 2011 Quoord Systems Limited
+* @license http://opensource.org/licenses/gpl-2.0.php GNU Public License (GPLv2)
+*
+*/
+
+defined('IN_MOBIQUO') or exit;
+
+function get_box_info_func()
+{
+    global $db, $user, $config, $phpbb_root_path, $phpEx;
+    $user->setup('ucp');
+    
+    if (!$user->data['is_registered']) trigger_error('LOGIN_EXPLAIN_UCP');
+    if (!$config['allow_privmsg']) trigger_error('Module not accessible');
+
+    $folder = array();
+    $user_id = $user->data['user_id'];
+    // Get folder information
+    $sql = 'SELECT folder_id, COUNT(msg_id) as num_messages, SUM(pm_unread) as num_unread
+            FROM ' . PRIVMSGS_TO_TABLE . "
+            WHERE user_id = $user_id
+            AND folder_id <> " . PRIVMSGS_NO_BOX . '
+            GROUP BY folder_id';
+    $result = $db->sql_query($sql);
+
+    $num_messages = $num_unread = array();
+    while ($row = $db->sql_fetchrow($result))
+    {
+        $num_messages[(int) $row['folder_id']] = $row['num_messages'];
+        $num_unread[(int) $row['folder_id']] = $row['num_unread'];
+    }
+    $db->sql_freeresult($result);
+
+    // Make sure the default boxes are defined
+    $available_folder = array(PRIVMSGS_INBOX, PRIVMSGS_OUTBOX, PRIVMSGS_SENTBOX);
+
+    foreach ($available_folder as $default_folder)
+    {
+        if (!isset($num_messages[$default_folder]))
+        {
+            $num_messages[$default_folder] = 0;
+        }
+
+        if (!isset($num_unread[$default_folder]))
+        {
+            $num_unread[$default_folder] = 0;
+        }
+    }
+
+    // Adjust unread status for outbox
+    $num_unread[PRIVMSGS_OUTBOX] = $num_messages[PRIVMSGS_OUTBOX];
+
+    $folder[PRIVMSGS_INBOX] = array(
+        'folder_id'         => 0,
+        'folder_name'       => $user->lang['PM_INBOX'],
+        'num_messages'      => $num_messages[PRIVMSGS_INBOX],
+        'unread_messages'   => $num_unread[PRIVMSGS_INBOX],
+        'folder_type'       => 'INBOX'
+    );
+
+    // Custom Folder
+    $sql = 'SELECT folder_id, folder_name, pm_count
+            FROM ' . PRIVMSGS_FOLDER_TABLE . "
+            WHERE user_id = $user_id";
+    $result = $db->sql_query($sql);
+
+    while ($row = $db->sql_fetchrow($result))
+    {
+        $folder[$row['folder_id']] = array(
+            'folder_id'         => $row['folder_id'],
+            'folder_name'       => $row['folder_name'],
+            'num_messages'      => $row['pm_count'],
+            'unread_messages'   => ((isset($num_unread[$row['folder_id']])) ? $num_unread[$row['folder_id']] : 0)
+        );
+    }
+    $db->sql_freeresult($result);
+
+    $folder[PRIVMSGS_OUTBOX] = array(
+        'folder_id'         => -2,
+        'folder_name'       => $user->lang['PM_OUTBOX'],
+        'num_messages'      => $num_messages[PRIVMSGS_OUTBOX],
+        'unread_messages'   => $num_unread[PRIVMSGS_OUTBOX],
+        'folder_type'       => 'OUTBOX'
+    );
+
+    $folder[PRIVMSGS_SENTBOX] = array(
+        'folder_id'         => -1,
+        'folder_name'       => $user->lang['PM_SENTBOX'],
+        'num_messages'      => $num_messages[PRIVMSGS_SENTBOX],
+        'unread_messages'   => $num_unread[PRIVMSGS_SENTBOX],
+        'folder_type'       => 'SENT'
+    );
+    
+    $box_list = array();
+    foreach($folder as $box)
+    {
+        $box_list[] = new xmlrpcval(array(
+            'box_id'        => new xmlrpcval($box['folder_id'],"string"),
+            'box_name'      => new xmlrpcval($box['folder_name'], 'base64'),
+            'msg_count'     => new xmlrpcval($box['num_messages'], 'int'),
+            'unread_count'  => new xmlrpcval($box['unread_messages'], 'int'),
+            'box_type'      => new xmlrpcval(isset($box['folder_type']) ? $box['folder_type'] : '')
+        ), 'struct');
+        
+    }
+    
+    //include_once($phpbb_root_path. 'includes/functions_privmsgs.' . $phpEx);
+    mobi_set_user_message_limit();
+    $message_room_count = ($user->data['message_limit']) ? $user->data['message_limit'] - $num_messages[PRIVMSGS_INBOX] : 0;
+    
+    $result = new xmlrpcval(array(
+        'message_room_count' => new xmlrpcval($message_room_count, 'int'),
+        'list'               => new xmlrpcval($box_list, 'array') 
+    ), 'struct');
+
+    return new xmlrpcresp($result);
+}
+
+function mobi_set_user_message_limit()
+{
+	global $user, $db, $config;
+
+	// Get maximum about from user memberships - if it is 0, there is no limit set and we use the maximum value within the config.
+	$sql = 'SELECT MAX(g.group_message_limit) as max_message_limit
+		FROM ' . GROUPS_TABLE . ' g, ' . USER_GROUP_TABLE . ' ug
+		WHERE ug.user_id = ' . $user->data['user_id'] . '
+			AND ug.user_pending = 0
+			AND ug.group_id = g.group_id';
+	$result = $db->sql_query($sql);
+	$message_limit = (int) $db->sql_fetchfield('max_message_limit');
+	$db->sql_freeresult($result);
+
+	$user->data['message_limit'] = (!$message_limit) ? $config['pm_max_msgs'] : $message_limit;
+}
\ No newline at end of file
diff -ruN phpBB-3.0.10/mobiquo/function/get_box.php phpbb/mobiquo/function/get_box.php
--- phpBB-3.0.10/mobiquo/function/get_box.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/function/get_box.php	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,228 @@
+<?php
+/**
+*
+* @copyright (c) 2009, 2010, 2011 Quoord Systems Limited
+* @license http://opensource.org/licenses/gpl-2.0.php GNU Public License (GPLv2)
+*
+*/
+
+defined('IN_MOBIQUO') or exit;
+
+function get_box_func($xmlrpc_params)
+{
+    global $db, $auth, $user, $cache, $config, $phpbb_home, $phpbb_root_path, $phpEx;
+
+    $params = php_xmlrpc_decode($xmlrpc_params);
+    
+    $user->setup('ucp');
+    if (!$user->data['is_registered']) trigger_error('LOGIN_EXPLAIN_UCP');
+    if (!$config['allow_privmsg']) trigger_error('Module not accessible');
+    if (!isset($params[0])) trigger_error('UNKNOWN_FOLDER');
+    
+    // get folder id from parameters
+    $folder_id = intval($params[0]);
+    if (PRIVMSGS_INBOX !== $folder_id)
+        $folder_id = PRIVMSGS_SENTBOX;
+    
+    list($start, $limit, $page) = process_page($params[1], $params[2]);
+    
+    // Grab icons
+    //$icons = $cache->obtain_icons();
+    $user_id = $user->data['user_id'];
+
+    include_once($phpbb_root_path . 'includes/functions_privmsgs.' . $phpEx);
+    $folder = get_folder($user_id, $folder_id);
+
+    include($phpbb_root_path . 'includes/ucp/ucp_pm_viewfolder.' . $phpEx);
+    $folder_info = get_pm_from($folder_id, $folder, $user_id);
+
+    $address_list = array();
+
+    // Build Recipient List if in outbox/sentbox - max two additional queries
+    if ($folder_id == PRIVMSGS_OUTBOX || $folder_id == PRIVMSGS_SENTBOX)
+    {
+        $recipient_list = $address = array();
+
+        foreach ($folder_info['rowset'] as $message_id => $row)
+        {
+            $address[$message_id] = rebuild_header(array('to' => $row['to_address'], 'bcc' => $row['bcc_address']));
+            $_save = array('u', 'g');
+            foreach ($_save as $save)
+            {
+                if (isset($address[$message_id][$save]) && sizeof($address[$message_id][$save]))
+                {
+                    foreach (array_keys($address[$message_id][$save]) as $ug_id)
+                    {
+                        $recipient_list[$save][$ug_id] = array('name' => $user->lang['NA'], 'colour' => '');
+                    }
+                }
+            }
+        }
+
+        $_types = array('u', 'g');
+        foreach ($_types as $ug_type)
+        {
+            if (!empty($recipient_list[$ug_type]))
+            {
+                if ($ug_type == 'u')
+                {
+                    $sql = 'SELECT user_id as id, username as name, user_colour as colour
+                        FROM ' . USERS_TABLE . '
+                        WHERE ';
+                }
+                else
+                {
+                    $sql = 'SELECT group_id as id, group_name as name, group_colour as colour, group_type
+                        FROM ' . GROUPS_TABLE . '
+                        WHERE ';
+                }
+                $sql .= $db->sql_in_set(($ug_type == 'u') ? 'user_id' : 'group_id', array_map('intval', array_keys($recipient_list[$ug_type])));
+
+                $result = $db->sql_query($sql);
+
+                while ($row = $db->sql_fetchrow($result))
+                {
+                    if ($ug_type == 'g')
+                    {
+                        $row['name'] = ($row['group_type'] == GROUP_SPECIAL) ? $user->lang['G_' . $row['name']] : $row['name'];
+                    }
+
+                    $recipient_list[$ug_type][$row['id']] = array('id' => $row['id'], 'name' => $row['name'], 'colour' => $row['colour']);
+                }
+                $db->sql_freeresult($result);
+            }
+        }
+
+        foreach ($address as $message_id => $adr_ary)
+        {
+            foreach ($adr_ary as $type => $id_ary)
+            {
+                foreach ($id_ary as $ug_id => $_id)
+                {
+                    $address_list[$message_id][] = $recipient_list[$type][$ug_id];
+                }
+            }
+        }
+        unset($recipient_list, $address);
+    }
+    
+    // get unread count in inbox only
+    if (PRIVMSGS_INBOX === $folder_id)
+    {
+        $sql = 'SELECT COUNT(msg_id) as num_messages
+                FROM ' . PRIVMSGS_TO_TABLE . '
+                WHERE pm_unread = 1
+                    AND folder_id = ' . PRIVMSGS_INBOX . '
+                    AND user_id = ' . $user->data['user_id'];
+        $result = $db->sql_query($sql);
+        $unread_num = (int) $db->sql_fetchfield('num_messages');
+        $db->sql_freeresult($result);
+    } else {
+        $unread_num = 0;
+    }
+    
+    $sql = 'SELECT COUNT(msg_id) as num_messages
+            FROM ' . PRIVMSGS_TO_TABLE . '
+            WHERE folder_id = ' . $folder_id . '
+                AND user_id = ' . $user->data['user_id'];
+    $result = $db->sql_query($sql);
+    $total_num = (int) $db->sql_fetchfield('num_messages');
+    $db->sql_freeresult($result);
+    
+    $sql = 'SELECT t.*, p.*, u.username, u.user_avatar, u.user_avatar_type, u.user_id
+            FROM ' . PRIVMSGS_TO_TABLE . ' t, ' . PRIVMSGS_TABLE . ' p, ' . USERS_TABLE . " u
+            WHERE t.user_id = $user_id
+            AND p.author_id = u.user_id
+            AND t.folder_id = $folder_id
+            AND t.msg_id = p.msg_id
+            ORDER BY p.message_time DESC";
+    $result = $db->sql_query_limit($sql, $limit, $start);
+    
+    $total_message_count = $total_unread_count = 0;
+    $online_cache = array();
+    while ($row = $db->sql_fetchrow($result))
+    {
+        $msg_state = 2; // message read
+        if ($row['pm_unread'])
+        {
+            $msg_state = 1;
+        }
+        else if ($row['pm_replied'])
+        {
+            $msg_state = 3;
+        }
+        else if ($row['pm_forwarded'])
+        {
+            $msg_state = 4;
+        }
+
+        if ($folder_id == PRIVMSGS_OUTBOX || $folder_id == PRIVMSGS_SENTBOX)
+        {
+            $msg_to_list = $address_list[$row['msg_id']];
+        }
+        else
+        {
+            $msg_to_list = array(array('id' => $user->data['user_id'], 'name' => $user->data['username']));
+        }
+
+        $msg_to = array();
+        foreach ($msg_to_list as $address)
+        {
+            $msg_to[] = new xmlrpcval(array(
+                'user_id'  => new xmlrpcval($address['id'], 'string'),
+                'username' => new xmlrpcval(basic_clean($address['name']), 'base64'),
+            ), 'struct');
+        }
+
+        $sent_date  = mobiquo_iso8601_encode($row['message_time']);
+        //$icon_url   = (!empty($icons[$row['icon_id']])) ? $phpbb_home . $config['icons_path'] . '/' . $icons[$row['icon_id']]['img'] : '';
+        $icon_url   = ($user->optionget('viewavatars')) ? get_user_avatar_url($row['user_avatar'], $row['user_avatar_type']) : '';
+        $msg_subject = html_entity_decode(strip_tags(censor_text($row['message_subject'])));
+
+        $short_content = censor_text($row['message_text']);
+        $short_content = preg_replace('/\[url.*?\].*?\[\/url.*?\]/', '[url]', $short_content);
+        $short_content = preg_replace('/\[img.*?\].*?\[\/img.*?\]/', '[img]', $short_content);
+        $short_content = preg_replace('/[\n\r\t]+/', ' ', $short_content);
+        strip_bbcode($short_content);
+        $short_content = html_entity_decode($short_content);
+        $short_content = substr($short_content, 0, 200);
+        
+        if ($config['load_onlinetrack'] && !isset($online_cache[$row['user_id']])) {
+            $sql = 'SELECT session_user_id, MAX(session_time) as online_time, MIN(session_viewonline) AS viewonline
+                    FROM ' . SESSIONS_TABLE . '
+                    WHERE session_user_id=' . $row['user_id'] . '
+                    GROUP BY session_user_id';
+            $online_result = $db->sql_query($sql);
+            $online_info = $db->sql_fetchrow($online_result);
+            $db->sql_freeresult($online_result);
+            
+            $update_time = $config['load_online_time'] * 60;
+            $online_cache[$row['user_id']] = (time() - $update_time < $online_info['online_time'] && (($online_info['viewonline']) || $auth->acl_get('u_viewonline'))) ? true : false;
+        }
+        
+        $is_online = isset($online_cache[$row['user_id']]) ? $online_cache[$row['user_id']] : false;
+        
+        $pm_list[] = new xmlrpcval(array(
+            'msg_id'        => new xmlrpcval($row['msg_id']),
+            'msg_state'     => new xmlrpcval($msg_state, 'int'),
+            'sent_date'     => new xmlrpcval($sent_date, 'dateTime.iso8601'),
+            'timestamp'     => new xmlrpcval($row['message_time'], 'string'),
+            'msg_from'      => new xmlrpcval(basic_clean($row['username']), 'base64'),
+            'msg_from_id'   => new xmlrpcval($row['user_id']),
+            'icon_url'      => new xmlrpcval($icon_url),
+            'msg_to'        => new xmlrpcval($msg_to, 'array'),
+            'msg_subject'   => new xmlrpcval($msg_subject, 'base64'),
+            'short_content' => new xmlrpcval($short_content, 'base64'),
+            'is_online'     => new xmlrpcval($is_online, 'boolean'),
+        ), 'struct');
+    }
+    $db->sql_freeresult($result);
+    
+    $result = new xmlrpcval(array(
+        'total_message_count' => new xmlrpcval($total_num, 'int'),
+        'total_unread_count'  => new xmlrpcval($unread_num, 'int'),
+        'list'                => new xmlrpcval($pm_list, 'array')
+    ), 'struct');
+
+    return new xmlrpcresp($result);
+}
diff -ruN phpBB-3.0.10/mobiquo/function/get_config.php phpbb/mobiquo/function/get_config.php
--- phpBB-3.0.10/mobiquo/function/get_config.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/function/get_config.php	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,51 @@
+<?php
+/**
+*
+* @copyright (c) 2009, 2010, 2011 Quoord Systems Limited
+* @license http://opensource.org/licenses/gpl-2.0.php GNU Public License (GPLv2)
+*
+*/
+
+defined('IN_MOBIQUO') or exit;
+
+function get_config_func()
+{    
+    global $mobiquo_config, $config, $auth;
+    
+    $config_list = array(
+        'sys_version'=> new xmlrpcval($config['version'], 'string'),
+        'is_open'    => new xmlrpcval($mobiquo_config['is_open'] ? true : false, 'boolean'),
+        'guest_okay' => new xmlrpcval($mobiquo_config['guest_okay'] ? true : false, 'boolean'),
+    );
+    
+    foreach($mobiquo_config as $key => $value)
+    {
+        if (!in_array($key, array('is_open', 'guest_okay', 'php_extension', 'shorten_quote', 'hide_forum_id', 'check_dnsbl')))
+        {
+            $config_list[$key] = new xmlrpcval($value, 'string');
+        }
+    }
+    
+    if ($auth->acl_get('u_search') && $auth->acl_getf_global('f_search') && $config['load_search'])
+    {
+        $config_list['guest_search'] = new xmlrpcval('1', 'string');
+    }
+    
+    if ($auth->acl_gets('u_viewprofile', 'a_user', 'a_useradd', 'a_userdel'))
+    {
+        $config_list['guest_whosonline'] = new xmlrpcval('1', 'string');
+    }
+    
+    if ($config['search_type'] == 'fulltext_native')
+    {
+        $config_list['min_search_length'] = new xmlrpcval($config['fulltext_native_min_chars'], 'int');
+    }
+    else if ($config['search_type'] == 'fulltext_mysql')
+    {
+        $config_list['min_search_length'] = new xmlrpcval($config['fulltext_mysql_min_word_len'], 'int');
+    }
+    
+    $response = new xmlrpcval($config_list, 'struct');
+    
+    return new xmlrpcresp($response);
+}
diff -ruN phpBB-3.0.10/mobiquo/function/get_forum.php phpbb/mobiquo/function/get_forum.php
--- phpBB-3.0.10/mobiquo/function/get_forum.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/function/get_forum.php	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,195 @@
+<?php
+/**
+*
+* @copyright (c) 2009, 2010, 2011 Quoord Systems Limited
+* @license http://opensource.org/licenses/gpl-2.0.php GNU Public License (GPLv2)
+*
+*/
+
+defined('IN_MOBIQUO') or exit;
+
+function get_forum_func($xmlrpc_params)
+{
+    global $db, $auth, $user, $config, $mobiquo_config, $phpbb_home;
+    
+    $params = php_xmlrpc_decode($xmlrpc_params);
+    
+    $return_description = isset($params[0]) ? $params[0] : false;
+    
+    if (isset($params[1]))
+    {
+        $fid = intval($params[1]);
+        $forum_filter = " WHERE f.parent_id = '$fid'";
+        $root_forum_id = $fid;
+    }
+    else
+    {
+        $forum_filter = '';
+        $root_forum_id = 0;
+    }
+    
+    $sql = 'SELECT f.* '. ($user->data['is_registered'] ? ', fw.notify_status' : '') . '
+            FROM ' . FORUMS_TABLE . ' f ' .
+            ($user->data['is_registered'] ? ' LEFT JOIN ' . FORUMS_WATCH_TABLE . ' fw ON (fw.forum_id = f.forum_id AND fw.user_id = ' . $user->data['user_id'] . ')' : '') . 
+            $forum_filter . '
+            ORDER BY f.left_id ASC';
+    $result = $db->sql_query($sql, 600);
+    
+    $forum_rows = array();
+    $forum_rows[$root_forum_id] = array('forum_id' => $root_forum_id, 'parent_id' => -1, 'child' => array());
+    while ($row = $db->sql_fetchrow($result))
+    {
+        $forum_id = $row['forum_id'];
+        
+        if ($row['forum_type'] == FORUM_CAT && ($row['left_id'] + 1 == $row['right_id']))
+        {
+            // Non-postable forum with no subforums, don't display
+            continue;
+        }
+
+        // Skip branch
+        if (isset($right_id))
+        {
+            if ($row['left_id'] < $right_id)
+            {
+                continue;
+            }
+            unset($right_id);
+        }
+
+        if (!$auth->acl_get('f_list', $forum_id) || (isset($mobiquo_config['hide_forum_id']) && in_array($forum_id, $mobiquo_config['hide_forum_id'])))
+        {
+            // if the user does not have permissions to list this forum, skip everything until next branch
+            $right_id = $row['right_id'];
+            continue;
+        }
+        
+        $row['unread_count'] = 0;
+        
+        if ($user->data['is_registered'] && ($config['email_enable'] || $config['jab_enable']) && $config['allow_forum_notify'] && $row['forum_type'] == FORUM_POST && $auth->acl_get('f_subscribe', $forum_id))
+        {
+            $row['can_subscribe'] = true;
+            $row['is_subscribed'] = isset($row['notify_status']) && !is_null($row['notify_status']) && $row['notify_status'] !== '' ? true : false;
+        } else {
+            $row['can_subscribe'] = false;
+            $row['is_subscribed'] = false;
+        }
+        
+        $forum_rows[$forum_id] = $row;
+    }
+    $db->sql_freeresult($result);
+    
+    $fids = array(-1);
+    foreach($forum_rows as $id => $value)
+    {
+        if (!in_array($value['parent_id'], $fids))
+            unset($forum_rows[$id]);
+        else
+            $fids[] = $id;
+    }
+    
+    while(empty($forum_rows[$root_forum_id]['child']) && count($forum_rows) > 1)
+    {
+        $current_parent_id = -1;
+        $leaves_forum = array();
+        foreach($forum_rows as $row)
+        {
+            $row_parent_id = $row['parent_id'];
+            
+            if ($row_parent_id != $current_parent_id)
+            {
+                if(isset($leaves_forum[$row_parent_id]))
+                {
+                    $leaves_forum[$row_parent_id] = array();
+                }
+                else
+                {
+                    if(isset($leaves_forum[$forum_rows[$row_parent_id]['parent_id']]))
+                    {
+                        $leaves_forum[$forum_rows[$row_parent_id]['parent_id']] = array();
+                    }
+                    $leaves_forum[$row_parent_id][] = $row['forum_id'];
+                }
+                $current_parent_id = $row_parent_id;
+            }
+            else if ($row_parent_id == $current_parent_id)
+            {
+                if(!empty($leaves_forum[$row_parent_id]))
+                {
+                    $leaves_forum[$row_parent_id][] = $row['forum_id'];
+                }
+            }
+        }
+        
+        foreach($leaves_forum as $node_forum_id => $leaves)
+        {
+            foreach($leaves as $forum_id)
+            {
+                $forum =& $forum_rows[$forum_id];
+                
+                $logo_url = '';
+                if (file_exists("./forum_icons/$forum_id.png"))
+                {
+                    $logo_url = $phpbb_home."mobiquo/forum_icons/$forum_id.png";
+                }
+                else if (file_exists("./forum_icons/$forum_id.jpg"))
+                {
+                    $logo_url = $phpbb_home."mobiquo/forum_icons/$forum_id.jpg";
+                }
+                else if (file_exists("./forum_icons/default.png"))
+                {
+                    $logo_url = $phpbb_home."mobiquo/forum_icons/default.png";
+                }
+                else if ($forum['forum_image'])
+                {
+                    $logo_url = $phpbb_home.$forum['forum_image'];
+                }
+                
+                if (function_exists('get_unread_topics'))
+                    $unread_count = count(get_unread_topics(false, "AND t.forum_id = $forum_id"));
+                else
+                    $unread_count = count(tt_get_unread_topics(false, "AND t.forum_id = $forum_id"));
+                
+                $forum['unread_count'] += $unread_count;
+                if ($forum['unread_count'])
+                {
+                    $forum_rows[$forum['parent_id']]['unread_count'] += $forum['unread_count'];
+                }
+                
+                $xmlrpc_forum = array(
+                    'forum_id'      => new xmlrpcval($forum_id),
+                    'forum_name'    => new xmlrpcval(basic_clean($forum['forum_name']), 'base64'),
+                    'parent_id'     => new xmlrpcval($node_forum_id),
+                    'logo_url'      => new xmlrpcval($logo_url),
+                    'url'           => new xmlrpcval($forum['forum_link']),
+                );
+                
+                if ($forum['unread_count'])     $xmlrpc_forum['unread_count']       = new xmlrpcval($forum['unread_count'], 'int');
+                if ($forum['unread_count'])     $xmlrpc_forum['new_post']           = new xmlrpcval(true, 'boolean');
+                if ($forum['forum_password'])   $xmlrpc_forum['is_protected']       = new xmlrpcval(true, 'boolean');
+                if ($forum['can_subscribe'])    $xmlrpc_forum['can_subscribe']      = new xmlrpcval(true, 'boolean');
+                if ($forum['is_subscribed'])    $xmlrpc_forum['is_subscribed']      = new xmlrpcval(true, 'boolean');
+                if ($forum['forum_type'] != FORUM_POST) $xmlrpc_forum['sub_only']   = new xmlrpcval(true, 'boolean');
+                
+                if ($return_description)
+                {
+                    $description = smiley_text($forum['forum_desc'], true);
+                    $description = generate_text_for_display($description, $forum['forum_desc_uid'], $forum['forum_desc_bitfield'], $forum['forum_desc_options']);
+                    $description = preg_replace('/<br *?\/?>/i', "\n", $description);
+                    $xmlrpc_forum['description'] = new xmlrpcval(basic_clean($description), 'base64');
+                }
+                
+                if (isset($forum['child'])) {
+                    $xmlrpc_forum['child'] = new xmlrpcval($forum['child'], 'array');
+                }
+                
+                $forum_rows[$node_forum_id]['child'][] = new xmlrpcval($xmlrpc_forum, 'struct');
+                unset($forum_rows[$forum_id]);
+            }
+        }
+    }
+    
+    $response = new xmlrpcval($forum_rows[$root_forum_id]['child'], 'array');
+    
+    return new xmlrpcresp($response);
+} // End of get_forum_func
diff -ruN phpBB-3.0.10/mobiquo/function/get_id_by_url.php phpbb/mobiquo/function/get_id_by_url.php
--- phpBB-3.0.10/mobiquo/function/get_id_by_url.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/function/get_id_by_url.php	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,71 @@
+<?php
+/**
+*
+* @copyright (c) 2009, 2010, 2011 Quoord Systems Limited
+* @license http://opensource.org/licenses/gpl-2.0.php GNU Public License (GPLv2)
+*
+*/
+
+defined('IN_MOBIQUO') or exit;
+
+function get_id_by_url_func($xmlrpc_params)
+{    
+    global $phpbb_home;
+    
+    $params = php_xmlrpc_decode($xmlrpc_params);
+    $url = trim($params[0]);
+    
+    if (strpos($url, $phpbb_home) === 0)
+    {
+        $path = '/' . substr($url, strlen($phpbb_home));
+        $fid = $tid = $pid = "";
+        
+        // get forum id
+        if (preg_match('/(\?|&|;)(f|fid|board)=(\d+)(\W|$)/', $path, $match)) {
+            $fid = $match['3'];
+        } elseif (preg_match('/\W(f|forum)-?(\d+)(\W|$)/', $path, $match)) {
+            $fid = $match['2'];
+        } elseif (preg_match('/\/forum\/(\d+)-(\w|-)+(\W|$)/', $path, $match)) {
+            $fid = $match['1'];
+            $path = str_replace($match[0], $match[3], $path);
+        } elseif (preg_match('/forumdisplay\.php(\?|\/)(\d+)(\W|$)/', $path, $match)) {
+            $fid = $match['2'];
+            $path = str_replace($match[0], $match[3], $path);
+        } elseif (preg_match('/(index\.php\?|\/)forums\/.+\.(\d+)/', $path, $match)) {
+            $fid = $match['2'];
+        }
+        
+        // get topic id
+        if (preg_match('/(\?|&|;)(t|tid|topic)=(\d+)(\W|$)/', $path, $match)) {
+            $tid = $match['3'];
+        } elseif (preg_match('/\W(t|(\w|-)+-t_|topic|article)-?(\d+)(\W|$)/', $path, $match)) {
+            $tid = $match['3'];
+        } elseif (preg_match('/showthread\.php(\?|\/)(\d+)(\W|$)/', $path, $match)) {
+            $tid = $match['2'];
+        } elseif (preg_match('/(\?|\/)(\d+)-(\w|-)+(\.|\/|$)/', $path, $match)) {
+            $tid = $match['2'];
+        } elseif (preg_match('/(\?|\/)(\w|-)+-(\d+)(\.|\/|$)/', $path, $match)) {
+            $tid = $match['3'];
+        } elseif (preg_match('/(index\.php\?|\/)threads\/.+\.(\d+)/', $path, $match)) {
+            $tid = $match['2'];
+        }
+        
+        // get post id
+        if (preg_match('/(\?|&|;)(p|pid)=(\d+)(\W|$)/', $path, $match)) {
+            $pid = $match['3'];
+        } elseif (preg_match('/\W(p|(\w|-)+-p|post|msg)(-|_)?(\d+)(\W|$)/', $path, $match)) {
+            $pid = $match['4'];
+        } elseif (preg_match('/__p__(\d+)(\W|$)/', $path, $match)) {
+            $pid = $match['1'];
+        }
+    }
+    
+    $result = array();
+    if ($fid) $result['forum_id'] = new xmlrpcval($fid, 'string');
+    if ($tid) $result['topic_id'] = new xmlrpcval($tid, 'string');
+    if ($pid) $result['post_id'] = new xmlrpcval($pid, 'string');
+    
+    $response = new xmlrpcval($result, 'struct');
+    
+    return new xmlrpcresp($response);
+}
\ No newline at end of file
diff -ruN phpBB-3.0.10/mobiquo/function/get_inbox_stat.php phpbb/mobiquo/function/get_inbox_stat.php
--- phpBB-3.0.10/mobiquo/function/get_inbox_stat.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/function/get_inbox_stat.php	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,55 @@
+<?php
+/**
+*
+* @copyright (c) 2009, 2010, 2011 Quoord Systems Limited
+* @license http://opensource.org/licenses/gpl-2.0.php GNU Public License (GPLv2)
+*
+*/
+
+defined('IN_MOBIQUO') or exit;
+
+function get_inbox_stat_func()
+{
+    global $db, $user, $config, $auth, $mobiquo_config;
+    
+    $user->setup('ucp');
+    if (!$user->data['is_registered']) trigger_error('LOGIN_EXPLAIN_UCP');
+    
+    // get unread number of subscribed topic
+    $forbidden_forums = $auth->acl_getf('!f_read', true);
+    $forbidden_forums = array_unique(array_keys($forbidden_forums));
+    
+    if (isset($mobiquo_config['hide_forum_id']))
+    {
+        $forbidden_forums = array_unique(array_merge($forbidden_forums, $mobiquo_config['hide_forum_id']));
+    }
+    
+    $sql = 'SELECT t.topic_id, t.forum_id, t.topic_last_post_time
+            FROM ' . TOPICS_WATCH_TABLE . ' tw
+            LEFT JOIN ' . TOPICS_TABLE . ' t ON tw.topic_id=t.topic_id
+            WHERE tw.user_id = ' . $user->data['user_id'] . '
+                AND ' . $db->sql_in_set('t.forum_id', $forbidden_forum_ary, true, true) . '
+                AND t.topic_last_post_time > ' . $user->data['user_lastvisit'];
+    $result = $db->sql_query($sql);
+    $subscribed_topic_unread_count = 0;
+    while ($row = $db->sql_fetchrow($result))
+    {
+        $topic_id = $row['topic_id'];
+        $forum_id = $row['forum_id'];
+        $topic_tracking = get_complete_topic_tracking($forum_id, $topic_id);
+        if ($topic_tracking[$topic_id] < $row['topic_last_post_time'])
+        {
+            $subscribed_topic_unread_count++;
+        }
+    }
+    $db->sql_freeresult($result);
+    
+    $inbox_unread_count = $user->data['user_unread_privmsg'] ? $user->data['user_unread_privmsg'] : 0;
+    
+    $result = new xmlrpcval(array(
+        'inbox_unread_count' => new xmlrpcval($inbox_unread_count, 'int'),
+        'subscribed_topic_unread_count' => new xmlrpcval($subscribed_topic_unread_count, 'int'),
+    ), 'struct');
+
+    return new xmlrpcresp($result);
+}
diff -ruN phpBB-3.0.10/mobiquo/function/get_message.php phpbb/mobiquo/function/get_message.php
--- phpBB-3.0.10/mobiquo/function/get_message.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/function/get_message.php	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,97 @@
+<?php
+/**
+*
+* @copyright (c) 2009, 2010, 2011 Quoord Systems Limited
+* @license http://opensource.org/licenses/gpl-2.0.php GNU Public License (GPLv2)
+*
+*/
+
+defined('IN_MOBIQUO') or exit;
+
+function get_message_func($xmlrpc_params)
+{
+    global $db, $auth, $user, $config, $template, $phpbb_root_path, $phpEx;
+    
+    $user->setup('ucp');
+    
+    $params = php_xmlrpc_decode($xmlrpc_params);
+    
+    if (!$user->data['is_registered']) trigger_error('LOGIN_EXPLAIN_UCP');
+    if (!$config['allow_privmsg']) trigger_error('Module not accessible');
+
+    // get msg id from parameters
+    $msg_id = intval($params[0]);
+    if (!$msg_id) trigger_error('NO_MESSAGE');
+    $GLOBALS['return_html'] = isset($params[2]) ? $params[2] : false;
+    
+    $message_row = array();
+
+    // Get Message user want to see
+    $sql = 'SELECT t.*, p.*, u.*
+            FROM ' . PRIVMSGS_TO_TABLE . ' t, ' . PRIVMSGS_TABLE . ' p, ' . USERS_TABLE . ' u
+            WHERE t.user_id = ' . $user->data['user_id'] . "
+            AND p.author_id = u.user_id
+            AND t.msg_id = p.msg_id
+            AND p.msg_id = $msg_id";
+    $result = $db->sql_query($sql);
+    $message_row = $db->sql_fetchrow($result);
+    $db->sql_freeresult($result);
+
+    if (!$message_row) trigger_error('NO_MESSAGE');
+    
+    $message_row['message_text'] = preg_replace('/\[b:'.$message_row['bbcode_uid'].'\](.*?)\[\/b:'.$message_row['bbcode_uid'].'\]/si', '[b]$1[/b]', $message_row['message_text']);
+    $message_row['message_text'] = preg_replace('/\[i:'.$message_row['bbcode_uid'].'\](.*?)\[\/i:'.$message_row['bbcode_uid'].'\]/si', '[i]$1[/i]', $message_row['message_text']);
+    $message_row['message_text'] = preg_replace('/\[u:'.$message_row['bbcode_uid'].'\](.*?)\[\/u:'.$message_row['bbcode_uid'].'\]/si', '[u]$1[/u]', $message_row['message_text']);
+    $message_row['message_text'] = preg_replace('/\[color=#(\w{6}):'.$message_row['bbcode_uid'].'\](.*?)\[\/color:'.$message_row['bbcode_uid'].'\]/si', '[color=#$1]$2[/color]', $message_row['message_text']);
+    
+    // Update unread status
+    $user->add_lang('posting');
+    include_once($phpbb_root_path . 'includes/functions_privmsgs.' . $phpEx);
+    update_unread_status($message_row['pm_unread'], $message_row['msg_id'], $user->data['user_id'], $message_row['folder_id']);
+    
+    include($phpbb_root_path . 'includes/ucp/ucp_pm_viewmessage.' . $phpEx);
+    view_message('', '', $message_row['folder_id'], $msg_id, '', $message_row);
+    
+    $msg_to = array();
+    foreach ($template->_tpldata['to_recipient'] as $address_row)
+    {
+        $msg_to[] = new xmlrpcval(array(
+            'user_id'  => new xmlrpcval($address_row['UG_ID'], 'string'),
+            'username' => new xmlrpcval($address_row['NAME'], 'base64'),
+        ), 'struct');
+    }
+
+    $sent_date  = mobiquo_iso8601_encode($message_row['message_time']);
+    $icon_url   = ($user->optionget('viewavatars')) ? get_user_avatar_url($message_row['user_avatar'], $message_row['user_avatar_type']) : '';
+    $msg_subject = html_entity_decode(strip_tags(censor_text($message_row['message_subject'])));
+    $msg_body = post_html_clean(parse_quote($template->_rootref['MESSAGE']));
+    
+    if ($config['load_onlinetrack']) {
+        $sql = 'SELECT session_user_id, MAX(session_time) as online_time, MIN(session_viewonline) AS viewonline
+                FROM ' . SESSIONS_TABLE . '
+                WHERE session_user_id=' . $message_row['user_id'] . '
+                GROUP BY session_user_id';
+        $result = $db->sql_query($sql);
+        $online_info = $db->sql_fetchrow($result);
+        
+        $update_time = $config['load_online_time'] * 60;
+        $is_online = (time() - $update_time < $online_info['online_time'] && (($online_info['viewonline']) || $auth->acl_get('u_viewonline'))) ? true : false;
+    } else {
+        $is_online = false;
+    }
+    
+    $result = new xmlrpcval(array(
+        'msg_from'      => new xmlrpcval($message_row['username'], 'base64'),
+        'msg_from_id'   => new xmlrpcval($message_row['user_id'], 'string'),
+        'msg_to'        => new xmlrpcval($msg_to, 'array'),
+        'icon_url'      => new xmlrpcval($icon_url),
+        'sent_date'     => new xmlrpcval($sent_date, 'dateTime.iso8601'),
+        'timestamp'     => new xmlrpcval($message_row['message_time'], 'string'),
+        'msg_subject'   => new xmlrpcval($msg_subject, 'base64'),
+        'text_body'     => new xmlrpcval($msg_body, 'base64'),
+        'is_online'     => new xmlrpcval($is_online, 'boolean'),
+        'allow_smilies' => new xmlrpcval($message_row['enable_smilies'] ? true : false, 'boolean'),
+    ), 'struct');
+    
+    return new xmlrpcresp($result);
+}
diff -ruN phpBB-3.0.10/mobiquo/function/get_online_users.php phpbb/mobiquo/function/get_online_users.php
--- phpBB-3.0.10/mobiquo/function/get_online_users.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/function/get_online_users.php	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,298 @@
+<?php
+/**
+*
+* @copyright (c) 2009, 2010, 2011 Quoord Systems Limited
+* @license http://opensource.org/licenses/gpl-2.0.php GNU Public License (GPLv2)
+*
+*/
+
+defined('IN_MOBIQUO') or exit;
+
+function get_online_users_func() 
+{    
+    global $db, $auth, $config, $user;
+    
+    $user->setup('memberlist');
+
+    // Get and set some variables
+    $mode        = '';
+    $session_id    = '';
+    $start        = 0;
+    $sort_key    = 'b';
+    $sort_dir    = 'd';
+    $show_guests= 0;
+    
+    if (!$user->data['is_registered']) 
+        trigger_error('LOGIN_EXPLAIN_VIEWONLINE');
+    if (!$auth->acl_gets('u_viewprofile', 'a_user', 'a_useradd', 'a_userdel'))
+        trigger_error('NO_VIEW_USERS');
+    
+    $sort_key_sql = array('a' => 'u.username_clean', 'b' => 's.session_time', 'c' => 's.session_page');
+    
+    $order_by = $sort_key_sql[$sort_key] . ' ' . (($sort_dir == 'a') ? 'ASC' : 'DESC');
+    
+    // Forum info
+    $sql = 'SELECT forum_id, forum_name, parent_id, forum_type, left_id, right_id
+        FROM ' . FORUMS_TABLE . '
+        ORDER BY left_id ASC';
+    $result = $db->sql_query($sql, 600);
+    
+    $forum_data = array();
+    while ($row = $db->sql_fetchrow($result))
+    {
+        $forum_data[$row['forum_id']] = $row;
+    }
+    $db->sql_freeresult($result);
+    
+    $guest_counter = 0;
+    
+    // Get number of online guests (if we do not display them)
+    if (!$show_guests)
+    {
+        switch ($db->sql_layer)
+        {
+            case 'sqlite':
+                $sql = 'SELECT COUNT(session_ip) as num_guests
+                    FROM (
+                        SELECT DISTINCT session_ip
+                            FROM ' . SESSIONS_TABLE . '
+                            WHERE session_user_id = ' . ANONYMOUS . '
+                                AND session_time >= ' . (time() - ($config['load_online_time'] * 60)) .
+                    ')';
+            break;
+    
+            default:
+                $sql = 'SELECT COUNT(DISTINCT session_ip) as num_guests
+                    FROM ' . SESSIONS_TABLE . '
+                    WHERE session_user_id = ' . ANONYMOUS . '
+                        AND session_time >= ' . (time() - ($config['load_online_time'] * 60));
+            break;
+        }
+        $result = $db->sql_query($sql);
+        $guest_counter = (int) $db->sql_fetchfield('num_guests');
+        $db->sql_freeresult($result);
+    }
+    
+    // Get user list
+    $sql = 'SELECT u.user_id, u.username, u.username_clean, u.user_type, u.user_avatar, u.user_avatar_type, s.session_id, s.session_time, s.session_page, s.session_ip, s.session_browser, s.session_viewonline, s.session_forum_id
+        FROM ' . USERS_TABLE . ' u, ' . SESSIONS_TABLE . ' s
+        WHERE u.user_id = s.session_user_id
+            AND s.session_time >= ' . (time() - ($config['load_online_time'] * 60)) .
+            ((!$show_guests) ? ' AND s.session_user_id <> ' . ANONYMOUS : '') . '
+        ORDER BY ' . $order_by;
+    $result = $db->sql_query($sql);
+    
+    $prev_id = $prev_ip = $user_list = array();
+    $logged_visible_online = $logged_hidden_online = $counter = 0;
+    
+    while ($row = $db->sql_fetchrow($result))
+    {
+        if ($row['user_id'] != ANONYMOUS && !isset($prev_id[$row['user_id']]))
+        {
+            $view_online = $s_user_hidden = false;
+   
+            if (!$row['session_viewonline'])
+            {
+                $view_online = ($auth->acl_get('u_viewonline')) ? true : false;
+                $logged_hidden_online++;
+    
+                $s_user_hidden = true;
+            }
+            else
+            {
+                $view_online = true;
+                $logged_visible_online++;
+            }
+    
+            $prev_id[$row['user_id']] = 1;
+    
+            if ($view_online)
+            {
+                $counter++;
+            }
+    
+            if (!$view_online || $counter > $start + 100 || $counter <= $start)
+            {
+                continue;
+            }
+        }
+        else if ($show_guests && $row['user_id'] == ANONYMOUS && !isset($prev_ip[$row['session_ip']]))
+        {
+            $prev_ip[$row['session_ip']] = 1;
+            $guest_counter++;
+            $counter++;
+    
+            if ($counter > $start + 100 || $counter <= $start)
+            {
+                continue;
+            }
+    
+            $s_user_hidden = false;
+        }
+        else
+        {
+            continue;
+        }
+    
+        preg_match('#^([a-z0-9/_-]+)#i', $row['session_page'], $on_page);
+        if (!sizeof($on_page))
+        {
+            $on_page[1] = '';
+        }
+    
+        switch ($on_page[1])
+        {
+            case 'index':
+                $location = $user->lang['INDEX'];
+                $location_url = append_sid("{$phpbb_root_path}index.$phpEx");
+            break;
+    
+            case 'adm/index':
+                $location = $user->lang['ACP'];
+                $location_url = append_sid("{$phpbb_root_path}index.$phpEx");
+            break;
+    
+            case 'posting':
+            case 'viewforum':
+            case 'viewtopic':
+                $forum_id = $row['session_forum_id'];
+    
+                if ($forum_id && $auth->acl_get('f_list', $forum_id))
+                {
+                    $location = '';
+                    $location_url = append_sid("{$phpbb_root_path}viewforum.$phpEx", 'f=' . $forum_id);
+    
+                    if ($forum_data[$forum_id]['forum_type'] == FORUM_LINK)
+                    {
+                        $location = sprintf($user->lang['READING_LINK'], $forum_data[$forum_id]['forum_name']);
+                        break;
+                    }
+    
+                    switch ($on_page[1])
+                    {
+                        case 'posting':
+                            preg_match('#mode=([a-z]+)#', $row['session_page'], $on_page);
+                            $posting_mode = (!empty($on_page[1])) ? $on_page[1] : '';
+    
+                            switch ($posting_mode)
+                            {
+                                case 'reply':
+                                case 'quote':
+                                    $location = sprintf($user->lang['REPLYING_MESSAGE'], $forum_data[$forum_id]['forum_name']);
+                                break;
+    
+                                default:
+                                    $location = sprintf($user->lang['POSTING_MESSAGE'], $forum_data[$forum_id]['forum_name']);
+                                break;
+                            }
+                        break;
+    
+                        case 'viewtopic':
+                            $location = sprintf($user->lang['READING_TOPIC'], $forum_data[$forum_id]['forum_name']);
+                        break;
+    
+                        case 'viewforum':
+                            $location = sprintf($user->lang['READING_FORUM'], $forum_data[$forum_id]['forum_name']);
+                        break;
+                    }
+                }
+                else
+                {
+                    $location = $user->lang['INDEX'];
+                    $location_url = append_sid("{$phpbb_root_path}index.$phpEx");
+                }
+            break;
+    
+            case 'search':
+                $location = $user->lang['SEARCHING_FORUMS'];
+                $location_url = append_sid("{$phpbb_root_path}search.$phpEx");
+            break;
+    
+            case 'faq':
+                $location = $user->lang['VIEWING_FAQ'];
+                $location_url = append_sid("{$phpbb_root_path}faq.$phpEx");
+            break;
+    
+            case 'viewonline':
+                $location = $user->lang['VIEWING_ONLINE'];
+                $location_url = append_sid("{$phpbb_root_path}viewonline.$phpEx");
+            break;
+    
+            case 'memberlist':
+                $location = (strpos($row['session_page'], 'mode=viewprofile') !== false) ? $user->lang['VIEWING_MEMBER_PROFILE'] : $user->lang['VIEWING_MEMBERS'];
+                $location_url = append_sid("{$phpbb_root_path}memberlist.$phpEx");
+            break;
+    
+            case 'mcp':
+                $location = $user->lang['VIEWING_MCP'];
+                $location_url = append_sid("{$phpbb_root_path}index.$phpEx");
+            break;
+    
+            case 'ucp':
+                $location = $user->lang['VIEWING_UCP'];
+    
+                // Grab some common modules
+                $url_params = array(
+                    'mode=register'        => 'VIEWING_REGISTER',
+                    'i=pm&mode=compose'    => 'POSTING_PRIVATE_MESSAGE',
+                    'i=pm&'                => 'VIEWING_PRIVATE_MESSAGES',
+                    'i=profile&'        => 'CHANGING_PROFILE',
+                    'i=prefs&'            => 'CHANGING_PREFERENCES',
+                );
+    
+                foreach ($url_params as $param => $lang)
+                {
+                    if (strpos($row['session_page'], $param) !== false)
+                    {
+                        $location = $user->lang[$lang];
+                        break;
+                    }
+                }
+    
+                $location_url = append_sid("{$phpbb_root_path}index.$phpEx");
+            break;
+    
+            case 'download/file':
+                $location = $user->lang['DOWNLOADING_FILE'];
+                $location_url = append_sid("{$phpbb_root_path}index.$phpEx");
+            break;
+    
+            case 'report':
+                $location = $user->lang['REPORTING_POST'];
+                $location_url = append_sid("{$phpbb_root_path}index.$phpEx");
+            break;
+            
+            case 'mobiquo/mobiquo':
+                $location = 'via Tapatalk';
+            break;
+    
+            default:
+                $location = $user->lang['INDEX'];
+                $location_url = append_sid("{$phpbb_root_path}index.$phpEx");
+            break;
+        }
+        
+        $user_avatar_url = get_user_avatar_url($row['user_avatar'], $row['user_avatar_type']);
+        
+        $user_list[] = new xmlrpcval(array(
+            'user_id'       => new xmlrpcval($row['user_id'], 'string'),
+            'username'      => new xmlrpcval($row['username'], 'base64'),
+            'user_name'     => new xmlrpcval($row['username'], 'base64'),
+            'icon_url'      => new xmlrpcval($user_avatar_url),
+            'display_text'  => new xmlrpcval($location, 'base64')
+        ), 'struct');
+        
+    }
+    $db->sql_freeresult($result);
+    unset($prev_id, $prev_ip);
+    
+    $online_users = array(
+        'member_count' => new xmlrpcval($logged_visible_online + $logged_hidden_online, 'int'),
+        'guest_count'  => new xmlrpcval($guest_counter, 'int'),
+        'list'         => new xmlrpcval($user_list, 'array')
+    );
+    
+    $response = new xmlrpcval($online_users, 'struct');
+
+    return new xmlrpcresp($response);
+}
diff -ruN phpBB-3.0.10/mobiquo/function/get_participated_forum.php phpbb/mobiquo/function/get_participated_forum.php
--- phpBB-3.0.10/mobiquo/function/get_participated_forum.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/function/get_participated_forum.php	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,117 @@
+<?php
+/**
+*
+* @copyright (c) 2009, 2010, 2011 Quoord Systems Limited
+* @license http://opensource.org/licenses/gpl-2.0.php GNU Public License (GPLv2)
+*
+*/
+
+defined('IN_MOBIQUO') or exit;
+
+function get_participated_forum_func()
+{
+    global $config, $db, $user, $auth, $mobiquo_config, $phpbb_home;
+    
+    $user->setup('ucp');
+    
+    if (!$user->data['is_registered']) trigger_error('LOGIN_EXPLAIN_UCP');
+
+    $forbidden_forums = $auth->acl_getf('!f_read', true);
+    $forbidden_forums = array_unique(array_keys($forbidden_forums));
+    
+    if (isset($mobiquo_config['hide_forum_id']))
+    {
+        $forbidden_forums = array_unique(array_merge($forbidden_forums, $mobiquo_config['hide_forum_id']));
+    }
+
+    $sql_array = array(
+        'SELECT' => 'DISTINCT f.forum_id, f.*',
+
+        'FROM'   => array(
+            POSTS_TABLE     => 'p',
+            FORUMS_TABLE    => 'f'
+        ),
+
+        'WHERE'  => 'p.poster_id = ' . $user->data['user_id'] . '
+            AND f.forum_id = p.forum_id
+            AND ' . $db->sql_in_set('f.forum_id', $forbidden_forums, true, true),
+
+        'ORDER_BY'    => 'left_id'
+    );
+
+    if ($config['load_db_lastread'])
+    {
+        $sql_array['LEFT_JOIN'] = array(
+            array(
+                'FROM'    => array(FORUMS_TRACK_TABLE => 'ft'),
+                'ON'    => 'ft.user_id = ' . $user->data['user_id'] . ' AND ft.forum_id = f.forum_id'
+            )
+        );
+
+        $sql_array['SELECT'] .= ', ft.mark_time ';
+    }
+    else
+    {
+        $tracking_topics = (isset($_COOKIE[$config['cookie_name'] . '_track'])) ? ((STRIP) ? stripslashes($_COOKIE[$config['cookie_name'] . '_track']) : $_COOKIE[$config['cookie_name'] . '_track']) : '';
+        $tracking_topics = ($tracking_topics) ? tracking_unserialize($tracking_topics) : array();
+    }
+
+    $sql = $db->sql_build_query('SELECT', $sql_array);
+    $result = $db->sql_query($sql);
+    
+    $forum_list = array();
+    while ($row = $db->sql_fetchrow($result))
+    {
+        $forum_id = $row['forum_id'];
+        
+        if ($config['load_db_lastread'])
+        {
+            $forum_check = (!empty($row['mark_time'])) ? $row['mark_time'] : $user->data['user_lastmark'];
+        }
+        else
+        {
+            $forum_check = (isset($tracking_topics['f'][$forum_id])) ? (int) (base_convert($tracking_topics['f'][$forum_id], 36, 10) + $config['board_startdate']) : $user->data['user_lastmark'];
+        }
+
+        $unread_forum = ($row['forum_last_post_time'] > $forum_check) ? true : false;
+        
+        $logo_url = '';
+        if (file_exists("./forum_icons/$forum_id.png"))
+        {
+            $logo_url = $phpbb_home."mobiquo/forum_icons/$forum_id.png";
+        }
+        else if (file_exists("./forum_icons/$forum_id.jpg"))
+        {
+            $logo_url = $phpbb_home."mobiquo/forum_icons/$forum_id.jpg";
+        }
+        else if (file_exists("./forum_icons/default.png"))
+        {
+            $logo_url = $phpbb_home."mobiquo/forum_icons/default.png";
+        }
+        else if ($row['forum_image'])
+        {
+            $logo_url = $phpbb_home.$row['forum_image'];
+        }
+        
+        $xmlrpc_forum = new xmlrpcval(array(
+            'forum_id'      => new xmlrpcval($forum_id),
+            'forum_name'    => new xmlrpcval(html_entity_decode($row['forum_name']), 'base64'),
+            'icon_url'      => new xmlrpcval($logo_url),
+            'is_protected'  => new xmlrpcval($row['forum_password'] ? true : false, 'boolean'),
+            'sub_only'      => new xmlrpcval(($row['forum_type'] == FORUM_POST) ? false : true, 'boolean'),
+            'new_post'      => new xmlrpcval($unread_forum, 'boolean'),
+        ), 'struct');
+
+        $forum_list[] = $xmlrpc_forum;
+    }
+    $db->sql_freeresult($result);
+
+    $forum_num = count($forum_list);
+    
+    $response = new xmlrpcval(array(
+        'total_forums_num' => new xmlrpcval($forum_num, 'int'),
+        'forums'    => new xmlrpcval($forum_list, 'array'),
+    ), 'struct');
+
+    return new xmlrpcresp($response);
+}
diff -ruN phpBB-3.0.10/mobiquo/function/get_quote_pm.php phpbb/mobiquo/function/get_quote_pm.php
--- phpBB-3.0.10/mobiquo/function/get_quote_pm.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/function/get_quote_pm.php	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,54 @@
+<?php
+/**
+*
+* @copyright (c) 2009, 2010, 2011 Quoord Systems Limited
+* @license http://opensource.org/licenses/gpl-2.0.php GNU Public License (GPLv2)
+*
+*/
+
+defined('IN_MOBIQUO') or exit;
+
+function get_quote_pm_func($xmlrpc_params)
+{
+    global $db, $auth, $user;
+    
+    $user->setup('ucp');
+    
+    $params = php_xmlrpc_decode($xmlrpc_params);
+    
+    // get msg id from parameters
+    $msg_id = intval($params[0]);
+    if (!$msg_id) trigger_error('NO_MESSAGE');
+    if (!$auth->acl_get('u_sendpm')) trigger_error('NO_AUTH_SEND_MESSAGE');
+    
+    $sql = 'SELECT p.*, u.username as quote_username
+            FROM ' . PRIVMSGS_TABLE . ' p, ' . USERS_TABLE . ' u
+            WHERE p.author_id = u.user_id
+            AND p.msg_id = '.$msg_id;
+
+    $result = $db->sql_query($sql);
+    $post = $db->sql_fetchrow($result);
+    $db->sql_freeresult($result);
+    
+    $msg_id = (int)$post['msg_id'];
+    
+    if (!$post) trigger_error('NO_MESSAGE');
+    
+    if ((!$post['author_id'] || ($post['author_id'] == ANONYMOUS && $action != 'delete')) && $msg_id)
+    {
+        trigger_error('NO_AUTHOR');
+    }
+
+    $message_subject = ((!preg_match('/^Re:/', $post['message_subject'])) ? 'Re: ' : '') . censor_text($post['message_subject']);
+    decode_message($post['message_text'], $post['bbcode_uid']);
+    $message = '[quote=&quot;' . $post['quote_username'] . '&quot;]' . censor_text(trim($post['message_text'])) . "[/quote]\n";
+    
+    return new xmlrpcresp(
+        new xmlrpcval(array(
+                'msg_id'        => new xmlrpcval($msg_id),
+                'msg_subject'   => new xmlrpcval(html_entity_decode(strip_tags($message_subject)), 'base64'),
+                'text_body'     => new xmlrpcval(html_entity_decode($message), 'base64'),
+            ), 'struct'
+        )
+    );
+}
diff -ruN phpBB-3.0.10/mobiquo/function/get_quote_post.php phpbb/mobiquo/function/get_quote_post.php
--- phpBB-3.0.10/mobiquo/function/get_quote_post.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/function/get_quote_post.php	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,110 @@
+<?php
+/**
+*
+* @copyright (c) 2009, 2010, 2011 Quoord Systems Limited
+* @license http://opensource.org/licenses/gpl-2.0.php GNU Public License (GPLv2)
+*
+*/
+
+defined('IN_MOBIQUO') or exit;
+
+function get_quote_post_func($xmlrpc_params)
+{
+    global $db, $auth, $user, $phpEx, $phpbb_root_path;
+    
+    $user->setup('posting');
+    
+    include($phpbb_root_path . 'includes/message_parser.' . $phpEx);
+
+    $params = php_xmlrpc_decode($xmlrpc_params);
+    
+    $post_ids = explode('-', $params[0]);
+    
+    $quote_messages = array();
+    foreach($post_ids as $post_id)
+    {
+        // get post id from parameters
+        $post_id = intval($post_id);
+        
+        $post_data = array();
+        
+        // We need to know some basic information in all cases before we do anything.
+        if (!$post_id) trigger_error('NO_POST');
+        
+        $sql = 'SELECT t.*, p.*, f.*, u.username
+                FROM ' . POSTS_TABLE . ' p
+                    LEFT JOIN ' . TOPICS_TABLE . ' t ON (p.topic_id = t.topic_id) 
+                    LEFT JOIN ' . FORUMS_TABLE . ' f ON (f.forum_id = t.forum_id OR (t.topic_type = ' . POST_GLOBAL . ' AND f.forum_type = ' . FORUM_POST . '))
+                    LEFT JOIN ' . USERS_TABLE  . ' u ON (p.poster_id = u.user_id)' . "
+                WHERE p.post_id = $post_id";
+        
+        $result = $db->sql_query_limit($sql, 1);
+        $post_data = $db->sql_fetchrow($result);
+        $db->sql_freeresult($result);
+        
+        if (!$post_data) trigger_error('NO_POST');
+        
+        // Use post_row values in favor of submitted ones...
+        $forum_id = (int) $post_data['forum_id'];
+        $topic_id = (int) $post_data['topic_id'];
+        $post_id  = (int) $post_data['post_id'];
+    
+        // Need to login to passworded forum first?
+        if ($post_data['forum_password'] && !check_forum_password($forum_id))
+        {
+            trigger_error('LOGIN_FORUM');
+        }
+    
+        // Is the user able to read within this forum?
+        if (!$auth->acl_get('f_read', $forum_id))
+        {
+            trigger_error('USER_CANNOT_READ');
+        }
+        
+        if (!$auth->acl_get('f_reply', $forum_id))
+        {
+            trigger_error('USER_CANNOT_REPLY');
+        }
+        
+        // Is the user able to post within this forum?
+        if ($post_data['forum_type'] != FORUM_POST)
+        {
+            trigger_error('USER_CANNOT_FORUM_POST');
+        }
+    
+        // Forum/Topic locked?
+        if (($post_data['forum_status'] == ITEM_LOCKED || (isset($post_data['topic_status']) && $post_data['topic_status'] == ITEM_LOCKED)) && !$auth->acl_get('m_edit', $forum_id))
+        {
+            trigger_error(($post_data['forum_status'] == ITEM_LOCKED) ? 'FORUM_LOCKED' : 'TOPIC_LOCKED');
+        }
+    
+    
+        // Determine some vars
+        if (isset($post_data['poster_id']) && $post_data['poster_id'] == ANONYMOUS)
+        {
+            $post_data['quote_username'] = (!empty($post_data['post_username'])) ? $post_data['post_username'] : $user->lang['GUEST'];
+        }
+        else
+        {
+            $post_data['quote_username'] = isset($post_data['username']) ? $post_data['username'] : '';
+        }
+    
+        $message_parser = new parse_message();
+        
+        if (isset($post_data['post_text']))
+        {
+            $message_parser->message = $post_data['post_text'];
+            $message_parser->decode_message($post_data['bbcode_uid']);
+            $message_parser->message = '[quote=&quot;' . $post_data['quote_username'] . '&quot;]' . censor_text(trim($message_parser->message)) . "[/quote]\n";
+            //$post_data['post_subject'] = ((strpos($post_data['post_subject'], 'Re: ') !== 0) ? 'Re: ' : '') . censor_text($post_data['post_subject']);
+            $quote_messages[] = $message_parser->message;
+        }
+    }
+    
+    return new xmlrpcresp(new xmlrpcval(array(
+        'post_id'       => new xmlrpcval($params[0]),
+        //'post_title'    => new xmlrpcval(basic_clean($post_data['post_subject']), 'base64'),
+        'post_title'    => new xmlrpcval('', 'base64'),
+        'post_content'  => new xmlrpcval(html_entity_decode(implode("\n\n", $quote_messages)), 'base64'),
+    ), 'struct'));
+}
diff -ruN phpBB-3.0.10/mobiquo/function/get_raw_post.php phpbb/mobiquo/function/get_raw_post.php
--- phpBB-3.0.10/mobiquo/function/get_raw_post.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/function/get_raw_post.php	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,113 @@
+<?php
+/**
+*
+* @copyright (c) 2009, 2010, 2011 Quoord Systems Limited
+* @license http://opensource.org/licenses/gpl-2.0.php GNU Public License (GPLv2)
+*
+*/
+
+defined('IN_MOBIQUO') or exit;
+
+function get_raw_post_func($xmlrpc_params)
+{
+    global $db, $auth, $user, $config, $template, $cache, $phpEx, $phpbb_root_path, $phpbb_home;
+    
+    $user->setup('posting');
+    
+    include($phpbb_root_path . 'includes/message_parser.' . $phpEx);
+
+    $params = php_xmlrpc_decode($xmlrpc_params);
+    
+    // get post id from parameters
+    $post_id = intval($params[0]);
+
+    $post_data = array();
+    $sql = 'SELECT p.*, t.*, f.*
+            FROM ' . POSTS_TABLE . ' p, ' . TOPICS_TABLE . ' t, ' . FORUMS_TABLE . " f
+            WHERE p.post_id = $post_id
+            AND t.topic_id = p.topic_id
+            AND (f.forum_id = t.forum_id OR (t.topic_type = " . POST_GLOBAL . ' AND f.forum_type = ' . FORUM_POST . '))';
+    
+    $result = $db->sql_query_limit($sql, 1);
+    $post_data = $db->sql_fetchrow($result);
+    $db->sql_freeresult($result);
+    
+    if (!$post_data) trigger_error('NO_POST');
+
+    // Use post_row values in favor of submitted ones...
+    $forum_id = (int) $post_data['forum_id'];
+    $topic_id = (int) $post_data['topic_id'];
+    $post_id  = (int) $post_id;
+    
+    // Need to login to passworded forum first?
+    if ($post_data['forum_password'] && !check_forum_password($forum_id))
+    {
+        trigger_error('LOGIN_FORUM');
+    }
+
+    // Is the user able to read within this forum?
+    if (!$auth->acl_get('f_read', $forum_id))
+    {
+        trigger_error('USER_CANNOT_READ');
+    }
+
+    // Permission to do the action asked?
+    if (!($user->data['is_registered'] && $auth->acl_gets('f_edit', 'm_edit', $forum_id)))
+    {
+        trigger_error('USER_CANNOT_EDIT');
+    }
+
+    // Forum/Topic locked?
+    if (($post_data['forum_status'] == ITEM_LOCKED || (isset($post_data['topic_status']) && $post_data['topic_status'] == ITEM_LOCKED)) && !$auth->acl_get('m_edit', $forum_id))
+    {
+        trigger_error(($post_data['forum_status'] == ITEM_LOCKED) ? 'FORUM_LOCKED' : 'TOPIC_LOCKED');
+    }
+
+    // Can we edit this post ... if we're a moderator with rights then always yes
+    // else it depends on editing times, lock status and if we're the correct user
+    if (!$auth->acl_get('m_edit', $forum_id))
+    {
+        if ($user->data['user_id'] != $post_data['poster_id'])
+        {
+            trigger_error('USER_CANNOT_EDIT');
+        }
+    
+        if (!($post_data['post_time'] > time() - ($config['edit_time'] * 60) || !$config['edit_time']))
+        {
+            trigger_error('CANNOT_EDIT_TIME');
+        }
+    
+        if ($post_data['post_edit_locked'])
+        {
+            trigger_error('CANNOT_EDIT_POST_LOCKED');
+        }
+    }
+
+    $message_parser = new parse_message();
+    
+    if (isset($post_data['post_text']))
+    {
+        $message_parser->message = &$post_data['post_text'];
+        unset($post_data['post_text']);
+    }
+
+    // Do we want to edit our post ?
+    if ($post_data['bbcode_uid'])
+    {
+        $message_parser->bbcode_uid = $post_data['bbcode_uid'];
+    }
+    
+    // Decode text for message display
+    $message_parser->decode_message($post_data['bbcode_uid']);
+    $post_data['post_text'] = $message_parser->message;
+
+    return new xmlrpcresp(
+        new xmlrpcval(array(
+                'post_id'       => new xmlrpcval($post_id),
+                'post_title'    => new xmlrpcval(html_entity_decode(strip_tags($post_data['post_subject'])), 'base64'),
+                'post_content'  => new xmlrpcval(html_entity_decode($post_data['post_text']), 'base64'),
+            ),
+            'struct'
+        )
+    );
+}
diff -ruN phpBB-3.0.10/mobiquo/function/get_subscribed_forum.php phpbb/mobiquo/function/get_subscribed_forum.php
--- phpBB-3.0.10/mobiquo/function/get_subscribed_forum.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/function/get_subscribed_forum.php	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,124 @@
+<?php
+/**
+*
+* @copyright (c) 2009, 2010, 2011 Quoord Systems Limited
+* @license http://opensource.org/licenses/gpl-2.0.php GNU Public License (GPLv2)
+*
+*/
+
+defined('IN_MOBIQUO') or exit;
+
+function get_subscribed_forum_func()
+{
+    global $config, $db, $user, $auth, $mobiquo_config, $phpbb_home;
+    
+    $user->setup('ucp');
+    
+    if (!$user->data['is_registered']) trigger_error('LOGIN_EXPLAIN_UCP');
+    
+    $forum_list = array();
+    if ($config['allow_forum_notify'])
+    {
+        $forbidden_forums = $auth->acl_getf('!f_read', true);
+        $forbidden_forums = array_unique(array_keys($forbidden_forums));
+        
+        if (isset($mobiquo_config['hide_forum_id']))
+        {
+            $forbidden_forums = array_unique(array_merge($forbidden_forums, $mobiquo_config['hide_forum_id']));
+        }
+    
+        $sql_array = array(
+            'SELECT' => 'f.*',
+    
+            'FROM'   => array(
+                FORUMS_WATCH_TABLE    => 'fw',
+                FORUMS_TABLE        => 'f'
+            ),
+    
+            'WHERE'  => 'fw.user_id = ' . $user->data['user_id'] . '
+                AND f.forum_id = fw.forum_id
+                AND ' . $db->sql_in_set('f.forum_id', $forbidden_forums, true, true),
+    
+            'ORDER_BY'    => 'left_id'
+        );
+    
+        if ($config['load_db_lastread'])
+        {
+            $sql_array['LEFT_JOIN'] = array(
+                array(
+                    'FROM'    => array(FORUMS_TRACK_TABLE => 'ft'),
+                    'ON'    => 'ft.user_id = ' . $user->data['user_id'] . ' AND ft.forum_id = f.forum_id'
+                )
+            );
+    
+            $sql_array['SELECT'] .= ', ft.mark_time ';
+        }
+        else
+        {
+            $tracking_topics = (isset($_COOKIE[$config['cookie_name'] . '_track'])) ? ((STRIP) ? stripslashes($_COOKIE[$config['cookie_name'] . '_track']) : $_COOKIE[$config['cookie_name'] . '_track']) : '';
+            $tracking_topics = ($tracking_topics) ? tracking_unserialize($tracking_topics) : array();
+        }
+    
+        $sql = $db->sql_build_query('SELECT', $sql_array);
+        $result = $db->sql_query($sql);
+        
+        $forum_list = array();
+        while ($row = $db->sql_fetchrow($result))
+        {
+            $forum_id = $row['forum_id'];
+            
+            if ($config['load_db_lastread'])
+            {
+                $forum_check = (!empty($row['mark_time'])) ? $row['mark_time'] : $user->data['user_lastmark'];
+            }
+            else
+            {
+                $forum_check = (isset($tracking_topics['f'][$forum_id])) ? (int) (base_convert($tracking_topics['f'][$forum_id], 36, 10) + $config['board_startdate']) : $user->data['user_lastmark'];
+            }
+    
+            $unread_forum = ($row['forum_last_post_time'] > $forum_check) ? true : false;
+            
+            $logo_url = '';
+            if (file_exists("./forum_icons/$forum_id.png"))
+            {
+                $logo_url = $phpbb_home."mobiquo/forum_icons/$forum_id.png";
+            }
+            else if (file_exists("./forum_icons/$forum_id.jpg"))
+            {
+                $logo_url = $phpbb_home."mobiquo/forum_icons/$forum_id.jpg";
+            }
+            else if (file_exists("./forum_icons/default.png"))
+            {
+                $logo_url = $phpbb_home."mobiquo/forum_icons/default.png";
+            }
+            else if ($row['forum_image'])
+            {
+                $logo_url = $phpbb_home.$row['forum_image'];
+            }
+            
+            $xmlrpc_forum = new xmlrpcval(array(
+                'forum_id'      => new xmlrpcval($forum_id),
+                'forum_name'    => new xmlrpcval(html_entity_decode($row['forum_name']), 'base64'),
+                'icon_url'      => new xmlrpcval($logo_url),
+                'is_protected'  => new xmlrpcval($row['forum_password'] ? true : false, 'boolean'),
+                'sub_only'      => new xmlrpcval(($row['forum_type'] == FORUM_POST) ? false : true, 'boolean'),
+                'new_post'      => new xmlrpcval($unread_forum, 'boolean'),
+            ), 'struct');
+    
+            $forum_list[] = $xmlrpc_forum;
+        }
+        $db->sql_freeresult($result);
+    }
+
+    $forum_num = count($forum_list);
+    
+    $response = new xmlrpcval(
+        array(
+            'total_forums_num' => new xmlrpcval($forum_num, 'int'),
+            'forums'    => new xmlrpcval($forum_list, 'array'),
+        ),
+        'struct'
+    );
+
+    return new xmlrpcresp($response);
+}
diff -ruN phpBB-3.0.10/mobiquo/function/get_topic.php phpbb/mobiquo/function/get_topic.php
--- phpBB-3.0.10/mobiquo/function/get_topic.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/function/get_topic.php	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,344 @@
+<?php
+/**
+*
+* @copyright (c) 2009, 2010, 2011 Quoord Systems Limited
+* @license http://opensource.org/licenses/gpl-2.0.php GNU Public License (GPLv2)
+*
+*/
+
+defined('IN_MOBIQUO') or exit;
+
+function get_topic_func($xmlrpc_params)
+{
+    global $db, $auth, $user, $config;
+    
+    $user->setup('viewforum');
+    
+    $params = php_xmlrpc_decode($xmlrpc_params);
+    
+    list($start, $limit) = process_page($params[1], $params[2]);
+    
+    // get forum id from parameters
+    $forum_id = intval($params[0]);
+    if (!$forum_id) trigger_error('NO_FORUM');
+    
+    // check if need sticky/announce topic only
+    $topic_type = '';
+    if (isset($params[3]))
+    {
+        // check if need sticky topic only
+        if ($params[3] == 'TOP')
+        {
+            $topic_type = POST_STICKY;
+            $start = 0;
+            $limit = 20;
+        }
+        // check if need announce topic only
+        else if ($params[3] == 'ANN')
+        {
+            $topic_type = POST_ANNOUNCE . ', ' . POST_GLOBAL;
+            $start = 0;
+            $limit = 20;
+        }
+    }
+
+//    $default_sort_days  = (!empty($user->data['user_topic_show_days'])) ? $user->data['user_topic_show_days'] : 0;
+//    $default_sort_key   = (!empty($user->data['user_topic_sortby_type'])) ? $user->data['user_topic_sortby_type'] : 't';
+//    $default_sort_dir   = (!empty($user->data['user_topic_sortby_dir'])) ? $user->data['user_topic_sortby_dir'] : 'd';
+//    
+//    $sort_days  = request_var('st', $default_sort_days); // default to get all topic
+//    $sort_key   = request_var('sk', $default_sort_key);  // default sort by last post time
+//    $sort_dir   = request_var('sd', $default_sort_dir);  // default sort as DESC
+    
+    $sort_days = 0;
+    $sort_key  = 't';
+    $sort_dir  = 'd';
+
+    //------- Grab appropriate forum data --------        
+    $sql = "SELECT f.* FROM " . FORUMS_TABLE . " f WHERE f.forum_id = $forum_id";
+    $result = $db->sql_query($sql);
+    $forum_data = $db->sql_fetchrow($result);
+    $db->sql_freeresult($result);
+
+    // Forum does not exist
+    if (!$forum_data) trigger_error('NO_FORUM');
+    
+    // Can not get topics from link forum
+    if ($forum_data['forum_type'] == FORUM_LINK)
+    {
+        trigger_error('NO_FORUM');
+    }
+    
+    // Permissions check
+    if (!$auth->acl_gets('f_list', 'f_read', $forum_id) || ($forum_data['forum_type'] == FORUM_LINK && $forum_data['forum_link'] && !$auth->acl_get('f_read', $forum_id)))
+    {
+        if ($user->data['user_id'] != ANONYMOUS)
+        {
+            trigger_error('SORRY_AUTH_READ');
+        }
+        
+        trigger_error('LOGIN_VIEWFORUM');
+    }
+    
+    
+    // Forum is passworded
+    if ($forum_data['forum_password'] && !check_forum_password($forum_id))
+    {
+        trigger_error('LOGIN_FORUM');
+    }
+
+    if (!$auth->acl_get('f_read', $forum_id))
+    {
+        trigger_error('NO_READ_ACCESS');
+    }
+
+    // Topic ordering options
+    $sort_by_sql = array('a' => 't.topic_first_poster_name', 
+                         't' => 't.topic_last_post_time',   // default one
+                         'r' => 't.topic_replies', 
+                         's' => 't.topic_title', 
+                         'v' => 't.topic_views');
+    
+    // Limit topics to certain time frame, obtain correct topic count
+    // global announcements must not be counted, normal announcements have to
+    // be counted, as forum_topics(_real) includes them
+    
+    $sql_approved = ($auth->acl_get('m_approve', $forum_id)) ? '' : ' AND t.topic_approved = 1 ';
+
+    // Get all shadow topics in this forum
+    $sql = 'SELECT t.topic_moved_id, t.topic_id
+            FROM ' . TOPICS_TABLE . ' t
+            WHERE t.forum_id = ' . $forum_id . '
+            AND t.topic_type IN (' . POST_NORMAL . ', ' . POST_STICKY . ', ' . POST_ANNOUNCE . ', ' . POST_GLOBAL . ')
+            AND t.topic_status = ' . ITEM_MOVED . ' ' .
+            $sql_approved;
+    $result = $db->sql_query($sql);
+    
+    $shadow_topic_list = array();
+    while ($row = $db->sql_fetchrow($result))
+    {
+        $shadow_topic_list[$row['topic_moved_id']] = $row['topic_id'];
+    }
+    $db->sql_freeresult($result);
+
+    // Pick out those shadow topics that the user has no permission to access
+    if (!empty($shadow_topic_list))
+    {
+        $sql = 'SELECT t.topic_id, t.forum_id
+                FROM ' . TOPICS_TABLE . ' t
+                WHERE ' . $db->sql_in_set('t.topic_id', array_keys($shadow_topic_list));
+        $result = $db->sql_query($sql);
+        
+        while ($row = $db->sql_fetchrow($result))
+        {
+            if ($auth->acl_get('f_read', $row['forum_id']))
+            {
+                unset($shadow_topic_list[$row['topic_id']]);
+            }
+        }
+        $db->sql_freeresult($result);
+    }
+
+    // Grab all topic data
+    $topic_list = array();
+    
+    $sql_limit = $limit;  // num of topics needs to be return, default is 20, at most 50
+    $sql_sort_order = $sort_by_sql[$sort_key] . ' ' . (($sort_dir == 'd') ? 'DESC' : 'ASC');
+    $sql_shadow_out = empty($shadow_topic_list) ? '' : 'AND ' . $db->sql_in_set('t.topic_moved_id', $shadow_topic_list, true);
+    
+    // If the user is trying to reach late pages, start searching from the end
+    $store_reverse = false;
+    
+    $unread_sticky_num = $unread_announce_count = 0;
+    if (!empty($topic_type)) // get top 20 announce/sticky topics only if need
+    {
+        $sql = 'SELECT t.*, u.user_avatar, u.user_avatar_type, tw.notify_status, bm.topic_id as bookmarked
+                FROM ' . TOPICS_TABLE . ' t
+                    LEFT JOIN ' . USERS_TABLE . ' u ON (t.topic_poster = u.user_id)
+                    LEFT JOIN ' . TOPICS_WATCH_TABLE . ' tw ON (tw.user_id = ' . $user->data['user_id'] . ' AND t.topic_id = tw.topic_id) 
+                    LEFT JOIN ' . BOOKMARKS_TABLE . ' bm ON (bm.user_id = ' . $user->data['user_id'] . ' AND t.topic_id = bm.topic_id) 
+                WHERE t.forum_id IN (' . $forum_id . ', 0)
+                AND t.topic_type IN (' . $topic_type . ') ' .
+                $sql_shadow_out . ' ' .
+                $sql_approved . '
+                ORDER BY ' . $sql_sort_order;
+        $result = $db->sql_query_limit($sql, $sql_limit, $start);
+    }
+    else
+    {
+        if ($user->data['user_id'] != ANONYMOUS)
+        {
+            // get total number of unread sticky topics number
+            $sql = 'SELECT t.topic_id, t.topic_last_post_time
+                    FROM ' . TOPICS_TABLE . ' t
+                    WHERE t.forum_id = ' . $forum_id.'
+                    AND t.topic_type = ' . POST_STICKY . ' ' .
+                    $sql_shadow_out . ' ' .
+                    $sql_approved;
+            $result = $db->sql_query($sql);
+            while ($row = $db->sql_fetchrow($result))
+            {
+                $topic_tracking = get_complete_topic_tracking($forum_id, $row['topic_id']);
+                if (isset($topic_tracking[$row['topic_id']]) && $topic_tracking[$row['topic_id']] < $row['topic_last_post_time'])
+                    $unread_sticky_num++;
+            }
+            $db->sql_freeresult($result);
+            
+            // get total number of unread announce topics number
+            $sql = 'SELECT t.topic_id, t.topic_last_post_time
+                    FROM ' . TOPICS_TABLE . ' t
+                    WHERE t.forum_id IN (' . $forum_id . ', 0)
+                    AND t.topic_type IN (' . POST_ANNOUNCE . ', ' . POST_GLOBAL . ') ' .
+                    $sql_shadow_out . ' ' .
+                    $sql_approved;
+            $result = $db->sql_query($sql);
+            while ($row = $db->sql_fetchrow($result))
+            {
+                $topic_tracking = get_complete_topic_tracking($forum_id, $row['topic_id']);
+                if (isset($topic_tracking[$row['topic_id']]) && $topic_tracking[$row['topic_id']] < $row['topic_last_post_time'])
+                    $unread_announce_count++;
+            }
+            $db->sql_freeresult($result);
+        }
+        
+        // get total number of normal topics
+        $sql = 'SELECT count(t.topic_id) AS num_topics
+                FROM ' . TOPICS_TABLE . ' t
+                WHERE t.forum_id = ' . $forum_id.'
+                AND t.topic_type = ' . POST_NORMAL . ' ' .
+                $sql_shadow_out . ' ' .
+                $sql_approved;
+        $result = $db->sql_query($sql);
+        $topics_count = (int) $db->sql_fetchfield('num_topics');
+        $db->sql_freeresult($result);
+        
+        if ($start > $topics_count / 2)
+        {
+            $store_reverse = true;
+        
+            if ($start + $sql_limit > $topics_count)
+            {
+                $sql_limit = min($sql_limit, max(1, $topics_count - $start));
+            }
+            
+            // Select the sort order
+            $sql_sort_order = $sort_by_sql[$sort_key] . ' ' . (($sort_dir == 'd') ? 'ASC' : 'DESC');
+            $start = max(0, $topics_count - $sql_limit - $start);
+        }
+        
+        $sql = 'SELECT t.*, u.user_avatar, u.user_avatar_type, tw.notify_status, bm.topic_id as bookmarked
+                FROM ' . TOPICS_TABLE . ' t
+                    LEFT JOIN ' . USERS_TABLE . ' u ON (t.topic_poster = u.user_id)
+                    LEFT JOIN ' . TOPICS_WATCH_TABLE . ' tw ON (tw.user_id = ' . $user->data['user_id'] . ' AND t.topic_id = tw.topic_id) 
+                    LEFT JOIN ' . BOOKMARKS_TABLE . ' bm ON (bm.user_id = ' . $user->data['user_id'] . ' AND t.topic_id = bm.topic_id) 
+                WHERE t.forum_id = ' . $forum_id.'
+                AND t.topic_type = ' . POST_NORMAL . ' ' .
+                $sql_shadow_out . ' ' .
+                $sql_approved . '
+                ORDER BY ' . $sql_sort_order;
+
+        $result = $db->sql_query_limit($sql, $sql_limit, $start);
+    }
+    
+    $tids = array();
+    $rowset = array();
+    while ($row = $db->sql_fetchrow($result))
+    {
+        $rowset[] = $row;
+        $tids[] = $row['topic_moved_id'] ? $row['topic_moved_id'] : $row['topic_id'];
+    }
+    $db->sql_freeresult($result);
+    
+    // get participated users of each topic
+//    get_participated_user_avatars($tids);
+//    global $topic_users, $user_avatar;
+    
+    $topic_list = array();
+    foreach($rowset as $row)
+    {
+        $replies = ($auth->acl_get('m_approve', $forum_id)) ? $row['topic_replies_real'] : $row['topic_replies'];
+        $short_content = get_short_content($row['topic_first_post_id']);
+        $user_avatar_url = get_user_avatar_url($row['user_avatar'], $row['user_avatar_type']);
+        
+        $new_post = false;
+        if ($user->data['user_id'] != ANONYMOUS)
+        {
+            $topic_tracking = get_complete_topic_tracking($forum_id, $row['topic_id']);
+            $new_post = $topic_tracking[$row['topic_id']] < $row['topic_last_post_time'] ? true : false;
+        }
+        
+        $allow_change_type = ($auth->acl_get('m_', $forum_id) || ($user->data['is_registered'] && $user->data['user_id'] == $row['topic_poster'])) ? true : false;
+        
+        $topic_id = $row['topic_moved_id'] ? $row['topic_moved_id'] : $row['topic_id'];
+//        $icon_urls = array();
+//        foreach($topic_users[$topic_id] as $posterid){
+//            $icon_urls[] = new xmlrpcval($user_avatar[$posterid], 'string');
+//        }
+        
+        $xmlrpc_topic = new xmlrpcval(array(
+            'forum_id'          => new xmlrpcval($forum_id),
+            'topic_id'          => new xmlrpcval($row['topic_moved_id'] ? $row['topic_moved_id'] : $row['topic_id']),
+            'topic_title'       => new xmlrpcval(html_entity_decode(strip_tags(censor_text($row['topic_title'])), ENT_QUOTES, 'UTF-8'), 'base64'),
+            'topic_author_id'   => new xmlrpcval($row['topic_first_post_id']),
+            'topic_author_name' => new xmlrpcval(html_entity_decode($row['topic_first_poster_name']), 'base64'),
+            'last_reply_time'   => new xmlrpcval(mobiquo_iso8601_encode($row['topic_last_post_time']),'dateTime.iso8601'),
+            'timestamp'         => new xmlrpcval($row['topic_last_post_time'], 'string'),
+            'reply_number'      => new xmlrpcval($replies, 'int'),
+            'view_number'       => new xmlrpcval($row['topic_views'], 'int'),
+            'short_content'     => new xmlrpcval($short_content, 'base64'),
+            'new_post'          => new xmlrpcval($new_post, 'boolean'),
+            'icon_url'          => new xmlrpcval($user_avatar_url),
+//            'icon_urls'         => new xmlrpcval($icon_urls, 'array'),
+            'attachment'        => new xmlrpcval($auth->acl_get('u_download') && $auth->acl_get('f_download', $forum_id) && $row['topic_attachment'] ? 1 : 0, 'string'),
+            
+            'can_delete'        => new xmlrpcval($auth->acl_get('m_delete', $forum_id), 'boolean'),
+            'can_move'          => new xmlrpcval($auth->acl_get('m_move', $forum_id), 'boolean'),
+            'can_subscribe'     => new xmlrpcval(($config['email_enable'] || $config['jab_enable']) && $config['allow_topic_notify'] && $user->data['is_registered'], 'boolean'), 
+            'is_subscribed'     => new xmlrpcval(!is_null($row['notify_status']) && $row['notify_status'] !== '' ? true : false, 'boolean'),
+            'can_close'         => new xmlrpcval($auth->acl_get('m_lock', $forum_id) || ($auth->acl_get('f_user_lock', $forum_id) && $user->data['is_registered'] && $user->data['user_id'] == $row['topic_poster']), 'boolean'),
+            'is_closed'         => new xmlrpcval($row['topic_status'] == ITEM_LOCKED, 'boolean'),
+            'can_stick'         => new xmlrpcval($allow_change_type && $auth->acl_get('f_sticky', $forum_id), 'boolean'),
+            'is_sticky'         => new xmlrpcval($row['topic_type'] == POST_STICKY, 'boolean'),
+            'can_approve'       => new xmlrpcval($auth->acl_get('m_approve', $forum_id) && !$row['topic_approved'], 'boolean'),
+            'is_approved'       => new xmlrpcval($row['topic_approved'] ? true : false, 'boolean'),
+        ), 'struct');
+        
+        $topic_list[] = $xmlrpc_topic;
+        unset($xmlrpc_topic);
+    }
+
+    if ($store_reverse)
+    {
+        $topic_list = array_reverse($topic_list);
+    }
+
+    if (!empty($topic_type))
+    {
+        $topic_num = count($topic_list);
+    }
+    else
+    {
+        $topic_num = $topics_count;
+    }
+    
+    $allowed = $config['max_attachments'] && $auth->acl_get('f_attach', $forum_id) && $auth->acl_get('u_attach') && $config['allow_attachments'] && @ini_get('file_uploads') != '0' && strtolower(@ini_get('file_uploads')) != 'off';
+    $max_attachment = ($auth->acl_get('a_') || $auth->acl_get('m_', $forum_id)) ? 99 : ($allowed ? $config['max_attachments'] : 0);
+    $max_png_size = ($auth->acl_get('a_') || $auth->acl_get('m_', $forum_id)) ? 10485760 : ($allowed ? ($config['max_filesize'] === '0' ? 10485760 : $config['max_filesize']) : 0);
+    $max_jpg_size = ($auth->acl_get('a_') || $auth->acl_get('m_', $forum_id)) ? 10485760 : ($allowed ? ($config['max_filesize'] === '0' ? 10485760 : $config['max_filesize']) : 0);
+    
+    $response = new xmlrpcval(array(
+        'total_topic_num' => new xmlrpcval($topic_num, 'int'),
+        'unread_sticky_count'   => new xmlrpcval($unread_sticky_num, 'int'),
+        'unread_announce_count' => new xmlrpcval($unread_announce_count, 'int'),
+        'forum_id'        => new xmlrpcval($forum_id, 'string'),
+        'forum_name'      => new xmlrpcval(html_entity_decode($forum_data['forum_name']), 'base64'),
+        'can_post'        => new xmlrpcval($auth->acl_get('f_post', $forum_id), 'boolean'),
+        'can_upload'      => new xmlrpcval($allowed, 'boolean'),
+        'max_attachment'  => new xmlrpcval($max_attachment, 'int'),
+        'max_png_size'    => new xmlrpcval($max_png_size, 'int'),
+        'max_jpg_size'    => new xmlrpcval($max_jpg_size, 'int'),
+        'topics'          => new xmlrpcval($topic_list, 'array'),
+    ), 'struct');
+
+    return new xmlrpcresp($response);
+}
diff -ruN phpBB-3.0.10/mobiquo/function/get_user_info.php phpbb/mobiquo/function/get_user_info.php
--- phpBB-3.0.10/mobiquo/function/get_user_info.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/function/get_user_info.php	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,721 @@
+<?php
+/**
+*
+* @copyright (c) 2009, 2010, 2011 Quoord Systems Limited
+* @license http://opensource.org/licenses/gpl-2.0.php GNU Public License (GPLv2)
+*
+*/
+
+defined('IN_MOBIQUO') or exit;
+
+include_once($phpbb_root_path . 'includes/functions_display.' . $phpEx);
+
+function get_user_info_func($xmlrpc_params)
+{
+    global $db, $user, $auth, $template, $config, $phpbb_root_path, $phpEx;
+    
+    $user->setup(array('memberlist', 'groups'));
+    
+    if (!$auth->acl_gets('u_viewprofile', 'a_user', 'a_useradd', 'a_userdel'))
+    {
+        if ($user->data['user_id'] != ANONYMOUS)
+        {
+            trigger_error('NO_VIEW_USERS');
+        }
+        
+        trigger_error('LOGIN_EXPLAIN_VIEWPROFILE');
+    }
+    
+    $params = php_xmlrpc_decode($xmlrpc_params);
+    $username = $params[0];
+    if (isset($params[1]) && !empty($params[1])){
+        $user_id = $params[1];
+    }
+    elseif (isset($params[0]) && !empty($params[0]))
+    {
+        $username = $params[0];
+        $user_id = get_user_id_by_name($username);
+    }
+    else
+    {
+        $user_id = $user->data['user_id'];
+    }
+    
+    $user_id = intval($user_id);
+    
+    // Display a profile
+    if (!$user_id) trigger_error('NO_USER');
+    
+    // Get user...
+    $sql = 'SELECT *
+        FROM ' . USERS_TABLE . "
+        WHERE user_id = '$user_id'";
+    $result = $db->sql_query($sql);
+    $member = $db->sql_fetchrow($result);
+    $db->sql_freeresult($result);
+    
+    if (!$member) trigger_error('NO_USER');
+    
+    // a_user admins and founder are able to view inactive users and bots to be able to manage them more easily
+    // Normal users are able to see at least users having only changed their profile settings but not yet reactivated.
+    if (!$auth->acl_get('a_user') && $user->data['user_type'] != USER_FOUNDER)
+    {
+        if ($member['user_type'] == USER_IGNORE)
+        {
+            trigger_error('NO_USER');
+        }
+        else if ($member['user_type'] == USER_INACTIVE && $member['user_inactive_reason'] != INACTIVE_PROFILE)
+        {
+            trigger_error('NO_USER');
+        }
+    }
+    
+    $user_id = (int) $member['user_id'];
+    
+    // Do the SQL thang
+    $sql = 'SELECT g.group_id, g.group_name, g.group_type
+        FROM ' . GROUPS_TABLE . ' g, ' . USER_GROUP_TABLE . " ug
+        WHERE ug.user_id = $user_id
+            AND g.group_id = ug.group_id" . ((!$auth->acl_gets('a_group', 'a_groupadd', 'a_groupdel')) ? ' AND g.group_type <> ' . GROUP_HIDDEN : '') . '
+            AND ug.user_pending = 0
+        ORDER BY g.group_type, g.group_name';
+    $result = $db->sql_query($sql);
+    
+    $group_options = '';
+    while ($row = $db->sql_fetchrow($result))
+    {
+        if ($row['group_type'] == GROUP_SPECIAL)
+        {
+            // Lookup group name in language dictionary
+            if (isset($user->lang['G_' . $row['group_name']]))
+            {
+                $row['group_name'] = $user->lang['G_' . $row['group_name']];
+            }
+        }
+        else if (!$auth_hidden_groups && $row['group_type'] == GROUP_HIDDEN && !isset($user_groups[$row['group_id']]))
+        {
+            // Skip over hidden groups the user cannot see
+            continue;
+        }
+        
+        $group_options .= ($row['group_id'] == $member['group_id']) ? $row['group_name']." *\n" : $row['group_name']."\n";
+    }
+    $group_options = trim($group_options);
+    $db->sql_freeresult($result);
+    
+    // What colour is the zebra
+    $sql = 'SELECT friend, foe
+        FROM ' . ZEBRA_TABLE . "
+        WHERE zebra_id = $user_id
+            AND user_id = {$user->data['user_id']}";
+    
+    $result = $db->sql_query($sql);
+    $row = $db->sql_fetchrow($result);
+    $foe = ($row['foe']) ? true : false;
+    $friend = ($row['friend']) ? true : false;
+    $db->sql_freeresult($result);
+    
+    if ($config['load_onlinetrack'])
+    {
+        $sql = 'SELECT MAX(session_time) AS session_time, MIN(session_viewonline) AS session_viewonline, session_page, session_forum_id
+            FROM ' . SESSIONS_TABLE . "
+            WHERE session_user_id = $user_id
+            GROUP BY session_page, session_forum_id
+            ORDER BY session_time DESC";
+
+        $result = $db->sql_query_limit($sql, 1);
+        $row = $db->sql_fetchrow($result);
+        $db->sql_freeresult($result);
+    
+        $member['session_time'] = (isset($row['session_time'])) ? $row['session_time'] : 0;
+        $member['session_viewonline'] = (isset($row['session_viewonline'])) ? $row['session_viewonline'] :    0;
+        $member['session_page'] = (isset($row['session_page'])) ? $row['session_page'] : 0;
+        $member['session_forum_id'] = (isset($row['session_forum_id'])) ? $row['session_forum_id'] : 0;
+        unset($row);
+    }
+    
+    if ($config['load_user_activity'])
+    {
+        display_user_activity($member);
+    }
+    
+    // Do the relevant calculations
+    $memberdays = max(1, round((time() - $member['user_regdate']) / 86400));
+    $posts_per_day = $member['user_posts'] / $memberdays;
+    $percentage = ($config['num_posts']) ? min(100, ($member['user_posts'] / $config['num_posts']) * 100) : 0;
+    
+    
+    if ($member['user_sig'])
+    {
+        $member['user_sig'] = censor_text($member['user_sig']);
+    
+        if ($member['user_sig_bbcode_bitfield'])
+        {
+            include_once($phpbb_root_path . 'includes/bbcode.' . $phpEx);
+            $bbcode = new bbcode();
+            $bbcode->bbcode_second_pass($member['user_sig'], $member['user_sig_bbcode_uid'], $member['user_sig_bbcode_bitfield']);
+        }
+    
+        $member['user_sig'] = bbcode_nl2br($member['user_sig']);
+        $member['user_sig'] = smiley_text($member['user_sig']);
+    }
+    
+    $poster_avatar = get_user_avatar($member['user_avatar'], $member['user_avatar_type'], $member['user_avatar_width'], $member['user_avatar_height']);
+    
+    // We need to check if the modules 'zebra' ('friends' & 'foes' mode),  'notes' ('user_notes' mode) and  'warn' ('warn_user' mode) are accessible to decide if we can display appropriate links
+    $zebra_enabled = $friends_enabled = $foes_enabled = $user_notes_enabled = $warn_user_enabled = false;
+    
+    // Only check if the user is logged in
+    if ($user->data['is_registered'])
+    {
+        if (!class_exists('p_master'))
+        {
+            include($phpbb_root_path . 'includes/functions_module.' . $phpEx);
+        }
+        $module = new p_master();
+    
+        $module->list_modules('ucp');
+        $module->list_modules('mcp');
+    
+        $user_notes_enabled = ($module->loaded('notes', 'user_notes')) ? true : false;
+        $warn_user_enabled = ($module->loaded('warn', 'warn_user')) ? true : false;
+        $zebra_enabled = ($module->loaded('zebra')) ? true : false;
+        $friends_enabled = ($module->loaded('zebra', 'friends')) ? true : false;
+        $foes_enabled = ($module->loaded('zebra', 'foes')) ? true : false;
+    
+        unset($module);
+    }
+    
+    $template->assign_vars(show_profile($member, $user_notes_enabled, $warn_user_enabled));
+    
+    // Custom Profile Fields
+    $profile_fields = array();
+    if ($config['load_cpf_viewprofile'])
+    {
+        include_once($phpbb_root_path . 'includes/functions_profile_fields.' . $phpEx);
+        $cp = new custom_profile();
+        $profile_fields = $cp->generate_profile_fields_template('grab', $user_id);
+        $profile_fields = (isset($profile_fields[$user_id])) ? $cp->generate_profile_fields_template('show', false, $profile_fields[$user_id]) : array();
+    }
+    
+    // If the user has m_approve permission or a_user permission, then list then display unapproved posts
+    if ($auth->acl_getf_global('m_approve') || $auth->acl_get('a_user'))
+    {
+        $sql = 'SELECT COUNT(post_id) as posts_in_queue
+            FROM ' . POSTS_TABLE . '
+            WHERE poster_id = ' . $user_id . '
+                AND post_approved = 0';
+        $result = $db->sql_query($sql);
+        $member['posts_in_queue'] = (int) $db->sql_fetchfield('posts_in_queue');
+        $db->sql_freeresult($result);
+    }
+    else
+    {
+        $member['posts_in_queue'] = 0;
+    }
+    
+    $template->assign_vars(array(
+        //'L_POSTS_IN_QUEUE'    => $user->lang('NUM_POSTS_IN_QUEUE', $member['posts_in_queue']),
+    
+        //'POSTS_DAY'            => sprintf($user->lang['POST_DAY'], $posts_per_day),
+        //'POSTS_PCT'            => sprintf($user->lang['POST_PCT'], $percentage),
+    
+        'OCCUPATION'    => (!empty($member['user_occ'])) ? censor_text($member['user_occ']) : '',
+        'INTERESTS'        => (!empty($member['user_interests'])) ? censor_text($member['user_interests']) : '',
+        'SIGNATURE'        => $member['user_sig'],
+        'POSTS_IN_QUEUE'=> $member['posts_in_queue'],
+    
+        'AVATAR_IMG'    => $poster_avatar,
+        'PM_IMG'        => $user->img('icon_contact_pm', $user->lang['SEND_PRIVATE_MESSAGE']),
+        'EMAIL_IMG'        => $user->img('icon_contact_email', $user->lang['EMAIL']),
+        'WWW_IMG'        => $user->img('icon_contact_www', $user->lang['WWW']),
+        'ICQ_IMG'        => $user->img('icon_contact_icq', $user->lang['ICQ']),
+        'AIM_IMG'        => $user->img('icon_contact_aim', $user->lang['AIM']),
+        'MSN_IMG'        => $user->img('icon_contact_msnm', $user->lang['MSNM']),
+        'YIM_IMG'        => $user->img('icon_contact_yahoo', $user->lang['YIM']),
+        'JABBER_IMG'    => $user->img('icon_contact_jabber', $user->lang['JABBER']),
+        'SEARCH_IMG'    => $user->img('icon_user_search', $user->lang['SEARCH']),
+    
+        'S_PROFILE_ACTION'    => append_sid("{$phpbb_root_path}memberlist.$phpEx", 'mode=group'),
+        'S_GROUP_OPTIONS'    => $group_options,
+        'S_CUSTOM_FIELDS'    => (isset($profile_fields['row']) && sizeof($profile_fields['row'])) ? true : false,
+    
+        'U_USER_ADMIN'            => ($auth->acl_get('a_user')) ? append_sid("{$phpbb_root_path}adm/index.$phpEx", 'i=users&amp;mode=overview&amp;u=' . $user_id, true, $user->session_id) : '',
+        'U_USER_BAN'            => ($auth->acl_get('m_ban') && $user_id != $user->data['user_id']) ? append_sid("{$phpbb_root_path}mcp.$phpEx", 'i=ban&amp;mode=user&amp;u=' . $user_id, true, $user->session_id) : '',
+        'U_MCP_QUEUE'            => ($auth->acl_getf_global('m_approve')) ? append_sid("{$phpbb_root_path}mcp.$phpEx", 'i=queue', true, $user->session_id) : '',
+    
+        'U_SWITCH_PERMISSIONS'    => ($auth->acl_get('a_switchperm') && $user->data['user_id'] != $user_id) ? append_sid("{$phpbb_root_path}ucp.$phpEx", "mode=switch_perm&amp;u={$user_id}&amp;hash=" . generate_link_hash('switchperm')) : '',
+    
+        'S_USER_NOTES'        => ($user_notes_enabled) ? true : false,
+        'S_WARN_USER'        => ($warn_user_enabled) ? true : false,
+        'S_ZEBRA'            => ($user->data['user_id'] != $user_id && $user->data['is_registered'] && $zebra_enabled) ? true : false,
+        'U_ADD_FRIEND'        => (!$friend && !$foe && $friends_enabled) ? append_sid("{$phpbb_root_path}ucp.$phpEx", 'i=zebra&amp;add=' . urlencode(htmlspecialchars_decode($member['username']))) : '',
+        'U_ADD_FOE'            => (!$friend && !$foe && $foes_enabled) ? append_sid("{$phpbb_root_path}ucp.$phpEx", 'i=zebra&amp;mode=foes&amp;add=' . urlencode(htmlspecialchars_decode($member['username']))) : '',
+        'U_REMOVE_FRIEND'    => ($friend && $friends_enabled) ? append_sid("{$phpbb_root_path}ucp.$phpEx", 'i=zebra&amp;remove=1&amp;usernames[]=' . $user_id) : '',
+        'U_REMOVE_FOE'        => ($foe && $foes_enabled) ? append_sid("{$phpbb_root_path}ucp.$phpEx", 'i=zebra&amp;remove=1&amp;mode=foes&amp;usernames[]=' . $user_id) : '',
+    ));
+    
+    if (!empty($profile_fields['row']))
+    {
+        $template->assign_vars($profile_fields['row']);
+    }
+    
+    if (!empty($profile_fields['blockrow']))
+    {
+        foreach ($profile_fields['blockrow'] as $field_data)
+        {
+            $template->assign_block_vars('custom_fields', $field_data);
+        }
+    }
+    
+    // Inactive reason/account?
+    if ($member['user_type'] == USER_INACTIVE)
+    {
+        $user->add_lang('acp/common');
+    
+        $inactive_reason = $user->lang['INACTIVE_REASON_UNKNOWN'];
+    
+        switch ($member['user_inactive_reason'])
+        {
+            case INACTIVE_REGISTER:
+                $inactive_reason = $user->lang['INACTIVE_REASON_REGISTER'];
+            break;
+    
+            case INACTIVE_PROFILE:
+                $inactive_reason = $user->lang['INACTIVE_REASON_PROFILE'];
+            break;
+    
+            case INACTIVE_MANUAL:
+                $inactive_reason = $user->lang['INACTIVE_REASON_MANUAL'];
+            break;
+    
+            case INACTIVE_REMIND:
+                $inactive_reason = $user->lang['INACTIVE_REASON_REMIND'];
+            break;
+        }
+    
+        $template->assign_vars(array(
+            'S_USER_INACTIVE'        => true,
+            'USER_INACTIVE_REASON'    => $inactive_reason)
+        );
+    }
+    
+    $custom_fields_list = get_custom_fields();
+    
+    if (!empty($member['user_sig']))
+        $custom_fields_list[] = new xmlrpcval(array(
+            'name'  => new xmlrpcval($user->lang['SIGNATURE'], 'base64'),
+            'value' => new xmlrpcval(basic_clean($member['user_sig']), 'base64')
+        ), 'struct');
+    
+    
+    $user_avatar_url = get_user_avatar_url($member['user_avatar'], $member['user_avatar_type']);
+    
+    // Forum info
+    $sql = 'SELECT forum_id, forum_name, parent_id, forum_type, left_id, right_id
+        FROM ' . FORUMS_TABLE . '
+        ORDER BY left_id ASC';
+    $result = $db->sql_query($sql, 600);
+    
+    $forum_data = array();
+    while ($row = $db->sql_fetchrow($result))
+    {
+        $forum_data[$row['forum_id']] = $row;
+    }
+    $db->sql_freeresult($result);
+    
+    
+    // get user current activity
+    preg_match('#^([a-z0-9/_-]+)#i', $member['session_page'], $on_page);
+    if (!sizeof($on_page))
+    {
+        $on_page[1] = '';
+    }
+
+    switch ($on_page[1])
+    {
+        case 'index':
+            $location = $user->lang['INDEX'];
+        break;
+
+        case 'adm/index':
+            $location = $user->lang['ACP'];
+        break;
+
+        case 'posting':
+        case 'viewforum':
+        case 'viewtopic':
+            $forum_id = $member['session_forum_id'];
+            
+            if ($forum_id && $auth->acl_get('f_list', $forum_id))
+            {
+                $location = '';
+
+                if ($forum_data[$forum_id]['forum_type'] == FORUM_LINK)
+                {
+                    $location = sprintf($user->lang['READING_LINK'], $forum_data[$forum_id]['forum_name']);
+                    break;
+                }
+
+                switch ($on_page[1])
+                {
+                    case 'posting':
+                        preg_match('#mode=([a-z]+)#', $member['session_page'], $on_page);
+                        $posting_mode = (!empty($on_page[1])) ? $on_page[1] : '';
+
+                        switch ($posting_mode)
+                        {
+                            case 'reply':
+                            case 'quote':
+                                $location = sprintf($user->lang['REPLYING_MESSAGE'], $forum_data[$forum_id]['forum_name']);
+                            break;
+
+                            default:
+                                $location = sprintf($user->lang['POSTING_MESSAGE'], $forum_data[$forum_id]['forum_name']);
+                            break;
+                        }
+                    break;
+
+                    case 'viewtopic':
+                        $location = sprintf($user->lang['READING_TOPIC'], $forum_data[$forum_id]['forum_name']);
+                    break;
+
+                    case 'viewforum':
+                        $location = sprintf($user->lang['READING_FORUM'], $forum_data[$forum_id]['forum_name']);
+                    break;
+                }
+            }
+            else
+            {
+                $location = $user->lang['INDEX'];
+            }
+        break;
+
+        case 'search':
+            $location = $user->lang['SEARCHING_FORUMS'];
+        break;
+
+        case 'faq':
+            $location = $user->lang['VIEWING_FAQ'];
+        break;
+
+        case 'viewonline':
+            $location = $user->lang['VIEWING_ONLINE'];
+        break;
+
+        case 'memberlist':
+            $location = (strpos($member['session_page'], 'mode=viewprofile') !== false) ? $user->lang['VIEWING_MEMBER_PROFILE'] : $user->lang['VIEWING_MEMBERS'];
+        break;
+
+        case 'mcp':
+            $location = $user->lang['VIEWING_MCP'];
+        break;
+
+        case 'ucp':
+            $location = $user->lang['VIEWING_UCP'];
+
+            // Grab some common modules
+            $url_params = array(
+                'mode=register'        => 'VIEWING_REGISTER',
+                'i=pm&mode=compose'    => 'POSTING_PRIVATE_MESSAGE',
+                'i=pm&'                => 'VIEWING_PRIVATE_MESSAGES',
+                'i=profile&'        => 'CHANGING_PROFILE',
+                'i=prefs&'            => 'CHANGING_PREFERENCES',
+            );
+
+            foreach ($url_params as $param => $lang)
+            {
+                if (strpos($member['session_page'], $param) !== false)
+                {
+                    $location = $user->lang[$lang];
+                    break;
+                }
+            }
+
+        break;
+
+        case 'download/file':
+            $location = $user->lang['DOWNLOADING_FILE'];
+        break;
+
+        case 'report':
+            $location = $user->lang['REPORTING_POST'];
+        break;
+        
+        case 'mobiquo/mobiquo':
+            $location = 'On Tapatalk';
+        break;
+
+        default:
+            $location = $user->lang['INDEX'];
+        break;
+    }
+    
+    $xmlrpc_user_info = new xmlrpcval(array(
+        'user_id'            => new xmlrpcval($member['user_id']),
+        'username'           => new xmlrpcval($member['username'], 'base64'),
+        'post_count'         => new xmlrpcval($member['user_posts'], 'int'),
+        'reg_time'           => new xmlrpcval(mobiquo_iso8601_encode($member['user_regdate']), 'dateTime.iso8601'),
+        'timestamp_reg'      => new xmlrpcval($member['user_regdate'], 'string'),
+        'last_activity_time' => new xmlrpcval(mobiquo_iso8601_encode($template->_rootref['VISITED']), 'dateTime.iso8601'),
+        'timestamp'          => new xmlrpcval($template->_rootref['VISITED'], 'string'),
+        'is_online'          => new xmlrpcval($template->_rootref['S_ONLINE'], 'boolean'),
+        'accept_pm'          => new xmlrpcval($template->_rootref['U_PM'] ? true : false, 'boolean'),
+        'display_text'       => new xmlrpcval('', 'base64'),
+        'icon_url'           => new xmlrpcval($user_avatar_url),
+        'current_activity'   => new xmlrpcval($location, 'base64'),
+        'custom_fields_list' => new xmlrpcval($custom_fields_list, 'array'),
+        
+        //'can_ban'            => new xmlrpcval($auth->acl_get('m_ban') && $user_id != $user->data['user_id'] ? true : false, 'boolean'),
+    ), 'struct');
+
+    return new xmlrpcresp($xmlrpc_user_info);
+} // End of get_user_info_func
+
+
+/**
+* Prepare profile data
+*/
+function show_profile($data, $user_notes_enabled = false, $warn_user_enabled = false)
+{
+    global $config, $auth, $template, $user, $phpEx, $phpbb_root_path;
+
+    $username = $data['username'];
+    $user_id = $data['user_id'];
+
+    $rank_title = $rank_img = $rank_img_src = '';
+    get_user_rank($data['user_rank'], (($user_id == ANONYMOUS) ? false : $data['user_posts']), $rank_title, $rank_img, $rank_img_src);
+
+    if (!empty($data['user_allow_viewemail']) || $auth->acl_get('a_user'))
+    {
+        $email = ($config['board_email_form'] && $config['email_enable']) ? '' : (($config['board_hide_emails'] && !$auth->acl_get('a_user')) ? '' : $data['user_email']);
+    }
+    else
+    {
+        $email = '';
+    }
+
+    if ($config['load_onlinetrack'])
+    {
+        $update_time = $config['load_online_time'] * 60;
+        $online = (time() - $update_time < $data['session_time'] && ((isset($data['session_viewonline']) && $data['session_viewonline']) || $auth->acl_get('u_viewonline'))) ? true : false;
+    }
+    else
+    {
+        $online = false;
+    }
+
+    if ($data['user_allow_viewonline'] || $auth->acl_get('u_viewonline'))
+    {
+        $last_visit = (!empty($data['session_time'])) ? $data['session_time'] : $data['user_lastvisit'];
+    }
+    else
+    {
+        $last_visit = '';
+    }
+
+    $age = '';
+
+    if ($config['allow_birthdays'] && $data['user_birthday'])
+    {
+        list($bday_day, $bday_month, $bday_year) = array_map('intval', explode('-', $data['user_birthday']));
+
+        if ($bday_year)
+        {
+            $now = getdate(time() + $user->timezone + $user->dst - date('Z'));
+
+            $diff = $now['mon'] - $bday_month;
+            if ($diff == 0)
+            {
+                $diff = ($now['mday'] - $bday_day < 0) ? 1 : 0;
+            }
+            else
+            {
+                $diff = ($diff < 0) ? 1 : 0;
+            }
+
+            $age = (int) ($now['year'] - $bday_year - $diff);
+        }
+    }
+
+    // Dump it out to the template
+    return array(
+        'AGE'            => $age,
+        'RANK_TITLE'    => $rank_title,
+        'JOINED'        => $user->format_date($data['user_regdate']),
+        'VISITED'        => $last_visit,
+        'POSTS'            => ($data['user_posts']) ? $data['user_posts'] : 0,
+        'WARNINGS'        => isset($data['user_warnings']) ? $data['user_warnings'] : 0,
+
+        'USERNAME_FULL'        => get_username_string('full', $user_id, $username, $data['user_colour']),
+        'USERNAME'            => get_username_string('username', $user_id, $username, $data['user_colour']),
+        'USER_COLOR'        => get_username_string('colour', $user_id, $username, $data['user_colour']),
+        'U_VIEW_PROFILE'    => get_username_string('profile', $user_id, $username, $data['user_colour']),
+
+        'A_USERNAME'        => addslashes(get_username_string('username', $user_id, $username, $data['user_colour'])),
+
+        'AVATAR_IMG'        => get_user_avatar($data['user_avatar'], $data['user_avatar_type'], $data['user_avatar_width'], $data['user_avatar_height']),
+        'ONLINE_IMG'        => (!$config['load_onlinetrack']) ? '' : (($online) ? $user->img('icon_user_online', 'ONLINE') : $user->img('icon_user_offline', 'OFFLINE')),
+        'S_ONLINE'            => ($config['load_onlinetrack'] && $online) ? true : false,
+        'RANK_IMG'            => $rank_img,
+        'RANK_IMG_SRC'        => $rank_img_src,
+        'ICQ_STATUS_IMG'    => (!empty($data['user_icq'])) ? '<img src="http://web.icq.com/whitepages/online?icq=' . $data['user_icq'] . '&amp;img=5" width="18" height="18" />' : '',
+        'S_JABBER_ENABLED'    => ($config['jab_enable']) ? true : false,
+
+        'S_WARNINGS'    => ($auth->acl_getf_global('m_') || $auth->acl_get('m_warn')) ? true : false,
+
+        'U_SEARCH_USER'    => ($auth->acl_get('u_search')) ? append_sid("{$phpbb_root_path}search.$phpEx", "author_id=$user_id&amp;sr=posts") : '',
+        'U_NOTES'        => ($user_notes_enabled && $auth->acl_getf_global('m_')) ? append_sid("{$phpbb_root_path}mcp.$phpEx", 'i=notes&amp;mode=user_notes&amp;u=' . $user_id, true, $user->session_id) : '',
+        'U_WARN'        => ($warn_user_enabled && $auth->acl_get('m_warn')) ? append_sid("{$phpbb_root_path}mcp.$phpEx", 'i=warn&amp;mode=warn_user&amp;u=' . $user_id, true, $user->session_id) : '',
+        'U_PM'            => ($config['allow_privmsg'] && $auth->acl_get('u_sendpm') && ($data['user_allow_pm'] || $auth->acl_gets('a_', 'm_') || $auth->acl_getf_global('m_'))) ? append_sid("{$phpbb_root_path}ucp.$phpEx", 'i=pm&amp;mode=compose&amp;u=' . $user_id) : '',
+        'U_EMAIL'        => $email,
+        'U_WWW'            => (!empty($data['user_website'])) ? $data['user_website'] : '',
+        'U_SHORT_WWW'            => (!empty($data['user_website'])) ? ((strlen($data['user_website']) > 55) ? substr($data['user_website'], 0, 39) . ' ... ' . substr($data['user_website'], -10) : $data['user_website']) : '',
+        'U_ICQ'            => ($data['user_icq']) ? 'http://www.icq.com/people/webmsg.php?to=' . urlencode($data['user_icq']) : '',
+        'U_AIM'            => ($data['user_aim'] && $auth->acl_get('u_sendim')) ? append_sid("{$phpbb_root_path}memberlist.$phpEx", 'mode=contact&amp;action=aim&amp;u=' . $user_id) : '',
+        'U_YIM'            => ($data['user_yim']) ? 'http://edit.yahoo.com/config/send_webmesg?.target=' . urlencode($data['user_yim']) . '&amp;.src=pg' : '',
+        'U_MSN'            => ($data['user_msnm'] && $auth->acl_get('u_sendim')) ? append_sid("{$phpbb_root_path}memberlist.$phpEx", 'mode=contact&amp;action=msnm&amp;u=' . $user_id) : '',
+        'U_JABBER'        => ($data['user_jabber'] && $auth->acl_get('u_sendim')) ? append_sid("{$phpbb_root_path}memberlist.$phpEx", 'mode=contact&amp;action=jabber&amp;u=' . $user_id) : '',
+        'LOCATION'        => ($data['user_from']) ? $data['user_from'] : '',
+
+        'USER_ICQ'            => $data['user_icq'],
+        'USER_AIM'            => $data['user_aim'],
+        'USER_YIM'            => $data['user_yim'],
+        'USER_MSN'            => $data['user_msnm'],
+        'USER_JABBER'        => $data['user_jabber'],
+        'USER_JABBER_IMG'    => ($data['user_jabber']) ? $user->img('icon_contact_jabber', $data['user_jabber']) : '',
+
+        'L_VIEWING_PROFILE'    => sprintf($user->lang['VIEWING_PROFILE'], $username),
+    );
+}
+
+function get_custom_fields()
+{
+    global $user, $template;
+    
+    $custom_fields = array();
+    
+    if ($template->_rootref['RANK_TITLE']) {
+        $custom_fields[] = new xmlrpcval(array(
+            'name'  => new xmlrpcval($user->lang['RANK'], 'base64'),
+            'value' => new xmlrpcval(basic_clean($template->_rootref['RANK_TITLE']), 'base64')
+        ), 'struct');
+    }
+    
+    if ($template->_rootref['S_USER_INACTIVE']) {
+        $custom_fields[] = new xmlrpcval(array(
+            'name'  => new xmlrpcval($user->lang['USER_IS_INACTIVE'], 'base64'),
+            'value' => new xmlrpcval($template->_rootref['USER_INACTIVE_REASON'], 'base64')
+        ), 'struct');
+    }
+    
+    if ($template->_rootref['LOCATION']) {
+        $custom_fields[] = new xmlrpcval(array(
+            'name'  => new xmlrpcval($user->lang['LOCATION'], 'base64'),
+            'value' => new xmlrpcval($template->_rootref['LOCATION'], 'base64')
+        ), 'struct');
+    }
+    
+    if ($template->_rootref['AGE']) {
+        $custom_fields[] = new xmlrpcval(array(
+            'name'  => new xmlrpcval($user->lang['AGE'], 'base64'),
+            'value' => new xmlrpcval($template->_rootref['AGE'], 'base64')
+        ), 'struct');
+    }
+    
+    if ($template->_rootref['OCCUPATION']) {
+        $custom_fields[] = new xmlrpcval(array(
+            'name'  => new xmlrpcval($user->lang['OCCUPATION'], 'base64'),
+            'value' => new xmlrpcval($template->_rootref['OCCUPATION'], 'base64')
+        ), 'struct');
+    }
+    
+    if ($template->_rootref['INTERESTS']) {
+        $custom_fields[] = new xmlrpcval(array(
+            'name'  => new xmlrpcval($user->lang['INTERESTS'], 'base64'),
+            'value' => new xmlrpcval($template->_rootref['INTERESTS'], 'base64')
+        ), 'struct');
+    }
+    
+    if ($template->_rootref['S_GROUP_OPTIONS']) {
+        $custom_fields[] = new xmlrpcval(array(
+            'name'  => new xmlrpcval($user->lang['USERGROUPS'], 'base64'),
+            'value' => new xmlrpcval($template->_rootref['S_GROUP_OPTIONS'], 'base64')
+        ), 'struct');
+    }
+    
+    if ($template->_rootref['U_EMAIL']) {
+        $custom_fields[] = new xmlrpcval(array(
+            'name'  => new xmlrpcval($user->lang['EMAIL_ADDRESS'], 'base64'),
+            'value' => new xmlrpcval($template->_rootref['U_EMAIL'], 'base64')
+        ), 'struct');
+    }
+    
+    if ($template->_rootref['U_WWW']) {
+        $custom_fields[] = new xmlrpcval(array(
+            'name'  => new xmlrpcval($user->lang['WEBSITE'], 'base64'),
+            'value' => new xmlrpcval($template->_rootref['U_WWW'], 'base64')
+        ), 'struct');
+    }
+    
+    if ($template->_rootref['USER_MSN']) {
+        $custom_fields[] = new xmlrpcval(array(
+            'name'  => new xmlrpcval($user->lang['MSNM'], 'base64'),
+            'value' => new xmlrpcval($template->_rootref['USER_MSN'], 'base64')
+        ), 'struct');
+    }
+    
+    if ($template->_rootref['USER_YIM']) {
+        $custom_fields[] = new xmlrpcval(array(
+            'name'  => new xmlrpcval($user->lang['YIM'], 'base64'),
+            'value' => new xmlrpcval($template->_rootref['USER_YIM'], 'base64')
+        ), 'struct');
+    }
+    
+    if ($template->_rootref['USER_AIM']) {
+        $custom_fields[] = new xmlrpcval(array(
+            'name'  => new xmlrpcval($user->lang['AIM'], 'base64'),
+            'value' => new xmlrpcval($template->_rootref['USER_AIM'], 'base64')
+        ), 'struct');
+    }
+    
+    if ($template->_rootref['USER_ICQ']) {
+        $custom_fields[] = new xmlrpcval(array(
+            'name'  => new xmlrpcval($user->lang['ICQ'], 'base64'),
+            'value' => new xmlrpcval($template->_rootref['USER_ICQ'], 'base64')
+        ), 'struct');
+    }
+    
+    if ($template->_rootref['USER_JABBER']) {
+        $custom_fields[] = new xmlrpcval(array(
+            'name'  => new xmlrpcval($user->lang['JABBER'], 'base64'),
+            'value' => new xmlrpcval($template->_rootref['USER_JABBER'], 'base64')
+        ), 'struct');
+    }
+    
+    if ($template->_rootref['S_WARNINGS']) {
+        $custom_fields[] = new xmlrpcval(array(
+            'name'  => new xmlrpcval($user->lang['WARNINGS'], 'base64'),
+            'value' => new xmlrpcval($template->_rootref['WARNINGS'], 'base64')
+        ), 'struct');
+    }
+    
+    if ($template->_rootref['S_SHOW_ACTIVITY'] && $template->_rootref['POSTS']) {
+        if ($template->_rootref['ACTIVE_FORUM']) {
+            $custom_fields[] = new xmlrpcval(array(
+                'name'  => new xmlrpcval($user->lang['ACTIVE_IN_FORUM'], 'base64'),
+                'value' => new xmlrpcval($template->_rootref['ACTIVE_FORUM']."\n(".$template->_rootref['ACTIVE_FORUM_POSTS'].' / '.$template->_rootref['ACTIVE_FORUM_PCT'].')', 'base64')
+            ), 'struct');
+        }
+        
+        if ($template->_rootref['ACTIVE_TOPIC']) {
+            $custom_fields[] = new xmlrpcval(array(
+                'name'  => new xmlrpcval($user->lang['ACTIVE_IN_TOPIC'], 'base64'),
+                'value' => new xmlrpcval($template->_rootref['ACTIVE_TOPIC']."\n(".$template->_rootref['ACTIVE_TOPIC_POSTS'].' / '.$template->_rootref['ACTIVE_TOPIC_PCT'].')', 'base64')
+            ), 'struct');
+        }
+    }
+    
+    return $custom_fields;
+    
+}
\ No newline at end of file
diff -ruN phpBB-3.0.10/mobiquo/function/index.html phpbb/mobiquo/function/index.html
--- phpBB-3.0.10/mobiquo/function/index.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/function/index.html	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,8 @@
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
+<HTML>
+ <HEAD>
+  <TITLE>Redirecting...</TITLE>
+<meta HTTP-EQUIV="REFRESH" content="0; url=/"> </HEAD>
+<BODY>  
+</BODY>
+</HTML>
diff -ruN phpBB-3.0.10/mobiquo/function/login_forum.php phpbb/mobiquo/function/login_forum.php
--- phpBB-3.0.10/mobiquo/function/login_forum.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/function/login_forum.php	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,128 @@
+<?php
+/**
+*
+* @copyright (c) 2009, 2010, 2011 Quoord Systems Limited
+* @license http://opensource.org/licenses/gpl-2.0.php GNU Public License (GPLv2)
+*
+*/
+
+defined('IN_MOBIQUO') or exit;
+
+function login_forum_func($xmlrpc_params)
+{
+    global $db, $auth, $user, $config;
+    
+    $user->setup('viewforum');
+    
+    $params = php_xmlrpc_decode($xmlrpc_params);
+    
+    $forum_id = intval($params[0]);
+    $password = $params[1];
+    
+    if (!$forum_id) trigger_error('NO_FORUM');
+    
+    $sql_from = FORUMS_TABLE . ' f';
+    $lastread_select = '';
+    
+    // Grab appropriate forum data
+    if ($config['load_db_lastread'] && $user->data['is_registered'])
+    {
+        $sql_from .= ' LEFT JOIN ' . FORUMS_TRACK_TABLE . ' ft ON (ft.user_id = ' . $user->data['user_id'] . '
+            AND ft.forum_id = f.forum_id)';
+        $lastread_select .= ', ft.mark_time';
+    }
+    
+    if ($user->data['is_registered'])
+    {
+        $sql_from .= ' LEFT JOIN ' . FORUMS_WATCH_TABLE . ' fw ON (fw.forum_id = f.forum_id AND fw.user_id = ' . $user->data['user_id'] . ')';
+        $lastread_select .= ', fw.notify_status';
+    }
+    
+    $sql = "SELECT f.* $lastread_select
+        FROM $sql_from
+        WHERE f.forum_id = $forum_id";
+    $result = $db->sql_query($sql);
+    $forum_data = $db->sql_fetchrow($result);
+    $db->sql_freeresult($result);
+    
+    if (!$forum_data) trigger_error('NO_FORUM');
+    
+    // Permissions check
+    if (!$auth->acl_gets('f_list', 'f_read', $forum_id) || ($forum_data['forum_type'] == FORUM_LINK && $forum_data['forum_link'] && !$auth->acl_get('f_read', $forum_id)))
+    {
+        if ($user->data['user_id'] != ANONYMOUS)
+        {
+            trigger_error('SORRY_AUTH_READ');
+        }
+    
+        trigger_error('LOGIN_VIEWFORUM');
+    }
+    
+    $login_status = false;
+    // Forum is passworded ... check whether access has been granted to this
+    // user this session, if not show login box
+    if ($forum_data['forum_password'])
+    {
+        $sql = 'SELECT forum_id
+            FROM ' . FORUMS_ACCESS_TABLE . '
+            WHERE forum_id = ' . $forum_data['forum_id'] . '
+                AND user_id = ' . $user->data['user_id'] . "
+                AND session_id = '" . $db->sql_escape($user->session_id) . "'";
+        $result = $db->sql_query($sql);
+        $row = $db->sql_fetchrow($result);
+        $db->sql_freeresult($result);
+    
+        if ($row)
+        {
+            $login_status = true;
+        }
+        elseif ($password)
+        {
+            // Remove expired authorised sessions
+            $sql = 'SELECT f.session_id
+                FROM ' . FORUMS_ACCESS_TABLE . ' f
+                LEFT JOIN ' . SESSIONS_TABLE . ' s ON (f.session_id = s.session_id)
+                WHERE s.session_id IS NULL';
+            $result = $db->sql_query($sql);
+    
+            if ($row = $db->sql_fetchrow($result))
+            {
+                $sql_in = array();
+                do
+                {
+                    $sql_in[] = (string) $row['session_id'];
+                }
+                while ($row = $db->sql_fetchrow($result));
+    
+                // Remove expired sessions
+                $sql = 'DELETE FROM ' . FORUMS_ACCESS_TABLE . '
+                    WHERE ' . $db->sql_in_set('session_id', $sql_in);
+                $db->sql_query($sql);
+            }
+            $db->sql_freeresult($result);
+    
+            if (phpbb_check_hash($password, $forum_data['forum_password']))
+            {
+                $sql_ary = array(
+                    'forum_id'        => (int) $forum_data['forum_id'],
+                    'user_id'        => (int) $user->data['user_id'],
+                    'session_id'    => (string) $user->session_id,
+                );
+    
+                $db->sql_query('INSERT INTO ' . FORUMS_ACCESS_TABLE . ' ' . $db->sql_build_array('INSERT', $sql_ary));
+    
+                $login_status = true;
+            }
+        }
+    }
+    
+    $response = new xmlrpcval(
+        array(
+            'result'        => new xmlrpcval($login_status, 'boolean'),
+            'result_text'   => new xmlrpcval($login_status ? '' : 'Password is wrong', 'base64'),
+        ),
+        'struct'
+    );
+
+    return new xmlrpcresp($response);
+}
diff -ruN phpBB-3.0.10/mobiquo/function/login.php phpbb/mobiquo/function/login.php
--- phpBB-3.0.10/mobiquo/function/login.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/function/login.php	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,82 @@
+<?php
+/**
+*
+* @copyright (c) 2009, 2010, 2011 Quoord Systems Limited
+* @license http://opensource.org/licenses/gpl-2.0.php GNU Public License (GPLv2)
+*
+*/
+
+defined('IN_MOBIQUO') or exit;
+
+function login_func($xmlrpc_params)
+{
+    global $auth, $user, $config, $db, $phpbb_root_path, $phpEx;
+    
+    $params = php_xmlrpc_decode($xmlrpc_params);
+    
+    $user->setup('ucp');
+    
+    $username = $params[0];
+    $password = $params[1];
+    $viewonline = isset($params[2]) ? !$params[2] : 1;
+    set_var($username, $username, 'string', true);
+    set_var($password, $password, 'string', true);
+    header('Set-Cookie: mobiquo_a=0');
+    header('Set-Cookie: mobiquo_b=0');
+    header('Set-Cookie: mobiquo_c=0');
+    $login_result = $auth->login($username, $password, true, $viewonline);
+    
+    $usergroup_id = array();
+    if ($login_result['status'] == LOGIN_SUCCESS)
+    {
+        $auth->acl($user->data);
+        
+        // Compatibility with mod NV who was here
+        if (file_exists($phpbb_root_path . 'includes/mods/who_was_here.' . $phpEx))
+        {
+            include_once($phpbb_root_path . 'includes/mods/who_was_here.' . $phpEx);
+            if (class_exists('phpbb_mods_who_was_here') && method_exists('phpbb_mods_who_was_here', 'update_session'))
+            {
+                @phpbb_mods_who_was_here::update_session();
+            }
+        }
+        
+    } else {
+        $error_msg = str_replace('%s', '', strip_tags($user->lang[$login_result['error_msg']]));
+        
+        return new xmlrpcresp(new xmlrpcval(array(
+            'result'        => new xmlrpcval(false, 'boolean'),
+            'result_text'   => new xmlrpcval($error_msg, 'base64'),
+        ), 'struct'));
+    }
+    
+    if ($config['max_attachments'] == 0) $config['max_attachments'] = 100;
+    
+    $usergroup_id[] = new xmlrpcval($user->data['group_id']);
+    $can_readpm = $config['allow_privmsg'] && $auth->acl_get('u_readpm') && ($user->data['user_allow_pm'] || $auth->acl_gets('a_', 'm_') || $auth->acl_getf_global('m_'));
+    $can_sendpm = $config['allow_privmsg'] && $auth->acl_get('u_sendpm') && ($user->data['user_allow_pm'] || $auth->acl_gets('a_', 'm_') || $auth->acl_getf_global('m_'));
+    $can_upload = ($config['allow_avatar_upload'] && file_exists($phpbb_root_path . $config['avatar_path']) && (function_exists('phpbb_is_writable') ? phpbb_is_writable($phpbb_root_path . $config['avatar_path']) : 1) && $auth->acl_get('u_chgavatar') && (@ini_get('file_uploads') || strtolower(@ini_get('file_uploads')) == 'on')) ? true : false;
+    $can_search = $auth->acl_get('u_search') && $auth->acl_getf_global('f_search') && $config['load_search'];
+    $can_whosonline = $auth->acl_gets('u_viewprofile', 'a_user', 'a_useradd', 'a_userdel');
+    $max_filesize   = ($config['max_filesize'] === '0' || $config['max_filesize'] > 10485760) ? 10485760 : $config['max_filesize'];
+    
+    $response = new xmlrpcval(array(
+        'result'        => new xmlrpcval(true, 'boolean'),
+        'user_id'       => new xmlrpcval($user->data['user_id'], 'string'),
+        'username'      => new xmlrpcval($user->data['username'], 'base64'),
+        'usergroup_id'  => new xmlrpcval($usergroup_id, 'array'),
+        'icon_url'      => new xmlrpcval(get_user_avatar_url($user->data['user_avatar'], $user->data['user_avatar_type']), 'string'),
+        'post_count'    => new xmlrpcval($user->data['user_posts'], 'int'),
+        'can_pm'        => new xmlrpcval($can_readpm, 'boolean'),
+        'can_send_pm'   => new xmlrpcval($can_sendpm, 'boolean'),
+        'can_moderate'  => new xmlrpcval($auth->acl_get('m_') || $auth->acl_getf_global('m_'), 'boolean'),
+        'max_attachment'=> new xmlrpcval($config['max_attachments'], 'int'),
+        'max_png_size'  => new xmlrpcval($max_filesize, 'int'),
+        'max_jpg_size'  => new xmlrpcval($max_filesize, 'int'),
+        'can_search'    => new xmlrpcval($can_search, 'boolean'),
+        'can_whosonline'    => new xmlrpcval($can_whosonline, 'boolean'),
+        'can_upload_avatar' => new xmlrpcval($can_upload, 'boolean'),
+    ), 'struct');
+    
+    return new xmlrpcresp($response);
+}
diff -ruN phpBB-3.0.10/mobiquo/function/logout_user.php phpbb/mobiquo/function/logout_user.php
--- phpBB-3.0.10/mobiquo/function/logout_user.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/function/logout_user.php	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,18 @@
+<?php
+/**
+*
+* @copyright (c) 2009, 2010, 2011 Quoord Systems Limited
+* @license http://opensource.org/licenses/gpl-2.0.php GNU Public License (GPLv2)
+*
+*/
+
+defined('IN_MOBIQUO') or exit;
+
+function logout_user_func()
+{
+    global $user;
+    
+    $user->session_kill();
+
+    return new xmlrpcresp(new xmlrpcval(true, 'boolean'));
+} // End of logout_user_func
diff -ruN phpBB-3.0.10/mobiquo/function/mark_all_as_read.php phpbb/mobiquo/function/mark_all_as_read.php
--- phpBB-3.0.10/mobiquo/function/mark_all_as_read.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/function/mark_all_as_read.php	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,34 @@
+<?php
+/**
+*
+* @copyright (c) 2009, 2010, 2011 Quoord Systems Limited
+* @license http://opensource.org/licenses/gpl-2.0.php GNU Public License (GPLv2)
+*
+*/
+
+defined('IN_MOBIQUO') or exit;
+
+function mark_all_as_read_func($xmlrpc_params)
+{
+    $params = php_xmlrpc_decode($xmlrpc_params);
+    
+    if (!isset($params[0]) || $params[0] === 0)
+    {
+        markread('all');
+    }
+    else
+    {
+        $forum_id = intval($params[0]);
+        markread('topics', $forum_id);
+    }
+    
+    $response = new xmlrpcval(
+        array(
+            'result'        => new xmlrpcval(true, 'boolean'),
+            'result_text'   => new xmlrpcval('', 'base64'),
+        ),
+        'struct'
+    );
+    
+    return new xmlrpcresp($response);
+}
diff -ruN phpBB-3.0.10/mobiquo/function/moderation.php phpbb/mobiquo/function/moderation.php
--- phpBB-3.0.10/mobiquo/function/moderation.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/function/moderation.php	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,911 @@
+<?php
+/**
+*
+* @copyright (c) 2009, 2010, 2011 Quoord Systems Limited
+* @license http://opensource.org/licenses/gpl-2.0.php GNU Public License (GPLv2)
+*
+*/
+
+defined('IN_MOBIQUO') or exit;
+
+include($phpbb_root_path . 'includes/functions_admin.' . $phpEx);
+require($phpbb_root_path . 'includes/functions_module.' . $phpEx);
+
+$user->setup('mcp');
+
+$module = new p_master();
+
+// Basic parameter data
+$id = request_var('i', '');
+
+if (isset($_REQUEST['mode']) && is_array($_REQUEST['mode']))
+{
+    $mode = request_var('mode', array(''));
+    list($mode, ) = each($mode);
+}
+else
+{
+    $mode = request_var('mode', '');
+}
+
+// Only Moderators can go beyond this point
+if (!$user->data['is_registered'])
+{
+    trigger_error('LOGIN_EXPLAIN_MCP');
+}
+
+$quickmod = (isset($_REQUEST['quickmod'])) ? true : false;
+$action = request_var('action', '');
+$action_ary = request_var('action', array('' => 0));
+
+$forum_action = request_var('forum_action', '');
+if ($forum_action !== '' && !empty($_POST['sort']))
+{
+    $action = $forum_action;
+}
+
+if (sizeof($action_ary))
+{
+    list($action, ) = each($action_ary);
+}
+unset($action_ary);
+
+if ($mode == 'topic_logs')
+{
+    $id = 'logs';
+    $quickmod = false;
+}
+
+$post_id = request_var('p', 0);
+$topic_id = request_var('t', 0);
+$forum_id = request_var('f', 0);
+$report_id = request_var('r', 0);
+$user_id = request_var('u', 0);
+$username = utf8_normalize_nfc(request_var('username', '', true));
+
+if ($post_id)
+{
+    // We determine the topic and forum id here, to make sure the moderator really has moderative rights on this post
+    $sql = 'SELECT topic_id, forum_id
+        FROM ' . POSTS_TABLE . "
+        WHERE post_id = $post_id";
+    $result = $db->sql_query($sql);
+    $row = $db->sql_fetchrow($result);
+    $db->sql_freeresult($result);
+
+    $_REQUEST['t'] = $topic_id = (int) $row['topic_id'];
+    $_REQUEST['f'] = $forum_id = (int) ($row['forum_id']) ? $row['forum_id'] : $forum_id;
+}
+else if ($topic_id)
+{
+    $sql = 'SELECT forum_id, topic_first_post_id
+        FROM ' . TOPICS_TABLE . "
+        WHERE topic_id = $topic_id";
+    $result = $db->sql_query($sql);
+    $row = $db->sql_fetchrow($result);
+    $db->sql_freeresult($result);
+
+    $_REQUEST['f'] = $forum_id = (int) $row['forum_id'];
+    if ($request_method == 'm_approve_topic') $_REQUEST['post_id_list'] = array($row['topic_first_post_id']);
+}
+
+// transform username to ban id
+if ($request_method == 'm_ban_user' && $request_params[1] == 2) {
+    $ban_userid = get_user_id_by_name($request_params[0]);
+    $sql = 'SELECT ban_id
+            FROM ' . BANLIST_TABLE . '
+            WHERE ban_userid = ' . $ban_userid;
+    $result = $db->sql_query_limit($sql, 1);
+    $ban_id = $db->sql_fetchfield('ban_id');
+    $db->sql_freeresult($result);
+    unset($sql);
+    $_REQUEST['unban'] = array($ban_id);
+}
+
+// If the user doesn't have any moderator powers (globally or locally) he can't access the mcp
+if (!$auth->acl_getf_global('m_'))
+{
+    // Except he is using one of the quickmod tools for users
+    $user_quickmod_actions = array(
+        'lock'            => 'f_user_lock',
+        'make_sticky'    => 'f_sticky',
+        'make_announce'    => 'f_announce',
+        'make_global'    => 'f_announce',
+        'make_normal'    => array('f_announce', 'f_sticky')
+    );
+
+    $allow_user = false;
+    if ($quickmod && isset($user_quickmod_actions[$action]) && $user->data['is_registered'] && $auth->acl_gets($user_quickmod_actions[$action], $forum_id))
+    {
+        $topic_info = get_topic_data(array($topic_id));
+        if ($topic_info[$topic_id]['topic_poster'] == $user->data['user_id'])
+        {
+            $allow_user = true;
+        }
+    }
+
+    if (!$allow_user)
+    {
+        trigger_error('NOT_AUTHORISED');
+    }
+}
+
+// if the user cannot read the forum he tries to access then we won't allow mcp access either
+if ($forum_id && !$auth->acl_get('f_read', $forum_id))
+{
+    trigger_error('NOT_AUTHORISED');
+}
+
+if ($forum_id)
+{
+    $module->acl_forum_id = $forum_id;
+}
+
+// Instantiate module system and generate list of available modules
+$module->list_modules('mcp');
+
+if ($quickmod)
+{
+    $mode = 'quickmod';
+
+    switch ($action)
+    {
+        case 'lock':
+        case 'unlock':
+        case 'lock_post':
+        case 'unlock_post':
+        case 'make_sticky':
+        case 'make_announce':
+        case 'make_global':
+        case 'make_normal':
+        case 'fork':
+        case 'move':
+        case 'delete_post':
+        case 'delete_topic':
+            $module->load('mcp', 'main', 'quickmod');
+            return;
+        break;
+
+        case 'topic_logs':
+            // Reset start parameter if we jumped from the quickmod dropdown
+            if (request_var('start', 0))
+            {
+                $_REQUEST['start'] = 0;
+            }
+
+            $module->set_active('logs', 'topic_logs');
+        break;
+
+        case 'merge_topic':
+            $module->set_active('main', 'forum_view');
+        break;
+
+        case 'split':
+        case 'merge':
+            $module->set_active('main', 'topic_view');
+        break;
+
+        default:
+            trigger_error("$action not allowed as quickmod", E_USER_ERROR);
+        break;
+    }
+}
+else
+{
+    // Select the active module
+    $module->set_active($id, $mode);
+}
+
+$module->load_active();
+
+
+function m_get_moderate_topic_func()
+{
+    global $template, $auth, $user;
+    
+    $posts = array();
+    foreach($template->_tpldata['postrow'] as $postinfo) {
+        $posts[] = $postinfo['POST_ID'];
+    }
+    
+    $posts = get_post_data($posts);
+    
+    $post_list = array();
+    foreach($template->_tpldata['postrow'] as $postinfo)
+    {
+        $post = $posts[$postinfo['POST_ID']];
+        
+        if (empty($post['forum_id']))
+        {
+            $post['forum_id'] = 0;
+            $post['forum_name'] = $user->lang['ANNOUNCEMENTS'];
+        }
+        
+        $post_list[] = new xmlrpcval(array(
+            'forum_id'          => new xmlrpcval($post['forum_id']),
+            'forum_name'        => new xmlrpcval(basic_clean($post['forum_name']), 'base64'),
+            'topic_id'          => new xmlrpcval($post['topic_id']),
+            'topic_title'       => new xmlrpcval(basic_clean($post['topic_title']), 'base64'),
+            'post_id'           => new xmlrpcval($post['post_id']),
+            'post_title'        => new xmlrpcval(basic_clean($post['post_subject']), 'base64'),
+            'topic_author_name' => new xmlrpcval(basic_clean($post['username']), 'base64'),
+            'icon_url'          => new xmlrpcval(get_user_avatar_url($post['user_avatar'], $post['user_avatar_type'])),
+            'post_time'         => new xmlrpcval(mobiquo_iso8601_encode($post['post_time']), 'dateTime.iso8601'),
+            'short_content'     => new xmlrpcval(process_short_content($post['post_text']), 'base64'),
+            'can_delete'        => new xmlrpcval($auth->acl_get('m_delete', $post['forum_id']), 'boolean'),
+        ), 'struct');
+    }
+    
+    preg_match('/(\d+)\D/', $template->_rootref['TOTAL'], $total);
+    
+    $response = new xmlrpcval(
+        array(
+            'total_topic_num' => new xmlrpcval($total[1], 'int'),
+            'topics'          => new xmlrpcval($post_list, 'array'),
+        ), 'struct'
+    );
+
+    return new xmlrpcresp($response);
+}
+
+function m_get_moderate_post_func()
+{
+    global $template, $auth, $user;
+    
+    $posts = array();
+    foreach($template->_tpldata['postrow'] as $postinfo) {
+        $posts[] = $postinfo['POST_ID'];
+    }
+    
+    $posts = get_post_data($posts);
+    
+    $post_list = array();
+    foreach($template->_tpldata['postrow'] as $postinfo)
+    {
+        $post = $posts[$postinfo['POST_ID']];
+        
+        if (empty($post['forum_id']))
+        {
+            $post['forum_id'] = 0;
+            $post['forum_name'] = $user->lang['ANNOUNCEMENTS'];
+        }
+        
+        $post_list[] = new xmlrpcval(array(
+            'forum_id'          => new xmlrpcval($post['forum_id']),
+            'forum_name'        => new xmlrpcval(basic_clean($post['forum_name']), 'base64'),
+            'topic_id'          => new xmlrpcval($post['topic_id']),
+            'topic_title'       => new xmlrpcval(basic_clean($post['topic_title']), 'base64'),
+            'post_id'           => new xmlrpcval($post['post_id']),
+            'post_title'        => new xmlrpcval(basic_clean($post['post_subject']), 'base64'),
+            'post_author_name'  => new xmlrpcval(basic_clean($post['username']), 'base64'),
+            'icon_url'          => new xmlrpcval(get_user_avatar_url($post['user_avatar'], $post['user_avatar_type'])),
+            'post_time'         => new xmlrpcval(mobiquo_iso8601_encode($post['post_time']), 'dateTime.iso8601'),
+            'short_content'     => new xmlrpcval(process_short_content($post['post_text']), 'base64'),
+            'can_delete'        => new xmlrpcval($auth->acl_get('m_delete', $forum_id), 'boolean'),
+        ), 'struct');
+    }
+    
+    preg_match('/(\d+)\D/', $template->_rootref['TOTAL'], $total);
+    
+    $response = new xmlrpcval(
+        array(
+            'total_post_num' => new xmlrpcval($total[1], 'int'),
+            'posts'          => new xmlrpcval($post_list, 'array'),
+        ), 'struct'
+    );
+
+    return new xmlrpcresp($response);
+}
+
+function m_get_report_post_func()
+{
+    global $template, $auth, $user;
+    
+    $posts = array();
+    foreach($template->_tpldata['postrow'] as $postinfo) {
+        $posts[] = $postinfo['POST_ID'];
+    }
+    
+    $posts = get_post_data($posts);
+    
+    $post_list = array();
+    foreach($template->_tpldata['postrow'] as $postinfo)
+    {
+        $post = $posts[$postinfo['POST_ID']];
+        
+        if (empty($post['forum_id']))
+        {
+            $user->setup('viewforum');
+            $post['forum_id'] = 0;
+            $post['forum_name'] = $user->lang['ANNOUNCEMENTS'];
+        }
+        
+        $post_list[] = new xmlrpcval(array(
+            'forum_id'          => new xmlrpcval($post['forum_id']),
+            'forum_name'        => new xmlrpcval(basic_clean($post['forum_name']), 'base64'),
+            'topic_id'          => new xmlrpcval($post['topic_id']),
+            'topic_title'       => new xmlrpcval(basic_clean($post['topic_title']), 'base64'),
+            'post_id'           => new xmlrpcval($post['post_id']),
+            'post_title'        => new xmlrpcval(basic_clean($post['post_subject']), 'base64'),
+            'post_author_name'  => new xmlrpcval(basic_clean($post['username']), 'base64'),
+            'icon_url'          => new xmlrpcval(get_user_avatar_url($post['user_avatar'], $post['user_avatar_type'])),
+            'post_time'         => new xmlrpcval(mobiquo_iso8601_encode($post['post_time']), 'dateTime.iso8601'),
+            'short_content'     => new xmlrpcval(process_short_content($post['post_text']), 'base64'),
+            'can_delete'        => new xmlrpcval($auth->acl_get('m_delete', $forum_id), 'boolean'),
+        ), 'struct');
+    }
+    
+    $response = new xmlrpcval(
+        array(
+            'total_report_num' => new xmlrpcval($template->_rootref['TOTAL'], 'int'),
+            'reports'          => new xmlrpcval($post_list, 'array'),
+        ), 'struct'
+    );
+
+    return new xmlrpcresp($response);
+}
+
+
+function extra_url()
+{
+    global $forum_id, $topic_id, $post_id, $report_id, $user_id;
+    
+    $url_extra = '';
+    $url_extra .= ($forum_id) ? "&amp;f=$forum_id" : '';
+    $url_extra .= ($topic_id) ? "&amp;t=$topic_id" : '';
+    $url_extra .= ($post_id) ? "&amp;p=$post_id" : '';
+    $url_extra .= ($user_id) ? "&amp;u=$user_id" : '';
+    $url_extra .= ($report_id) ? "&amp;r=$report_id" : '';
+    
+    return $url_extra;
+}
+
+/**
+* Get simple topic data
+*/
+function get_topic_data($topic_ids, $acl_list = false, $read_tracking = false)
+{
+    global $auth, $db, $config, $user;
+    static $rowset = array();
+
+    $topics = array();
+
+    if (!sizeof($topic_ids))
+    {
+        return array();
+    }
+
+    // cache might not contain read tracking info, so we can't use it if read
+    // tracking information is requested
+    if (!$read_tracking)
+    {
+        $cache_topic_ids = array_intersect($topic_ids, array_keys($rowset));
+        $topic_ids = array_diff($topic_ids, array_keys($rowset));
+    }
+    else
+    {
+        $cache_topic_ids = array();
+    }
+
+    if (sizeof($topic_ids))
+    {
+        $sql_array = array(
+            'SELECT'    => 't.*, f.*',
+
+            'FROM'        => array(
+                TOPICS_TABLE    => 't',
+            ),
+
+            'LEFT_JOIN'    => array(
+                array(
+                    'FROM'    => array(FORUMS_TABLE => 'f'),
+                    'ON'    => 'f.forum_id = t.forum_id'
+                )
+            ),
+
+            'WHERE'        => $db->sql_in_set('t.topic_id', $topic_ids)
+        );
+
+        if ($read_tracking && $config['load_db_lastread'])
+        {
+            $sql_array['SELECT'] .= ', tt.mark_time, ft.mark_time as forum_mark_time';
+
+            $sql_array['LEFT_JOIN'][] = array(
+                'FROM'    => array(TOPICS_TRACK_TABLE => 'tt'),
+                'ON'    => 'tt.user_id = ' . $user->data['user_id'] . ' AND t.topic_id = tt.topic_id'
+            );
+
+            $sql_array['LEFT_JOIN'][] = array(
+                'FROM'    => array(FORUMS_TRACK_TABLE => 'ft'),
+                'ON'    => 'ft.user_id = ' . $user->data['user_id'] . ' AND t.forum_id = ft.forum_id'
+            );
+        }
+
+        $sql = $db->sql_build_query('SELECT', $sql_array);
+        $result = $db->sql_query($sql);
+
+        while ($row = $db->sql_fetchrow($result))
+        {
+            if (!$row['forum_id'])
+            {
+                // Global Announcement?
+                $row['forum_id'] = request_var('f', 0);
+            }
+
+            $rowset[$row['topic_id']] = $row;
+
+            if ($acl_list && !$auth->acl_gets($acl_list, $row['forum_id']))
+            {
+                continue;
+            }
+
+            $topics[$row['topic_id']] = $row;
+        }
+        $db->sql_freeresult($result);
+    }
+
+    foreach ($cache_topic_ids as $id)
+    {
+        if (!$acl_list || $auth->acl_gets($acl_list, $rowset[$id]['forum_id']))
+        {
+            $topics[$id] = $rowset[$id];
+        }
+    }
+
+    return $topics;
+}
+
+/**
+* Get simple post data
+*/
+function get_post_data($post_ids, $acl_list = false, $read_tracking = false)
+{
+    global $db, $auth, $config, $user;
+
+    $rowset = array();
+
+    if (!sizeof($post_ids))
+    {
+        return array();
+    }
+
+    $sql_array = array(
+        'SELECT'    => 'p.*, u.*, t.*, f.*',
+
+        'FROM'        => array(
+            USERS_TABLE        => 'u',
+            POSTS_TABLE        => 'p',
+            TOPICS_TABLE    => 't',
+        ),
+
+        'LEFT_JOIN'    => array(
+            array(
+                'FROM'    => array(FORUMS_TABLE => 'f'),
+                'ON'    => 'f.forum_id = t.forum_id'
+            )
+        ),
+
+        'WHERE'        => $db->sql_in_set('p.post_id', $post_ids) . '
+            AND u.user_id = p.poster_id
+            AND t.topic_id = p.topic_id',
+    );
+
+    if ($read_tracking && $config['load_db_lastread'])
+    {
+        $sql_array['SELECT'] .= ', tt.mark_time, ft.mark_time as forum_mark_time';
+
+        $sql_array['LEFT_JOIN'][] = array(
+            'FROM'    => array(TOPICS_TRACK_TABLE => 'tt'),
+            'ON'    => 'tt.user_id = ' . $user->data['user_id'] . ' AND t.topic_id = tt.topic_id'
+        );
+
+        $sql_array['LEFT_JOIN'][] = array(
+            'FROM'    => array(FORUMS_TRACK_TABLE => 'ft'),
+            'ON'    => 'ft.user_id = ' . $user->data['user_id'] . ' AND t.forum_id = ft.forum_id'
+        );
+    }
+
+    $sql = $db->sql_build_query('SELECT', $sql_array);
+    $result = $db->sql_query($sql);
+    unset($sql_array);
+
+    while ($row = $db->sql_fetchrow($result))
+    {
+        if (!$row['forum_id'])
+        {
+            // Global Announcement?
+            $row['forum_id'] = request_var('f', 0);
+        }
+
+        if ($acl_list && !$auth->acl_gets($acl_list, $row['forum_id']))
+        {
+            continue;
+        }
+
+        if (!$row['post_approved'] && !$auth->acl_get('m_approve', $row['forum_id']))
+        {
+            // Moderators without the permission to approve post should at least not see them. ;)
+            continue;
+        }
+
+        $rowset[$row['post_id']] = $row;
+    }
+    $db->sql_freeresult($result);
+
+    return $rowset;
+}
+
+/**
+* Get simple forum data
+*/
+function get_forum_data($forum_id, $acl_list = 'f_list', $read_tracking = false)
+{
+    global $auth, $db, $user, $config;
+
+    $rowset = array();
+
+    if (!is_array($forum_id))
+    {
+        $forum_id = array($forum_id);
+    }
+
+    if (!sizeof($forum_id))
+    {
+        return array();
+    }
+
+    if ($read_tracking && $config['load_db_lastread'])
+    {
+        $read_tracking_join = ' LEFT JOIN ' . FORUMS_TRACK_TABLE . ' ft ON (ft.user_id = ' . $user->data['user_id'] . '
+            AND ft.forum_id = f.forum_id)';
+        $read_tracking_select = ', ft.mark_time';
+    }
+    else
+    {
+        $read_tracking_join = $read_tracking_select = '';
+    }
+
+    $sql = "SELECT f.* $read_tracking_select
+        FROM " . FORUMS_TABLE . " f$read_tracking_join
+        WHERE " . $db->sql_in_set('f.forum_id', $forum_id);
+    $result = $db->sql_query($sql);
+
+    while ($row = $db->sql_fetchrow($result))
+    {
+        if ($acl_list && !$auth->acl_gets($acl_list, $row['forum_id']))
+        {
+            continue;
+        }
+
+        if ($auth->acl_get('m_approve', $row['forum_id']))
+        {
+            $row['forum_topics'] = $row['forum_topics_real'];
+        }
+
+        $rowset[$row['forum_id']] = $row;
+    }
+    $db->sql_freeresult($result);
+
+    return $rowset;
+}
+
+/**
+* Get simple pm data
+*/
+function get_pm_data($pm_ids)
+{
+    global $db, $auth, $config, $user;
+
+    $rowset = array();
+
+    if (!sizeof($pm_ids))
+    {
+        return array();
+    }
+
+    $sql_array = array(
+        'SELECT'    => 'p.*, u.*',
+
+        'FROM'        => array(
+            USERS_TABLE            => 'u',
+            PRIVMSGS_TABLE        => 'p',
+        ),
+
+        'WHERE'        => $db->sql_in_set('p.msg_id', $pm_ids) . '
+            AND u.user_id = p.author_id',
+    );
+
+    $sql = $db->sql_build_query('SELECT', $sql_array);
+    $result = $db->sql_query($sql);
+    unset($sql_array);
+
+    while ($row = $db->sql_fetchrow($result))
+    {
+        $rowset[$row['msg_id']] = $row;
+    }
+    $db->sql_freeresult($result);
+
+    return $rowset;
+}
+
+function mcp_sorting($mode, &$sort_days, &$sort_key, &$sort_dir, &$sort_by_sql, &$sort_order_sql, &$total, $forum_id = 0, $topic_id = 0, $where_sql = 'WHERE')
+{
+    global $db, $user, $auth, $template, $config;
+
+    $sort_days = request_var('st', 0);
+    $min_time = ($sort_days) ? time() - ($sort_days * 86400) : 0;
+
+    switch ($mode)
+    {
+        case 'viewforum':
+            $type = 'topics';
+            $default_key = 't';
+            $default_dir = 'd';
+
+            $sql = 'SELECT COUNT(topic_id) AS total
+                FROM ' . TOPICS_TABLE . "
+                $where_sql forum_id = $forum_id
+                    AND topic_type NOT IN (" . POST_ANNOUNCE . ', ' . POST_GLOBAL . ")
+                    AND topic_last_post_time >= $min_time";
+
+            if (!$auth->acl_get('m_approve', $forum_id))
+            {
+                $sql .= 'AND topic_approved = 1';
+            }
+        break;
+
+        case 'viewtopic':
+            $type = 'posts';
+            $default_key = 't';
+            $default_dir = 'a';
+
+            $sql = 'SELECT COUNT(post_id) AS total
+                FROM ' . POSTS_TABLE . "
+                $where_sql topic_id = $topic_id
+                    AND post_time >= $min_time";
+
+            if (!$auth->acl_get('m_approve', $forum_id))
+            {
+                $sql .= 'AND post_approved = 1';
+            }
+        break;
+
+        case 'unapproved_posts':
+            $type = 'posts';
+            $default_key = 't';
+            $default_dir = 'd';
+            $where_sql .= ($topic_id) ? ' p.topic_id = ' . $topic_id . ' AND' : '';
+
+            $sql = 'SELECT COUNT(p.post_id) AS total
+                FROM ' . POSTS_TABLE . ' p, ' . TOPICS_TABLE . " t
+                $where_sql " . $db->sql_in_set('p.forum_id', ($forum_id) ? array($forum_id) : array_intersect(get_forum_list('f_read'), get_forum_list('m_approve'))) . '
+                    AND p.post_approved = 0
+                    AND t.topic_id = p.topic_id
+                    AND t.topic_first_post_id <> p.post_id';
+
+            if ($min_time)
+            {
+                $sql .= ' AND post_time >= ' . $min_time;
+            }
+        break;
+
+        case 'unapproved_topics':
+            $type = 'topics';
+            $default_key = 't';
+            $default_dir = 'd';
+
+            $sql = 'SELECT COUNT(topic_id) AS total
+                FROM ' . TOPICS_TABLE . "
+                $where_sql " . $db->sql_in_set('forum_id', ($forum_id) ? array($forum_id) : array_intersect(get_forum_list('f_read'), get_forum_list('m_approve'))) . '
+                    AND topic_approved = 0';
+
+            if ($min_time)
+            {
+                $sql .= ' AND topic_time >= ' . $min_time;
+            }
+        break;
+
+        case 'pm_reports':
+        case 'pm_reports_closed':
+        case 'reports':
+        case 'reports_closed':
+            $pm = (strpos($mode, 'pm_') === 0) ? true : false;
+
+            $type = ($pm) ? 'pm_reports' : 'reports';
+            $default_key = 't';
+            $default_dir = 'd';
+            $limit_time_sql = ($min_time) ? "AND r.report_time >= $min_time" : '';
+
+            if ($topic_id)
+            {
+                $where_sql .= ' p.topic_id = ' . $topic_id . ' AND ';
+            }
+            else if ($forum_id)
+            {
+                $where_sql .= ' p.forum_id = ' . $forum_id . ' AND ';
+            }
+            else if (!$pm)
+            {
+                $where_sql .= ' ' . $db->sql_in_set('p.forum_id', get_forum_list(array('!f_read', '!m_report')), true, true) . ' AND ';
+            }
+
+            if ($mode == 'reports' || $mode == 'pm_reports')
+            {
+                $where_sql .= ' r.report_closed = 0 AND ';
+            }
+            else
+            {
+                $where_sql .= ' r.report_closed = 1 AND ';
+            }
+
+            if ($pm)
+            {
+                $sql = 'SELECT COUNT(r.report_id) AS total
+                    FROM ' . REPORTS_TABLE . ' r, ' . PRIVMSGS_TABLE . " p
+                    $where_sql r.post_id = 0
+                        AND p.msg_id = r.pm_id
+                        $limit_time_sql";
+            }
+            else
+            {
+                $sql = 'SELECT COUNT(r.report_id) AS total
+                    FROM ' . REPORTS_TABLE . ' r, ' . POSTS_TABLE . " p
+                    $where_sql " . (version_compare($config['version'], '3.0.6', '<') ? '1' : " r.pm_id = 0") . "
+                        AND p.post_id = r.post_id
+                        $limit_time_sql";
+            }
+        break;
+
+        case 'viewlogs':
+            $type = 'logs';
+            $default_key = 't';
+            $default_dir = 'd';
+
+            $sql = 'SELECT COUNT(log_id) AS total
+                FROM ' . LOG_TABLE . "
+                $where_sql " . $db->sql_in_set('forum_id', ($forum_id) ? array($forum_id) : array_intersect(get_forum_list('f_read'), get_forum_list('m_'))) . '
+                    AND log_time >= ' . $min_time . '
+                    AND log_type = ' . LOG_MOD;
+        break;
+    }
+
+    $sort_key = request_var('sk', $default_key);
+    $sort_dir = request_var('sd', $default_dir);
+    $sort_dir_text = array('a' => $user->lang['ASCENDING'], 'd' => $user->lang['DESCENDING']);
+
+    switch ($type)
+    {
+        case 'topics':
+            $limit_days = array(0 => $user->lang['ALL_TOPICS'], 1 => $user->lang['1_DAY'], 7 => $user->lang['7_DAYS'], 14 => $user->lang['2_WEEKS'], 30 => $user->lang['1_MONTH'], 90 => $user->lang['3_MONTHS'], 180 => $user->lang['6_MONTHS'], 365 => $user->lang['1_YEAR']);
+            $sort_by_text = array('a' => $user->lang['AUTHOR'], 't' => $user->lang['POST_TIME'], 'tt' => $user->lang['TOPIC_TIME'], 'r' => $user->lang['REPLIES'], 's' => $user->lang['SUBJECT'], 'v' => $user->lang['VIEWS']);
+
+            $sort_by_sql = array('a' => 't.topic_first_poster_name', 't' => 't.topic_last_post_time', 'tt' => 't.topic_time', 'r' => (($auth->acl_get('m_approve', $forum_id)) ? 't.topic_replies_real' : 't.topic_replies'), 's' => 't.topic_title', 'v' => 't.topic_views');
+            $limit_time_sql = ($min_time) ? "AND t.topic_last_post_time >= $min_time" : '';
+        break;
+
+        case 'posts':
+            $limit_days = array(0 => $user->lang['ALL_POSTS'], 1 => $user->lang['1_DAY'], 7 => $user->lang['7_DAYS'], 14 => $user->lang['2_WEEKS'], 30 => $user->lang['1_MONTH'], 90 => $user->lang['3_MONTHS'], 180 => $user->lang['6_MONTHS'], 365 => $user->lang['1_YEAR']);
+            $sort_by_text = array('a' => $user->lang['AUTHOR'], 't' => $user->lang['POST_TIME'], 's' => $user->lang['SUBJECT']);
+            $sort_by_sql = array('a' => 'u.username_clean', 't' => 'p.post_time', 's' => 'p.post_subject');
+            $limit_time_sql = ($min_time) ? "AND p.post_time >= $min_time" : '';
+        break;
+
+        case 'reports':
+            $limit_days = array(0 => $user->lang['ALL_REPORTS'], 1 => $user->lang['1_DAY'], 7 => $user->lang['7_DAYS'], 14 => $user->lang['2_WEEKS'], 30 => $user->lang['1_MONTH'], 90 => $user->lang['3_MONTHS'], 180 => $user->lang['6_MONTHS'], 365 => $user->lang['1_YEAR']);
+            $sort_by_text = array('a' => $user->lang['AUTHOR'], 'r' => $user->lang['REPORTER'], 'p' => $user->lang['POST_TIME'], 't' => $user->lang['REPORT_TIME'], 's' => $user->lang['SUBJECT']);
+            $sort_by_sql = array('a' => 'u.username_clean', 'r' => 'ru.username', 'p' => 'p.post_time', 't' => 'r.report_time', 's' => 'p.post_subject');
+        break;
+
+        case 'pm_reports':
+            $limit_days = array(0 => $user->lang['ALL_REPORTS'], 1 => $user->lang['1_DAY'], 7 => $user->lang['7_DAYS'], 14 => $user->lang['2_WEEKS'], 30 => $user->lang['1_MONTH'], 90 => $user->lang['3_MONTHS'], 180 => $user->lang['6_MONTHS'], 365 => $user->lang['1_YEAR']);
+            $sort_by_text = array('a' => $user->lang['AUTHOR'], 'r' => $user->lang['REPORTER'], 'p' => $user->lang['POST_TIME'], 't' => $user->lang['REPORT_TIME'], 's' => $user->lang['SUBJECT']);
+            $sort_by_sql = array('a' => 'u.username_clean', 'r' => 'ru.username', 'p' => 'p.message_time', 't' => 'r.report_time', 's' => 'p.message_subject');
+        break;
+
+        case 'logs':
+            $limit_days = array(0 => $user->lang['ALL_ENTRIES'], 1 => $user->lang['1_DAY'], 7 => $user->lang['7_DAYS'], 14 => $user->lang['2_WEEKS'], 30 => $user->lang['1_MONTH'], 90 => $user->lang['3_MONTHS'], 180 => $user->lang['6_MONTHS'], 365 => $user->lang['1_YEAR']);
+            $sort_by_text = array('u' => $user->lang['SORT_USERNAME'], 't' => $user->lang['SORT_DATE'], 'i' => $user->lang['SORT_IP'], 'o' => $user->lang['SORT_ACTION']);
+
+            $sort_by_sql = array('u' => 'u.username_clean', 't' => 'l.log_time', 'i' => 'l.log_ip', 'o' => 'l.log_operation');
+            $limit_time_sql = ($min_time) ? "AND l.log_time >= $min_time" : '';
+        break;
+    }
+
+    if (!isset($sort_by_sql[$sort_key]))
+    {
+        $sort_key = $default_key;
+    }
+
+    $sort_order_sql = $sort_by_sql[$sort_key] . ' ' . (($sort_dir == 'd') ? 'DESC' : 'ASC');
+
+    $s_limit_days = $s_sort_key = $s_sort_dir = $sort_url = '';
+    gen_sort_selects($limit_days, $sort_by_text, $sort_days, $sort_key, $sort_dir, $s_limit_days, $s_sort_key, $s_sort_dir, $sort_url);
+
+    $template->assign_vars(array(
+        'S_SELECT_SORT_DIR'        => $s_sort_dir,
+        'S_SELECT_SORT_KEY'        => $s_sort_key,
+        'S_SELECT_SORT_DAYS'    => $s_limit_days)
+    );
+
+    if (($sort_days && $mode != 'viewlogs') || in_array($mode, array('reports', 'unapproved_topics', 'unapproved_posts')) || $where_sql != 'WHERE')
+    {
+        $result = $db->sql_query($sql);
+        $total = (int) $db->sql_fetchfield('total');
+        $db->sql_freeresult($result);
+    }
+    else
+    {
+        $total = -1;
+    }
+}
+
+function check_ids(&$ids, $table, $sql_id, $acl_list = false, $single_forum = false)
+{
+    global $db, $auth;
+
+    if (!is_array($ids) || empty($ids))
+    {
+        return false;
+    }
+
+    $sql = "SELECT $sql_id, forum_id FROM $table
+        WHERE " . $db->sql_in_set($sql_id, $ids);
+    $result = $db->sql_query($sql);
+
+    $ids = array();
+    $forum_id = false;
+
+    while ($row = $db->sql_fetchrow($result))
+    {
+        if ($acl_list && $row['forum_id'] && !$auth->acl_gets($acl_list, $row['forum_id']))
+        {
+            continue;
+        }
+
+        if ($acl_list && !$row['forum_id'] && !$auth->acl_getf_global($acl_list))
+        {
+            continue;
+        }
+
+        // Limit forum? If not, just assign the id.
+        if ($single_forum === false)
+        {
+            $ids[] = $row[$sql_id];
+            continue;
+        }
+
+        // Limit forum to a specific forum id?
+        // This can get really tricky, because we do not want to create a failure on global topics. :)
+        if ($row['forum_id'])
+        {
+            if ($single_forum !== true && $row['forum_id'] == (int) $single_forum)
+            {
+                $forum_id = (int) $single_forum;
+            }
+            else if ($forum_id === false)
+            {
+                $forum_id = $row['forum_id'];
+            }
+
+            if ($row['forum_id'] == $forum_id)
+            {
+                $ids[] = $row[$sql_id];
+            }
+        }
+        else
+        {
+            // Always add a global topic
+            $ids[] = $row[$sql_id];
+        }
+    }
+    $db->sql_freeresult($result);
+
+    if (!sizeof($ids))
+    {
+        return false;
+    }
+
+    // If forum id is false and ids populated we may have only global announcements selected (returning 0 because of (int) $forum_id)
+
+    return ($single_forum === false) ? true : (int) $forum_id;
+}
diff -ruN phpBB-3.0.10/mobiquo/function/new_topic.php phpbb/mobiquo/function/new_topic.php
--- phpBB-3.0.10/mobiquo/function/new_topic.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/function/new_topic.php	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,317 @@
+<?php
+/**
+*
+* @copyright (c) 2009, 2010, 2011 Quoord Systems Limited
+* @license http://opensource.org/licenses/gpl-2.0.php GNU Public License (GPLv2)
+*
+*/
+
+defined('IN_MOBIQUO') or exit;
+
+function new_topic_func($xmlrpc_params)
+{
+    global $db, $auth, $user, $config, $phpbb_root_path, $phpEx, $mobiquo_config;
+    
+    $user->setup('posting');
+    if (!$user->data['is_registered']) trigger_error('LOGIN_EXPLAIN_POST');
+    
+    $params = php_xmlrpc_decode($xmlrpc_params);
+    
+    // get parameters
+    $forum_id   = isset($params[0]) ? intval($params[0]) : '';
+    $subject    = isset($params[1]) ? $params[1] : '';
+    $text_body  = isset($params[2]) ? $params[2] : '';
+    $_POST['attachment_data'] = (isset($params[5]) && $params[5]) ? unserialize(base64_decode($params[5])) : array();
+    
+    if (!$forum_id) trigger_error('NO_FORUM');
+    if (utf8_clean_string($subject) === '') trigger_error('EMPTY_SUBJECT');
+    if (utf8_clean_string($text_body) === '') trigger_error('TOO_FEW_CHARS');
+
+    $post_data = array();
+    $current_time = time();
+    
+    $sql = 'SELECT * FROM ' . FORUMS_TABLE . " WHERE forum_id = $forum_id";
+    $result = $db->sql_query($sql);
+    $post_data = $db->sql_fetchrow($result);
+    $db->sql_freeresult($result);
+    
+    if (!$post_data) trigger_error('NO_FORUM');
+    
+    // Need to login to passworded forum first?
+    if ($post_data['forum_password'] && !check_forum_password($forum_id))
+        trigger_error('LOGIN_FORUM');
+    
+    // Check permissions
+    if ($user->data['is_bot']) trigger_error('NOT_AUTHORISED');
+    
+    // Is the user able to read and post within this forum?
+    if (!$auth->acl_get('f_read', $forum_id))
+    {
+        if ($user->data['user_id'] != ANONYMOUS)
+        {
+            trigger_error('USER_CANNOT_READ');
+        }
+        
+        trigger_error('LOGIN_EXPLAIN_POST');
+    }
+    
+    if (!$auth->acl_get('f_post', $forum_id))
+    {
+        if ($user->data['user_id'] != ANONYMOUS)
+        {
+            trigger_error('USER_CANNOT_POST');
+        }
+        
+        trigger_error('LOGIN_EXPLAIN_POST');
+    }
+    
+    // Is the user able to post within this forum?
+    if ($post_data['forum_type'] != FORUM_POST)
+    {
+        trigger_error('USER_CANNOT_FORUM_POST');
+    }
+    
+    // Forum/Topic locked?
+    if ($post_data['forum_status'] == ITEM_LOCKED && !$auth->acl_get('m_edit', $forum_id))
+    {
+        trigger_error('FORUM_LOCKED');
+    }
+    
+    $post_data['quote_username'] = '';
+    $post_data['post_edit_locked']    = 0;
+    $post_data['post_subject']        = '';
+    $post_data['topic_time_limit']    = 0;
+    $post_data['poll_length']        = 0;
+    $post_data['poll_start']        = 0;
+    $post_data['icon_id']            = 0;
+    $post_data['poll_options']        = array();
+    
+    include($phpbb_root_path . 'includes/message_parser.' . $phpEx);
+    $message_parser = new parse_message();
+    
+    // Set some default variables
+    $uninit = array('post_attachment' => 0, 
+                    'poster_id' => $user->data['user_id'], 
+                    'enable_magic_url' => 0, 
+                    'topic_status' => 0, 
+                    'topic_type' => POST_NORMAL, 
+                    'post_subject' => '', 
+                    'topic_title' => '', 
+                    'post_time' => 0, 
+                    'post_edit_reason' => '', 
+                    'notify_set' => 0);
+    
+    foreach ($uninit as $var_name => $default_value)
+    {
+        if (!isset($post_data[$var_name]))
+        {
+            $post_data[$var_name] = $default_value;
+        }
+    }
+    unset($uninit);
+    
+    if ($config['allow_topic_notify'] && $user->data['is_registered'])
+    {
+        $notify = $user->data['user_notify'] ? true : false;
+    }
+    else
+    {
+        $notify = false;
+    }
+    
+    // Always check if the submitted attachment data is valid and belongs to the user.
+    // Further down (especially in submit_post()) we do not check this again.
+    $message_parser->get_submitted_attachment_data($post_data['poster_id']);
+    
+    $post_data['username']          = '';
+    $post_data['enable_urls']       = $post_data['enable_magic_url'];
+    $post_data['enable_sig']        = ($config['allow_sig'] && $user->optionget('attachsig')) ? true: false;
+    $post_data['enable_smilies']    = ($config['allow_smilies'] && $user->optionget('smilies')) ? true : false;
+    $post_data['enable_bbcode']        = ($config['allow_bbcode'] && $user->optionget('bbcode')) ? true : false;
+    $post_data['enable_urls']        = true;
+    $post_data['enable_magic_url']  = $post_data['drafts'] = false;
+    
+    $check_value = (($post_data['enable_bbcode']+1) << 8) + (($post_data['enable_smilies']+1) << 4) + (($post_data['enable_urls']+1) << 2) + (($post_data['enable_sig']+1) << 1);
+    
+    // HTML, BBCode, Smilies, Images and Flash status
+    $bbcode_status    = ($config['allow_bbcode'] && $auth->acl_get('f_bbcode', $forum_id)) ? true : false;
+    $smilies_status    = ($bbcode_status && $config['allow_smilies'] && $auth->acl_get('f_smilies', $forum_id)) ? true : false;
+    $img_status        = ($bbcode_status && $auth->acl_get('f_img', $forum_id)) ? true : false;
+    $url_status        = ($config['allow_post_links']) ? true : false;
+    $flash_status    = ($bbcode_status && $auth->acl_get('f_flash', $forum_id) && $config['allow_post_flash']) ? true : false;
+    $quote_status    = ($auth->acl_get('f_reply', $forum_id)) ? true : false;
+
+    $post_data['topic_cur_post_id']    = request_var('topic_cur_post_id', 0);
+    $post_data['post_subject']        = utf8_normalize_nfc($subject);
+    $message_parser->message        = utf8_normalize_nfc(htmlspecialchars($text_body));
+
+    $post_data['username']            = utf8_normalize_nfc(request_var('username', $post_data['username'], true));
+    $post_data['post_edit_reason']    = '';
+
+    $post_data['orig_topic_type']    = $post_data['topic_type'];
+    $post_data['topic_type']        = request_var('topic_type', POST_NORMAL);
+    $post_data['topic_time_limit']    = request_var('topic_time_limit', 0);
+    $post_data['icon_id']            = request_var('icon', 0);
+
+    $post_data['enable_bbcode']        = (!$bbcode_status || isset($_POST['disable_bbcode'])) ? false : true;
+    $post_data['enable_smilies']    = (!$smilies_status || isset($_POST['disable_smilies'])) ? false : true;
+    $post_data['enable_urls']        = (isset($_POST['disable_magic_url'])) ? 0 : 1;
+    $post_data['enable_sig']        = (!$config['allow_sig'] || !$auth->acl_get('f_sigs', $forum_id) || !$auth->acl_get('u_sig')) ? false : ($user->data['is_registered'] ? true : false);
+
+    $topic_lock            = (isset($_POST['lock_topic'])) ? true : false;
+    $post_lock            = (isset($_POST['lock_post'])) ? true : false;
+    $poll_delete        = (isset($_POST['poll_delete'])) ? true : false;
+
+    $status_switch = (($post_data['enable_bbcode']+1) << 8) + (($post_data['enable_smilies']+1) << 4) + (($post_data['enable_urls']+1) << 2) + (($post_data['enable_sig']+1) << 1);
+    $status_switch = ($status_switch != $check_value);
+
+    $post_data['poll_title']        = utf8_normalize_nfc(request_var('poll_title', '', true));
+    $post_data['poll_length']        = request_var('poll_length', 0);
+    $post_data['poll_option_text']    = utf8_normalize_nfc(request_var('poll_option_text', '', true));
+    $post_data['poll_max_options']    = request_var('poll_max_options', 1);
+    $post_data['poll_vote_change']    = ($auth->acl_get('f_votechg', $forum_id) && isset($_POST['poll_vote_change'])) ? 1 : 0;
+
+    // Parse Attachments - before checksum is calculated
+    $message_parser->parse_attachments('fileupload', 'post', $forum_id, true, false, false);
+
+    // Grab md5 'checksum' of new message
+    $message_md5 = md5($message_parser->message);
+
+    if (sizeof($message_parser->warn_msg))
+    {
+        trigger_error(join("\n", $message_parser->warn_msg));
+    }
+
+    $message_parser->parse($post_data['enable_bbcode'], ($config['allow_post_links']) ? $post_data['enable_urls'] : false, $post_data['enable_smilies'], $img_status, $flash_status, $quote_status, $config['allow_post_links']);
+
+    if ($config['flood_interval'] && !$auth->acl_get('f_ignoreflood', $forum_id))
+    {
+        // Flood check
+        $last_post_time = 0;
+
+        if ($user->data['is_registered'])
+        {
+            $last_post_time = $user->data['user_lastpost_time'];
+        }
+        else
+        {
+            $sql = 'SELECT post_time AS last_post_time
+                FROM ' . POSTS_TABLE . "
+                WHERE poster_ip = '" . $user->ip . "'
+                    AND post_time > " . ($current_time - $config['flood_interval']);
+            $result = $db->sql_query_limit($sql, 1);
+            if ($row = $db->sql_fetchrow($result))
+            {
+                $last_post_time = $row['last_post_time'];
+            }
+            $db->sql_freeresult($result);
+        }
+
+        if ($last_post_time && ($current_time - $last_post_time) < intval($config['flood_interval']))
+        {
+            trigger_error('FLOOD_ERROR');
+        }
+    }
+
+    // Validate username
+    if (($post_data['username'] && !$user->data['is_registered']))
+    {
+        include($phpbb_root_path . 'includes/functions_user.' . $phpEx);
+
+        if (($result = validate_username($post_data['username'], (!empty($post_data['post_username'])) ? $post_data['post_username'] : '')) !== false)
+        {
+            $user->add_lang('ucp');
+            trigger_error($result . '_USERNAME');
+        }
+    }
+    
+    if (sizeof($message_parser->warn_msg))
+    {
+        trigger_error(join("\n", $message_parser->warn_msg));
+    }
+
+    // DNSBL check
+    if ($config['check_dnsbl'] && $mobiquo_config['check_dnsbl'])
+    {
+        if (($dnsbl = $user->check_dnsbl('post')) !== false)
+        {
+            trigger_error(sprintf($user->lang['IP_BLACKLISTED'], $user->ip, $dnsbl[1]));
+        }
+    }
+
+    // Store message, sync counters
+    $data = array(
+        'topic_title'           => (empty($post_data['topic_title'])) ? $post_data['post_subject'] : $post_data['topic_title'],
+        'topic_first_post_id'   => (isset($post_data['topic_first_post_id'])) ? (int) $post_data['topic_first_post_id'] : 0,
+        'topic_last_post_id'    => (isset($post_data['topic_last_post_id'])) ? (int) $post_data['topic_last_post_id'] : 0,
+        'topic_time_limit'      => (int) $post_data['topic_time_limit'],
+        'topic_attachment'      => (isset($post_data['topic_attachment'])) ? (int) $post_data['topic_attachment'] : 0,
+        'post_id'               => 0,
+        'topic_id'              => 0,
+        'forum_id'              => (int) $forum_id,
+        'icon_id'               => (int) $post_data['icon_id'],
+        'poster_id'             => (int) $post_data['poster_id'],
+        'enable_sig'            => (bool) $post_data['enable_sig'],
+        'enable_bbcode'         => (bool) $post_data['enable_bbcode'],
+        'enable_smilies'        => (bool) $post_data['enable_smilies'],
+        'enable_urls'           => (bool) $post_data['enable_urls'],
+        'enable_indexing'       => (bool) $post_data['enable_indexing'],
+        'message_md5'           => (string) $message_md5,
+        'post_time'             => (isset($post_data['post_time'])) ? (int) $post_data['post_time'] : $current_time,
+        'post_checksum'         => (isset($post_data['post_checksum'])) ? (string) $post_data['post_checksum'] : '',
+        'post_edit_reason'      => $post_data['post_edit_reason'],
+        'post_edit_user'        => (isset($post_data['post_edit_user'])) ? (int) $post_data['post_edit_user'] : 0,
+        'forum_parents'         => $post_data['forum_parents'],
+        'forum_name'            => $post_data['forum_name'],
+        'notify'                => $notify,
+        'notify_set'            => $post_data['notify_set'],
+        'poster_ip'             => (isset($post_data['poster_ip'])) ? $post_data['poster_ip'] : $user->ip,
+        'post_edit_locked'      => (int) $post_data['post_edit_locked'],
+        'bbcode_bitfield'       => $message_parser->bbcode_bitfield,
+        'bbcode_uid'            => $message_parser->bbcode_uid,
+        'message'               => $message_parser->message,
+        'attachment_data'       => $message_parser->attachment_data,
+        'filename_data'         => $message_parser->filename_data,
+        'topic_approved'        => (isset($post_data['topic_approved'])) ? $post_data['topic_approved'] : false,
+        'post_approved'         => (isset($post_data['post_approved'])) ? $post_data['post_approved'] : false,
+        
+        // for mod post expire compatibility
+        'post_expire_time'      => -1,
+    );
+
+    $poll = array();
+    include($phpbb_root_path . 'includes/functions_posting.' . $phpEx);
+
+    $update_message = true;
+    $cwd = getcwd();
+    chdir('../');
+    $phpbb_root_path_tmp = $phpbb_root_path;
+    $phpbb_root_path = './';
+    $redirect_url = submit_post('post', $post_data['post_subject'], $post_data['username'], $post_data['topic_type'], $poll, $data, $update_message);
+    chdir($cwd);
+    $phpbb_root_path = $phpbb_root_path_tmp;
+    
+    // Check the permissions for post approval, as well as the queue trigger where users are put on approval with a post count lower than specified. Moderators are not affected.
+    $approved = true;
+    if ((($config['enable_queue_trigger'] && $user->data['user_posts'] < $config['queue_trigger_posts']) || !$auth->acl_get('f_noapprove', $data['forum_id'])) && !$auth->acl_get('m_approve', $data['forum_id']))
+    {
+        $approved = false;
+    }
+    
+    $posted_success = false;
+    $topic_id = '';
+    if ($redirect_url)
+    {
+        preg_match('/&amp;t=(\d+)/', $redirect_url, $matches);
+        $topic_id = $matches[1];
+        $posted_success = true;
+    }
+    
+    $xmlrpc_create_topic = new xmlrpcval(array(
+        'result'    => new xmlrpcval($posted_success, 'boolean'),
+        'topic_id'  => new xmlrpcval($topic_id),
+        'state'     => new xmlrpcval($approved ? 0 : 1, 'int'),
+    ), 'struct');
+
+    return new xmlrpcresp($xmlrpc_create_topic);
+}
diff -ruN phpBB-3.0.10/mobiquo/function/remove_attachment.php phpbb/mobiquo/function/remove_attachment.php
--- phpBB-3.0.10/mobiquo/function/remove_attachment.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/function/remove_attachment.php	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,94 @@
+<?php
+/**
+*
+* @copyright (c) 2009, 2010, 2011 Quoord Systems Limited
+* @license http://opensource.org/licenses/gpl-2.0.php GNU Public License (GPLv2)
+*
+*/
+
+defined('IN_MOBIQUO') or exit;
+
+function remove_attachment_func($xmlrpc_params)
+{
+    global $db, $auth, $user, $config, $phpbb_root_path, $phpEx;
+    
+    $user->setup('posting');
+    if (!$user->data['is_registered']) trigger_error('LOGIN_EXPLAIN_POST');
+    
+    $params = php_xmlrpc_decode($xmlrpc_params);
+    
+    include($phpbb_root_path . 'includes/functions_posting.' . $phpEx);
+    include($phpbb_root_path . 'includes/message_parser.' . $phpEx);
+    
+    // get parameters
+    $attachment_id  = isset($params[0]) ? intval($params[0]) : trigger_error('Attachment not exists');
+    $forum_id       = isset($params[1]) ? intval($params[1]) : trigger_error('NO_FORUM');
+    $group_id       = isset($params[2]) ? $params[2] : '';
+    $post_id        = isset($params[3]) ? intval($params[3]) : '';
+    $_POST['attachment_data'] = $group_id ? unserialize(base64_decode($group_id)) : array();
+    
+    // Forum does not exist
+    if (!$forum_id) trigger_error('NO_FORUM');
+    
+    $sql = "SELECT f.* FROM " . FORUMS_TABLE . " f WHERE f.forum_id = $forum_id";
+    $result = $db->sql_query($sql);
+    $forum_data = $db->sql_fetchrow($result);
+    $db->sql_freeresult($result);   
+    
+    if (!$forum_data) trigger_error('NO_FORUM');
+    if ($forum_data['forum_password'] && !check_forum_password($forum_id))
+        trigger_error('LOGIN_FORUM');
+    
+    if (!$auth->acl_gets('f_read', $forum_id))
+    {
+        if ($user->data['user_id'] != ANONYMOUS)
+        {
+            trigger_error('USER_CANNOT_READ');
+        }
+        
+        trigger_error('LOGIN_EXPLAIN_POST');
+    }
+    
+    // Is the user able to post within this forum?
+    if ($forum_data['forum_type'] != FORUM_POST)
+    {
+        trigger_error('USER_CANNOT_FORUM_POST');
+    }
+    
+    // Check permissions
+    if (($user->data['is_bot'] || !$auth->acl_get('f_attach', $forum_id) || !$auth->acl_get('u_attach') || !$config['allow_attachments'] || @ini_get('file_uploads') == '0' || strtolower(@ini_get('file_uploads')) == 'off'))
+        trigger_error('NOT_AUTHORISED');
+    
+    if ((!$auth->acl_get('f_post', $forum_id) && !$auth->acl_gets('f_edit', 'm_edit', $forum_id) && !$auth->acl_get('f_reply', $forum_id)))
+        trigger_error('USER_CANNOT_POST');
+    
+    global $warn_msg;
+
+    $position = '';
+    foreach($_POST['attachment_data'] as $pos => $data) {
+        if ($data['attach_id'] == $attachment_id) {
+            $position = $pos;
+            break;
+        }
+    }
+    if ($position === '') {
+        $warn_msg = 'Attachment not exists';
+    } else {
+        $_POST['delete_file'][$position] = 'Delete file';
+        $_REQUEST['delete_file'][$position] = 'Delete file';
+        
+        $message_parser = new parse_message();
+        $message_parser->get_submitted_attachment_data();
+        $message_parser->parse_attachments('fileupload', 'post', $forum_id, false, false, true);
+        $group_id = base64_encode(serialize($message_parser->attachment_data));
+        $warn_msg = join("\n", $message_parser->warn_msg);
+    }
+    
+    $xmlrpc_result = new xmlrpcval(array(
+        'result'        => new xmlrpcval($warn_msg ? false : true, 'boolean'),
+        'result_text'   => new xmlrpcval(strip_tags($warn_msg), 'base64'),
+        'group_id'      => new xmlrpcval($group_id),
+    ), 'struct');
+    
+    return new xmlrpcresp($xmlrpc_result);
+}
diff -ruN phpBB-3.0.10/mobiquo/function/reply_post.php phpbb/mobiquo/function/reply_post.php
--- phpBB-3.0.10/mobiquo/function/reply_post.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/function/reply_post.php	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,466 @@
+<?php
+/**
+*
+* @copyright (c) 2009, 2010, 2011 Quoord Systems Limited
+* @license http://opensource.org/licenses/gpl-2.0.php GNU Public License (GPLv2)
+*
+*/
+
+defined('IN_MOBIQUO') or exit;
+
+function reply_post_func($xmlrpc_params)
+{
+    global $db, $auth, $user, $config, $phpbb_root_path, $phpEx, $mobiquo_config, $phpbb_home;
+    
+    $user->setup('posting');
+    if (!$user->data['is_registered']) trigger_error('LOGIN_EXPLAIN_POST');
+    
+    $params = php_xmlrpc_decode($xmlrpc_params);
+    
+    // get parameters
+    $forum_id   = isset($params[0]) ? intval($params[0]) : '';
+    $topic_id   = isset($params[1]) ? intval($params[1]) : '';
+    $subject    = isset($params[2]) ? $params[2] : '';
+    $text_body  = isset($params[3]) ? $params[3] : '';
+    
+    $attach_list = isset($params[4]) ? $params[4] : array();
+    $_POST['attachment_data'] = (isset($params[5]) && $params[5]) ? unserialize(base64_decode($params[5])) : array();
+    $GLOBALS['return_html'] = isset($params[6]) ? $params[6] : false;
+    
+    if (!$topic_id) trigger_error('NO_TOPIC');
+    if (utf8_clean_string($text_body) === '') trigger_error('TOO_FEW_CHARS');
+
+    $post_data = array();
+    $current_time = time();
+    
+    // get topic data
+    $sql = 'SELECT *
+            FROM ' . TOPICS_TABLE . '
+            WHERE topic_id = ' . $topic_id;
+    $result = $db->sql_query($sql);
+    $post_data = $db->sql_fetchrow($result);
+    $db->sql_freeresult($result);
+    
+    // get forum data
+    $sql = 'SELECT *
+            FROM ' . FORUMS_TABLE . "
+            WHERE forum_type = " . FORUM_POST . ($post_data['forum_id'] ? "
+            AND forum_id = '$post_data[forum_id]' " : '');
+    $result = $db->sql_query_limit($sql, 1);
+    $forum_data = $db->sql_fetchrow($result);
+    $db->sql_freeresult($result);
+    
+    $post_data = array_merge($post_data, $forum_data);
+    
+    if (!$post_data) trigger_error('NO_TOPIC');
+    
+    // Use post_row values in favor of submitted ones...
+    $forum_id    = (!empty($post_data['forum_id'])) ? (int) $post_data['forum_id'] : (int) $forum_id;
+    $topic_id    = (!empty($post_data['topic_id'])) ? (int) $post_data['topic_id'] : (int) $topic_id;
+
+    // Need to login to passworded forum first?
+    if ($post_data['forum_password'] && !check_forum_password($forum_id))
+        trigger_error('LOGIN_FORUM');
+
+    // Check permissions
+    if ($user->data['is_bot']) trigger_error('NOT_AUTHORISED');
+    
+    // Is the user able to read within this forum?
+    if (!$auth->acl_get('f_read', $forum_id))
+    {
+        if ($user->data['user_id'] != ANONYMOUS)
+        {
+            trigger_error('USER_CANNOT_READ');
+        }
+        
+        trigger_error('LOGIN_EXPLAIN_POST');
+    }
+
+    // Permission to do the reply
+    if (!$auth->acl_get('f_reply', $forum_id))
+    {    
+        if ($user->data['user_id'] != ANONYMOUS)
+        {
+            trigger_error('USER_CANNOT_REPLY');
+        }
+        
+        trigger_error('LOGIN_EXPLAIN_POST');
+    }
+
+    // Is the user able to post within this forum?
+    if ($post_data['forum_type'] != FORUM_POST)
+    {
+        trigger_error('USER_CANNOT_FORUM_POST');
+    }
+
+    // Forum/Topic locked?
+    if (($post_data['forum_status'] == ITEM_LOCKED || (isset($post_data['topic_status']) && $post_data['topic_status'] == ITEM_LOCKED)) && !$auth->acl_get('m_edit', $forum_id))
+    {
+        trigger_error(($post_data['forum_status'] == ITEM_LOCKED) ? 'FORUM_LOCKED' : 'TOPIC_LOCKED');
+    }
+    
+    $subject = ((strpos($subject, 'Re: ') !== 0) ? 'Re: ' : '') . ($subject ? $subject : censor_text($post_data['topic_title']));
+    
+    $post_data['post_edit_locked']  = (isset($post_data['post_edit_locked'])) ? (int) $post_data['post_edit_locked'] : 0;
+    $post_data['post_subject']      = (isset($post_data['topic_title'])) ? $post_data['topic_title'] : '';
+    $post_data['topic_time_limit']  = (isset($post_data['topic_time_limit'])) ? (($post_data['topic_time_limit']) ? (int) $post_data['topic_time_limit'] / 86400 : (int) $post_data['topic_time_limit']) : 0;
+    $post_data['poll_length']       = (!empty($post_data['poll_length'])) ? (int) $post_data['poll_length'] / 86400 : 0;
+    $post_data['poll_start']        = (!empty($post_data['poll_start'])) ? (int) $post_data['poll_start'] : 0;
+    $post_data['icon_id']           = 0;
+    $post_data['poll_options']      = array();
+    
+    // Get Poll Data
+    if ($post_data['poll_start'])
+    {
+        $sql = 'SELECT poll_option_text
+            FROM ' . POLL_OPTIONS_TABLE . "
+            WHERE topic_id = $topic_id
+            ORDER BY poll_option_id";
+        $result = $db->sql_query($sql);
+    
+        while ($row = $db->sql_fetchrow($result))
+        {
+            $post_data['poll_options'][] = trim($row['poll_option_text']);
+        }
+        $db->sql_freeresult($result);
+    }
+    
+    $orig_poll_options_size = sizeof($post_data['poll_options']);
+    
+    include($phpbb_root_path . 'includes/message_parser.' . $phpEx);
+    $message_parser = new parse_message();
+
+    // Set some default variables
+    $uninit = array('post_attachment' => 0, 'poster_id' => $user->data['user_id'], 'enable_magic_url' => 0, 'topic_status' => 0, 'topic_type' => POST_NORMAL, 'post_subject' => '', 'topic_title' => '', 'post_time' => 0, 'post_edit_reason' => '', 'notify_set' => 0);
+    
+    foreach ($uninit as $var_name => $default_value)
+    {
+        if (!isset($post_data[$var_name]))
+        {
+            $post_data[$var_name] = $default_value;
+        }
+    }
+    unset($uninit);
+    
+    // Always check if the submitted attachment data is valid and belongs to the user.
+    // Further down (especially in submit_post()) we do not check this again.
+    $message_parser->get_submitted_attachment_data($post_data['poster_id']);
+    
+    $post_data['username']       = '';
+    $post_data['enable_urls']    = $post_data['enable_magic_url'];
+    $post_data['enable_sig']     = ($config['allow_sig'] && $user->optionget('attachsig')) ? true: false;
+    $post_data['enable_smilies'] = ($config['allow_smilies'] && $user->optionget('smilies')) ? true : false;
+    $post_data['enable_bbcode']  = ($config['allow_bbcode'] && $user->optionget('bbcode')) ? true : false;
+    $post_data['enable_urls']    = true;
+    
+    $post_data['enable_magic_url'] = $post_data['drafts'] = false;
+    
+    $check_value = (($post_data['enable_bbcode']+1) << 8) + (($post_data['enable_smilies']+1) << 4) + (($post_data['enable_urls']+1) << 2) + (($post_data['enable_sig']+1) << 1);
+    
+    // Check if user is watching this topic
+    if ($config['allow_topic_notify'] && $user->data['is_registered'])
+    {
+        $sql = 'SELECT topic_id
+                FROM ' . TOPICS_WATCH_TABLE . '
+                WHERE topic_id = ' . $topic_id . '
+                AND user_id = ' . $user->data['user_id'];
+        $result = $db->sql_query($sql);
+        $post_data['notify_set'] = (int) $db->sql_fetchfield('topic_id');
+        $db->sql_freeresult($result);
+    }
+    
+    // HTML, BBCode, Smilies, Images and Flash status
+    $bbcode_status  = ($config['allow_bbcode'] && $auth->acl_get('f_bbcode', $forum_id)) ? true : false;
+    $smilies_status = ($bbcode_status && $config['allow_smilies'] && $auth->acl_get('f_smilies', $forum_id)) ? true : false;
+    $img_status     = ($bbcode_status && $auth->acl_get('f_img', $forum_id)) ? true : false;
+    $url_status     = ($config['allow_post_links']) ? true : false;
+    $flash_status   = ($bbcode_status && $auth->acl_get('f_flash', $forum_id) && $config['allow_post_flash']) ? true : false;
+    $quote_status   = ($auth->acl_get('f_reply', $forum_id)) ? true : false;
+    
+    $post_data['topic_cur_post_id'] = request_var('topic_cur_post_id', 0);
+    $post_data['post_subject']      = utf8_normalize_nfc($subject);
+    $message_parser->message        = utf8_normalize_nfc(htmlspecialchars($text_body));
+    $post_data['username']          = utf8_normalize_nfc(request_var('username', $post_data['username'], true));
+    $post_data['post_edit_reason']  = '';
+
+    $post_data['orig_topic_type']   = $post_data['topic_type'];
+    $post_data['topic_type']        = request_var('topic_type', (int) $post_data['topic_type']);
+    $post_data['topic_time_limit']  = request_var('topic_time_limit', (int) $post_data['topic_time_limit']);
+    $post_data['icon_id']           = request_var('icon', 0);
+
+    $post_data['enable_bbcode']     = (!$bbcode_status || isset($_POST['disable_bbcode'])) ? false : true;
+    $post_data['enable_smilies']    = (!$smilies_status || isset($_POST['disable_smilies'])) ? false : true;
+    $post_data['enable_urls']       = (isset($_POST['disable_magic_url'])) ? 0 : 1;
+    $post_data['enable_sig']        = (!$config['allow_sig'] || !$auth->acl_get('f_sigs', $forum_id) || !$auth->acl_get('u_sig')) ? false : ($user->data['is_registered'] ? true : false);
+
+    if ($config['allow_topic_notify'] && $user->data['is_registered'])
+    {
+        $notify = (!$post_data['notify_set'] ? $user->data['user_notify'] : $post_data['notify_set']) ? true : false;
+    }
+    else
+    {
+        $notify = false;
+    }
+
+    $post_data['poll_title']        = utf8_normalize_nfc(request_var('poll_title', '', true));
+    $post_data['poll_length']       = request_var('poll_length', 0);
+    $post_data['poll_option_text']  = utf8_normalize_nfc(request_var('poll_option_text', '', true));
+    $post_data['poll_max_options']  = request_var('poll_max_options', 1);
+    $post_data['poll_vote_change']  = ($auth->acl_get('f_votechg', $forum_id) && isset($_POST['poll_vote_change'])) ? 1 : 0;
+
+    // Parse Attachments - before checksum is calculated
+    $message_parser->parse_attachments('fileupload', 'reply', $forum_id, true, false, false);
+    
+    // Grab md5 'checksum' of new message
+    $message_md5 = md5($message_parser->message);
+
+    // Check checksum ... don't re-parse message if the same
+    if (sizeof($message_parser->warn_msg))
+    {
+        trigger_error(join("\n", $message_parser->warn_msg));
+    }
+
+    $message_parser->parse($post_data['enable_bbcode'], ($config['allow_post_links']) ? $post_data['enable_urls'] : false, $post_data['enable_smilies'], $img_status, $flash_status, $quote_status, $config['allow_post_links']);
+    
+    if ($config['flood_interval'] && !$auth->acl_get('f_ignoreflood', $forum_id))
+    {
+        // Flood check
+        $last_post_time = 0;
+
+        if ($user->data['is_registered'])
+        {
+            $last_post_time = $user->data['user_lastpost_time'];
+        }
+        else
+        {
+            $sql = 'SELECT post_time AS last_post_time
+                FROM ' . POSTS_TABLE . "
+                WHERE poster_ip = '" . $user->ip . "'
+                    AND post_time > " . ($current_time - $config['flood_interval']);
+            $result = $db->sql_query_limit($sql, 1);
+            if ($row = $db->sql_fetchrow($result))
+            {
+                $last_post_time = $row['last_post_time'];
+            }
+            $db->sql_freeresult($result);
+        }
+
+        if ($last_post_time && ($current_time - $last_post_time) < intval($config['flood_interval']))
+        {
+            trigger_error('FLOOD_ERROR');
+        }
+    }
+
+    // Validate username
+    if (($post_data['username'] && !$user->data['is_registered']))
+    {
+        include($phpbb_root_path . 'includes/functions_user.' . $phpEx);
+
+        if (($result = validate_username($post_data['username'], (!empty($post_data['post_username'])) ? $post_data['post_username'] : '')) !== false)
+        {
+            $user->add_lang('ucp');
+            trigger_error($result . '_USERNAME');
+        }
+    }
+
+    $post_data['poll_last_vote'] = (isset($post_data['poll_last_vote'])) ? $post_data['poll_last_vote'] : 0;
+
+    $poll = array();
+
+//    if (sizeof($message_parser->warn_msg))
+//    {
+//        return get_error();
+//    }
+
+    // DNSBL check
+    if ($config['check_dnsbl'] && $mobiquo_config['check_dnsbl'])
+    {
+        if (($dnsbl = $user->check_dnsbl('post')) !== false)
+        {
+            trigger_error(sprintf($user->lang['IP_BLACKLISTED'], $user->ip, $dnsbl[1]));
+        }
+    }
+
+    // Store message, sync counters
+    $data = array(
+        'topic_title'         => (empty($post_data['topic_title'])) ? $post_data['post_subject'] : $post_data['topic_title'],
+        'topic_first_post_id' => (isset($post_data['topic_first_post_id'])) ? (int) $post_data['topic_first_post_id'] : 0,
+        'topic_last_post_id'  => (isset($post_data['topic_last_post_id'])) ? (int) $post_data['topic_last_post_id'] : 0,
+        'topic_time_limit'    => (int) $post_data['topic_time_limit'],
+        'topic_attachment'    => (isset($post_data['topic_attachment'])) ? (int) $post_data['topic_attachment'] : 0,
+        'post_id'             => 0,
+        'topic_id'            => (int) $topic_id,
+        'forum_id'            => (int) $forum_id,
+        'icon_id'             => (int) $post_data['icon_id'],
+        'poster_id'           => (int) $post_data['poster_id'],
+        'enable_sig'          => (bool) $post_data['enable_sig'],
+        'enable_bbcode'       => (bool) $post_data['enable_bbcode'],
+        'enable_smilies'      => (bool) $post_data['enable_smilies'],
+        'enable_urls'         => (bool) $post_data['enable_urls'],
+        'enable_indexing'     => (bool) $post_data['enable_indexing'],
+        'message_md5'         => (string) $message_md5,
+        'post_time'           => (isset($post_data['post_time'])) ? (int) $post_data['post_time'] : $current_time,
+        'post_checksum'       => (isset($post_data['post_checksum'])) ? (string) $post_data['post_checksum'] : '',
+        'post_edit_reason'    => $post_data['post_edit_reason'],
+        'post_edit_user'      => (isset($post_data['post_edit_user']) ? (int) $post_data['post_edit_user'] : 0),
+        'forum_parents'       => $post_data['forum_parents'],
+        'forum_name'          => $post_data['forum_name'],
+        'notify'              => $notify,
+        'notify_set'          => $post_data['notify_set'],
+        'poster_ip'           => (isset($post_data['poster_ip'])) ? $post_data['poster_ip'] : $user->ip,
+        'post_edit_locked'    => (int) $post_data['post_edit_locked'],
+        'bbcode_bitfield'     => $message_parser->bbcode_bitfield,
+        'bbcode_uid'          => $message_parser->bbcode_uid,
+        'message'             => $message_parser->message,
+        'attachment_data'     => $message_parser->attachment_data,
+        'filename_data'       => $message_parser->filename_data,
+
+        'topic_approved'      => (isset($post_data['topic_approved'])) ? $post_data['topic_approved'] : false,
+        'post_approved'       => (isset($post_data['post_approved'])) ? $post_data['post_approved'] : false,
+        
+        // for mod post expire compatibility
+        'post_expire_time'      => -1,
+    );
+    
+    include($phpbb_root_path . 'includes/functions_posting.' . $phpEx);
+
+    $update_message = true;
+    
+    $cwd = getcwd();
+    chdir('../');
+    $phpbb_root_path_tmp = $phpbb_root_path;
+    $phpbb_root_path = './';
+    $redirect_url = submit_post('reply', $post_data['post_subject'], $post_data['username'], $post_data['topic_type'], $poll, $data, $update_message);
+    chdir($cwd);
+    $phpbb_root_path = $phpbb_root_path_tmp;
+    
+    // Check the permissions for post approval, as well as the queue trigger where users are put on approval with a post count lower than specified. Moderators are not affected.
+    $approved = true;
+    if ((($config['enable_queue_trigger'] && $user->data['user_posts'] < $config['queue_trigger_posts']) || !$auth->acl_get('f_noapprove', $data['forum_id'])) && !$auth->acl_get('m_approve', $data['forum_id']))
+    {
+        $approved = false;
+    }
+
+    $reply_success = false;
+    $post_id = '';
+    if ($redirect_url)
+    {
+        preg_match('/&amp;p=(\d+)/', $redirect_url, $matches);
+        $post_id = $matches[1];
+        $reply_success = true;
+        
+        // get new post_content
+        $message = censor_text($data['message']);
+        $quote_wrote_string = $user->lang['WROTE'];
+        $message = str_replace('[/quote:'.$data['bbcode_uid'].']', '[/quote]', $message);
+        $message = preg_replace('/\[quote(?:=&quot;(.*?)&quot;)?:'.$data['bbcode_uid'].'\]/ise', "'[quote]' . ('$1' ? '$1' . ' $quote_wrote_string:\n' : '\n')", $message);
+        $blocks = preg_split('/(\[\/?quote\])/i', $message, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE);
+        $quote_level = 0;
+        $message = '';
+            
+        foreach($blocks as $block)
+        {
+            if ($block == '[quote]') {
+                if ($quote_level == 0) $message .= $block;
+                $quote_level++;
+            } else if ($block == '[/quote]') {
+                if ($quote_level <= 1) $message .= $block;
+                if ($quote_level >= 1) $quote_level--;            
+            } else {
+                if ($quote_level <= 1) $message .= $block;
+            }
+        }
+        
+        $message = preg_replace('/\[(youtube|video|googlevideo|gvideo):'.$data['bbcode_uid'].'\](.*?)\[\/\1:'.$data['bbcode_uid'].'\]/sie', "video_bbcode_format('$1', '$2')", $message);
+        $message = preg_replace('/\[(BBvideo)[\d, ]+:'.$row['bbcode_uid'].'\](.*?)\[\/\1:'.$row['bbcode_uid'].'\]/si', "[url=$2]YouTube Video[/url]", $message);
+        $message = preg_replace('/\[(spoil|spoiler):'.$row['bbcode_uid'].'\](.*?)\[\/\1:'.$row['bbcode_uid'].'\]/si', "[spoiler]$2[/spoiler]", $message);
+        $message = preg_replace('/\[b:'.$data['bbcode_uid'].'\](.*?)\[\/b:'.$data['bbcode_uid'].'\]/si', '[b]$1[/b]', $message);
+        $message = preg_replace('/\[i:'.$data['bbcode_uid'].'\](.*?)\[\/i:'.$data['bbcode_uid'].'\]/si', '[i]$1[/i]', $message);
+        $message = preg_replace('/\[u:'.$data['bbcode_uid'].'\](.*?)\[\/u:'.$data['bbcode_uid'].'\]/si', '[u]$1[/u]', $message);
+        $message = preg_replace('/\[color=#(\w{6}):'.$data['bbcode_uid'].'\](.*?)\[\/color:'.$data['bbcode_uid'].'\]/si', '[color=#$1]$2[/color]', $message);
+        
+        // Second parse bbcode here
+        if ($data['bbcode_bitfield'])
+        {
+            $bbcode = new bbcode(base64_encode($data['bbcode_bitfield']));
+            $bbcode->bbcode_second_pass($message, $data['bbcode_uid'], $data['bbcode_bitfield']);
+        }
+        
+        $message = bbcode_nl2br($message);
+        $message = smiley_text($message);
+        
+        if (!empty($data['attachment_data']))
+        {
+            parse_attachments($forum_id, $message, $data['attachment_data'], $update_count);
+        }
+        
+        $updated_post_title = html_entity_decode(strip_tags(censor_text($data['topic_title'])), ENT_QUOTES, 'UTF-8');
+        
+        $edit_allowed = ($auth->acl_get('m_edit', $forum_id) || (
+            $auth->acl_get('f_edit', $forum_id) &&
+            !$data['post_edit_locked'] &&
+            ($data['post_time'] > time() - ($config['edit_time'] * 60) || !$config['edit_time'])
+        ));
+        
+        $delete_allowed = ($auth->acl_get('m_delete', $forum_id) || (
+            $auth->acl_get('f_delete', $forum_id) &&
+            ($data['post_time'] > time() - ($config['delete_time'] * 60) || !$config['delete_time']) &&
+            // we do not want to allow removal of the last post if a moderator locked it!
+            !$data['post_edit_locked']
+        ));
+        
+        $attachments = array();  
+        if (sizeof($attach_list) && sizeof($data['attachment_data']))
+        {
+            $sql = 'SELECT *
+                FROM ' . ATTACHMENTS_TABLE . '
+                WHERE ' . $db->sql_in_set('attach_id', $attach_list) . '
+                    AND in_message = 0
+                ORDER BY filetime DESC';
+            $result = $db->sql_query($sql);
+            
+            while ($row = $db->sql_fetchrow($result))
+            {
+                $attachment_by_id[$row['attach_id']] = $row;
+            }
+            $db->sql_freeresult($result);
+            
+            foreach($data['attachment_data'] as $attachment)
+            {               
+                if(preg_match('/<img src=\".*?(\/download\/file.php\?id=(\d+).*?)\"/is', $attachment, $matches))
+                {
+                    $file_url = html_entity_decode($phpbb_home.$matches[1]);
+                    $attach_id = $matches[2];
+                    unset($matches);
+                
+                    $xmlrpc_attachment = new xmlrpcval(array(
+                        'filename'      => new xmlrpcval($attachment_by_id[$attach_id]['real_filename'], 'base64'),
+                        'filesize'      => new xmlrpcval($attachment_by_id[$attach_id]['filesize'], 'int'),
+                        'content_type'  => new xmlrpcval('image'),
+                        'thumbnail_url' => new xmlrpcval(''),
+                        'url'           => new xmlrpcval($file_url)
+                    ), 'struct');
+                    $attachments[] = $xmlrpc_attachment;
+                }
+            }
+        }
+    }
+    
+    $xmlrpc_reply_topic = new xmlrpcval(array(
+        'result'    => new xmlrpcval($reply_success, 'boolean'),
+        'post_id'   => new xmlrpcval($post_id, 'string'),
+        'state'     => new xmlrpcval($approved ? 0 : 1, 'int'),
+        'post_title'        => new xmlrpcval($updated_post_title, 'base64'),
+        'post_content'      => new xmlrpcval(post_html_clean($message), 'base64'),
+        'post_author_name'  => new xmlrpcval(html_entity_decode($user->data['username']), 'base64'),
+        'is_online'         => new xmlrpcval(true, 'boolean'),
+        'can_edit'          => new xmlrpcval($edit_allowed, 'boolean'),
+        'icon_url'          => new xmlrpcval(($user->optionget('viewavatars')) ? get_user_avatar_url($user->data['user_avatar'], $user->data['user_avatar_type']) : ''),
+        'post_time'         => new xmlrpcval(mobiquo_iso8601_encode($current_time), 'dateTime.iso8601'),
+        'can_delete'        => new xmlrpcval($delete_allowed, 'boolean'),
+        'allow_smilies'     => new xmlrpcval($data['enable_smilies'] ? true : false, 'boolean'),
+        'attachments'       => new xmlrpcval($attachments, 'array'),
+    ), 'struct');
+
+    return new xmlrpcresp($xmlrpc_reply_topic);
+}
diff -ruN phpBB-3.0.10/mobiquo/function/report_pm.php phpbb/mobiquo/function/report_pm.php
--- phpBB-3.0.10/mobiquo/function/report_pm.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/function/report_pm.php	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,102 @@
+<?php
+/**
+*
+* @copyright (c) 2009, 2010, 2011 Quoord Systems Limited
+* @license http://opensource.org/licenses/gpl-2.0.php GNU Public License (GPLv2)
+*
+*/
+
+defined('IN_MOBIQUO') or exit;
+
+function report_pm_func($xmlrpc_params)
+{
+    global $db, $user, $config;
+    
+    $user->setup('mcp');
+    
+    $params = php_xmlrpc_decode($xmlrpc_params);
+    
+    $post_id = 0;
+    $pm_id = intval($params[0]);
+    $report_text = utf8_normalize_nfc($params[1]);
+    $reason_id   = intval($params[2]) ? intval($params[2]) : 2;
+    $forum_id    = intval($params[3]) ? intval($params[3]) : '';
+    $user_notify =  true;
+    
+    if (!$pm_id || !$config['allow_pm_report'])
+    {
+        trigger_error('NO_POST_SELECTED');
+    }
+    
+    // Grab all relevant data
+    $sql = 'SELECT p.*, pt.*
+        FROM ' . PRIVMSGS_TABLE . ' p, ' . PRIVMSGS_TO_TABLE . " pt
+        WHERE p.msg_id = $pm_id
+            AND p.msg_id = pt.msg_id
+            AND (p.author_id = " . $user->data['user_id'] . " OR pt.user_id = " . $user->data['user_id'] . ")";
+    $result = $db->sql_query($sql);
+    $report_data = $db->sql_fetchrow($result);
+    $db->sql_freeresult($result);
+
+    if (!$report_data)
+    {
+        $user->add_lang('ucp');
+        trigger_error('NO_MESSAGE');
+    }
+
+    if ($report_data['message_reported'])
+    {
+        trigger_error('ALREADY_REPORTED_PM');
+    }
+    
+    $sql = 'SELECT *
+        FROM ' . REPORTS_REASONS_TABLE . "
+        WHERE reason_id = $reason_id";
+    $result = $db->sql_query($sql);
+    $row = $db->sql_fetchrow($result);
+    $db->sql_freeresult($result);
+
+    if (!$row || (!$report_text && strtolower($row['reason_title']) == 'other'))
+    {
+        trigger_error('EMPTY_REPORT');
+    }
+
+    $sql_ary = array(
+        'reason_id' => (int) $reason_id,
+        'post_id'   => $post_id,
+        'pm_id'     => $pm_id,
+        'user_id'   => (int) $user->data['user_id'],
+        'user_notify'   => (int) $user_notify,
+        'report_closed' => 0,
+        'report_time'   => (int) time(),
+        'report_text'   => (string) $report_text
+    );
+
+    $sql = 'INSERT INTO ' . REPORTS_TABLE . ' ' . $db->sql_build_array('INSERT', $sql_ary);
+    $db->sql_query($sql);
+    $report_id = $db->sql_nextid();
+
+    $sql = 'UPDATE ' . PRIVMSGS_TABLE . '
+        SET message_reported = 1
+        WHERE msg_id = ' . $pm_id;
+    $db->sql_query($sql);
+
+    $sql_ary = array(
+        'msg_id'        => $pm_id,
+        'user_id'        => ANONYMOUS,
+        'author_id'        => (int) $report_data['author_id'],
+        'pm_deleted'    => 0,
+        'pm_new'        => 0,
+        'pm_unread'        => 0,
+        'pm_replied'    => 0,
+        'pm_marked'        => 0,
+        'pm_forwarded'    => 0,
+        'folder_id'        => PRIVMSGS_INBOX,
+    );
+
+    $sql = 'INSERT INTO ' . PRIVMSGS_TO_TABLE . ' ' . $db->sql_build_array('INSERT', $sql_ary);
+    $db->sql_query($sql);
+
+    $result = new xmlrpcval(array('result' => new xmlrpcval(true, 'boolean')), 'struct');
+    return new xmlrpcresp($result);
+}
diff -ruN phpBB-3.0.10/mobiquo/function/report_post.php phpbb/mobiquo/function/report_post.php
--- phpBB-3.0.10/mobiquo/function/report_post.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/function/report_post.php	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,122 @@
+<?php
+/**
+*
+* @copyright (c) 2009, 2010, 2011 Quoord Systems Limited
+* @license http://opensource.org/licenses/gpl-2.0.php GNU Public License (GPLv2)
+*
+*/
+
+defined('IN_MOBIQUO') or exit;
+
+function report_post_func($xmlrpc_params)
+{
+    global $db, $auth, $user, $config;
+    
+    $user->setup('mcp');
+    
+    $params = php_xmlrpc_decode($xmlrpc_params);
+    
+    $pm_id = 0;
+    $post_id = intval($params[0]);
+    $report_text = utf8_normalize_nfc($params[1]);
+    $reason_id   = intval($params[2]) ? intval($params[2]) : 2;
+    $forum_id    = intval($params[3]) ? intval($params[3]) : '';
+    $user_notify =  true;
+    
+    if (!$post_id)
+    {
+        trigger_error('NO_POST_SELECTED');
+    }
+    
+    // Grab all relevant data
+    $sql = 'SELECT t.*, p.*
+        FROM ' . POSTS_TABLE . ' p, ' . TOPICS_TABLE . " t
+        WHERE p.post_id = $post_id
+            AND p.topic_id = t.topic_id";
+    $result = $db->sql_query($sql);
+    $report_data = $db->sql_fetchrow($result);
+    $db->sql_freeresult($result);
+
+    if (!$report_data)
+    {
+        trigger_error('POST_NOT_EXIST');
+    }
+
+    $forum_id = (int) ($report_data['forum_id']) ? $report_data['forum_id'] : $forum_id;
+    $topic_id = (int) $report_data['topic_id'];
+
+    $sql = 'SELECT *
+        FROM ' . FORUMS_TABLE . '
+        WHERE forum_id = ' . $forum_id;
+    $result = $db->sql_query($sql);
+    $forum_data = $db->sql_fetchrow($result);
+    $db->sql_freeresult($result);
+
+    if (!$forum_data)
+    {
+        trigger_error('FORUM_NOT_EXIST');
+    }
+
+    // Check required permissions
+    $acl_check_ary = array('f_list' => 'POST_NOT_EXIST', 'f_read' => 'USER_CANNOT_READ', 'f_report' => 'USER_CANNOT_REPORT');
+
+    foreach ($acl_check_ary as $acl => $error)
+    {
+        if (!$auth->acl_get($acl, $forum_id))
+        {
+            trigger_error($error);
+        }
+    }
+    unset($acl_check_ary);
+
+    if ($report_data['post_reported'])
+    {
+        trigger_error('ALREADY_REPORTED');
+    }
+    
+    $sql = 'SELECT *
+        FROM ' . REPORTS_REASONS_TABLE . "
+        WHERE reason_id = $reason_id";
+    $result = $db->sql_query($sql);
+    $row = $db->sql_fetchrow($result);
+    $db->sql_freeresult($result);
+
+    if (!$row || (!$report_text && strtolower($row['reason_title']) == 'other'))
+    {
+        trigger_error('EMPTY_REPORT');
+    }
+
+    $sql_ary = array(
+        'reason_id'     => (int) $reason_id,
+        'post_id'       => $post_id,
+        'user_id'       => (int) $user->data['user_id'],
+        'user_notify'   => (int) $user_notify,
+        'report_closed' => 0,
+        'report_time'   => (int) time(),
+        'report_text'   => (string) $report_text
+    );
+    
+    if (version_compare($config['version'], '3.0.6', '>='))
+        $sql_ary['pm_id'] = $pm_id;
+
+    $sql = 'INSERT INTO ' . REPORTS_TABLE . ' ' . $db->sql_build_array('INSERT', $sql_ary);
+    $db->sql_query($sql);
+    $report_id = $db->sql_nextid();
+
+    $sql = 'UPDATE ' . POSTS_TABLE . '
+        SET post_reported = 1
+        WHERE post_id = ' . $post_id;
+    $db->sql_query($sql);
+
+    if (!$report_data['topic_reported'])
+    {
+        $sql = 'UPDATE ' . TOPICS_TABLE . '
+            SET topic_reported = 1
+            WHERE topic_id = ' . $report_data['topic_id'] . '
+                OR topic_moved_id = ' . $report_data['topic_id'];
+        $db->sql_query($sql);
+    }
+
+    $result = new xmlrpcval(array('result' => new xmlrpcval(true, 'boolean')), 'struct');
+    return new xmlrpcresp($result);
+}
diff -ruN phpBB-3.0.10/mobiquo/function/save_raw_post.php phpbb/mobiquo/function/save_raw_post.php
--- phpBB-3.0.10/mobiquo/function/save_raw_post.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/function/save_raw_post.php	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,568 @@
+<?php
+/**
+*
+* @copyright (c) 2009, 2010, 2011 Quoord Systems Limited
+* @license http://opensource.org/licenses/gpl-2.0.php GNU Public License (GPLv2)
+*
+*/
+
+defined('IN_MOBIQUO') or exit;
+
+function save_raw_post_func($xmlrpc_params)
+{
+    global $db, $auth, $user, $config, $template, $cache, $phpEx, $phpbb_root_path, $phpbb_home;
+    
+    $user->setup('posting');
+    
+    include($phpbb_root_path . 'includes/message_parser.' . $phpEx);
+
+    $params = php_xmlrpc_decode($xmlrpc_params);
+
+    $submit     = true;
+    $preview    = false;
+    $refresh    = false;
+    $mode       = 'edit';
+
+    // get post information from parameters
+    $post_id        = intval($params[0]);
+    $post_title     = $params[1];
+    $post_content   = $params[2];
+    $GLOBALS['return_html'] = isset($params[3]) ? $params[3] : false;
+
+    $post_data = array();
+
+    $sql = 'SELECT p.*, t.*, f.*, u.username
+            FROM ' . POSTS_TABLE . ' p
+                LEFT JOIN ' . TOPICS_TABLE . ' t ON (p.topic_id = t.topic_id) 
+                LEFT JOIN ' . FORUMS_TABLE . ' f ON (t.forum_id = f.forum_id OR (t.topic_type = ' . POST_GLOBAL . ' AND f.forum_type = ' . FORUM_POST . '))
+                LEFT JOIN ' . USERS_TABLE  . ' u ON (p.poster_id = u.user_id)' . "
+            WHERE p.post_id = $post_id";
+
+    $result = $db->sql_query_limit($sql, 1);
+    $post_data = $db->sql_fetchrow($result);
+    $db->sql_freeresult($result);
+
+    if (!$post_data) trigger_error('NO_POST');
+    
+    // Use post_row values in favor of submitted ones...
+    $forum_id = (int) $post_data['forum_id'];
+    $topic_id = (int) $post_data['topic_id'];
+    $post_id  = (int) $post_id;
+
+    // Need to login to passworded forum first?
+    if ($post_data['forum_password'] && !check_forum_password($forum_id))
+    {
+        trigger_error('LOGIN_FORUM');
+    }
+
+    // Is the user able to read within this forum?
+    if (!$auth->acl_get('f_read', $forum_id))
+    {
+        trigger_error('USER_CANNOT_READ');
+    }
+
+    // Permission to do the action asked?
+    if (!($user->data['is_registered'] && $auth->acl_gets('f_edit', 'm_edit', $forum_id)))
+    {
+        trigger_error('USER_CANNOT_EDIT');
+    }
+
+    // Forum/Topic locked?
+    if (($post_data['forum_status'] == ITEM_LOCKED || (isset($post_data['topic_status']) && $post_data['topic_status'] == ITEM_LOCKED)) && !$auth->acl_get('m_edit', $forum_id))
+    {
+        trigger_error(($post_data['forum_status'] == ITEM_LOCKED) ? 'FORUM_LOCKED' : 'TOPIC_LOCKED');
+    }
+
+    // Can we edit this post ... if we're a moderator with rights then always yes
+    // else it depends on editing times, lock status and if we're the correct user
+    if (!$auth->acl_get('m_edit', $forum_id))
+    {
+        if ($user->data['user_id'] != $post_data['poster_id'])
+        {
+            trigger_error('USER_CANNOT_EDIT');
+        }
+
+        if (!($post_data['post_time'] > time() - ($config['edit_time'] * 60) || !$config['edit_time']))
+        {
+            trigger_error('CANNOT_EDIT_TIME');
+        }
+
+        if ($post_data['post_edit_locked'])
+        {
+            trigger_error('CANNOT_EDIT_POST_LOCKED');
+        }
+    }
+
+    // Determine some vars
+    if (isset($post_data['poster_id']) && $post_data['poster_id'] == ANONYMOUS)
+    {
+        $post_data['quote_username'] = (!empty($post_data['post_username'])) ? $post_data['post_username'] : $user->lang['GUEST'];
+    }
+    else
+    {
+        $post_data['quote_username'] = isset($post_data['username']) ? $post_data['username'] : '';
+    }
+
+    $post_data['post_edit_locked']    = (isset($post_data['post_edit_locked'])) ? (int) $post_data['post_edit_locked'] : 0;
+    $post_data['post_subject']        = (in_array($mode, array('quote', 'edit'))) ? $post_data['post_subject'] : ((isset($post_data['topic_title'])) ? $post_data['topic_title'] : '');
+    $post_data['topic_time_limit']    = (isset($post_data['topic_time_limit'])) ? (($post_data['topic_time_limit']) ? (int) $post_data['topic_time_limit'] / 86400 : (int) $post_data['topic_time_limit']) : 0;
+    $post_data['poll_length']        = (!empty($post_data['poll_length'])) ? (int) $post_data['poll_length'] / 86400 : 0;
+    $post_data['poll_start']        = (!empty($post_data['poll_start'])) ? (int) $post_data['poll_start'] : 0;
+    $post_data['icon_id']            = (!isset($post_data['icon_id']) || in_array($mode, array('quote', 'reply'))) ? 0 : (int) $post_data['icon_id'];
+    $post_data['poll_options']        = array();
+
+    // Get Poll Data
+    if ($post_data['poll_start'])
+    {
+        $sql = 'SELECT poll_option_text
+            FROM ' . POLL_OPTIONS_TABLE . "
+            WHERE topic_id = $topic_id
+            ORDER BY poll_option_id";
+        $result = $db->sql_query($sql);
+
+        while ($row = $db->sql_fetchrow($result))
+        {
+            $post_data['poll_options'][] = trim($row['poll_option_text']);
+        }
+        $db->sql_freeresult($result);
+    }
+
+    $orig_poll_options_size = sizeof($post_data['poll_options']);
+
+    $message_parser = new parse_message();
+
+    if (isset($post_data['post_text']))
+    {
+        $message_parser->message = &$post_data['post_text'];
+        unset($post_data['post_text']);
+    }
+
+    // Set some default variables
+    $uninit = array('post_attachment' => 0, 'poster_id' => $user->data['user_id'], 'enable_magic_url' => 0, 'topic_status' => 0, 'topic_type' => POST_NORMAL, 'post_subject' => '', 'topic_title' => '', 'post_time' => 0, 'post_edit_reason' => '', 'notify_set' => 0);
+
+    foreach ($uninit as $var_name => $default_value)
+    {
+        if (!isset($post_data[$var_name]))
+        {
+            $post_data[$var_name] = $default_value;
+        }
+    }
+    unset($uninit);
+
+    // Always check if the submitted attachment data is valid and belongs to the user.
+    // Further down (especially in submit_post()) we do not check this again.
+    $message_parser->get_submitted_attachment_data($post_data['poster_id']);
+
+    if ($post_data['post_attachment'] && !$refresh && !$preview && $mode == 'edit')
+    {
+        // Do not change to SELECT *
+        $sql = 'SELECT attach_id, is_orphan, attach_comment, real_filename
+            FROM ' . ATTACHMENTS_TABLE . "
+            WHERE post_msg_id = $post_id
+                AND in_message = 0
+                AND is_orphan = 0
+            ORDER BY filetime DESC";
+        $result = $db->sql_query($sql);
+        $message_parser->attachment_data = array_merge($message_parser->attachment_data, $db->sql_fetchrowset($result));
+        $db->sql_freeresult($result);
+    }
+
+    if ($post_data['poster_id'] == ANONYMOUS)
+    {
+        $post_data['username'] = ($mode == 'quote' || $mode == 'edit') ? trim($post_data['post_username']) : '';
+    }
+    else
+    {
+        $post_data['username'] = ($mode == 'quote' || $mode == 'edit') ? trim($post_data['username']) : '';
+    }
+
+    $post_data['enable_urls'] = $post_data['enable_magic_url'];
+
+    $post_data['enable_magic_url'] = $post_data['drafts'] = false;
+
+    $check_value = (($post_data['enable_bbcode']+1) << 8) + (($post_data['enable_smilies']+1) << 4) + (($post_data['enable_urls']+1) << 2) + (($post_data['enable_sig']+1) << 1);
+
+    // Check if user is watching this topic
+    if ($mode != 'post' && $config['allow_topic_notify'] && $user->data['is_registered'])
+    {
+        $sql = 'SELECT topic_id
+            FROM ' . TOPICS_WATCH_TABLE . '
+            WHERE topic_id = ' . $topic_id . '
+                AND user_id = ' . $user->data['user_id'];
+        $result = $db->sql_query($sql);
+        $post_data['notify_set'] = (int) $db->sql_fetchfield('topic_id');
+        $db->sql_freeresult($result);
+    }
+
+    // Do we want to edit our post ?
+    if ($post_data['bbcode_uid'])
+    {
+        $message_parser->bbcode_uid = $post_data['bbcode_uid'];
+    }
+
+    // HTML, BBCode, Smilies, Images and Flash status
+    $bbcode_status    = ($config['allow_bbcode'] && $auth->acl_get('f_bbcode', $forum_id)) ? true : false;
+    $smilies_status    = ($bbcode_status && $config['allow_smilies'] && $auth->acl_get('f_smilies', $forum_id)) ? true : false;
+    $img_status        = ($bbcode_status && $auth->acl_get('f_img', $forum_id)) ? true : false;
+    $url_status        = ($config['allow_post_links']) ? true : false;
+    $flash_status    = ($bbcode_status && $auth->acl_get('f_flash', $forum_id) && $config['allow_post_flash']) ? true : false;
+    $quote_status    = ($auth->acl_get('f_reply', $forum_id)) ? true : false;
+
+    $solved_captcha = false;
+
+    $post_data['topic_cur_post_id']    = request_var('topic_cur_post_id', 0);
+    $post_data['post_subject']        = utf8_normalize_nfc($post_title);
+    $message_parser->message        = utf8_normalize_nfc(htmlspecialchars($post_content));
+
+    $post_data['username']            = utf8_normalize_nfc(request_var('username', $post_data['username'], true));
+    $post_data['post_edit_reason']    = (!empty($_POST['edit_reason']) && $mode == 'edit' && $auth->acl_get('m_edit', $forum_id)) ? utf8_normalize_nfc(request_var('edit_reason', '', true)) : '';
+
+    $post_data['orig_topic_type']    = $post_data['topic_type'];
+    $post_data['topic_type']        = request_var('topic_type', (($mode != 'post') ? (int) $post_data['topic_type'] : POST_NORMAL));
+    $post_data['topic_time_limit']    = request_var('topic_time_limit', (($mode != 'post') ? (int) $post_data['topic_time_limit'] : 0));
+    $post_data['icon_id']            = request_var('icon', 0);
+
+    $post_data['enable_bbcode']        = (!$bbcode_status || isset($_POST['disable_bbcode'])) ? false : true;
+    $post_data['enable_smilies']    = (!$smilies_status || isset($_POST['disable_smilies'])) ? false : true;
+    $post_data['enable_urls']        = (isset($_POST['disable_magic_url'])) ? 0 : 1;
+    $post_data['enable_sig']        = (!$config['allow_sig'] || !$auth->acl_get('f_sigs', $forum_id) || !$auth->acl_get('u_sig')) ? false : ($user->data['is_registered'] ? true : false);
+
+    if ($config['allow_topic_notify'] && $user->data['is_registered'])
+    {
+        $notify = (isset($_POST['notify'])) ? true : false;
+    }
+    else
+    {
+        $notify = false;
+    }
+
+    $topic_lock     = (isset($_POST['lock_topic'])) ? true : false;
+    $post_lock      = (isset($_POST['lock_post'])) ? true : false;
+    $poll_delete    = (isset($_POST['poll_delete'])) ? true : false;
+
+    $status_switch = (($post_data['enable_bbcode']+1) << 8) + (($post_data['enable_smilies']+1) << 4) + (($post_data['enable_urls']+1) << 2) + (($post_data['enable_sig']+1) << 1);
+    $status_switch = ($status_switch != $check_value);
+
+    //$post_data['poll_title']        = utf8_normalize_nfc(request_var('poll_title', '', true));
+    //$post_data['poll_length']        = request_var('poll_length', 0);
+    //$post_data['poll_option_text']    = utf8_normalize_nfc(request_var('poll_option_text', '', true));
+    $post_data['poll_option_text'] = implode("\n", $post_data['poll_options']);
+    //$post_data['poll_max_options']    = request_var('poll_max_options', 1);
+    //$post_data['poll_vote_change']    = ($auth->acl_get('f_votechg', $forum_id) && isset($_POST['poll_vote_change'])) ? 1 : 0;
+
+    // Parse Attachments - before checksum is calculated
+    $message_parser->parse_attachments('fileupload', $mode, $forum_id, $submit, $preview, $refresh);
+
+    // Grab md5 'checksum' of new message
+    $message_md5 = md5($message_parser->message);
+
+    // Check checksum ... don't re-parse message if the same
+    $update_message = ($mode != 'edit' || $message_md5 != $post_data['post_checksum'] || $status_switch || strlen($post_data['bbcode_uid']) < BBCODE_UID_LEN) ? true : false;
+
+    // Parse message
+    if ($update_message)
+    {
+        if (sizeof($message_parser->warn_msg))
+        {
+            trigger_error(join("\n", $message_parser->warn_msg));
+        }
+
+        $message_parser->parse($post_data['enable_bbcode'], ($config['allow_post_links']) ? $post_data['enable_urls'] : false, $post_data['enable_smilies'], $img_status, $flash_status, $quote_status, $config['allow_post_links']);
+    }
+    else
+    {
+        $message_parser->bbcode_bitfield = $post_data['bbcode_bitfield'];
+    }
+
+    // Validate username
+    if (($post_data['username'] && !$user->data['is_registered']) || ($mode == 'edit' && $post_data['poster_id'] == ANONYMOUS && $post_data['username'] && $post_data['post_username'] && $post_data['post_username'] != $post_data['username']))
+    {
+        include($phpbb_root_path . 'includes/functions_user.' . $phpEx);
+
+        if (($result = validate_username($post_data['username'], (!empty($post_data['post_username'])) ? $post_data['post_username'] : '')) !== false)
+        {
+            $user->add_lang('ucp');
+            trigger_error($result . '_USERNAME');
+        }
+    }
+
+    // Parse subject
+    if (utf8_clean_string($post_data['post_subject']) === '' && $post_data['topic_first_post_id'] == $post_id)
+    {
+        trigger_error('EMPTY_SUBJECT');
+    }
+
+    $post_data['poll_last_vote'] = (isset($post_data['poll_last_vote'])) ? $post_data['poll_last_vote'] : 0;
+
+    if ($post_data['poll_option_text'] && $post_id == $post_data['topic_first_post_id']
+        && $auth->acl_get('f_poll', $forum_id))
+    {
+        $poll = array(
+            'poll_title'        => $post_data['poll_title'],
+            'poll_length'        => $post_data['poll_length'],
+            'poll_max_options'    => $post_data['poll_max_options'],
+            'poll_option_text'    => $post_data['poll_option_text'],
+            'poll_start'        => $post_data['poll_start'],
+            'poll_last_vote'    => $post_data['poll_last_vote'],
+            'poll_vote_change'    => $post_data['poll_vote_change'],
+            'enable_bbcode'        => $post_data['enable_bbcode'],
+            'enable_urls'        => $post_data['enable_urls'],
+            'enable_smilies'    => $post_data['enable_smilies'],
+            'img_status'        => $img_status
+        );
+
+        $message_parser->parse_poll($poll);
+
+        $post_data['poll_options'] = (isset($poll['poll_options'])) ? $poll['poll_options'] : '';
+        $post_data['poll_title'] = (isset($poll['poll_title'])) ? $poll['poll_title'] : '';
+    }
+    else
+    {
+        $poll = array();
+    }
+
+    // Check topic type
+    if ($post_data['topic_type'] != POST_NORMAL && $post_data['topic_first_post_id'] == $post_id)
+    {
+        switch ($post_data['topic_type'])
+        {
+            case POST_GLOBAL:
+            case POST_ANNOUNCE:
+                $auth_option = 'f_announce';
+            break;
+
+            case POST_STICKY:
+                $auth_option = 'f_sticky';
+            break;
+
+            default:
+                $auth_option = '';
+            break;
+        }
+
+        if (!$auth->acl_get($auth_option, $forum_id))
+        {
+            // There is a special case where a user edits his post whereby the topic type got changed by an admin/mod.
+            // Another case would be a mod not having sticky permissions for example but edit permissions.
+            // To prevent non-authed users messing around with the topic type we reset it to the original one.
+            $post_data['topic_type'] = $post_data['orig_topic_type'];
+        }
+    }
+
+    // DNSBL check
+    if ($config['check_dnsbl'])
+    {
+        if (($dnsbl = $user->check_dnsbl('post')) !== false)
+        {
+            trigger_error(sprintf($user->lang['IP_BLACKLISTED'], $user->ip, $dnsbl[1]));
+        }
+    }
+
+    // Check if we want to de-globalize the topic... and ask for new forum
+    if ($post_data['topic_type'] != POST_GLOBAL)
+    {
+        $sql = 'SELECT topic_type, forum_id
+            FROM ' . TOPICS_TABLE . "
+            WHERE topic_id = $topic_id";
+        $result = $db->sql_query($sql);
+        $row = $db->sql_fetchrow($result);
+        $db->sql_freeresult($result);
+
+        if ($row && !$row['forum_id'] && $row['topic_type'] == POST_GLOBAL)
+        {
+            $to_forum_id = request_var('to_forum_id', 0);
+
+            if ($to_forum_id)
+            {
+                $sql = 'SELECT forum_type
+                    FROM ' . FORUMS_TABLE . '
+                    WHERE forum_id = ' . $to_forum_id;
+                $result = $db->sql_query($sql);
+                $forum_type = (int) $db->sql_fetchfield('forum_type');
+                $db->sql_freeresult($result);
+
+                if ($forum_type != FORUM_POST || !$auth->acl_get('f_post', $to_forum_id))
+                {
+                    $to_forum_id = 0;
+                }
+            }
+
+            if (!$to_forum_id)
+            {
+                include_once($phpbb_root_path . 'includes/functions_admin.' . $phpEx);
+
+                $template->assign_vars(array(
+                    'S_FORUM_SELECT'    => make_forum_select(false, false, false, true, true, true),
+                    'S_UNGLOBALISE'        => true)
+                );
+
+                $submit = false;
+                $refresh = true;
+            }
+            else
+            {
+                if (!$auth->acl_get('f_post', $to_forum_id))
+                {
+                    // This will only be triggered if the user tried to trick the forum.
+                    trigger_error('NOT_AUTHORISED');
+                }
+
+                $forum_id = $to_forum_id;
+            }
+        }
+    }
+
+    // Lock/Unlock Topic
+    $change_topic_status = $post_data['topic_status'];
+    $perm_lock_unlock = ($auth->acl_get('m_lock', $forum_id) || ($auth->acl_get('f_user_lock', $forum_id) && $user->data['is_registered'] && !empty($post_data['topic_poster']) && $user->data['user_id'] == $post_data['topic_poster'] && $post_data['topic_status'] == ITEM_UNLOCKED)) ? true : false;
+
+    if ($post_data['topic_status'] == ITEM_LOCKED && !$topic_lock && $perm_lock_unlock)
+    {
+        $change_topic_status = ITEM_UNLOCKED;
+    }
+    else if ($post_data['topic_status'] == ITEM_UNLOCKED && $topic_lock && $perm_lock_unlock)
+    {
+        $change_topic_status = ITEM_LOCKED;
+    }
+
+    if ($change_topic_status != $post_data['topic_status'])
+    {
+        $sql = 'UPDATE ' . TOPICS_TABLE . "
+            SET topic_status = $change_topic_status
+            WHERE topic_id = $topic_id
+                AND topic_moved_id = 0";
+        $db->sql_query($sql);
+
+        $user_lock = ($auth->acl_get('f_user_lock', $forum_id) && $user->data['is_registered'] && $user->data['user_id'] == $post_data['topic_poster']) ? 'USER_' : '';
+
+        add_log('mod', $forum_id, $topic_id, 'LOG_' . $user_lock . (($change_topic_status == ITEM_LOCKED) ? 'LOCK' : 'UNLOCK'), $post_data['topic_title']);
+    }
+
+    // Lock/Unlock Post Edit
+    if ($mode == 'edit' && $post_data['post_edit_locked'] == ITEM_LOCKED && !$post_lock && $auth->acl_get('m_edit', $forum_id))
+    {
+        $post_data['post_edit_locked'] = ITEM_UNLOCKED;
+    }
+    else if ($mode == 'edit' && $post_data['post_edit_locked'] == ITEM_UNLOCKED && $post_lock && $auth->acl_get('m_edit', $forum_id))
+    {
+        $post_data['post_edit_locked'] = ITEM_LOCKED;
+    }
+
+    $data = array(
+        'topic_title'            => (empty($post_data['topic_title'])) ? $post_data['post_subject'] : $post_data['topic_title'],
+        'topic_first_post_id'    => (isset($post_data['topic_first_post_id'])) ? (int) $post_data['topic_first_post_id'] : 0,
+        'topic_last_post_id'    => (isset($post_data['topic_last_post_id'])) ? (int) $post_data['topic_last_post_id'] : 0,
+        'topic_time_limit'        => (int) $post_data['topic_time_limit'],
+        'topic_attachment'        => (isset($post_data['topic_attachment'])) ? (int) $post_data['topic_attachment'] : 0,
+        'post_id'                => (int) $post_id,
+        'topic_id'                => (int) $topic_id,
+        'forum_id'                => (int) $forum_id,
+        'icon_id'                => (int) $post_data['icon_id'],
+        'poster_id'                => (int) $post_data['poster_id'],
+        'enable_sig'            => (bool) $post_data['enable_sig'],
+        'enable_bbcode'            => (bool) $post_data['enable_bbcode'],
+        'enable_smilies'        => (bool) $post_data['enable_smilies'],
+        'enable_urls'            => (bool) $post_data['enable_urls'],
+        'enable_indexing'        => (bool) $post_data['enable_indexing'],
+        'message_md5'            => (string) $message_md5,
+        'post_time'                => (isset($post_data['post_time'])) ? (int) $post_data['post_time'] : time(),
+        'post_checksum'            => (isset($post_data['post_checksum'])) ? (string) $post_data['post_checksum'] : '',
+        'post_edit_reason'        => $post_data['post_edit_reason'],
+        'post_edit_user'        => ($mode == 'edit') ? $user->data['user_id'] : ((isset($post_data['post_edit_user'])) ? (int) $post_data['post_edit_user'] : 0),
+        'forum_parents'            => $post_data['forum_parents'],
+        'forum_name'            => $post_data['forum_name'],
+        'notify'                => $notify,
+        'notify_set'            => $post_data['notify_set'],
+        'poster_ip'                => (isset($post_data['poster_ip'])) ? $post_data['poster_ip'] : $user->ip,
+        'post_edit_locked'        => (int) $post_data['post_edit_locked'],
+        'bbcode_bitfield'        => $message_parser->bbcode_bitfield,
+        'bbcode_uid'            => $message_parser->bbcode_uid,
+        'message'                => $message_parser->message,
+        'attachment_data'        => $message_parser->attachment_data,
+        'filename_data'            => $message_parser->filename_data,
+
+        'topic_approved'        => (isset($post_data['topic_approved'])) ? $post_data['topic_approved'] : false,
+        'post_approved'            => (isset($post_data['post_approved'])) ? $post_data['post_approved'] : false,
+    );
+
+    $data['topic_replies_real'] = $post_data['topic_replies_real'];
+    $data['topic_replies'] = $post_data['topic_replies'];
+
+    include($phpbb_root_path . 'includes/functions_posting.' . $phpEx);
+    $cwd = getcwd();
+    chdir('../');
+    $redirect_url = submit_post($mode, $post_data['post_subject'], $post_data['username'], $post_data['topic_type'], $poll, $data, $update_message);
+    chdir($cwd);
+    
+    // Check the permissions for post approval, as well as the queue trigger where users are put on approval with a post count lower than specified. Moderators are not affected.
+    $approved = true;
+    if ((($config['enable_queue_trigger'] && $user->data['user_posts'] < $config['queue_trigger_posts']) || !$auth->acl_get('f_noapprove', $data['forum_id'])) && !$auth->acl_get('m_approve', $data['forum_id']))
+    {
+        $approved = false;
+    }
+
+    $reply_success = false;
+    $post_id = '';
+    if ($redirect_url)
+    {
+        preg_match('/&amp;p=(\d+)/', $redirect_url, $matches);
+        $post_id = $matches[1];
+        $reply_success = true;
+        
+        // get new post_content
+        $message = censor_text($data['message']);
+        $quote_wrote_string = $user->lang['WROTE'];
+        $message = str_replace('[/quote:'.$data['bbcode_uid'].']', '[/quote]', $message);
+        $message = preg_replace('/\[quote(?:=&quot;(.*?)&quot;)?:'.$data['bbcode_uid'].'\]/ise', "'[quote]' . ('$1' ? '$1' . ' $quote_wrote_string:\n' : '\n')", $message);
+        $blocks = preg_split('/(\[\/?quote\])/i', $message, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE);
+        $quote_level = 0;
+        $message = '';
+            
+        foreach($blocks as $block)
+        {
+            if ($block == '[quote]') {
+                if ($quote_level == 0) $message .= $block;
+                $quote_level++;
+            } else if ($block == '[/quote]') {
+                if ($quote_level <= 1) $message .= $block;
+                if ($quote_level >= 1) $quote_level--;
+            } else {
+                if ($quote_level <= 1) $message .= $block;
+            }
+        }
+        
+        $message = preg_replace('/\[(youtube|video|googlevideo|gvideo):'.$data['bbcode_uid'].'\](.*?)\[\/\1:'.$data['bbcode_uid'].'\]/sie', "video_bbcode_format('$1', '$2')", $message);
+        $message = preg_replace('/\[(BBvideo)[\d, ]+:'.$row['bbcode_uid'].'\](.*?)\[\/\1:'.$row['bbcode_uid'].'\]/si', "[url=$2]YouTube Video[/url]", $message);
+        $message = preg_replace('/\[(spoil|spoiler):'.$row['bbcode_uid'].'\](.*?)\[\/\1:'.$row['bbcode_uid'].'\]/si', "[spoiler]$2[/spoiler]", $message);
+        $message = preg_replace('/\[b:'.$data['bbcode_uid'].'\](.*?)\[\/b:'.$data['bbcode_uid'].'\]/si', '[b]$1[/b]', $message);
+        $message = preg_replace('/\[i:'.$data['bbcode_uid'].'\](.*?)\[\/i:'.$data['bbcode_uid'].'\]/si', '[i]$1[/i]', $message);
+        $message = preg_replace('/\[u:'.$data['bbcode_uid'].'\](.*?)\[\/u:'.$data['bbcode_uid'].'\]/si', '[u]$1[/u]', $message);
+        $message = preg_replace('/\[color=#(\w{6}):'.$data['bbcode_uid'].'\](.*?)\[\/color:'.$data['bbcode_uid'].'\]/si', '[color=#$1]$2[/color]', $message);
+        
+        // Second parse bbcode here
+        if ($data['bbcode_bitfield'])
+        {
+            $bbcode = new bbcode(base64_encode($data['bbcode_bitfield']));
+            $bbcode->bbcode_second_pass($message, $data['bbcode_uid'], $data['bbcode_bitfield']);
+        }
+        
+        $message = bbcode_nl2br($message);
+        $message = smiley_text($message);
+        
+        if (!empty($data['attachment_data']))
+        {
+            parse_attachments($forum_id, $message, $data['attachment_data'], $update_count);
+        }
+        
+        $updated_post_title = html_entity_decode(strip_tags(censor_text($data['topic_title'])), ENT_QUOTES, 'UTF-8');
+    }
+
+    $xmlrpc_reply_topic = new xmlrpcval(array(
+        'result'    => new xmlrpcval($reply_success, 'boolean'),
+        'state'     => new xmlrpcval($approved ? 0 : 1, 'int'),
+        'post_title'   => new xmlrpcval($updated_post_title, 'base64'),
+        'post_content' => new xmlrpcval(post_html_clean($message), 'base64'),
+    ), 'struct');
+
+    return new xmlrpcresp($xmlrpc_reply_topic);
+}
diff -ruN phpBB-3.0.10/mobiquo/function/search.php phpbb/mobiquo/function/search.php
--- phpBB-3.0.10/mobiquo/function/search.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/function/search.php	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,1139 @@
+<?php
+/**
+*
+* @copyright (c) 2009, 2010, 2011 Quoord Systems Limited
+* @license http://opensource.org/licenses/gpl-2.0.php GNU Public License (GPLv2)
+*
+*/
+
+defined('IN_MOBIQUO') or exit;
+
+
+if (!function_exists('evaluation_extend_sort_sql'))
+{
+    function evaluation_extend_sort_sql($sql, $sort_key)
+    {
+        return $sql;
+    }
+}
+
+//include($phpbb_root_path . 'common.' . $phpEx);
+
+// Start session management
+//$user->session_begin();
+//$auth->acl($user->data);
+$user->setup('search');
+
+// Define initial vars
+$mode			= request_var('mode', '');
+$search_id		= request_var('search_id', '');
+$page			= request_var('page', 1);
+$per_page		= request_var('perpage', 20);
+$start			= max(($page - 1) * $per_page, 0);
+//$start			= max(request_var('start', 0), 0);
+$post_id		= request_var('p', 0);
+$topic_id		= request_var('t', 0);
+$view			= request_var('view', '');
+
+$submit			= request_var('submit', false);
+$keywords		= utf8_normalize_nfc(request_var('keywords', '', true));
+$add_keywords	= utf8_normalize_nfc(request_var('add_keywords', '', true));
+$author			= request_var('author', '', true);
+$author_id		= request_var('author_id', 0);
+$show_results	= ($topic_id) ? 'posts' : request_var('sr', 'posts');
+$show_results	= ($show_results == 'posts') ? 'posts' : 'topics';
+$search_terms	= request_var('terms', 'all');
+$search_fields	= request_var('sf', 'all');
+$search_child	= request_var('sc', true);
+
+$sort_days		= request_var('st', 0.0);
+$sort_key		= request_var('sk', 't');
+$sort_dir		= request_var('sd', 'd');
+
+$return_chars	= request_var('ch', ($topic_id) ? -1 : 200);
+$search_forum	= request_var('fid', array(0));
+$exclude_forum	= request_var('exclude', array(0));
+
+// We put login boxes for the case if search_id is newposts, egosearch or unreadposts
+// because a guest should be able to log in even if guests search is not permitted
+
+switch ($search_id)
+{
+	// Egosearch is an author search
+	case 'egosearch':
+		$author_id = $user->data['user_id'];
+		if ($user->data['user_id'] == ANONYMOUS)
+		{
+		    trigger_error('LOGIN_EXPLAIN_EGOSEARCH');
+			//login_box('', $user->lang['LOGIN_EXPLAIN_EGOSEARCH']);
+		}
+	break;
+
+	// Search for unread posts needs to be allowed and user to be logged in if topics tracking for guests is disabled
+	case 'unreadposts':
+		if (isset($config['load_unreads_search']) && !$config['load_unreads_search'])
+		{
+			$template->assign_var('S_NO_SEARCH', true);
+			$errmsg = $user->lang['NO_SEARCH_UNREADS'] ? 'NO_SEARCH_UNREADS' : 'Sorry but searching for unread posts has been disabled on this board.';
+			trigger_error($errmsg);
+		}
+		else if (!$config['load_anon_lastread'] && !$user->data['is_registered'])
+		{
+			$errmsg = $user->lang['LOGIN_EXPLAIN_UNREADSEARCH'] ? 'LOGIN_EXPLAIN_UNREADSEARCH' : 'The board requires you to be registered and logged in to view your unread posts.';
+			trigger_error($errmsg);
+			//login_box('', $user->lang['LOGIN_EXPLAIN_UNREADSEARCH']);
+		}
+	break;
+	
+	// The "new posts" search uses user_lastvisit which is user based, so it should require user to log in.
+	case 'newposts':
+		if ($user->data['user_id'] == ANONYMOUS)
+		{
+		    trigger_error('LOGIN_EXPLAIN_NEWPOSTS');
+			//login_box('', $user->lang['LOGIN_EXPLAIN_NEWPOSTS']);
+		}
+	break;
+	
+	default:
+		// There's nothing to do here for now ;)
+	break;
+}
+
+if ($search_id != 'subscribedtopics')
+{
+    // Is user able to search? Has search been disabled?
+    if (!$auth->acl_get('u_search') || !$auth->acl_getf_global('f_search') || !$config['load_search'])
+    {
+    	$template->assign_var('S_NO_SEARCH', true);
+    	trigger_error('NO_SEARCH');
+    }
+    
+    // Check search load limit
+    if ($user->load && $config['limit_search_load'] && ($user->load > doubleval($config['limit_search_load'])))
+    {
+    	$template->assign_var('S_NO_SEARCH', true);
+    	trigger_error('NO_SEARCH_TIME');
+    }
+}
+
+// It is applicable if the configuration setting is non-zero, and the user cannot
+// ignore the flood setting, and the search is a keyword search.
+$interval = ($user->data['user_id'] == ANONYMOUS) ? $config['search_anonymous_interval'] : $config['search_interval'];
+if ($interval && !in_array($search_id, array('unreadposts', 'unanswered', 'active_topics', 'egosearch', 'latesttopics', 'subscribedtopics', 'tt_user_search')) && !$auth->acl_get('u_ignoreflood'))
+{
+	if ($user->data['user_last_search'] > time() - $interval)
+	{
+		$template->assign_var('S_NO_SEARCH', true);
+		trigger_error('NO_SEARCH_TIME');
+	}
+}
+
+// Define some vars
+$limit_days		= array(0 => $user->lang['ALL_RESULTS'], 1 => $user->lang['1_DAY'], 7 => $user->lang['7_DAYS'], 14 => $user->lang['2_WEEKS'], 30 => $user->lang['1_MONTH'], 90 => $user->lang['3_MONTHS'], 180 => $user->lang['6_MONTHS'], 365 => $user->lang['1_YEAR']);
+$sort_by_text	= array('a' => $user->lang['SORT_AUTHOR'], 't' => $user->lang['SORT_TIME'], 'f' => $user->lang['SORT_FORUM'], 'i' => $user->lang['SORT_TOPIC_TITLE'], 's' => $user->lang['SORT_POST_SUBJECT']);
+
+$s_limit_days = $s_sort_key = $s_sort_dir = $u_sort_param = '';
+gen_sort_selects($limit_days, $sort_by_text, $sort_days, $sort_key, $sort_dir, $s_limit_days, $s_sort_key, $s_sort_dir, $u_sort_param);
+
+if ($keywords || $author || $author_id || $search_id || $submit)
+{
+	// clear arrays
+	$id_ary = array();
+
+	// If we are looking for authors get their ids
+	$author_id_ary = array();
+	$sql_author_match = '';
+	if ($author_id)
+	{
+		$author_id_ary[] = $author_id;
+	}
+	else if ($author)
+	{
+		if ((strpos($author, '*') !== false) && (utf8_strlen(str_replace(array('*', '%'), '', $author)) < $config['min_search_author_chars']))
+		{
+			trigger_error(sprintf($user->lang['TOO_FEW_AUTHOR_CHARS'], $config['min_search_author_chars']));
+		}
+
+		$sql_where = (strpos($author, '*') !== false) ? ' username_clean ' . $db->sql_like_expression(str_replace('*', $db->any_char, utf8_clean_string($author))) : " username_clean = '" . $db->sql_escape(utf8_clean_string($author)) . "'";
+
+		$sql = 'SELECT user_id
+			FROM ' . USERS_TABLE . "
+			WHERE $sql_where
+				AND user_type <> " . USER_IGNORE;
+		$result = $db->sql_query_limit($sql, 100);
+
+		while ($row = $db->sql_fetchrow($result))
+		{
+			$author_id_ary[] = (int) $row['user_id'];
+		}
+		$db->sql_freeresult($result);
+
+		$sql_where = (strpos($author, '*') !== false) ? ' post_username ' . $db->sql_like_expression(str_replace('*', $db->any_char, utf8_clean_string($author))) : " post_username = '" . $db->sql_escape(utf8_clean_string($author)) . "'";
+
+		$sql = 'SELECT 1 as guest_post
+			FROM ' . POSTS_TABLE . "
+			WHERE $sql_where
+				AND poster_id = " . ANONYMOUS;
+		$result = $db->sql_query_limit($sql, 1);
+		$found_guest_post = $db->sql_fetchfield('guest_post');
+		$db->sql_freeresult($result);
+
+		if ($found_guest_post)
+		{
+			$author_id_ary[] = ANONYMOUS;
+			$sql_author_match = (strpos($author, '*') !== false) ? ' ' . $db->sql_like_expression(str_replace('*', $db->any_char, utf8_clean_string($author))) : " = '" . $db->sql_escape(utf8_clean_string($author)) . "'";
+		}
+
+		if (!sizeof($author_id_ary))
+		{
+			trigger_error('NO_SEARCH_RESULTS');
+		}
+	}
+
+	// if we search in an existing search result just add the additional keywords. But we need to use "all search terms"-mode
+	// so we can keep the old keywords in their old mode, but add the new ones as required words
+	if ($add_keywords)
+	{
+		if ($search_terms == 'all')
+		{
+			$keywords .= ' ' . $add_keywords;
+		}
+		else
+		{
+			$search_terms = 'all';
+			$keywords = implode(' |', explode(' ', preg_replace('#\s+#u', ' ', $keywords))) . ' ' .$add_keywords;
+		}
+	}
+
+	// Which forums should not be searched? Author searches are also carried out in unindexed forums
+	if (empty($keywords) && sizeof($author_id_ary))
+	{
+		$ex_fid_ary = array_keys($auth->acl_getf('!f_read', true));
+	}
+	else
+	{
+		$ex_fid_ary = array_unique(array_merge(array_keys($auth->acl_getf('!f_read', true)), array_keys($auth->acl_getf('!f_search', true))));
+	}
+
+    // add for tapatalk
+    if (isset($mobiquo_config['hide_forum_id']))
+    {
+        $ex_fid_ary = array_unique(array_merge($ex_fid_ary, $mobiquo_config['hide_forum_id']));
+    }
+    if ($exclude_forum)
+    {
+        $ex_fid_ary = array_unique(array_merge($ex_fid_ary, $exclude_forum));
+    }
+    // end
+
+	$not_in_fid = (sizeof($ex_fid_ary)) ? 'WHERE ' . $db->sql_in_set('f.forum_id', $ex_fid_ary, true) . " OR (f.forum_password <> '' AND fa.user_id <> " . (int) $user->data['user_id'] . ')' : "";
+
+	$sql = 'SELECT f.forum_id, f.forum_name, f.parent_id, f.forum_type, f.right_id, f.forum_password, f.forum_flags, fa.user_id
+		FROM ' . FORUMS_TABLE . ' f
+		LEFT JOIN ' . FORUMS_ACCESS_TABLE . " fa ON (fa.forum_id = f.forum_id
+			AND fa.session_id = '" . $db->sql_escape($user->session_id) . "')
+		$not_in_fid
+		ORDER BY f.left_id";
+	$result = $db->sql_query($sql);
+
+	$right_id = 0;
+	$reset_search_forum = true;
+	while ($row = $db->sql_fetchrow($result))
+	{
+		if ($row['forum_password'] && $row['user_id'] != $user->data['user_id'])
+		{
+			$ex_fid_ary[] = (int) $row['forum_id'];
+			continue;
+		}
+
+		// Exclude forums from active topics
+		if (!($row['forum_flags'] & FORUM_FLAG_ACTIVE_TOPICS) && ($search_id == 'active_topics'))
+		{
+			$ex_fid_ary[] = (int) $row['forum_id'];
+			continue;
+		}
+
+		if (sizeof($search_forum))
+		{
+			if ($search_child)
+			{
+				if (in_array($row['forum_id'], $search_forum) && $row['right_id'] > $right_id)
+				{
+					$right_id = (int) $row['right_id'];
+				}
+				else if ($row['right_id'] < $right_id)
+				{
+					continue;
+				}
+			}
+
+			if (!in_array($row['forum_id'], $search_forum))
+			{
+				$ex_fid_ary[] = (int) $row['forum_id'];
+				$reset_search_forum = false;
+			}
+		}
+	}
+	$db->sql_freeresult($result);
+
+	// find out in which forums the user is allowed to view approved posts
+	if ($auth->acl_get('m_approve'))
+	{
+		$m_approve_fid_ary = array(-1);
+		$m_approve_fid_sql = '';
+	}
+	else if ($auth->acl_getf_global('m_approve'))
+	{
+		$m_approve_fid_ary = array_diff(array_keys($auth->acl_getf('!m_approve', true)), $ex_fid_ary);
+		$m_approve_fid_sql = ' AND (p.post_approved = 1' . ((sizeof($m_approve_fid_ary)) ? ' OR ' . $db->sql_in_set('p.forum_id', $m_approve_fid_ary, true) : '') . ')';
+	}
+	else
+	{
+		$m_approve_fid_ary = array();
+		$m_approve_fid_sql = ' AND p.post_approved = 1';
+	}
+
+	if ($reset_search_forum)
+	{
+		$search_forum = array();
+	}
+
+	// Select which method we'll use to obtain the post_id or topic_id information
+	$search_type = basename($config['search_type']);
+
+	if (!file_exists($phpbb_root_path . 'includes/search/' . $search_type . '.' . $phpEx))
+	{
+		trigger_error('NO_SUCH_SEARCH_MODULE');
+	}
+
+	require("{$phpbb_root_path}includes/search/$search_type.$phpEx");
+
+	// We do some additional checks in the module to ensure it can actually be utilised
+	$error = false;
+	$search = new $search_type($error);
+
+	if ($error)
+	{
+		trigger_error($error);
+	}
+
+	// let the search module split up the keywords
+	if ($keywords)
+	{
+		$correct_query = $search->split_keywords($keywords, $search_terms);
+		if (!$correct_query || (empty($search->search_query) && !sizeof($author_id_ary) && !$search_id))
+		{
+			$ignored = (sizeof($search->common_words)) ? sprintf($user->lang['IGNORED_TERMS_EXPLAIN'], implode(' ', $search->common_words)) . '<br />' : '';
+			trigger_error($ignored . sprintf($user->lang['NO_KEYWORDS'], $search->word_length['min'], $search->word_length['max']));
+		}
+	}
+
+	if (!$keywords && sizeof($author_id_ary))
+	{
+		// if it is an author search we want to show topics by default
+		$show_results = ($topic_id) ? 'posts' : request_var('sr', ($search_id == 'egosearch') ? 'topics' : 'posts');
+		$show_results = ($show_results == 'posts') ? 'posts' : 'topics';
+	}
+
+	// define some variables needed for retrieving post_id/topic_id information
+	$sort_by_sql = array('a' => 'u.username_clean', 't' => (($show_results == 'posts') ? 'p.post_time' : 't.topic_last_post_time'), 'f' => 'f.forum_id', 'i' => 't.topic_title', 's' => (($show_results == 'posts') ? 'p.post_subject' : 't.topic_title'));
+
+	// pre-made searches
+	$sql = $field = $l_search_title = '';
+	if ($search_id)
+	{
+		switch ($search_id)
+		{
+			// Oh holy Bob, bring us some activity...
+			case 'active_topics':
+				$l_search_title = $user->lang['SEARCH_ACTIVE_TOPICS'];
+				$show_results = 'topics';
+				$sort_key = 't';
+				$sort_dir = 'd';
+				$sort_days = request_var('st', 7.0);
+				$sort_by_sql['t'] = 't.topic_last_post_time';
+
+				gen_sort_selects($limit_days, $sort_by_text, $sort_days, $sort_key, $sort_dir, $s_limit_days, $s_sort_key, $s_sort_dir, $u_sort_param);
+				$s_sort_key = $s_sort_dir = '';
+
+				$last_post_time_sql = ($sort_days) ? ' AND t.topic_last_post_time > ' . (time() - ($sort_days * 24 * 3600)) : '';
+
+				$sql = 'SELECT t.topic_last_post_time, t.topic_id
+					FROM ' . TOPICS_TABLE . " t
+					WHERE t.topic_moved_id = 0
+						$last_post_time_sql
+						" . str_replace(array('p.', 'post_'), array('t.', 'topic_'), $m_approve_fid_sql) . '
+						' . ((sizeof($ex_fid_ary)) ? ' AND ' . $db->sql_in_set('t.forum_id', $ex_fid_ary, true) : '') . '
+					ORDER BY t.topic_last_post_time DESC';
+				$field = 'topic_id';
+			break;
+
+			case 'unanswered':
+				$l_search_title = $user->lang['SEARCH_UNANSWERED'];
+				$show_results = request_var('sr', 'topics');
+				$show_results = ($show_results == 'posts') ? 'posts' : 'topics';
+				$sort_by_sql['t'] = ($show_results == 'posts') ? 'p.post_time' : 't.topic_last_post_time';
+				$sort_by_sql['s'] = ($show_results == 'posts') ? 'p.post_subject' : 't.topic_title';
+				$sql_sort = 'ORDER BY ' . $sort_by_sql[$sort_key] . (($sort_dir == 'a') ? ' ASC' : ' DESC');
+
+				$sort_join = ($sort_key == 'f') ? FORUMS_TABLE . ' f, ' : '';
+				$sql_sort = ($sort_key == 'f') ? ' AND f.forum_id = p.forum_id ' . $sql_sort : $sql_sort;
+
+				if ($sort_days)
+				{
+					$last_post_time = 'AND p.post_time > ' . (time() - ($sort_days * 24 * 3600));
+				}
+				else
+				{
+					$last_post_time = '';
+				}
+
+				if ($sort_key == 'a')
+				{
+					$sort_join = USERS_TABLE . ' u, ';
+					$sql_sort = ' AND u.user_id = p.poster_id ' . $sql_sort;
+				}
+				if ($show_results == 'posts')
+				{
+					$sql = "SELECT p.post_id
+						FROM $sort_join" . POSTS_TABLE . ' p, ' . TOPICS_TABLE . " t
+						WHERE t.topic_replies = 0
+							AND p.topic_id = t.topic_id
+							$last_post_time
+							$m_approve_fid_sql
+							" . ((sizeof($ex_fid_ary)) ? ' AND ' . $db->sql_in_set('p.forum_id', $ex_fid_ary, true) : '') . "
+							$sql_sort";
+					$field = 'post_id';
+				}
+				else
+				{
+					$sql = 'SELECT DISTINCT ' . $sort_by_sql[$sort_key] . ", p.topic_id
+						FROM $sort_join" . POSTS_TABLE . ' p, ' . TOPICS_TABLE . " t
+						WHERE t.topic_replies = 0
+							AND t.topic_moved_id = 0
+							AND p.topic_id = t.topic_id
+							$last_post_time
+							$m_approve_fid_sql
+							" . ((sizeof($ex_fid_ary)) ? ' AND ' . $db->sql_in_set('p.forum_id', $ex_fid_ary, true) : '') . "
+						$sql_sort";
+					$field = 'topic_id';
+				}
+			break;
+
+			case 'unreadposts':
+				$l_search_title = $user->lang['SEARCH_UNREAD'];
+				// force sorting
+				$show_results = 'topics';
+				$sort_key = 't';
+				$sort_by_sql['t'] = 't.topic_last_post_time';
+				$sql_sort = 'ORDER BY ' . $sort_by_sql[$sort_key] . (($sort_dir == 'a') ? ' ASC' : ' DESC');
+
+				$sql_where = 'AND t.topic_moved_id = 0
+					' . str_replace(array('p.', 'post_'), array('t.', 'topic_'), $m_approve_fid_sql) . '
+					' . ((sizeof($ex_fid_ary)) ? 'AND ' . $db->sql_in_set('t.forum_id', $ex_fid_ary, true) : '');
+
+				gen_sort_selects($limit_days, $sort_by_text, $sort_days, $sort_key, $sort_dir, $s_limit_days, $s_sort_key, $s_sort_dir, $u_sort_param);
+				$s_sort_key = $s_sort_dir = $u_sort_param = $s_limit_days = '';
+			break;
+
+			case 'newposts':
+				$l_search_title = $user->lang['SEARCH_NEW'];
+				// force sorting
+				$show_results = (request_var('sr', 'topics') == 'posts') ? 'posts' : 'topics';
+				$sort_key = 't';
+				$sort_dir = 'd';
+				$sort_by_sql['t'] = ($show_results == 'posts') ? 'p.post_time' : 't.topic_last_post_time';
+				$sql_sort = 'ORDER BY ' . $sort_by_sql[$sort_key] . (($sort_dir == 'a') ? ' ASC' : ' DESC');
+
+				gen_sort_selects($limit_days, $sort_by_text, $sort_days, $sort_key, $sort_dir, $s_limit_days, $s_sort_key, $s_sort_dir, $u_sort_param);
+				$s_sort_key = $s_sort_dir = $u_sort_param = $s_limit_days = '';
+
+				if ($show_results == 'posts')
+				{
+					$sql = 'SELECT p.post_id
+						FROM ' . POSTS_TABLE . ' p
+						WHERE p.post_time > ' . $user->data['user_lastvisit'] . "
+							$m_approve_fid_sql
+							" . ((sizeof($ex_fid_ary)) ? ' AND ' . $db->sql_in_set('p.forum_id', $ex_fid_ary, true) : '') . "
+						$sql_sort";
+					$field = 'post_id';
+				}
+				else
+				{
+					$sql = 'SELECT t.topic_id
+						FROM ' . TOPICS_TABLE . ' t
+						WHERE t.topic_last_post_time > ' . $user->data['user_lastvisit'] . '
+							AND t.topic_moved_id = 0
+							' . str_replace(array('p.', 'post_'), array('t.', 'topic_'), $m_approve_fid_sql) . '
+							' . ((sizeof($ex_fid_ary)) ? 'AND ' . $db->sql_in_set('t.forum_id', $ex_fid_ary, true) : '') . "
+						$sql_sort";
+/*
+		[Fix] queued replies missing from "view new posts" (Bug #42705 - Patch by Paul)
+		- Creates temporary table, query is far from optimized
+
+					$sql = 'SELECT t.topic_id
+						FROM ' . TOPICS_TABLE . ' t, ' . POSTS_TABLE . ' p
+						WHERE p.post_time > ' . $user->data['user_lastvisit'] . '
+							AND t.topic_id = p.topic_id
+							AND t.topic_moved_id = 0
+							' . $m_approve_fid_sql . '
+							' . ((sizeof($ex_fid_ary)) ? 'AND ' . $db->sql_in_set('t.forum_id', $ex_fid_ary, true) : '') . "
+						GROUP BY t.topic_id
+						$sql_sort";
+*/
+					$field = 'topic_id';
+				}
+			break;
+
+			// tapatalk add
+			case 'latesttopics':
+				// force sorting
+				$show_results = 'topics';
+				$sort_key = 't';
+				$sort_dir = 'd';
+				$sort_by_sql['t'] = 't.topic_last_post_time';
+				$sql_sort = 'ORDER BY ' . $sort_by_sql[$sort_key] . (($sort_dir == 'a') ? ' ASC' : ' DESC');
+
+				gen_sort_selects($limit_days, $sort_by_text, $sort_days, $sort_key, $sort_dir, $s_limit_days, $s_sort_key, $s_sort_dir, $u_sort_param);
+				$s_sort_key = $s_sort_dir = $u_sort_param = $s_limit_days = '';
+
+				$sql = 'SELECT t.topic_id
+					FROM ' . TOPICS_TABLE . ' t
+					WHERE t.topic_moved_id = 0
+						' . str_replace(array('p.', 'post_'), array('t.', 'topic_'), $m_approve_fid_sql) . '
+						' . ((sizeof($ex_fid_ary)) ? 'AND ' . $db->sql_in_set('t.forum_id', $ex_fid_ary, true) : '') . "
+					$sql_sort";
+				$field = 'topic_id';
+			break;
+			case 'subscribedtopics':
+				// force sorting
+				$show_results = 'topics';
+				$sort_key = 't';
+				$sort_dir = 'd';
+				$sort_by_sql['t'] = 't.topic_last_post_time';
+				$sql_sort = 'ORDER BY ' . $sort_by_sql[$sort_key] . (($sort_dir == 'a') ? ' ASC' : ' DESC');
+
+				gen_sort_selects($limit_days, $sort_by_text, $sort_days, $sort_key, $sort_dir, $s_limit_days, $s_sort_key, $s_sort_dir, $u_sort_param);
+				$s_sort_key = $s_sort_dir = $u_sort_param = $s_limit_days = '';
+
+				$sql = 'SELECT tw.topic_id
+					FROM ' . TOPICS_WATCH_TABLE . ' tw
+						LEFT JOIN ' . TOPICS_TABLE . ' t ON (tw.topic_id = t.topic_id)
+						LEFT JOIN ' . FORUMS_TABLE . ' f ON (t.forum_id = f.forum_id)
+					WHERE tw.user_id = ' . $user->data['user_id'] . '
+						' . str_replace(array('p.', 'post_'), array('t.', 'topic_'), $m_approve_fid_sql) . '
+						' . ((sizeof($ex_fid_ary)) ? 'AND ' . $db->sql_in_set('t.forum_id', $ex_fid_ary, true) : '') . "
+					$sql_sort";
+				$field = 'topic_id';
+			
+			case 'egosearch':
+				$l_search_title = $user->lang['SEARCH_SELF'];
+			break;
+		}
+	}
+
+	// show_results should not change after this
+	//$per_page = ($show_results == 'posts') ? $config['posts_per_page'] : $config['topics_per_page'];
+	$total_match_count = 0;
+
+	if ($search_id)
+	{
+		if ($sql)
+		{
+			// only return up to 1000 ids (the last one will be removed later)
+			$result = $db->sql_query_limit($sql, 1001 - $start, $start);
+
+			while ($row = $db->sql_fetchrow($result))
+			{
+				$id_ary[] = (int) $row[$field];
+			}
+			$db->sql_freeresult($result);
+
+			$total_match_count = sizeof($id_ary) + $start;
+			$id_ary = array_slice($id_ary, 0, $per_page);
+		}
+		else if ($search_id == 'unreadposts')
+		{
+			// tapatalk update
+			if (function_exists('get_unread_topics'))
+				$id_ary = array_keys(get_unread_topics($user->data['user_id'], $sql_where, $sql_sort, 1001 - $start, $start));
+			else
+				$id_ary = array_keys(tt_get_unread_topics($user->data['user_id'], $sql_where, $sql_sort, 1001 - $start, $start));
+
+			$total_match_count = sizeof($id_ary) + $start;
+			$id_ary = array_slice($id_ary, 0, $per_page);
+		}
+		else
+		{
+			$search_id = '';
+		}
+	}
+
+	// make sure that some arrays are always in the same order
+	sort($ex_fid_ary);
+	sort($m_approve_fid_ary);
+	sort($author_id_ary);
+
+	if (!empty($search->search_query))
+	{
+		// tapatalk change
+		if (version_compare($config['version'], '3.0.6', '<'))
+			$total_match_count = $search->keyword_search($show_results, $search_fields, $search_terms, $sort_by_sql, $sort_key, $sort_dir, $sort_days, $ex_fid_ary, $m_approve_fid_ary, $topic_id, $author_id_ary, $id_ary, $start, $per_page);
+		else
+			$total_match_count = $search->keyword_search($show_results, $search_fields, $search_terms, $sort_by_sql, $sort_key, $sort_dir, $sort_days, $ex_fid_ary, $m_approve_fid_ary, $topic_id, $author_id_ary, $sql_author_match, $id_ary, $start, $per_page);
+	}
+	else if (sizeof($author_id_ary))
+	{
+		$firstpost_only = ($search_fields === 'firstpost' || $search_fields == 'titleonly') ? true : false;
+		// tapatalk change
+		if (version_compare($config['version'], '3.0.6', '<'))
+			$total_match_count = $search->author_search($show_results, $firstpost_only, $sort_by_sql, $sort_key, $sort_dir, $sort_days, $ex_fid_ary, $m_approve_fid_ary, $topic_id, $author_id_ary, $id_ary, $start, $per_page);
+		else
+			$total_match_count = $search->author_search($show_results, $firstpost_only, $sort_by_sql, $sort_key, $sort_dir, $sort_days, $ex_fid_ary, $m_approve_fid_ary, $topic_id, $author_id_ary, $sql_author_match, $id_ary, $start, $per_page);
+	}
+
+	// For some searches we need to print out the "no results" page directly to allow re-sorting/refining the search options.
+	if (!sizeof($id_ary) && !$search_id)
+	{
+		trigger_error('NO_SEARCH_RESULTS');
+	}
+
+	$sql_where = '';
+
+	if (sizeof($id_ary))
+	{
+		$sql_where .= $db->sql_in_set(($show_results == 'posts') ? 'p.post_id' : 't.topic_id', $id_ary);
+		$sql_where .= (sizeof($ex_fid_ary)) ? ' AND (' . $db->sql_in_set('f.forum_id', $ex_fid_ary, true) . ' OR f.forum_id IS NULL)' : '';
+		$sql_where .= ($show_results == 'posts') ? $m_approve_fid_sql : str_replace(array('p.post_approved', 'p.forum_id'), array('t.topic_approved', 't.forum_id'), $m_approve_fid_sql);
+	}
+
+	if ($show_results == 'posts')
+	{
+		include($phpbb_root_path . 'includes/functions_posting.' . $phpEx);
+	}
+	else
+	{
+		include($phpbb_root_path . 'includes/functions_display.' . $phpEx);
+	}
+
+	$user->add_lang('viewtopic');
+
+	// Grab icons
+	$icons = $cache->obtain_icons();
+
+	// Output header
+	if ($search_id && ($total_match_count > 1000))
+	{
+		// limit the number to 1000 for pre-made searches
+		$total_match_count--;
+		$l_search_matches = sprintf($user->lang['FOUND_MORE_SEARCH_MATCHES'], $total_match_count);
+	}
+	else
+	{
+		$l_search_matches = ($total_match_count == 1) ? sprintf($user->lang['FOUND_SEARCH_MATCH'], $total_match_count) : sprintf($user->lang['FOUND_SEARCH_MATCHES'], $total_match_count);
+	}
+
+	// define some vars for urls
+	$hilit = implode('|', explode(' ', preg_replace('#\s+#u', ' ', str_replace(array('+', '-', '|', '(', ')', '&quot;'), ' ', $keywords))));
+	// Do not allow *only* wildcard being used for hilight
+	$hilit = (strspn($hilit, '*') === strlen($hilit)) ? '' : $hilit;
+
+	$u_hilit = urlencode(htmlspecialchars_decode(str_replace('|', ' ', $hilit)));
+	$u_show_results = '&amp;sr=' . $show_results;
+	$u_search_forum = implode('&amp;fid%5B%5D=', $search_forum);
+
+	$u_search = append_sid("{$phpbb_root_path}search.$phpEx", $u_sort_param . $u_show_results);
+	$u_search .= ($search_id) ? '&amp;search_id=' . $search_id : '';
+	$u_search .= ($u_hilit) ? '&amp;keywords=' . urlencode(htmlspecialchars_decode($keywords)) : '';
+	$u_search .= ($search_terms != 'all') ? '&amp;terms=' . $search_terms : '';
+	$u_search .= ($topic_id) ? '&amp;t=' . $topic_id : '';
+	$u_search .= ($author) ? '&amp;author=' . urlencode(htmlspecialchars_decode($author)) : '';
+	$u_search .= ($author_id) ? '&amp;author_id=' . $author_id : '';
+	$u_search .= ($u_search_forum) ? '&amp;fid%5B%5D=' . $u_search_forum : '';
+	$u_search .= (!$search_child) ? '&amp;sc=0' : '';
+	$u_search .= ($search_fields != 'all') ? '&amp;sf=' . $search_fields : '';
+	$u_search .= ($return_chars != 200) ? '&amp;ch=' . $return_chars : '';
+
+	$template->assign_vars(array(
+		'SEARCH_TITLE'		=> $l_search_title,
+		'SEARCH_MATCHES'	=> $l_search_matches,
+		'SEARCH_WORDS'		=> $search->search_query,
+		'IGNORED_WORDS'		=> (sizeof($search->common_words)) ? implode(' ', $search->common_words) : '',
+		'PAGINATION'		=> generate_pagination($u_search, $total_match_count, $per_page, $start),
+		'PAGE_NUMBER'		=> on_page($total_match_count, $per_page, $start),
+		'TOTAL_MATCHES'		=> $total_match_count,
+		'SEARCH_IN_RESULTS'	=> ($search_id) ? false : true,
+
+		'S_SELECT_SORT_DIR'		=> $s_sort_dir,
+		'S_SELECT_SORT_KEY'		=> $s_sort_key,
+		'S_SELECT_SORT_DAYS'	=> $s_limit_days,
+		'S_SEARCH_ACTION'		=> $u_search,
+		'S_SHOW_TOPICS'			=> ($show_results == 'posts') ? false : true,
+
+		'GOTO_PAGE_IMG'		=> $user->img('icon_post_target', 'GOTO_PAGE'),
+		'NEWEST_POST_IMG'	=> $user->img('icon_topic_newest', 'VIEW_NEWEST_POST'),
+		'REPORTED_IMG'		=> $user->img('icon_topic_reported', 'TOPIC_REPORTED'),
+		'UNAPPROVED_IMG'	=> $user->img('icon_topic_unapproved', 'TOPIC_UNAPPROVED'),
+		'LAST_POST_IMG'		=> $user->img('icon_topic_latest', 'VIEW_LATEST_POST'),
+
+		'U_SEARCH_WORDS'	=> $u_search,
+	));
+
+	if ($sql_where)
+	{
+		if ($show_results == 'posts')
+		{
+			// @todo Joining this query to the one below?
+			$sql = 'SELECT zebra_id, friend, foe
+				FROM ' . ZEBRA_TABLE . '
+				WHERE user_id = ' . $user->data['user_id'];
+			$result = $db->sql_query($sql);
+
+			$zebra = array();
+			while ($row = $db->sql_fetchrow($result))
+			{
+				$zebra[($row['friend']) ? 'friend' : 'foe'][] = $row['zebra_id'];
+			}
+			$db->sql_freeresult($result);
+
+			$sql = 'SELECT p.*, f.forum_id, f.forum_name, t.*, u.username, u.username_clean, u.user_sig, u.user_sig_bbcode_uid, u.user_colour, u.user_avatar, u.user_avatar_type
+				FROM ' . POSTS_TABLE . ' p
+					LEFT JOIN ' . TOPICS_TABLE . ' t ON (p.topic_id = t.topic_id)
+					LEFT JOIN ' . FORUMS_TABLE . ' f ON (p.forum_id = f.forum_id)
+					LEFT JOIN ' . USERS_TABLE . " u ON (p.poster_id = u.user_id)
+				WHERE $sql_where";
+		}
+		else
+		{
+			$sql_from = TOPICS_TABLE . ' t
+				LEFT JOIN ' . FORUMS_TABLE . ' f ON (f.forum_id = t.forum_id)
+				LEFT JOIN ' . POSTS_TABLE . ' p ON (p.post_id = t.topic_last_post_id)
+				LEFT JOIN ' . USERS_TABLE . ' u ON (u.user_id = t.topic_last_poster_id)';
+				//' . (($sort_key == 'a') ? ' LEFT JOIN ' . USERS_TABLE . ' u ON (u.user_id = t.topic_poster) ' : '');
+			$sql_select = 't.*, f.forum_id, f.forum_name, p.post_text, p.bbcode_uid, p.bbcode_bitfield, u.user_avatar, u.user_avatar_type';
+
+			if ($user->data['is_registered'])
+			{
+				if ($config['load_db_track'] && $author_id !== $user->data['user_id'])
+				{
+					$sql_from .= ' LEFT JOIN ' . TOPICS_POSTED_TABLE . ' tp ON (tp.user_id = ' . $user->data['user_id'] . '
+						AND t.topic_id = tp.topic_id)';
+					$sql_select .= ', tp.topic_posted';
+				}
+
+				if ($config['load_db_lastread'])
+				{
+					$sql_from .= ' LEFT JOIN ' . TOPICS_TRACK_TABLE . ' tt ON (tt.user_id = ' . $user->data['user_id'] . '
+							AND t.topic_id = tt.topic_id)
+						LEFT JOIN ' . FORUMS_TRACK_TABLE . ' ft ON (ft.user_id = ' . $user->data['user_id'] . '
+							AND ft.forum_id = f.forum_id)';
+					$sql_select .= ', tt.mark_time, ft.mark_time as f_mark_time';
+				}
+			}
+
+			if ($config['load_anon_lastread'] || ($user->data['is_registered'] && !$config['load_db_lastread']))
+			{
+				$tracking_topics = (isset($_COOKIE[$config['cookie_name'] . '_track'])) ? ((STRIP) ? stripslashes($_COOKIE[$config['cookie_name'] . '_track']) : $_COOKIE[$config['cookie_name'] . '_track']) : '';
+				$tracking_topics = ($tracking_topics) ? tracking_unserialize($tracking_topics) : array();
+			}
+
+			$sql = "SELECT $sql_select
+				FROM $sql_from
+				WHERE $sql_where";
+		}
+		$sql .= ' ORDER BY ' . $sort_by_sql[$sort_key] . ' ' . (($sort_dir == 'd') ? 'DESC' : 'ASC');
+		$result = $db->sql_query($sql);
+		$result_topic_id = 0;
+
+		$rowset = array();
+
+		if ($show_results == 'topics')
+		{
+			$forums = $rowset = $shadow_topic_list = array();
+			while ($row = $db->sql_fetchrow($result))
+			{
+                // tapatalk add
+                // We pre-process some variables here for later usage
+                $row['post_text'] = censor_text($row['post_text']);
+
+                $text_only_message = $row['post_text'];
+                // make list items visible as such
+                if ($row['bbcode_uid'])
+                {
+                    $text_only_message = str_replace('[*:' . $row['bbcode_uid'] . ']', '&sdot;&nbsp;', $text_only_message);
+                    // no BBCode in text only message
+                    strip_bbcode($text_only_message, $row['bbcode_uid']);
+                }
+                
+                $row['post_text'] = $text_only_message;
+                $row['display_text_only'] = true;
+                // tapatalk end
+				
+				$row['forum_id'] = (int) $row['forum_id'];
+				$row['topic_id'] = (int) $row['topic_id'];
+
+				if ($row['topic_status'] == ITEM_MOVED)
+				{
+					$shadow_topic_list[$row['topic_moved_id']] = $row['topic_id'];
+				}
+
+				$rowset[$row['topic_id']] = $row;
+
+				if (!isset($forums[$row['forum_id']]) && $user->data['is_registered'] && $config['load_db_lastread'])
+				{
+					$forums[$row['forum_id']]['mark_time'] = $row['f_mark_time'];
+				}
+				$forums[$row['forum_id']]['topic_list'][] = $row['topic_id'];
+				$forums[$row['forum_id']]['rowset'][$row['topic_id']] = &$rowset[$row['topic_id']];
+			}
+			$db->sql_freeresult($result);
+
+			// If we have some shadow topics, update the rowset to reflect their topic information
+			if (sizeof($shadow_topic_list))
+			{
+				$sql = 'SELECT *
+					FROM ' . TOPICS_TABLE . '
+					WHERE ' . $db->sql_in_set('topic_id', array_keys($shadow_topic_list));
+				$result = $db->sql_query($sql);
+
+				while ($row = $db->sql_fetchrow($result))
+				{
+					$orig_topic_id = $shadow_topic_list[$row['topic_id']];
+
+					// We want to retain some values
+					$row = array_merge($row, array(
+						'topic_moved_id'	=> $rowset[$orig_topic_id]['topic_moved_id'],
+						'topic_status'		=> $rowset[$orig_topic_id]['topic_status'],
+						'forum_name'		=> $rowset[$orig_topic_id]['forum_name'])
+					);
+
+					$rowset[$orig_topic_id] = $row;
+				}
+				$db->sql_freeresult($result);
+			}
+			unset($shadow_topic_list);
+
+			foreach ($forums as $forum_id => $forum)
+			{
+				if ($user->data['is_registered'] && $config['load_db_lastread'])
+				{
+					$topic_tracking_info[$forum_id] = get_topic_tracking($forum_id, $forum['topic_list'], $forum['rowset'], array($forum_id => $forum['mark_time']), ($forum_id) ? false : $forum['topic_list']);
+				}
+				else if ($config['load_anon_lastread'] || $user->data['is_registered'])
+				{
+					$topic_tracking_info[$forum_id] = get_complete_topic_tracking($forum_id, $forum['topic_list'], ($forum_id) ? false : $forum['topic_list']);
+
+					if (!$user->data['is_registered'])
+					{
+						$user->data['user_lastmark'] = (isset($tracking_topics['l'])) ? (int) (base_convert($tracking_topics['l'], 36, 10) + $config['board_startdate']) : 0;
+					}
+				}
+			}
+			unset($forums);
+		}
+		else
+		{
+			$bbcode_bitfield = $text_only_message = '';
+			$attach_list = array();
+
+			while ($row = $db->sql_fetchrow($result))
+			{
+				// We pre-process some variables here for later usage
+				$row['post_text'] = censor_text($row['post_text']);
+
+				$text_only_message = $row['post_text'];
+				// make list items visible as such
+				if ($row['bbcode_uid'])
+				{
+					$text_only_message = str_replace('[*:' . $row['bbcode_uid'] . ']', '&sdot;&nbsp;', $text_only_message);
+					// no BBCode in text only message
+					strip_bbcode($text_only_message, $row['bbcode_uid']);
+				}
+/*
+				if ($return_chars == -1 || utf8_strlen($text_only_message) < ($return_chars + 3))
+				{
+					$row['display_text_only'] = false;
+					$bbcode_bitfield = $bbcode_bitfield | base64_decode($row['bbcode_bitfield']);
+
+					// Does this post have an attachment? If so, add it to the list
+					if ($row['post_attachment'] && $config['allow_attachments'])
+					{
+						$attach_list[$row['forum_id']][] = $row['post_id'];
+					}
+				}
+				else
+				{
+*/
+					$row['post_text'] = $text_only_message;
+					$row['display_text_only'] = true;
+//				}
+
+				$rowset[] = $row;
+			}
+			$db->sql_freeresult($result);
+
+			unset($text_only_message);
+
+			// Instantiate BBCode if needed
+			if ($bbcode_bitfield !== '')
+			{
+				include_once($phpbb_root_path . 'includes/bbcode.' . $phpEx);
+				$bbcode = new bbcode(base64_encode($bbcode_bitfield));
+			}
+
+			// Pull attachment data
+			if (sizeof($attach_list))
+			{
+				$use_attach_list = $attach_list;
+				$attach_list = array();
+
+				foreach ($use_attach_list as $forum_id => $_list)
+				{
+					if ($auth->acl_get('u_download') && $auth->acl_get('f_download', $forum_id))
+					{
+						$attach_list = array_merge($attach_list, $_list);
+					}
+				}
+			}
+
+			if (sizeof($attach_list))
+			{
+				$sql = 'SELECT *
+					FROM ' . ATTACHMENTS_TABLE . '
+					WHERE ' . $db->sql_in_set('post_msg_id', $attach_list) . '
+						AND in_message = 0
+					ORDER BY filetime DESC, post_msg_id ASC';
+				$result = $db->sql_query($sql);
+
+				while ($row = $db->sql_fetchrow($result))
+				{
+					$attachments[$row['post_msg_id']][] = $row;
+				}
+				$db->sql_freeresult($result);
+			}
+		}
+/*
+		if ($hilit)
+		{
+			// Remove bad highlights
+			$hilit_array = array_filter(explode('|', $hilit), 'strlen');
+			foreach ($hilit_array as $key => $value)
+			{
+				$hilit_array[$key] = str_replace('\*', '\w*?', preg_quote($value, '#'));
+				$hilit_array[$key] = preg_replace('#(^|\s)\\\\w\*\?(\s|$)#', '$1\w+?$2', $hilit_array[$key]);
+			}
+			$hilit = implode('|', $hilit_array);
+		}
+*/
+		foreach ($rowset as $row)
+		{
+			$forum_id = $row['forum_id'];
+			$result_topic_id = $row['topic_id'];
+			$topic_title = censor_text($row['topic_title']);
+
+			// we need to select a forum id for this global topic
+			if (!$forum_id)
+			{
+				if (!isset($g_forum_id))
+				{
+					// Get a list of forums the user cannot read
+					$forum_ary = array_unique(array_keys($auth->acl_getf('!f_read', true)));
+
+					// Determine first forum the user is able to read (must not be a category)
+					$sql = 'SELECT forum_id
+						FROM ' . FORUMS_TABLE . '
+						WHERE forum_type = ' . FORUM_POST;
+
+					if (sizeof($forum_ary))
+					{
+						$sql .= ' AND ' . $db->sql_in_set('forum_id', $forum_ary, true);
+					}
+
+					$result = $db->sql_query_limit($sql, 1);
+					$g_forum_id = (int) $db->sql_fetchfield('forum_id');
+				}
+				$u_forum_id = $g_forum_id;
+			}
+			else
+			{
+				$u_forum_id = $forum_id;
+			}
+
+			$view_topic_url_params = "f=$u_forum_id&amp;t=$result_topic_id" . (($u_hilit) ? "&amp;hilit=$u_hilit" : '');
+			$view_topic_url = append_sid("{$phpbb_root_path}viewtopic.$phpEx", $view_topic_url_params);
+
+			$replies = ($auth->acl_get('m_approve', $forum_id)) ? $row['topic_replies_real'] : $row['topic_replies'];
+
+			if ($show_results == 'topics')
+			{
+				if ($config['load_db_track'] && $author_id === $user->data['user_id'])
+				{
+					$row['topic_posted'] = 1;
+				}
+
+				$folder_img = $folder_alt = $topic_type = '';
+				topic_status($row, $replies, (isset($topic_tracking_info[$forum_id][$row['topic_id']]) && $row['topic_last_post_time'] > $topic_tracking_info[$forum_id][$row['topic_id']]) ? true : false, $folder_img, $folder_alt, $topic_type);
+
+				$unread_topic = (isset($topic_tracking_info[$forum_id][$row['topic_id']]) && $row['topic_last_post_time'] > $topic_tracking_info[$forum_id][$row['topic_id']]) ? true : false;
+
+				$topic_unapproved = (!$row['topic_approved'] && $auth->acl_get('m_approve', $forum_id)) ? true : false;
+				$posts_unapproved = ($row['topic_approved'] && $row['topic_replies'] < $row['topic_replies_real'] && $auth->acl_get('m_approve', $forum_id)) ? true : false;
+				$u_mcp_queue = ($topic_unapproved || $posts_unapproved) ? append_sid("{$phpbb_root_path}mcp.$phpEx", 'i=queue&amp;mode=' . (($topic_unapproved) ? 'approve_details' : 'unapproved_posts') . "&amp;t=$result_topic_id", true, $user->session_id) : '';
+
+				$row['topic_title'] = preg_replace('#(?!<.*)(?<!\w)(' . $hilit . ')(?!\w|[^<>]*(?:</s(?:cript|tyle))?>)#is', '<span class="posthilit">$1</span>', $row['topic_title']);
+
+				// tapatalk add
+				$row['post_text'] = get_context($row['post_text'], array_filter(explode('|', $hilit), 'strlen'), $return_chars);
+
+				$tpl_ary = array(
+					'TOPIC_AUTHOR'				=> get_username_string('username', $row['topic_poster'], $row['topic_first_poster_name'], $row['topic_first_poster_colour']),
+					'TOPIC_AUTHOR_COLOUR'		=> get_username_string('colour', $row['topic_poster'], $row['topic_first_poster_name'], $row['topic_first_poster_colour']),
+					'TOPIC_AUTHOR_FULL'			=> get_username_string('full', $row['topic_poster'], $row['topic_first_poster_name'], $row['topic_first_poster_colour']),
+					'FIRST_POST_TIME'			=> $user->format_date($row['topic_time']),
+					'LAST_POST_SUBJECT'			=> $row['topic_last_post_subject'],
+					'LAST_POST_TIME'			=> $user->format_date($row['topic_last_post_time']),
+					'LAST_VIEW_TIME'			=> $user->format_date($row['topic_last_view_time']),
+					
+					// tapatalk add
+					'TOPIC_AUTHOR_ID'			=> $row['topic_poster'],
+					'FIRST_POST_TIMESTAMP'		=> $row['topic_time'],
+					'LAST_POST_TIMESTAMP'		=> $row['topic_last_post_time'],
+					'LAST_POSTER_ID'			=> $row['topic_last_poster_id'],
+					'LAST_POSTER_AVATAR'		=> get_user_avatar_url($row['user_avatar'], $row['user_avatar_type']),
+					'LAST_POST_PREV'			=> $row['post_text'],
+					'S_POST_STICKY'				=> ($row['topic_type'] == POST_STICKY) ? true : false,
+					'S_TOPIC_LOCKED'			=> ($row['topic_status'] == ITEM_LOCKED) ? true : false,
+					
+					'LAST_POST_AUTHOR'			=> get_username_string('username', $row['topic_last_poster_id'], $row['topic_last_poster_name'], $row['topic_last_poster_colour']),
+					'LAST_POST_AUTHOR_COLOUR'	=> get_username_string('colour', $row['topic_last_poster_id'], $row['topic_last_poster_name'], $row['topic_last_poster_colour']),
+					'LAST_POST_AUTHOR_FULL'		=> get_username_string('full', $row['topic_last_poster_id'], $row['topic_last_poster_name'], $row['topic_last_poster_colour']),
+
+					'PAGINATION'		=> topic_generate_pagination($replies, $view_topic_url),
+					'TOPIC_TYPE'		=> $topic_type,
+
+					'TOPIC_FOLDER_IMG'		=> $user->img($folder_img, $folder_alt),
+					'TOPIC_FOLDER_IMG_SRC'	=> $user->img($folder_img, $folder_alt, false, '', 'src'),
+					'TOPIC_FOLDER_IMG_ALT'	=> $user->lang[$folder_alt],
+					'TOPIC_FOLDER_IMG_WIDTH'=> $user->img($folder_img, '', false, '', 'width'),
+					'TOPIC_FOLDER_IMG_HEIGHT'	=> $user->img($folder_img, '', false, '', 'height'),
+
+					'TOPIC_ICON_IMG'		=> (!empty($icons[$row['icon_id']])) ? $icons[$row['icon_id']]['img'] : '',
+					'TOPIC_ICON_IMG_WIDTH'	=> (!empty($icons[$row['icon_id']])) ? $icons[$row['icon_id']]['width'] : '',
+					'TOPIC_ICON_IMG_HEIGHT'	=> (!empty($icons[$row['icon_id']])) ? $icons[$row['icon_id']]['height'] : '',
+					'ATTACH_ICON_IMG'		=> ($auth->acl_get('u_download') && $auth->acl_get('f_download', $forum_id) && $row['topic_attachment']) ? $user->img('icon_topic_attach', $user->lang['TOTAL_ATTACHMENTS']) : '',
+					'UNAPPROVED_IMG'		=> ($topic_unapproved || $posts_unapproved) ? $user->img('icon_topic_unapproved', ($topic_unapproved) ? 'TOPIC_UNAPPROVED' : 'POSTS_UNAPPROVED') : '',
+
+					'S_TOPIC_GLOBAL'		=> (!$forum_id) ? true : false,
+					'S_TOPIC_TYPE'			=> $row['topic_type'],
+					'S_USER_POSTED'			=> (!empty($row['topic_posted'])) ? true : false,
+					'S_UNREAD_TOPIC'		=> $unread_topic,
+
+					'S_TOPIC_REPORTED'		=> (!empty($row['topic_reported']) && $auth->acl_get('m_report', $forum_id)) ? true : false,
+					'S_TOPIC_UNAPPROVED'	=> $topic_unapproved,
+					'S_POSTS_UNAPPROVED'	=> $posts_unapproved,
+
+					'U_LAST_POST'			=> append_sid("{$phpbb_root_path}viewtopic.$phpEx", $view_topic_url_params . '&amp;p=' . $row['topic_last_post_id']) . '#p' . $row['topic_last_post_id'],
+					'U_LAST_POST_AUTHOR'	=> get_username_string('profile', $row['topic_last_poster_id'], $row['topic_last_poster_name'], $row['topic_last_poster_colour']),
+					'U_TOPIC_AUTHOR'		=> get_username_string('profile', $row['topic_poster'], $row['topic_first_poster_name'], $row['topic_first_poster_colour']),
+					'U_NEWEST_POST'			=> append_sid("{$phpbb_root_path}viewtopic.$phpEx", $view_topic_url_params . '&amp;view=unread') . '#unread',
+					'U_MCP_REPORT'			=> append_sid("{$phpbb_root_path}mcp.$phpEx", 'i=reports&amp;mode=reports&amp;t=' . $result_topic_id, true, $user->session_id),
+					'U_MCP_QUEUE'			=> $u_mcp_queue,
+				);
+			}
+			else
+			{
+				if ((isset($zebra['foe']) && in_array($row['poster_id'], $zebra['foe'])) && (!$view || $view != 'show' || $post_id != $row['post_id']))
+				{
+					$template->assign_block_vars('searchresults', array(
+						'S_IGNORE_POST' => true,
+
+						'L_IGNORE_POST' => sprintf($user->lang['POST_BY_FOE'], $row['username'], "<a href=\"$u_search&amp;start=$start&amp;p=" . $row['post_id'] . '&amp;view=show#p' . $row['post_id'] . '">', '</a>'))
+					);
+
+					continue;
+				}
+
+				// Replace naughty words such as farty pants
+				$row['post_subject'] = censor_text($row['post_subject']);
+/*
+				if ($row['display_text_only'])
+				{
+*/
+					// now find context for the searched words
+					$row['post_text'] = get_context($row['post_text'], array_filter(explode('|', $hilit), 'strlen'), $return_chars);
+/*
+					$row['post_text'] = bbcode_nl2br($row['post_text']);
+				}
+				else
+				{
+					// Second parse bbcode here
+					if ($row['bbcode_bitfield'])
+					{
+						$bbcode->bbcode_second_pass($row['post_text'], $row['bbcode_uid'], $row['bbcode_bitfield']);
+					}
+
+					$row['post_text'] = bbcode_nl2br($row['post_text']);
+					$row['post_text'] = smiley_text($row['post_text']);
+
+					if (!empty($attachments[$row['post_id']]))
+					{
+						parse_attachments($forum_id, $row['post_text'], $attachments[$row['post_id']], $update_count);
+
+						// we only display inline attachments
+						unset($attachments[$row['post_id']]);
+					}
+				}
+
+				if ($hilit)
+				{
+					// post highlighting
+					$row['post_text'] = preg_replace('#(?!<.*)(?<!\w)(' . $hilit . ')(?!\w|[^<>]*(?:</s(?:cript|tyle))?>)#is', '<span class="posthilit">$1</span>', $row['post_text']);
+					$row['post_subject'] = preg_replace('#(?!<.*)(?<!\w)(' . $hilit . ')(?!\w|[^<>]*(?:</s(?:cript|tyle))?>)#is', '<span class="posthilit">$1</span>', $row['post_subject']);
+				}
+*/
+				$tpl_ary = array(
+					'POST_AUTHOR_FULL'		=> get_username_string('full', $row['poster_id'], $row['username'], $row['user_colour'], $row['post_username']),
+					'POST_AUTHOR_COLOUR'	=> get_username_string('colour', $row['poster_id'], $row['username'], $row['user_colour'], $row['post_username']),
+					'POST_AUTHOR'			=> get_username_string('username', $row['poster_id'], $row['username'], $row['user_colour'], $row['post_username']),
+					'U_POST_AUTHOR'			=> get_username_string('profile', $row['poster_id'], $row['username'], $row['user_colour'], $row['post_username']),
+
+					// tapatalk add
+					'POST_AUTHOR_ID'	=> $row['poster_id'],
+					'POST_TIMESTAMP'	=> $row['post_time'],
+					'POSTER_AVATAR'		=> get_user_avatar_url($row['user_avatar'], $row['user_avatar_type']),
+					'POST_APPROVED'		=> $row['post_approved'],
+					'TOPIC_LAST_POST_ID'=> $row['topic_last_post_id'],
+					'POST_EDIT_LOCKED'  => $row['post_edit_locked'],
+					
+					'POST_SUBJECT'		=> $row['post_subject'],
+					'POST_DATE'			=> (!empty($row['post_time'])) ? $user->format_date($row['post_time']) : '',
+					'MESSAGE'			=> $row['post_text']
+				);
+			}
+
+			$template->assign_block_vars('searchresults', array_merge($tpl_ary, array(
+				'FORUM_ID'			=> $forum_id,
+				'TOPIC_ID'			=> $result_topic_id,
+				'POST_ID'			=> ($show_results == 'posts') ? $row['post_id'] : false,
+
+				'FORUM_TITLE'		=> $forum_id ? $row['forum_name'] : (isset($user->lang['GLOBAL']) ? $user->lang['GLOBAL'] : 'Global announcement'),
+				'TOPIC_TITLE'		=> $topic_title,
+				'TOPIC_REPLIES'		=> $replies,
+				'TOPIC_VIEWS'		=> $row['topic_views'],
+
+				'U_VIEW_TOPIC'		=> $view_topic_url,
+				'U_VIEW_FORUM'		=> append_sid("{$phpbb_root_path}viewforum.$phpEx", 'f=' . $forum_id),
+				'U_VIEW_POST'		=> (!empty($row['post_id'])) ? append_sid("{$phpbb_root_path}viewtopic.$phpEx", "f=$forum_id&amp;t=" . $row['topic_id'] . '&amp;p=' . $row['post_id'] . (($u_hilit) ? '&amp;hilit=' . $u_hilit : '')) . '#p' . $row['post_id'] : '')
+			));
+		}
+
+		if ($topic_id && ($topic_id == $result_topic_id))
+		{
+			$template->assign_vars(array(
+				'SEARCH_TOPIC'		=> $topic_title,
+				'U_SEARCH_TOPIC'	=> $view_topic_url
+			));
+		}
+	}
+	unset($rowset);
+}
diff -ruN phpBB-3.0.10/mobiquo/function/subscribe_forum.php phpbb/mobiquo/function/subscribe_forum.php
--- phpBB-3.0.10/mobiquo/function/subscribe_forum.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/function/subscribe_forum.php	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,146 @@
+<?php
+/**
+*
+* @copyright (c) 2009, 2010, 2011 Quoord Systems Limited
+* @license http://opensource.org/licenses/gpl-2.0.php GNU Public License (GPLv2)
+*
+*/
+
+defined('IN_MOBIQUO') or exit;
+
+function subscribe_forum_func($xmlrpc_params)
+{
+    global $db, $user, $config, $auth;
+    
+    $user->setup('viewforum');
+    
+    $params = php_xmlrpc_decode($xmlrpc_params);
+    
+    $forum_id = intval($params[0]);
+    if (!$forum_id) trigger_error('NO_FORUM');
+    $user_id = $user->data['user_id'];
+
+    $sql_from = FORUMS_TABLE . ' f';
+    $lastread_select = '';
+    
+    // Grab appropriate forum data
+    if ($config['load_db_lastread'] && $user->data['is_registered'])
+    {
+        $sql_from .= ' LEFT JOIN ' . FORUMS_TRACK_TABLE . ' ft ON (ft.user_id = ' . $user->data['user_id'] . '
+            AND ft.forum_id = f.forum_id)';
+        $lastread_select .= ', ft.mark_time';
+    }
+    
+    if ($user->data['is_registered'])
+    {
+        $sql_from .= ' LEFT JOIN ' . FORUMS_WATCH_TABLE . ' fw ON (fw.forum_id = f.forum_id AND fw.user_id = ' . $user->data['user_id'] . ')';
+        $lastread_select .= ', fw.notify_status';
+    }
+    
+    $sql = "SELECT f.* $lastread_select
+        FROM $sql_from
+        WHERE f.forum_id = $forum_id";
+    $result = $db->sql_query($sql);
+    $forum_data = $db->sql_fetchrow($result);
+    $db->sql_freeresult($result);
+
+    if (!$forum_data) trigger_error('NO_FORUM');
+    
+    // Permissions check
+    if (!$auth->acl_gets('f_list', 'f_read', $forum_id) || ($forum_data['forum_type'] == FORUM_LINK && $forum_data['forum_link'] && !$auth->acl_get('f_read', $forum_id)))
+    {
+        if ($user->data['user_id'] != ANONYMOUS)
+        {
+            trigger_error('SORRY_AUTH_READ');
+        }
+    
+        trigger_error('LOGIN_VIEWFORUM');
+    }
+    
+    // Forum is passworded ... check whether access has been granted to this
+    // user this session, if not show login box
+    if ($forum_data['forum_password'] && !check_forum_password($forum_id))
+        trigger_error('LOGIN_FORUM');
+    
+    // Is this forum a link? ... User got here either because the
+    // number of clicks is being tracked or they guessed the id
+    if ($forum_data['forum_type'] == FORUM_LINK && $forum_data['forum_link'])
+    {
+        trigger_error('NO_FORUM');
+    }
+    
+    // Not postable forum or showing active topics?
+    if (!($forum_data['forum_type'] == FORUM_POST || (($forum_data['forum_flags'] & FORUM_FLAG_ACTIVE_TOPICS) && $forum_data['forum_type'] == FORUM_CAT)))
+    {
+        trigger_error('NO_FORUM');
+    }
+    
+    // Ok, if someone has only list-access, we only display the forum list.
+    // We also make this circumstance available to the template in case we want to display a notice. ;)
+    if (!$auth->acl_get('f_read', $forum_id))
+    {
+        trigger_error('SORRY_AUTH_READ');
+    }
+    
+    if (($config['email_enable'] || $config['jab_enable']) && $config['allow_forum_notify'] && $forum_data['forum_type'] == FORUM_POST && $auth->acl_get('f_subscribe', $forum_id))
+    {
+        $notify_status = (isset($forum_data['notify_status'])) ? $forum_data['notify_status'] : 'unset';
+        
+        $table_sql = FORUMS_WATCH_TABLE;
+        $where_sql = 'forum_id';
+        $match_id = $forum_id;
+    
+        // Is user watching this thread?
+        if ($user_id != ANONYMOUS)
+        {
+            if ($notify_status == 'unset')
+            {
+                $sql = "SELECT notify_status
+                    FROM $table_sql
+                    WHERE $where_sql = $match_id
+                        AND user_id = $user_id";
+                $result = $db->sql_query($sql);
+    
+                $notify_status = ($row = $db->sql_fetchrow($result)) ? $row['notify_status'] : NULL;
+                $db->sql_freeresult($result);
+            }
+    
+            if (!is_null($notify_status) && $notify_status !== '')
+            {
+                if ($notify_status)
+                {
+                    $sql = 'UPDATE ' . $table_sql . "
+                        SET notify_status = 0
+                        WHERE $where_sql = $match_id
+                            AND user_id = $user_id";
+                    $db->sql_query($sql);
+                }
+            }
+            else
+            {
+                $sql = 'INSERT INTO ' . $table_sql . " (user_id, $where_sql, notify_status)
+                    VALUES ($user_id, $match_id, 0)";
+                $db->sql_query($sql);
+            }
+            $s_result = true;
+        }
+        else
+        {
+            trigger_error('LOGIN_VIEWFORUM');
+        }
+    }
+    else
+    {
+        $s_result = false;
+    }
+    
+    $response = new xmlrpcval(
+        array(
+            'result'        => new xmlrpcval($s_result, 'boolean'),
+            'result_text'   => new xmlrpcval($s_result ? '' : 'Subscribe failed', 'base64'),
+        ),
+        'struct'
+    );
+    
+    return new xmlrpcresp($response);
+}
diff -ruN phpBB-3.0.10/mobiquo/function/subscribe_topic.php phpbb/mobiquo/function/subscribe_topic.php
--- phpBB-3.0.10/mobiquo/function/subscribe_topic.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/function/subscribe_topic.php	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,66 @@
+<?php
+/**
+*
+* @copyright (c) 2009, 2010, 2011 Quoord Systems Limited
+* @license http://opensource.org/licenses/gpl-2.0.php GNU Public License (GPLv2)
+*
+*/
+
+defined('IN_MOBIQUO') or exit;
+
+function subscribe_topic_func($xmlrpc_params)
+{
+    global $db, $user;
+    
+    $user->setup('viewtopic');
+    
+    $params = php_xmlrpc_decode($xmlrpc_params);
+    
+    // get topic id from parameters
+    $topic_id = intval($params[0]);
+    if (!$topic_id) trigger_error('NO_TOPIC');
+    $user_id = $user->data['user_id'];
+    $s_result = false;
+
+    // Is user login?
+    if ($user_id != ANONYMOUS)
+    {
+        $sql = 'SELECT notify_status
+                FROM ' . TOPICS_WATCH_TABLE . "
+                WHERE topic_id = $topic_id
+                AND user_id = $user_id";
+        $result = $db->sql_query($sql);
+
+        $notify_status = ($row = $db->sql_fetchrow($result)) ? $row['notify_status'] : NULL;
+        $db->sql_freeresult($result);
+
+        if (!is_null($notify_status) && $notify_status !== '')
+        {
+            if ($notify_status)
+            {
+                $sql = 'UPDATE ' . TOPICS_WATCH_TABLE . "
+                        SET notify_status = 0
+                        WHERE topic_id = $topic_id
+                        AND user_id = $user_id";
+                $db->sql_query($sql);
+            }
+        }
+        else
+        {
+            $sql = 'INSERT INTO ' . TOPICS_WATCH_TABLE . " (user_id, topic_id, notify_status)
+                    VALUES ($user_id, $topic_id, 0)";
+            $db->sql_query($sql);
+            $s_result = true;
+        }
+    }
+    
+    $response = new xmlrpcval(
+        array(
+            'result'        => new xmlrpcval($s_result, 'boolean'),
+            'result_text'   => new xmlrpcval($s_result ? '' : 'Subscribe failed', 'base64'),
+        ),
+        'struct'
+    );
+    
+    return new xmlrpcresp($response);
+}
diff -ruN phpBB-3.0.10/mobiquo/function/unsubscribe_forum.php phpbb/mobiquo/function/unsubscribe_forum.php
--- phpBB-3.0.10/mobiquo/function/unsubscribe_forum.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/function/unsubscribe_forum.php	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,135 @@
+<?php
+/**
+*
+* @copyright (c) 2009, 2010, 2011 Quoord Systems Limited
+* @license http://opensource.org/licenses/gpl-2.0.php GNU Public License (GPLv2)
+*
+*/
+
+defined('IN_MOBIQUO') or exit;
+
+function unsubscribe_forum_func($xmlrpc_params)
+{
+    global $db, $user, $config, $auth;
+    
+    $user->setup('viewforum');
+    
+    $params = php_xmlrpc_decode($xmlrpc_params);
+    
+    $forum_id = intval($params[0]);
+    if (!$forum_id) trigger_error('NO_FORUM');
+    $user_id = $user->data['user_id'];
+
+    $sql_from = FORUMS_TABLE . ' f';
+    $lastread_select = '';
+    
+    // Grab appropriate forum data
+    if ($config['load_db_lastread'] && $user->data['is_registered'])
+    {
+        $sql_from .= ' LEFT JOIN ' . FORUMS_TRACK_TABLE . ' ft ON (ft.user_id = ' . $user->data['user_id'] . '
+            AND ft.forum_id = f.forum_id)';
+        $lastread_select .= ', ft.mark_time';
+    }
+    
+    if ($user->data['is_registered'])
+    {
+        $sql_from .= ' LEFT JOIN ' . FORUMS_WATCH_TABLE . ' fw ON (fw.forum_id = f.forum_id AND fw.user_id = ' . $user->data['user_id'] . ')';
+        $lastread_select .= ', fw.notify_status';
+    }
+    
+    $sql = "SELECT f.* $lastread_select
+        FROM $sql_from
+        WHERE f.forum_id = $forum_id";
+    $result = $db->sql_query($sql);
+    $forum_data = $db->sql_fetchrow($result);
+    $db->sql_freeresult($result);
+
+    if (!$forum_data) trigger_error('NO_FORUM');
+    
+    // Permissions check
+    if (!$auth->acl_gets('f_list', 'f_read', $forum_id) || ($forum_data['forum_type'] == FORUM_LINK && $forum_data['forum_link'] && !$auth->acl_get('f_read', $forum_id)))
+    {
+        if ($user->data['user_id'] != ANONYMOUS)
+        {
+            trigger_error('SORRY_AUTH_READ');
+        }
+    
+        trigger_error('LOGIN_VIEWFORUM');
+    }
+    
+    // Forum is passworded ... check whether access has been granted to this
+    // user this session, if not show login box
+    if ($forum_data['forum_password'] && !check_forum_password($forum_id))
+        trigger_error('LOGIN_FORUM');
+    
+    // Is this forum a link? ... User got here either because the
+    // number of clicks is being tracked or they guessed the id
+    if ($forum_data['forum_type'] == FORUM_LINK && $forum_data['forum_link'])
+        trigger_error('NO_FORUM');
+    
+    // Not postable forum or showing active topics?
+    if (!($forum_data['forum_type'] == FORUM_POST || (($forum_data['forum_flags'] & FORUM_FLAG_ACTIVE_TOPICS) && $forum_data['forum_type'] == FORUM_CAT)))
+        trigger_error('NO_FORUM');
+    
+    // Ok, if someone has only list-access, we only display the forum list.
+    // We also make this circumstance available to the template in case we want to display a notice. ;)
+    if (!$auth->acl_get('f_read', $forum_id))
+    {
+        trigger_error('SORRY_AUTH_READ');
+    }
+    
+    if (($config['email_enable'] || $config['jab_enable']) && $config['allow_forum_notify'] && $forum_data['forum_type'] == FORUM_POST && $auth->acl_get('f_subscribe', $forum_id))
+    {
+        $notify_status = (isset($forum_data['notify_status'])) ? $forum_data['notify_status'] : 'unset';
+        
+        $table_sql = FORUMS_WATCH_TABLE;
+        $where_sql = 'forum_id';
+        $match_id = $forum_id;
+
+        // Is user watching this thread?
+        if ($user_id != ANONYMOUS)
+        {
+            $can_watch = true;
+    
+            if ($notify_status == 'unset')
+            {
+                $sql = "SELECT notify_status
+                    FROM $table_sql
+                    WHERE $where_sql = $match_id
+                        AND user_id = $user_id";
+                $result = $db->sql_query($sql);
+    
+                $notify_status = ($row = $db->sql_fetchrow($result)) ? $row['notify_status'] : NULL;
+                $db->sql_freeresult($result);
+            }
+    
+            if (!is_null($notify_status) && $notify_status !== '')
+            {
+                $sql = 'DELETE FROM ' . $table_sql . "
+                    WHERE $where_sql = $match_id
+                        AND user_id = $user_id";
+                $db->sql_query($sql);
+            }
+            
+            $s_result = true;
+        }
+        else
+        {
+            trigger_error('LOGIN_VIEWFORUM');
+        }
+    }
+    else
+    {
+        $s_result = false;
+    }
+    
+    $response = new xmlrpcval(
+        array(
+            'result'        => new xmlrpcval($s_result, 'boolean'),
+            'result_text'   => new xmlrpcval($s_result ? '' : 'Unsubscribe failed', 'base64'),
+        ),
+        'struct'
+    );
+    
+    return new xmlrpcresp($response);
+}
diff -ruN phpBB-3.0.10/mobiquo/function/unsubscribe_topic.php phpbb/mobiquo/function/unsubscribe_topic.php
--- phpBB-3.0.10/mobiquo/function/unsubscribe_topic.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/function/unsubscribe_topic.php	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,56 @@
+<?php
+/**
+*
+* @copyright (c) 2009, 2010, 2011 Quoord Systems Limited
+* @license http://opensource.org/licenses/gpl-2.0.php GNU Public License (GPLv2)
+*
+*/
+
+defined('IN_MOBIQUO') or exit;
+
+function unsubscribe_topic_func($xmlrpc_params)
+{
+    global $db, $user;
+    
+    $user->setup('viewtopic');
+    
+    $params = php_xmlrpc_decode($xmlrpc_params);
+    
+    // get topic id from parameters
+    $topic_id = intval($params[0]);
+    if (!$topic_id) trigger_error('NO_TOPIC');
+    $user_id = $user->data['user_id'];
+    $uns_result = false;
+
+    // Is user login?
+    if ($user_id != ANONYMOUS)
+    {
+        $sql = 'SELECT notify_status
+                FROM ' . TOPICS_WATCH_TABLE . "
+                WHERE topic_id = $topic_id
+                AND user_id = $user_id";
+        $result = $db->sql_query($sql);
+
+        $notify_status = ($row = $db->sql_fetchrow($result)) ? $row['notify_status'] : NULL;
+        $db->sql_freeresult($result);
+
+        if (!is_null($notify_status) && $notify_status !== '')
+        {
+            $sql = 'DELETE FROM ' . TOPICS_WATCH_TABLE . "
+                WHERE topic_id = $topic_id
+                    AND user_id = $user_id";
+            $db->sql_query($sql);
+            $uns_result = true;
+        }
+    }
+    
+    $response = new xmlrpcval(
+        array(
+            'result'        => new xmlrpcval($uns_result, 'boolean'),
+            'result_text'   => new xmlrpcval($uns_result ? '' : 'Unsubscribe failed', 'base64'),
+        ),
+        'struct'
+    );
+    
+    return new xmlrpcresp($response);
+}
diff -ruN phpBB-3.0.10/mobiquo/function/viewtopic.php phpbb/mobiquo/function/viewtopic.php
--- phpBB-3.0.10/mobiquo/function/viewtopic.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/function/viewtopic.php	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,1743 @@
+<?php
+/**
+*
+* @copyright (c) 2009, 2010, 2011 Quoord Systems Limited
+* @license http://opensource.org/licenses/gpl-2.0.php GNU Public License (GPLv2)
+*
+*/
+
+defined('IN_MOBIQUO') or exit;
+
+//include($phpbb_root_path . 'common.' . $phpEx);
+include($phpbb_root_path . 'includes/functions_display.' . $phpEx);
+include($phpbb_root_path . 'includes/bbcode.' . $phpEx);
+
+// Start session management
+//$user->session_begin();
+//$auth->acl($user->data);
+
+// Initial var setup
+$forum_id	= request_var('f', 0);
+$topic_id	= request_var('t', 0);
+$post_id	= request_var('p', 0);
+$voted_id	= request_var('vote_id', array('' => 0));
+
+$voted_id = (sizeof($voted_id) > 1) ? array_unique($voted_id) : $voted_id;
+
+$config['posts_per_page'] = request_var('limit', 20);
+$start		= request_var('start', 0);
+$view		= request_var('view', '');
+
+$default_sort_days	= (!empty($user->data['user_post_show_days'])) ? $user->data['user_post_show_days'] : 0;
+$default_sort_key	= (!empty($user->data['user_post_sortby_type'])) ? $user->data['user_post_sortby_type'] : 't';
+$default_sort_dir	= (!empty($user->data['user_post_sortby_dir'])) ? $user->data['user_post_sortby_dir'] : 'a';
+
+$sort_days	= request_var('st', $default_sort_days);
+$sort_key	= request_var('sk', $default_sort_key);
+$sort_dir	= request_var('sd', $default_sort_dir);
+
+$update		= request_var('update', false);
+
+$s_can_vote = false;
+/**
+* @todo normalize?
+*/
+$hilit_words	= request_var('hilit', '', true);
+
+// Do we have a topic or post id?
+if (!$topic_id && !$post_id)
+{
+	trigger_error('NO_TOPIC');
+}
+
+// Find topic id if user requested a newer or older topic
+if ($view && !$post_id)
+{
+	if (!$forum_id)
+	{
+		$sql = 'SELECT forum_id
+			FROM ' . TOPICS_TABLE . "
+			WHERE topic_id = $topic_id";
+		$result = $db->sql_query($sql);
+		$forum_id = (int) $db->sql_fetchfield('forum_id');
+		$db->sql_freeresult($result);
+
+		if (!$forum_id)
+		{
+			trigger_error('NO_TOPIC');
+		}
+	}
+
+	if ($view == 'unread')
+	{
+		// Get topic tracking info
+		$topic_tracking_info = get_complete_topic_tracking($forum_id, $topic_id);
+
+		$topic_last_read = (isset($topic_tracking_info[$topic_id])) ? $topic_tracking_info[$topic_id] : 0;
+
+		$sql = 'SELECT post_id, topic_id, forum_id
+			FROM ' . POSTS_TABLE . "
+			WHERE topic_id = $topic_id
+				" . (($auth->acl_get('m_approve', $forum_id)) ? '' : 'AND post_approved = 1') . "
+				AND post_time > $topic_last_read
+				AND forum_id = $forum_id
+			ORDER BY post_time ASC";
+		$result = $db->sql_query_limit($sql, 1);
+		$row = $db->sql_fetchrow($result);
+		$db->sql_freeresult($result);
+
+		if (!$row)
+		{
+			$sql = 'SELECT topic_last_post_id as post_id, topic_id, forum_id
+				FROM ' . TOPICS_TABLE . '
+				WHERE topic_id = ' . $topic_id;
+			$result = $db->sql_query($sql);
+			$row = $db->sql_fetchrow($result);
+			$db->sql_freeresult($result);
+		}
+
+		if (!$row)
+		{
+			// Setup user environment so we can process lang string
+			$user->setup('viewtopic');
+
+			trigger_error('NO_TOPIC');
+		}
+
+		$post_id = $row['post_id'];
+		$topic_id = $row['topic_id'];
+	}
+	else if ($view == 'next' || $view == 'previous')
+	{
+		$sql_condition = ($view == 'next') ? '>' : '<';
+		$sql_ordering = ($view == 'next') ? 'ASC' : 'DESC';
+
+		$sql = 'SELECT forum_id, topic_last_post_time
+			FROM ' . TOPICS_TABLE . '
+			WHERE topic_id = ' . $topic_id;
+		$result = $db->sql_query($sql);
+		$row = $db->sql_fetchrow($result);
+		$db->sql_freeresult($result);
+
+		if (!$row)
+		{
+			$user->setup('viewtopic');
+			// OK, the topic doesn't exist. This error message is not helpful, but technically correct.
+			trigger_error(($view == 'next') ? 'NO_NEWER_TOPICS' : 'NO_OLDER_TOPICS');
+		}
+		else
+		{
+			$sql = 'SELECT topic_id, forum_id
+				FROM ' . TOPICS_TABLE . '
+				WHERE forum_id = ' . $row['forum_id'] . "
+					AND topic_moved_id = 0
+					AND topic_last_post_time $sql_condition {$row['topic_last_post_time']}
+					" . (($auth->acl_get('m_approve', $row['forum_id'])) ? '' : 'AND topic_approved = 1') . "
+				ORDER BY topic_last_post_time $sql_ordering";
+			$result = $db->sql_query_limit($sql, 1);
+			$row = $db->sql_fetchrow($result);
+			$db->sql_freeresult($result);
+
+			if (!$row)
+			{
+				$user->setup('viewtopic');
+				trigger_error(($view == 'next') ? 'NO_NEWER_TOPICS' : 'NO_OLDER_TOPICS');
+			}
+			else
+			{
+				$topic_id = $row['topic_id'];
+
+				// Check for global announcement correctness?
+				if (!$row['forum_id'] && !$forum_id)
+				{
+					trigger_error('NO_TOPIC');
+				}
+				else if ($row['forum_id'])
+				{
+					$forum_id = $row['forum_id'];
+				}
+			}
+		}
+	}
+
+	// Check for global announcement correctness?
+	if ((!isset($row) || !$row['forum_id']) && !$forum_id)
+	{
+		trigger_error('NO_TOPIC');
+	}
+	else if (isset($row) && $row['forum_id'])
+	{
+		$forum_id = $row['forum_id'];
+	}
+}
+
+// This rather complex gaggle of code handles querying for topics but
+// also allows for direct linking to a post (and the calculation of which
+// page the post is on and the correct display of viewtopic)
+$sql_array = array(
+	'SELECT'	=> 't.*, f.*',
+
+	'FROM'		=> array(FORUMS_TABLE => 'f'),
+);
+
+// Firebird handles two columns of the same name a little differently, this
+// addresses that by forcing the forum_id to come from the forums table.
+if ($db->sql_layer === 'firebird')
+{
+	$sql_array['SELECT'] = 'f.forum_id AS forum_id, ' . $sql_array['SELECT'];
+}
+
+// The FROM-Order is quite important here, else t.* columns can not be correctly bound.
+if ($post_id)
+{
+	$sql_array['SELECT'] .= ', p.post_approved, p.post_time, p.post_id, p.poster_id';
+	$sql_array['FROM'][POSTS_TABLE] = 'p';
+}
+
+// Topics table need to be the last in the chain
+$sql_array['FROM'][TOPICS_TABLE] = 't';
+
+if ($user->data['is_registered'])
+{
+	$sql_array['SELECT'] .= ', tw.notify_status';
+	$sql_array['LEFT_JOIN'] = array();
+
+	$sql_array['LEFT_JOIN'][] = array(
+		'FROM'	=> array(TOPICS_WATCH_TABLE => 'tw'),
+		'ON'	=> 'tw.user_id = ' . $user->data['user_id'] . ' AND t.topic_id = tw.topic_id'
+	);
+
+	if ($config['allow_bookmarks'])
+	{
+		$sql_array['SELECT'] .= ', bm.topic_id as bookmarked';
+		$sql_array['LEFT_JOIN'][] = array(
+			'FROM'	=> array(BOOKMARKS_TABLE => 'bm'),
+			'ON'	=> 'bm.user_id = ' . $user->data['user_id'] . ' AND t.topic_id = bm.topic_id'
+		);
+	}
+
+	if ($config['load_db_lastread'])
+	{
+		$sql_array['SELECT'] .= ', tt.mark_time, ft.mark_time as forum_mark_time';
+
+		$sql_array['LEFT_JOIN'][] = array(
+			'FROM'	=> array(TOPICS_TRACK_TABLE => 'tt'),
+			'ON'	=> 'tt.user_id = ' . $user->data['user_id'] . ' AND t.topic_id = tt.topic_id'
+		);
+
+		$sql_array['LEFT_JOIN'][] = array(
+			'FROM'	=> array(FORUMS_TRACK_TABLE => 'ft'),
+			'ON'	=> 'ft.user_id = ' . $user->data['user_id'] . ' AND t.forum_id = ft.forum_id'
+		);
+	}
+}
+
+if (!$post_id)
+{
+	$sql_array['WHERE'] = "t.topic_id = $topic_id";
+}
+else
+{
+	$sql_array['WHERE'] = "p.post_id = $post_id AND t.topic_id = p.topic_id";
+}
+
+$sql_array['WHERE'] .= ' AND (f.forum_id = t.forum_id';
+
+if (!$forum_id)
+{
+	// If it is a global announcement make sure to set the forum id to a postable forum
+	$sql_array['WHERE'] .= ' OR (t.topic_type = ' . POST_GLOBAL . '
+		AND f.forum_type = ' . FORUM_POST . ')';
+}
+else
+{
+	$sql_array['WHERE'] .= ' OR (t.topic_type = ' . POST_GLOBAL . "
+		AND f.forum_id = $forum_id)";
+}
+
+$sql_array['WHERE'] .= ')';
+
+// Join to forum table on topic forum_id unless topic forum_id is zero
+// whereupon we join on the forum_id passed as a parameter ... this
+// is done so navigation, forum name, etc. remain consistent with where
+// user clicked to view a global topic
+$sql = $db->sql_build_query('SELECT', $sql_array);
+$result = $db->sql_query($sql);
+$topic_data = $db->sql_fetchrow($result);
+$db->sql_freeresult($result);
+
+// link to unapproved post or incorrect link
+if (!$topic_data)
+{
+	// If post_id was submitted, we try at least to display the topic as a last resort...
+	if ($post_id && $topic_id)
+	{
+		//redirect(append_sid("{$phpbb_root_path}viewtopic.$phpEx", "t=$topic_id" . (($forum_id) ? "&amp;f=$forum_id" : '')));
+	}
+
+	trigger_error('NO_TOPIC');
+}
+
+$forum_id = (int) $topic_data['forum_id'];
+// This is for determining where we are (page)
+if ($post_id)
+{
+	// are we where we are supposed to be?
+	if (!$topic_data['post_approved'] && !$auth->acl_get('m_approve', $topic_data['forum_id']))
+	{
+		// If post_id was submitted, we try at least to display the topic as a last resort...
+		if ($topic_id)
+		{
+			//redirect(append_sid("{$phpbb_root_path}viewtopic.$phpEx", "t=$topic_id" . (($forum_id) ? "&amp;f=$forum_id" : '')));
+		}
+
+		trigger_error('NO_TOPIC');
+	}
+	if ($post_id == $topic_data['topic_first_post_id'] || $post_id == $topic_data['topic_last_post_id'])
+	{
+		$check_sort = ($post_id == $topic_data['topic_first_post_id']) ? 'd' : 'a';
+
+		if ($sort_dir == $check_sort)
+		{
+			$topic_data['prev_posts'] = ($auth->acl_get('m_approve', $forum_id)) ? $topic_data['topic_replies_real'] : $topic_data['topic_replies'];
+		}
+		else
+		{
+			$topic_data['prev_posts'] = 0;
+		}
+	}
+	else
+	{
+		$sql = 'SELECT COUNT(p.post_id) AS prev_posts
+			FROM ' . POSTS_TABLE . " p
+			WHERE p.topic_id = {$topic_data['topic_id']}
+				" . ((!$auth->acl_get('m_approve', $forum_id)) ? 'AND p.post_approved = 1' : '');
+
+		if ($sort_dir == 'd')
+		{
+			$sql .= " AND (p.post_time > {$topic_data['post_time']} OR (p.post_time = {$topic_data['post_time']} AND p.post_id >= {$topic_data['post_id']}))";
+		}
+		else
+		{
+			$sql .= " AND (p.post_time < {$topic_data['post_time']} OR (p.post_time = {$topic_data['post_time']} AND p.post_id <= {$topic_data['post_id']}))";
+		}
+
+		$result = $db->sql_query($sql);
+		$row = $db->sql_fetchrow($result);
+		$db->sql_freeresult($result);
+
+		$topic_data['prev_posts'] = $row['prev_posts'] - 1;
+	}
+}
+
+$topic_id = (int) $topic_data['topic_id'];
+//
+$topic_replies = ($auth->acl_get('m_approve', $forum_id)) ? $topic_data['topic_replies_real'] : $topic_data['topic_replies'];
+
+// Check sticky/announcement time limit
+if (($topic_data['topic_type'] == POST_STICKY || $topic_data['topic_type'] == POST_ANNOUNCE) && $topic_data['topic_time_limit'] && ($topic_data['topic_time'] + $topic_data['topic_time_limit']) < time())
+{
+	$sql = 'UPDATE ' . TOPICS_TABLE . '
+		SET topic_type = ' . POST_NORMAL . ', topic_time_limit = 0
+		WHERE topic_id = ' . $topic_id;
+	$db->sql_query($sql);
+
+	$topic_data['topic_type'] = POST_NORMAL;
+	$topic_data['topic_time_limit'] = 0;
+}
+
+// Setup look and feel
+$user->setup('viewtopic', $topic_data['forum_style']);
+
+if (!$topic_data['topic_approved'] && !$auth->acl_get('m_approve', $forum_id))
+{
+	trigger_error('NO_TOPIC');
+}
+
+// Start auth check
+if (!$auth->acl_get('f_read', $forum_id))
+{
+	if ($user->data['user_id'] != ANONYMOUS)
+	{
+		trigger_error('SORRY_AUTH_READ');
+	}
+    
+    trigger_error('LOGIN_VIEWFORUM');
+	//login_box('', $user->lang['LOGIN_VIEWFORUM']);
+}
+
+// Forum is passworded ... check whether access has been granted to this
+// user this session, if not show login box
+if ($topic_data['forum_password'] && !check_forum_password($forum_id))
+{
+    trigger_error('LOGIN_FORUM');
+	//login_forum_box($topic_data);
+}
+
+/*
+// Redirect to login or to the correct post upon emailed notification links
+if (isset($_GET['e']))
+{
+	$jump_to = request_var('e', 0);
+
+	$redirect_url = append_sid("{$phpbb_root_path}viewtopic.$phpEx", "f=$forum_id&amp;t=$topic_id");
+
+	if ($user->data['user_id'] == ANONYMOUS)
+	{
+	    trigger_error('LOGIN_NOTIFY_TOPIC');
+		//login_box($redirect_url . "&amp;p=$post_id&amp;e=$jump_to", $user->lang['LOGIN_NOTIFY_TOPIC']);
+	}
+
+	if ($jump_to > 0)
+	{
+		// We direct the already logged in user to the correct post...
+		//redirect($redirect_url . ((!$post_id) ? "&amp;p=$jump_to" : "&amp;p=$post_id") . "#p$jump_to");
+	}
+}
+*/
+
+// What is start equal to?
+if ($post_id)
+{
+	$start = floor(($topic_data['prev_posts']) / $config['posts_per_page']) * $config['posts_per_page'];
+}
+
+// Get topic tracking info
+if (!isset($topic_tracking_info))
+{
+	$topic_tracking_info = array();
+
+	// Get topic tracking info
+	if ($config['load_db_lastread'] && $user->data['is_registered'])
+	{
+		$tmp_topic_data = array($topic_id => $topic_data);
+		$topic_tracking_info = get_topic_tracking($forum_id, $topic_id, $tmp_topic_data, array($forum_id => $topic_data['forum_mark_time']));
+		unset($tmp_topic_data);
+	}
+	else if ($config['load_anon_lastread'] || $user->data['is_registered'])
+	{
+		$topic_tracking_info = get_complete_topic_tracking($forum_id, $topic_id);
+	}
+}
+
+// Post ordering options
+$limit_days = array(0 => $user->lang['ALL_POSTS'], 1 => $user->lang['1_DAY'], 7 => $user->lang['7_DAYS'], 14 => $user->lang['2_WEEKS'], 30 => $user->lang['1_MONTH'], 90 => $user->lang['3_MONTHS'], 180 => $user->lang['6_MONTHS'], 365 => $user->lang['1_YEAR']);
+
+$sort_by_text = array('a' => $user->lang['AUTHOR'], 't' => $user->lang['POST_TIME'], 's' => $user->lang['SUBJECT']);
+$sort_by_sql = array('a' => array('u.username_clean', 'p.post_id'), 't' => 'p.post_time', 's' => array('p.post_subject', 'p.post_id'));
+$join_user_sql = array('a' => true, 't' => false, 's' => false);
+
+$s_limit_days = $s_sort_key = $s_sort_dir = $u_sort_param = '';
+
+gen_sort_selects($limit_days, $sort_by_text, $sort_days, $sort_key, $sort_dir, $s_limit_days, $s_sort_key, $s_sort_dir, $u_sort_param, $default_sort_days, $default_sort_key, $default_sort_dir);
+
+// Obtain correct post count and ordering SQL if user has
+// requested anything different
+if ($sort_days)
+{
+	$min_post_time = time() - ($sort_days * 86400);
+
+	$sql = 'SELECT COUNT(post_id) AS num_posts
+		FROM ' . POSTS_TABLE . "
+		WHERE topic_id = $topic_id
+			AND post_time >= $min_post_time
+		" . (($auth->acl_get('m_approve', $forum_id)) ? '' : 'AND post_approved = 1');
+	$result = $db->sql_query($sql);
+	$total_posts = (int) $db->sql_fetchfield('num_posts');
+	$db->sql_freeresult($result);
+
+	$limit_posts_time = "AND p.post_time >= $min_post_time ";
+
+	if (isset($_POST['sort']))
+	{
+		$start = 0;
+	}
+}
+else
+{
+	$total_posts = $topic_replies + 1;
+	$limit_posts_time = '';
+}
+
+// Was a highlight request part of the URI?
+$highlight_match = $highlight = '';
+if ($hilit_words)
+{
+	foreach (explode(' ', trim($hilit_words)) as $word)
+	{
+		if (trim($word))
+		{
+			$word = str_replace('\*', '\w+?', preg_quote($word, '#'));
+			$word = preg_replace('#(^|\s)\\\\w\*\?(\s|$)#', '$1\w+?$2', $word);
+			$highlight_match .= (($highlight_match != '') ? '|' : '') . $word;
+		}
+	}
+
+	$highlight = urlencode($hilit_words);
+}
+
+// Make sure $start is set to the last page if it exceeds the amount
+if ($start < 0 || $start >= $total_posts)
+{
+	$start = ($start < 0) ? 0 : floor(($total_posts - 1) / $config['posts_per_page']) * $config['posts_per_page'];
+}
+
+// General Viewtopic URL for return links
+$viewtopic_url = append_sid("{$phpbb_root_path}viewtopic.$phpEx", "f=$forum_id&amp;t=$topic_id" . (($start == 0) ? '' : "&amp;start=$start") . ((strlen($u_sort_param)) ? "&amp;$u_sort_param" : '') . (($highlight_match) ? "&amp;hilit=$highlight" : ''));
+
+// Are we watching this topic?
+$s_watching_topic = array(
+	'link'			=> '',
+	'title'			=> '',
+	'is_watching'	=> false,
+);
+
+if (($config['email_enable'] || $config['jab_enable']) && $config['allow_topic_notify'])
+{
+	$notify_status = (isset($topic_data['notify_status'])) ? $topic_data['notify_status'] : null;
+	watch_topic_forum('topic', $s_watching_topic, $user->data['user_id'], $forum_id, $topic_id, $notify_status, $start, $topic_data['topic_title']);
+
+	// Reset forum notification if forum notify is set
+	if ($config['allow_forum_notify'] && $auth->acl_get('f_subscribe', $forum_id))
+	{
+		$s_watching_forum = $s_watching_topic;
+		watch_topic_forum('forum', $s_watching_forum, $user->data['user_id'], $forum_id, 0);
+	}
+}
+
+/*
+// Bookmarks
+if ($config['allow_bookmarks'] && $user->data['is_registered'] && request_var('bookmark', 0))
+{
+	if (check_link_hash(request_var('hash', ''), "topic_$topic_id"))
+	{
+		if (!$topic_data['bookmarked'])
+		{
+			$sql = 'INSERT INTO ' . BOOKMARKS_TABLE . ' ' . $db->sql_build_array('INSERT', array(
+				'user_id'	=> $user->data['user_id'],
+				'topic_id'	=> $topic_id,
+			));
+			$db->sql_query($sql);
+		}
+		else
+		{
+			$sql = 'DELETE FROM ' . BOOKMARKS_TABLE . "
+				WHERE user_id = {$user->data['user_id']}
+					AND topic_id = $topic_id";
+			$db->sql_query($sql);
+		}
+		$message = (($topic_data['bookmarked']) ? $user->lang['BOOKMARK_REMOVED'] : $user->lang['BOOKMARK_ADDED']) . '<br /><br />' . sprintf($user->lang['RETURN_TOPIC'], '<a href="' . $viewtopic_url . '">', '</a>');
+	}
+	else
+	{
+		$message = $user->lang['BOOKMARK_ERR'] . '<br /><br />' . sprintf($user->lang['RETURN_TOPIC'], '<a href="' . $viewtopic_url . '">', '</a>');
+	}
+	meta_refresh(3, $viewtopic_url);
+
+	trigger_error($message);
+}
+
+
+// Grab ranks
+$ranks = $cache->obtain_ranks();
+
+// Grab icons
+$icons = $cache->obtain_icons();
+
+// Grab extensions
+$extensions = array();
+if ($topic_data['topic_attachment'])
+{
+	$extensions = $cache->obtain_attach_extensions($forum_id);
+}
+
+// Forum rules listing
+$s_forum_rules = '';
+gen_forum_auth_level('topic', $forum_id, $topic_data['forum_status']);
+
+// Quick mod tools
+$allow_change_type = ($auth->acl_get('m_', $forum_id) || ($user->data['is_registered'] && $user->data['user_id'] == $topic_data['topic_poster'])) ? true : false;
+
+$topic_mod = '';
+$topic_mod .= ($auth->acl_get('m_lock', $forum_id) || ($auth->acl_get('f_user_lock', $forum_id) && $user->data['is_registered'] && $user->data['user_id'] == $topic_data['topic_poster'] && $topic_data['topic_status'] == ITEM_UNLOCKED)) ? (($topic_data['topic_status'] == ITEM_UNLOCKED) ? '<option value="lock">' . $user->lang['LOCK_TOPIC'] . '</option>' : '<option value="unlock">' . $user->lang['UNLOCK_TOPIC'] . '</option>') : '';
+$topic_mod .= ($auth->acl_get('m_delete', $forum_id)) ? '<option value="delete_topic">' . $user->lang['DELETE_TOPIC'] . '</option>' : '';
+$topic_mod .= ($auth->acl_get('m_move', $forum_id) && $topic_data['topic_status'] != ITEM_MOVED) ? '<option value="move">' . $user->lang['MOVE_TOPIC'] . '</option>' : '';
+$topic_mod .= ($auth->acl_get('m_split', $forum_id)) ? '<option value="split">' . $user->lang['SPLIT_TOPIC'] . '</option>' : '';
+$topic_mod .= ($auth->acl_get('m_merge', $forum_id)) ? '<option value="merge">' . $user->lang['MERGE_POSTS'] . '</option>' : '';
+$topic_mod .= ($auth->acl_get('m_merge', $forum_id)) ? '<option value="merge_topic">' . $user->lang['MERGE_TOPIC'] . '</option>' : '';
+$topic_mod .= ($auth->acl_get('m_move', $forum_id)) ? '<option value="fork">' . $user->lang['FORK_TOPIC'] . '</option>' : '';
+$topic_mod .= ($allow_change_type && $auth->acl_gets('f_sticky', 'f_announce', $forum_id) && $topic_data['topic_type'] != POST_NORMAL) ? '<option value="make_normal">' . $user->lang['MAKE_NORMAL'] . '</option>' : '';
+$topic_mod .= ($allow_change_type && $auth->acl_get('f_sticky', $forum_id) && $topic_data['topic_type'] != POST_STICKY) ? '<option value="make_sticky">' . $user->lang['MAKE_STICKY'] . '</option>' : '';
+$topic_mod .= ($allow_change_type && $auth->acl_get('f_announce', $forum_id) && $topic_data['topic_type'] != POST_ANNOUNCE) ? '<option value="make_announce">' . $user->lang['MAKE_ANNOUNCE'] . '</option>' : '';
+$topic_mod .= ($allow_change_type && $auth->acl_get('f_announce', $forum_id) && $topic_data['topic_type'] != POST_GLOBAL) ? '<option value="make_global">' . $user->lang['MAKE_GLOBAL'] . '</option>' : '';
+$topic_mod .= ($auth->acl_get('m_', $forum_id)) ? '<option value="topic_logs">' . $user->lang['VIEW_TOPIC_LOGS'] . '</option>' : '';
+
+// If we've got a hightlight set pass it on to pagination.
+$pagination = generate_pagination(append_sid("{$phpbb_root_path}viewtopic.$phpEx", "f=$forum_id&amp;t=$topic_id" . ((strlen($u_sort_param)) ? "&amp;$u_sort_param" : '') . (($highlight_match) ? "&amp;hilit=$highlight" : '')), $total_posts, $config['posts_per_page'], $start);
+
+// Navigation links
+generate_forum_nav($topic_data);
+
+// Forum Rules
+generate_forum_rules($topic_data);
+
+// Moderators
+$forum_moderators = array();
+if ($config['load_moderators'])
+{
+	get_moderators($forum_moderators, $forum_id);
+}
+
+// This is only used for print view so ...
+$server_path = (!$view) ? $phpbb_root_path : generate_board_url() . '/';
+
+// Replace naughty words in title
+$topic_data['topic_title'] = censor_text($topic_data['topic_title']);
+
+$s_search_hidden_fields = array(
+	't' => $topic_id,
+	'sf' => 'msgonly',
+);
+if ($_SID)
+{
+	$s_search_hidden_fields['sid'] = $_SID;
+}
+
+if (!empty($_EXTRA_URL))
+{
+	foreach ($_EXTRA_URL as $url_param)
+	{
+		$url_param = explode('=', $url_param, 2);
+		$s_hidden_fields[$url_param[0]] = $url_param[1];
+	}
+}
+
+// Send vars to template
+$template->assign_vars(array(
+	'FORUM_ID' 		=> $forum_id,
+	'FORUM_NAME' 	=> $topic_data['forum_name'],
+	'FORUM_DESC'	=> generate_text_for_display($topic_data['forum_desc'], $topic_data['forum_desc_uid'], $topic_data['forum_desc_bitfield'], $topic_data['forum_desc_options']),
+	'TOPIC_ID' 		=> $topic_id,
+	'TOPIC_TITLE' 	=> $topic_data['topic_title'],
+	'TOPIC_POSTER'	=> $topic_data['topic_poster'],
+
+	'TOPIC_AUTHOR_FULL'		=> get_username_string('full', $topic_data['topic_poster'], $topic_data['topic_first_poster_name'], $topic_data['topic_first_poster_colour']),
+	'TOPIC_AUTHOR_COLOUR'	=> get_username_string('colour', $topic_data['topic_poster'], $topic_data['topic_first_poster_name'], $topic_data['topic_first_poster_colour']),
+	'TOPIC_AUTHOR'			=> get_username_string('username', $topic_data['topic_poster'], $topic_data['topic_first_poster_name'], $topic_data['topic_first_poster_colour']),
+
+	//'PAGINATION' 	=> $pagination,
+	'PAGE_NUMBER' 	=> on_page($total_posts, $config['posts_per_page'], $start),
+	'TOTAL_POSTS'	=> ($total_posts == 1) ? $user->lang['VIEW_TOPIC_POST'] : sprintf($user->lang['VIEW_TOPIC_POSTS'], $total_posts),
+	'U_MCP' 		=> ($auth->acl_get('m_', $forum_id)) ? append_sid("{$phpbb_root_path}mcp.$phpEx", "i=main&amp;mode=topic_view&amp;f=$forum_id&amp;t=$topic_id" . (($start == 0) ? '' : "&amp;start=$start") . ((strlen($u_sort_param)) ? "&amp;$u_sort_param" : ''), true, $user->session_id) : '',
+	'MODERATORS'	=> (isset($forum_moderators[$forum_id]) && sizeof($forum_moderators[$forum_id])) ? implode(', ', $forum_moderators[$forum_id]) : '',
+
+	'POST_IMG' 			=> ($topic_data['forum_status'] == ITEM_LOCKED) ? $user->img('button_topic_locked', 'FORUM_LOCKED') : $user->img('button_topic_new', 'POST_NEW_TOPIC'),
+	'QUOTE_IMG' 		=> $user->img('icon_post_quote', 'REPLY_WITH_QUOTE'),
+	'REPLY_IMG'			=> ($topic_data['forum_status'] == ITEM_LOCKED || $topic_data['topic_status'] == ITEM_LOCKED) ? $user->img('button_topic_locked', 'TOPIC_LOCKED') : $user->img('button_topic_reply', 'REPLY_TO_TOPIC'),
+	'EDIT_IMG' 			=> $user->img('icon_post_edit', 'EDIT_POST'),
+	'DELETE_IMG' 		=> $user->img('icon_post_delete', 'DELETE_POST'),
+	'INFO_IMG' 			=> $user->img('icon_post_info', 'VIEW_INFO'),
+	'PROFILE_IMG'		=> $user->img('icon_user_profile', 'READ_PROFILE'),
+	'SEARCH_IMG' 		=> $user->img('icon_user_search', 'SEARCH_USER_POSTS'),
+	'PM_IMG' 			=> $user->img('icon_contact_pm', 'SEND_PRIVATE_MESSAGE'),
+	'EMAIL_IMG' 		=> $user->img('icon_contact_email', 'SEND_EMAIL'),
+	'WWW_IMG' 			=> $user->img('icon_contact_www', 'VISIT_WEBSITE'),
+	'ICQ_IMG' 			=> $user->img('icon_contact_icq', 'ICQ'),
+	'AIM_IMG' 			=> $user->img('icon_contact_aim', 'AIM'),
+	'MSN_IMG' 			=> $user->img('icon_contact_msnm', 'MSNM'),
+	'YIM_IMG' 			=> $user->img('icon_contact_yahoo', 'YIM'),
+	'JABBER_IMG'		=> $user->img('icon_contact_jabber', 'JABBER') ,
+	'REPORT_IMG'		=> $user->img('icon_post_report', 'REPORT_POST'),
+	'REPORTED_IMG'		=> $user->img('icon_topic_reported', 'POST_REPORTED'),
+	'UNAPPROVED_IMG'	=> $user->img('icon_topic_unapproved', 'POST_UNAPPROVED'),
+	'WARN_IMG'			=> $user->img('icon_user_warn', 'WARN_USER'),
+
+	'S_IS_LOCKED'			=> ($topic_data['topic_status'] == ITEM_UNLOCKED && $topic_data['forum_status'] == ITEM_UNLOCKED) ? false : true,
+	'S_SELECT_SORT_DIR' 	=> $s_sort_dir,
+	'S_SELECT_SORT_KEY' 	=> $s_sort_key,
+	'S_SELECT_SORT_DAYS' 	=> $s_limit_days,
+	'S_SINGLE_MODERATOR'	=> (!empty($forum_moderators[$forum_id]) && sizeof($forum_moderators[$forum_id]) > 1) ? false : true,
+	'S_TOPIC_ACTION' 		=> append_sid("{$phpbb_root_path}viewtopic.$phpEx", "f=$forum_id&amp;t=$topic_id" . (($start == 0) ? '' : "&amp;start=$start")),
+	'S_TOPIC_MOD' 			=> ($topic_mod != '') ? '<select name="action" id="quick-mod-select">' . $topic_mod . '</select>' : '',
+	'S_MOD_ACTION' 			=> append_sid("{$phpbb_root_path}mcp.$phpEx", "f=$forum_id&amp;t=$topic_id" . (($start == 0) ? '' : "&amp;start=$start") . "&amp;quickmod=1&amp;redirect=" . urlencode(str_replace('&amp;', '&', $viewtopic_url)), true, $user->session_id),
+
+	'S_VIEWTOPIC'			=> true,
+	'S_DISPLAY_SEARCHBOX'	=> ($auth->acl_get('u_search') && $auth->acl_get('f_search', $forum_id) && $config['load_search']) ? true : false,
+	'S_SEARCHBOX_ACTION'	=> append_sid("{$phpbb_root_path}search.$phpEx"),
+	'S_SEARCH_LOCAL_HIDDEN_FIELDS'	=> build_hidden_fields($s_search_hidden_fields),
+
+	'S_DISPLAY_POST_INFO'	=> ($topic_data['forum_type'] == FORUM_POST && ($auth->acl_get('f_post', $forum_id) || $user->data['user_id'] == ANONYMOUS)) ? true : false,
+	'S_DISPLAY_REPLY_INFO'	=> ($topic_data['forum_type'] == FORUM_POST && ($auth->acl_get('f_reply', $forum_id) || $user->data['user_id'] == ANONYMOUS)) ? true : false,
+	'S_ENABLE_FEEDS_TOPIC'	=> ($config['feed_topic'] && !phpbb_optionget(FORUM_OPTION_FEED_EXCLUDE, $topic_data['forum_options'])) ? true : false,
+
+	'U_TOPIC'				=> "{$server_path}viewtopic.$phpEx?f=$forum_id&amp;t=$topic_id",
+	'U_FORUM'				=> $server_path,
+	'U_VIEW_TOPIC' 			=> $viewtopic_url,
+	'U_VIEW_FORUM' 			=> append_sid("{$phpbb_root_path}viewforum.$phpEx", 'f=' . $forum_id),
+	'U_VIEW_OLDER_TOPIC'	=> append_sid("{$phpbb_root_path}viewtopic.$phpEx", "f=$forum_id&amp;t=$topic_id&amp;view=previous"),
+	'U_VIEW_NEWER_TOPIC'	=> append_sid("{$phpbb_root_path}viewtopic.$phpEx", "f=$forum_id&amp;t=$topic_id&amp;view=next"),
+	'U_PRINT_TOPIC'			=> ($auth->acl_get('f_print', $forum_id)) ? $viewtopic_url . '&amp;view=print' : '',
+	'U_EMAIL_TOPIC'			=> ($auth->acl_get('f_email', $forum_id) && $config['email_enable']) ? append_sid("{$phpbb_root_path}memberlist.$phpEx", "mode=email&amp;t=$topic_id") : '',
+
+	'U_WATCH_TOPIC' 		=> $s_watching_topic['link'],
+	'L_WATCH_TOPIC' 		=> $s_watching_topic['title'],
+	'S_WATCHING_TOPIC'		=> $s_watching_topic['is_watching'],
+
+	'U_BOOKMARK_TOPIC'		=> ($user->data['is_registered'] && $config['allow_bookmarks']) ? $viewtopic_url . '&amp;bookmark=1&amp;hash=' . generate_link_hash("topic_$topic_id") : '',
+	'L_BOOKMARK_TOPIC'		=> ($user->data['is_registered'] && $config['allow_bookmarks'] && $topic_data['bookmarked']) ? $user->lang['BOOKMARK_TOPIC_REMOVE'] : $user->lang['BOOKMARK_TOPIC'],
+
+	'U_POST_NEW_TOPIC' 		=> ($auth->acl_get('f_post', $forum_id) || $user->data['user_id'] == ANONYMOUS) ? append_sid("{$phpbb_root_path}posting.$phpEx", "mode=post&amp;f=$forum_id") : '',
+	'U_POST_REPLY_TOPIC' 	=> ($auth->acl_get('f_reply', $forum_id) || $user->data['user_id'] == ANONYMOUS) ? append_sid("{$phpbb_root_path}posting.$phpEx", "mode=reply&amp;f=$forum_id&amp;t=$topic_id") : '',
+	'U_BUMP_TOPIC'			=> (bump_topic_allowed($forum_id, $topic_data['topic_bumped'], $topic_data['topic_last_post_time'], $topic_data['topic_poster'], $topic_data['topic_last_poster_id'])) ? append_sid("{$phpbb_root_path}posting.$phpEx", "mode=bump&amp;f=$forum_id&amp;t=$topic_id&amp;hash=" . generate_link_hash("topic_$topic_id")) : '')
+);
+
+// Does this topic contain a poll?
+if (!empty($topic_data['poll_start']))
+{
+	$sql = 'SELECT o.*, p.bbcode_bitfield, p.bbcode_uid
+		FROM ' . POLL_OPTIONS_TABLE . ' o, ' . POSTS_TABLE . " p
+		WHERE o.topic_id = $topic_id
+			AND p.post_id = {$topic_data['topic_first_post_id']}
+			AND p.topic_id = o.topic_id
+		ORDER BY o.poll_option_id";
+	$result = $db->sql_query($sql);
+
+	$poll_info = array();
+	while ($row = $db->sql_fetchrow($result))
+	{
+		$poll_info[] = $row;
+	}
+	$db->sql_freeresult($result);
+
+	$cur_voted_id = array();
+	if ($user->data['is_registered'])
+	{
+		$sql = 'SELECT poll_option_id
+			FROM ' . POLL_VOTES_TABLE . '
+			WHERE topic_id = ' . $topic_id . '
+				AND vote_user_id = ' . $user->data['user_id'];
+		$result = $db->sql_query($sql);
+
+		while ($row = $db->sql_fetchrow($result))
+		{
+			$cur_voted_id[] = $row['poll_option_id'];
+		}
+		$db->sql_freeresult($result);
+	}
+	else
+	{
+		// Cookie based guest tracking ... I don't like this but hum ho
+		// it's oft requested. This relies on "nice" users who don't feel
+		// the need to delete cookies to mess with results.
+		if (isset($_COOKIE[$config['cookie_name'] . '_poll_' . $topic_id]))
+		{
+			$cur_voted_id = explode(',', $_COOKIE[$config['cookie_name'] . '_poll_' . $topic_id]);
+			$cur_voted_id = array_map('intval', $cur_voted_id);
+		}
+	}
+
+	// Can not vote at all if no vote permission
+	$s_can_vote = ($auth->acl_get('f_vote', $forum_id) &&
+		(($topic_data['poll_length'] != 0 && $topic_data['poll_start'] + $topic_data['poll_length'] > time()) || $topic_data['poll_length'] == 0) &&
+		$topic_data['topic_status'] != ITEM_LOCKED &&
+		$topic_data['forum_status'] != ITEM_LOCKED &&
+		(!sizeof($cur_voted_id) ||
+		($auth->acl_get('f_votechg', $forum_id) && $topic_data['poll_vote_change']))) ? true : false;
+	$s_display_results = (!$s_can_vote || ($s_can_vote && sizeof($cur_voted_id)) || $view == 'viewpoll') ? true : false;
+
+	if ($update && $s_can_vote)
+	{
+
+		if (!sizeof($voted_id) || sizeof($voted_id) > $topic_data['poll_max_options'] || in_array(VOTE_CONVERTED, $cur_voted_id) || !check_form_key('posting'))
+		{
+			$redirect_url = append_sid("{$phpbb_root_path}viewtopic.$phpEx", "f=$forum_id&amp;t=$topic_id" . (($start == 0) ? '' : "&amp;start=$start"));
+
+			meta_refresh(5, $redirect_url);
+			if (!sizeof($voted_id))
+			{
+				$message = 'NO_VOTE_OPTION';
+			}
+			else if (sizeof($voted_id) > $topic_data['poll_max_options'])
+			{
+				$message = 'TOO_MANY_VOTE_OPTIONS';
+			}
+			else if (in_array(VOTE_CONVERTED, $cur_voted_id))
+			{
+				$message = 'VOTE_CONVERTED';
+			}
+			else
+			{
+				$message = 'FORM_INVALID';
+			}
+
+			//$message = $user->lang[$message] . '<br /><br />' . sprintf($user->lang['RETURN_TOPIC'], '<a href="' . $redirect_url . '">', '</a>');
+			trigger_error($message);
+		}
+
+		foreach ($voted_id as $option)
+		{
+			if (in_array($option, $cur_voted_id))
+			{
+				continue;
+			}
+
+			$sql = 'UPDATE ' . POLL_OPTIONS_TABLE . '
+				SET poll_option_total = poll_option_total + 1
+				WHERE poll_option_id = ' . (int) $option . '
+					AND topic_id = ' . (int) $topic_id;
+			$db->sql_query($sql);
+
+			if ($user->data['is_registered'])
+			{
+				$sql_ary = array(
+					'topic_id'			=> (int) $topic_id,
+					'poll_option_id'	=> (int) $option,
+					'vote_user_id'		=> (int) $user->data['user_id'],
+					'vote_user_ip'		=> (string) $user->ip,
+				);
+
+				$sql = 'INSERT INTO ' . POLL_VOTES_TABLE . ' ' . $db->sql_build_array('INSERT', $sql_ary);
+				$db->sql_query($sql);
+			}
+		}
+
+		foreach ($cur_voted_id as $option)
+		{
+			if (!in_array($option, $voted_id))
+			{
+				$sql = 'UPDATE ' . POLL_OPTIONS_TABLE . '
+					SET poll_option_total = poll_option_total - 1
+					WHERE poll_option_id = ' . (int) $option . '
+						AND topic_id = ' . (int) $topic_id;
+				$db->sql_query($sql);
+
+				if ($user->data['is_registered'])
+				{
+					$sql = 'DELETE FROM ' . POLL_VOTES_TABLE . '
+						WHERE topic_id = ' . (int) $topic_id . '
+							AND poll_option_id = ' . (int) $option . '
+							AND vote_user_id = ' . (int) $user->data['user_id'];
+					$db->sql_query($sql);
+				}
+			}
+		}
+
+		if ($user->data['user_id'] == ANONYMOUS && !$user->data['is_bot'])
+		{
+			$user->set_cookie('poll_' . $topic_id, implode(',', $voted_id), time() + 31536000);
+		}
+
+		$sql = 'UPDATE ' . TOPICS_TABLE . '
+			SET poll_last_vote = ' . time() . "
+			WHERE topic_id = $topic_id";
+		//, topic_last_post_time = ' . time() . " -- for bumping topics with new votes, ignore for now
+		$db->sql_query($sql);
+
+		$redirect_url = append_sid("{$phpbb_root_path}viewtopic.$phpEx", "f=$forum_id&amp;t=$topic_id" . (($start == 0) ? '' : "&amp;start=$start"));
+
+		meta_refresh(5, $redirect_url);
+		trigger_error($user->lang['VOTE_SUBMITTED']);
+		//trigger_error($user->lang['VOTE_SUBMITTED'] . '<br /><br />' . sprintf($user->lang['RETURN_TOPIC'], '<a href="' . $redirect_url . '">', '</a>'));
+	}
+
+	$poll_total = 0;
+	foreach ($poll_info as $poll_option)
+	{
+		$poll_total += $poll_option['poll_option_total'];
+	}
+
+	if ($poll_info[0]['bbcode_bitfield'])
+	{
+		$poll_bbcode = new bbcode();
+	}
+	else
+	{
+		$poll_bbcode = false;
+	}
+
+	for ($i = 0, $size = sizeof($poll_info); $i < $size; $i++)
+	{
+		$poll_info[$i]['poll_option_text'] = censor_text($poll_info[$i]['poll_option_text']);
+
+		if ($poll_bbcode !== false)
+		{
+			$poll_bbcode->bbcode_second_pass($poll_info[$i]['poll_option_text'], $poll_info[$i]['bbcode_uid'], $poll_option['bbcode_bitfield']);
+		}
+
+		$poll_info[$i]['poll_option_text'] = bbcode_nl2br($poll_info[$i]['poll_option_text']);
+		$poll_info[$i]['poll_option_text'] = smiley_text($poll_info[$i]['poll_option_text']);
+	}
+
+	$topic_data['poll_title'] = censor_text($topic_data['poll_title']);
+
+	if ($poll_bbcode !== false)
+	{
+		$poll_bbcode->bbcode_second_pass($topic_data['poll_title'], $poll_info[0]['bbcode_uid'], $poll_info[0]['bbcode_bitfield']);
+	}
+
+	$topic_data['poll_title'] = bbcode_nl2br($topic_data['poll_title']);
+	$topic_data['poll_title'] = smiley_text($topic_data['poll_title']);
+
+	unset($poll_bbcode);
+
+	foreach ($poll_info as $poll_option)
+	{
+		$option_pct = ($poll_total > 0) ? $poll_option['poll_option_total'] / $poll_total : 0;
+		$option_pct_txt = sprintf("%.1d%%", round($option_pct * 100));
+
+		$template->assign_block_vars('poll_option', array(
+			'POLL_OPTION_ID' 		=> $poll_option['poll_option_id'],
+			'POLL_OPTION_CAPTION' 	=> $poll_option['poll_option_text'],
+			'POLL_OPTION_RESULT' 	=> $poll_option['poll_option_total'],
+			'POLL_OPTION_PERCENT' 	=> $option_pct_txt,
+			'POLL_OPTION_PCT'		=> round($option_pct * 100),
+			'POLL_OPTION_IMG' 		=> $user->img('poll_center', $option_pct_txt, round($option_pct * 250)),
+			'POLL_OPTION_VOTED'		=> (in_array($poll_option['poll_option_id'], $cur_voted_id)) ? true : false)
+		);
+	}
+
+	$poll_end = $topic_data['poll_length'] + $topic_data['poll_start'];
+
+	$template->assign_vars(array(
+		'POLL_QUESTION'		=> $topic_data['poll_title'],
+		'TOTAL_VOTES' 		=> $poll_total,
+		'POLL_LEFT_CAP_IMG'	=> $user->img('poll_left'),
+		'POLL_RIGHT_CAP_IMG'=> $user->img('poll_right'),
+
+		'L_MAX_VOTES'		=> ($topic_data['poll_max_options'] == 1) ? $user->lang['MAX_OPTION_SELECT'] : sprintf($user->lang['MAX_OPTIONS_SELECT'], $topic_data['poll_max_options']),
+		'L_POLL_LENGTH'		=> ($topic_data['poll_length']) ? sprintf($user->lang[($poll_end > time()) ? 'POLL_RUN_TILL' : 'POLL_ENDED_AT'], $user->format_date($poll_end)) : '',
+
+		'S_HAS_POLL'		=> true,
+		'S_CAN_VOTE'		=> $s_can_vote,
+		'S_DISPLAY_RESULTS'	=> $s_display_results,
+		'S_IS_MULTI_CHOICE'	=> ($topic_data['poll_max_options'] > 1) ? true : false,
+		'S_POLL_ACTION'		=> $viewtopic_url,
+
+		'U_VIEW_RESULTS'	=> $viewtopic_url . '&amp;view=viewpoll')
+	);
+
+	unset($poll_end, $poll_info, $voted_id);
+}
+*/
+
+// If the user is trying to reach the second half of the topic, fetch it starting from the end
+$store_reverse = false;
+$sql_limit = $config['posts_per_page'];
+$sql_sort_order = $direction = '';
+
+if ($start > $total_posts / 2)
+{
+	$store_reverse = true;
+
+	if ($start + $config['posts_per_page'] > $total_posts)
+	{
+		$sql_limit = min($config['posts_per_page'], max(1, $total_posts - $start));
+	}
+
+	// Select the sort order
+	$direction = (($sort_dir == 'd') ? 'ASC' : 'DESC');
+	$sql_start = max(0, $total_posts - $sql_limit - $start);
+}
+else
+{
+	// Select the sort order
+	$direction = (($sort_dir == 'd') ? 'DESC' : 'ASC');
+	$sql_start = $start;
+}
+
+if (is_array($sort_by_sql[$sort_key]))
+{
+	$sql_sort_order = implode(' ' . $direction . ', ', $sort_by_sql[$sort_key]) . ' ' . $direction;
+}
+else
+{
+	$sql_sort_order = $sort_by_sql[$sort_key] . ' ' . $direction;
+}
+
+// Container for user details, only process once
+$post_list = $user_cache = $id_cache = $attachments = $attach_list = $rowset = $update_count = $post_edit_list = array();
+$has_attachments = $display_notice = false;
+$bbcode_bitfield = '';
+$i = $i_total = 0;
+
+// Go ahead and pull all data for this topic
+$sql = 'SELECT p.post_id
+	FROM ' . POSTS_TABLE . ' p' . (($join_user_sql[$sort_key]) ? ', ' . USERS_TABLE . ' u': '') . "
+	WHERE p.topic_id = $topic_id
+		" . ((!$auth->acl_get('m_approve', $forum_id)) ? 'AND p.post_approved = 1' : '') . "
+		" . (($join_user_sql[$sort_key]) ? 'AND u.user_id = p.poster_id': '') . "
+		$limit_posts_time
+	ORDER BY $sql_sort_order";
+$result = $db->sql_query_limit($sql, $sql_limit, $sql_start);
+
+$i = ($store_reverse) ? $sql_limit - 1 : 0;
+while ($row = $db->sql_fetchrow($result))
+{
+	$post_list[$i] = (int) $row['post_id'];
+	($store_reverse) ? $i-- : $i++;
+}
+$db->sql_freeresult($result);
+
+if (!sizeof($post_list))
+{
+	if ($sort_days)
+	{
+		trigger_error('NO_POSTS_TIME_FRAME');
+	}
+	else
+	{
+		trigger_error('NO_TOPIC');
+	}
+}
+
+// Holding maximum post time for marking topic read
+// We need to grab it because we do reverse ordering sometimes
+$max_post_time = 0;
+
+$sql = $db->sql_build_query('SELECT', array(
+	'SELECT'	=> 'u.*, z.friend, z.foe, p.*',
+
+	'FROM'		=> array(
+		USERS_TABLE		=> 'u',
+		POSTS_TABLE		=> 'p',
+	),
+
+	'LEFT_JOIN'	=> array(
+		array(
+			'FROM'	=> array(ZEBRA_TABLE => 'z'),
+			'ON'	=> 'z.user_id = ' . $user->data['user_id'] . ' AND z.zebra_id = p.poster_id'
+		)
+	),
+
+	'WHERE'		=> $db->sql_in_set('p.post_id', $post_list) . '
+		AND u.user_id = p.poster_id'
+));
+
+$result = $db->sql_query($sql);
+
+// tapatalk add
+if (function_exists('phpbb_gmgetdate'))
+    $now = phpbb_gmgetdate(time() + $user->timezone + $user->dst);
+else
+    $now = getdate(time() + $user->timezone + $user->dst - date('Z'));
+
+// Posts are stored in the $rowset array while $attach_list, $user_cache
+// and the global bbcode_bitfield are built
+while ($row = $db->sql_fetchrow($result))
+{
+	// Set max_post_time
+	if ($row['post_time'] > $max_post_time)
+	{
+		$max_post_time = $row['post_time'];
+	}
+
+	$poster_id = (int) $row['poster_id'];
+
+	// Does post have an attachment? If so, add it to the list
+	if ($row['post_attachment'] && $config['allow_attachments'])
+	{
+		$attach_list[] = (int) $row['post_id'];
+
+		if ($row['post_approved'])
+		{
+			$has_attachments = true;
+		}
+	}
+
+	$rowset[$row['post_id']] = array(
+		'hide_post'			=> ($row['foe'] && ($view != 'show' || $post_id != $row['post_id'])) ? true : false,
+
+		'post_id'			=> $row['post_id'],
+		'post_time'			=> $row['post_time'],
+		'user_id'			=> $row['user_id'],
+		'username'			=> $row['username'],
+		'user_colour'		=> $row['user_colour'],
+		'topic_id'			=> $row['topic_id'],
+		'forum_id'			=> $row['forum_id'],
+		'post_subject'		=> $row['post_subject'],
+		'post_edit_count'	=> $row['post_edit_count'],
+		'post_edit_time'	=> $row['post_edit_time'],
+		'post_edit_reason'	=> $row['post_edit_reason'],
+		'post_edit_user'	=> $row['post_edit_user'],
+		'post_edit_locked'	=> $row['post_edit_locked'],
+
+		// Make sure the icon actually exists
+		//'icon_id'			=> (isset($icons[$row['icon_id']]['img'], $icons[$row['icon_id']]['height'], $icons[$row['icon_id']]['width'])) ? $row['icon_id'] : 0,
+		'post_attachment'	=> $row['post_attachment'],
+		'post_approved'		=> $row['post_approved'],
+		'post_reported'		=> $row['post_reported'],
+		'post_username'		=> $row['post_username'],
+		'post_text'			=> $row['post_text'],
+		'bbcode_uid'		=> $row['bbcode_uid'],
+		'bbcode_bitfield'	=> $row['bbcode_bitfield'],
+		'enable_smilies'	=> $row['enable_smilies'],
+		'enable_sig'		=> $row['enable_sig'],
+		'friend'			=> $row['friend'],
+		'foe'				=> $row['foe'],
+	);
+
+	// Define the global bbcode bitfield, will be used to load bbcodes
+	$bbcode_bitfield = $bbcode_bitfield | base64_decode($row['bbcode_bitfield']);
+
+	// Is a signature attached? Are we going to display it?
+	if ($row['enable_sig'] && $config['allow_sig'] && $user->optionget('viewsigs'))
+	{
+		$bbcode_bitfield = $bbcode_bitfield | base64_decode($row['user_sig_bbcode_bitfield']);
+	}
+
+	// Cache various user specific data ... so we don't have to recompute
+	// this each time the same user appears on this page
+	if (!isset($user_cache[$poster_id]))
+	{
+		if ($poster_id == ANONYMOUS)
+		{
+			$user_cache[$poster_id] = array(
+				'joined'		=> '',
+				'posts'			=> '',
+				'from'			=> '',
+
+				'sig'					=> '',
+				'sig_bbcode_uid'		=> '',
+				'sig_bbcode_bitfield'	=> '',
+
+				'online'			=> false,
+				'avatar'            => ($user->optionget('viewavatars')) ? get_user_avatar_url($row['user_avatar'], $row['user_avatar_type']) : '',
+				//'avatar'			=> ($user->optionget('viewavatars')) ? get_user_avatar($row['user_avatar'], $row['user_avatar_type'], $row['user_avatar_width'], $row['user_avatar_height']) : '',
+				'rank_title'		=> '',
+				'rank_image'		=> '',
+				'rank_image_src'	=> '',
+				'sig'				=> '',
+				'profile'			=> '',
+				'pm'				=> '',
+				'email'				=> '',
+				'www'				=> '',
+				'icq_status_img'	=> '',
+				'icq'				=> '',
+				'aim'				=> '',
+				'msn'				=> '',
+				'yim'				=> '',
+				'jabber'			=> '',
+				'search'			=> '',
+				'age'				=> '',
+
+				'username'			=> $row['username'],
+				'user_colour'		=> $row['user_colour'],
+
+				'warnings'			=> 0,
+				'allow_pm'			=> 0,
+			);
+
+			//get_user_rank($row['user_rank'], false, $user_cache[$poster_id]['rank_title'], $user_cache[$poster_id]['rank_image'], $user_cache[$poster_id]['rank_image_src']);
+		}
+		else
+		{
+			$user_sig = '';
+
+			// We add the signature to every posters entry because enable_sig is post dependant
+			if ($row['user_sig'] && $config['allow_sig'] && $user->optionget('viewsigs'))
+			{
+				$user_sig = $row['user_sig'];
+			}
+
+			$id_cache[] = $poster_id;
+
+			$user_cache[$poster_id] = array(
+				'joined'		=> $user->format_date($row['user_regdate']),
+				'posts'			=> $row['user_posts'],
+				'warnings'		=> (isset($row['user_warnings'])) ? $row['user_warnings'] : 0,
+				'from'			=> (!empty($row['user_from'])) ? $row['user_from'] : '',
+
+				'sig'					=> $user_sig,
+				'sig_bbcode_uid'		=> (!empty($row['user_sig_bbcode_uid'])) ? $row['user_sig_bbcode_uid'] : '',
+				'sig_bbcode_bitfield'	=> (!empty($row['user_sig_bbcode_bitfield'])) ? $row['user_sig_bbcode_bitfield'] : '',
+
+				'viewonline'	=> $row['user_allow_viewonline'],
+				'allow_pm'		=> $row['user_allow_pm'],
+
+				'avatar'		=> ($user->optionget('viewavatars')) ? get_user_avatar_url($row['user_avatar'], $row['user_avatar_type']) : '',
+				//'avatar'		=> ($user->optionget('viewavatars')) ? get_user_avatar($row['user_avatar'], $row['user_avatar_type'], $row['user_avatar_width'], $row['user_avatar_height']) : '',
+				'age'			=> '',
+
+				'rank_title'		=> '',
+				'rank_image'		=> '',
+				'rank_image_src'	=> '',
+
+				'username'			=> $row['username'],
+				'user_colour'		=> $row['user_colour'],
+
+				'online'		=> false,
+				'profile'		=> append_sid("{$phpbb_root_path}memberlist.$phpEx", "mode=viewprofile&amp;u=$poster_id"),
+				'www'			=> $row['user_website'],
+				'aim'			=> ($row['user_aim'] && $auth->acl_get('u_sendim')) ? append_sid("{$phpbb_root_path}memberlist.$phpEx", "mode=contact&amp;action=aim&amp;u=$poster_id") : '',
+				'msn'			=> ($row['user_msnm'] && $auth->acl_get('u_sendim')) ? append_sid("{$phpbb_root_path}memberlist.$phpEx", "mode=contact&amp;action=msnm&amp;u=$poster_id") : '',
+				'yim'			=> ($row['user_yim']) ? 'http://edit.yahoo.com/config/send_webmesg?.target=' . urlencode($row['user_yim']) . '&amp;.src=pg' : '',
+				'jabber'		=> ($row['user_jabber'] && $auth->acl_get('u_sendim')) ? append_sid("{$phpbb_root_path}memberlist.$phpEx", "mode=contact&amp;action=jabber&amp;u=$poster_id") : '',
+				'search'		=> ($auth->acl_get('u_search')) ? append_sid("{$phpbb_root_path}search.$phpEx", "author_id=$poster_id&amp;sr=posts") : '',
+
+				'author_full'		=> get_username_string('full', $poster_id, $row['username'], $row['user_colour']),
+				'author_colour'		=> get_username_string('colour', $poster_id, $row['username'], $row['user_colour']),
+				'author_username'	=> get_username_string('username', $poster_id, $row['username'], $row['user_colour']),
+				'author_profile'	=> get_username_string('profile', $poster_id, $row['username'], $row['user_colour']),
+			);
+
+			//get_user_rank($row['user_rank'], $row['user_posts'], $user_cache[$poster_id]['rank_title'], $user_cache[$poster_id]['rank_image'], $user_cache[$poster_id]['rank_image_src']);
+
+			if ((!empty($row['user_allow_viewemail']) && $auth->acl_get('u_sendemail')) || $auth->acl_get('a_email'))
+			{
+				$user_cache[$poster_id]['email'] = ($config['board_email_form'] && $config['email_enable']) ? append_sid("{$phpbb_root_path}memberlist.$phpEx", "mode=email&amp;u=$poster_id") : (($config['board_hide_emails'] && !$auth->acl_get('a_email')) ? '' : 'mailto:' . $row['user_email']);
+			}
+			else
+			{
+				$user_cache[$poster_id]['email'] = '';
+			}
+
+			if (!empty($row['user_icq']))
+			{
+				$user_cache[$poster_id]['icq'] = 'http://www.icq.com/people/' . urlencode($row['user_icq']) . '/';
+				$user_cache[$poster_id]['icq_status_img'] = '<img src="http://web.icq.com/whitepages/online?icq=' . $row['user_icq'] . '&amp;img=5" width="18" height="18" alt="" />';
+			}
+			else
+			{
+				$user_cache[$poster_id]['icq_status_img'] = '';
+				$user_cache[$poster_id]['icq'] = '';
+			}
+
+			if ($config['allow_birthdays'] && !empty($row['user_birthday']))
+			{
+				list($bday_day, $bday_month, $bday_year) = array_map('intval', explode('-', $row['user_birthday']));
+
+				if ($bday_year)
+				{
+					$diff = $now['mon'] - $bday_month;
+					if ($diff == 0)
+					{
+						$diff = ($now['mday'] - $bday_day < 0) ? 1 : 0;
+					}
+					else
+					{
+						$diff = ($diff < 0) ? 1 : 0;
+					}
+
+					$user_cache[$poster_id]['age'] = (int) ($now['year'] - $bday_year - $diff);
+				}
+			}
+		}
+	}
+}
+$db->sql_freeresult($result);
+
+// Load custom profile fields
+if ($config['load_cpf_viewtopic'])
+{
+	if (!class_exists('custom_profile'))
+	{
+		include($phpbb_root_path . 'includes/functions_profile_fields.' . $phpEx);
+	}
+	$cp = new custom_profile();
+
+	// Grab all profile fields from users in id cache for later use - similar to the poster cache
+	$profile_fields_tmp = $cp->generate_profile_fields_template('grab', $id_cache);
+
+	// filter out fields not to be displayed on viewtopic. Yes, it's a hack, but this shouldn't break any MODs.
+	$profile_fields_cache = array();
+	foreach ($profile_fields_tmp as $profile_user_id => $profile_fields)
+	{
+		$profile_fields_cache[$profile_user_id] = array();
+		foreach ($profile_fields as $used_ident => $profile_field)
+		{
+			if ($profile_field['data']['field_show_on_vt'])
+			{
+				$profile_fields_cache[$profile_user_id][$used_ident] = $profile_field;
+			}
+		}
+	}
+	unset($profile_fields_tmp);
+}
+
+// Generate online information for user
+if ($config['load_onlinetrack'] && sizeof($id_cache))
+{
+	$sql = 'SELECT session_user_id, MAX(session_time) as online_time, MIN(session_viewonline) AS viewonline
+		FROM ' . SESSIONS_TABLE . '
+		WHERE ' . $db->sql_in_set('session_user_id', $id_cache) . '
+		GROUP BY session_user_id';
+	$result = $db->sql_query($sql);
+
+	$update_time = $config['load_online_time'] * 60;
+	while ($row = $db->sql_fetchrow($result))
+	{
+		$user_cache[$row['session_user_id']]['online'] = (time() - $update_time < $row['online_time'] && (($row['viewonline']) || $auth->acl_get('u_viewonline'))) ? true : false;
+	}
+	$db->sql_freeresult($result);
+}
+unset($id_cache);
+
+// tapatalk add
+$attachment_by_id = array();
+
+// Pull attachment data
+if (sizeof($attach_list))
+{
+	if ($auth->acl_get('u_download') && $auth->acl_get('f_download', $forum_id))
+	{
+		$sql = 'SELECT *
+			FROM ' . ATTACHMENTS_TABLE . '
+			WHERE ' . $db->sql_in_set('post_msg_id', $attach_list) . '
+				AND in_message = 0
+			ORDER BY filetime DESC, post_msg_id ASC';
+		$result = $db->sql_query($sql);
+
+		while ($row = $db->sql_fetchrow($result))
+		{
+            // tapatalk add
+            $row['thumbnail_orig'] = $row['thumbnail'];
+            $row['thumbnail'] = 0;
+            $attachment_by_id[$row['attach_id']] = $row;
+		
+			$attachments[$row['post_msg_id']][] = $row;
+		}
+		$db->sql_freeresult($result);
+
+		// No attachments exist, but post table thinks they do so go ahead and reset post_attach flags
+		if (!sizeof($attachments))
+		{
+			$sql = 'UPDATE ' . POSTS_TABLE . '
+				SET post_attachment = 0
+				WHERE ' . $db->sql_in_set('post_id', $attach_list);
+			$db->sql_query($sql);
+
+			// We need to update the topic indicator too if the complete topic is now without an attachment
+			if (sizeof($rowset) != $total_posts)
+			{
+				// Not all posts are displayed so we query the db to find if there's any attachment for this topic
+				$sql = 'SELECT a.post_msg_id as post_id
+					FROM ' . ATTACHMENTS_TABLE . ' a, ' . POSTS_TABLE . " p
+					WHERE p.topic_id = $topic_id
+						AND p.post_approved = 1
+						AND p.topic_id = a.topic_id";
+				$result = $db->sql_query_limit($sql, 1);
+				$row = $db->sql_fetchrow($result);
+				$db->sql_freeresult($result);
+
+				if (!$row)
+				{
+					$sql = 'UPDATE ' . TOPICS_TABLE . "
+						SET topic_attachment = 0
+						WHERE topic_id = $topic_id";
+					$db->sql_query($sql);
+				}
+			}
+			else
+			{
+				$sql = 'UPDATE ' . TOPICS_TABLE . "
+					SET topic_attachment = 0
+					WHERE topic_id = $topic_id";
+				$db->sql_query($sql);
+			}
+		}
+		else if ($has_attachments && !$topic_data['topic_attachment'])
+		{
+			// Topic has approved attachments but its flag is wrong
+			$sql = 'UPDATE ' . TOPICS_TABLE . "
+				SET topic_attachment = 1
+				WHERE topic_id = $topic_id";
+			$db->sql_query($sql);
+
+			$topic_data['topic_attachment'] = 1;
+		}
+	}
+	else
+	{
+		$display_notice = true;
+	}
+}
+
+// Instantiate BBCode if need be
+if ($bbcode_bitfield !== '')
+{
+	$bbcode = new bbcode(base64_encode($bbcode_bitfield));
+}
+
+$i_total = sizeof($rowset) - 1;
+$prev_post_id = '';
+
+$template->assign_vars(array(
+	'S_NUM_POSTS' => sizeof($post_list))
+);
+
+// tapatalk add for thanks support
+$support_post_thanks = false;
+if (file_exists($phpbb_root_path . 'includes/functions_thanks.' . $phpEx))
+{
+    if (!function_exists('array_all_thanks'))
+    {
+        include($phpbb_root_path . 'includes/functions_thanks.' . $phpEx);
+    }
+
+    if (isset($_REQUEST['thanks'])) 
+    {
+        if (function_exists('insert_thanks'))
+        {
+            $user->add_lang('mods/thanks_mod');
+            $_REQUEST['from_id'] = $user->data['user_id'];
+            $_REQUEST['to_id'] = $topic_data['poster_id'];
+            $config['thanks_info_page'] = 1;
+            insert_thanks(request_var('thanks', 0), $user->data['user_id']);
+            trigger_error("Insert thanks");
+        }
+        else
+        {
+            trigger_error("Function 'insert_thanks' does not exist!");
+        }
+    }
+
+    if (function_exists('array_all_thanks'))
+    {
+        array_all_thanks($post_list);
+        $support_post_thanks = true;
+    }
+}
+
+// Output the posts
+$first_unread = $post_unread = false;
+for ($i = 0, $end = sizeof($post_list); $i < $end; ++$i)
+{
+	// A non-existing rowset only happens if there was no user present for the entered poster_id
+	// This could be a broken posts table.
+	if (!isset($rowset[$post_list[$i]]))
+	{
+		continue;
+	}
+
+	$row =& $rowset[$post_list[$i]];
+	$poster_id = $row['user_id'];
+
+	// End signature parsing, only if needed
+	if ($user_cache[$poster_id]['sig'] && $row['enable_sig'] && empty($user_cache[$poster_id]['sig_parsed']))
+	{
+		$user_cache[$poster_id]['sig'] = censor_text($user_cache[$poster_id]['sig']);
+
+		if ($user_cache[$poster_id]['sig_bbcode_bitfield'])
+		{
+			$bbcode->bbcode_second_pass($user_cache[$poster_id]['sig'], $user_cache[$poster_id]['sig_bbcode_uid'], $user_cache[$poster_id]['sig_bbcode_bitfield']);
+		}
+
+		$user_cache[$poster_id]['sig'] = bbcode_nl2br($user_cache[$poster_id]['sig']);
+		$user_cache[$poster_id]['sig'] = smiley_text($user_cache[$poster_id]['sig']);
+		$user_cache[$poster_id]['sig_parsed'] = true;
+	}
+
+	// Parse the message and subject
+	$message = censor_text($row['post_text']);
+
+    // tapatalk add for bbcode pretreatment
+    $message = process_bbcode($message, $row['bbcode_uid']);
+
+	// Second parse bbcode here
+	if ($row['bbcode_bitfield'])
+	{
+		$bbcode->bbcode_second_pass($message, $row['bbcode_uid'], $row['bbcode_bitfield']);
+	}
+
+	$message = bbcode_nl2br($message);
+	$message = smiley_text($message);
+
+	if (!empty($attachments[$row['post_id']]))
+	{
+	    $config['img_link_width'] = $config['img_link_height'] = 100000;    // tapatalk add
+		parse_attachments($forum_id, $message, $attachments[$row['post_id']], $update_count);
+	}
+
+	// Replace naughty words such as farty pants
+	$row['post_subject'] = censor_text($row['post_subject']);
+
+	// Highlight active words (primarily for search)
+	if ($highlight_match)
+	{
+		$message = preg_replace('#(?!<.*)(?<!\w)(' . $highlight_match . ')(?!\w|[^<>]*(?:</s(?:cript|tyle))?>)#is', '<span class="posthilit">\1</span>', $message);
+		$row['post_subject'] = preg_replace('#(?!<.*)(?<!\w)(' . $highlight_match . ')(?!\w|[^<>]*(?:</s(?:cript|tyle))?>)#is', '<span class="posthilit">\1</span>', $row['post_subject']);
+	}
+
+	// Editing information
+	if (($row['post_edit_count'] && $config['display_last_edited']) || $row['post_edit_reason'])
+	{
+		// Get usernames for all following posts if not already stored
+		if (!sizeof($post_edit_list) && ($row['post_edit_reason'] || ($row['post_edit_user'] && !isset($user_cache[$row['post_edit_user']]))))
+		{
+			// Remove all post_ids already parsed (we do not have to check them)
+			$post_storage_list = (!$store_reverse) ? array_slice($post_list, $i) : array_slice(array_reverse($post_list), $i);
+
+			$sql = 'SELECT DISTINCT u.user_id, u.username, u.user_colour
+				FROM ' . POSTS_TABLE . ' p, ' . USERS_TABLE . ' u
+				WHERE ' . $db->sql_in_set('p.post_id', $post_storage_list) . '
+					AND p.post_edit_count <> 0
+					AND p.post_edit_user <> 0
+					AND p.post_edit_user = u.user_id';
+			$result2 = $db->sql_query($sql);
+			while ($user_edit_row = $db->sql_fetchrow($result2))
+			{
+				$post_edit_list[$user_edit_row['user_id']] = $user_edit_row;
+			}
+			$db->sql_freeresult($result2);
+
+			unset($post_storage_list);
+		}
+
+		$l_edit_time_total = ($row['post_edit_count'] == 1) ? $user->lang['EDITED_TIME_TOTAL'] : $user->lang['EDITED_TIMES_TOTAL'];
+
+		if ($row['post_edit_reason'])
+		{
+			// User having edited the post also being the post author?
+			if (!$row['post_edit_user'] || $row['post_edit_user'] == $poster_id)
+			{
+				$display_username = get_username_string('full', $poster_id, $row['username'], $row['user_colour'], $row['post_username']);
+			}
+			else
+			{
+				$display_username = get_username_string('full', $row['post_edit_user'], $post_edit_list[$row['post_edit_user']]['username'], $post_edit_list[$row['post_edit_user']]['user_colour']);
+			}
+
+			$l_edited_by = sprintf($l_edit_time_total, $display_username, $user->format_date($row['post_edit_time'], false, true), $row['post_edit_count']);
+		}
+		else
+		{
+			if ($row['post_edit_user'] && !isset($user_cache[$row['post_edit_user']]))
+			{
+				$user_cache[$row['post_edit_user']] = $post_edit_list[$row['post_edit_user']];
+			}
+
+			// User having edited the post also being the post author?
+			if (!$row['post_edit_user'] || $row['post_edit_user'] == $poster_id)
+			{
+				$display_username = get_username_string('full', $poster_id, $row['username'], $row['user_colour'], $row['post_username']);
+			}
+			else
+			{
+				$display_username = get_username_string('full', $row['post_edit_user'], $user_cache[$row['post_edit_user']]['username'], $user_cache[$row['post_edit_user']]['user_colour']);
+			}
+
+			$l_edited_by = sprintf($l_edit_time_total, $display_username, $user->format_date($row['post_edit_time'], false, true), $row['post_edit_count']);
+		}
+	}
+	else
+	{
+		$l_edited_by = '';
+	}
+
+	// Bump information
+	if ($topic_data['topic_bumped'] && $row['post_id'] == $topic_data['topic_last_post_id'] && isset($user_cache[$topic_data['topic_bumper']]) )
+	{
+		// It is safe to grab the username from the user cache array, we are at the last
+		// post and only the topic poster and last poster are allowed to bump.
+		// Admins and mods are bound to the above rules too...
+		$l_bumped_by = sprintf($user->lang['BUMPED_BY'], $user_cache[$topic_data['topic_bumper']]['username'], $user->format_date($topic_data['topic_last_post_time'], false, true));
+	}
+	else
+	{
+		$l_bumped_by = '';
+	}
+
+	$cp_row = array();
+
+	//
+	if ($config['load_cpf_viewtopic'])
+	{
+		$cp_row = (isset($profile_fields_cache[$poster_id])) ? $cp->generate_profile_fields_template('show', false, $profile_fields_cache[$poster_id]) : array();
+	}
+
+	$post_unread = (isset($topic_tracking_info[$topic_id]) && $row['post_time'] > $topic_tracking_info[$topic_id]) ? true : false;
+
+	$s_first_unread = false;
+	if (!$first_unread && $post_unread)
+	{
+		$s_first_unread = $first_unread = true;
+	}
+
+	$edit_allowed = ($user->data['is_registered'] && ($auth->acl_get('m_edit', $forum_id) || (
+		$user->data['user_id'] == $poster_id &&
+		$auth->acl_get('f_edit', $forum_id) &&
+		!$row['post_edit_locked'] &&
+		($row['post_time'] > time() - ($config['edit_time'] * 60) || !$config['edit_time'])
+	)));
+
+	$delete_allowed = ($user->data['is_registered'] && ($auth->acl_get('m_delete', $forum_id) || (
+		$user->data['user_id'] == $poster_id &&
+		$auth->acl_get('f_delete', $forum_id) &&
+		$topic_data['topic_last_post_id'] == $row['post_id'] &&
+		($row['post_time'] > time() - ($config['delete_time'] * 60) || !$config['delete_time']) &&
+		// we do not want to allow removal of the last post if a moderator locked it!
+		!$row['post_edit_locked']
+	)));
+
+	//
+	$postrow = array(
+        'enable_smilies'    => $row['enable_smilies'],  // tapatalk add
+        'post_approved'     => $row['post_approved'],   // tapatalk add
+	
+		'POST_AUTHOR_FULL'		=> ($poster_id != ANONYMOUS) ? $user_cache[$poster_id]['author_full'] : get_username_string('full', $poster_id, $row['username'], $row['user_colour'], $row['post_username']),
+		'POST_AUTHOR_COLOUR'	=> ($poster_id != ANONYMOUS) ? $user_cache[$poster_id]['author_colour'] : get_username_string('colour', $poster_id, $row['username'], $row['user_colour'], $row['post_username']),
+		'POST_AUTHOR'			=> ($poster_id != ANONYMOUS) ? $user_cache[$poster_id]['author_username'] : get_username_string('username', $poster_id, $row['username'], $row['user_colour'], $row['post_username']),
+		'U_POST_AUTHOR'			=> ($poster_id != ANONYMOUS) ? $user_cache[$poster_id]['author_profile'] : get_username_string('profile', $poster_id, $row['username'], $row['user_colour'], $row['post_username']),
+
+		'RANK_TITLE'		=> $user_cache[$poster_id]['rank_title'],
+		'RANK_IMG'			=> $user_cache[$poster_id]['rank_image'],
+		'RANK_IMG_SRC'		=> $user_cache[$poster_id]['rank_image_src'],
+		'POSTER_JOINED'		=> $user_cache[$poster_id]['joined'],
+		'POSTER_POSTS'		=> $user_cache[$poster_id]['posts'],
+		'POSTER_FROM'		=> $user_cache[$poster_id]['from'],
+		'POSTER_AVATAR'		=> $user_cache[$poster_id]['avatar'],
+		'POSTER_WARNINGS'	=> $user_cache[$poster_id]['warnings'],
+		'POSTER_AGE'		=> $user_cache[$poster_id]['age'],
+
+		'POST_TIMESTAMP'	=> $row['post_time'],
+		'POST_DATE'			=> $user->format_date($row['post_time'], false, ($view == 'print') ? true : false),
+		'POST_SUBJECT'		=> $row['post_subject'],
+		'MESSAGE'			=> $message,
+		'SIGNATURE'			=> ($row['enable_sig']) ? $user_cache[$poster_id]['sig'] : '',
+		'EDITED_MESSAGE'	=> $l_edited_by,
+		'EDIT_REASON'		=> $row['post_edit_reason'],
+		'BUMPED_MESSAGE'	=> $l_bumped_by,
+
+		'MINI_POST_IMG'			=> ($post_unread) ? $user->img('icon_post_target_unread', 'UNREAD_POST') : $user->img('icon_post_target', 'POST'),
+		//'POST_ICON_IMG'			=> ($topic_data['enable_icons'] && !empty($row['icon_id'])) ? $icons[$row['icon_id']]['img'] : '',
+		//'POST_ICON_IMG_WIDTH'	=> ($topic_data['enable_icons'] && !empty($row['icon_id'])) ? $icons[$row['icon_id']]['width'] : '',
+		//'POST_ICON_IMG_HEIGHT'	=> ($topic_data['enable_icons'] && !empty($row['icon_id'])) ? $icons[$row['icon_id']]['height'] : '',
+		'ICQ_STATUS_IMG'		=> $user_cache[$poster_id]['icq_status_img'],
+		'ONLINE_IMG'			=> ($poster_id == ANONYMOUS || !$config['load_onlinetrack']) ? '' : (($user_cache[$poster_id]['online']) ? $user->img('icon_user_online', 'ONLINE') : $user->img('icon_user_offline', 'OFFLINE')),
+		'S_ONLINE'				=> ($poster_id == ANONYMOUS || !$config['load_onlinetrack']) ? false : (($user_cache[$poster_id]['online']) ? true : false),
+
+		'U_EDIT'			=> ($edit_allowed) ? append_sid("{$phpbb_root_path}posting.$phpEx", "mode=edit&amp;f=$forum_id&amp;p={$row['post_id']}") : '',
+		'U_QUOTE'			=> ($auth->acl_get('f_reply', $forum_id)) ? append_sid("{$phpbb_root_path}posting.$phpEx", "mode=quote&amp;f=$forum_id&amp;p={$row['post_id']}") : '',
+		'U_INFO'			=> ($auth->acl_get('m_info', $forum_id)) ? append_sid("{$phpbb_root_path}mcp.$phpEx", "i=main&amp;mode=post_details&amp;f=$forum_id&amp;p=" . $row['post_id'], true, $user->session_id) : '',
+		'U_DELETE'			=> ($delete_allowed) ? append_sid("{$phpbb_root_path}posting.$phpEx", "mode=delete&amp;f=$forum_id&amp;p={$row['post_id']}") : '',
+
+		'U_PROFILE'		=> $user_cache[$poster_id]['profile'],
+		'U_SEARCH'		=> $user_cache[$poster_id]['search'],
+		'U_PM'			=> ($poster_id != ANONYMOUS && $config['allow_privmsg'] && $auth->acl_get('u_sendpm') && ($user_cache[$poster_id]['allow_pm'] || $auth->acl_gets('a_', 'm_') || $auth->acl_getf_global('m_'))) ? append_sid("{$phpbb_root_path}ucp.$phpEx", 'i=pm&amp;mode=compose&amp;action=quotepost&amp;p=' . $row['post_id']) : '',
+		'U_EMAIL'		=> $user_cache[$poster_id]['email'],
+		'U_WWW'			=> $user_cache[$poster_id]['www'],
+		'U_ICQ'			=> $user_cache[$poster_id]['icq'],
+		'U_AIM'			=> $user_cache[$poster_id]['aim'],
+		'U_MSN'			=> $user_cache[$poster_id]['msn'],
+		'U_YIM'			=> $user_cache[$poster_id]['yim'],
+		'U_JABBER'		=> $user_cache[$poster_id]['jabber'],
+
+		'U_REPORT'			=> ($auth->acl_get('f_report', $forum_id)) ? append_sid("{$phpbb_root_path}report.$phpEx", 'f=' . $forum_id . '&amp;p=' . $row['post_id']) : '',
+		'U_MCP_REPORT'		=> ($auth->acl_get('m_report', $forum_id)) ? append_sid("{$phpbb_root_path}mcp.$phpEx", 'i=reports&amp;mode=report_details&amp;f=' . $forum_id . '&amp;p=' . $row['post_id'], true, $user->session_id) : '',
+		'U_MCP_APPROVE'		=> ($auth->acl_get('m_approve', $forum_id)) ? append_sid("{$phpbb_root_path}mcp.$phpEx", 'i=queue&amp;mode=approve_details&amp;f=' . $forum_id . '&amp;p=' . $row['post_id'], true, $user->session_id) : '',
+		'U_MINI_POST'		=> append_sid("{$phpbb_root_path}viewtopic.$phpEx", 'p=' . $row['post_id']) . (($topic_data['topic_type'] == POST_GLOBAL) ? '&amp;f=' . $forum_id : '') . '#p' . $row['post_id'],
+		'U_NEXT_POST_ID'	=> ($i < $i_total && isset($rowset[$post_list[$i + 1]])) ? $rowset[$post_list[$i + 1]]['post_id'] : '',
+		'U_PREV_POST_ID'	=> $prev_post_id,
+		'U_NOTES'			=> ($auth->acl_getf_global('m_')) ? append_sid("{$phpbb_root_path}mcp.$phpEx", 'i=notes&amp;mode=user_notes&amp;u=' . $poster_id, true, $user->session_id) : '',
+		'U_WARN'			=> ($auth->acl_get('m_warn') && $poster_id != $user->data['user_id'] && $poster_id != ANONYMOUS) ? append_sid("{$phpbb_root_path}mcp.$phpEx", 'i=warn&amp;mode=warn_post&amp;f=' . $forum_id . '&amp;p=' . $row['post_id'], true, $user->session_id) : '',
+
+		'POST_ID'			=> $row['post_id'],
+		'POST_NUMBER'		=> $i + $start + 1,
+		'POSTER_ID'			=> $poster_id,
+
+		'S_HAS_ATTACHMENTS'	=> (!empty($attachments[$row['post_id']])) ? true : false,
+		'S_POST_UNAPPROVED'	=> ($row['post_approved']) ? false : true,
+		'S_POST_REPORTED'	=> ($row['post_reported'] && $auth->acl_get('m_report', $forum_id)) ? true : false,
+		'S_DISPLAY_NOTICE'	=> $display_notice && $row['post_attachment'],
+		'S_FRIEND'			=> ($row['friend']) ? true : false,
+		'S_UNREAD_POST'		=> $post_unread,
+		'S_FIRST_UNREAD'	=> $s_first_unread,
+		'S_CUSTOM_FIELDS'	=> (isset($cp_row['row']) && sizeof($cp_row['row'])) ? true : false,
+		'S_TOPIC_POSTER'	=> ($topic_data['topic_poster'] == $poster_id) ? true : false,
+
+		'S_IGNORE_POST'		=> ($row['hide_post']) ? true : false,
+		'L_IGNORE_POST'		=> ($row['hide_post']) ? sprintf($user->lang['POST_BY_FOE'], get_username_string('no_profile', $poster_id, $row['username'], $row['user_colour'], $row['post_username']), '', '') : '',
+		//'L_IGNORE_POST'		=> ($row['hide_post']) ? sprintf($user->lang['POST_BY_FOE'], get_username_string('full', $poster_id, $row['username'], $row['user_colour'], $row['post_username']), '<a href="' . $viewtopic_url . "&amp;p={$row['post_id']}&amp;view=show#p{$row['post_id']}" . '">', '</a>') : '',
+	);
+	
+    // tapatalk add for thanks support
+    if (function_exists('output_thanks') && $support_post_thanks)
+    {
+        output_thanks($row['user_id']);
+    }
+
+	if (isset($cp_row['row']) && sizeof($cp_row['row']))
+	{
+		$postrow = array_merge($postrow, $cp_row['row']);
+	}
+
+	// Dump vars into template
+	$template->assign_block_vars('postrow', $postrow);
+
+	if (!empty($cp_row['blockrow']))
+	{
+		foreach ($cp_row['blockrow'] as $field_data)
+		{
+			$template->assign_block_vars('postrow.custom_fields', $field_data);
+		}
+	}
+
+	// Display not already displayed Attachments for this post, we already parsed them. ;)
+	if (!empty($attachments[$row['post_id']]))
+	{
+		foreach ($attachments[$row['post_id']] as $attachment)
+		{
+			$template->assign_block_vars('postrow.attachment', array(
+				'DISPLAY_ATTACHMENT'	=> $attachment)
+			);
+		}
+	}
+
+	$prev_post_id = $row['post_id'];
+
+	unset($rowset[$post_list[$i]]);
+	unset($attachments[$row['post_id']]);
+}
+unset($rowset, $user_cache);
+
+// Update topic view and if necessary attachment view counters ... but only for humans and if this is the first 'page view'
+if (isset($user->data['session_page']) && !$user->data['is_bot'] && (strpos($user->data['session_page'], '&t=' . $topic_id) === false || isset($user->data['session_created'])))
+{
+	$sql = 'UPDATE ' . TOPICS_TABLE . '
+		SET topic_views = topic_views + 1, topic_last_view_time = ' . time() . "
+		WHERE topic_id = $topic_id";
+	$db->sql_query($sql);
+
+	// Update the attachment download counts
+	if (sizeof($update_count))
+	{
+		$sql = 'UPDATE ' . ATTACHMENTS_TABLE . '
+			SET download_count = download_count + 1
+			WHERE ' . $db->sql_in_set('attach_id', array_unique($update_count));
+		$db->sql_query($sql);
+	}
+}
+
+// Get last post time for all global announcements
+// to keep proper forums tracking
+if ($topic_data['topic_type'] == POST_GLOBAL)
+{
+	$sql = 'SELECT topic_last_post_time as forum_last_post_time
+		FROM ' . TOPICS_TABLE . '
+		WHERE forum_id = 0
+		ORDER BY topic_last_post_time DESC';
+	$result = $db->sql_query_limit($sql, 1);
+	$topic_data['forum_last_post_time'] = (int) $db->sql_fetchfield('forum_last_post_time');
+	$db->sql_freeresult($result);
+
+	$sql = 'SELECT mark_time as forum_mark_time
+		FROM ' . FORUMS_TRACK_TABLE . '
+		WHERE forum_id = 0
+			AND user_id = ' . $user->data['user_id'];
+	$result = $db->sql_query($sql);
+	$topic_data['forum_mark_time'] = (int) $db->sql_fetchfield('forum_mark_time');
+	$db->sql_freeresult($result);
+}
+
+// Only mark topic if it's currently unread. Also make sure we do not set topic tracking back if earlier pages are viewed.
+if (isset($topic_tracking_info[$topic_id]) && $topic_data['topic_last_post_time'] > $topic_tracking_info[$topic_id] && $max_post_time > $topic_tracking_info[$topic_id])
+{
+	markread('topic', (($topic_data['topic_type'] == POST_GLOBAL) ? 0 : $forum_id), $topic_id, $max_post_time);
+
+	// Update forum info
+	$all_marked_read = update_forum_tracking_info((($topic_data['topic_type'] == POST_GLOBAL) ? 0 : $forum_id), $topic_data['forum_last_post_time'], (isset($topic_data['forum_mark_time'])) ? $topic_data['forum_mark_time'] : false, false);
+}
+else
+{
+	$all_marked_read = true;
+}
diff -ruN phpBB-3.0.10/mobiquo/include/index.html phpbb/mobiquo/include/index.html
--- phpBB-3.0.10/mobiquo/include/index.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/include/index.html	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,8 @@
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
+<HTML>
+ <HEAD>
+  <TITLE>Redirecting...</TITLE>
+<meta HTTP-EQUIV="REFRESH" content="0; url=/"> </HEAD>
+<BODY>  
+</BODY>
+</HTML>
diff -ruN phpBB-3.0.10/mobiquo/include/user.class.php phpbb/mobiquo/include/user.class.php
--- phpBB-3.0.10/mobiquo/include/user.class.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/include/user.class.php	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,23 @@
+<?php
+
+defined('IN_MOBIQUO') or exit;
+
+class tapa_user extends user
+{
+    var $time_format = 'Ymd\TH:i:s';
+    
+    /**
+    *
+    * @return iso8601 time
+    */
+    function format_date($gmepoch, $format = false, $forcedate = false)
+    {
+        // Zone offset
+        $zone_offset = $this->timezone + $this->dst;
+        $timezone = $this->data['user_timezone'];
+        $time = @gmdate($this->time_format, $gmepoch + $zone_offset);
+        $time .= sprintf("%+03d:%02d", intval($timezone), abs($timezone - intval($timezone)) * 60);
+        
+        return $time;
+    }
+}
\ No newline at end of file
diff -ruN phpBB-3.0.10/mobiquo/include/xmlrpc.inc phpbb/mobiquo/include/xmlrpc.inc
--- phpBB-3.0.10/mobiquo/include/xmlrpc.inc	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/include/xmlrpc.inc	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,3707 @@
+<?php
+// by Edd Dumbill (C) 1999-2002
+// <edd@usefulinc.com>
+// $Id: xmlrpc.inc,v 1.169 2008/03/06 18:47:24 ggiunta Exp $
+
+// Copyright (c) 1999,2000,2002 Edd Dumbill.
+// All rights reserved.
+//
+// Redistribution and use in source and binary forms, with or without
+// modification, are permitted provided that the following conditions
+// are met:
+//
+//    * Redistributions of source code must retain the above copyright
+//      notice, this list of conditions and the following disclaimer.
+//
+//    * Redistributions in binary form must reproduce the above
+//      copyright notice, this list of conditions and the following
+//      disclaimer in the documentation and/or other materials provided
+//      with the distribution.
+//
+//    * Neither the name of the "XML-RPC for PHP" nor the names of its
+//      contributors may be used to endorse or promote products derived
+//      from this software without specific prior written permission.
+//
+// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
+// "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
+// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
+// FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
+// REGENTS OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
+// INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
+// (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
+// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+// HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
+// STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+// ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
+// OF THE POSSIBILITY OF SUCH DAMAGE.
+
+	if(!function_exists('xml_parser_create'))
+	{
+		// For PHP 4 onward, XML functionality is always compiled-in on windows:
+		// no more need to dl-open it. It might have been compiled out on *nix...
+		if(strtoupper(substr(PHP_OS, 0, 3) != 'WIN'))
+		{
+			dl('xml.so');
+		}
+	}
+
+	// Try to be backward compat with php < 4.2 (are we not being nice ?)
+	$phpversion = phpversion();
+	if($phpversion[0] == '4' && $phpversion[2] < 2)
+	{
+		// give an opportunity to user to specify where to include other files from
+		if(!defined('PHP_XMLRPC_COMPAT_DIR'))
+		{
+			define('PHP_XMLRPC_COMPAT_DIR',dirname(__FILE__).'/compat/');
+		}
+		if($phpversion[2] == '0')
+		{
+			if($phpversion[4] < 6)
+			{
+				include(PHP_XMLRPC_COMPAT_DIR.'is_callable.php');
+			}
+			include(PHP_XMLRPC_COMPAT_DIR.'is_scalar.php');
+			include(PHP_XMLRPC_COMPAT_DIR.'array_key_exists.php');
+			include(PHP_XMLRPC_COMPAT_DIR.'version_compare.php');
+		}
+		include(PHP_XMLRPC_COMPAT_DIR.'var_export.php');
+		include(PHP_XMLRPC_COMPAT_DIR.'is_a.php');
+	}
+
+	// G. Giunta 2005/01/29: declare global these variables,
+	// so that xmlrpc.inc will work even if included from within a function
+	// Milosch: 2005/08/07 - explicitly request these via $GLOBALS where used.
+	$GLOBALS['xmlrpcI4']='i4';
+	$GLOBALS['xmlrpcInt']='int';
+	$GLOBALS['xmlrpcBoolean']='boolean';
+	$GLOBALS['xmlrpcDouble']='double';
+	$GLOBALS['xmlrpcString']='string';
+	$GLOBALS['xmlrpcDateTime']='dateTime.iso8601';
+	$GLOBALS['xmlrpcBase64']='base64';
+	$GLOBALS['xmlrpcArray']='array';
+	$GLOBALS['xmlrpcStruct']='struct';
+	$GLOBALS['xmlrpcValue']='undefined';
+
+	$GLOBALS['xmlrpcTypes']=array(
+		$GLOBALS['xmlrpcI4']       => 1,
+		$GLOBALS['xmlrpcInt']      => 1,
+		$GLOBALS['xmlrpcBoolean']  => 1,
+		$GLOBALS['xmlrpcString']   => 1,
+		$GLOBALS['xmlrpcDouble']   => 1,
+		$GLOBALS['xmlrpcDateTime'] => 1,
+		$GLOBALS['xmlrpcBase64']   => 1,
+		$GLOBALS['xmlrpcArray']    => 2,
+		$GLOBALS['xmlrpcStruct']   => 3
+	);
+
+	$GLOBALS['xmlrpc_valid_parents'] = array(
+		'VALUE' => array('MEMBER', 'DATA', 'PARAM', 'FAULT'),
+		'BOOLEAN' => array('VALUE'),
+		'I4' => array('VALUE'),
+		'INT' => array('VALUE'),
+		'STRING' => array('VALUE'),
+		'DOUBLE' => array('VALUE'),
+		'DATETIME.ISO8601' => array('VALUE'),
+		'BASE64' => array('VALUE'),
+		'MEMBER' => array('STRUCT'),
+		'NAME' => array('MEMBER'),
+		'DATA' => array('ARRAY'),
+		'ARRAY' => array('VALUE'),
+		'STRUCT' => array('VALUE'),
+		'PARAM' => array('PARAMS'),
+		'METHODNAME' => array('METHODCALL'),
+		'PARAMS' => array('METHODCALL', 'METHODRESPONSE'),
+		'FAULT' => array('METHODRESPONSE'),
+		'NIL' => array('VALUE') // only used when extension activated
+	);
+
+	// define extra types for supporting NULL (useful for json or <NIL/>)
+	$GLOBALS['xmlrpcNull']='null';
+	$GLOBALS['xmlrpcTypes']['null']=1;
+
+	// Not in use anymore since 2.0. Shall we remove it?
+	/// @deprecated
+	$GLOBALS['xmlEntities']=array(
+		'amp'  => '&',
+		'quot' => '"',
+		'lt'   => '<',
+		'gt'   => '>',
+		'apos' => "'"
+	);
+
+	// tables used for transcoding different charsets into us-ascii xml
+
+	$GLOBALS['xml_iso88591_Entities']=array();
+	$GLOBALS['xml_iso88591_Entities']['in'] = array();
+	$GLOBALS['xml_iso88591_Entities']['out'] = array();
+	for ($i = 0; $i < 32; $i++)
+	{
+		$GLOBALS['xml_iso88591_Entities']['in'][] = chr($i);
+		$GLOBALS['xml_iso88591_Entities']['out'][] = '&#'.$i.';';
+	}
+	for ($i = 160; $i < 256; $i++)
+	{
+		$GLOBALS['xml_iso88591_Entities']['in'][] = chr($i);
+		$GLOBALS['xml_iso88591_Entities']['out'][] = '&#'.$i.';';
+	}
+
+	/// @todo add to iso table the characters from cp_1252 range, i.e. 128 to 159?
+	/// These will NOT be present in true ISO-8859-1, but will save the unwary
+	/// windows user from sending junk (though no luck when reciving them...)
+  /*
+	$GLOBALS['xml_cp1252_Entities']=array();
+	for ($i = 128; $i < 160; $i++)
+	{
+		$GLOBALS['xml_cp1252_Entities']['in'][] = chr($i);
+	}
+	$GLOBALS['xml_cp1252_Entities']['out'] = array(
+		'&#x20AC;', '?',        '&#x201A;', '&#x0192;',
+		'&#x201E;', '&#x2026;', '&#x2020;', '&#x2021;',
+		'&#x02C6;', '&#x2030;', '&#x0160;', '&#x2039;',
+		'&#x0152;', '?',        '&#x017D;', '?',
+		'?',        '&#x2018;', '&#x2019;', '&#x201C;',
+		'&#x201D;', '&#x2022;', '&#x2013;', '&#x2014;',
+		'&#x02DC;', '&#x2122;', '&#x0161;', '&#x203A;',
+		'&#x0153;', '?',        '&#x017E;', '&#x0178;'
+	);
+  */
+
+	$GLOBALS['xmlrpcerr'] = array(
+	'unknown_method'=>1,
+	'invalid_return'=>2,
+	'incorrect_params'=>3,
+	'introspect_unknown'=>4,
+	'http_error'=>5,
+	'no_data'=>6,
+	'no_ssl'=>7,
+	'curl_fail'=>8,
+	'invalid_request'=>15,
+	'no_curl'=>16,
+	'server_error'=>17,
+	'multicall_error'=>18,
+	'multicall_notstruct'=>9,
+	'multicall_nomethod'=>10,
+	'multicall_notstring'=>11,
+	'multicall_recursion'=>12,
+	'multicall_noparams'=>13,
+	'multicall_notarray'=>14,
+
+	'cannot_decompress'=>103,
+	'decompress_fail'=>104,
+	'dechunk_fail'=>105,
+	'server_cannot_decompress'=>106,
+	'server_decompress_fail'=>107
+	);
+
+	$GLOBALS['xmlrpcstr'] = array(
+	'unknown_method'=>'Unknown method',
+	'invalid_return'=>'Invalid return payload: enable debugging to examine incoming payload',
+	'incorrect_params'=>'Incorrect parameters passed to method',
+	'introspect_unknown'=>"Can't introspect: method unknown",
+	'http_error'=>"Didn't receive 200 OK from remote server.",
+	'no_data'=>'No data received from server.',
+	'no_ssl'=>'No SSL support compiled in.',
+	'curl_fail'=>'CURL error',
+	'invalid_request'=>'Invalid request payload',
+	'no_curl'=>'No CURL support compiled in.',
+	'server_error'=>'Internal server error',
+	'multicall_error'=>'Received from server invalid multicall response',
+	'multicall_notstruct'=>'system.multicall expected struct',
+	'multicall_nomethod'=>'missing methodName',
+	'multicall_notstring'=>'methodName is not a string',
+	'multicall_recursion'=>'recursive system.multicall forbidden',
+	'multicall_noparams'=>'missing params',
+	'multicall_notarray'=>'params is not an array',
+
+	'cannot_decompress'=>'Received from server compressed HTTP and cannot decompress',
+	'decompress_fail'=>'Received from server invalid compressed HTTP',
+	'dechunk_fail'=>'Received from server invalid chunked HTTP',
+	'server_cannot_decompress'=>'Received from client compressed HTTP request and cannot decompress',
+	'server_decompress_fail'=>'Received from client invalid compressed HTTP request'
+	);
+
+	// The charset encoding used by the server for received messages and
+	// by the client for received responses when received charset cannot be determined
+	// or is not supported
+	$GLOBALS['xmlrpc_defencoding']='UTF-8';
+
+	// The encoding used internally by PHP.
+	// String values received as xml will be converted to this, and php strings will be converted to xml
+	// as if having been coded with this
+	$GLOBALS['xmlrpc_internalencoding']='ISO-8859-1';
+
+	$GLOBALS['xmlrpcName']='XML-RPC for PHP';
+	$GLOBALS['xmlrpcVersion']='2.2.1';
+
+	// let user errors start at 800
+	$GLOBALS['xmlrpcerruser']=800;
+	// let XML parse errors start at 100
+	$GLOBALS['xmlrpcerrxml']=100;
+
+	// formulate backslashes for escaping regexp
+	// Not in use anymore since 2.0. Shall we remove it?
+	/// @deprecated
+	$GLOBALS['xmlrpc_backslash']=chr(92).chr(92);
+
+	// set to TRUE to enable correct decoding of <NIL/> values
+	$GLOBALS['xmlrpc_null_extension']=false;
+
+	// used to store state during parsing
+	// quick explanation of components:
+	//   ac - used to accumulate values
+	//   isf - used to indicate a parsing fault (2) or xmlrpcresp fault (1)
+	//   isf_reason - used for storing xmlrpcresp fault string
+	//   lv - used to indicate "looking for a value": implements
+	//        the logic to allow values with no types to be strings
+	//   params - used to store parameters in method calls
+	//   method - used to store method name
+	//   stack - array with genealogy of xml elements names:
+	//           used to validate nesting of xmlrpc elements
+	$GLOBALS['_xh']=null;
+
+	/**
+	* Convert a string to the correct XML representation in a target charset
+	* To help correct communication of non-ascii chars inside strings, regardless
+	* of the charset used when sending requests, parsing them, sending responses
+	* and parsing responses, an option is to convert all non-ascii chars present in the message
+	* into their equivalent 'charset entity'. Charset entities enumerated this way
+	* are independent of the charset encoding used to transmit them, and all XML
+	* parsers are bound to understand them.
+	* Note that in the std case we are not sending a charset encoding mime type
+	* along with http headers, so we are bound by RFC 3023 to emit strict us-ascii.
+	*
+	* @todo do a bit of basic benchmarking (strtr vs. str_replace)
+	* @todo	make usage of iconv() or recode_string() or mb_string() where available
+	*/
+	function xmlrpc_encode_entitites($data, $src_encoding='', $dest_encoding='')
+	{
+		if ($src_encoding == '')
+		{
+			// lame, but we know no better...
+			$src_encoding = $GLOBALS['xmlrpc_internalencoding'];
+		}
+
+		switch(strtoupper($src_encoding.'_'.$dest_encoding))
+		{
+			case 'ISO-8859-1_':
+			case 'ISO-8859-1_US-ASCII':
+				$escaped_data = str_replace(array('&', '"', "'", '<', '>'), array('&amp;', '&quot;', '&apos;', '&lt;', '&gt;'), $data);
+				$escaped_data = str_replace($GLOBALS['xml_iso88591_Entities']['in'], $GLOBALS['xml_iso88591_Entities']['out'], $escaped_data);
+				break;
+			case 'ISO-8859-1_UTF-8':
+				$escaped_data = str_replace(array('&', '"', "'", '<', '>'), array('&amp;', '&quot;', '&apos;', '&lt;', '&gt;'), $data);
+				$escaped_data = utf8_encode($escaped_data);
+				break;
+			case 'ISO-8859-1_ISO-8859-1':
+			case 'US-ASCII_US-ASCII':
+			case 'US-ASCII_UTF-8':
+			case 'US-ASCII_':
+			case 'US-ASCII_ISO-8859-1':
+			case 'UTF-8_UTF-8':
+			//case 'CP1252_CP1252':
+				$escaped_data = str_replace(array('&', '"', "'", '<', '>'), array('&amp;', '&quot;', '&apos;', '&lt;', '&gt;'), $data);
+				break;
+			case 'UTF-8_':
+			case 'UTF-8_US-ASCII':
+			case 'UTF-8_ISO-8859-1':
+	// NB: this will choke on invalid UTF-8, going most likely beyond EOF
+	$escaped_data = '';
+	// be kind to users creating string xmlrpcvals out of different php types
+	$data = (string) $data;
+	$ns = strlen ($data);
+	for ($nn = 0; $nn < $ns; $nn++)
+	{
+		$ch = $data[$nn];
+		$ii = ord($ch);
+		//1 7 0bbbbbbb (127)
+		if ($ii < 128)
+		{
+			/// @todo shall we replace this with a (supposedly) faster str_replace?
+			switch($ii){
+				case 34:
+					$escaped_data .= '&quot;';
+					break;
+				case 38:
+					$escaped_data .= '&amp;';
+					break;
+				case 39:
+					$escaped_data .= '&apos;';
+					break;
+				case 60:
+					$escaped_data .= '&lt;';
+					break;
+				case 62:
+					$escaped_data .= '&gt;';
+					break;
+				default:
+					$escaped_data .= $ch;
+			} // switch
+		}
+		//2 11 110bbbbb 10bbbbbb (2047)
+		else if ($ii>>5 == 6)
+		{
+			$b1 = ($ii & 31);
+			$ii = ord($data[$nn+1]);
+			$b2 = ($ii & 63);
+			$ii = ($b1 * 64) + $b2;
+			$ent = sprintf ('&#%d;', $ii);
+			$escaped_data .= $ent;
+			$nn += 1;
+		}
+		//3 16 1110bbbb 10bbbbbb 10bbbbbb
+		else if ($ii>>4 == 14)
+		{
+			$b1 = ($ii & 31);
+			$ii = ord($data[$nn+1]);
+			$b2 = ($ii & 63);
+			$ii = ord($data[$nn+2]);
+			$b3 = ($ii & 63);
+			$ii = ((($b1 * 64) + $b2) * 64) + $b3;
+			$ent = sprintf ('&#%d;', $ii);
+			$escaped_data .= $ent;
+			$nn += 2;
+		}
+		//4 21 11110bbb 10bbbbbb 10bbbbbb 10bbbbbb
+		else if ($ii>>3 == 30)
+		{
+			$b1 = ($ii & 31);
+			$ii = ord($data[$nn+1]);
+			$b2 = ($ii & 63);
+			$ii = ord($data[$nn+2]);
+			$b3 = ($ii & 63);
+			$ii = ord($data[$nn+3]);
+			$b4 = ($ii & 63);
+			$ii = ((((($b1 * 64) + $b2) * 64) + $b3) * 64) + $b4;
+			$ent = sprintf ('&#%d;', $ii);
+			$escaped_data .= $ent;
+			$nn += 3;
+		}
+	}
+				break;
+/*
+			case 'CP1252_':
+			case 'CP1252_US-ASCII':
+				$escaped_data = str_replace(array('&', '"', "'", '<', '>'), array('&amp;', '&quot;', '&apos;', '&lt;', '&gt;'), $data);
+				$escaped_data = str_replace($GLOBALS['xml_iso88591_Entities']['in'], $GLOBALS['xml_iso88591_Entities']['out'], $escaped_data);
+				$escaped_data = str_replace($GLOBALS['xml_cp1252_Entities']['in'], $GLOBALS['xml_cp1252_Entities']['out'], $escaped_data);
+				break;
+			case 'CP1252_UTF-8':
+				$escaped_data = str_replace(array('&', '"', "'", '<', '>'), array('&amp;', '&quot;', '&apos;', '&lt;', '&gt;'), $data);
+				/// @todo we could use real UTF8 chars here instead of xml entities... (note that utf_8 encode all allone will NOT convert them)
+				$escaped_data = str_replace($GLOBALS['xml_cp1252_Entities']['in'], $GLOBALS['xml_cp1252_Entities']['out'], $escaped_data);
+				$escaped_data = utf8_encode($escaped_data);
+				break;
+			case 'CP1252_ISO-8859-1':
+				$escaped_data = str_replace(array('&', '"', "'", '<', '>'), array('&amp;', '&quot;', '&apos;', '&lt;', '&gt;'), $data);
+				// we might as well replave all funky chars with a '?' here, but we are kind and leave it to the receiving application layer to decide what to do with these weird entities...
+				$escaped_data = str_replace($GLOBALS['xml_cp1252_Entities']['in'], $GLOBALS['xml_cp1252_Entities']['out'], $escaped_data);
+				break;
+*/
+			default:
+				$escaped_data = '';
+				error_log("Converting from $src_encoding to $dest_encoding: not supported...");
+		}
+		return $escaped_data;
+	}
+
+	/// xml parser handler function for opening element tags
+	function xmlrpc_se($parser, $name, $attrs, $accept_single_vals=false)
+	{
+		// if invalid xmlrpc already detected, skip all processing
+		if ($GLOBALS['_xh']['isf'] < 2)
+		{
+			// check for correct element nesting
+			// top level element can only be of 2 types
+			/// @todo optimization creep: save this check into a bool variable, instead of using count() every time:
+			///       there is only a single top level element in xml anyway
+			if (count($GLOBALS['_xh']['stack']) == 0)
+			{
+				if ($name != 'METHODRESPONSE' && $name != 'METHODCALL' && (
+					$name != 'VALUE' && !$accept_single_vals))
+				{
+					$GLOBALS['_xh']['isf'] = 2;
+					$GLOBALS['_xh']['isf_reason'] = 'missing top level xmlrpc element';
+					return;
+				}
+				else
+				{
+					$GLOBALS['_xh']['rt'] = strtolower($name);
+				}
+			}
+			else
+			{
+				// not top level element: see if parent is OK
+				$parent = end($GLOBALS['_xh']['stack']);
+				if (!array_key_exists($name, $GLOBALS['xmlrpc_valid_parents']) || !in_array($parent, $GLOBALS['xmlrpc_valid_parents'][$name]))
+				{
+					$GLOBALS['_xh']['isf'] = 2;
+					$GLOBALS['_xh']['isf_reason'] = "xmlrpc element $name cannot be child of $parent";
+					return;
+				}
+			}
+
+			switch($name)
+			{
+				// optimize for speed switch cases: most common cases first
+				case 'VALUE':
+					/// @todo we could check for 2 VALUE elements inside a MEMBER or PARAM element
+					$GLOBALS['_xh']['vt']='value'; // indicator: no value found yet
+					$GLOBALS['_xh']['ac']='';
+					$GLOBALS['_xh']['lv']=1;
+					$GLOBALS['_xh']['php_class']=null;
+					break;
+				case 'I4':
+				case 'INT':
+				case 'STRING':
+				case 'BOOLEAN':
+				case 'DOUBLE':
+				case 'DATETIME.ISO8601':
+				case 'BASE64':
+					if ($GLOBALS['_xh']['vt']!='value')
+					{
+						//two data elements inside a value: an error occurred!
+						$GLOBALS['_xh']['isf'] = 2;
+						$GLOBALS['_xh']['isf_reason'] = "$name element following a {$GLOBALS['_xh']['vt']} element inside a single value";
+						return;
+					}
+					$GLOBALS['_xh']['ac']=''; // reset the accumulator
+					break;
+				case 'STRUCT':
+				case 'ARRAY':
+					if ($GLOBALS['_xh']['vt']!='value')
+					{
+						//two data elements inside a value: an error occurred!
+						$GLOBALS['_xh']['isf'] = 2;
+						$GLOBALS['_xh']['isf_reason'] = "$name element following a {$GLOBALS['_xh']['vt']} element inside a single value";
+						return;
+					}
+					// create an empty array to hold child values, and push it onto appropriate stack
+					$cur_val = array();
+					$cur_val['values'] = array();
+					$cur_val['type'] = $name;
+					// check for out-of-band information to rebuild php objs
+					// and in case it is found, save it
+					if (@isset($attrs['PHP_CLASS']))
+					{
+						$cur_val['php_class'] = $attrs['PHP_CLASS'];
+					}
+					$GLOBALS['_xh']['valuestack'][] = $cur_val;
+					$GLOBALS['_xh']['vt']='data'; // be prepared for a data element next
+					break;
+				case 'DATA':
+					if ($GLOBALS['_xh']['vt']!='data')
+					{
+						//two data elements inside a value: an error occurred!
+						$GLOBALS['_xh']['isf'] = 2;
+						$GLOBALS['_xh']['isf_reason'] = "found two data elements inside an array element";
+						return;
+					}
+				case 'METHODCALL':
+				case 'METHODRESPONSE':
+				case 'PARAMS':
+					// valid elements that add little to processing
+					break;
+				case 'METHODNAME':
+				case 'NAME':
+					/// @todo we could check for 2 NAME elements inside a MEMBER element
+					$GLOBALS['_xh']['ac']='';
+					break;
+				case 'FAULT':
+					$GLOBALS['_xh']['isf']=1;
+					break;
+				case 'MEMBER':
+					$GLOBALS['_xh']['valuestack'][count($GLOBALS['_xh']['valuestack'])-1]['name']=''; // set member name to null, in case we do not find in the xml later on
+					//$GLOBALS['_xh']['ac']='';
+					// Drop trough intentionally
+				case 'PARAM':
+					// clear value type, so we can check later if no value has been passed for this param/member
+					$GLOBALS['_xh']['vt']=null;
+					break;
+				case 'NIL':
+					if ($GLOBALS['xmlrpc_null_extension'])
+					{
+						if ($GLOBALS['_xh']['vt']!='value')
+						{
+							//two data elements inside a value: an error occurred!
+							$GLOBALS['_xh']['isf'] = 2;
+							$GLOBALS['_xh']['isf_reason'] = "$name element following a {$GLOBALS['_xh']['vt']} element inside a single value";
+							return;
+						}
+						$GLOBALS['_xh']['ac']=''; // reset the accumulator
+						break;
+					}
+					// we do not support the <NIL/> extension, so
+					// drop through intentionally
+				default:
+					/// INVALID ELEMENT: RAISE ISF so that it is later recognized!!!
+					$GLOBALS['_xh']['isf'] = 2;
+					$GLOBALS['_xh']['isf_reason'] = "found not-xmlrpc xml element $name";
+					break;
+			}
+
+			// Save current element name to stack, to validate nesting
+			$GLOBALS['_xh']['stack'][] = $name;
+
+			/// @todo optimization creep: move this inside the big switch() above
+			if($name!='VALUE')
+			{
+				$GLOBALS['_xh']['lv']=0;
+			}
+		}
+	}
+
+	/// Used in decoding xml chunks that might represent single xmlrpc values
+	function xmlrpc_se_any($parser, $name, $attrs)
+	{
+		xmlrpc_se($parser, $name, $attrs, true);
+	}
+
+	/// xml parser handler function for close element tags
+	function xmlrpc_ee($parser, $name, $rebuild_xmlrpcvals = true)
+	{
+		if ($GLOBALS['_xh']['isf'] < 2)
+		{
+			// push this element name from stack
+			// NB: if XML validates, correct opening/closing is guaranteed and
+			// we do not have to check for $name == $curr_elem.
+			// we also checked for proper nesting at start of elements...
+			$curr_elem = array_pop($GLOBALS['_xh']['stack']);
+
+			switch($name)
+			{
+				case 'VALUE':
+					// This if() detects if no scalar was inside <VALUE></VALUE>
+					if ($GLOBALS['_xh']['vt']=='value')
+					{
+						$GLOBALS['_xh']['value']=$GLOBALS['_xh']['ac'];
+						$GLOBALS['_xh']['vt']=$GLOBALS['xmlrpcString'];
+					}
+
+					if ($rebuild_xmlrpcvals)
+					{
+						// build the xmlrpc val out of the data received, and substitute it
+						$temp =& new xmlrpcval($GLOBALS['_xh']['value'], $GLOBALS['_xh']['vt']);
+						// in case we got info about underlying php class, save it
+						// in the object we're rebuilding
+						if (isset($GLOBALS['_xh']['php_class']))
+							$temp->_php_class = $GLOBALS['_xh']['php_class'];
+						// check if we are inside an array or struct:
+						// if value just built is inside an array, let's move it into array on the stack
+						$vscount = count($GLOBALS['_xh']['valuestack']);
+						if ($vscount && $GLOBALS['_xh']['valuestack'][$vscount-1]['type']=='ARRAY')
+						{
+							$GLOBALS['_xh']['valuestack'][$vscount-1]['values'][] = $temp;
+						}
+						else
+						{
+							$GLOBALS['_xh']['value'] = $temp;
+						}
+					}
+					else
+					{
+						/// @todo this needs to treat correctly php-serialized objects,
+						/// since std deserializing is done by php_xmlrpc_decode,
+						/// which we will not be calling...
+						if (isset($GLOBALS['_xh']['php_class']))
+						{
+						}
+
+						// check if we are inside an array or struct:
+						// if value just built is inside an array, let's move it into array on the stack
+						$vscount = count($GLOBALS['_xh']['valuestack']);
+						if ($vscount && $GLOBALS['_xh']['valuestack'][$vscount-1]['type']=='ARRAY')
+						{
+							$GLOBALS['_xh']['valuestack'][$vscount-1]['values'][] = $GLOBALS['_xh']['value'];
+						}
+					}
+					break;
+				case 'BOOLEAN':
+				case 'I4':
+				case 'INT':
+				case 'STRING':
+				case 'DOUBLE':
+				case 'DATETIME.ISO8601':
+				case 'BASE64':
+					$GLOBALS['_xh']['vt']=strtolower($name);
+					/// @todo: optimization creep - remove the if/elseif cycle below
+					/// since the case() in which we are already did that
+					if ($name=='STRING')
+					{
+						$GLOBALS['_xh']['value']=$GLOBALS['_xh']['ac'];
+					}
+					elseif ($name=='DATETIME.ISO8601')
+					{
+						if (!preg_match('/^[0-9]{8}T[0-9]{2}:[0-9]{2}:[0-9]{2}$/', $GLOBALS['_xh']['ac']))
+						{
+							error_log('XML-RPC: invalid value received in DATETIME: '.$GLOBALS['_xh']['ac']);
+						}
+						$GLOBALS['_xh']['vt']=$GLOBALS['xmlrpcDateTime'];
+						$GLOBALS['_xh']['value']=$GLOBALS['_xh']['ac'];
+					}
+					elseif ($name=='BASE64')
+					{
+						/// @todo check for failure of base64 decoding / catch warnings
+						$GLOBALS['_xh']['value']=base64_decode($GLOBALS['_xh']['ac']);
+					}
+					elseif ($name=='BOOLEAN')
+					{
+						// special case here: we translate boolean 1 or 0 into PHP
+						// constants true or false.
+						// Strings 'true' and 'false' are accepted, even though the
+						// spec never mentions them (see eg. Blogger api docs)
+						// NB: this simple checks helps a lot sanitizing input, ie no
+						// security problems around here
+						if ($GLOBALS['_xh']['ac']=='1' || strcasecmp($GLOBALS['_xh']['ac'], 'true') == 0)
+						{
+							$GLOBALS['_xh']['value']=true;
+						}
+						else
+						{
+							// log if receiveing something strange, even though we set the value to false anyway
+							//if ($GLOBALS['_xh']['ac']!='0' && strcasecmp($_xh[$parser]['ac'], 'false') != 0)
+								//error_log('XML-RPC: invalid value received in BOOLEAN: '.$GLOBALS['_xh']['ac']);
+							$GLOBALS['_xh']['value']=false;
+						}
+					}
+					elseif ($name=='DOUBLE')
+					{
+						// we have a DOUBLE
+						// we must check that only 0123456789-.<space> are characters here
+						// NOTE: regexp could be much stricter than this...
+						if (!preg_match('/^[+-eE0123456789 \t.]+$/', $GLOBALS['_xh']['ac']))
+						{
+							/// @todo: find a better way of throwing an error than this!
+							error_log('XML-RPC: non numeric value received in DOUBLE: '.$GLOBALS['_xh']['ac']);
+							$GLOBALS['_xh']['value']='ERROR_NON_NUMERIC_FOUND';
+						}
+						else
+						{
+							// it's ok, add it on
+							$GLOBALS['_xh']['value']=(double)$GLOBALS['_xh']['ac'];
+						}
+					}
+					else
+					{
+						// we have an I4/INT
+						// we must check that only 0123456789-<space> are characters here
+						if (!preg_match('/^[+-]?[0123456789 \t]+$/', $GLOBALS['_xh']['ac']))
+						{
+							/// @todo find a better way of throwing an error than this!
+							error_log('XML-RPC: non numeric value received in INT: '.$GLOBALS['_xh']['ac']);
+							$GLOBALS['_xh']['value']='ERROR_NON_NUMERIC_FOUND';
+						}
+						else
+						{
+							// it's ok, add it on
+							$GLOBALS['_xh']['value']=(int)$GLOBALS['_xh']['ac'];
+						}
+					}
+					//$GLOBALS['_xh']['ac']=''; // is this necessary?
+					$GLOBALS['_xh']['lv']=3; // indicate we've found a value
+					break;
+				case 'NAME':
+					$GLOBALS['_xh']['valuestack'][count($GLOBALS['_xh']['valuestack'])-1]['name'] = $GLOBALS['_xh']['ac'];
+					break;
+				case 'MEMBER':
+					//$GLOBALS['_xh']['ac']=''; // is this necessary?
+					// add to array in the stack the last element built,
+					// unless no VALUE was found
+					if ($GLOBALS['_xh']['vt'])
+					{
+						$vscount = count($GLOBALS['_xh']['valuestack']);
+						$GLOBALS['_xh']['valuestack'][$vscount-1]['values'][$GLOBALS['_xh']['valuestack'][$vscount-1]['name']] = $GLOBALS['_xh']['value'];
+					} else
+						error_log('XML-RPC: missing VALUE inside STRUCT in received xml');
+					break;
+				case 'DATA':
+					//$GLOBALS['_xh']['ac']=''; // is this necessary?
+					$GLOBALS['_xh']['vt']=null; // reset this to check for 2 data elements in a row - even if they're empty
+					break;
+				case 'STRUCT':
+				case 'ARRAY':
+					// fetch out of stack array of values, and promote it to current value
+					$curr_val = array_pop($GLOBALS['_xh']['valuestack']);
+					$GLOBALS['_xh']['value'] = $curr_val['values'];
+					$GLOBALS['_xh']['vt']=strtolower($name);
+					if (isset($curr_val['php_class']))
+					{
+						$GLOBALS['_xh']['php_class'] = $curr_val['php_class'];
+					}
+					break;
+				case 'PARAM':
+					// add to array of params the current value,
+					// unless no VALUE was found
+					if ($GLOBALS['_xh']['vt'])
+					{
+						$GLOBALS['_xh']['params'][]=$GLOBALS['_xh']['value'];
+						$GLOBALS['_xh']['pt'][]=$GLOBALS['_xh']['vt'];
+					}
+					else
+						error_log('XML-RPC: missing VALUE inside PARAM in received xml');
+					break;
+				case 'METHODNAME':
+					$GLOBALS['_xh']['method']=preg_replace('/^[\n\r\t ]+/', '', $GLOBALS['_xh']['ac']);
+					break;
+				case 'NIL':
+					if ($GLOBALS['xmlrpc_null_extension'])
+					{
+						$GLOBALS['_xh']['vt']='null';
+						$GLOBALS['_xh']['value']=null;
+						$GLOBALS['_xh']['lv']=3;
+						break;
+					}
+					// drop through intentionally if nil extension not enabled
+				case 'PARAMS':
+				case 'FAULT':
+				case 'METHODCALL':
+				case 'METHORESPONSE':
+					break;
+				default:
+					// End of INVALID ELEMENT!
+					// shall we add an assert here for unreachable code???
+					break;
+			}
+		}
+	}
+
+	/// Used in decoding xmlrpc requests/responses without rebuilding xmlrpc values
+	function xmlrpc_ee_fast($parser, $name)
+	{
+		xmlrpc_ee($parser, $name, false);
+	}
+
+	/// xml parser handler function for character data
+	function xmlrpc_cd($parser, $data)
+	{
+		// skip processing if xml fault already detected
+		if ($GLOBALS['_xh']['isf'] < 2)
+		{
+			// "lookforvalue==3" means that we've found an entire value
+			// and should discard any further character data
+			if($GLOBALS['_xh']['lv']!=3)
+			{
+				// G. Giunta 2006-08-23: useless change of 'lv' from 1 to 2
+				//if($GLOBALS['_xh']['lv']==1)
+				//{
+					// if we've found text and we're just in a <value> then
+					// say we've found a value
+					//$GLOBALS['_xh']['lv']=2;
+				//}
+				// we always initialize the accumulator before starting parsing, anyway...
+				//if(!@isset($GLOBALS['_xh']['ac']))
+				//{
+				//	$GLOBALS['_xh']['ac'] = '';
+				//}
+				$GLOBALS['_xh']['ac'].=$data;
+			}
+		}
+	}
+
+	/// xml parser handler function for 'other stuff', ie. not char data or
+	/// element start/end tag. In fact it only gets called on unknown entities...
+	function xmlrpc_dh($parser, $data)
+	{
+		// skip processing if xml fault already detected
+		if ($GLOBALS['_xh']['isf'] < 2)
+		{
+			if(substr($data, 0, 1) == '&' && substr($data, -1, 1) == ';')
+			{
+				// G. Giunta 2006-08-25: useless change of 'lv' from 1 to 2
+				//if($GLOBALS['_xh']['lv']==1)
+				//{
+				//	$GLOBALS['_xh']['lv']=2;
+				//}
+				$GLOBALS['_xh']['ac'].=$data;
+			}
+		}
+		return true;
+	}
+
+	class xmlrpc_client
+	{
+		var $path;
+		var $server;
+		var $port=0;
+		var $method='http';
+		var $errno;
+		var $errstr;
+		var $debug=0;
+		var $username='';
+		var $password='';
+		var $authtype=1;
+		var $cert='';
+		var $certpass='';
+		var $cacert='';
+		var $cacertdir='';
+		var $key='';
+		var $keypass='';
+		var $verifypeer=true;
+		var $verifyhost=1;
+		var $no_multicall=false;
+		var $proxy='';
+		var $proxyport=0;
+		var $proxy_user='';
+		var $proxy_pass='';
+		var $proxy_authtype=1;
+		var $cookies=array();
+		/**
+		* List of http compression methods accepted by the client for responses.
+		* NB: PHP supports deflate, gzip compressions out of the box if compiled w. zlib
+		*
+		* NNB: you can set it to any non-empty array for HTTP11 and HTTPS, since
+		* in those cases it will be up to CURL to decide the compression methods
+		* it supports. You might check for the presence of 'zlib' in the output of
+		* curl_version() to determine wheter compression is supported or not
+		*/
+		var $accepted_compression = array();
+		/**
+		* Name of compression scheme to be used for sending requests.
+		* Either null, gzip or deflate
+		*/
+		var $request_compression = '';
+		/**
+		* CURL handle: used for keep-alive connections (PHP 4.3.8 up, see:
+		* http://curl.haxx.se/docs/faq.html#7.3)
+		*/
+		var $xmlrpc_curl_handle = null;
+		/// Wheter to use persistent connections for http 1.1 and https
+		var $keepalive = false;
+		/// Charset encodings that can be decoded without problems by the client
+		var $accepted_charset_encodings = array();
+		/// Charset encoding to be used in serializing request. NULL = use ASCII
+		var $request_charset_encoding = '';
+		/**
+		* Decides the content of xmlrpcresp objects returned by calls to send()
+		* valid strings are 'xmlrpcvals', 'phpvals' or 'xml'
+		*/
+		var $return_type = 'xmlrpcvals';
+
+		/**
+		* @param string $path either the complete server URL or the PATH part of the xmlrc server URL, e.g. /xmlrpc/server.php
+		* @param string $server the server name / ip address
+		* @param integer $port the port the server is listening on, defaults to 80 or 443 depending on protocol used
+		* @param string $method the http protocol variant: defaults to 'http', 'https' and 'http11' can be used if CURL is installed
+		*/
+		function xmlrpc_client($path, $server='', $port='', $method='')
+		{
+			// allow user to specify all params in $path
+			if($server == '' and $port == '' and $method == '')
+			{
+				$parts = parse_url($path);
+				$server = $parts['host'];
+				$path = isset($parts['path']) ? $parts['path'] : '';
+				if(isset($parts['query']))
+				{
+					$path .= '?'.$parts['query'];
+				}
+				if(isset($parts['fragment']))
+				{
+					$path .= '#'.$parts['fragment'];
+				}
+				if(isset($parts['port']))
+				{
+					$port = $parts['port'];
+				}
+				if(isset($parts['scheme']))
+				{
+					$method = $parts['scheme'];
+				}
+				if(isset($parts['user']))
+				{
+					$this->username = $parts['user'];
+				}
+				if(isset($parts['pass']))
+				{
+					$this->password = $parts['pass'];
+				}
+			}
+			if($path == '' || $path[0] != '/')
+			{
+				$this->path='/'.$path;
+			}
+			else
+			{
+				$this->path=$path;
+			}
+			$this->server=$server;
+			if($port != '')
+			{
+				$this->port=$port;
+			}
+			if($method != '')
+			{
+				$this->method=$method;
+			}
+
+			// if ZLIB is enabled, let the client by default accept compressed responses
+			if(function_exists('gzinflate') || (
+				function_exists('curl_init') && (($info = curl_version()) &&
+				((is_string($info) && strpos($info, 'zlib') !== null) || isset($info['libz_version'])))
+			))
+			{
+				$this->accepted_compression = array('gzip', 'deflate');
+			}
+
+			// keepalives: enabled by default ONLY for PHP >= 4.3.8
+			// (see http://curl.haxx.se/docs/faq.html#7.3)
+			if(version_compare(phpversion(), '4.3.8') >= 0)
+			{
+				$this->keepalive = true;
+			}
+
+			// by default the xml parser can support these 3 charset encodings
+			$this->accepted_charset_encodings = array('UTF-8', 'ISO-8859-1', 'US-ASCII');
+		}
+
+		/**
+		* Enables/disables the echoing to screen of the xmlrpc responses received
+		* @param integer $debug values 0, 1 and 2 are supported (2 = echo sent msg too, before received response)
+		* @access public
+		*/
+		function setDebug($in)
+		{
+			$this->debug=$in;
+		}
+
+		/**
+		* Add some http BASIC AUTH credentials, used by the client to authenticate
+		* @param string $u username
+		* @param string $p password
+		* @param integer $t auth type. See curl_setopt man page for supported auth types. Defaults to CURLAUTH_BASIC (basic auth)
+		* @access public
+		*/
+		function setCredentials($u, $p, $t=1)
+		{
+			$this->username=$u;
+			$this->password=$p;
+			$this->authtype=$t;
+		}
+
+		/**
+		* Add a client-side https certificate
+		* @param string $cert
+		* @param string $certpass
+		* @access public
+		*/
+		function setCertificate($cert, $certpass)
+		{
+			$this->cert = $cert;
+			$this->certpass = $certpass;
+		}
+
+		/**
+		* Add a CA certificate to verify server with (see man page about
+		* CURLOPT_CAINFO for more details
+		* @param string $cacert certificate file name (or dir holding certificates)
+		* @param bool $is_dir set to true to indicate cacert is a dir. defaults to false
+		* @access public
+		*/
+		function setCaCertificate($cacert, $is_dir=false)
+		{
+			if ($is_dir)
+			{
+				$this->cacertdir = $cacert;
+			}
+			else
+			{
+				$this->cacert = $cacert;
+			}
+		}
+
+		/**
+		* Set attributes for SSL communication: private SSL key
+		* NB: does not work in older php/curl installs
+		* Thanks to Daniel Convissor
+		* @param string $key The name of a file containing a private SSL key
+		* @param string $keypass The secret password needed to use the private SSL key
+		* @access public
+		*/
+		function setKey($key, $keypass)
+		{
+			$this->key = $key;
+			$this->keypass = $keypass;
+		}
+
+		/**
+		* Set attributes for SSL communication: verify server certificate
+		* @param bool $i enable/disable verification of peer certificate
+		* @access public
+		*/
+		function setSSLVerifyPeer($i)
+		{
+			$this->verifypeer = $i;
+		}
+
+		/**
+		* Set attributes for SSL communication: verify match of server cert w. hostname
+		* @param int $i
+		* @access public
+		*/
+		function setSSLVerifyHost($i)
+		{
+			$this->verifyhost = $i;
+		}
+
+		/**
+		* Set proxy info
+		* @param string $proxyhost
+		* @param string $proxyport Defaults to 8080 for HTTP and 443 for HTTPS
+		* @param string $proxyusername Leave blank if proxy has public access
+		* @param string $proxypassword Leave blank if proxy has public access
+		* @param int $proxyauthtype set to constant CURLAUTH_NTLM to use NTLM auth with proxy
+		* @access public
+		*/
+		function setProxy($proxyhost, $proxyport, $proxyusername = '', $proxypassword = '', $proxyauthtype = 1)
+		{
+			$this->proxy = $proxyhost;
+			$this->proxyport = $proxyport;
+			$this->proxy_user = $proxyusername;
+			$this->proxy_pass = $proxypassword;
+			$this->proxy_authtype = $proxyauthtype;
+		}
+
+		/**
+		* Enables/disables reception of compressed xmlrpc responses.
+		* Note that enabling reception of compressed responses merely adds some standard
+		* http headers to xmlrpc requests. It is up to the xmlrpc server to return
+		* compressed responses when receiving such requests.
+		* @param string $compmethod either 'gzip', 'deflate', 'any' or ''
+		* @access public
+		*/
+		function setAcceptedCompression($compmethod)
+		{
+			if ($compmethod == 'any')
+				$this->accepted_compression = array('gzip', 'deflate');
+			else
+				$this->accepted_compression = array($compmethod);
+		}
+
+		/**
+		* Enables/disables http compression of xmlrpc request.
+		* Take care when sending compressed requests: servers might not support them
+		* (and automatic fallback to uncompressed requests is not yet implemented)
+		* @param string $compmethod either 'gzip', 'deflate' or ''
+		* @access public
+		*/
+		function setRequestCompression($compmethod)
+		{
+			$this->request_compression = $compmethod;
+		}
+
+		/**
+		* Adds a cookie to list of cookies that will be sent to server.
+		* NB: setting any param but name and value will turn the cookie into a 'version 1' cookie:
+		* do not do it unless you know what you are doing
+		* @param string $name
+		* @param string $value
+		* @param string $path
+		* @param string $domain
+		* @param int $port
+		* @access public
+		*
+		* @todo check correctness of urlencoding cookie value (copied from php way of doing it...)
+		*/
+		function setCookie($name, $value='', $path='', $domain='', $port=null)
+		{
+			$this->cookies[$name]['value'] = urlencode($value);
+			if ($path || $domain || $port)
+			{
+				$this->cookies[$name]['path'] = $path;
+				$this->cookies[$name]['domain'] = $domain;
+				$this->cookies[$name]['port'] = $port;
+				$this->cookies[$name]['version'] = 1;
+			}
+			else
+			{
+				$this->cookies[$name]['version'] = 0;
+			}
+		}
+
+		/**
+		* Send an xmlrpc request
+		* @param mixed $msg The message object, or an array of messages for using multicall, or the complete xml representation of a request
+		* @param integer $timeout Connection timeout, in seconds, If unspecified, a platform specific timeout will apply
+		* @param string $method if left unspecified, the http protocol chosen during creation of the object will be used
+		* @return xmlrpcresp
+		* @access public
+		*/
+		function& send($msg, $timeout=0, $method='')
+		{
+			// if user deos not specify http protocol, use native method of this client
+			// (i.e. method set during call to constructor)
+			if($method == '')
+			{
+				$method = $this->method;
+			}
+
+			if(is_array($msg))
+			{
+				// $msg is an array of xmlrpcmsg's
+				$r = $this->multicall($msg, $timeout, $method);
+				return $r;
+			}
+			elseif(is_string($msg))
+			{
+				$n =& new xmlrpcmsg('');
+				$n->payload = $msg;
+				$msg = $n;
+			}
+
+			// where msg is an xmlrpcmsg
+			$msg->debug=$this->debug;
+
+			if($method == 'https')
+			{
+				$r =& $this->sendPayloadHTTPS(
+					$msg,
+					$this->server,
+					$this->port,
+					$timeout,
+					$this->username,
+					$this->password,
+					$this->authtype,
+					$this->cert,
+					$this->certpass,
+					$this->cacert,
+					$this->cacertdir,
+					$this->proxy,
+					$this->proxyport,
+					$this->proxy_user,
+					$this->proxy_pass,
+					$this->proxy_authtype,
+					$this->keepalive,
+					$this->key,
+					$this->keypass
+				);
+			}
+			elseif($method == 'http11')
+			{
+				$r =& $this->sendPayloadCURL(
+					$msg,
+					$this->server,
+					$this->port,
+					$timeout,
+					$this->username,
+					$this->password,
+					$this->authtype,
+					null,
+					null,
+					null,
+					null,
+					$this->proxy,
+					$this->proxyport,
+					$this->proxy_user,
+					$this->proxy_pass,
+					$this->proxy_authtype,
+					'http',
+					$this->keepalive
+				);
+			}
+			else
+			{
+				$r =& $this->sendPayloadHTTP10(
+					$msg,
+					$this->server,
+					$this->port,
+					$timeout,
+					$this->username,
+					$this->password,
+					$this->authtype,
+					$this->proxy,
+					$this->proxyport,
+					$this->proxy_user,
+					$this->proxy_pass,
+					$this->proxy_authtype
+				);
+			}
+
+			return $r;
+		}
+
+		/**
+		* @access private
+		*/
+		function &sendPayloadHTTP10($msg, $server, $port, $timeout=0,
+			$username='', $password='', $authtype=1, $proxyhost='',
+			$proxyport=0, $proxyusername='', $proxypassword='', $proxyauthtype=1)
+		{
+			if($port==0)
+			{
+				$port=80;
+			}
+
+			// Only create the payload if it was not created previously
+			if(empty($msg->payload))
+			{
+				$msg->createPayload($this->request_charset_encoding);
+			}
+
+			$payload = $msg->payload;
+			// Deflate request body and set appropriate request headers
+			if(function_exists('gzdeflate') && ($this->request_compression == 'gzip' || $this->request_compression == 'deflate'))
+			{
+				if($this->request_compression == 'gzip')
+				{
+					$a = @gzencode($payload);
+					if($a)
+					{
+						$payload = $a;
+						$encoding_hdr = "Content-Encoding: gzip\r\n";
+					}
+				}
+				else
+				{
+					$a = @gzcompress($payload);
+					if($a)
+					{
+						$payload = $a;
+						$encoding_hdr = "Content-Encoding: deflate\r\n";
+					}
+				}
+			}
+			else
+			{
+				$encoding_hdr = '';
+			}
+
+			// thanks to Grant Rauscher <grant7@firstworld.net> for this
+			$credentials='';
+			if($username!='')
+			{
+				$credentials='Authorization: Basic ' . base64_encode($username . ':' . $password) . "\r\n";
+				if ($authtype != 1)
+				{
+					error_log('XML-RPC: xmlrpc_client::send: warning. Only Basic auth is supported with HTTP 1.0');
+				}
+			}
+
+			$accepted_encoding = '';
+			if(is_array($this->accepted_compression) && count($this->accepted_compression))
+			{
+				$accepted_encoding = 'Accept-Encoding: ' . implode(', ', $this->accepted_compression) . "\r\n";
+			}
+
+			$proxy_credentials = '';
+			if($proxyhost)
+			{
+				if($proxyport == 0)
+				{
+					$proxyport = 8080;
+				}
+				$connectserver = $proxyhost;
+				$connectport = $proxyport;
+				$uri = 'http://'.$server.':'.$port.$this->path;
+				if($proxyusername != '')
+				{
+					if ($proxyauthtype != 1)
+					{
+						error_log('XML-RPC: xmlrpc_client::send: warning. Only Basic auth to proxy is supported with HTTP 1.0');
+					}
+					$proxy_credentials = 'Proxy-Authorization: Basic ' . base64_encode($proxyusername.':'.$proxypassword) . "\r\n";
+				}
+			}
+			else
+			{
+				$connectserver = $server;
+				$connectport = $port;
+				$uri = $this->path;
+			}
+
+			// Cookie generation, as per rfc2965 (version 1 cookies) or
+			// netscape's rules (version 0 cookies)
+			$cookieheader='';
+			if (count($this->cookies))
+			{
+				$version = '';
+				foreach ($this->cookies as $name => $cookie)
+				{
+					if ($cookie['version'])
+					{
+						$version = ' $Version="' . $cookie['version'] . '";';
+						$cookieheader .= ' ' . $name . '="' . $cookie['value'] . '";';
+						if ($cookie['path'])
+							$cookieheader .= ' $Path="' . $cookie['path'] . '";';
+						if ($cookie['domain'])
+							$cookieheader .= ' $Domain="' . $cookie['domain'] . '";';
+						if ($cookie['port'])
+							$cookieheader .= ' $Port="' . $cookie['port'] . '";';
+					}
+					else
+					{
+						$cookieheader .= ' ' . $name . '=' . $cookie['value'] . ";";
+					}
+				}
+				$cookieheader = 'Cookie:' . $version . substr($cookieheader, 0, -1) . "\r\n";
+			}
+
+			$op= 'POST ' . $uri. " HTTP/1.0\r\n" .
+				'User-Agent: ' . $GLOBALS['xmlrpcName'] . ' ' . $GLOBALS['xmlrpcVersion'] . "\r\n" .
+				'Host: '. $server . ':' . $port . "\r\n" .
+				$credentials .
+				$proxy_credentials .
+				$accepted_encoding .
+				$encoding_hdr .
+				'Accept-Charset: ' . implode(',', $this->accepted_charset_encodings) . "\r\n" .
+				$cookieheader .
+				'Content-Type: ' . $msg->content_type . "\r\nContent-Length: " .
+				strlen($payload) . "\r\n\r\n" .
+				$payload;
+
+			if($this->debug > 1)
+			{
+				print "<PRE>\n---SENDING---\n" . htmlentities($op) . "\n---END---\n</PRE>";
+				// let the client see this now in case http times out...
+				flush();
+			}
+
+			if($timeout>0)
+			{
+				$fp=@fsockopen($connectserver, $connectport, $this->errno, $this->errstr, $timeout);
+			}
+			else
+			{
+				$fp=@fsockopen($connectserver, $connectport, $this->errno, $this->errstr);
+			}
+			if($fp)
+			{
+				if($timeout>0 && function_exists('stream_set_timeout'))
+				{
+					stream_set_timeout($fp, $timeout);
+				}
+			}
+			else
+			{
+				$this->errstr='Connect error: '.$this->errstr;
+				$r=&new xmlrpcresp(0, $GLOBALS['xmlrpcerr']['http_error'], $this->errstr . ' (' . $this->errno . ')');
+				return $r;
+			}
+
+			if(!fputs($fp, $op, strlen($op)))
+			{
+				$this->errstr='Write error';
+				$r=&new xmlrpcresp(0, $GLOBALS['xmlrpcerr']['http_error'], $this->errstr);
+				return $r;
+			}
+			else
+			{
+				// reset errno and errstr on succesful socket connection
+				$this->errstr = '';
+			}
+			// G. Giunta 2005/10/24: close socket before parsing.
+			// should yeld slightly better execution times, and make easier recursive calls (e.g. to follow http redirects)
+			$ipd='';
+			while($data=fread($fp, 32768))
+			{
+				// shall we check for $data === FALSE?
+				// as per the manual, it signals an error
+				$ipd.=$data;
+			}
+			fclose($fp);
+            
+			$r =& $msg->parseResponse($ipd, false, $this->return_type);
+			return $r;
+
+		}
+
+		/**
+		* @access private
+		*/
+		function &sendPayloadHTTPS($msg, $server, $port, $timeout=0, $username='',
+			$password='', $authtype=1, $cert='',$certpass='', $cacert='', $cacertdir='',
+			$proxyhost='', $proxyport=0, $proxyusername='', $proxypassword='', $proxyauthtype=1,
+			$keepalive=false, $key='', $keypass='')
+		{
+			$r =& $this->sendPayloadCURL($msg, $server, $port, $timeout, $username,
+				$password, $authtype, $cert, $certpass, $cacert, $cacertdir, $proxyhost, $proxyport,
+				$proxyusername, $proxypassword, $proxyauthtype, 'https', $keepalive, $key, $keypass);
+			return $r;
+		}
+
+		/**
+		* Contributed by Justin Miller <justin@voxel.net>
+		* Requires curl to be built into PHP
+		* NB: CURL versions before 7.11.10 cannot use proxy to talk to https servers!
+		* @access private
+		*/
+		function &sendPayloadCURL($msg, $server, $port, $timeout=0, $username='',
+			$password='', $authtype=1, $cert='', $certpass='', $cacert='', $cacertdir='',
+			$proxyhost='', $proxyport=0, $proxyusername='', $proxypassword='', $proxyauthtype=1, $method='https',
+			$keepalive=false, $key='', $keypass='')
+		{
+			if(!function_exists('curl_init'))
+			{
+				$this->errstr='CURL unavailable on this install';
+				$r=&new xmlrpcresp(0, $GLOBALS['xmlrpcerr']['no_curl'], $GLOBALS['xmlrpcstr']['no_curl']);
+				return $r;
+			}
+			if($method == 'https')
+			{
+				if(($info = curl_version()) &&
+					((is_string($info) && strpos($info, 'OpenSSL') === null) || (is_array($info) && !isset($info['ssl_version']))))
+				{
+					$this->errstr='SSL unavailable on this install';
+					$r=&new xmlrpcresp(0, $GLOBALS['xmlrpcerr']['no_ssl'], $GLOBALS['xmlrpcstr']['no_ssl']);
+					return $r;
+				}
+			}
+
+			if($port == 0)
+			{
+				if($method == 'http')
+				{
+					$port = 80;
+				}
+				else
+				{
+					$port = 443;
+				}
+			}
+
+			// Only create the payload if it was not created previously
+			if(empty($msg->payload))
+			{
+				$msg->createPayload($this->request_charset_encoding);
+			}
+
+			// Deflate request body and set appropriate request headers
+			$payload = $msg->payload;
+			if(function_exists('gzdeflate') && ($this->request_compression == 'gzip' || $this->request_compression == 'deflate'))
+			{
+				if($this->request_compression == 'gzip')
+				{
+					$a = @gzencode($payload);
+					if($a)
+					{
+						$payload = $a;
+						$encoding_hdr = 'Content-Encoding: gzip';
+					}
+				}
+				else
+				{
+					$a = @gzcompress($payload);
+					if($a)
+					{
+						$payload = $a;
+						$encoding_hdr = 'Content-Encoding: deflate';
+					}
+				}
+			}
+			else
+			{
+				$encoding_hdr = '';
+			}
+
+			if($this->debug > 1)
+			{
+				print "<PRE>\n---SENDING---\n" . htmlentities($payload) . "\n---END---\n</PRE>";
+				// let the client see this now in case http times out...
+				flush();
+			}
+
+			if(!$keepalive || !$this->xmlrpc_curl_handle)
+			{
+				$curl = curl_init($method . '://' . $server . ':' . $port . $this->path);
+				if($keepalive)
+				{
+					$this->xmlrpc_curl_handle = $curl;
+				}
+			}
+			else
+			{
+				$curl = $this->xmlrpc_curl_handle;
+			}
+
+			// results into variable
+			curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);
+
+			if($this->debug)
+			{
+				curl_setopt($curl, CURLOPT_VERBOSE, 1);
+			}
+			curl_setopt($curl, CURLOPT_USERAGENT, $GLOBALS['xmlrpcName'].' '.$GLOBALS['xmlrpcVersion']);
+			// required for XMLRPC: post the data
+			curl_setopt($curl, CURLOPT_POST, 1);
+			// the data
+			curl_setopt($curl, CURLOPT_POSTFIELDS, $payload);
+
+			// return the header too
+			curl_setopt($curl, CURLOPT_HEADER, 1);
+
+			// will only work with PHP >= 5.0
+			// NB: if we set an empty string, CURL will add http header indicating
+			// ALL methods it is supporting. This is possibly a better option than
+			// letting the user tell what curl can / cannot do...
+			if(is_array($this->accepted_compression) && count($this->accepted_compression))
+			{
+				//curl_setopt($curl, CURLOPT_ENCODING, implode(',', $this->accepted_compression));
+				// empty string means 'any supported by CURL' (shall we catch errors in case CURLOPT_SSLKEY undefined ?)
+				if (count($this->accepted_compression) == 1)
+				{
+					curl_setopt($curl, CURLOPT_ENCODING, $this->accepted_compression[0]);
+				}
+				else
+					curl_setopt($curl, CURLOPT_ENCODING, '');
+			}
+			// extra headers
+			$headers = array('Content-Type: ' . $msg->content_type , 'Accept-Charset: ' . implode(',', $this->accepted_charset_encodings));
+			// if no keepalive is wanted, let the server know it in advance
+			if(!$keepalive)
+			{
+				$headers[] = 'Connection: close';
+			}
+			// request compression header
+			if($encoding_hdr)
+			{
+				$headers[] = $encoding_hdr;
+			}
+
+			curl_setopt($curl, CURLOPT_HTTPHEADER, $headers);
+			// timeout is borked
+			if($timeout)
+			{
+				curl_setopt($curl, CURLOPT_TIMEOUT, $timeout == 1 ? 1 : $timeout - 1);
+			}
+
+			if($username && $password)
+			{
+				curl_setopt($curl, CURLOPT_USERPWD, $username.':'.$password);
+				if (defined('CURLOPT_HTTPAUTH'))
+				{
+					curl_setopt($curl, CURLOPT_HTTPAUTH, $authtype);
+				}
+				else if ($authtype != 1)
+				{
+					error_log('XML-RPC: xmlrpc_client::send: warning. Only Basic auth is supported by the current PHP/curl install');
+				}
+			}
+
+			if($method == 'https')
+			{
+				// set cert file
+				if($cert)
+				{
+					curl_setopt($curl, CURLOPT_SSLCERT, $cert);
+				}
+				// set cert password
+				if($certpass)
+				{
+					curl_setopt($curl, CURLOPT_SSLCERTPASSWD, $certpass);
+				}
+				// whether to verify remote host's cert
+				curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, $this->verifypeer);
+				// set ca certificates file/dir
+				if($cacert)
+				{
+					curl_setopt($curl, CURLOPT_CAINFO, $cacert);
+				}
+				if($cacertdir)
+				{
+					curl_setopt($curl, CURLOPT_CAPATH, $cacertdir);
+				}
+				// set key file (shall we catch errors in case CURLOPT_SSLKEY undefined ?)
+				if($key)
+				{
+					curl_setopt($curl, CURLOPT_SSLKEY, $key);
+				}
+				// set key password (shall we catch errors in case CURLOPT_SSLKEY undefined ?)
+				if($keypass)
+				{
+					curl_setopt($curl, CURLOPT_SSLKEYPASSWD, $keypass);
+				}
+				// whether to verify cert's common name (CN); 0 for no, 1 to verify that it exists, and 2 to verify that it matches the hostname used
+				curl_setopt($curl, CURLOPT_SSL_VERIFYHOST, $this->verifyhost);
+			}
+
+			// proxy info
+			if($proxyhost)
+			{
+				if($proxyport == 0)
+				{
+					$proxyport = 8080; // NB: even for HTTPS, local connection is on port 8080
+				}
+				curl_setopt($curl, CURLOPT_PROXY, $proxyhost.':'.$proxyport);
+				//curl_setopt($curl, CURLOPT_PROXYPORT,$proxyport);
+				if($proxyusername)
+				{
+					curl_setopt($curl, CURLOPT_PROXYUSERPWD, $proxyusername.':'.$proxypassword);
+					if (defined('CURLOPT_PROXYAUTH'))
+					{
+						curl_setopt($curl, CURLOPT_PROXYAUTH, $proxyauthtype);
+					}
+					else if ($proxyauthtype != 1)
+					{
+						error_log('XML-RPC: xmlrpc_client::send: warning. Only Basic auth to proxy is supported by the current PHP/curl install');
+					}
+				}
+			}
+
+			// NB: should we build cookie http headers by hand rather than let CURL do it?
+			// the following code does not honour 'expires', 'path' and 'domain' cookie attributes
+			// set to client obj the the user...
+			if (count($this->cookies))
+			{
+				$cookieheader = '';
+				foreach ($this->cookies as $name => $cookie)
+				{
+					$cookieheader .= $name . '=' . $cookie['value'] . '; ';
+				}
+				curl_setopt($curl, CURLOPT_COOKIE, substr($cookieheader, 0, -2));
+			}
+
+			$result = curl_exec($curl);
+
+			if ($this->debug > 1)
+			{
+				print "<PRE>\n---CURL INFO---\n";
+				foreach(curl_getinfo($curl) as $name => $val)
+					 print $name . ': ' . htmlentities($val). "\n";
+				print "---END---\n</PRE>";
+			}
+
+			if(!$result) /// @todo we should use a better check here - what if we get back '' or '0'?
+			{
+				$this->errstr='no response';
+				$resp=&new xmlrpcresp(0, $GLOBALS['xmlrpcerr']['curl_fail'], $GLOBALS['xmlrpcstr']['curl_fail']. ': '. curl_error($curl));
+				curl_close($curl);
+				if($keepalive)
+				{
+					$this->xmlrpc_curl_handle = null;
+				}
+			}
+			else
+			{
+				if(!$keepalive)
+				{
+					curl_close($curl);
+				}
+				$resp =& $msg->parseResponse($result, true, $this->return_type);
+			}
+			return $resp;
+		}
+
+		/**
+		* Send an array of request messages and return an array of responses.
+		* Unless $this->no_multicall has been set to true, it will try first
+		* to use one single xmlrpc call to server method system.multicall, and
+		* revert to sending many successive calls in case of failure.
+		* This failure is also stored in $this->no_multicall for subsequent calls.
+		* Unfortunately, there is no server error code universally used to denote
+		* the fact that multicall is unsupported, so there is no way to reliably
+		* distinguish between that and a temporary failure.
+		* If you are sure that server supports multicall and do not want to
+		* fallback to using many single calls, set the fourth parameter to FALSE.
+		*
+		* NB: trying to shoehorn extra functionality into existing syntax has resulted
+		* in pretty much convoluted code...
+		*
+		* @param array $msgs an array of xmlrpcmsg objects
+		* @param integer $timeout connection timeout (in seconds)
+		* @param string $method the http protocol variant to be used
+		* @param boolean fallback When true, upon receiveing an error during multicall, multiple single calls will be attempted
+		* @return array
+		* @access public
+		*/
+		function multicall($msgs, $timeout=0, $method='', $fallback=true)
+		{
+			if ($method == '')
+			{
+				$method = $this->method;
+			}
+			if(!$this->no_multicall)
+			{
+				$results = $this->_try_multicall($msgs, $timeout, $method);
+				if(is_array($results))
+				{
+					// System.multicall succeeded
+					return $results;
+				}
+				else
+				{
+					// either system.multicall is unsupported by server,
+					// or call failed for some other reason.
+					if ($fallback)
+					{
+						// Don't try it next time...
+						$this->no_multicall = true;
+					}
+					else
+					{
+						if (is_a($results, 'xmlrpcresp'))
+						{
+							$result = $results;
+						}
+						else
+						{
+							$result =& new xmlrpcresp(0, $GLOBALS['xmlrpcerr']['multicall_error'], $GLOBALS['xmlrpcstr']['multicall_error']);
+						}
+					}
+				}
+			}
+			else
+			{
+				// override fallback, in case careless user tries to do two
+				// opposite things at the same time
+				$fallback = true;
+			}
+
+			$results = array();
+			if ($fallback)
+			{
+				// system.multicall is (probably) unsupported by server:
+				// emulate multicall via multiple requests
+				foreach($msgs as $msg)
+				{
+					$results[] =& $this->send($msg, $timeout, $method);
+				}
+			}
+			else
+			{
+				// user does NOT want to fallback on many single calls:
+				// since we should always return an array of responses,
+				// return an array with the same error repeated n times
+				foreach($msgs as $msg)
+				{
+					$results[] = $result;
+				}
+			}
+			return $results;
+		}
+
+		/**
+		* Attempt to boxcar $msgs via system.multicall.
+		* Returns either an array of xmlrpcreponses, an xmlrpc error response
+		* or false (when received response does not respect valid multicall syntax)
+		* @access private
+		*/
+		function _try_multicall($msgs, $timeout, $method)
+		{
+			// Construct multicall message
+			$calls = array();
+			foreach($msgs as $msg)
+			{
+				$call['methodName'] =& new xmlrpcval($msg->method(),'string');
+				$numParams = $msg->getNumParams();
+				$params = array();
+				for($i = 0; $i < $numParams; $i++)
+				{
+					$params[$i] = $msg->getParam($i);
+				}
+				$call['params'] =& new xmlrpcval($params, 'array');
+				$calls[] =& new xmlrpcval($call, 'struct');
+			}
+			$multicall =& new xmlrpcmsg('system.multicall');
+			$multicall->addParam(new xmlrpcval($calls, 'array'));
+
+			// Attempt RPC call
+			$result =& $this->send($multicall, $timeout, $method);
+
+			if($result->faultCode() != 0)
+			{
+				// call to system.multicall failed
+				return $result;
+			}
+
+			// Unpack responses.
+			$rets = $result->value();
+
+			if ($this->return_type == 'xml')
+			{
+					return $rets;
+			}
+			else if ($this->return_type == 'phpvals')
+			{
+				///@todo test this code branch...
+				$rets = $result->value();
+				if(!is_array($rets))
+				{
+					return false;		// bad return type from system.multicall
+				}
+				$numRets = count($rets);
+				if($numRets != count($msgs))
+				{
+					return false;		// wrong number of return values.
+				}
+
+				$response = array();
+				for($i = 0; $i < $numRets; $i++)
+				{
+					$val = $rets[$i];
+					if (!is_array($val)) {
+						return false;
+					}
+					switch(count($val))
+					{
+						case 1:
+							if(!isset($val[0]))
+							{
+								return false;		// Bad value
+							}
+							// Normal return value
+							$response[$i] =& new xmlrpcresp($val[0], 0, '', 'phpvals');
+							break;
+						case 2:
+							///	@todo remove usage of @: it is apparently quite slow
+							$code = @$val['faultCode'];
+							if(!is_int($code))
+							{
+								return false;
+							}
+							$str = @$val['faultString'];
+							if(!is_string($str))
+							{
+								return false;
+							}
+							$response[$i] =& new xmlrpcresp(0, $code, $str);
+							break;
+						default:
+							return false;
+					}
+				}
+				return $response;
+			}
+			else // return type == 'xmlrpcvals'
+			{
+				$rets = $result->value();
+				if($rets->kindOf() != 'array')
+				{
+					return false;		// bad return type from system.multicall
+				}
+				$numRets = $rets->arraysize();
+				if($numRets != count($msgs))
+				{
+					return false;		// wrong number of return values.
+				}
+
+				$response = array();
+				for($i = 0; $i < $numRets; $i++)
+				{
+					$val = $rets->arraymem($i);
+					switch($val->kindOf())
+					{
+						case 'array':
+							if($val->arraysize() != 1)
+							{
+								return false;		// Bad value
+							}
+							// Normal return value
+							$response[$i] =& new xmlrpcresp($val->arraymem(0));
+							break;
+						case 'struct':
+							$code = $val->structmem('faultCode');
+							if($code->kindOf() != 'scalar' || $code->scalartyp() != 'int')
+							{
+								return false;
+							}
+							$str = $val->structmem('faultString');
+							if($str->kindOf() != 'scalar' || $str->scalartyp() != 'string')
+							{
+								return false;
+							}
+							$response[$i] =& new xmlrpcresp(0, $code->scalarval(), $str->scalarval());
+							break;
+						default:
+							return false;
+					}
+				}
+				return $response;
+			}
+		}
+	} // end class xmlrpc_client
+
+	class xmlrpcresp
+	{
+		var $val = 0;
+		var $valtyp;
+		var $errno = 0;
+		var $errstr = '';
+		var $payload;
+		var $hdrs = array();
+		var $_cookies = array();
+		var $content_type = 'text/xml';
+		var $raw_data = '';
+
+		/**
+		* @param mixed $val either an xmlrpcval obj, a php value or the xml serialization of an xmlrpcval (a string)
+		* @param integer $fcode set it to anything but 0 to create an error response
+		* @param string $fstr the error string, in case of an error response
+		* @param string $valtyp either 'xmlrpcvals', 'phpvals' or 'xml'
+		*
+		* @todo add check that $val / $fcode / $fstr is of correct type???
+		* NB: as of now we do not do it, since it might be either an xmlrpcval or a plain
+		* php val, or a complete xml chunk, depending on usage of xmlrpc_client::send() inside which creator is called...
+		*/
+		function xmlrpcresp($val, $fcode = 0, $fstr = '', $valtyp='')
+		{
+			if($fcode != 0)
+			{
+				// error response
+				$this->errno = $fcode;
+				$this->errstr = $fstr;
+				//$this->errstr = htmlspecialchars($fstr); // XXX: encoding probably shouldn't be done here; fix later.
+			}
+			else
+			{
+				// successful response
+				$this->val = $val;
+				if ($valtyp == '')
+				{
+					// user did not declare type of response value: try to guess it
+					if (is_object($this->val) && is_a($this->val, 'xmlrpcval'))
+					{
+						$this->valtyp = 'xmlrpcvals';
+					}
+					else if (is_string($this->val))
+					{
+						$this->valtyp = 'xml';
+
+					}
+					else
+					{
+						$this->valtyp = 'phpvals';
+					}
+				}
+				else
+				{
+					// user declares type of resp value: believe him
+					$this->valtyp = $valtyp;
+				}
+			}
+			@ob_get_clean();
+		}
+
+		/**
+		* Returns the error code of the response.
+		* @return integer the error code of this response (0 for not-error responses)
+		* @access public
+		*/
+		function faultCode()
+		{
+			return $this->errno;
+		}
+
+		/**
+		* Returns the error code of the response.
+		* @return string the error string of this response ('' for not-error responses)
+		* @access public
+		*/
+		function faultString()
+		{
+			return $this->errstr;
+		}
+
+		/**
+		* Returns the value received by the server.
+		* @return mixed the xmlrpcval object returned by the server. Might be an xml string or php value if the response has been created by specially configured xmlrpc_client objects
+		* @access public
+		*/
+		function value()
+		{
+			return $this->val;
+		}
+
+		/**
+		* Returns an array with the cookies received from the server.
+		* Array has the form: $cookiename => array ('value' => $val, $attr1 => $val1, $attr2 = $val2, ...)
+		* with attributes being e.g. 'expires', 'path', domain'.
+		* NB: cookies sent as 'expired' by the server (i.e. with an expiry date in the past)
+		* are still present in the array. It is up to the user-defined code to decide
+		* how to use the received cookies, and wheter they have to be sent back with the next
+		* request to the server (using xmlrpc_client::setCookie) or not
+		* @return array array of cookies received from the server
+		* @access public
+		*/
+		function cookies()
+		{
+			return $this->_cookies;
+		}
+
+		/**
+		* Returns xml representation of the response. XML prologue not included
+		* @param string $charset_encoding the charset to be used for serialization. if null, US-ASCII is assumed
+		* @return string the xml representation of the response
+		* @access public
+		*/
+		function serialize($charset_encoding='')
+		{
+			if ($charset_encoding != '')
+				$this->content_type = 'text/xml; charset=' . $charset_encoding;
+			else
+				$this->content_type = 'text/xml';
+			$result = "<methodResponse>\n";
+			if($this->errno)
+			{
+				// G. Giunta 2005/2/13: let non-ASCII response messages be tolerated by clients
+				// by xml-encoding non ascii chars
+				$result .= "<fault>\n" .
+"<value>\n<struct><member><name>faultCode</name>\n<value><int>" . $this->errno .
+"</int></value>\n</member>\n<member>\n<name>faultString</name>\n<value><string>" .
+xmlrpc_encode_entitites($this->errstr, $GLOBALS['xmlrpc_internalencoding'], $charset_encoding) . "</string></value>\n</member>\n" .
+"</struct>\n</value>\n</fault>";
+			}
+			else
+			{
+				if(!is_object($this->val) || !is_a($this->val, 'xmlrpcval'))
+				{
+					if (is_string($this->val) && $this->valtyp == 'xml')
+					{
+						$result .= "<params>\n<param>\n" .
+							$this->val .
+							"</param>\n</params>";
+					}
+					else
+					{
+						/// @todo try to build something serializable?
+						die('cannot serialize xmlrpcresp objects whose content is native php values');
+					}
+				}
+				else
+				{
+					$result .= "<params>\n<param>\n" .
+						$this->val->serialize($charset_encoding) .
+						"</param>\n</params>";
+				}
+			}
+			$result .= "\n</methodResponse>";
+			$this->payload = $result;
+			return $result;
+		}
+	}
+
+	class xmlrpcmsg
+	{
+		var $payload;
+		var $methodname;
+		var $params=array();
+		var $debug=0;
+		var $content_type = 'text/xml';
+
+		/**
+		* @param string $meth the name of the method to invoke
+		* @param array $pars array of parameters to be paased to the method (xmlrpcval objects)
+		*/
+		function xmlrpcmsg($meth, $pars=0)
+		{
+			$this->methodname=$meth;
+			if(is_array($pars) && count($pars)>0)
+			{
+				for($i=0; $i<count($pars); $i++)
+				{
+					$this->addParam($pars[$i]);
+				}
+			}
+		}
+
+		/**
+		* @access private
+		*/
+		function xml_header($charset_encoding='')
+		{
+			if ($charset_encoding != '')
+			{
+				return "<?xml version=\"1.0\" encoding=\"$charset_encoding\" ?" . ">\n<methodCall>\n";
+			}
+			else
+			{
+				return "<?xml version=\"1.0\"?" . ">\n<methodCall>\n";
+			}
+		}
+
+		/**
+		* @access private
+		*/
+		function xml_footer()
+		{
+			return '</methodCall>';
+		}
+
+		/**
+		* @access private
+		*/
+		function kindOf()
+		{
+			return 'msg';
+		}
+
+		/**
+		* @access private
+		*/
+		function createPayload($charset_encoding='')
+		{
+			if ($charset_encoding != '')
+				$this->content_type = 'text/xml; charset=' . $charset_encoding;
+			else
+				$this->content_type = 'text/xml';
+			$this->payload=$this->xml_header($charset_encoding);
+			$this->payload.='<methodName>' . $this->methodname . "</methodName>\n";
+			$this->payload.="<params>\n";
+			for($i=0; $i<count($this->params); $i++)
+			{
+				$p=$this->params[$i];
+				$this->payload.="<param>\n" . $p->serialize($charset_encoding) .
+				"</param>\n";
+			}
+			$this->payload.="</params>\n";
+			$this->payload.=$this->xml_footer();
+		}
+
+		/**
+		* Gets/sets the xmlrpc method to be invoked
+		* @param string $meth the method to be set (leave empty not to set it)
+		* @return string the method that will be invoked
+		* @access public
+		*/
+		function method($meth='')
+		{
+			if($meth!='')
+			{
+				$this->methodname=$meth;
+			}
+			return $this->methodname;
+		}
+
+		/**
+		* Returns xml representation of the message. XML prologue included
+		* @return string the xml representation of the message, xml prologue included
+		* @access public
+		*/
+		function serialize($charset_encoding='')
+		{
+			$this->createPayload($charset_encoding);
+			return $this->payload;
+		}
+
+		/**
+		* Add a parameter to the list of parameters to be used upon method invocation
+		* @param xmlrpcval $par
+		* @return boolean false on failure
+		* @access public
+		*/
+		function addParam($par)
+		{
+			// add check: do not add to self params which are not xmlrpcvals
+			if(is_object($par) && is_a($par, 'xmlrpcval'))
+			{
+				$this->params[]=$par;
+				return true;
+			}
+			else
+			{
+				return false;
+			}
+		}
+
+		/**
+		* Returns the nth parameter in the message. The index zero-based.
+		* @param integer $i the index of the parameter to fetch (zero based)
+		* @return xmlrpcval the i-th parameter
+		* @access public
+		*/
+		function getParam($i) { return $this->params[$i]; }
+
+		/**
+		* Returns the number of parameters in the messge.
+		* @return integer the number of parameters currently set
+		* @access public
+		*/
+		function getNumParams() { return count($this->params); }
+
+		/**
+		* Given an open file handle, read all data available and parse it as axmlrpc response.
+		* NB: the file handle is not closed by this function.
+		* @access public
+		* @return xmlrpcresp
+		* @todo add 2nd & 3rd param to be passed to ParseResponse() ???
+		*/
+		function &parseResponseFile($fp)
+		{
+			$ipd='';
+			while($data=fread($fp, 32768))
+			{
+				$ipd.=$data;
+			}
+			//fclose($fp);
+			$r =& $this->parseResponse($ipd);
+			return $r;
+		}
+
+		/**
+		* Parses HTTP headers and separates them from data.
+		* @access private
+		*/
+		function &parseResponseHeaders(&$data, $headers_processed=false)
+		{
+				// Support "web-proxy-tunelling" connections for https through proxies
+				if(preg_match('/^HTTP\/1\.[0-1] 200 Connection established/', $data))
+				{
+					// Look for CR/LF or simple LF as line separator,
+					// (even though it is not valid http)
+					$pos = strpos($data,"\r\n\r\n");
+					if($pos || is_int($pos))
+					{
+						$bd = $pos+4;
+					}
+					else
+					{
+						$pos = strpos($data,"\n\n");
+						if($pos || is_int($pos))
+						{
+							$bd = $pos+2;
+						}
+						else
+						{
+							// No separation between response headers and body: fault?
+							$bd = 0;
+						}
+					}
+					if ($bd)
+					{
+						// this filters out all http headers from proxy.
+						// maybe we could take them into account, too?
+						$data = substr($data, $bd);
+					}
+					else
+					{
+						error_log('XML-RPC: xmlrpcmsg::parseResponse: HTTPS via proxy error, tunnel connection possibly failed');
+						$r=&new xmlrpcresp(0, $GLOBALS['xmlrpcerr']['http_error'], $GLOBALS['xmlrpcstr']['http_error']. ' (HTTPS via proxy error, tunnel connection possibly failed)');
+						return $r;
+					}
+				}
+
+				// Strip HTTP 1.1 100 Continue header if present
+				while(preg_match('/^HTTP\/1\.1 1[0-9]{2} /', $data))
+				{
+					$pos = strpos($data, 'HTTP', 12);
+					// server sent a Continue header without any (valid) content following...
+					// give the client a chance to know it
+					if(!$pos && !is_int($pos)) // works fine in php 3, 4 and 5
+					{
+						break;
+					}
+					$data = substr($data, $pos);
+				}
+				if(!preg_match('/^HTTP\/[0-9.]+ 200 /', $data))
+				{
+					$errstr= substr($data, 0, strpos($data, "\n")-1);
+					error_log('XML-RPC: xmlrpcmsg::parseResponse: HTTP error, got response: ' .$errstr);
+					$r=&new xmlrpcresp(0, $GLOBALS['xmlrpcerr']['http_error'], $GLOBALS['xmlrpcstr']['http_error']. ' (' . $errstr . ')');
+					return $r;
+				}
+
+				$GLOBALS['_xh']['headers'] = array();
+				$GLOBALS['_xh']['cookies'] = array();
+
+				// be tolerant to usage of \n instead of \r\n to separate headers and data
+				// (even though it is not valid http)
+				$pos = strpos($data,"\r\n\r\n");
+				if($pos || is_int($pos))
+				{
+					$bd = $pos+4;
+				}
+				else
+				{
+					$pos = strpos($data,"\n\n");
+					if($pos || is_int($pos))
+					{
+						$bd = $pos+2;
+					}
+					else
+					{
+						// No separation between response headers and body: fault?
+						// we could take some action here instead of going on...
+						$bd = 0;
+					}
+				}
+				// be tolerant to line endings, and extra empty lines
+				$ar = split("\r?\n", trim(substr($data, 0, $pos)));
+				while(list(,$line) = @each($ar))
+				{
+					// take care of multi-line headers and cookies
+					$arr = explode(':',$line,2);
+					if(count($arr) > 1)
+					{
+						$header_name = strtolower(trim($arr[0]));
+						/// @todo some other headers (the ones that allow a CSV list of values)
+						/// do allow many values to be passed using multiple header lines.
+						/// We should add content to $GLOBALS['_xh']['headers'][$header_name]
+						/// instead of replacing it for those...
+						if ($header_name == 'set-cookie' || $header_name == 'set-cookie2')
+						{
+							if ($header_name == 'set-cookie2')
+							{
+								// version 2 cookies:
+								// there could be many cookies on one line, comma separated
+								$cookies = explode(',', $arr[1]);
+							}
+							else
+							{
+								$cookies = array($arr[1]);
+							}
+							foreach ($cookies as $cookie)
+							{
+								// glue together all received cookies, using a comma to separate them
+								// (same as php does with getallheaders())
+								if (isset($GLOBALS['_xh']['headers'][$header_name]))
+									$GLOBALS['_xh']['headers'][$header_name] .= ', ' . trim($cookie);
+								else
+									$GLOBALS['_xh']['headers'][$header_name] = trim($cookie);
+								// parse cookie attributes, in case user wants to correctly honour them
+								// feature creep: only allow rfc-compliant cookie attributes?
+								// @todo support for server sending multiple time cookie with same name, but using different PATHs
+								$cookie = explode(';', $cookie);
+								foreach ($cookie as $pos => $val)
+								{
+									$val = explode('=', $val, 2);
+									$tag = trim($val[0]);
+									$val = trim(@$val[1]);
+									/// @todo with version 1 cookies, we should strip leading and trailing " chars
+									if ($pos == 0)
+									{
+										$cookiename = $tag;
+										$GLOBALS['_xh']['cookies'][$tag] = array();
+										$GLOBALS['_xh']['cookies'][$cookiename]['value'] = urldecode($val);
+									}
+									else
+									{
+										if ($tag != 'value')
+										{
+										  $GLOBALS['_xh']['cookies'][$cookiename][$tag] = $val;
+										}
+									}
+								}
+							}
+						}
+						else
+						{
+							$GLOBALS['_xh']['headers'][$header_name] = trim($arr[1]);
+						}
+					}
+					elseif(isset($header_name))
+					{
+						///	@todo version1 cookies might span multiple lines, thus breaking the parsing above
+						$GLOBALS['_xh']['headers'][$header_name] .= ' ' . trim($line);
+					}
+				}
+
+				$data = substr($data, $bd);
+
+				if($this->debug && count($GLOBALS['_xh']['headers']))
+				{
+					print '<PRE>';
+					foreach($GLOBALS['_xh']['headers'] as $header => $value)
+					{
+						print htmlentities("HEADER: $header: $value\n");
+					}
+					foreach($GLOBALS['_xh']['cookies'] as $header => $value)
+					{
+						print htmlentities("COOKIE: $header={$value['value']}\n");
+					}
+					print "</PRE>\n";
+				}
+
+				// if CURL was used for the call, http headers have been processed,
+				// and dechunking + reinflating have been carried out
+				if(!$headers_processed)
+				{
+					// Decode chunked encoding sent by http 1.1 servers
+					if(isset($GLOBALS['_xh']['headers']['transfer-encoding']) && $GLOBALS['_xh']['headers']['transfer-encoding'] == 'chunked')
+					{
+						if(!$data = decode_chunked($data))
+						{
+							error_log('XML-RPC: xmlrpcmsg::parseResponse: errors occurred when trying to rebuild the chunked data received from server');
+							$r =& new xmlrpcresp(0, $GLOBALS['xmlrpcerr']['dechunk_fail'], $GLOBALS['xmlrpcstr']['dechunk_fail']);
+							return $r;
+						}
+					}
+
+					// Decode gzip-compressed stuff
+					// code shamelessly inspired from nusoap library by Dietrich Ayala
+					if(isset($GLOBALS['_xh']['headers']['content-encoding']))
+					{
+						$GLOBALS['_xh']['headers']['content-encoding'] = str_replace('x-', '', $GLOBALS['_xh']['headers']['content-encoding']);
+						if($GLOBALS['_xh']['headers']['content-encoding'] == 'deflate' || $GLOBALS['_xh']['headers']['content-encoding'] == 'gzip')
+						{
+							// if decoding works, use it. else assume data wasn't gzencoded
+							if(function_exists('gzinflate'))
+							{
+								if($GLOBALS['_xh']['headers']['content-encoding'] == 'deflate' && $degzdata = @gzuncompress($data))
+								{
+									$data = $degzdata;
+									if($this->debug)
+									print "<PRE>---INFLATED RESPONSE---[".strlen($data)." chars]---\n" . htmlentities($data) . "\n---END---</PRE>";
+								}
+								elseif($GLOBALS['_xh']['headers']['content-encoding'] == 'gzip' && $degzdata = @gzinflate(substr($data, 10)))
+								{
+									$data = $degzdata;
+									if($this->debug)
+									print "<PRE>---INFLATED RESPONSE---[".strlen($data)." chars]---\n" . htmlentities($data) . "\n---END---</PRE>";
+								}
+								else
+								{
+									error_log('XML-RPC: xmlrpcmsg::parseResponse: errors occurred when trying to decode the deflated data received from server');
+									$r =& new xmlrpcresp(0, $GLOBALS['xmlrpcerr']['decompress_fail'], $GLOBALS['xmlrpcstr']['decompress_fail']);
+									return $r;
+								}
+							}
+							else
+							{
+								error_log('XML-RPC: xmlrpcmsg::parseResponse: the server sent deflated data. Your php install must have the Zlib extension compiled in to support this.');
+								$r =& new xmlrpcresp(0, $GLOBALS['xmlrpcerr']['cannot_decompress'], $GLOBALS['xmlrpcstr']['cannot_decompress']);
+								return $r;
+							}
+						}
+					}
+				} // end of 'if needed, de-chunk, re-inflate response'
+
+				// real stupid hack to avoid PHP 4 complaining about returning NULL by ref
+				$r = null;
+				$r =& $r;
+				return $r;
+		}
+
+		/**
+		* Parse the xmlrpc response contained in the string $data and return an xmlrpcresp object.
+		* @param string $data the xmlrpc response, eventually including http headers
+		* @param bool $headers_processed when true prevents parsing HTTP headers for interpretation of content-encoding and consequent decoding
+		* @param string $return_type decides return type, i.e. content of response->value(). Either 'xmlrpcvals', 'xml' or 'phpvals'
+		* @return xmlrpcresp
+		* @access public
+		*/
+		function &parseResponse($data='', $headers_processed=false, $return_type='xmlrpcvals')
+		{
+			if($this->debug)
+			{
+				//by maHo, replaced htmlspecialchars with htmlentities
+				print "<PRE>---GOT---\n" . htmlentities($data) . "\n---END---\n</PRE>";
+			}
+
+			if($data == '')
+			{
+				error_log('XML-RPC: xmlrpcmsg::parseResponse: no response received from server.');
+				$r =& new xmlrpcresp(0, $GLOBALS['xmlrpcerr']['no_data'], $GLOBALS['xmlrpcstr']['no_data']);
+				return $r;
+			}
+
+			$GLOBALS['_xh']=array();
+
+			$raw_data = $data;
+			// parse the HTTP headers of the response, if present, and separate them from data
+			if(substr($data, 0, 4) == 'HTTP')
+			{
+				$r =& $this->parseResponseHeaders($data, $headers_processed);
+				if ($r)
+				{
+					// failed processing of HTTP response headers
+					// save into response obj the full payload received, for debugging
+					$r->raw_data = $data;
+					return $r;
+				}
+			}
+			else
+			{
+				$GLOBALS['_xh']['headers'] = array();
+				$GLOBALS['_xh']['cookies'] = array();
+			}
+
+			if($this->debug)
+			{
+				$start = strpos($data, '<!-- SERVER DEBUG INFO (BASE64 ENCODED):');
+				if ($start)
+				{
+					$start += strlen('<!-- SERVER DEBUG INFO (BASE64 ENCODED):');
+					$end = strpos($data, '-->', $start);
+					$comments = substr($data, $start, $end-$start);
+					print "<PRE>---SERVER DEBUG INFO (DECODED) ---\n\t".htmlentities(str_replace("\n", "\n\t", base64_decode($comments)))."\n---END---\n</PRE>";
+				}
+			}
+
+			// be tolerant of extra whitespace in response body
+			$data = trim($data);
+
+			/// @todo return an error msg if $data=='' ?
+
+			// be tolerant of junk after methodResponse (e.g. javascript ads automatically inserted by free hosts)
+			// idea from Luca Mariano <luca.mariano@email.it> originally in PEARified version of the lib
+			$bd = false;
+			// Poor man's version of strrpos for php 4...
+			$pos = strpos($data, '</methodResponse>');
+			while($pos || is_int($pos))
+			{
+				$bd = $pos+17;
+				$pos = strpos($data, '</methodResponse>', $bd);
+			}
+			if($bd)
+			{
+				$data = substr($data, 0, $bd);
+			}
+
+			// if user wants back raw xml, give it to him
+			if ($return_type == 'xml')
+			{
+				$r =& new xmlrpcresp($data, 0, '', 'xml');
+				$r->hdrs = $GLOBALS['_xh']['headers'];
+				$r->_cookies = $GLOBALS['_xh']['cookies'];
+				$r->raw_data = $raw_data;
+				return $r;
+			}
+
+			// try to 'guestimate' the character encoding of the received response
+			$resp_encoding = guess_encoding(@$GLOBALS['_xh']['headers']['content-type'], $data);
+
+			$GLOBALS['_xh']['ac']='';
+			//$GLOBALS['_xh']['qt']=''; //unused...
+			$GLOBALS['_xh']['stack'] = array();
+			$GLOBALS['_xh']['valuestack'] = array();
+			$GLOBALS['_xh']['isf']=0; // 0 = OK, 1 for xmlrpc fault responses, 2 = invalid xmlrpc
+			$GLOBALS['_xh']['isf_reason']='';
+			$GLOBALS['_xh']['rt']=''; // 'methodcall or 'methodresponse'
+
+			// if response charset encoding is not known / supported, try to use
+			// the default encoding and parse the xml anyway, but log a warning...
+			if (!in_array($resp_encoding, array('UTF-8', 'ISO-8859-1', 'US-ASCII')))
+			// the following code might be better for mb_string enabled installs, but
+			// makes the lib about 200% slower...
+			//if (!is_valid_charset($resp_encoding, array('UTF-8', 'ISO-8859-1', 'US-ASCII')))
+			{
+				error_log('XML-RPC: xmlrpcmsg::parseResponse: invalid charset encoding of received response: '.$resp_encoding);
+				$resp_encoding = $GLOBALS['xmlrpc_defencoding'];
+			}
+			$parser = xml_parser_create($resp_encoding);
+			xml_parser_set_option($parser, XML_OPTION_CASE_FOLDING, true);
+			// G. Giunta 2005/02/13: PHP internally uses ISO-8859-1, so we have to tell
+			// the xml parser to give us back data in the expected charset.
+			// What if internal encoding is not in one of the 3 allowed?
+			// we use the broadest one, ie. utf8
+			// This allows to send data which is native in various charset,
+			// by extending xmlrpc_encode_entitites() and setting xmlrpc_internalencoding
+			if (!in_array($GLOBALS['xmlrpc_internalencoding'], array('UTF-8', 'ISO-8859-1', 'US-ASCII')))
+			{
+				xml_parser_set_option($parser, XML_OPTION_TARGET_ENCODING, 'UTF-8');
+			}
+			else
+			{
+				xml_parser_set_option($parser, XML_OPTION_TARGET_ENCODING, $GLOBALS['xmlrpc_internalencoding']);
+			}
+
+			if ($return_type == 'phpvals')
+			{
+				xml_set_element_handler($parser, 'xmlrpc_se', 'xmlrpc_ee_fast');
+			}
+			else
+			{
+				xml_set_element_handler($parser, 'xmlrpc_se', 'xmlrpc_ee');
+			}
+
+			xml_set_character_data_handler($parser, 'xmlrpc_cd');
+			xml_set_default_handler($parser, 'xmlrpc_dh');
+
+			// first error check: xml not well formed
+			if(!xml_parse($parser, $data, count($data)))
+			{
+				// thanks to Peter Kocks <peter.kocks@baygate.com>
+				if((xml_get_current_line_number($parser)) == 1)
+				{
+					$errstr = 'XML error at line 1, check URL';
+				}
+				else
+				{
+					$errstr = sprintf('XML error: %s at line %d, column %d',
+						xml_error_string(xml_get_error_code($parser)),
+						xml_get_current_line_number($parser), xml_get_current_column_number($parser));
+				}
+				error_log($errstr);
+				$r=&new xmlrpcresp(0, $GLOBALS['xmlrpcerr']['invalid_return'], $GLOBALS['xmlrpcstr']['invalid_return'].' ('.$errstr.')');
+				xml_parser_free($parser);
+				if($this->debug)
+				{
+					print $errstr;
+				}
+				$r->hdrs = $GLOBALS['_xh']['headers'];
+				$r->_cookies = $GLOBALS['_xh']['cookies'];
+				$r->raw_data = $raw_data;
+				return $r;
+			}
+			xml_parser_free($parser);
+			// second error check: xml well formed but not xml-rpc compliant
+			if ($GLOBALS['_xh']['isf'] > 1)
+			{
+				if ($this->debug)
+				{
+					/// @todo echo something for user?
+				}
+
+				$r =& new xmlrpcresp(0, $GLOBALS['xmlrpcerr']['invalid_return'],
+				$GLOBALS['xmlrpcstr']['invalid_return'] . ' ' . $GLOBALS['_xh']['isf_reason']);
+			}
+			// third error check: parsing of the response has somehow gone boink.
+			// NB: shall we omit this check, since we trust the parsing code?
+			elseif ($return_type == 'xmlrpcvals' && !is_object($GLOBALS['_xh']['value']))
+			{
+				// something odd has happened
+				// and it's time to generate a client side error
+				// indicating something odd went on
+				$r=&new xmlrpcresp(0, $GLOBALS['xmlrpcerr']['invalid_return'],
+					$GLOBALS['xmlrpcstr']['invalid_return']);
+			}
+			else
+			{
+				if ($this->debug)
+				{
+					print "<PRE>---PARSED---\n";
+					// somehow htmlentities chokes on var_export, and some full html string...
+					//print htmlentitites(var_export($GLOBALS['_xh']['value'], true));
+					print htmlspecialchars(var_export($GLOBALS['_xh']['value'], true));
+					print "\n---END---</PRE>";
+				}
+
+				// note that using =& will raise an error if $GLOBALS['_xh']['st'] does not generate an object.
+				$v =& $GLOBALS['_xh']['value'];
+
+				if($GLOBALS['_xh']['isf'])
+				{
+					/// @todo we should test here if server sent an int and a string,
+					/// and/or coerce them into such...
+					if ($return_type == 'xmlrpcvals')
+					{
+						$errno_v = $v->structmem('faultCode');
+						$errstr_v = $v->structmem('faultString');
+						$errno = $errno_v->scalarval();
+						$errstr = $errstr_v->scalarval();
+					}
+					else
+					{
+						$errno = $v['faultCode'];
+						$errstr = $v['faultString'];
+					}
+
+					if($errno == 0)
+					{
+						// FAULT returned, errno needs to reflect that
+						$errno = -1;
+					}
+
+					$r =& new xmlrpcresp(0, $errno, $errstr);
+				}
+				else
+				{
+					$r=&new xmlrpcresp($v, 0, '', $return_type);
+				}
+			}
+
+			$r->hdrs = $GLOBALS['_xh']['headers'];
+			$r->_cookies = $GLOBALS['_xh']['cookies'];
+			$r->raw_data = $raw_data;
+			return $r;
+		}
+	}
+
+	class xmlrpcval
+	{
+		var $me=array();
+		var $mytype=0;
+		var $_php_class=null;
+
+		/**
+		* @param mixed $val
+		* @param string $type any valid xmlrpc type name (lowercase). If null, 'string' is assumed
+		*/
+		function xmlrpcval($val=-1, $type='')
+		{
+			/// @todo: optimization creep - do not call addXX, do it all inline.
+			/// downside: booleans will not be coerced anymore
+			if($val!==-1 || $type!='')
+			{
+				// optimization creep: inlined all work done by constructor
+				switch($type)
+				{
+					case '':
+						$this->mytype=1;
+						$this->me['string']=$val;
+						break;
+					case 'i4':
+					case 'int':
+					case 'double':
+					case 'string':
+					case 'boolean':
+					case 'dateTime.iso8601':
+					case 'base64':
+					case 'null':
+						$this->mytype=1;
+						$this->me[$type]=$val;
+						break;
+					case 'array':
+						$this->mytype=2;
+						$this->me['array']=$val;
+						break;
+					case 'struct':
+						$this->mytype=3;
+						$this->me['struct']=$val;
+						break;
+					default:
+						error_log("XML-RPC: xmlrpcval::xmlrpcval: not a known type ($type)");
+				}
+				/*if($type=='')
+				{
+					$type='string';
+				}
+				if($GLOBALS['xmlrpcTypes'][$type]==1)
+				{
+					$this->addScalar($val,$type);
+				}
+				elseif($GLOBALS['xmlrpcTypes'][$type]==2)
+				{
+					$this->addArray($val);
+				}
+				elseif($GLOBALS['xmlrpcTypes'][$type]==3)
+				{
+					$this->addStruct($val);
+				}*/
+			}
+		}
+
+		/**
+		* Add a single php value to an (unitialized) xmlrpcval
+		* @param mixed $val
+		* @param string $type
+		* @return int 1 or 0 on failure
+		*/
+		function addScalar($val, $type='string')
+		{
+			$typeof=@$GLOBALS['xmlrpcTypes'][$type];
+			if($typeof!=1)
+			{
+				error_log("XML-RPC: xmlrpcval::addScalar: not a scalar type ($type)");
+				return 0;
+			}
+
+			// coerce booleans into correct values
+			// NB: we should iether do it for datetimes, integers and doubles, too,
+			// or just plain remove this check, implemnted on booleans only...
+			if($type==$GLOBALS['xmlrpcBoolean'])
+			{
+				if(strcasecmp($val,'true')==0 || $val==1 || ($val==true && strcasecmp($val,'false')))
+				{
+					$val=true;
+				}
+				else
+				{
+					$val=false;
+				}
+			}
+
+			switch($this->mytype)
+			{
+				case 1:
+					error_log('XML-RPC: xmlrpcval::addScalar: scalar xmlrpcval can have only one value');
+					return 0;
+				case 3:
+					error_log('XML-RPC: xmlrpcval::addScalar: cannot add anonymous scalar to struct xmlrpcval');
+					return 0;
+				case 2:
+					// we're adding a scalar value to an array here
+					//$ar=$this->me['array'];
+					//$ar[]=&new xmlrpcval($val, $type);
+					//$this->me['array']=$ar;
+					// Faster (?) avoid all the costly array-copy-by-val done here...
+					$this->me['array'][]=&new xmlrpcval($val, $type);
+					return 1;
+				default:
+					// a scalar, so set the value and remember we're scalar
+					$this->me[$type]=$val;
+					$this->mytype=$typeof;
+					return 1;
+			}
+		}
+
+		/**
+		* Add an array of xmlrpcval objects to an xmlrpcval
+		* @param array $vals
+		* @return int 1 or 0 on failure
+		* @access public
+		*
+		* @todo add some checking for $vals to be an array of xmlrpcvals?
+		*/
+		function addArray($vals)
+		{
+			if($this->mytype==0)
+			{
+				$this->mytype=$GLOBALS['xmlrpcTypes']['array'];
+				$this->me['array']=$vals;
+				return 1;
+			}
+			elseif($this->mytype==2)
+			{
+				// we're adding to an array here
+				$this->me['array'] = array_merge($this->me['array'], $vals);
+				return 1;
+			}
+			else
+			{
+				error_log('XML-RPC: xmlrpcval::addArray: already initialized as a [' . $this->kindOf() . ']');
+				return 0;
+			}
+		}
+
+		/**
+		* Add an array of named xmlrpcval objects to an xmlrpcval
+		* @param array $vals
+		* @return int 1 or 0 on failure
+		* @access public
+		*
+		* @todo add some checking for $vals to be an array?
+		*/
+		function addStruct($vals)
+		{
+			if($this->mytype==0)
+			{
+				$this->mytype=$GLOBALS['xmlrpcTypes']['struct'];
+				$this->me['struct']=$vals;
+				return 1;
+			}
+			elseif($this->mytype==3)
+			{
+				// we're adding to a struct here
+				$this->me['struct'] = array_merge($this->me['struct'], $vals);
+				return 1;
+			}
+			else
+			{
+				error_log('XML-RPC: xmlrpcval::addStruct: already initialized as a [' . $this->kindOf() . ']');
+				return 0;
+			}
+		}
+
+		// poor man's version of print_r ???
+		// DEPRECATED!
+		function dump($ar)
+		{
+			foreach($ar as $key => $val)
+			{
+				echo "$key => $val<br />";
+				if($key == 'array')
+				{
+					while(list($key2, $val2) = each($val))
+					{
+						echo "-- $key2 => $val2<br />";
+					}
+				}
+			}
+		}
+
+		/**
+		* Returns a string containing "struct", "array" or "scalar" describing the base type of the value
+		* @return string
+		* @access public
+		*/
+		function kindOf()
+		{
+			switch($this->mytype)
+			{
+				case 3:
+					return 'struct';
+					break;
+				case 2:
+					return 'array';
+					break;
+				case 1:
+					return 'scalar';
+					break;
+				default:
+					return 'undef';
+			}
+		}
+
+		/**
+		* @access private
+		*/
+		function serializedata($typ, $val, $charset_encoding='')
+		{
+			$rs='';
+			switch(@$GLOBALS['xmlrpcTypes'][$typ])
+			{
+				case 1:
+					switch($typ)
+					{
+						case $GLOBALS['xmlrpcBase64']:
+							$rs.="<${typ}>" . base64_encode($val) . "</${typ}>";
+							break;
+						case $GLOBALS['xmlrpcBoolean']:
+							$rs.="<${typ}>" . ($val ? '1' : '0') . "</${typ}>";
+							break;
+						case $GLOBALS['xmlrpcString']:
+							// G. Giunta 2005/2/13: do NOT use htmlentities, since
+							// it will produce named html entities, which are invalid xml
+							$rs.="<${typ}>" . xmlrpc_encode_entitites($val, $GLOBALS['xmlrpc_internalencoding'], $charset_encoding). "</${typ}>";
+							break;
+						case $GLOBALS['xmlrpcInt']:
+						case $GLOBALS['xmlrpcI4']:
+							$rs.="<${typ}>".(int)$val."</${typ}>";
+							break;
+						case $GLOBALS['xmlrpcDouble']:
+							$rs.="<${typ}>".(double)$val."</${typ}>";
+							break;
+						case $GLOBALS['xmlrpcNull']:
+							$rs.="<nil/>";
+							break;
+						default:
+							// no standard type value should arrive here, but provide a possibility
+							// for xmlrpcvals of unknown type...
+							$rs.="<${typ}>${val}</${typ}>";
+					}
+					break;
+				case 3:
+					// struct
+					if ($this->_php_class)
+					{
+						$rs.='<struct php_class="' . $this->_php_class . "\">\n";
+					}
+					else
+					{
+						$rs.="<struct>\n";
+					}
+					foreach($val as $key2 => $val2)
+					{
+						$rs.='<member><name>'.xmlrpc_encode_entitites($key2, $GLOBALS['xmlrpc_internalencoding'], $charset_encoding)."</name>\n";
+						//$rs.=$this->serializeval($val2);
+						$rs.=$val2->serialize($charset_encoding);
+						$rs.="</member>\n";
+					}
+					$rs.='</struct>';
+					break;
+				case 2:
+					// array
+					$rs.="<array>\n<data>\n";
+					for($i=0; $i<count($val); $i++)
+					{
+						//$rs.=$this->serializeval($val[$i]);
+						$rs.=$val[$i]->serialize($charset_encoding);
+					}
+					$rs.="</data>\n</array>";
+					break;
+				default:
+					break;
+			}
+			return $rs;
+		}
+
+		/**
+		* Returns xml representation of the value. XML prologue not included
+		* @param string $charset_encoding the charset to be used for serialization. if null, US-ASCII is assumed
+		* @return string
+		* @access public
+		*/
+		function serialize($charset_encoding='')
+		{
+			// add check? slower, but helps to avoid recursion in serializing broken xmlrpcvals...
+			//if (is_object($o) && (get_class($o) == 'xmlrpcval' || is_subclass_of($o, 'xmlrpcval')))
+			//{
+				reset($this->me);
+				list($typ, $val) = each($this->me);
+				return '<value>' . $this->serializedata($typ, $val, $charset_encoding) . "</value>\n";
+			//}
+		}
+
+		// DEPRECATED
+		function serializeval($o)
+		{
+			// add check? slower, but helps to avoid recursion in serializing broken xmlrpcvals...
+			//if (is_object($o) && (get_class($o) == 'xmlrpcval' || is_subclass_of($o, 'xmlrpcval')))
+			//{
+				$ar=$o->me;
+				reset($ar);
+				list($typ, $val) = each($ar);
+				return '<value>' . $this->serializedata($typ, $val) . "</value>\n";
+			//}
+		}
+
+		/**
+		* Checks wheter a struct member with a given name is present.
+		* Works only on xmlrpcvals of type struct.
+		* @param string $m the name of the struct member to be looked up
+		* @return boolean
+		* @access public
+		*/
+		function structmemexists($m)
+		{
+			return array_key_exists($m, $this->me['struct']);
+		}
+
+		/**
+		* Returns the value of a given struct member (an xmlrpcval object in itself).
+		* Will raise a php warning if struct member of given name does not exist
+		* @param string $m the name of the struct member to be looked up
+		* @return xmlrpcval
+		* @access public
+		*/
+		function structmem($m)
+		{
+			return $this->me['struct'][$m];
+		}
+
+		/**
+		* Reset internal pointer for xmlrpcvals of type struct.
+		* @access public
+		*/
+		function structreset()
+		{
+			reset($this->me['struct']);
+		}
+
+		/**
+		* Return next member element for xmlrpcvals of type struct.
+		* @return xmlrpcval
+		* @access public
+		*/
+		function structeach()
+		{
+			return each($this->me['struct']);
+		}
+
+		// DEPRECATED! this code looks like it is very fragile and has not been fixed
+		// for a long long time. Shall we remove it for 2.0?
+		function getval()
+		{
+			// UNSTABLE
+			reset($this->me);
+			list($a,$b)=each($this->me);
+			// contributed by I Sofer, 2001-03-24
+			// add support for nested arrays to scalarval
+			// i've created a new method here, so as to
+			// preserve back compatibility
+
+			if(is_array($b))
+			{
+				@reset($b);
+				while(list($id,$cont) = @each($b))
+				{
+					$b[$id] = $cont->scalarval();
+				}
+			}
+
+			// add support for structures directly encoding php objects
+			if(is_object($b))
+			{
+				$t = get_object_vars($b);
+				@reset($t);
+				while(list($id,$cont) = @each($t))
+				{
+					$t[$id] = $cont->scalarval();
+				}
+				@reset($t);
+				while(list($id,$cont) = @each($t))
+				{
+					@$b->$id = $cont;
+				}
+			}
+			// end contrib
+			return $b;
+		}
+
+		/**
+		* Returns the value of a scalar xmlrpcval
+		* @return mixed
+		* @access public
+		*/
+		function scalarval()
+		{
+			reset($this->me);
+			list(,$b)=each($this->me);
+			return $b;
+		}
+
+		/**
+		* Returns the type of the xmlrpcval.
+		* For integers, 'int' is always returned in place of 'i4'
+		* @return string
+		* @access public
+		*/
+		function scalartyp()
+		{
+			reset($this->me);
+			list($a,)=each($this->me);
+			if($a==$GLOBALS['xmlrpcI4'])
+			{
+				$a=$GLOBALS['xmlrpcInt'];
+			}
+			return $a;
+		}
+
+		/**
+		* Returns the m-th member of an xmlrpcval of struct type
+		* @param integer $m the index of the value to be retrieved (zero based)
+		* @return xmlrpcval
+		* @access public
+		*/
+		function arraymem($m)
+		{
+			return $this->me['array'][$m];
+		}
+
+		/**
+		* Returns the number of members in an xmlrpcval of array type
+		* @return integer
+		* @access public
+		*/
+		function arraysize()
+		{
+			return count($this->me['array']);
+		}
+
+		/**
+		* Returns the number of members in an xmlrpcval of struct type
+		* @return integer
+		* @access public
+		*/
+		function structsize()
+		{
+			return count($this->me['struct']);
+		}
+	}
+
+
+	// date helpers
+
+	/**
+	* Given a timestamp, return the corresponding ISO8601 encoded string.
+	*
+	* Really, timezones ought to be supported
+	* but the XML-RPC spec says:
+	*
+	* "Don't assume a timezone. It should be specified by the server in its
+	* documentation what assumptions it makes about timezones."
+	*
+	* These routines always assume localtime unless
+	* $utc is set to 1, in which case UTC is assumed
+	* and an adjustment for locale is made when encoding
+	*
+	* @param int $timet (timestamp)
+	* @param int $utc (0 or 1)
+	* @return string
+	*/
+	function iso8601_encode($timet, $utc=0)
+	{
+		if(!$utc)
+		{
+			$t=strftime("%Y%m%dT%H:%M:%S", $timet);
+		}
+		else
+		{
+			if(function_exists('gmstrftime'))
+			{
+				// gmstrftime doesn't exist in some versions
+				// of PHP
+				$t=gmstrftime("%Y%m%dT%H:%M:%S", $timet);
+			}
+			else
+			{
+				$t=strftime("%Y%m%dT%H:%M:%S", $timet-date('Z'));
+			}
+		}
+		return $t;
+	}
+
+	/**
+	* Given an ISO8601 date string, return a timet in the localtime, or UTC
+	* @param string $idate
+	* @param int $utc either 0 or 1
+	* @return int (datetime)
+	*/
+	function iso8601_decode($idate, $utc=0)
+	{
+		$t=0;
+		if(preg_match('/([0-9]{4})([0-9]{2})([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})/', $idate, $regs))
+		{
+			if($utc)
+			{
+				$t=gmmktime($regs[4], $regs[5], $regs[6], $regs[2], $regs[3], $regs[1]);
+			}
+			else
+			{
+				$t=mktime($regs[4], $regs[5], $regs[6], $regs[2], $regs[3], $regs[1]);
+			}
+		}
+		return $t;
+	}
+
+	/**
+	* Takes an xmlrpc value in PHP xmlrpcval object format and translates it into native PHP types.
+	*
+	* Works with xmlrpc message objects as input, too.
+	*
+	* Given proper options parameter, can rebuild generic php object instances
+	* (provided those have been encoded to xmlrpc format using a corresponding
+	* option in php_xmlrpc_encode())
+	* PLEASE NOTE that rebuilding php objects involves calling their constructor function.
+	* This means that the remote communication end can decide which php code will
+	* get executed on your server, leaving the door possibly open to 'php-injection'
+	* style of attacks (provided you have some classes defined on your server that
+	* might wreak havoc if instances are built outside an appropriate context).
+	* Make sure you trust the remote server/client before eanbling this!
+	*
+	* @author Dan Libby (dan@libby.com)
+	*
+	* @param xmlrpcval $xmlrpc_val
+	* @param array $options if 'decode_php_objs' is set in the options array, xmlrpc structs can be decoded into php objects
+	* @return mixed
+	*/
+	function php_xmlrpc_decode($xmlrpc_val, $options=array())
+	{
+		switch($xmlrpc_val->kindOf())
+		{
+			case 'scalar':
+				if (in_array('extension_api', $options))
+				{
+					reset($xmlrpc_val->me);
+					list($typ,$val) = each($xmlrpc_val->me);
+					switch ($typ)
+					{
+						case 'dateTime.iso8601':
+							$xmlrpc_val->scalar = $val;
+							$xmlrpc_val->xmlrpc_type = 'datetime';
+							$xmlrpc_val->timestamp = iso8601_decode($val);
+							return $xmlrpc_val;
+						case 'base64':
+							$xmlrpc_val->scalar = $val;
+							$xmlrpc_val->type = $typ;
+							return $xmlrpc_val;
+						default:
+							return $xmlrpc_val->scalarval();
+					}
+				}
+				return $xmlrpc_val->scalarval();
+			case 'array':
+				$size = $xmlrpc_val->arraysize();
+				$arr = array();
+				for($i = 0; $i < $size; $i++)
+				{
+					$arr[] = php_xmlrpc_decode($xmlrpc_val->arraymem($i), $options);
+				}
+				return $arr;
+			case 'struct':
+				$xmlrpc_val->structreset();
+				// If user said so, try to rebuild php objects for specific struct vals.
+				/// @todo should we raise a warning for class not found?
+				// shall we check for proper subclass of xmlrpcval instead of
+				// presence of _php_class to detect what we can do?
+				if (in_array('decode_php_objs', $options) && $xmlrpc_val->_php_class != ''
+					&& class_exists($xmlrpc_val->_php_class))
+				{
+					$obj = @new $xmlrpc_val->_php_class;
+					while(list($key,$value)=$xmlrpc_val->structeach())
+					{
+						$obj->$key = php_xmlrpc_decode($value, $options);
+					}
+					return $obj;
+				}
+				else
+				{
+					$arr = array();
+					while(list($key,$value)=$xmlrpc_val->structeach())
+					{
+						$arr[$key] = php_xmlrpc_decode($value, $options);
+					}
+					return $arr;
+				}
+			case 'msg':
+				$paramcount = $xmlrpc_val->getNumParams();
+				$arr = array();
+				for($i = 0; $i < $paramcount; $i++)
+				{
+					$arr[] = php_xmlrpc_decode($xmlrpc_val->getParam($i));
+				}
+				return $arr;
+			}
+	}
+
+	// This constant left here only for historical reasons...
+	// it was used to decide if we have to define xmlrpc_encode on our own, but
+	// we do not do it anymore
+	if(function_exists('xmlrpc_decode'))
+	{
+		define('XMLRPC_EPI_ENABLED','1');
+	}
+	else
+	{
+		define('XMLRPC_EPI_ENABLED','0');
+	}
+
+	/**
+	* Takes native php types and encodes them into xmlrpc PHP object format.
+	* It will not re-encode xmlrpcval objects.
+	*
+	* Feature creep -- could support more types via optional type argument
+	* (string => datetime support has been added, ??? => base64 not yet)
+	*
+	* If given a proper options parameter, php object instances will be encoded
+	* into 'special' xmlrpc values, that can later be decoded into php objects
+	* by calling php_xmlrpc_decode() with a corresponding option
+	*
+	* @author Dan Libby (dan@libby.com)
+	*
+	* @param mixed $php_val the value to be converted into an xmlrpcval object
+	* @param array $options	can include 'encode_php_objs', 'auto_dates', 'null_extension' or 'extension_api'
+	* @return xmlrpcval
+	*/
+	function &php_xmlrpc_encode($php_val, $options=array())
+	{
+		$type = gettype($php_val);
+		switch($type)
+		{
+			case 'string':
+				if (in_array('auto_dates', $options) && preg_match('/^[0-9]{8}T[0-9]{2}:[0-9]{2}:[0-9]{2}$/', $php_val))
+					$xmlrpc_val =& new xmlrpcval($php_val, $GLOBALS['xmlrpcDateTime']);
+				else
+					$xmlrpc_val =& new xmlrpcval($php_val, $GLOBALS['xmlrpcString']);
+				break;
+			case 'integer':
+				$xmlrpc_val =& new xmlrpcval($php_val, $GLOBALS['xmlrpcInt']);
+				break;
+			case 'double':
+				$xmlrpc_val =& new xmlrpcval($php_val, $GLOBALS['xmlrpcDouble']);
+				break;
+				// <G_Giunta_2001-02-29>
+				// Add support for encoding/decoding of booleans, since they are supported in PHP
+			case 'boolean':
+				$xmlrpc_val =& new xmlrpcval($php_val, $GLOBALS['xmlrpcBoolean']);
+				break;
+				// </G_Giunta_2001-02-29>
+			case 'array':
+				// PHP arrays can be encoded to either xmlrpc structs or arrays,
+				// depending on wheter they are hashes or plain 0..n integer indexed
+				// A shorter one-liner would be
+				// $tmp = array_diff(array_keys($php_val), range(0, count($php_val)-1));
+				// but execution time skyrockets!
+				$j = 0;
+				$arr = array();
+				$ko = false;
+				foreach($php_val as $key => $val)
+				{
+					$arr[$key] =& php_xmlrpc_encode($val, $options);
+					if(!$ko && $key !== $j)
+					{
+						$ko = true;
+					}
+					$j++;
+				}
+				if($ko)
+				{
+					$xmlrpc_val =& new xmlrpcval($arr, $GLOBALS['xmlrpcStruct']);
+				}
+				else
+				{
+					$xmlrpc_val =& new xmlrpcval($arr, $GLOBALS['xmlrpcArray']);
+				}
+				break;
+			case 'object':
+				if(is_a($php_val, 'xmlrpcval'))
+				{
+					$xmlrpc_val = $php_val;
+				}
+				else
+				{
+					$arr = array();
+					while(list($k,$v) = each($php_val))
+					{
+						$arr[$k] = php_xmlrpc_encode($v, $options);
+					}
+					$xmlrpc_val =& new xmlrpcval($arr, $GLOBALS['xmlrpcStruct']);
+					if (in_array('encode_php_objs', $options))
+					{
+						// let's save original class name into xmlrpcval:
+						// might be useful later on...
+						$xmlrpc_val->_php_class = get_class($php_val);
+					}
+				}
+				break;
+			case 'NULL':
+				if (in_array('extension_api', $options))
+				{
+					$xmlrpc_val =& new xmlrpcval('', $GLOBALS['xmlrpcString']);
+				}
+				if (in_array('null_extension', $options))
+				{
+					$xmlrpc_val =& new xmlrpcval('', $GLOBALS['xmlrpcNull']);
+				}
+				else
+				{
+					$xmlrpc_val =& new xmlrpcval();
+				}
+				break;
+			case 'resource':
+				if (in_array('extension_api', $options))
+				{
+					$xmlrpc_val =& new xmlrpcval((int)$php_val, $GLOBALS['xmlrpcInt']);
+				}
+				else
+				{
+					$xmlrpc_val =& new xmlrpcval();
+				}
+			// catch "user function", "unknown type"
+			default:
+				// giancarlo pinerolo <ping@alt.it>
+				// it has to return
+				// an empty object in case, not a boolean.
+				$xmlrpc_val =& new xmlrpcval();
+				break;
+			}
+			return $xmlrpc_val;
+	}
+
+	/**
+	* Convert the xml representation of a method response, method request or single
+	* xmlrpc value into the appropriate object (a.k.a. deserialize)
+	* @param string $xml_val
+	* @param array $options
+	* @return mixed false on error, or an instance of either xmlrpcval, xmlrpcmsg or xmlrpcresp
+	*/
+	function php_xmlrpc_decode_xml($xml_val, $options=array())
+	{
+		$GLOBALS['_xh'] = array();
+		$GLOBALS['_xh']['ac'] = '';
+		$GLOBALS['_xh']['stack'] = array();
+		$GLOBALS['_xh']['valuestack'] = array();
+		$GLOBALS['_xh']['params'] = array();
+		$GLOBALS['_xh']['pt'] = array();
+		$GLOBALS['_xh']['isf'] = 0;
+		$GLOBALS['_xh']['isf_reason'] = '';
+		$GLOBALS['_xh']['method'] = false;
+		$GLOBALS['_xh']['rt'] = '';
+		/// @todo 'guestimate' encoding
+		$parser = xml_parser_create();
+		xml_parser_set_option($parser, XML_OPTION_CASE_FOLDING, true);
+		// What if internal encoding is not in one of the 3 allowed?
+		// we use the broadest one, ie. utf8!
+		if (!in_array($GLOBALS['xmlrpc_internalencoding'], array('UTF-8', 'ISO-8859-1', 'US-ASCII')))
+		{
+			xml_parser_set_option($parser, XML_OPTION_TARGET_ENCODING, 'UTF-8');
+		}
+		else
+		{
+			xml_parser_set_option($parser, XML_OPTION_TARGET_ENCODING, $GLOBALS['xmlrpc_internalencoding']);
+		}
+		xml_set_element_handler($parser, 'xmlrpc_se_any', 'xmlrpc_ee');
+		xml_set_character_data_handler($parser, 'xmlrpc_cd');
+		xml_set_default_handler($parser, 'xmlrpc_dh');
+		if(!xml_parse($parser, $xml_val, 1))
+		{
+			$errstr = sprintf('XML error: %s at line %d, column %d',
+						xml_error_string(xml_get_error_code($parser)),
+						xml_get_current_line_number($parser), xml_get_current_column_number($parser));
+			error_log($errstr);
+			xml_parser_free($parser);
+			return false;
+		}
+		xml_parser_free($parser);
+		if ($GLOBALS['_xh']['isf'] > 1) // test that $GLOBALS['_xh']['value'] is an obj, too???
+		{
+			error_log($GLOBALS['_xh']['isf_reason']);
+			return false;
+		}
+		switch ($GLOBALS['_xh']['rt'])
+		{
+			case 'methodresponse':
+				$v =& $GLOBALS['_xh']['value'];
+				if ($GLOBALS['_xh']['isf'] == 1)
+				{
+					$vc = $v->structmem('faultCode');
+					$vs = $v->structmem('faultString');
+					$r =& new xmlrpcresp(0, $vc->scalarval(), $vs->scalarval());
+				}
+				else
+				{
+					$r =& new xmlrpcresp($v);
+				}
+				return $r;
+			case 'methodcall':
+				$m =& new xmlrpcmsg($GLOBALS['_xh']['method']);
+				for($i=0; $i < count($GLOBALS['_xh']['params']); $i++)
+				{
+					$m->addParam($GLOBALS['_xh']['params'][$i]);
+				}
+				return $m;
+			case 'value':
+				return $GLOBALS['_xh']['value'];
+			default:
+				return false;
+		}
+	}
+
+	/**
+	* decode a string that is encoded w/ "chunked" transfer encoding
+	* as defined in rfc2068 par. 19.4.6
+	* code shamelessly stolen from nusoap library by Dietrich Ayala
+	*
+	* @param string $buffer the string to be decoded
+	* @return string
+	*/
+	function decode_chunked($buffer)
+	{
+		// length := 0
+		$length = 0;
+		$new = '';
+
+		// read chunk-size, chunk-extension (if any) and crlf
+		// get the position of the linebreak
+		$chunkend = strpos($buffer,"\r\n") + 2;
+		$temp = substr($buffer,0,$chunkend);
+		$chunk_size = hexdec( trim($temp) );
+		$chunkstart = $chunkend;
+		while($chunk_size > 0)
+		{
+			$chunkend = strpos($buffer, "\r\n", $chunkstart + $chunk_size);
+
+			// just in case we got a broken connection
+			if($chunkend == false)
+			{
+				$chunk = substr($buffer,$chunkstart);
+				// append chunk-data to entity-body
+				$new .= $chunk;
+				$length += strlen($chunk);
+				break;
+			}
+
+			// read chunk-data and crlf
+			$chunk = substr($buffer,$chunkstart,$chunkend-$chunkstart);
+			// append chunk-data to entity-body
+			$new .= $chunk;
+			// length := length + chunk-size
+			$length += strlen($chunk);
+			// read chunk-size and crlf
+			$chunkstart = $chunkend + 2;
+
+			$chunkend = strpos($buffer,"\r\n",$chunkstart)+2;
+			if($chunkend == false)
+			{
+				break; //just in case we got a broken connection
+			}
+			$temp = substr($buffer,$chunkstart,$chunkend-$chunkstart);
+			$chunk_size = hexdec( trim($temp) );
+			$chunkstart = $chunkend;
+		}
+		return $new;
+	}
+
+	/**
+	* xml charset encoding guessing helper function.
+	* Tries to determine the charset encoding of an XML chunk
+	* received over HTTP.
+	* NB: according to the spec (RFC 3023, if text/xml content-type is received over HTTP without a content-type,
+	* we SHOULD assume it is strictly US-ASCII. But we try to be more tolerant of unconforming (legacy?) clients/servers,
+	* which will be most probably using UTF-8 anyway...
+	*
+	* @param string $httpheaders the http Content-type header
+	* @param string $xmlchunk xml content buffer
+	* @param string $encoding_prefs comma separated list of character encodings to be used as default (when mb extension is enabled)
+	*
+	* @todo explore usage of mb_http_input(): does it detect http headers + post data? if so, use it instead of hand-detection!!!
+	*/
+	function guess_encoding($httpheader='', $xmlchunk='', $encoding_prefs=null)
+	{
+		// discussion: see http://www.yale.edu/pclt/encoding/
+		// 1 - test if encoding is specified in HTTP HEADERS
+
+		//Details:
+		// LWS:           (\13\10)?( |\t)+
+		// token:         (any char but excluded stuff)+
+		// header:        Content-type = ...; charset=value(; ...)*
+		//   where value is of type token, no LWS allowed between 'charset' and value
+		// Note: we do not check for invalid chars in VALUE:
+		//   this had better be done using pure ereg as below
+
+		/// @todo this test will pass if ANY header has charset specification, not only Content-Type. Fix it?
+		$matches = array();
+		if(preg_match('/;\s*charset=([^;]+)/i', $httpheader, $matches))
+		{
+			return strtoupper(trim($matches[1]));
+		}
+
+		// 2 - scan the first bytes of the data for a UTF-16 (or other) BOM pattern
+		//     (source: http://www.w3.org/TR/2000/REC-xml-20001006)
+		//     NOTE: actually, according to the spec, even if we find the BOM and determine
+		//     an encoding, we should check if there is an encoding specified
+		//     in the xml declaration, and verify if they match.
+		/// @todo implement check as described above?
+		/// @todo implement check for first bytes of string even without a BOM? (It sure looks harder than for cases WITH a BOM)
+		if(preg_match('/^(\x00\x00\xFE\xFF|\xFF\xFE\x00\x00|\x00\x00\xFF\xFE|\xFE\xFF\x00\x00)/', $xmlchunk))
+		{
+			return 'UCS-4';
+		}
+		elseif(preg_match('/^(\xFE\xFF|\xFF\xFE)/', $xmlchunk))
+		{
+			return 'UTF-16';
+		}
+		elseif(preg_match('/^(\xEF\xBB\xBF)/', $xmlchunk))
+		{
+			return 'UTF-8';
+		}
+
+		// 3 - test if encoding is specified in the xml declaration
+		// Details:
+		// SPACE:         (#x20 | #x9 | #xD | #xA)+ === [ \x9\xD\xA]+
+		// EQ:            SPACE?=SPACE? === [ \x9\xD\xA]*=[ \x9\xD\xA]*
+		if (preg_match('/^<\?xml\s+version\s*=\s*'. "((?:\"[a-zA-Z0-9_.:-]+\")|(?:'[a-zA-Z0-9_.:-]+'))".
+			'\s+encoding\s*=\s*' . "((?:\"[A-Za-z][A-Za-z0-9._-]*\")|(?:'[A-Za-z][A-Za-z0-9._-]*'))/",
+			$xmlchunk, $matches))
+		{
+			return strtoupper(substr($matches[2], 1, -1));
+		}
+
+		// 4 - if mbstring is available, let it do the guesswork
+		// NB: we favour finding an encoding that is compatible with what we can process
+		if(extension_loaded('mbstring'))
+		{
+			if($encoding_prefs)
+			{
+				$enc = mb_detect_encoding($xmlchunk, $encoding_prefs);
+			}
+			else
+			{
+				$enc = mb_detect_encoding($xmlchunk);
+			}
+			// NB: mb_detect likes to call it ascii, xml parser likes to call it US_ASCII...
+			// IANA also likes better US-ASCII, so go with it
+			if($enc == 'ASCII')
+			{
+				$enc = 'US-'.$enc;
+			}
+			return $enc;
+		}
+		else
+		{
+			// no encoding specified: as per HTTP1.1 assume it is iso-8859-1?
+			// Both RFC 2616 (HTTP 1.1) and 1945(http 1.0) clearly state that for text/xxx content types
+			// this should be the standard. And we should be getting text/xml as request and response.
+			// BUT we have to be backward compatible with the lib, which always used UTF-8 as default...
+			return $GLOBALS['xmlrpc_defencoding'];
+		}
+	}
+
+	/**
+	* Checks if a given charset encoding is present in a list of encodings or
+	* if it is a valid subset of any encoding in the list
+	* @param string $encoding charset to be tested
+	* @param mixed $validlist comma separated list of valid charsets (or array of charsets)
+	*/
+	function is_valid_charset($encoding, $validlist)
+	{
+		$charset_supersets = array(
+			'US-ASCII' => array ('ISO-8859-1', 'ISO-8859-2', 'ISO-8859-3', 'ISO-8859-4',
+				'ISO-8859-5', 'ISO-8859-6', 'ISO-8859-7', 'ISO-8859-8',
+				'ISO-8859-9', 'ISO-8859-10', 'ISO-8859-11', 'ISO-8859-12',
+				'ISO-8859-13', 'ISO-8859-14', 'ISO-8859-15', 'UTF-8',
+				'EUC-JP', 'EUC-', 'EUC-KR', 'EUC-CN')
+		);
+		if (is_string($validlist))
+			$validlist = explode(',', $validlist);
+		if (@in_array(strtoupper($encoding), $validlist))
+			return true;
+		else
+		{
+			if (array_key_exists($encoding, $charset_supersets))
+				foreach ($validlist as $allowed)
+					if (in_array($allowed, $charset_supersets[$encoding]))
+						return true;
+				return false;
+		}
+	}
+
+?>
\ No newline at end of file
diff -ruN phpBB-3.0.10/mobiquo/include/xmlrpcs.inc phpbb/mobiquo/include/xmlrpcs.inc
--- phpBB-3.0.10/mobiquo/include/xmlrpcs.inc	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/include/xmlrpcs.inc	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,1195 @@
+<?php
+// by Edd Dumbill (C) 1999-2002
+// <edd@usefulinc.com>
+// $Id: xmlrpcs.inc,v 1.69 2007/09/20 20:14:25 ggiunta Exp $
+
+// Copyright (c) 1999,2000,2002 Edd Dumbill.
+// All rights reserved.
+//
+// Redistribution and use in source and binary forms, with or without
+// modification, are permitted provided that the following conditions
+// are met:
+//
+//    * Redistributions of source code must retain the above copyright
+//      notice, this list of conditions and the following disclaimer.
+//
+//    * Redistributions in binary form must reproduce the above
+//      copyright notice, this list of conditions and the following
+//      disclaimer in the documentation and/or other materials provided
+//      with the distribution.
+//
+//    * Neither the name of the "XML-RPC for PHP" nor the names of its
+//      contributors may be used to endorse or promote products derived
+//      from this software without specific prior written permission.
+//
+// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
+// "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
+// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
+// FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
+// REGENTS OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
+// INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
+// (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
+// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+// HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
+// STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+// ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
+// OF THE POSSIBILITY OF SUCH DAMAGE.
+
+	// XML RPC Server class
+	// requires: xmlrpc.inc
+
+	$GLOBALS['xmlrpcs_capabilities'] = array(
+		// xmlrpc spec: always supported
+		'xmlrpc' => new xmlrpcval(array(
+			'specUrl' => new xmlrpcval('http://www.xmlrpc.com/spec', 'string'),
+			'specVersion' => new xmlrpcval(1, 'int')
+		), 'struct'),
+		// if we support system.xxx functions, we always support multicall, too...
+		// Note that, as of 2006/09/17, the following URL does not respond anymore
+		'system.multicall' => new xmlrpcval(array(
+			'specUrl' => new xmlrpcval('http://www.xmlrpc.com/discuss/msgReader$1208', 'string'),
+			'specVersion' => new xmlrpcval(1, 'int')
+		), 'struct'),
+		// introspection: version 2! we support 'mixed', too
+		'introspection' => new xmlrpcval(array(
+			'specUrl' => new xmlrpcval('http://phpxmlrpc.sourceforge.net/doc-2/ch10.html', 'string'),
+			'specVersion' => new xmlrpcval(2, 'int')
+		), 'struct')
+	);
+
+	/* Functions that implement system.XXX methods of xmlrpc servers */
+	$_xmlrpcs_getCapabilities_sig=array(array($GLOBALS['xmlrpcStruct']));
+	$_xmlrpcs_getCapabilities_doc='This method lists all the capabilites that the XML-RPC server has: the (more or less standard) extensions to the xmlrpc spec that it adheres to';
+	$_xmlrpcs_getCapabilities_sdoc=array(array('list of capabilities, described as structs with a version number and url for the spec'));
+	function _xmlrpcs_getCapabilities($server, $m=null)
+	{
+		$outAr = $GLOBALS['xmlrpcs_capabilities'];
+		// NIL extension
+		if ($GLOBALS['xmlrpc_null_extension']) {
+			$outAr['nil'] = new xmlrpcval(array(
+				'specUrl' => new xmlrpcval('http://www.ontosys.com/xml-rpc/extensions.php', 'string'),
+				'specVersion' => new xmlrpcval(1, 'int')
+			), 'struct');
+		}
+		return new xmlrpcresp(new xmlrpcval($outAr, 'struct'));
+	}
+
+	// listMethods: signature was either a string, or nothing.
+	// The useless string variant has been removed
+	$_xmlrpcs_listMethods_sig=array(array($GLOBALS['xmlrpcArray']));
+	$_xmlrpcs_listMethods_doc='This method lists all the methods that the XML-RPC server knows how to dispatch';
+	$_xmlrpcs_listMethods_sdoc=array(array('list of method names'));
+	function _xmlrpcs_listMethods($server, $m=null) // if called in plain php values mode, second param is missing
+	{
+
+		$outAr=array();
+		foreach($server->dmap as $key => $val)
+		{
+			$outAr[]=&new xmlrpcval($key, 'string');
+		}
+		if($server->allow_system_funcs)
+		{
+			foreach($GLOBALS['_xmlrpcs_dmap'] as $key => $val)
+			{
+				$outAr[]=&new xmlrpcval($key, 'string');
+			}
+		}
+		return new xmlrpcresp(new xmlrpcval($outAr, 'array'));
+	}
+
+	$_xmlrpcs_methodSignature_sig=array(array($GLOBALS['xmlrpcArray'], $GLOBALS['xmlrpcString']));
+	$_xmlrpcs_methodSignature_doc='Returns an array of known signatures (an array of arrays) for the method name passed. If no signatures are known, returns a none-array (test for type != array to detect missing signature)';
+	$_xmlrpcs_methodSignature_sdoc=array(array('list of known signatures, each sig being an array of xmlrpc type names', 'name of method to be described'));
+	function _xmlrpcs_methodSignature($server, $m)
+	{
+		// let accept as parameter both an xmlrpcval or string
+		if (is_object($m))
+		{
+			$methName=$m->getParam(0);
+			$methName=$methName->scalarval();
+		}
+		else
+		{
+			$methName=$m;
+		}
+		if(strpos($methName, "system.") === 0)
+		{
+			$dmap=$GLOBALS['_xmlrpcs_dmap']; $sysCall=1;
+		}
+		else
+		{
+			$dmap=$server->dmap; $sysCall=0;
+		}
+		if(isset($dmap[$methName]))
+		{
+			if(isset($dmap[$methName]['signature']))
+			{
+				$sigs=array();
+				foreach($dmap[$methName]['signature'] as $inSig)
+				{
+					$cursig=array();
+					foreach($inSig as $sig)
+					{
+						$cursig[]=&new xmlrpcval($sig, 'string');
+					}
+					$sigs[]=&new xmlrpcval($cursig, 'array');
+				}
+				$r=&new xmlrpcresp(new xmlrpcval($sigs, 'array'));
+			}
+			else
+			{
+				// NB: according to the official docs, we should be returning a
+				// "none-array" here, which means not-an-array
+				$r=&new xmlrpcresp(new xmlrpcval('undef', 'string'));
+			}
+		}
+		else
+		{
+			$r=&new xmlrpcresp(0,$GLOBALS['xmlrpcerr']['introspect_unknown'], $GLOBALS['xmlrpcstr']['introspect_unknown']);
+		}
+		return $r;
+	}
+
+	$_xmlrpcs_methodHelp_sig=array(array($GLOBALS['xmlrpcString'], $GLOBALS['xmlrpcString']));
+	$_xmlrpcs_methodHelp_doc='Returns help text if defined for the method passed, otherwise returns an empty string';
+	$_xmlrpcs_methodHelp_sdoc=array(array('method description', 'name of the method to be described'));
+	function _xmlrpcs_methodHelp($server, $m)
+	{
+		// let accept as parameter both an xmlrpcval or string
+		if (is_object($m))
+		{
+			$methName=$m->getParam(0);
+			$methName=$methName->scalarval();
+		}
+		else
+		{
+			$methName=$m;
+		}
+		if(strpos($methName, "system.") === 0)
+		{
+			$dmap=$GLOBALS['_xmlrpcs_dmap']; $sysCall=1;
+		}
+		else
+		{
+			$dmap=$server->dmap; $sysCall=0;
+		}
+		if(isset($dmap[$methName]))
+		{
+			if(isset($dmap[$methName]['docstring']))
+			{
+				$r=&new xmlrpcresp(new xmlrpcval($dmap[$methName]['docstring']), 'string');
+			}
+			else
+			{
+				$r=&new xmlrpcresp(new xmlrpcval('', 'string'));
+			}
+		}
+		else
+		{
+			$r=&new xmlrpcresp(0, $GLOBALS['xmlrpcerr']['introspect_unknown'], $GLOBALS['xmlrpcstr']['introspect_unknown']);
+		}
+		return $r;
+	}
+
+	$_xmlrpcs_multicall_sig = array(array($GLOBALS['xmlrpcArray'], $GLOBALS['xmlrpcArray']));
+	$_xmlrpcs_multicall_doc = 'Boxcar multiple RPC calls in one request. See http://www.xmlrpc.com/discuss/msgReader$1208 for details';
+	$_xmlrpcs_multicall_sdoc = array(array('list of response structs, where each struct has the usual members', 'list of calls, with each call being represented as a struct, with members "methodname" and "params"'));
+	function _xmlrpcs_multicall_error($err)
+	{
+		if(is_string($err))
+		{
+			$str = $GLOBALS['xmlrpcstr']["multicall_${err}"];
+			$code = $GLOBALS['xmlrpcerr']["multicall_${err}"];
+		}
+		else
+		{
+			$code = $err->faultCode();
+			$str = $err->faultString();
+		}
+		$struct = array();
+		$struct['faultCode'] =& new xmlrpcval($code, 'int');
+		$struct['faultString'] =& new xmlrpcval($str, 'string');
+		return new xmlrpcval($struct, 'struct');
+	}
+
+	function _xmlrpcs_multicall_do_call($server, $call)
+	{
+		if($call->kindOf() != 'struct')
+		{
+			return _xmlrpcs_multicall_error('notstruct');
+		}
+		$methName = @$call->structmem('methodName');
+		if(!$methName)
+		{
+			return _xmlrpcs_multicall_error('nomethod');
+		}
+		if($methName->kindOf() != 'scalar' || $methName->scalartyp() != 'string')
+		{
+			return _xmlrpcs_multicall_error('notstring');
+		}
+		if($methName->scalarval() == 'system.multicall')
+		{
+			return _xmlrpcs_multicall_error('recursion');
+		}
+
+		$params = @$call->structmem('params');
+		if(!$params)
+		{
+			return _xmlrpcs_multicall_error('noparams');
+		}
+		if($params->kindOf() != 'array')
+		{
+			return _xmlrpcs_multicall_error('notarray');
+		}
+		$numParams = $params->arraysize();
+
+		$msg =& new xmlrpcmsg($methName->scalarval());
+		for($i = 0; $i < $numParams; $i++)
+		{
+			if(!$msg->addParam($params->arraymem($i)))
+			{
+				$i++;
+				return _xmlrpcs_multicall_error(new xmlrpcresp(0,
+					$GLOBALS['xmlrpcerr']['incorrect_params'],
+					$GLOBALS['xmlrpcstr']['incorrect_params'] . ": probable xml error in param " . $i));
+			}
+		}
+
+		$result = $server->execute($msg);
+
+		if($result->faultCode() != 0)
+		{
+			return _xmlrpcs_multicall_error($result);		// Method returned fault.
+		}
+
+		return new xmlrpcval(array($result->value()), 'array');
+	}
+
+	function _xmlrpcs_multicall_do_call_phpvals($server, $call)
+	{
+		if(!is_array($call))
+		{
+			return _xmlrpcs_multicall_error('notstruct');
+		}
+		if(!array_key_exists('methodName', $call))
+		{
+			return _xmlrpcs_multicall_error('nomethod');
+		}
+		if (!is_string($call['methodName']))
+		{
+			return _xmlrpcs_multicall_error('notstring');
+		}
+		if($call['methodName'] == 'system.multicall')
+		{
+			return _xmlrpcs_multicall_error('recursion');
+		}
+		if(!array_key_exists('params', $call))
+		{
+			return _xmlrpcs_multicall_error('noparams');
+		}
+		if(!is_array($call['params']))
+		{
+			return _xmlrpcs_multicall_error('notarray');
+		}
+
+		// this is a real dirty and simplistic hack, since we might have received a
+		// base64 or datetime values, but they will be listed as strings here...
+		$numParams = count($call['params']);
+		$pt = array();
+		foreach($call['params'] as $val)
+			$pt[] = php_2_xmlrpc_type(gettype($val));
+
+		$result = $server->execute($call['methodName'], $call['params'], $pt);
+
+		if($result->faultCode() != 0)
+		{
+			return _xmlrpcs_multicall_error($result);		// Method returned fault.
+		}
+
+		return new xmlrpcval(array($result->value()), 'array');
+	}
+
+	function _xmlrpcs_multicall($server, $m)
+	{
+		$result = array();
+		// let accept a plain list of php parameters, beside a single xmlrpc msg object
+		if (is_object($m))
+		{
+			$calls = $m->getParam(0);
+			$numCalls = $calls->arraysize();
+			for($i = 0; $i < $numCalls; $i++)
+			{
+				$call = $calls->arraymem($i);
+				$result[$i] = _xmlrpcs_multicall_do_call($server, $call);
+			}
+		}
+		else
+		{
+			$numCalls=count($m);
+			for($i = 0; $i < $numCalls; $i++)
+			{
+				$result[$i] = _xmlrpcs_multicall_do_call_phpvals($server, $m[$i]);
+			}
+		}
+
+		return new xmlrpcresp(new xmlrpcval($result, 'array'));
+	}
+
+	$GLOBALS['_xmlrpcs_dmap']=array(
+		'system.listMethods' => array(
+			'function' => '_xmlrpcs_listMethods',
+			'signature' => $_xmlrpcs_listMethods_sig,
+			'docstring' => $_xmlrpcs_listMethods_doc,
+			'signature_docs' => $_xmlrpcs_listMethods_sdoc),
+		'system.methodHelp' => array(
+			'function' => '_xmlrpcs_methodHelp',
+			'signature' => $_xmlrpcs_methodHelp_sig,
+			'docstring' => $_xmlrpcs_methodHelp_doc,
+			'signature_docs' => $_xmlrpcs_methodHelp_sdoc),
+		'system.methodSignature' => array(
+			'function' => '_xmlrpcs_methodSignature',
+			'signature' => $_xmlrpcs_methodSignature_sig,
+			'docstring' => $_xmlrpcs_methodSignature_doc,
+			'signature_docs' => $_xmlrpcs_methodSignature_sdoc),
+		'system.multicall' => array(
+			'function' => '_xmlrpcs_multicall',
+			'signature' => $_xmlrpcs_multicall_sig,
+			'docstring' => $_xmlrpcs_multicall_doc,
+			'signature_docs' => $_xmlrpcs_multicall_sdoc),
+		'system.getCapabilities' => array(
+			'function' => '_xmlrpcs_getCapabilities',
+			'signature' => $_xmlrpcs_getCapabilities_sig,
+			'docstring' => $_xmlrpcs_getCapabilities_doc,
+			'signature_docs' => $_xmlrpcs_getCapabilities_sdoc)
+	);
+
+	$GLOBALS['_xmlrpcs_occurred_errors'] = '';
+	$GLOBALS['_xmlrpcs_prev_ehandler'] = '';
+	/**
+	* Error handler used to track errors that occur during server-side execution of PHP code.
+	* This allows to report back to the client whether an internal error has occurred or not
+	* using an xmlrpc response object, instead of letting the client deal with the html junk
+	* that a PHP execution error on the server generally entails.
+	*
+	* NB: in fact a user defined error handler can only handle WARNING, NOTICE and USER_* errors.
+	*
+	*/
+	function _xmlrpcs_errorHandler($errcode, $errstring, $filename=null, $lineno=null, $context=null)
+	{
+		// obey the @ protocol
+		if (error_reporting() == 0)
+			return;
+
+		//if($errcode != E_NOTICE && $errcode != E_WARNING && $errcode != E_USER_NOTICE && $errcode != E_USER_WARNING)
+		if($errcode != 2048) // do not use E_STRICT by name, since on PHP 4 it will not be defined
+		{
+			$GLOBALS['_xmlrpcs_occurred_errors'] = $GLOBALS['_xmlrpcs_occurred_errors'] . $errstring . "\n";
+		}
+		// Try to avoid as much as possible disruption to the previous error handling
+		// mechanism in place
+		if($GLOBALS['_xmlrpcs_prev_ehandler'] == '')
+		{
+			// The previous error handler was the default: all we should do is log error
+			// to the default error log (if level high enough)
+			if(ini_get('log_errors') && (intval(ini_get('error_reporting')) & $errcode))
+			{
+				error_log($errstring);
+			}
+		}
+		else
+		{
+			// Pass control on to previous error handler, trying to avoid loops...
+			if($GLOBALS['_xmlrpcs_prev_ehandler'] != '_xmlrpcs_errorHandler')
+			{
+				// NB: this code will NOT work on php < 4.0.2: only 2 params were used for error handlers
+				if(is_array($GLOBALS['_xmlrpcs_prev_ehandler']))
+				{
+					// the following works both with static class methods and plain object methods as error handler
+					call_user_func_array($GLOBALS['_xmlrpcs_prev_ehandler'], array($errcode, $errstring, $filename, $lineno, $context));
+				}
+				else
+				{
+					$GLOBALS['_xmlrpcs_prev_ehandler']($errcode, $errstring, $filename, $lineno, $context);
+				}
+			}
+		}
+	}
+
+	$GLOBALS['_xmlrpc_debuginfo']='';
+
+	/**
+	* Add a string to the debug info that can be later seralized by the server
+	* as part of the response message.
+	* Note that for best compatbility, the debug string should be encoded using
+	* the $GLOBALS['xmlrpc_internalencoding'] character set.
+	* @param string $m
+	* @access public
+	*/
+	function xmlrpc_debugmsg($m)
+	{
+		$GLOBALS['_xmlrpc_debuginfo'] .= $m . "\n";
+	}
+
+	class xmlrpc_server
+	{
+		/// array defining php functions exposed as xmlrpc methods by this server
+		var $dmap=array();
+		/**
+		* Defines how functions in dmap will be invokde: either using an xmlrpc msg object
+		* or plain php values.
+		* valid strings are 'xmlrpcvals', 'phpvals' or 'epivals'
+		*/
+		var $functions_parameters_type='xmlrpcvals';
+		/// controls wether the server is going to echo debugging messages back to the client as comments in response body. valid values: 0,1,2,3
+		var $debug = 1;
+		/**
+		* When set to true, it will enable HTTP compression of the response, in case
+		* the client has declared its support for compression in the request.
+		*/
+		var $compress_response = false;
+		/**
+		* List of http compression methods accepted by the server for requests.
+		* NB: PHP supports deflate, gzip compressions out of the box if compiled w. zlib
+		*/
+		var $accepted_compression = array();
+		/// shall we serve calls to system.* methods?
+		var $allow_system_funcs = true;
+		/// list of charset encodings natively accepted for requests
+		var $accepted_charset_encodings = array();
+		/**
+		* charset encoding to be used for response.
+		* NB: if we can, we will convert the generated response from internal_encoding to the intended one.
+		* can be: a supported xml encoding (only UTF-8 and ISO-8859-1 at present, unless mbstring is enabled),
+		* null (leave unspecified in response, convert output stream to US_ASCII),
+		* 'default' (use xmlrpc library default as specified in xmlrpc.inc, convert output stream if needed),
+		* or 'auto' (use client-specified charset encoding or same as request if request headers do not specify it (unless request is US-ASCII: then use library default anyway).
+		* NB: pretty dangerous if you accept every charset and do not have mbstring enabled)
+		*/
+		var $response_charset_encoding = '';
+		/// storage for internal debug info
+		var $debug_info = '';
+		/// extra data passed at runtime to method handling functions. Used only by EPI layer
+		var $user_data = null;
+
+		/**
+		* @param array $dispmap the dispatch map withd efinition of exposed services
+		* @param boolean $servicenow set to false to prevent the server from runnung upon construction
+		*/
+		function xmlrpc_server($dispMap=null, $serviceNow=true)
+		{
+			// if ZLIB is enabled, let the server by default accept compressed requests,
+			// and compress responses sent to clients that support them
+			if(function_exists('gzinflate'))
+			{
+				$this->accepted_compression = array('gzip', 'deflate');
+				$this->compress_response = true;
+			}
+
+			// by default the xml parser can support these 3 charset encodings
+			$this->accepted_charset_encodings = array('UTF-8', 'ISO-8859-1', 'US-ASCII');
+
+			// dispMap is a dispatch array of methods
+			// mapped to function names and signatures
+			// if a method
+			// doesn't appear in the map then an unknown
+			// method error is generated
+			/* milosch - changed to make passing dispMap optional.
+			 * instead, you can use the class add_to_map() function
+			 * to add functions manually (borrowed from SOAPX4)
+			 */
+			if($dispMap)
+			{
+				$this->dmap = $dispMap;
+				if($serviceNow)
+				{
+					$this->service();
+				}
+			}
+		}
+
+		/**
+		* Set debug level of server.
+		* @param integer $in debug lvl: determines info added to xmlrpc responses (as xml comments)
+		* 0 = no debug info,
+		* 1 = msgs set from user with debugmsg(),
+		* 2 = add complete xmlrpc request (headers and body),
+		* 3 = add also all processing warnings happened during method processing
+		* (NB: this involves setting a custom error handler, and might interfere
+		* with the standard processing of the php function exposed as method. In
+		* particular, triggering an USER_ERROR level error will not halt script
+		* execution anymore, but just end up logged in the xmlrpc response)
+		* Note that info added at elevel 2 and 3 will be base64 encoded
+		* @access public
+		*/
+		function setDebug($in)
+		{
+			$this->debug=$in;
+		}
+
+		/**
+		* Return a string with the serialized representation of all debug info
+		* @param string $charset_encoding the target charset encoding for the serialization
+		* @return string an XML comment (or two)
+		*/
+		function serializeDebug($charset_encoding='')
+		{
+			// Tough encoding problem: which internal charset should we assume for debug info?
+			// It might contain a copy of raw data received from client, ie with unknown encoding,
+			// intermixed with php generated data and user generated data...
+			// so we split it: system debug is base 64 encoded,
+			// user debug info should be encoded by the end user using the INTERNAL_ENCODING
+			$out = '';
+			if ($this->debug_info != '')
+			{
+				$out .= "<!-- SERVER DEBUG INFO (BASE64 ENCODED):\n".base64_encode($this->debug_info)."\n-->\n";
+			}
+			if($GLOBALS['_xmlrpc_debuginfo']!='')
+			{
+
+				$out .= "<!-- DEBUG INFO:\n" . xmlrpc_encode_entitites(str_replace('--', '_-', $GLOBALS['_xmlrpc_debuginfo']), $GLOBALS['xmlrpc_internalencoding'], $charset_encoding) . "\n-->\n";
+				// NB: a better solution MIGHT be to use CDATA, but we need to insert it
+				// into return payload AFTER the beginning tag
+				//$out .= "<![CDATA[ DEBUG INFO:\n\n" . str_replace(']]>', ']_]_>', $GLOBALS['_xmlrpc_debuginfo']) . "\n]]>\n";
+			}
+			return $out;
+		}
+
+		/**
+		* Execute the xmlrpc request, printing the response
+		* @param string $data the request body. If null, the http POST request will be examined
+		* @return xmlrpcresp the response object (usually not used by caller...)
+		* @access public
+		*/
+		function service($data=null, $return_payload=false)
+		{
+			if ($data === null)
+			{
+				// workaround for a known bug in php ver. 5.2.2 that broke $HTTP_RAW_POST_DATA
+				$ver = phpversion();
+				if ($ver[0] >= 5)
+				{
+					$data = file_get_contents('php://input');
+				}
+				else
+				{
+					$data = isset($GLOBALS['HTTP_RAW_POST_DATA']) ? $GLOBALS['HTTP_RAW_POST_DATA'] : '';
+				}
+			}
+			$raw_data = $data;
+
+			// reset internal debug info
+			$this->debug_info = '';
+
+			// Echo back what we received, before parsing it
+			if($this->debug > 1)
+			{
+				$this->debugmsg("+++GOT+++\n" . $data . "\n+++END+++");
+			}
+
+			$r = $this->parseRequestHeaders($data, $req_charset, $resp_charset, $resp_encoding);
+			if (!$r)
+			{
+				$r=$this->parseRequest($data, $req_charset);
+			}
+
+			// save full body of request into response, for more debugging usages
+			$r->raw_data = $raw_data;
+
+			if($this->debug > 2 && $GLOBALS['_xmlrpcs_occurred_errors'])
+			{
+				$this->debugmsg("+++PROCESSING ERRORS AND WARNINGS+++\n" .
+					$GLOBALS['_xmlrpcs_occurred_errors'] . "+++END+++");
+			}
+
+			$payload=$this->xml_header($resp_charset);
+			if($this->debug > 0)
+			{
+				$payload = $payload . $this->serializeDebug($resp_charset);
+			}
+
+			// G. Giunta 2006-01-27: do not create response serialization if it has
+			// already happened. Helps building json magic
+			if (empty($r->payload))
+			{
+				$r->serialize($resp_charset);
+			}
+			$payload = $payload . $r->payload;
+
+			if ($return_payload)
+			{
+				return $payload;
+			}
+
+			// if we get a warning/error that has output some text before here, then we cannot
+			// add a new header. We cannot say we are sending xml, either...
+			if(!headers_sent())
+			{
+				header('Content-Type: '.$r->content_type);
+				// we do not know if client actually told us an accepted charset, but if he did
+				// we have to tell him what we did
+				header("Vary: Accept-Charset");
+
+				// http compression of output: only
+				// if we can do it, and we want to do it, and client asked us to,
+				// and php ini settings do not force it already
+				$php_no_self_compress = ini_get('zlib.output_compression') == '' && (ini_get('output_handler') != 'ob_gzhandler');
+				if($this->compress_response && function_exists('gzencode') && $resp_encoding != ''
+					&& $php_no_self_compress)
+				{
+					if(strpos($resp_encoding, 'gzip') !== false)
+					{
+						$payload = gzencode($payload);
+						header("Content-Encoding: gzip");
+						header("Vary: Accept-Encoding");
+					}
+					elseif (strpos($resp_encoding, 'deflate') !== false)
+					{
+						$payload = gzcompress($payload);
+						header("Content-Encoding: deflate");
+						header("Vary: Accept-Encoding");
+					}
+				}
+
+				// do not ouput content-length header if php is compressing output for us:
+				// it will mess up measurements
+				if($php_no_self_compress)
+				{
+					header('Content-Length: ' . (int)strlen($payload));
+				}
+			}
+			else
+			{
+				error_log('XML-RPC: xmlrpc_server::service: http headers already sent before response is fully generated. Check for php warning or error messages');
+			}
+            
+            //tapatalk add:
+            if (MOBIQUO_DEBUG == 0 && ob_get_level() > 0) ob_end_clean();
+			print $payload;
+
+			// return request, in case subclasses want it
+			return $r;
+		}
+
+		/**
+		* Add a method to the dispatch map
+		* @param string $methodname the name with which the method will be made available
+		* @param string $function the php function that will get invoked
+		* @param array $sig the array of valid method signatures
+		* @param string $doc method documentation
+		* @access public
+		*/
+		function add_to_map($methodname,$function,$sig=null,$doc='')
+		{
+			$this->dmap[$methodname] = array(
+				'function'	=> $function,
+				'docstring' => $doc
+			);
+			if ($sig)
+			{
+				$this->dmap[$methodname]['signature'] = $sig;
+			}
+		}
+
+		/**
+		* Verify type and number of parameters received against a list of known signatures
+		* @param array $in array of either xmlrpcval objects or xmlrpc type definitions
+		* @param array $sig array of known signatures to match against
+		* @access private
+		*/
+		function verifySignature($in, $sig)
+		{
+			// check each possible signature in turn
+			if (is_object($in))
+			{
+				$numParams = $in->getNumParams();
+			}
+			else
+			{
+				$numParams = count($in);
+			}
+			foreach($sig as $cursig)
+			{
+				if(count($cursig)==$numParams+1)
+				{
+					$itsOK=1;
+					for($n=0; $n<$numParams; $n++)
+					{
+						if (is_object($in))
+						{
+							$p=$in->getParam($n);
+							if($p->kindOf() == 'scalar')
+							{
+								$pt=$p->scalartyp();
+							}
+							else
+							{
+								$pt=$p->kindOf();
+							}
+						}
+						else
+						{
+							$pt= $in[$n] == 'i4' ? 'int' : $in[$n]; // dispatch maps never use i4...
+						}
+
+						// param index is $n+1, as first member of sig is return type
+						if($pt != $cursig[$n+1] && $cursig[$n+1] != $GLOBALS['xmlrpcValue'])
+						{
+							$itsOK=0;
+							$pno=$n+1;
+							$wanted=$cursig[$n+1];
+							$got=$pt;
+							break;
+						}
+					}
+					if($itsOK)
+					{
+						return array(1,'');
+					}
+				}
+			}
+			if(isset($wanted))
+			{
+				return array(0, "Wanted ${wanted}, got ${got} at param ${pno}");
+			}
+			else
+			{
+				return array(0, "No method signature matches number of parameters");
+			}
+		}
+
+		/**
+		* Parse http headers received along with xmlrpc request. If needed, inflate request
+		* @return null on success or an xmlrpcresp
+		* @access private
+		*/
+		function parseRequestHeaders(&$data, &$req_encoding, &$resp_encoding, &$resp_compression)
+		{
+			// Play nice to PHP 4.0.x: superglobals were not yet invented...
+			if(!isset($_SERVER))
+			{
+				$_SERVER = $GLOBALS['HTTP_SERVER_VARS'];
+			}
+
+			if($this->debug > 1)
+			{
+				if(function_exists('getallheaders'))
+				{
+					$this->debugmsg(''); // empty line
+					foreach(getallheaders() as $name => $val)
+					{
+						$this->debugmsg("HEADER: $name: $val");
+					}
+				}
+
+			}
+
+			if(isset($_SERVER['HTTP_CONTENT_ENCODING']))
+			{
+				$content_encoding = str_replace('x-', '', $_SERVER['HTTP_CONTENT_ENCODING']);
+			}
+			else
+			{
+				$content_encoding = '';
+			}
+
+			// check if request body has been compressed and decompress it
+			if($content_encoding != '' && strlen($data))
+			{
+				if($content_encoding == 'deflate' || $content_encoding == 'gzip')
+				{
+					// if decoding works, use it. else assume data wasn't gzencoded
+					if(function_exists('gzinflate') && in_array($content_encoding, $this->accepted_compression))
+					{
+						if($content_encoding == 'deflate' && $degzdata = @gzuncompress($data))
+						{
+							$data = $degzdata;
+							if($this->debug > 1)
+							{
+								$this->debugmsg("\n+++INFLATED REQUEST+++[".strlen($data)." chars]+++\n" . $data . "\n+++END+++");
+							}
+						}
+						elseif($content_encoding == 'gzip' && $degzdata = @gzinflate(substr($data, 10)))
+						{
+							$data = $degzdata;
+							if($this->debug > 1)
+								$this->debugmsg("+++INFLATED REQUEST+++[".strlen($data)." chars]+++\n" . $data . "\n+++END+++");
+						}
+						else
+						{
+							$r =& new xmlrpcresp(0, $GLOBALS['xmlrpcerr']['server_decompress_fail'], $GLOBALS['xmlrpcstr']['server_decompress_fail']);
+							return $r;
+						}
+					}
+					else
+					{
+						//error_log('The server sent deflated data. Your php install must have the Zlib extension compiled in to support this.');
+						$r =& new xmlrpcresp(0, $GLOBALS['xmlrpcerr']['server_cannot_decompress'], $GLOBALS['xmlrpcstr']['server_cannot_decompress']);
+						return $r;
+					}
+				}
+			}
+
+			// check if client specified accepted charsets, and if we know how to fulfill
+			// the request
+			if ($this->response_charset_encoding == 'auto')
+			{
+				$resp_encoding = '';
+				if (isset($_SERVER['HTTP_ACCEPT_CHARSET']))
+				{
+					// here we should check if we can match the client-requested encoding
+					// with the encodings we know we can generate.
+					/// @todo we should parse q=0.x preferences instead of getting first charset specified...
+					$client_accepted_charsets = explode(',', strtoupper($_SERVER['HTTP_ACCEPT_CHARSET']));
+					// Give preference to internal encoding
+					$known_charsets = array($GLOBALS['xmlrpc_internalencoding'], 'UTF-8', 'ISO-8859-1', 'US-ASCII');
+					foreach ($known_charsets as $charset)
+					{
+						foreach ($client_accepted_charsets as $accepted)
+							if (strpos($accepted, $charset) === 0)
+							{
+								$resp_encoding = $charset;
+								break;
+							}
+						if ($resp_encoding)
+							break;
+					}
+				}
+			}
+			else
+			{
+				$resp_encoding = $this->response_charset_encoding;
+			}
+
+			if (isset($_SERVER['HTTP_ACCEPT_ENCODING']))
+			{
+				$resp_compression = $_SERVER['HTTP_ACCEPT_ENCODING'];
+			}
+			else
+			{
+				$resp_compression = '';
+			}
+
+			// 'guestimate' request encoding
+			/// @todo check if mbstring is enabled and automagic input conversion is on: it might mingle with this check???
+			$req_encoding = guess_encoding(isset($_SERVER['CONTENT_TYPE']) ? $_SERVER['CONTENT_TYPE'] : '',
+				$data);
+
+			return null;
+		}
+
+		/**
+		* Parse an xml chunk containing an xmlrpc request and execute the corresponding
+		* php function registered with the server
+		* @param string $data the xml request
+		* @param string $req_encoding (optional) the charset encoding of the xml request
+		* @return xmlrpcresp
+		* @access private
+		*/
+		function parseRequest($data, $req_encoding='')
+		{
+			// 2005/05/07 commented and moved into caller function code
+			//if($data=='')
+			//{
+			//	$data=$GLOBALS['HTTP_RAW_POST_DATA'];
+			//}
+
+			// G. Giunta 2005/02/13: we do NOT expect to receive html entities
+			// so we do not try to convert them into xml character entities
+			//$data = xmlrpc_html_entity_xlate($data);
+
+			$GLOBALS['_xh']=array();
+			$GLOBALS['_xh']['ac']='';
+			$GLOBALS['_xh']['stack']=array();
+			$GLOBALS['_xh']['valuestack'] = array();
+			$GLOBALS['_xh']['params']=array();
+			$GLOBALS['_xh']['pt']=array();
+			$GLOBALS['_xh']['isf']=0;
+			$GLOBALS['_xh']['isf_reason']='';
+			$GLOBALS['_xh']['method']=false; // so we can check later if we got a methodname or not
+			$GLOBALS['_xh']['rt']='';
+
+			// decompose incoming XML into request structure
+			if ($req_encoding != '')
+			{
+				if (!in_array($req_encoding, array('UTF-8', 'ISO-8859-1', 'US-ASCII')))
+				// the following code might be better for mb_string enabled installs, but
+				// makes the lib about 200% slower...
+				//if (!is_valid_charset($req_encoding, array('UTF-8', 'ISO-8859-1', 'US-ASCII')))
+				{
+					error_log('XML-RPC: xmlrpc_server::parseRequest: invalid charset encoding of received request: '.$req_encoding);
+					$req_encoding = $GLOBALS['xmlrpc_defencoding'];
+				}
+				/// @BUG this will fail on PHP 5 if charset is not specified in the xml prologue,
+				// the encoding is not UTF8 and there are non-ascii chars in the text...
+				/// @todo use an ampty string for php 5 ???
+				$parser = xml_parser_create($req_encoding);
+			}
+			else
+			{
+				$parser = xml_parser_create();
+			}
+
+			xml_parser_set_option($parser, XML_OPTION_CASE_FOLDING, true);
+			// G. Giunta 2005/02/13: PHP internally uses ISO-8859-1, so we have to tell
+			// the xml parser to give us back data in the expected charset
+			// What if internal encoding is not in one of the 3 allowed?
+			// we use the broadest one, ie. utf8
+			// This allows to send data which is native in various charset,
+			// by extending xmlrpc_encode_entitites() and setting xmlrpc_internalencoding
+			if (!in_array($GLOBALS['xmlrpc_internalencoding'], array('UTF-8', 'ISO-8859-1', 'US-ASCII')))
+			{
+				xml_parser_set_option($parser, XML_OPTION_TARGET_ENCODING, 'UTF-8');
+			}
+			else
+			{
+				xml_parser_set_option($parser, XML_OPTION_TARGET_ENCODING, $GLOBALS['xmlrpc_internalencoding']);
+			}
+
+			if ($this->functions_parameters_type != 'xmlrpcvals')
+				xml_set_element_handler($parser, 'xmlrpc_se', 'xmlrpc_ee_fast');
+			else
+				xml_set_element_handler($parser, 'xmlrpc_se', 'xmlrpc_ee');
+			xml_set_character_data_handler($parser, 'xmlrpc_cd');
+			xml_set_default_handler($parser, 'xmlrpc_dh');
+			if(!xml_parse($parser, $data, 1))
+			{
+				// return XML error as a faultCode
+				$r=&new xmlrpcresp(0,
+				$GLOBALS['xmlrpcerrxml']+xml_get_error_code($parser),
+				sprintf('XML error: %s at line %d, column %d',
+					xml_error_string(xml_get_error_code($parser)),
+					xml_get_current_line_number($parser), xml_get_current_column_number($parser)));
+				xml_parser_free($parser);
+			}
+			elseif ($GLOBALS['_xh']['isf'])
+			{
+				xml_parser_free($parser);
+				$r=&new xmlrpcresp(0,
+					$GLOBALS['xmlrpcerr']['invalid_request'],
+					$GLOBALS['xmlrpcstr']['invalid_request'] . ' ' . $GLOBALS['_xh']['isf_reason']);
+			}
+			else
+			{
+				xml_parser_free($parser);
+				if ($this->functions_parameters_type != 'xmlrpcvals')
+				{
+					if($this->debug > 1)
+					{
+						$this->debugmsg("\n+++PARSED+++\n".var_export($GLOBALS['_xh']['params'], true)."\n+++END+++");
+					}
+					$r = $this->execute($GLOBALS['_xh']['method'], $GLOBALS['_xh']['params'], $GLOBALS['_xh']['pt']);
+				}
+				else
+				{
+					// build an xmlrpcmsg object with data parsed from xml
+					$m=&new xmlrpcmsg($GLOBALS['_xh']['method']);
+					// now add parameters in
+					for($i=0; $i<count($GLOBALS['_xh']['params']); $i++)
+					{
+						$m->addParam($GLOBALS['_xh']['params'][$i]);
+					}
+
+					if($this->debug > 1)
+					{
+						$this->debugmsg("\n+++PARSED+++\n".var_export($m, true)."\n+++END+++");
+					}
+					$r = $this->execute($m);
+				}
+			}
+			return $r;
+		}
+
+		/**
+		* Execute a method invoked by the client, checking parameters used
+		* @param mixed $m either an xmlrpcmsg obj or a method name
+		* @param array $params array with method parameters as php types (if m is method name only)
+		* @param array $paramtypes array with xmlrpc types of method parameters (if m is method name only)
+		* @return xmlrpcresp
+		* @access private
+		*/
+		function execute($m, $params=null, $paramtypes=null)
+		{
+			if (is_object($m))
+			{
+				$methName = $m->method();
+			}
+			else
+			{
+				$methName = $m;
+			}
+			$sysCall = $this->allow_system_funcs && (strpos($methName, "system.") === 0);
+			$dmap = $sysCall ? $GLOBALS['_xmlrpcs_dmap'] : $this->dmap;
+
+			if(!isset($dmap[$methName]['function']))
+			{
+				// No such method
+				return new xmlrpcresp(0,
+					$GLOBALS['xmlrpcerr']['unknown_method'],
+					$GLOBALS['xmlrpcstr']['unknown_method']);
+			}
+
+			// Check signature
+			if(isset($dmap[$methName]['signature']))
+			{
+				$sig = $dmap[$methName]['signature'];
+				if (is_object($m))
+				{
+					list($ok, $errstr) = $this->verifySignature($m, $sig);
+				}
+				else
+				{
+					list($ok, $errstr) = $this->verifySignature($paramtypes, $sig);
+				}
+				if(!$ok)
+				{
+					// Didn't match.
+					return new xmlrpcresp(
+						0,
+						$GLOBALS['xmlrpcerr']['incorrect_params'],
+						$GLOBALS['xmlrpcstr']['incorrect_params'] . ": ${errstr}"
+					);
+				}
+			}
+
+			$func = $dmap[$methName]['function'];
+			// let the 'class::function' syntax be accepted in dispatch maps
+			if(is_string($func) && strpos($func, '::'))
+			{
+				$func = explode('::', $func);
+			}
+			// verify that function to be invoked is in fact callable
+			if(!is_callable($func))
+			{
+				error_log("XML-RPC: xmlrpc_server::execute: function $func registered as method handler is not callable");
+				return new xmlrpcresp(
+					0,
+					$GLOBALS['xmlrpcerr']['server_error'],
+					$GLOBALS['xmlrpcstr']['server_error'] . ": no function matches method"
+				);
+			}
+
+			// If debug level is 3, we should catch all errors generated during
+			// processing of user function, and log them as part of response
+			if($this->debug > 2)
+			{
+				$GLOBALS['_xmlrpcs_prev_ehandler'] = set_error_handler('_xmlrpcs_errorHandler');
+			}
+			if (is_object($m))
+			{
+				if($sysCall)
+				{
+					$r = call_user_func($func, $this, $m);
+				}
+				else
+				{
+					$r = call_user_func($func, $m);
+				}
+				if (!is_a($r, 'xmlrpcresp'))
+				{
+					error_log("XML-RPC: xmlrpc_server::execute: function $func registered as method handler does not return an xmlrpcresp object");
+					if (is_a($r, 'xmlrpcval'))
+					{
+						$r =& new xmlrpcresp($r);
+					}
+					else
+					{
+						$r =& new xmlrpcresp(
+							0,
+							$GLOBALS['xmlrpcerr']['server_error'],
+							$GLOBALS['xmlrpcstr']['server_error'] . ": function does not return xmlrpcresp object"
+						);
+					}
+				}
+			}
+			else
+			{
+				// call a 'plain php' function
+				if($sysCall)
+				{
+					array_unshift($params, $this);
+					$r = call_user_func_array($func, $params);
+				}
+				else
+				{
+					// 3rd API convention for method-handling functions: EPI-style
+					if ($this->functions_parameters_type == 'epivals')
+					{
+						$r = call_user_func_array($func, array($methName, $params, $this->user_data));
+						// mimic EPI behaviour: if we get an array that looks like an error, make it
+						// an eror response
+						if (is_array($r) && array_key_exists('faultCode', $r) && array_key_exists('faultString', $r))
+						{
+							$r =& new xmlrpcresp(0, (integer)$r['faultCode'], (string)$r['faultString']);
+						}
+						else
+						{
+							// functions using EPI api should NOT return resp objects,
+							// so make sure we encode the return type correctly
+							$r =& new xmlrpcresp(php_xmlrpc_encode($r, array('extension_api')));
+						}
+					}
+					else
+					{
+						$r = call_user_func_array($func, $params);
+					}
+				}
+				// the return type can be either an xmlrpcresp object or a plain php value...
+				if (!is_a($r, 'xmlrpcresp'))
+				{
+					// what should we assume here about automatic encoding of datetimes
+					// and php classes instances???
+					$r =& new xmlrpcresp(php_xmlrpc_encode($r, array('auto_dates')));
+				}
+			}
+			if($this->debug > 2)
+			{
+				// note: restore the error handler we found before calling the
+				// user func, even if it has been changed inside the func itself
+				if($GLOBALS['_xmlrpcs_prev_ehandler'])
+				{
+					set_error_handler($GLOBALS['_xmlrpcs_prev_ehandler']);
+				}
+				else
+				{
+					restore_error_handler();
+				}
+			}
+			return $r;
+		}
+
+		/**
+		* add a string to the 'internal debug message' (separate from 'user debug message')
+		* @param string $strings
+		* @access private
+		*/
+		function debugmsg($string)
+		{
+			$this->debug_info .= $string."\n";
+		}
+
+		/**
+		* @access private
+		*/
+		function xml_header($charset_encoding='')
+		{
+			if ($charset_encoding != '')
+			{
+				return "<?xml version=\"1.0\" encoding=\"$charset_encoding\"?" . ">\n";
+			}
+			else
+			{
+				return "<?xml version=\"1.0\"?" . ">\n";
+			}
+		}
+
+		/**
+		* A debugging routine: just echoes back the input packet as a string value
+		* DEPRECATED!
+		*/
+		function echoInput()
+		{
+			$r=&new xmlrpcresp(new xmlrpcval( "'Aha said I: '" . $GLOBALS['HTTP_RAW_POST_DATA'], 'string'));
+			print $r->serialize();
+		}
+	}
+?>
\ No newline at end of file
diff -ruN phpBB-3.0.10/mobiquo/index.html phpbb/mobiquo/index.html
--- phpBB-3.0.10/mobiquo/index.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/index.html	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,8 @@
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
+<HTML>
+ <HEAD>
+  <TITLE>Redirecting...</TITLE>
+<meta HTTP-EQUIV="REFRESH" content="0; url=/"> </HEAD>
+<BODY>  
+</BODY>
+</HTML>
diff -ruN phpBB-3.0.10/mobiquo/license.txt phpbb/mobiquo/license.txt
--- phpBB-3.0.10/mobiquo/license.txt	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/license.txt	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,16 @@
+phpBB3 Tapatalk Plugin
+Copyright (C) 2009 Quoord Systems Limited
+license http://opensource.org/licenses/gpl-license.php GNU Public License
+
+This program is free software: you can redistribute it and/or modify
+it under the terms of the GNU General Public License as published by
+the Free Software Foundation, either version 3 of the License, or
+(at your option) any later version.
+
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+
+You should have received a copy of the GNU General Public License
+along with this program.  If not, see <http://www.gnu.org/licenses/>.
diff -ruN phpBB-3.0.10/mobiquo/mobiquo_common.php phpbb/mobiquo/mobiquo_common.php
--- phpBB-3.0.10/mobiquo/mobiquo_common.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/mobiquo_common.php	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,995 @@
+<?php
+/**
+*
+* @copyright (c) 2009, 2010, 2011 Quoord Systems Limited
+* @license http://opensource.org/licenses/gpl-2.0.php GNU Public License (GPLv2)
+*
+*/
+
+defined('IN_MOBIQUO') or exit;
+
+function process_page($start_num, $end)
+{
+    global $start, $limit, $page;
+    
+    $start = intval($start_num);
+    $end = intval($end);
+    $start = empty($start) ? 0 : max($start, 0);
+    $end = (empty($end) || $end < $start) ? ($start + 19) : max($end, $start);
+    if ($end - $start >= 50) {
+        $end = $start + 49;
+    }
+    $limit = $end - $start + 1;
+    $page = intval($start/$limit) + 1;
+    
+    return array($start, $limit, $page);
+}
+
+function xmlrpc_shutdown()
+{
+    if (function_exists('error_get_last'))
+    {
+        $error = error_get_last();
+    
+        if(!empty($error)){
+            switch($error['type']){
+                case E_ERROR:
+                case E_CORE_ERROR:
+                case E_COMPILE_ERROR:
+                case E_USER_ERROR:
+                case E_PARSE:
+                    $xmlrpcresp = xmlresperror("Server error occurred: '{$error['message']} (".basename($error['file']).":{$error['line']})'");
+                    echo "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" . $xmlrpcresp->serialize('UTF-8');
+                    break;
+            }
+        }
+    }
+}
+
+function xmlresperror($error_message)
+{
+    $result = new xmlrpcval(array(
+        'result'        => new xmlrpcval(false, 'boolean'),
+        'result_text'   => new xmlrpcval(basic_clean($error_message), 'base64')
+    ), 'struct');
+    
+    return new xmlrpcresp($result);
+}
+
+function xmlrpc_error_handler($errno, $msg_text, $errfile, $errline)
+{
+    global $auth, $user, $msg_long_text;
+
+    // Do not display notices if we suppress them via @
+    if (MOBIQUO_DEBUG == 0 && $errno != E_USER_ERROR && $errno != E_USER_WARNING && $errno != E_USER_NOTICE)
+    {
+        return;
+    }
+
+    // Message handler is stripping text. In case we need it, we are possible to define long text...
+    if (isset($msg_long_text) && $msg_long_text && !$msg_text)
+    {
+        $msg_text = $msg_long_text;
+    }
+
+    if (!defined('E_DEPRECATED'))
+    {
+        define('E_DEPRECATED', 8192);
+    }
+
+    switch ($errno)
+    {
+        case E_NOTICE:
+        case E_WARNING:
+
+            // Check the error reporting level and return if the error level does not match
+            // If DEBUG is defined the default level is E_ALL
+            if (MOBIQUO_DEBUG == 0)
+            {
+                return;
+            }
+
+            if (strpos($errfile, 'cache') === false && strpos($errfile, 'template.') === false)
+            {
+                $errfile = phpbb_filter_root_path($errfile);
+                $msg_text = phpbb_filter_root_path($msg_text);
+                $error_name = ($errno === E_WARNING) ? 'PHP Warning' : 'PHP Notice';
+                echo '[phpBB Debug] ' . $error_name . ': in file ' . $errfile . ' on line ' . $errline . ': ' . $msg_text . "\n";
+            }
+
+            return;
+
+        break;
+
+        case E_USER_ERROR:
+
+            if (!empty($user) && !empty($user->lang))
+            {
+                $msg_text = (!empty($user->lang[$msg_text])) ? $user->lang[$msg_text] : $msg_text;
+            }
+
+            garbage_collection();
+        break;
+
+        case E_USER_WARNING:
+        case E_USER_NOTICE:
+
+            define('IN_ERROR_HANDLER', true);
+
+            if (empty($user->data))
+            {
+                $user->session_begin();
+            }
+
+            // We re-init the auth array to get correct results on login/logout
+            $auth->acl($user->data);
+
+            if (empty($user->lang))
+            {
+                $user->setup();
+            }
+
+            if ($msg_text == 'ERROR_NO_ATTACHMENT' || $msg_text == 'NO_FORUM' || $msg_text == 'NO_TOPIC' || $msg_text == 'NO_USER')
+            {
+                send_status_line(404, 'Not Found');
+            }
+
+            $msg_text = (!empty($user->lang[$msg_text])) ? $user->lang[$msg_text] : $msg_text;
+        break;
+
+        // PHP4 compatibility
+        case E_DEPRECATED:
+            return true;
+        break;
+    }
+    
+    if (in_array($errno, array(E_USER_ERROR, E_USER_WARNING, E_USER_NOTICE)))
+    {
+        $result = check_error_status($msg_text);
+        if (MOBIQUO_DEBUG == -1) $msg_text .= " > $errfile, $errline";
+        
+        $response = new xmlrpcresp(
+            new xmlrpcval(array(
+                'result'        => new xmlrpcval($result, 'boolean'),
+                'result_text'   => new xmlrpcval(basic_clean($msg_text), 'base64'),
+            ),'struct')
+        );
+        
+        echo "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n".$response->serialize('UTF-8');
+        exit;
+    }
+    
+    // If we notice an error not handled here we pass this back to PHP by returning false
+    // This may not work for all php versions
+    return false;
+}
+
+function basic_clean($str)
+{
+    $str = preg_replace('/<br\s*\/?>/si', "\n", $str);
+    $str = strip_tags($str);
+    $str = trim($str);
+    return html_entity_decode($str, ENT_QUOTES, 'UTF-8');
+}
+
+
+function mobi_parse_requrest()
+{
+    global $request_method, $request_params, $params_num;
+    
+    $ver = phpversion();
+    if ($ver[0] >= 5) {
+        $data = file_get_contents('php://input');
+    } else {
+        $data = isset($GLOBALS['HTTP_RAW_POST_DATA']) ? $GLOBALS['HTTP_RAW_POST_DATA'] : '';
+    }
+    
+    if (count($_SERVER) == 0)
+    {
+        $r = new xmlrpcresp('', 15, 'XML-RPC: '.__METHOD__.': cannot parse request headers as $_SERVER is not populated');
+        echo $r->serialize('UTF-8');
+        exit;
+    }
+    
+    if(isset($_SERVER['HTTP_CONTENT_ENCODING'])) {
+        $content_encoding = str_replace('x-', '', $_SERVER['HTTP_CONTENT_ENCODING']);
+    } else {
+        $content_encoding = '';
+    }
+    
+    if($content_encoding != '' && strlen($data)) {
+        if($content_encoding == 'deflate' || $content_encoding == 'gzip') {
+            // if decoding works, use it. else assume data wasn't gzencoded
+            if(function_exists('gzinflate')) {
+                if ($content_encoding == 'deflate' && $degzdata = @gzuncompress($data)) {
+                    $data = $degzdata;
+                } elseif ($degzdata = @gzinflate(substr($data, 10))) {
+                    $data = $degzdata;
+                }
+            } else {
+                $r = new xmlrpcresp('', 106, 'Received from client compressed HTTP request and cannot decompress');
+                echo $r->serialize('UTF-8');
+                exit;
+            }
+        }
+    }
+    
+    $parsers = php_xmlrpc_decode_xml($data);
+    $request_method = $parsers->methodname;
+    $request_params = php_xmlrpc_decode(new xmlrpcval($parsers->params, 'array'));
+    $params_num = count($request_params);
+}
+
+function get_short_content($post_id, $length = 200)
+{
+    global $db;
+    
+    $post_id = intval($post_id);
+    if (empty($post_id)) return '';
+    
+    $sql = 'SELECT post_text
+            FROM ' . POSTS_TABLE . '
+            WHERE post_id = ' . $post_id;
+    $result = $db->sql_query($sql);
+    $post_text = $db->sql_fetchfield('post_text');
+    $db->sql_freeresult($result);
+    
+    return process_short_content($post_text, 200);
+}
+
+function process_short_content($post_text, $length = 200)
+{
+    $post_text = censor_text($post_text);
+    $post_text = preg_replace('/\[url.*?\].*?\[\/url.*?\]/', '[url]', $post_text);
+    $post_text = preg_replace('/\[img.*?\].*?\[\/img.*?\]/', '[img]', $post_text);
+    $post_text = preg_replace('/[\n\r\t]+/', ' ', $post_text);
+    strip_bbcode($post_text);
+    $post_text = html_entity_decode($post_text, ENT_QUOTES, 'UTF-8');
+    $post_text = function_exists('mb_substr') ? mb_substr($post_text, 0, $length) : substr($post_text, 0, $length);
+    return strip_tags($post_text);
+}
+
+function post_html_clean($str)
+{
+    global $phpbb_root_path, $phpbb_home, $mobiquo_config;
+    
+    $search = array(
+        "/<strong>(.*?)<\/strong>/si",
+        "/<a .*?href=\"(.*?)\".*?>(.*?)<\/a>/sei",
+        "/<img .*?src=\"(.*?)\".*?\/?>/si",
+        "/<br\s*\/?>|<\/cite>|<\/dt>|<\/dd>/si",
+        "/<object .*?data=\"(http:\/\/www\.youtube\.com\/.*?)\" .*?>.*?<\/object>/si",
+        "/<object .*?data=\"(http:\/\/video\.google\.com\/.*?)\" .*?>.*?<\/object>/si",
+        "/<iframe .*?src=\"(http.*?)\" .*?>.*?<\/iframe>/si",
+    );
+    
+    $replace = array(
+        '[b]$1[/b]',
+        "'[url='.url_encode('$1').']$2[/url]'",
+        '[img]$1[/img]',
+        "\n",
+        '[url=$1]YouTube Video[/url]',
+        '[url=$1]Google Video[/url]',
+        '[url=$1]$1[/url]',
+    );
+    
+    $str = preg_replace('/\n|\r/si', '', $str);
+    $str = preg_replace('/>\s+</si', '><', $str);
+    // remove smile
+    $str = preg_replace('/<img [^>]*?src=\"[^"]*?images\/smilies\/[^"]*?\"[^>]*?alt=\"([^"]*?)\"[^>]*?\/?>/', '$1', $str);
+    $str = preg_replace('/<img [^>]*?alt=\"([^"]*?)\"[^>]*?src=\"[^"]*?images\/smilies\/[^"]*?\"[^>]*?\/?>/', '$1', $str);
+    
+    $str = preg_replace('/<null.*?\/>/', '', $str);
+    $str = preg_replace($search, $replace, $str);
+    $str = strip_tags($str);
+    $str = html_entity_decode($str, ENT_QUOTES, 'UTF-8');
+    
+    // remove attach icon image
+    $str = preg_replace('/\[img\][^\[\]]+icon_topic_attach\.gif\[\/img\]/si', '', $str);
+    
+    // change relative path to absolute URL and encode url
+    $str = preg_replace('/\[img\](.*?)\[\/img\]/sei', "'[img]'.url_encode('$1').'[/img]'", $str);
+    $str = preg_replace('/\[\/img\]\s*/si', "[/img]\n", $str);
+    $str = preg_replace('/\[\/img\]\s+\[img\]/si', '[/img][img]', $str);
+    
+    // remove link on img
+    $str = preg_replace('/\[url=[^\]]*?\]\s*(\[img\].*?\[\/img\])\s*\[\/url\]/si', '$1', $str);
+    
+    // change url to image resource to img bbcode
+    $str = preg_replace('/\[url\](http[^\[\]]+\.(jpg|png|bmp|gif))\[\/url\]/si', '[img]$1[/img]', $str);
+    $str = preg_replace('/\[url=(http[^\]]+\.(jpg|png|bmp|gif))\]([^\[\]]+)\[\/url\]/si', '[img]$1[/img]', $str);
+    
+    // cut quote content to 100 charactors
+    if (isset($mobiquo_config['shorten_quote']) && $mobiquo_config['shorten_quote'])
+    {
+        $str = cut_quote($str, 100);
+    }
+    
+    return parse_bbcode($str);
+}
+
+function parse_bbcode($str)
+{
+    $search = array(
+        '#\[(b)\](.*?)\[/b\]#si',
+        '#\[(u)\](.*?)\[/u\]#si',
+        '#\[(i)\](.*?)\[/i\]#si',
+        '#\[color=(\#[\da-fA-F]{3}|\#[\da-fA-F]{6}|[A-Za-z]{1,20}|rgb\(\d{1,3}, ?\d{1,3}, ?\d{1,3}\))\](.*?)\[/color\]#sie',
+    );
+    
+    if ($GLOBALS['return_html']) {
+        $str = htmlspecialchars($str, ENT_NOQUOTES);
+        $replace = array(
+            '<$1>$2</$1>',
+            '<$1>$2</$1>',
+            '<$1>$2</$1>',
+            "mobi_color_convert('$1', '$2')",
+        );
+        $str = str_replace("\n", '<br />', $str);
+    } else {
+        $replace = array('$2', '$2', '$2', "'$2'");
+    }
+    
+    return preg_replace($search, $replace, $str);
+}
+
+function mobi_color_convert($color, $str)
+{
+    static $colorlist;
+    
+    if (preg_match('/#[\da-fA-F]{6}/is', $color))
+    {
+        if (!$colorlist)
+        {
+            $colorlist = array(
+                '#000000' => 'Black',             '#708090' => 'SlateGray',       '#C71585' => 'MediumVioletRed', '#FF4500' => 'OrangeRed',
+                '#000080' => 'Navy',              '#778899' => 'LightSlateGrey',  '#CD5C5C' => 'IndianRed',       '#FF6347' => 'Tomato',
+                '#00008B' => 'DarkBlue',          '#778899' => 'LightSlateGray',  '#CD853F' => 'Peru',            '#FF69B4' => 'HotPink',
+                '#0000CD' => 'MediumBlue',        '#7B68EE' => 'MediumSlateBlue', '#D2691E' => 'Chocolate',       '#FF7F50' => 'Coral',
+                '#0000FF' => 'Blue',              '#7CFC00' => 'LawnGreen',       '#D2B48C' => 'Tan',             '#FF8C00' => 'Darkorange',
+                '#006400' => 'DarkGreen',         '#7FFF00' => 'Chartreuse',      '#D3D3D3' => 'LightGrey',       '#FFA07A' => 'LightSalmon',
+                '#008000' => 'Green',             '#7FFFD4' => 'Aquamarine',      '#D3D3D3' => 'LightGray',       '#FFA500' => 'Orange',
+                '#008080' => 'Teal',              '#800000' => 'Maroon',          '#D87093' => 'PaleVioletRed',   '#FFB6C1' => 'LightPink',
+                '#008B8B' => 'DarkCyan',          '#800080' => 'Purple',          '#D8BFD8' => 'Thistle',         '#FFC0CB' => 'Pink',
+                '#00BFFF' => 'DeepSkyBlue',       '#808000' => 'Olive',           '#DA70D6' => 'Orchid',          '#FFD700' => 'Gold',
+                '#00CED1' => 'DarkTurquoise',     '#808080' => 'Grey',            '#DAA520' => 'GoldenRod',       '#FFDAB9' => 'PeachPuff',
+                '#00FA9A' => 'MediumSpringGreen', '#808080' => 'Gray',            '#DC143C' => 'Crimson',         '#FFDEAD' => 'NavajoWhite',
+                '#00FF00' => 'Lime',              '#87CEEB' => 'SkyBlue',         '#DCDCDC' => 'Gainsboro',       '#FFE4B5' => 'Moccasin',
+                '#00FF7F' => 'SpringGreen',       '#87CEFA' => 'LightSkyBlue',    '#DDA0DD' => 'Plum',            '#FFE4C4' => 'Bisque',
+                '#00FFFF' => 'Aqua',              '#8A2BE2' => 'BlueViolet',      '#DEB887' => 'BurlyWood',       '#FFE4E1' => 'MistyRose',
+                '#00FFFF' => 'Cyan',              '#8B0000' => 'DarkRed',         '#E0FFFF' => 'LightCyan',       '#FFEBCD' => 'BlanchedAlmond',
+                '#191970' => 'MidnightBlue',      '#8B008B' => 'DarkMagenta',     '#E6E6FA' => 'Lavender',        '#FFEFD5' => 'PapayaWhip',
+                '#1E90FF' => 'DodgerBlue',        '#8B4513' => 'SaddleBrown',     '#E9967A' => 'DarkSalmon',      '#FFF0F5' => 'LavenderBlush',
+                '#20B2AA' => 'LightSeaGreen',     '#8FBC8F' => 'DarkSeaGreen',    '#EE82EE' => 'Violet',          '#FFF5EE' => 'SeaShell',
+                '#228B22' => 'ForestGreen',       '#90EE90' => 'LightGreen',      '#EEE8AA' => 'PaleGoldenRod',   '#FFF8DC' => 'Cornsilk',
+                '#2E8B57' => 'SeaGreen',          '#9370D8' => 'MediumPurple',    '#F08080' => 'LightCoral',      '#FFFACD' => 'LemonChiffon',
+                '#2F4F4F' => 'DarkSlateGrey',     '#9400D3' => 'DarkViolet',      '#F0E68C' => 'Khaki',           '#FFFAF0' => 'FloralWhite',
+                '#2F4F4F' => 'DarkSlateGray',     '#98FB98' => 'PaleGreen',       '#F0F8FF' => 'AliceBlue',       '#FFFAFA' => 'Snow',
+                '#32CD32' => 'LimeGreen',         '#9932CC' => 'DarkOrchid',      '#F0FFF0' => 'HoneyDew',        '#FFFF00' => 'Yellow',
+                '#3CB371' => 'MediumSeaGreen',    '#9ACD32' => 'YellowGreen',     '#F0FFFF' => 'Azure',           '#FFFFE0' => 'LightYellow',
+                '#40E0D0' => 'Turquoise',         '#A0522D' => 'Sienna',          '#F4A460' => 'SandyBrown',      '#FFFFF0' => 'Ivory',
+                '#4169E1' => 'RoyalBlue',         '#A52A2A' => 'Brown',           '#F5DEB3' => 'Wheat',           '#FFFFFF' => 'White',
+                '#4682B4' => 'SteelBlue',         '#A9A9A9' => 'DarkGrey',        '#F5F5DC' => 'Beige',
+                '#483D8B' => 'DarkSlateBlue',     '#A9A9A9' => 'DarkGray',        '#F5F5F5' => 'WhiteSmoke',
+                '#48D1CC' => 'MediumTurquoise',   '#ADD8E6' => 'LightBlue',       '#F5FFFA' => 'MintCream',
+                '#4B0082' => 'Indigo',            '#ADFF2F' => 'GreenYellow',     '#F8F8FF' => 'GhostWhite',
+                '#556B2F' => 'DarkOliveGreen',    '#AFEEEE' => 'PaleTurquoise',   '#FA8072' => 'Salmon',
+                '#5F9EA0' => 'CadetBlue',         '#B0C4DE' => 'LightSteelBlue',  '#FAEBD7' => 'AntiqueWhite',
+                '#6495ED' => 'CornflowerBlue',    '#B0E0E6' => 'PowderBlue',      '#FAF0E6' => 'Linen',
+                '#66CDAA' => 'MediumAquaMarine',  '#B22222' => 'FireBrick',       '#FAFAD2' => 'LightGoldenRodYellow',
+                '#696969' => 'DimGrey',           '#B8860B' => 'DarkGoldenRod',   '#FDF5E6' => 'OldLace',
+                '#696969' => 'DimGray',           '#BA55D3' => 'MediumOrchid',    '#FF0000' => 'Red',
+                '#6A5ACD' => 'SlateBlue',         '#BC8F8F' => 'RosyBrown',       '#FF00FF' => 'Fuchsia',
+                '#6B8E23' => 'OliveDrab',         '#BDB76B' => 'DarkKhaki',       '#FF00FF' => 'Magenta',
+                '#708090' => 'SlateGrey',         '#C0C0C0' => 'Silver',          '#FF1493' => 'DeepPink',
+            );
+        }
+        
+        if (isset($colorlist[strtoupper($color)])) $color = $colorlist[strtoupper($color)];
+    }
+    
+    return "<font color=\"$color\">$str</font>";
+}
+
+
+function parse_quote($str)
+{
+    $blocks = preg_split('/(<blockquote.*?>|<\/blockquote>)/i', $str, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE);
+    
+    $quote_level = 0;
+    $message = '';
+        
+    foreach($blocks as $block)
+    {
+        if (preg_match('/<blockquote.*?>/i', $block)) {
+            if ($quote_level == 0) $message .= '[quote]';
+            $quote_level++;
+        } else if (preg_match('/<\/blockquote>/i', $block)) {
+            if ($quote_level <= 1) $message .= '[/quote]';
+            if ($quote_level >= 1) {
+                $quote_level--;
+                $message .= "\n";
+            }
+        } else {
+            if ($quote_level <= 1) $message .= $block;
+        }
+    }
+    
+    return $message;
+}
+
+function process_bbcode($message, $uid)
+{
+    global $user;
+    
+    // process bbcode: code
+    $message = str_replace('[code:'.$uid.']', '[quote]', $message);
+    $message = str_replace('[/code:'.$uid.']', '[/quote]', $message);
+    
+    // process bbcode: quote
+    $quote_wrote_string = $user->lang['WROTE'];
+    $message = str_replace('[/quote:'.$uid.']', '[/quote]', $message);
+    $message = preg_replace('/\[quote(?:=&quot;(.*?)&quot;)?:'.$uid.'\]/ise', "'[quote]' . ('$1' ? '$1' . ' $quote_wrote_string:\n' : '\n')", $message);
+    $blocks = preg_split('/(\[\/?quote\])/i', $message, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE);
+
+    $quote_level = 0;
+    $message = '';
+
+    foreach($blocks as $block)
+    {
+        if ($block == '[quote]') {
+            if ($quote_level == 0) $message .= $block;
+            $quote_level++;
+        } else if ($block == '[/quote]') {
+            if ($quote_level <= 1) $message .= $block;
+            if ($quote_level >= 1) $quote_level--;
+        } else {
+            if ($quote_level <= 1) $message .= $block;
+        }
+    }
+    
+    // prcess bbcode: list
+    $message = preg_replace('/\[\*:'.$uid.'\]/si', '[*]', $message);
+    $message = preg_replace('/\[\/\*:(m:)?'.$uid.'\]/si', '', $message);
+    $blocks = preg_split('/(\[list=[^\]]*?:'.$uid.'\]|\[list:'.$uid.'\]|\[\/list:o:'.$uid.'\]|\[\/list:u:'.$uid.'\])/siU', $message, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE);
+    
+    $result = '';
+    $status = 'out';
+    foreach($blocks as $block)
+    {
+        if ($status == 'out')
+        {
+            if (strpos($block, '[list:') !== false)
+            {
+                $status = 'inlist';
+            } elseif (strpos($block, '[list=') !== false)
+            {
+                $status = 'inorder';
+            } else {
+                $result .= $block;
+            }
+        } elseif ($status == 'inlist')
+        {
+            if (strpos($block, '[/list') !== false)
+            {
+                $status = 'out';
+            } else
+            {
+                $result .= str_replace('[*]', '  * ', ltrim($block));
+            }
+        } elseif ($status == 'inorder')
+        {
+            if (strpos($block, '[/list') !== false)
+            {
+                $status = 'out';
+            } else
+            {
+                $index = 1;
+                $result .= preg_replace('/\[\*\]/sie', "'  '.\$index++.'. '", ltrim($block));
+            }
+        }
+    }
+    
+    $message = $result;
+    
+    // process video bbcode\
+    $message = preg_replace('/\[(youtube|yt|video|googlevideo|gvideo):'.$uid.'\](.*?)\[\/\1:'.$uid.'\]/sie', "video_bbcode_format('$1', '$2')", $message);
+    $message = preg_replace('/\[(BBvideo)[\d, ]+:'.$uid.'\](.*?)\[\/\1:'.$uid.'\]/si', "[url=$2]YouTube Video[/url]", $message);
+    $message = preg_replace('/\[(spoil|spoiler):'.$uid.'\](.*?)\[\/\1:'.$uid.'\]/si', "[spoiler]$2[/spoiler]", $message);
+    $message = preg_replace('/\[b:'.$uid.'\](.*?)\[\/b:'.$uid.'\]/si', '[b]$1[/b]', $message);
+    $message = preg_replace('/\[i:'.$uid.'\](.*?)\[\/i:'.$uid.'\]/si', '[i]$1[/i]', $message);
+    $message = preg_replace('/\[u:'.$uid.'\](.*?)\[\/u:'.$uid.'\]/si', '[u]$1[/u]', $message);
+    $message = preg_replace('/\[color=(\#[\da-fA-F]{3}|\#[\da-fA-F]{6}|[A-Za-z]{1,20}|rgb\(\d{1,3}, ?\d{1,3}, ?\d{1,3}\)):'.$uid.'\](.*?)\[\/color:'.$uid.'\]/si', '[color=$1]$2[/color]', $message);
+    $message = preg_replace('/\[mp3preview:'.$uid.'\](.*?)\[\/mp3preview:'.$uid.'\]/si', '[url=$1]MP3 Preview[/url]', $message);
+    
+    return $message;
+}
+
+function url_encode($url)
+{
+    global $phpbb_home, $phpbb_root_path;
+    
+    $url = rawurlencode($url);
+    
+    $from = array('/%3A/', '/%2F/', '/%3F/', '/%2C/', '/%3D/', '/%26/', '/%25/', '/%23/', '/%2B/', '/%3B/', '/%5C/');
+    $to   = array(':',     '/',     '?',     ',',     '=',     '&',     '%',     '#',     '+',     ';',     '\\');
+    $url = preg_replace($from, $to, $url);
+    $root_path = preg_replace('/^\//', '', $phpbb_root_path);
+    $url = preg_replace('#^\.\./|^/|'.addslashes($root_path).'#si', '', $url);
+    
+    if (strpos($url, 'http') !== 0)
+    {
+        $url = $phpbb_home.$url;
+    }
+    
+    return htmlspecialchars_decode($url);
+}
+
+function get_user_avatar_url($avatar, $avatar_type, $ignore_config = false)
+{
+    global $config, $phpbb_home, $phpEx;
+
+    if (empty($avatar) || !$avatar_type || (isset($config['allow_avatar']) && !$config['allow_avatar'] && !$ignore_config))
+    {
+        return '';
+    }
+    
+    $avatar_img = '';
+
+    switch ($avatar_type)
+    {
+        case AVATAR_UPLOAD:
+            if (isset($config['allow_avatar_upload']) && !$config['allow_avatar_upload'] && !$ignore_config)
+            {
+                return '';
+            }
+            $avatar_img = $phpbb_home . "download/file.$phpEx?avatar=";
+        break;
+
+        case AVATAR_GALLERY:
+            if (isset($config['allow_avatar_local']) && !$config['allow_avatar_local'] && !$ignore_config)
+            {
+                return '';
+            }
+            $avatar_img = $phpbb_home . $config['avatar_gallery_path'] . '/';
+        break;
+
+        case AVATAR_REMOTE:
+            if (isset($config['allow_avatar_remote']) && !$config['allow_avatar_remote'] && !$ignore_config)
+            {
+                return '';
+            }
+        break;
+    }
+
+    $avatar_img .= $avatar;
+    $avatar_img = str_replace(' ', '%20', $avatar_img);
+    
+    return $avatar_img;
+}
+
+
+function mobiquo_iso8601_encode($timet)
+{
+    global $user;
+    
+    return $user->format_date($timet);
+}
+
+
+function get_user_id_by_name($username)
+{
+    global $db;
+    
+    if (!$username)
+    {
+        return false;
+    }
+    
+    $username_clean = $db->sql_escape(utf8_clean_string($username));
+    
+    $sql = 'SELECT user_id
+            FROM ' . USERS_TABLE . "
+            WHERE username_clean = '$username_clean'";
+    $result = $db->sql_query($sql);
+    $user_id = $db->sql_fetchfield('user_id');
+    $db->sql_freeresult($result);
+    
+    return $user_id;
+}
+
+function cut_quote($str, $keep_size)
+{
+    $str_array = preg_split('/(\[quote\].*?\[\/quote\])/is', $str, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE);
+    
+    $str = '';
+    
+    foreach($str_array as $block)
+    {
+        if (preg_match('/\[quote\](.*?)\[\/quote\]/is', $block, $block_matches))
+        {
+            $quote_array = preg_split('/(\[img\].*?\[\/img\]|\[url=.*?\].*?\[\/url\])/is', $block_matches[1], -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE);
+            $short_str = '';
+            $current_size = 0;
+            $img_flag = true; // just keep at most one img in the quote
+            for ($i = 0, $size = sizeof($quote_array); $i < $size; $i++)
+            {
+                if (preg_match('/^\[img\].*?\[\/img\]$/is', $quote_array[$i]))
+                {
+                    if ($img_flag)
+                    {
+                        $short_str .= $quote_array[$i];
+                        $img_flag = false;
+                    }
+                }
+                else if (preg_match('/^\[url=.*?\](.*?)\[\/url\]$/is', $quote_array[$i], $matches))
+                {
+                    $short_str .= $quote_array[$i];
+                    $current_size += strlen($matches[1]);
+                    if ($current_size > $keep_size)
+                    {
+                        $short_str .= "...";
+                        break;
+                    }
+                }
+                else
+                {
+                    if ($current_size + strlen($quote_array[$i]) > $keep_size)
+                    {
+                        $short_str .= substr($quote_array[$i], 0, $keep_size - $current_size);
+                        $short_str .= "...";
+                        break;
+                    }
+                    else
+                    {
+                        $short_str .= $quote_array[$i];
+                        $current_size += strlen($quote_array[$i]);
+                    }
+                }
+            }
+            $str .= '[quote]' . $short_str . '[/quote]';
+        } else {
+            $str .= $block;
+        }
+    }
+
+    return $str;
+}
+
+function video_bbcode_format($type, $url)
+{
+    $url = trim($url);
+    
+    switch (strtolower($type)) {
+        case 'yt':
+        case 'youtube':
+            if (preg_match('#^(http://)?((www|m)\.)?(youtube\.com/(watch\?.*?v=|v/)|youtu\.be/)([-\w]+)#', $url, $matches)) {
+                $message = '[url='.$url.']YouTube Video[/url]';
+            } else if (preg_match('/^[-\w]+$/', $url)) {
+                $url = 'http://www.youtube.com/watch?v='.$url;
+                $message = '[url='.$url.']YouTube Video[/url]';
+            } else {
+                $message = '';
+            }
+            break;
+        case 'video':
+            if (preg_match('#^http(s)?://#', $url)) {
+                $message = '[url='.$url.']Video[/url]';
+            } else {
+                $message = '';
+            }
+            break;
+        case 'gvideo':
+        case 'googlevideo':
+            if (preg_match('#^http://video.google.com/(googleplayer.swf|videoplay)?docid=-#', $url)) {
+                $message = '[url='.$url.']Google Video[/url]';
+            } else if (preg_match('/^-?(\d+)/', $url, $matches)) {
+                $message = '[url=http://video.google.com/videoplay?docid=-'.$matches['1'].']Google Video[/url]';
+            } else {
+                $message = '';
+            }
+            break;
+        default: $message = '';
+    }
+    
+    return $message;
+}
+
+function check_forum_password($forum_id)
+{
+    global $user, $db;
+    
+    $sql = 'SELECT forum_id
+            FROM ' . FORUMS_ACCESS_TABLE . '
+            WHERE forum_id = ' . $forum_id . '
+                AND user_id = ' . $user->data['user_id'] . "
+                AND session_id = '" . $db->sql_escape($user->session_id) . "'";
+    $result = $db->sql_query($sql);
+    $row = $db->sql_fetchrow($result);
+    $db->sql_freeresult($result);
+
+    if (!$row)
+    {
+        return false;
+    }
+    
+    return true;
+}
+
+function get_participated_user_avatars($tids)
+{
+    global $db, $topic_users, $user_avatar;
+    
+    $topic_users = array();
+    $user_avatar = array();
+    if (!empty($tids))
+    {
+        $posters = array();
+        foreach($tids as $tid)
+        {
+            $sql = 'SELECT poster_id, count(post_id) as num FROM ' . POSTS_TABLE . '
+                    WHERE topic_id=' . $tid . '
+                    GROUP BY poster_id
+                    ORDER BY num DESC';
+            $result = $db->sql_query_limit($sql, 10);
+            while ($row = $db->sql_fetchrow($result))
+            {
+                $posters[$row['poster_id']] = $row['num'];
+                $topic_users[$tid][] = $row['poster_id'];
+            }
+            $db->sql_freeresult($result);
+        }
+        
+        if (!empty($posters))
+        {
+            $user_avatar = get_user_avatars(array_keys($posters));
+        }
+    }
+}
+
+function get_user_avatars($users, $is_username = false)
+{
+    global $db;
+    
+    if (empty($users)) return array();
+    
+    if (!is_array($users)) $users = array($users);
+    
+    if($is_username)
+        foreach($users as $key => $username)
+            $users[$key] = $db->sql_escape(utf8_clean_string($username));
+    
+    $sql = 'SELECT user_id, username, user_avatar, user_avatar_type 
+            FROM ' . USERS_TABLE . '
+            WHERE ' . $db->sql_in_set($is_username ? 'username_clean' : 'user_id', $users);
+    $result = $db->sql_query($sql);
+    $user_avatar = array();
+    $user_key = $is_username ? 'username' : 'user_id';
+    while ($row = $db->sql_fetchrow($result))
+    {
+        $user_avatar[$row[$user_key]] = get_user_avatar_url($row['user_avatar'], $row['user_avatar_type']);
+    }
+    $db->sql_freeresult($result);
+    
+    return $user_avatar;
+}
+
+function check_error_status(&$str)
+{
+    global $user, $request_method;
+    
+    switch ($request_method) {
+        case 'thank_post':
+            if (strpos($str, $user->lang['THANKS_INFO_GIVE']) !== false || $str == "Insert thanks") {
+                $str = '';
+                return true;
+            } elseif (strpos($str, $user->lang['GLOBAL_INCORRECT_THANKS']) !== false) {
+                $str = $user->lang['GLOBAL_INCORRECT_THANKS'];
+                return false;
+            } elseif (strpos($str, $user->lang['INCORRECT_THANKS']) !== false) {
+                $str = $user->lang['INCORRECT_THANKS'];
+                return false;
+            } else {
+                return false;
+            }
+            
+        case 'm_stick_topic':
+            if (strpos($str, $user->lang['TOPIC_TYPE_CHANGED']) === false)
+                return false;
+            else {
+                $str = $user->lang['TOPIC_TYPE_CHANGED'];
+                return true;
+            }
+        case 'm_close_topic':
+            if (strpos($str, $user->lang['TOPIC_LOCKED_SUCCESS']) === false && strpos($str, $user->lang['TOPIC_UNLOCKED_SUCCESS']) === false)
+                return false;
+            elseif (strpos($str, $user->lang['TOPIC_LOCKED_SUCCESS']) !== false) {
+                $str = $user->lang['TOPIC_LOCKED_SUCCESS'];
+                return true;
+            } else {
+                $str = $user->lang['TOPIC_UNLOCKED_SUCCESS'];
+                return true;
+            }
+        case 'm_delete_topic':
+            if (strpos($str, $user->lang['TOPIC_DELETED_SUCCESS']) === false)
+                return false;
+            else {
+                $str = $user->lang['TOPIC_DELETED_SUCCESS'];
+                return true;
+            }
+        case 'm_delete_post':
+            if (strpos($str, $user->lang['POST_DELETED_SUCCESS']) === false && strpos($str, $user->lang['TOPIC_DELETED_SUCCESS']) === false)
+                return false;
+            elseif (strpos($str, $user->lang['POST_DELETED_SUCCESS']) !== false) {
+                $str = $user->lang['POST_DELETED_SUCCESS'];
+                return true;
+            } else {
+                $str = $user->lang['TOPIC_DELETED_SUCCESS'];
+                return true;
+            }
+        case 'm_move_topic':
+            if (strpos($str, $user->lang['TOPIC_MOVED_SUCCESS']) === false)
+                return false;
+            else {
+                $str = $user->lang['TOPIC_MOVED_SUCCESS'];
+                return true;
+            }
+        case 'm_move_post':
+            if (strpos($str, $user->lang['TOPIC_SPLIT_SUCCESS']) === false && strpos($str, $user->lang['POSTS_MERGED_SUCCESS']) === false)
+                return false;
+            elseif (strpos($str, $user->lang['TOPIC_SPLIT_SUCCESS']) !== false) {
+                $str = $user->lang['TOPIC_SPLIT_SUCCESS'];
+                return true;
+            } else {
+                $str = $user->lang['POSTS_MERGED_SUCCESS'];
+                return true;
+            }
+        case 'm_merge_topic':
+            if (strpos($str, $user->lang['POSTS_MERGED_SUCCESS']) === false)
+                return false;
+            else {
+                $str = $user->lang['POSTS_MERGED_SUCCESS'];
+                return true;
+            }
+        case 'm_approve_topic':
+            if (strpos($str, $user->lang['TOPIC_APPROVED_SUCCESS']) === false)
+                return false;
+            else {
+                $str = $user->lang['TOPIC_APPROVED_SUCCESS'];
+                return true;
+            }
+        case 'm_approve_post':
+            if (strpos($str, $user->lang['POST_APPROVED_SUCCESS']) === false)
+                return false;
+            else {
+                $str = $user->lang['POST_APPROVED_SUCCESS'];
+                return true;
+            }
+        case 'm_ban_user':
+            if (strpos($str, $user->lang['BAN_UPDATE_SUCCESSFUL']) === false)
+                return false;
+            else {
+                $str = $user->lang['BAN_UPDATE_SUCCESSFUL'];
+                return true;
+            }
+    }
+    
+    return false;
+}
+
+function tt_get_unread_topics($user_id = false, $sql_extra = '', $sql_sort = '', $sql_limit = 1001, $sql_limit_offset = 0)
+{
+    global $config, $db, $user;
+
+    $user_id = ($user_id === false) ? (int) $user->data['user_id'] : (int) $user_id;
+
+    // Data array we're going to return
+    $unread_topics = array();
+
+    if (empty($sql_sort))
+    {
+        $sql_sort = 'ORDER BY t.topic_last_post_time DESC';
+    }
+
+    if ($config['load_db_lastread'] && $user->data['is_registered'])
+    {
+        // Get list of the unread topics
+        $last_mark = (int) $user->data['user_lastmark'];
+
+        $sql_array = array(
+            'SELECT'        => 't.topic_id, t.topic_last_post_time, tt.mark_time as topic_mark_time, ft.mark_time as forum_mark_time',
+
+            'FROM'            => array(TOPICS_TABLE => 't'),
+
+            'LEFT_JOIN'        => array(
+                array(
+                    'FROM'    => array(TOPICS_TRACK_TABLE => 'tt'),
+                    'ON'    => "tt.user_id = $user_id AND t.topic_id = tt.topic_id",
+                ),
+                array(
+                    'FROM'    => array(FORUMS_TRACK_TABLE => 'ft'),
+                    'ON'    => "ft.user_id = $user_id AND t.forum_id = ft.forum_id",
+                ),
+            ),
+
+            'WHERE'            => "
+                 t.topic_last_post_time > $last_mark AND
+                (
+                (tt.mark_time IS NOT NULL AND t.topic_last_post_time > tt.mark_time) OR
+                (tt.mark_time IS NULL AND ft.mark_time IS NOT NULL AND t.topic_last_post_time > ft.mark_time) OR
+                (tt.mark_time IS NULL AND ft.mark_time IS NULL)
+                )
+                $sql_extra
+                $sql_sort",
+        );
+
+        $sql = $db->sql_build_query('SELECT', $sql_array);
+        $result = $db->sql_query_limit($sql, $sql_limit, $sql_limit_offset);
+
+        while ($row = $db->sql_fetchrow($result))
+        {
+            $topic_id = (int) $row['topic_id'];
+            $unread_topics[$topic_id] = ($row['topic_mark_time']) ? (int) $row['topic_mark_time'] : (($row['forum_mark_time']) ? (int) $row['forum_mark_time'] : $last_mark);
+        }
+        $db->sql_freeresult($result);
+    }
+    else if ($config['load_anon_lastread'] || $user->data['is_registered'])
+    {
+        global $tracking_topics;
+
+        if (empty($tracking_topics))
+        {
+            $tracking_topics = request_var($config['cookie_name'] . '_track', '', false, true);
+            $tracking_topics = ($tracking_topics) ? tracking_unserialize($tracking_topics) : array();
+        }
+
+        if (!$user->data['is_registered'])
+        {
+            $user_lastmark = (isset($tracking_topics['l'])) ? base_convert($tracking_topics['l'], 36, 10) + $config['board_startdate'] : 0;
+        }
+        else
+        {
+            $user_lastmark = (int) $user->data['user_lastmark'];
+        }
+
+        $sql = 'SELECT t.topic_id, t.forum_id, t.topic_last_post_time
+            FROM ' . TOPICS_TABLE . ' t
+            WHERE t.topic_last_post_time > ' . $user_lastmark . "
+            $sql_extra
+            $sql_sort";
+        $result = $db->sql_query_limit($sql, $sql_limit, $sql_limit_offset);
+
+        while ($row = $db->sql_fetchrow($result))
+        {
+            $forum_id = (int) $row['forum_id'];
+            $topic_id = (int) $row['topic_id'];
+            $topic_id36 = base_convert($topic_id, 10, 36);
+
+            if (isset($tracking_topics['t'][$topic_id36]))
+            {
+                $last_read = base_convert($tracking_topics['t'][$topic_id36], 36, 10) + $config['board_startdate'];
+
+                if ($row['topic_last_post_time'] > $last_read)
+                {
+                    $unread_topics[$topic_id] = $last_read;
+                }
+            }
+            else if (isset($tracking_topics['f'][$forum_id]))
+            {
+                $mark_time = base_convert($tracking_topics['f'][$forum_id], 36, 10) + $config['board_startdate'];
+
+                if ($row['topic_last_post_time'] > $mark_time)
+                {
+                    $unread_topics[$topic_id] = $mark_time;
+                }
+            }
+            else
+            {
+                $unread_topics[$topic_id] = $user_lastmark;
+            }
+        }
+        $db->sql_freeresult($result);
+    }
+
+    return $unread_topics;
+}
\ No newline at end of file
diff -ruN phpBB-3.0.10/mobiquo/mobiquo.php phpbb/mobiquo/mobiquo.php
--- phpBB-3.0.10/mobiquo/mobiquo.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/mobiquo.php	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,47 @@
+<?php
+/**
+*
+* @copyright (c) 2009, 2010, 2011 Quoord Systems Limited
+* @license http://opensource.org/licenses/gpl-2.0.php GNU Public License (GPLv2)
+*
+*/
+
+define('IN_PHPBB', true);
+define('IN_MOBIQUO', true);
+define('MOBIQUO_DEBUG', 0);
+
+include('./config/config.php');
+include('./mobiquo_common.php');
+
+define('PHPBB_MSG_HANDLER', 'xmlrpc_error_handler');
+register_shutdown_function('xmlrpc_shutdown');
+
+include($phpbb_root_path . 'common.' . $phpEx);
+//include($phpbb_root_path . 'includes/functions_display.' . $phpEx);
+
+error_reporting(MOBIQUO_DEBUG);
+if (MOBIQUO_DEBUG == 0) ob_start();
+
+include('./include/xmlrpc.inc');
+include('./include/xmlrpcs.inc');
+
+require('./server_define.php');
+require('./env_setting.php');
+require('./xmlrpcresp.php');
+
+if ($request_file && isset($server_param[$request_method]))
+{
+    if (strpos($request_file, 'm_') === 0)
+        require('./function/moderation.php');
+    else
+        require('./function/'.$request_file.'.php');
+}
+
+$rpcServer = new xmlrpc_server($server_param, false);
+$rpcServer->setDebug(1);
+$rpcServer->compress_response = 'true';
+$rpcServer->response_charset_encoding = 'UTF-8';
+$rpcServer->service();
+exit;
+
+?>
\ No newline at end of file
diff -ruN phpBB-3.0.10/mobiquo/README.txt phpbb/mobiquo/README.txt
--- phpBB-3.0.10/mobiquo/README.txt	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/README.txt	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,17 @@
+Installation instruction
+========================
+
+For details step by step instruction to install Tapatalk plugin to your phpBB3 forum system. Please login to http://tapatalk.com/plugin.php
+
+Installation is easy. It does not change any of your forum settings or overwrite any of your existing forum code and configuration. Simply follow the procedure below:
+
+1) Place the zip package at the root of your forum system.
+2) Unzip the package. You should see a directory called "mobiquo" inside your forum system root directory. For example, if your forum URL is http://www.mysite.com/forum, it should be placed at http://www.mysite.com/forum/mobiquo/.
+
+
+To uninstall Tapatalk:
+- Remove the "mobiquo" directory.
+
+
+"So how do I know if I installed properly?" 
+- You will need to login to the Tapatalk Forum Owner Area (http://www.tapatalk.com/plugin.php) to verify the installation.  As soon as you submitted your forum information into the system, a simple tool is provided to verify your installation. If it doesn't appear to be working properly, you can post your problem at Tapatalk Community Forum (http://tapatalk.com/forum) and we will assist you any problem that you might have.
\ No newline at end of file
diff -ruN phpBB-3.0.10/mobiquo/server_define.php phpbb/mobiquo/server_define.php
--- phpBB-3.0.10/mobiquo/server_define.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/server_define.php	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,413 @@
+<?php
+/**
+*
+* @copyright (c) 2009, 2010, 2011 Quoord Systems Limited
+* @license http://opensource.org/licenses/gpl-2.0.php GNU Public License (GPLv2)
+*
+*/
+
+defined('IN_MOBIQUO') or exit;
+
+$server_param = array(
+    
+    'login' => array(
+        'function'  => 'login_func',
+        'signature' => array(array($xmlrpcStruct, $xmlrpcBase64, $xmlrpcBase64),
+                             array($xmlrpcStruct, $xmlrpcBase64, $xmlrpcBase64, $xmlrpcBoolean)),
+        'docstring' => 'login need two parameters,the first is user name(Base64), second is password(Base64).',
+    ),
+    
+    'get_forum' => array(
+        'function' => 'get_forum_func',
+        'signature' => array(array($xmlrpcArray),
+                             array($xmlrpcArray, $xmlrpcBoolean),
+                             array($xmlrpcArray, $xmlrpcBoolean, $xmlrpcString)),
+    ),
+    
+    'get_topic' => array(
+        'function'  => 'get_topic_func',
+        'signature' => array(array($xmlrpcStruct, $xmlrpcString, $xmlrpcInt, $xmlrpcInt, $xmlrpcString),
+                             array($xmlrpcStruct, $xmlrpcString, $xmlrpcInt, $xmlrpcInt),
+                             array($xmlrpcStruct, $xmlrpcString, $xmlrpcInt),
+                             array($xmlrpcStruct, $xmlrpcString)),
+        'docstring' => 'parameter should be array(string,int,int,string)',
+    ),
+    
+    'get_thread' => array(
+        'function'  => 'get_thread_func',
+        'signature' => array(array($xmlrpcStruct, $xmlrpcString, $xmlrpcInt, $xmlrpcInt, $xmlrpcBoolean),
+                             array($xmlrpcStruct, $xmlrpcString, $xmlrpcInt, $xmlrpcInt),
+                             array($xmlrpcStruct, $xmlrpcString)),
+    ),
+    
+    'get_thread_by_unread' => array(
+        'function'  => 'get_thread_func',
+        'signature' => array(array($xmlrpcStruct, $xmlrpcString, $xmlrpcInt, $xmlrpcBoolean),
+                             array($xmlrpcStruct, $xmlrpcString, $xmlrpcInt),
+                             array($xmlrpcStruct, $xmlrpcString)),
+    ),
+    
+    'get_thread_by_post' => array(
+        'function'  => 'get_thread_func',
+        'signature' => array(array($xmlrpcStruct, $xmlrpcString, $xmlrpcInt, $xmlrpcBoolean),
+                             array($xmlrpcStruct, $xmlrpcString, $xmlrpcInt),
+                             array($xmlrpcStruct, $xmlrpcString)),
+    ),
+    
+    'get_raw_post' => array(
+        'function'  => 'get_raw_post_func',
+        'signature' => array(array($xmlrpcStruct, $xmlrpcString)),
+        'docstring' => 'parameter should be array(string)',
+    ),
+    
+    'save_raw_post' => array(
+        'function'  => 'save_raw_post_func',
+        'signature' => array(array($xmlrpcStruct, $xmlrpcString, $xmlrpcBase64, $xmlrpcBase64),
+                             array($xmlrpcStruct, $xmlrpcString, $xmlrpcBase64, $xmlrpcBase64, $xmlrpcBoolean)),
+        'docstring' => 'parameter should be array(string, base64, base64)',
+    ),
+    
+    'get_quote_post' => array(
+        'function'  => 'get_quote_post_func',
+        'signature' => array(array($xmlrpcStruct, $xmlrpcString)),
+        'docstring' => 'parameter should be array(string)',
+    ),
+    
+    'get_quote_pm' => array(
+        'function'  => 'get_quote_pm_func',
+        'signature' => array(array($xmlrpcStruct, $xmlrpcString)),
+        'docstring' => 'parameter should be array(string)',
+    ),
+    
+    'get_user_topic' => array(
+        'function'  => 'search_func',
+        'signature' => array(array($xmlrpcStruct),
+                             array($xmlrpcStruct, $xmlrpcBase64),
+                             array($xmlrpcStruct, $xmlrpcBase64, $xmlrpcString)),
+    ),
+    
+    'get_user_reply_post' => array(
+        'function'  => 'search_func',
+        'signature' => array(array($xmlrpcStruct),
+                             array($xmlrpcStruct, $xmlrpcBase64),
+                             array($xmlrpcStruct, $xmlrpcBase64, $xmlrpcString)),
+    ),
+    
+    'get_latest_topic' => array(
+        'function' => 'search_func',
+        'signature' => array(array($xmlrpcArray),
+                             array($xmlrpcArray, $xmlrpcInt, $xmlrpcInt),
+                             array($xmlrpcArray, $xmlrpcInt, $xmlrpcInt, $xmlrpcString),
+                             array($xmlrpcArray, $xmlrpcInt, $xmlrpcInt, $xmlrpcString, $xmlrpcStruct)),
+    ),
+    
+    'get_unread_topic' => array(
+        'function' => 'search_func',
+        'signature' => array(array($xmlrpcArray),
+                             array($xmlrpcArray, $xmlrpcInt, $xmlrpcInt),
+                             array($xmlrpcArray, $xmlrpcInt, $xmlrpcInt, $xmlrpcString),
+                             array($xmlrpcArray, $xmlrpcInt, $xmlrpcInt, $xmlrpcString, $xmlrpcStruct)),
+    ),
+    
+    'get_participated_topic' => array(
+        'function' => 'search_func',
+        'signature' => array(array($xmlrpcArray, $xmlrpcBase64, $xmlrpcInt, $xmlrpcInt, $xmlrpcString, $xmlrpcString),
+                             array($xmlrpcArray, $xmlrpcBase64, $xmlrpcInt, $xmlrpcInt, $xmlrpcString),
+                             array($xmlrpcArray, $xmlrpcBase64, $xmlrpcInt, $xmlrpcInt),
+                             array($xmlrpcArray, $xmlrpcBase64),
+                             array($xmlrpcArray)),
+    ),
+    
+    'get_subscribed_topic' => array(
+        'function'  => 'search_func',
+        'signature' => array(array($xmlrpcArray),
+                             array($xmlrpcStruct, $xmlrpcInt, $xmlrpcInt)),
+        'docstring' => 'no need parameters for get_subscribed_topic',
+    ),
+    
+    'get_subscribed_forum' => array(
+        'function'  => 'get_subscribed_forum_func',
+        'signature' => array(array($xmlrpcArray)),
+        'docstring' => 'no need parameters for get_subscribed_forum',
+    ),
+    
+    'get_user_info' => array(
+        'function' => 'get_user_info_func',
+        'signature' => array(array($xmlrpcStruct),
+                             array($xmlrpcStruct, $xmlrpcBase64),
+                             array($xmlrpcStruct, $xmlrpcBase64, $xmlrpcString)),
+    ),
+    
+    'get_config' => array(
+        'function'  => 'get_config_func',
+        'signature' => array(array($xmlrpcArray)),
+        'docstring' => 'no need parameters for get_forum',
+    ),
+    
+    'logout_user' => array(
+        'function'  => 'logout_user_func',
+        'signature' => array(array($xmlrpcArray)),
+        'docstring' => 'no need parameters for logout',
+    ),
+    
+    'new_topic' => array(
+        'function'  => 'new_topic_func',
+        'signature' => array(array($xmlrpcStruct, $xmlrpcString, $xmlrpcBase64, $xmlrpcBase64),
+                             array($xmlrpcStruct, $xmlrpcString, $xmlrpcBase64, $xmlrpcBase64, $xmlrpcString),
+                             array($xmlrpcStruct, $xmlrpcString, $xmlrpcBase64, $xmlrpcBase64, $xmlrpcString, $xmlrpcArray),
+                             array($xmlrpcStruct, $xmlrpcString, $xmlrpcBase64, $xmlrpcBase64, $xmlrpcString, $xmlrpcArray, $xmlrpcString)),
+        'docstring' => 'parameter should be array(string,byte,byte,[string],[array])',
+    ),
+    
+    'reply_post' => array(
+        'function'  => 'reply_post_func',
+        'signature' => array(array($xmlrpcStruct, $xmlrpcString, $xmlrpcString, $xmlrpcBase64, $xmlrpcBase64),
+                             array($xmlrpcStruct, $xmlrpcString, $xmlrpcString, $xmlrpcBase64, $xmlrpcBase64, $xmlrpcArray, $xmlrpcString),
+                             array($xmlrpcStruct, $xmlrpcString, $xmlrpcString, $xmlrpcBase64, $xmlrpcBase64, $xmlrpcArray, $xmlrpcString, $xmlrpcBoolean)),
+        'docstring' => 'parameter should be array(int,string,string)',
+    ),
+    
+    'subscribe_topic' => array(
+        'function'  => 'subscribe_topic_func',
+        'signature' => array(array($xmlrpcStruct, $xmlrpcString)),
+        'docstring' => 'subscribe_topic need one parameters as topic id.',
+    ),
+    
+    'unsubscribe_topic' => array(
+        'function'  => 'unsubscribe_topic_func',
+        'signature' => array(array($xmlrpcStruct, $xmlrpcString)),
+        'docstring' => 'unsubscribe_topic need one parameters as topic id.',
+    ),
+    
+    'subscribe_forum' => array(
+        'function'  => 'subscribe_forum_func',
+        'signature' => array(array($xmlrpcStruct, $xmlrpcString)),
+        'docstring' => 'subscribe_topic need one parameters as forum id.',
+    ),
+    
+    'unsubscribe_forum' => array(
+        'function'  => 'unsubscribe_forum_func',
+        'signature' => array(array($xmlrpcStruct, $xmlrpcString)),
+        'docstring' => 'unsubscribe_topic need one parameters as forum id.',
+    ),
+    
+    'get_inbox_stat' => array(
+        'function'  => 'get_inbox_stat_func',
+        'signature' => array(array($xmlrpcArray)),
+        'docstring' => 'no parameter but need login first',
+    ),
+    
+    'get_box_info' => array(
+        'function'  => 'get_box_info_func',
+        'signature' => array(array($xmlrpcArray)),
+        'docstring' => 'no parameter but need login first',
+    ),
+    
+    'get_box' => array(
+        'function'  => 'get_box_func',
+        'signature' => array(array($xmlrpcStruct, $xmlrpcString, $xmlrpcInt, $xmlrpcInt, $xmlrpcDateTime),
+                             array($xmlrpcStruct, $xmlrpcString, $xmlrpcInt, $xmlrpcInt),
+                             array($xmlrpcStruct, $xmlrpcString, $xmlrpcInt),
+                             array($xmlrpcStruct, $xmlrpcString)),
+        'docstring' => 'parameter should be array(string,int,int,date)',
+    ),
+    
+    'get_message' => array(
+        'function'  => 'get_message_func',
+        'signature' => array(array($xmlrpcStruct, $xmlrpcString),
+                             array($xmlrpcStruct, $xmlrpcString, $xmlrpcString),
+                             array($xmlrpcStruct, $xmlrpcString, $xmlrpcString, $xmlrpcBoolean)),
+        'docstring' => 'get_message need one parameter as message id'
+    ),
+    
+    'delete_message' => array(
+        'function'  => 'delete_message_func',
+        'signature' => array(array($xmlrpcStruct, $xmlrpcString),
+                             array($xmlrpcStruct, $xmlrpcString, $xmlrpcString)),
+        'docstring' => 'get_message need one parameter as message id'
+    ),
+    
+    'create_message' => array(
+        'function'  => 'create_message_func',
+        'signature' => array(array($xmlrpcStruct, $xmlrpcArray, $xmlrpcBase64, $xmlrpcBase64),
+                             array($xmlrpcStruct, $xmlrpcArray, $xmlrpcBase64, $xmlrpcBase64, $xmlrpcInt, $xmlrpcString)),
+        'docstring' => 'parameter should be array(array,string,string,[int, string])',
+    ),
+    
+    'get_board_stat' => array(
+        'function'  => 'get_board_stat_func',
+        'signature' => array(array($xmlrpcStruct)),
+        'docstring' => 'no parameter',
+    ),
+    
+    'get_online_users' => array(
+        'function'  => 'get_online_users_func',
+        'signature' => array(array($xmlrpcStruct)),
+        'docstring' => 'no parameter',
+    ),
+    
+    'mark_all_as_read' => array(
+        'function'  => 'mark_all_as_read_func',
+        'signature' => array(array($xmlrpcArray),
+                             array($xmlrpcStruct, $xmlrpcString)),
+        'docstring' => 'no need parameters for mark_all_as_read',
+    ),
+
+    'search' => array(
+        'function' => 'search_func',
+        'signature' => array(array($xmlrpcStruct, $xmlrpcStruct)),
+    ),
+
+    'search_topic' => array(
+        'function'  => 'search_func',
+        'signature' => array(array($xmlrpcStruct, $xmlrpcBase64, $xmlrpcInt, $xmlrpcInt, $xmlrpcString),
+                             array($xmlrpcStruct, $xmlrpcBase64, $xmlrpcInt, $xmlrpcInt),
+                             array($xmlrpcStruct, $xmlrpcBase64)),
+        'docstring' => 'parameter should be array(base64,[int,int])',
+    ),
+    
+    'search_post' => array(
+        'function'  => 'search_func',
+        'signature' => array(array($xmlrpcStruct, $xmlrpcBase64, $xmlrpcInt, $xmlrpcInt, $xmlrpcString),
+                             array($xmlrpcStruct, $xmlrpcBase64, $xmlrpcInt, $xmlrpcInt),
+                             array($xmlrpcStruct, $xmlrpcBase64)),
+        'docstring' => 'parameter should be array(base64,[int,int])',
+    ),
+
+    'report_post' => array(
+        'function'  => 'report_post_func',
+        'signature' => array(array($xmlrpcStruct, $xmlrpcString, $xmlrpcBase64),
+                             array($xmlrpcStruct, $xmlrpcString)),
+        'docstring' => 'parameter should be)',
+    ),
+
+    'report_pm' => array(
+        'function'  => 'report_pm_func',
+        'signature' => array(array($xmlrpcStruct, $xmlrpcString, $xmlrpcBase64),
+                             array($xmlrpcStruct, $xmlrpcString)),
+        'docstring' => 'parameter should be)',
+    ),
+    
+    'get_participated_forum' => array(
+        'function'  => 'get_participated_forum_func',
+        'signature' => array(array($xmlrpcArray)),
+    ),
+
+    'login_forum' => array(
+        'function'  => 'login_forum_func',
+        'signature' => array(array($xmlrpcStruct, $xmlrpcString, $xmlrpcBase64)),
+        'docstring' => 'parameter should be)',
+    ),
+    
+    'upload_attach' => array(
+        'function'  => 'upload_attach_func',
+        'signature' => array(array($xmlrpcStruct)),
+        'docstring' => 'parameter should be',
+    ),
+    
+    'upload_avatar' => array(
+        'function'  => 'upload_avatar_func',
+        'signature' => array(array($xmlrpcStruct)),
+        'docstring' => 'parameter should be',
+    ),
+    
+    'remove_attachment' => array(
+        'function'  => 'remove_attachment_func',
+        'signature' => array(array($xmlrpcStruct, $xmlrpcString, $xmlrpcString, $xmlrpcString),
+                             array($xmlrpcStruct, $xmlrpcString, $xmlrpcString, $xmlrpcString, $xmlrpcString)),
+        'docstring' => 'parameter should be',
+    ),
+    
+    'get_id_by_url' => array(
+        'function'  => 'get_id_by_url_func',
+        'signature' => array(array($xmlrpcStruct, $xmlrpcString)),
+        'docstring' => 'get_id_by_url need one parameters as url.',
+    ),
+    
+    'thank_post' => array(
+        'function' => 'xmlresptrue',
+        'signature' => array(array($xmlrpcStruct, $xmlrpcString)),
+    ),
+    
+    
+    // Moderation functions
+    'm_stick_topic' => array(
+        'function'  => 'xmlresptrue',
+        'signature' => array(array($xmlrpcArray, $xmlrpcString, $xmlrpcInt)),
+        'docstring' => '',
+    ),
+    'm_close_topic' => array(
+        'function'  => 'xmlresptrue',
+        'signature' => array(array($xmlrpcArray, $xmlrpcString, $xmlrpcInt)),
+        'docstring' => '',
+    ),
+    'm_delete_topic' => array(
+        'function'  => 'xmlresptrue',
+        'signature' => array(array($xmlrpcArray, $xmlrpcString, $xmlrpcInt, $xmlrpcBase64)),
+        'docstring' => '',
+    ),
+    'm_delete_post' => array(
+        'function'  => 'xmlresptrue',
+        'signature' => array(array($xmlrpcArray, $xmlrpcString, $xmlrpcInt, $xmlrpcBase64)),
+        'docstring' => '',
+    ),
+    'm_move_topic' => array(
+        'function'  => 'xmlresptrue',
+        'signature' => array(array($xmlrpcArray, $xmlrpcString, $xmlrpcString)),
+        'docstring' => '',
+    ),
+    'm_move_post' => array(
+        'function'  => 'xmlresptrue',
+        'signature' => array(array($xmlrpcArray, $xmlrpcString, $xmlrpcString),
+                             array($xmlrpcArray, $xmlrpcString, $xmlrpcString, $xmlrpcBase64, $xmlrpcString)),
+        'docstring' => '',
+    ),
+    'm_merge_topic' => array(
+        'function'  => 'xmlresptrue',
+        'signature' => array(array($xmlrpcArray, $xmlrpcString, $xmlrpcString)),
+        'docstring' => '',
+    ),
+    'm_get_moderate_topic' => array(
+        'function'  => 'm_get_moderate_topic_func',
+        'signature' => array(array($xmlrpcArray),
+                             array($xmlrpcArray, $xmlrpcInt),
+                             array($xmlrpcArray, $xmlrpcInt, $xmlrpcInt),
+                             array($xmlrpcArray, $xmlrpcInt, $xmlrpcInt, $xmlrpcInt)),
+        'docstring' => '',
+    ),
+    'm_get_moderate_post' => array(
+        'function'  => 'm_get_moderate_post_func',
+        'signature' => array(array($xmlrpcArray),
+                             array($xmlrpcArray, $xmlrpcInt),
+                             array($xmlrpcArray, $xmlrpcInt, $xmlrpcInt),
+                             array($xmlrpcArray, $xmlrpcInt, $xmlrpcInt, $xmlrpcInt)),
+        'docstring' => '',
+    ),
+    'm_get_report_post' => array(
+        'function'  => 'm_get_report_post_func',
+        'signature' => array(array($xmlrpcArray),
+                             array($xmlrpcArray, $xmlrpcInt, $xmlrpcInt)),
+        'docstring' => '',
+    ),
+    'm_get_report_pm' => array(
+        'function'  => 'm_get_report_pm_func',
+        'signature' => array(array($xmlrpcArray),
+                             array($xmlrpcArray, $xmlrpcInt, $xmlrpcInt)),
+        'docstring' => '',
+    ),
+    'm_approve_topic' => array(
+        'function'  => 'xmlresptrue',
+        'signature' => array(array($xmlrpcArray, $xmlrpcString, $xmlrpcInt)),
+        'docstring' => '',
+    ),
+    'm_approve_post' => array(
+        'function'  => 'xmlresptrue',
+        'signature' => array(array($xmlrpcArray, $xmlrpcString, $xmlrpcInt)),
+        'docstring' => '',
+    ),
+    'm_ban_user' => array(
+        'function'  => 'xmlresptrue',
+        'signature' => array(array($xmlrpcArray, $xmlrpcBase64, $xmlrpcInt, $xmlrpcBase64)),
+        'docstring' => '',
+    ),
+);
diff -ruN phpBB-3.0.10/mobiquo/tapatalkdetect/jquery-1.7.min.js phpbb/mobiquo/tapatalkdetect/jquery-1.7.min.js
--- phpBB-3.0.10/mobiquo/tapatalkdetect/jquery-1.7.min.js	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/tapatalkdetect/jquery-1.7.min.js	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,4 @@
+/*! jQuery v1.7 jquery.com | jquery.org/license */
+(function(a,b){function cA(a){return f.isWindow(a)?a:a.nodeType===9?a.defaultView||a.parentWindow:!1}function cx(a){if(!cm[a]){var b=c.body,d=f("<"+a+">").appendTo(b),e=d.css("display");d.remove();if(e==="none"||e===""){cn||(cn=c.createElement("iframe"),cn.frameBorder=cn.width=cn.height=0),b.appendChild(cn);if(!co||!cn.createElement)co=(cn.contentWindow||cn.contentDocument).document,co.write((c.compatMode==="CSS1Compat"?"<!doctype html>":"")+"<html><body>"),co.close();d=co.createElement(a),co.body.appendChild(d),e=f.css(d,"display"),b.removeChild(cn)}cm[a]=e}return cm[a]}function cw(a,b){var c={};f.each(cs.concat.apply([],cs.slice(0,b)),function(){c[this]=a});return c}function cv(){ct=b}function cu(){setTimeout(cv,0);return ct=f.now()}function cl(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}function ck(){try{return new a.XMLHttpRequest}catch(b){}}function ce(a,c){a.dataFilter&&(c=a.dataFilter(c,a.dataType));var d=a.dataTypes,e={},g,h,i=d.length,j,k=d[0],l,m,n,o,p;for(g=1;g<i;g++){if(g===1)for(h in a.converters)typeof h=="string"&&(e[h.toLowerCase()]=a.converters[h]);l=k,k=d[g];if(k==="*")k=l;else if(l!=="*"&&l!==k){m=l+" "+k,n=e[m]||e["* "+k];if(!n){p=b;for(o in e){j=o.split(" ");if(j[0]===l||j[0]==="*"){p=e[j[1]+" "+k];if(p){o=e[o],o===!0?n=p:p===!0&&(n=o);break}}}}!n&&!p&&f.error("No conversion from "+m.replace(" "," to ")),n!==!0&&(c=n?n(c):p(o(c)))}}return c}function cd(a,c,d){var e=a.contents,f=a.dataTypes,g=a.responseFields,h,i,j,k;for(i in g)i in d&&(c[g[i]]=d[i]);while(f[0]==="*")f.shift(),h===b&&(h=a.mimeType||c.getResponseHeader("content-type"));if(h)for(i in e)if(e[i]&&e[i].test(h)){f.unshift(i);break}if(f[0]in d)j=f[0];else{for(i in d){if(!f[0]||a.converters[i+" "+f[0]]){j=i;break}k||(k=i)}j=j||k}if(j){j!==f[0]&&f.unshift(j);return d[j]}}function cc(a,b,c,d){if(f.isArray(b))f.each(b,function(b,e){c||bG.test(a)?d(a,e):cc(a+"["+(typeof e=="object"||f.isArray(e)?b:"")+"]",e,c,d)});else if(!c&&b!=null&&typeof b=="object")for(var e in b)cc(a+"["+e+"]",b[e],c,d);else d(a,b)}function cb(a,c){var d,e,g=f.ajaxSettings.flatOptions||{};for(d in c)c[d]!==b&&((g[d]?a:e||(e={}))[d]=c[d]);e&&f.extend(!0,a,e)}function ca(a,c,d,e,f,g){f=f||c.dataTypes[0],g=g||{},g[f]=!0;var h=a[f],i=0,j=h?h.length:0,k=a===bV,l;for(;i<j&&(k||!l);i++)l=h[i](c,d,e),typeof l=="string"&&(!k||g[l]?l=b:(c.dataTypes.unshift(l),l=ca(a,c,d,e,l,g)));(k||!l)&&!g["*"]&&(l=ca(a,c,d,e,"*",g));return l}function b_(a){return function(b,c){typeof b!="string"&&(c=b,b="*");if(f.isFunction(c)){var d=b.toLowerCase().split(bR),e=0,g=d.length,h,i,j;for(;e<g;e++)h=d[e],j=/^\+/.test(h),j&&(h=h.substr(1)||"*"),i=a[h]=a[h]||[],i[j?"unshift":"push"](c)}}}function bE(a,b,c){var d=b==="width"?a.offsetWidth:a.offsetHeight,e=b==="width"?bz:bA;if(d>0){c!=="border"&&f.each(e,function(){c||(d-=parseFloat(f.css(a,"padding"+this))||0),c==="margin"?d+=parseFloat(f.css(a,c+this))||0:d-=parseFloat(f.css(a,"border"+this+"Width"))||0});return d+"px"}d=bB(a,b,b);if(d<0||d==null)d=a.style[b]||0;d=parseFloat(d)||0,c&&f.each(e,function(){d+=parseFloat(f.css(a,"padding"+this))||0,c!=="padding"&&(d+=parseFloat(f.css(a,"border"+this+"Width"))||0),c==="margin"&&(d+=parseFloat(f.css(a,c+this))||0)});return d+"px"}function br(a,b){b.src?f.ajax({url:b.src,async:!1,dataType:"script"}):f.globalEval((b.text||b.textContent||b.innerHTML||"").replace(bi,"/*$0*/")),b.parentNode&&b.parentNode.removeChild(b)}function bq(a){var b=(a.nodeName||"").toLowerCase();b==="input"?bp(a):b!=="script"&&typeof a.getElementsByTagName!="undefined"&&f.grep(a.getElementsByTagName("input"),bp)}function bp(a){if(a.type==="checkbox"||a.type==="radio")a.defaultChecked=a.checked}function bo(a){return typeof a.getElementsByTagName!="undefined"?a.getElementsByTagName("*"):typeof a.querySelectorAll!="undefined"?a.querySelectorAll("*"):[]}function bn(a,b){var c;if(b.nodeType===1){b.clearAttributes&&b.clearAttributes(),b.mergeAttributes&&b.mergeAttributes(a),c=b.nodeName.toLowerCase();if(c==="object")b.outerHTML=a.outerHTML;else if(c!=="input"||a.type!=="checkbox"&&a.type!=="radio"){if(c==="option")b.selected=a.defaultSelected;else if(c==="input"||c==="textarea")b.defaultValue=a.defaultValue}else a.checked&&(b.defaultChecked=b.checked=a.checked),b.value!==a.value&&(b.value=a.value);b.removeAttribute(f.expando)}}function bm(a,b){if(b.nodeType===1&&!!f.hasData(a)){var c,d,e,g=f._data(a),h=f._data(b,g),i=g.events;if(i){delete h.handle,h.events={};for(c in i)for(d=0,e=i[c].length;d<e;d++)f.event.add(b,c+(i[c][d].namespace?".":"")+i[c][d].namespace,i[c][d],i[c][d].data)}h.data&&(h.data=f.extend({},h.data))}}function bl(a,b){return f.nodeName(a,"table")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function X(a){var b=Y.split(" "),c=a.createDocumentFragment();if(c.createElement)while(b.length)c.createElement(b.pop());return c}function W(a,b,c){b=b||0;if(f.isFunction(b))return f.grep(a,function(a,d){var e=!!b.call(a,d,a);return e===c});if(b.nodeType)return f.grep(a,function(a,d){return a===b===c});if(typeof b=="string"){var d=f.grep(a,function(a){return a.nodeType===1});if(R.test(b))return f.filter(b,d,!c);b=f.filter(b,d)}return f.grep(a,function(a,d){return f.inArray(a,b)>=0===c})}function V(a){return!a||!a.parentNode||a.parentNode.nodeType===11}function N(){return!0}function M(){return!1}function n(a,b,c){var d=b+"defer",e=b+"queue",g=b+"mark",h=f._data(a,d);h&&(c==="queue"||!f._data(a,e))&&(c==="mark"||!f._data(a,g))&&setTimeout(function(){!f._data(a,e)&&!f._data(a,g)&&(f.removeData(a,d,!0),h.fire())},0)}function m(a){for(var b in a){if(b==="data"&&f.isEmptyObject(a[b]))continue;if(b!=="toJSON")return!1}return!0}function l(a,c,d){if(d===b&&a.nodeType===1){var e="data-"+c.replace(k,"-$1").toLowerCase();d=a.getAttribute(e);if(typeof d=="string"){try{d=d==="true"?!0:d==="false"?!1:d==="null"?null:f.isNumeric(d)?parseFloat(d):j.test(d)?f.parseJSON(d):d}catch(g){}f.data(a,c,d)}else d=b}return d}function h(a){var b=g[a]={},c,d;a=a.split(/\s+/);for(c=0,d=a.length;c<d;c++)b[a[c]]=!0;return b}var c=a.document,d=a.navigator,e=a.location,f=function(){function K(){if(!e.isReady){try{c.documentElement.doScroll("left")}catch(a){setTimeout(K,1);return}e.ready()}}var e=function(a,b){return new e.fn.init(a,b,h)},f=a.jQuery,g=a.$,h,i=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,j=/\S/,k=/^\s+/,l=/\s+$/,m=/\d/,n=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,o=/^[\],:{}\s]*$/,p=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,q=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,r=/(?:^|:|,)(?:\s*\[)+/g,s=/(webkit)[ \/]([\w.]+)/,t=/(opera)(?:.*version)?[ \/]([\w.]+)/,u=/(msie) ([\w.]+)/,v=/(mozilla)(?:.*? rv:([\w.]+))?/,w=/-([a-z]|[0-9])/ig,x=/^-ms-/,y=function(a,b){return(b+"").toUpperCase()},z=d.userAgent,A,B,C,D=Object.prototype.toString,E=Object.prototype.hasOwnProperty,F=Array.prototype.push,G=Array.prototype.slice,H=String.prototype.trim,I=Array.prototype.indexOf,J={};e.fn=e.prototype={constructor:e,init:function(a,d,f){var g,h,j,k;if(!a)return this;if(a.nodeType){this.context=this[0]=a,this.length=1;return this}if(a==="body"&&!d&&c.body){this.context=c,this[0]=c.body,this.selector=a,this.length=1;return this}if(typeof a=="string"){a.charAt(0)!=="<"||a.charAt(a.length-1)!==">"||a.length<3?g=i.exec(a):g=[null,a,null];if(g&&(g[1]||!d)){if(g[1]){d=d instanceof e?d[0]:d,k=d?d.ownerDocument||d:c,j=n.exec(a),j?e.isPlainObject(d)?(a=[c.createElement(j[1])],e.fn.attr.call(a,d,!0)):a=[k.createElement(j[1])]:(j=e.buildFragment([g[1]],[k]),a=(j.cacheable?e.clone(j.fragment):j.fragment).childNodes);return e.merge(this,a)}h=c.getElementById(g[2]);if(h&&h.parentNode){if(h.id!==g[2])return f.find(a);this.length=1,this[0]=h}this.context=c,this.selector=a;return this}return!d||d.jquery?(d||f).find(a):this.constructor(d).find(a)}if(e.isFunction(a))return f.ready(a);a.selector!==b&&(this.selector=a.selector,this.context=a.context);return e.makeArray(a,this)},selector:"",jquery:"1.7",length:0,size:function(){return this.length},toArray:function(){return G.call(this,0)},get:function(a){return a==null?this.toArray():a<0?this[this.length+a]:this[a]},pushStack:function(a,b,c){var d=this.constructor();e.isArray(a)?F.apply(d,a):e.merge(d,a),d.prevObject=this,d.context=this.context,b==="find"?d.selector=this.selector+(this.selector?" ":"")+c:b&&(d.selector=this.selector+"."+b+"("+c+")");return d},each:function(a,b){return e.each(this,a,b)},ready:function(a){e.bindReady(),B.add(a);return this},eq:function(a){return a===-1?this.slice(a):this.slice(a,+a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(G.apply(this,arguments),"slice",G.call(arguments).join(","))},map:function(a){return this.pushStack(e.map(this,function(b,c){return a.call(b,c,b)}))},end:function(){return this.prevObject||this.constructor(null)},push:F,sort:[].sort,splice:[].splice},e.fn.init.prototype=e.fn,e.extend=e.fn.extend=function(){var a,c,d,f,g,h,i=arguments[0]||{},j=1,k=arguments.length,l=!1;typeof i=="boolean"&&(l=i,i=arguments[1]||{},j=2),typeof i!="object"&&!e.isFunction(i)&&(i={}),k===j&&(i=this,--j);for(;j<k;j++)if((a=arguments[j])!=null)for(c in a){d=i[c],f=a[c];if(i===f)continue;l&&f&&(e.isPlainObject(f)||(g=e.isArray(f)))?(g?(g=!1,h=d&&e.isArray(d)?d:[]):h=d&&e.isPlainObject(d)?d:{},i[c]=e.extend(l,h,f)):f!==b&&(i[c]=f)}return i},e.extend({noConflict:function(b){a.$===e&&(a.$=g),b&&a.jQuery===e&&(a.jQuery=f);return e},isReady:!1,readyWait:1,holdReady:function(a){a?e.readyWait++:e.ready(!0)},ready:function(a){if(a===!0&&!--e.readyWait||a!==!0&&!e.isReady){if(!c.body)return setTimeout(e.ready,1);e.isReady=!0;if(a!==!0&&--e.readyWait>0)return;B.fireWith(c,[e]),e.fn.trigger&&e(c).trigger("ready").unbind("ready")}},bindReady:function(){if(!B){B=e.Callbacks("once memory");if(c.readyState==="complete")return setTimeout(e.ready,1);if(c.addEventListener)c.addEventListener("DOMContentLoaded",C,!1),a.addEventListener("load",e.ready,!1);else if(c.attachEvent){c.attachEvent("onreadystatechange",C),a.attachEvent("onload",e.ready);var b=!1;try{b=a.frameElement==null}catch(d){}c.documentElement.doScroll&&b&&K()}}},isFunction:function(a){return e.type(a)==="function"},isArray:Array.isArray||function(a){return e.type(a)==="array"},isWindow:function(a){return a&&typeof a=="object"&&"setInterval"in a},isNumeric:function(a){return a!=null&&m.test(a)&&!isNaN(a)},type:function(a){return a==null?String(a):J[D.call(a)]||"object"},isPlainObject:function(a){if(!a||e.type(a)!=="object"||a.nodeType||e.isWindow(a))return!1;try{if(a.constructor&&!E.call(a,"constructor")&&!E.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}var d;for(d in a);return d===b||E.call(a,d)},isEmptyObject:function(a){for(var b in a)return!1;return!0},error:function(a){throw a},parseJSON:function(b){if(typeof b!="string"||!b)return null;b=e.trim(b);if(a.JSON&&a.JSON.parse)return a.JSON.parse(b);if(o.test(b.replace(p,"@").replace(q,"]").replace(r,"")))return(new Function("return "+b))();e.error("Invalid JSON: "+b)},parseXML:function(c){var d,f;try{a.DOMParser?(f=new DOMParser,d=f.parseFromString(c,"text/xml")):(d=new ActiveXObject("Microsoft.XMLDOM"),d.async="false",d.loadXML(c))}catch(g){d=b}(!d||!d.documentElement||d.getElementsByTagName("parsererror").length)&&e.error("Invalid XML: "+c);return d},noop:function(){},globalEval:function(b){b&&j.test(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(x,"ms-").replace(w,y)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toUpperCase()===b.toUpperCase()},each:function(a,c,d){var f,g=0,h=a.length,i=h===b||e.isFunction(a);if(d){if(i){for(f in a)if(c.apply(a[f],d)===!1)break}else for(;g<h;)if(c.apply(a[g++],d)===!1)break}else if(i){for(f in a)if(c.call(a[f],f,a[f])===!1)break}else for(;g<h;)if(c.call(a[g],g,a[g++])===!1)break;return a},trim:H?function(a){return a==null?"":H.call(a)}:function(a){return a==null?"":(a+"").replace(k,"").replace(l,"")},makeArray:function(a,b){var c=b||[];if(a!=null){var d=e.type(a);a.length==null||d==="string"||d==="function"||d==="regexp"||e.isWindow(a)?F.call(c,a):e.merge(c,a)}return c},inArray:function(a,b,c){var d;if(b){if(I)return I.call(b,a,c);d=b.length,c=c?c<0?Math.max(0,d+c):c:0;for(;c<d;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,c){var d=a.length,e=0;if(typeof c.length=="number")for(var f=c.length;e<f;e++)a[d++]=c[e];else while(c[e]!==b)a[d++]=c[e++];a.length=d;return a},grep:function(a,b,c){var d=[],e;c=!!c;for(var f=0,g=a.length;f<g;f++)e=!!b(a[f],f),c!==e&&d.push(a[f]);return d},map:function(a,c,d){var f,g,h=[],i=0,j=a.length,k=a instanceof e||j!==b&&typeof j=="number"&&(j>0&&a[0]&&a[j-1]||j===0||e.isArray(a));if(k)for(;i<j;i++)f=c(a[i],i,d),f!=null&&(h[h.length]=f);else for(g in a)f=c(a[g],g,d),f!=null&&(h[h.length]=f);return h.concat.apply([],h)},guid:1,proxy:function(a,c){if(typeof c=="string"){var d=a[c];c=a,a=d}if(!e.isFunction(a))return b;var f=G.call(arguments,2),g=function(){return a.apply(c,f.concat(G.call(arguments)))};g.guid=a.guid=a.guid||g.guid||e.guid++;return g},access:function(a,c,d,f,g,h){var i=a.length;if(typeof c=="object"){for(var j in c)e.access(a,j,c[j],f,g,d);return a}if(d!==b){f=!h&&f&&e.isFunction(d);for(var k=0;k<i;k++)g(a[k],c,f?d.call(a[k],k,g(a[k],c)):d,h);return a}return i?g(a[0],c):b},now:function(){return(new Date).getTime()},uaMatch:function(a){a=a.toLowerCase();var b=s.exec(a)||t.exec(a)||u.exec(a)||a.indexOf("compatible")<0&&v.exec(a)||[];return{browser:b[1]||"",version:b[2]||"0"}},sub:function(){function a(b,c){return new a.fn.init(b,c)}e.extend(!0,a,this),a.superclass=this,a.fn=a.prototype=this(),a.fn.constructor=a,a.sub=this.sub,a.fn.init=function(d,f){f&&f instanceof e&&!(f instanceof a)&&(f=a(f));return e.fn.init.call(this,d,f,b)},a.fn.init.prototype=a.fn;var b=a(c);return a},browser:{}}),e.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(a,b){J["[object "+b+"]"]=b.toLowerCase()}),A=e.uaMatch(z),A.browser&&(e.browser[A.browser]=!0,e.browser.version=A.version),e.browser.webkit&&(e.browser.safari=!0),j.test("")&&(k=/^[\s\xA0]+/,l=/[\s\xA0]+$/),h=e(c),c.addEventListener?C=function(){c.removeEventListener("DOMContentLoaded",C,!1),e.ready()}:c.attachEvent&&(C=function(){c.readyState==="complete"&&(c.detachEvent("onreadystatechange",C),e.ready())}),typeof define=="function"&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return e});return e}(),g={};f.Callbacks=function(a){a=a?g[a]||h(a):{};var c=[],d=[],e,i,j,k,l,m=function(b){var d,e,g,h,i;for(d=0,e=b.length;d<e;d++)g=b[d],h=f.type(g),h==="array"?m(g):h==="function"&&(!a.unique||!o.has(g))&&c.push(g)},n=function(b,f){f=f||[],e=!a.memory||[b,f],i=!0,l=j||0,j=0,k=c.length;for(;c&&l<k;l++)if(c[l].apply(b,f)===!1&&a.stopOnFalse){e=!0;break}i=!1,c&&(a.once?e===!0?o.disable():c=[]:d&&d.length&&(e=d.shift(),o.fireWith(e[0],e[1])))},o={add:function(){if(c){var a=c.length;m(arguments),i?k=c.length:e&&e!==!0&&(j=a,n(e[0],e[1]))}return this},remove:function(){if(c){var b=arguments,d=0,e=b.length;for(;d<e;d++)for(var f=0;f<c.length;f++)if(b[d]===c[f]){i&&f<=k&&(k--,f<=l&&l--),c.splice(f--,1);if(a.unique)break}}return this},has:function(a){if(c){var b=0,d=c.length;for(;b<d;b++)if(a===c[b])return!0}return!1},empty:function(){c=[];return this},disable:function(){c=d=e=b;return this},disabled:function(){return!c},lock:function(){d=b,(!e||e===!0)&&o.disable();return this},locked:function(){return!d},fireWith:function(b,c){d&&(i?a.once||d.push([b,c]):(!a.once||!e)&&n(b,c));return this},fire:function(){o.fireWith(this,arguments);return this},fired:function(){return!!e}};return o};var i=[].slice;f.extend({Deferred:function(a){var b=f.Callbacks("once memory"),c=f.Callbacks("once memory"),d=f.Callbacks("memory"),e="pending",g={resolve:b,reject:c,notify:d},h={done:b.add,fail:c.add,progress:d.add,state:function(){return e},isResolved:b.fired,isRejected:c.fired,then:function(a,b,c){i.done(a).fail(b).progress(c);return this},always:function(){return i.done.apply(i,arguments).fail.apply(i,arguments)},pipe:function(a,b,c){return f.Deferred(function(d){f.each({done:[a,"resolve"],fail:[b,"reject"],progress:[c,"notify"]},function(a,b){var c=b[0],e=b[1],g;f.isFunction(c)?i[a](function(){g=c.apply(this,arguments),g&&f.isFunction(g.promise)?g.promise().then(d.resolve,d.reject,d.notify):d[e+"With"](this===i?d:this,[g])}):i[a](d[e])})}).promise()},promise:function(a){if(a==null)a=h;else for(var b in h)a[b]=h[b];return a}},i=h.promise({}),j;for(j in g)i[j]=g[j].fire,i[j+"With"]=g[j].fireWith;i.done(function(){e="resolved"},c.disable,d.lock).fail(function(){e="rejected"},b.disable,d.lock),a&&a.call(i,i);return i},when:function(a){function m(a){return function(b){e[a]=arguments.length>1?i.call(arguments,0):b,j.notifyWith(k,e)}}function l(a){return function(c){b[a]=arguments.length>1?i.call(arguments,0):c,--g||j.resolveWith(j,b)}}var b=i.call(arguments,0),c=0,d=b.length,e=Array(d),g=d,h=d,j=d<=1&&a&&f.isFunction(a.promise)?a:f.Deferred(),k=j.promise();if(d>1){for(;c<d;c++)b[c]&&b[c].promise&&f.isFunction(b[c].promise)?b[c].promise().then(l(c),j.reject,m(c)):--g;g||j.resolveWith(j,b)}else j!==a&&j.resolveWith(j,d?[a]:[]);return k}}),f.support=function(){var a=c.createElement("div"),b=c.documentElement,d,e,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u;a.setAttribute("className","t"),a.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/><nav></nav>",d=a.getElementsByTagName("*"),e=a.getElementsByTagName("a")[0];if(!d||!d.length||!e)return{};g=c.createElement("select"),h=g.appendChild(c.createElement("option")),i=a.getElementsByTagName("input")[0],k={leadingWhitespace:a.firstChild.nodeType===3,tbody:!a.getElementsByTagName("tbody").length,htmlSerialize:!!a.getElementsByTagName("link").length,style:/top/.test(e.getAttribute("style")),hrefNormalized:e.getAttribute("href")==="/a",opacity:/^0.55/.test(e.style.opacity),cssFloat:!!e.style.cssFloat,unknownElems:!!a.getElementsByTagName("nav").length,checkOn:i.value==="on",optSelected:h.selected,getSetAttribute:a.className!=="t",enctype:!!c.createElement("form").enctype,submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0},i.checked=!0,k.noCloneChecked=i.cloneNode(!0).checked,g.disabled=!0,k.optDisabled=!h.disabled;try{delete a.test}catch(v){k.deleteExpando=!1}!a.addEventListener&&a.attachEvent&&a.fireEvent&&(a.attachEvent("onclick",function(){k.noCloneEvent=!1}),a.cloneNode(!0).fireEvent("onclick")),i=c.createElement("input"),i.value="t",i.setAttribute("type","radio"),k.radioValue=i.value==="t",i.setAttribute("checked","checked"),a.appendChild(i),l=c.createDocumentFragment(),l.appendChild(a.lastChild),k.checkClone=l.cloneNode(!0).cloneNode(!0).lastChild.checked,a.innerHTML="",a.style.width=a.style.paddingLeft="1px",m=c.getElementsByTagName("body")[0],o=c.createElement(m?"div":"body"),p={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},m&&f.extend(p,{position:"absolute",left:"-999px",top:"-999px"});for(t in p)o.style[t]=p[t];o.appendChild(a),n=m||b,n.insertBefore(o,n.firstChild),k.appendChecked=i.checked,k.boxModel=a.offsetWidth===2,"zoom"in a.style&&(a.style.display="inline",a.style.zoom=1,k.inlineBlockNeedsLayout=a.offsetWidth===2,a.style.display="",a.innerHTML="<div style='width:4px;'></div>",k.shrinkWrapBlocks=a.offsetWidth!==2),a.innerHTML="<table><tr><td style='padding:0;border:0;display:none'></td><td>t</td></tr></table>",q=a.getElementsByTagName("td"),u=q[0].offsetHeight===0,q[0].style.display="",q[1].style.display="none",k.reliableHiddenOffsets=u&&q[0].offsetHeight===0,a.innerHTML="",c.defaultView&&c.defaultView.getComputedStyle&&(j=c.createElement("div"),j.style.width="0",j.style.marginRight="0",a.appendChild(j),k.reliableMarginRight=(parseInt((c.defaultView.getComputedStyle(j,null)||{marginRight:0}).marginRight,10)||0)===0);if(a.attachEvent)for(t in{submit:1,change:1,focusin:1})s="on"+t,u=s in a,u||(a.setAttribute(s,"return;"),u=typeof a[s]=="function"),k[t+"Bubbles"]=u;f(function(){var a,b,d,e,g,h,i=1,j="position:absolute;top:0;left:0;width:1px;height:1px;margin:0;",l="visibility:hidden;border:0;",n="style='"+j+"border:5px solid #000;padding:0;'",p="<div "+n+"><div></div></div>"+"<table "+n+" cellpadding='0' cellspacing='0'>"+"<tr><td></td></tr></table>";m=c.getElementsByTagName("body")[0];!m||(a=c.createElement("div"),a.style.cssText=l+"width:0;height:0;position:static;top:0;margin-top:"+i+"px",m.insertBefore(a,m.firstChild),o=c.createElement("div"),o.style.cssText=j+l,o.innerHTML=p,a.appendChild(o),b=o.firstChild,d=b.firstChild,g=b.nextSibling.firstChild.firstChild,h={doesNotAddBorder:d.offsetTop!==5,doesAddBorderForTableAndCells:g.offsetTop===5},d.style.position="fixed",d.style.top="20px",h.fixedPosition=d.offsetTop===20||d.offsetTop===15,d.style.position=d.style.top="",b.style.overflow="hidden",b.style.position="relative",h.subtractsBorderForOverflowNotVisible=d.offsetTop===-5,h.doesNotIncludeMarginInBodyOffset=m.offsetTop!==i,m.removeChild(a),o=a=null,f.extend(k,h))}),o.innerHTML="",n.removeChild(o),o=l=g=h=m=j=a=i=null;return k}(),f.boxModel=f.support.boxModel;var j=/^(?:\{.*\}|\[.*\])$/,k=/([A-Z])/g;f.extend({cache:{},uuid:0,expando:"jQuery"+(f.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(a){a=a.nodeType?f.cache[a[f.expando]]:a[f.expando];return!!a&&!m(a)},data:function(a,c,d,e){if(!!f.acceptData(a)){var g,h,i,j=f.expando,k=typeof c=="string",l=a.nodeType,m=l?f.cache:a,n=l?a[f.expando]:a[f.expando]&&f.expando,o=c==="events";if((!n||!m[n]||!o&&!e&&!m[n].data)&&k&&d===b)return;n||(l?a[f.expando]=n=++f.uuid:n=f.expando),m[n]||(m[n]={},l||(m[n].toJSON=f.noop));if(typeof c=="object"||typeof c=="function")e?m[n]=f.extend(m[n],c):m[n].data=f.extend(m[n].data,c);g=h=m[n],e||(h.data||(h.data={}),h=h.data),d!==b&&(h[f.camelCase(c)]=d);if(o&&!h[c])return g.events;k?(i=h[c],i==null&&(i=h[f.camelCase(c)])):i=h;return i}},removeData:function(a,b,c){if(!!f.acceptData(a)){var d,e,g,h=f.expando,i=a.nodeType,j=i?f.cache:a,k=i?a[f.expando]:f.expando;if(!j[k])return;if(b){d=c?j[k]:j[k].data;if(d){f.isArray(b)?b=b:b in d?b=[b]:(b=f.camelCase(b),b in d?b=[b]:b=b.split(" "));for(e=0,g=b.length;e<g;e++)delete d[b[e]];if(!(c?m:f.isEmptyObject)(d))return}}if(!c){delete j[k].data;if(!m(j[k]))return}f.support.deleteExpando||!j.setInterval?delete j[k]:j[k]=null,i&&(f.support.deleteExpando?delete a[f.expando]:a.removeAttribute?a.removeAttribute(f.expando):a[f.expando]=null)}},_data:function(a,b,c){return f.data(a,b,c,!0)},acceptData:function(a){if(a.nodeName){var b=f.noData[a.nodeName.toLowerCase()];if(b)return b!==!0&&a.getAttribute("classid")===b}return!0}}),f.fn.extend({data:function(a,c){var d,e,g,h=null;if(typeof a=="undefined"){if(this.length){h=f.data(this[0]);if(this[0].nodeType===1&&!f._data(this[0],"parsedAttrs")){e=this[0].attributes;for(var i=0,j=e.length;i<j;i++)g=e[i].name,g.indexOf("data-")===0&&(g=f.camelCase(g.substring(5)),l(this[0],g,h[g]));f._data(this[0],"parsedAttrs",!0)}}return h}if(typeof a=="object")return this.each(function(){f.data(this,a)});d=a.split("."),d[1]=d[1]?"."+d[1]:"";if(c===b){h=this.triggerHandler("getData"+d[1]+"!",[d[0]]),h===b&&this.length&&(h=f.data(this[0],a),h=l(this[0],a,h));return h===b&&d[1]?this.data(d[0]):h}return this.each(function(){var b=f(this),e=[d[0],c];b.triggerHandler("setData"+d[1]+"!",e),f.data(this,a,c),b.triggerHandler("changeData"+d[1]+"!",e)})},removeData:function(a){return this.each(function(){f.removeData(this,a)})}}),f.extend({_mark:function(a,b){a&&(b=(b||"fx")+"mark",f._data(a,b,(f._data(a,b)||0)+1))},_unmark:function(a,b,c){a!==!0&&(c=b,b=a,a=!1);if(b){c=c||"fx";var d=c+"mark",e=a?0:(f._data(b,d)||1)-1;e?f._data(b,d,e):(f.removeData(b,d,!0),n(b,c,"mark"))}},queue:function(a,b,c){var d;if(a){b=(b||"fx")+"queue",d=f._data(a,b),c&&(!d||f.isArray(c)?d=f._data(a,b,f.makeArray(c)):d.push(c));return d||[]}},dequeue:function(a,b){b=b||"fx";var c=f.queue(a,b),d=c.shift(),e={};d==="inprogress"&&(d=c.shift()),d&&(b==="fx"&&c.unshift("inprogress"),f._data(a,b+".run",e),d.call(a,function(){f.dequeue(a,b)},e)),c.length||(f.removeData(a,b+"queue "+b+".run",!0),n(a,b,"queue"))}}),f.fn.extend({queue:function(a,c){typeof a!="string"&&(c=a,a="fx");if(c===b)return f.queue(this[0],a);return this.each(function(){var b=f.queue(this,a,c);a==="fx"&&b[0]!=="inprogress"&&f.dequeue(this,a)})},dequeue:function(a){return this.each(function(){f.dequeue(this,a)})},delay:function(a,b){a=f.fx?f.fx.speeds[a]||a:a,b=b||"fx";return this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,c){function m(){--h||d.resolveWith(e,[e])}typeof a!="string"&&(c=a,a=b),a=a||"fx";var d=f.Deferred(),e=this,g=e.length,h=1,i=a+"defer",j=a+"queue",k=a+"mark",l;while(g--)if(l=f.data(e[g],i,b,!0)||(f.data(e[g],j,b,!0)||f.data(e[g],k,b,!0))&&f.data(e[g],i,f.Callbacks("once memory"),!0))h++,l.add(m);m();return d.promise()}});var o=/[\n\t\r]/g,p=/\s+/,q=/\r/g,r=/^(?:button|input)$/i,s=/^(?:button|input|object|select|textarea)$/i,t=/^a(?:rea)?$/i,u=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,v=f.support.getSetAttribute,w,x,y;f.fn.extend({attr:function(a,b){return f.access(this,a,b,!0,f.attr)},removeAttr:function(a){return this.each(function(){f.removeAttr(this,a)})},prop:function(a,b){return f.access(this,a,b,!0,f.prop)},removeProp:function(a){a=f.propFix[a]||a;return this.each(function(){try{this[a]=b,delete this[a]}catch(c){}})},addClass:function(a){var b,c,d,e,g,h,i;if(f.isFunction(a))return this.each(function(b){f(this).addClass(a.call(this,b,this.className))});if(a&&typeof a=="string"){b=a.split(p);for(c=0,d=this.length;c<d;c++){e=this[c];if(e.nodeType===1)if(!e.className&&b.length===1)e.className=a;else{g=" "+e.className+" ";for(h=0,i=b.length;h<i;h++)~g.indexOf(" "+b[h]+" ")||(g+=b[h]+" ");e.className=f.trim(g)}}}return this},removeClass:function(a){var c,d,e,g,h,i,j;if(f.isFunction(a))return this.each(function(b){f(this).removeClass(a.call(this,b,this.className))});if(a&&typeof a=="string"||a===b){c=(a||"").split(p);for(d=0,e=this.length;d<e;d++){g=this[d];if(g.nodeType===1&&g.className)if(a){h=(" "+g.className+" ").replace(o," ");for(i=0,j=c.length;i<j;i++)h=h.replace(" "+c[i]+" "," ");g.className=f.trim(h)}else g.className=""}}return this},toggleClass:function(a,b){var c=typeof a,d=typeof b=="boolean";if(f.isFunction(a))return this.each(function(c){f(this).toggleClass(a.call(this,c,this.className,b),b)});return this.each(function(){if(c==="string"){var e,g=0,h=f(this),i=b,j=a.split(p);while(e=j[g++])i=d?i:!h.hasClass(e),h[i?"addClass":"removeClass"](e)}else if(c==="undefined"||c==="boolean")this.className&&f._data(this,"__className__",this.className),this.className=this.className||a===!1?"":f._data(this,"__className__")||""})},hasClass:function(a){var b=" "+a+" ",c=0,d=this.length;for(;c<d;c++)if(this[c].nodeType===1&&(" "+this[c].className+" ").replace(o," ").indexOf(b)>-1)return!0;return!1},val:function(a){var c,d,e,g=this[0];if(!arguments.length){if(g){c=f.valHooks[g.nodeName.toLowerCase()]||f.valHooks[g.type];if(c&&"get"in c&&(d=c.get(g,"value"))!==b)return d;d=g.value;return typeof d=="string"?d.replace(q,""):d==null?"":d}return b}e=f.isFunction(a);return this.each(function(d){var g=f(this),h;if(this.nodeType===1){e?h=a.call(this,d,g.val()):h=a,h==null?h="":typeof h=="number"?h+="":f.isArray(h)&&(h=f.map(h,function(a){return a==null?"":a+""})),c=f.valHooks[this.nodeName.toLowerCase()]||f.valHooks[this.type];if(!c||!("set"in c)||c.set(this,h,"value")===b)this.value=h}})}}),f.extend({valHooks:{option:{get:function(a){var b=a.attributes.value;return!b||b.specified?a.value:a.text}},select:{get:function(a){var b,c,d,e,g=a.selectedIndex,h=[],i=a.options,j=a.type==="select-one";if(g<0)return null;c=j?g:0,d=j?g+1:i.length;for(;c<d;c++){e=i[c];if(e.selected&&(f.support.optDisabled?!e.disabled:e.getAttribute("disabled")===null)&&(!e.parentNode.disabled||!f.nodeName(e.parentNode,"optgroup"))){b=f(e).val();if(j)return b;h.push(b)}}if(j&&!h.length&&i.length)return f(i[g]).val();return h},set:function(a,b){var c=f.makeArray(b);f(a).find("option").each(function(){this.selected=f.inArray(f(this).val(),c)>=0}),c.length||(a.selectedIndex=-1);return c}}},attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0},attr:function(a,c,d,e){var g,h,i,j=a.nodeType;if(!a||j===3||j===8||j===2)return b;if(e&&c in f.attrFn)return f(a)[c](d);if(!("getAttribute"in a))return f.prop(a,c,d);i=j!==1||!f.isXMLDoc(a),i&&(c=c.toLowerCase(),h=f.attrHooks[c]||(u.test(c)?x:w));if(d!==b){if(d===null){f.removeAttr(a,c);return b}if(h&&"set"in h&&i&&(g=h.set(a,d,c))!==b)return g;a.setAttribute(c,""+d);return d}if(h&&"get"in h&&i&&(g=h.get(a,c))!==null)return g;g=a.getAttribute(c);return g===null?b:g},removeAttr:function(a,b){var c,d,e,g,h=0;if(a.nodeType===1){d=(b||"").split(p),g=d.length;for(;h<g;h++)e=d[h].toLowerCase(),c=f.propFix[e]||e,f.attr(a,e,""),a.removeAttribute(v?e:c),u.test(e)&&c in a&&(a[c]=!1)}},attrHooks:{type:{set:function(a,b){if(r.test(a.nodeName)&&a.parentNode)f.error("type property can't be changed");else if(!f.support.radioValue&&b==="radio"&&f.nodeName(a,"input")){var c=a.value;a.setAttribute("type",b),c&&(a.value=c);return b}}},value:{get:function(a,b){if(w&&f.nodeName(a,"button"))return w.get(a,b);return b in a?a.value:null},set:function(a,b,c){if(w&&f.nodeName(a,"button"))return w.set(a,b,c);a.value=b}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(a,c,d){var e,g,h,i=a.nodeType;if(!a||i===3||i===8||i===2)return b;h=i!==1||!f.isXMLDoc(a),h&&(c=f.propFix[c]||c,g=f.propHooks[c]);return d!==b?g&&"set"in g&&(e=g.set(a,d,c))!==b?e:a[c]=d:g&&"get"in g&&(e=g.get(a,c))!==null?e:a[c]},propHooks:{tabIndex:{get:function(a){var c=a.getAttributeNode("tabindex");return c&&c.specified?parseInt(c.value,10):s.test(a.nodeName)||t.test(a.nodeName)&&a.href?0:b}}}}),f.attrHooks.tabindex=f.propHooks.tabIndex,x={get:function(a,c){var d,e=f.prop(a,c);return e===!0||typeof e!="boolean"&&(d=a.getAttributeNode(c))&&d.nodeValue!==!1?c.toLowerCase():b},set:function(a,b,c){var d;b===!1?f.removeAttr(a,c):(d=f.propFix[c]||c,d in a&&(a[d]=!0),a.setAttribute(c,c.toLowerCase()));return c}},v||(y={name:!0,id:!0},w=f.valHooks.button={get:function(a,c){var d;d=a.getAttributeNode(c);return d&&(y[c]?d.nodeValue!=="":d.specified)?d.nodeValue:b},set:function(a,b,d){var e=a.getAttributeNode(d);e||(e=c.createAttribute(d),a.setAttributeNode(e));return e.nodeValue=b+""}},f.attrHooks.tabindex.set=w.set,f.each(["width","height"],function(a,b){f.attrHooks[b]=f.extend(f.attrHooks[b],{set:function(a,c){if(c===""){a.setAttribute(b,"auto");return c}}})}),f.attrHooks.contenteditable={get:w.get,set:function(a,b,c){b===""&&(b="false"),w.set(a,b,c)}}),f.support.hrefNormalized||f.each(["href","src","width","height"],function(a,c){f.attrHooks[c]=f.extend(f.attrHooks[c],{get:function(a){var d=a.getAttribute(c,2);return d===null?b:d}})}),f.support.style||(f.attrHooks.style={get:function(a){return a.style.cssText.toLowerCase()||b},set:function(a,b){return a.style.cssText=""+b}}),f.support.optSelected||(f.propHooks.selected=f.extend(f.propHooks.selected,{get:function(a){var b=a.parentNode;b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex);return null}})),f.support.enctype||(f.propFix.enctype="encoding"),f.support.checkOn||f.each(["radio","checkbox"],function(){f.valHooks[this]={get:function(a){return a.getAttribute("value")===null?"on":a.value}}}),f.each(["radio","checkbox"],function(){f.valHooks[this]=f.extend(f.valHooks[this],{set:function(a,b){if(f.isArray(b))return a.checked=f.inArray(f(a).val(),b)>=0}})});var z=/\.(.*)$/,A=/^(?:textarea|input|select)$/i,B=/\./g,C=/ /g,D=/[^\w\s.|`]/g,E=/^([^\.]*)?(?:\.(.+))?$/,F=/\bhover(\.\S+)?/,G=/^key/,H=/^(?:mouse|contextmenu)|click/,I=/^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/,J=function(a){var b=I.exec(a);b&&
+(b[1]=(b[1]||"").toLowerCase(),b[3]=b[3]&&new RegExp("(?:^|\\s)"+b[3]+"(?:\\s|$)"));return b},K=function(a,b){return(!b[1]||a.nodeName.toLowerCase()===b[1])&&(!b[2]||a.id===b[2])&&(!b[3]||b[3].test(a.className))},L=function(a){return f.event.special.hover?a:a.replace(F,"mouseenter$1 mouseleave$1")};f.event={add:function(a,c,d,e,g){var h,i,j,k,l,m,n,o,p,q,r,s;if(!(a.nodeType===3||a.nodeType===8||!c||!d||!(h=f._data(a)))){d.handler&&(p=d,d=p.handler),d.guid||(d.guid=f.guid++),j=h.events,j||(h.events=j={}),i=h.handle,i||(h.handle=i=function(a){return typeof f!="undefined"&&(!a||f.event.triggered!==a.type)?f.event.dispatch.apply(i.elem,arguments):b},i.elem=a),c=L(c).split(" ");for(k=0;k<c.length;k++){l=E.exec(c[k])||[],m=l[1],n=(l[2]||"").split(".").sort(),s=f.event.special[m]||{},m=(g?s.delegateType:s.bindType)||m,s=f.event.special[m]||{},o=f.extend({type:m,origType:l[1],data:e,handler:d,guid:d.guid,selector:g,namespace:n.join(".")},p),g&&(o.quick=J(g),!o.quick&&f.expr.match.POS.test(g)&&(o.isPositional=!0)),r=j[m];if(!r){r=j[m]=[],r.delegateCount=0;if(!s.setup||s.setup.call(a,e,n,i)===!1)a.addEventListener?a.addEventListener(m,i,!1):a.attachEvent&&a.attachEvent("on"+m,i)}s.add&&(s.add.call(a,o),o.handler.guid||(o.handler.guid=d.guid)),g?r.splice(r.delegateCount++,0,o):r.push(o),f.event.global[m]=!0}a=null}},global:{},remove:function(a,b,c,d){var e=f.hasData(a)&&f._data(a),g,h,i,j,k,l,m,n,o,p,q;if(!!e&&!!(m=e.events)){b=L(b||"").split(" ");for(g=0;g<b.length;g++){h=E.exec(b[g])||[],i=h[1],j=h[2];if(!i){j=j?"."+j:"";for(l in m)f.event.remove(a,l+j,c,d);return}n=f.event.special[i]||{},i=(d?n.delegateType:n.bindType)||i,p=m[i]||[],k=p.length,j=j?new RegExp("(^|\\.)"+j.split(".").sort().join("\\.(?:.*\\.)?")+"(\\.|$)"):null;if(c||j||d||n.remove)for(l=0;l<p.length;l++){q=p[l];if(!c||c.guid===q.guid)if(!j||j.test(q.namespace))if(!d||d===q.selector||d==="**"&&q.selector)p.splice(l--,1),q.selector&&p.delegateCount--,n.remove&&n.remove.call(a,q)}else p.length=0;p.length===0&&k!==p.length&&((!n.teardown||n.teardown.call(a,j)===!1)&&f.removeEvent(a,i,e.handle),delete m[i])}f.isEmptyObject(m)&&(o=e.handle,o&&(o.elem=null),f.removeData(a,["events","handle"],!0))}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(c,d,e,g){if(!e||e.nodeType!==3&&e.nodeType!==8){var h=c.type||c,i=[],j,k,l,m,n,o,p,q,r,s;h.indexOf("!")>=0&&(h=h.slice(0,-1),k=!0),h.indexOf(".")>=0&&(i=h.split("."),h=i.shift(),i.sort());if((!e||f.event.customEvent[h])&&!f.event.global[h])return;c=typeof c=="object"?c[f.expando]?c:new f.Event(h,c):new f.Event(h),c.type=h,c.isTrigger=!0,c.exclusive=k,c.namespace=i.join("."),c.namespace_re=c.namespace?new RegExp("(^|\\.)"+i.join("\\.(?:.*\\.)?")+"(\\.|$)"):null,o=h.indexOf(":")<0?"on"+h:"",(g||!e)&&c.preventDefault();if(!e){j=f.cache;for(l in j)j[l].events&&j[l].events[h]&&f.event.trigger(c,d,j[l].handle.elem,!0);return}c.result=b,c.target||(c.target=e),d=d!=null?f.makeArray(d):[],d.unshift(c),p=f.event.special[h]||{};if(p.trigger&&p.trigger.apply(e,d)===!1)return;r=[[e,p.bindType||h]];if(!g&&!p.noBubble&&!f.isWindow(e)){s=p.delegateType||h,n=null;for(m=e.parentNode;m;m=m.parentNode)r.push([m,s]),n=m;n&&n===e.ownerDocument&&r.push([n.defaultView||n.parentWindow||a,s])}for(l=0;l<r.length;l++){m=r[l][0],c.type=r[l][1],q=(f._data(m,"events")||{})[c.type]&&f._data(m,"handle"),q&&q.apply(m,d),q=o&&m[o],q&&f.acceptData(m)&&q.apply(m,d);if(c.isPropagationStopped())break}c.type=h,c.isDefaultPrevented()||(!p._default||p._default.apply(e.ownerDocument,d)===!1)&&(h!=="click"||!f.nodeName(e,"a"))&&f.acceptData(e)&&o&&e[h]&&(h!=="focus"&&h!=="blur"||c.target.offsetWidth!==0)&&!f.isWindow(e)&&(n=e[o],n&&(e[o]=null),f.event.triggered=h,e[h](),f.event.triggered=b,n&&(e[o]=n));return c.result}},dispatch:function(c){c=f.event.fix(c||a.event);var d=(f._data(this,"events")||{})[c.type]||[],e=d.delegateCount,g=[].slice.call(arguments,0),h=!c.exclusive&&!c.namespace,i=(f.event.special[c.type]||{}).handle,j=[],k,l,m,n,o,p,q,r,s,t,u;g[0]=c,c.delegateTarget=this;if(e&&!c.target.disabled&&(!c.button||c.type!=="click"))for(m=c.target;m!=this;m=m.parentNode||this){o={},q=[];for(k=0;k<e;k++)r=d[k],s=r.selector,t=o[s],r.isPositional?t=(t||(o[s]=f(s))).index(m)>=0:t===b&&(t=o[s]=r.quick?K(m,r.quick):f(m).is(s)),t&&q.push(r);q.length&&j.push({elem:m,matches:q})}d.length>e&&j.push({elem:this,matches:d.slice(e)});for(k=0;k<j.length&&!c.isPropagationStopped();k++){p=j[k],c.currentTarget=p.elem;for(l=0;l<p.matches.length&&!c.isImmediatePropagationStopped();l++){r=p.matches[l];if(h||!c.namespace&&!r.namespace||c.namespace_re&&c.namespace_re.test(r.namespace))c.data=r.data,c.handleObj=r,n=(i||r.handler).apply(p.elem,g),n!==b&&(c.result=n,n===!1&&(c.preventDefault(),c.stopPropagation()))}}return c.result},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){a.which==null&&(a.which=b.charCode!=null?b.charCode:b.keyCode);return a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement wheelDelta".split(" "),filter:function(a,d){var e,f,g,h=d.button,i=d.fromElement;a.pageX==null&&d.clientX!=null&&(e=a.target.ownerDocument||c,f=e.documentElement,g=e.body,a.pageX=d.clientX+(f&&f.scrollLeft||g&&g.scrollLeft||0)-(f&&f.clientLeft||g&&g.clientLeft||0),a.pageY=d.clientY+(f&&f.scrollTop||g&&g.scrollTop||0)-(f&&f.clientTop||g&&g.clientTop||0)),!a.relatedTarget&&i&&(a.relatedTarget=i===a.target?d.toElement:i),!a.which&&h!==b&&(a.which=h&1?1:h&2?3:h&4?2:0);return a}},fix:function(a){if(a[f.expando])return a;var d,e,g=a,h=f.event.fixHooks[a.type]||{},i=h.props?this.props.concat(h.props):this.props;a=f.Event(g);for(d=i.length;d;)e=i[--d],a[e]=g[e];a.target||(a.target=g.srcElement||c),a.target.nodeType===3&&(a.target=a.target.parentNode),a.metaKey===b&&(a.metaKey=a.ctrlKey);return h.filter?h.filter(a,g):a},special:{ready:{setup:f.bindReady},focus:{delegateType:"focusin",noBubble:!0},blur:{delegateType:"focusout",noBubble:!0},beforeunload:{setup:function(a,b,c){f.isWindow(this)&&(this.onbeforeunload=c)},teardown:function(a,b){this.onbeforeunload===b&&(this.onbeforeunload=null)}}},simulate:function(a,b,c,d){var e=f.extend(new f.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?f.event.trigger(e,null,b):f.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},f.event.handle=f.event.dispatch,f.removeEvent=c.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){a.detachEvent&&a.detachEvent("on"+b,c)},f.Event=function(a,b){if(!(this instanceof f.Event))return new f.Event(a,b);a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||a.returnValue===!1||a.getPreventDefault&&a.getPreventDefault()?N:M):this.type=a,b&&f.extend(this,b),this.timeStamp=a&&a.timeStamp||f.now(),this[f.expando]=!0},f.Event.prototype={preventDefault:function(){this.isDefaultPrevented=N;var a=this.originalEvent;!a||(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=N;var a=this.originalEvent;!a||(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=N,this.stopPropagation()},isDefaultPrevented:M,isPropagationStopped:M,isImmediatePropagationStopped:M},f.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){f.event.special[a]=f.event.special[b]={delegateType:b,bindType:b,handle:function(a){var b=this,c=a.relatedTarget,d=a.handleObj,e=d.selector,g,h;if(!c||d.origType===a.type||c!==b&&!f.contains(b,c))g=a.type,a.type=d.origType,h=d.handler.apply(this,arguments),a.type=g;return h}}}),f.support.submitBubbles||(f.event.special.submit={setup:function(){if(f.nodeName(this,"form"))return!1;f.event.add(this,"click._submit keypress._submit",function(a){var c=a.target,d=f.nodeName(c,"input")||f.nodeName(c,"button")?c.form:b;d&&!d._submit_attached&&(f.event.add(d,"submit._submit",function(a){this.parentNode&&f.event.simulate("submit",this.parentNode,a,!0)}),d._submit_attached=!0)})},teardown:function(){if(f.nodeName(this,"form"))return!1;f.event.remove(this,"._submit")}}),f.support.changeBubbles||(f.event.special.change={setup:function(){if(A.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio")f.event.add(this,"propertychange._change",function(a){a.originalEvent.propertyName==="checked"&&(this._just_changed=!0)}),f.event.add(this,"click._change",function(a){this._just_changed&&(this._just_changed=!1,f.event.simulate("change",this,a,!0))});return!1}f.event.add(this,"beforeactivate._change",function(a){var b=a.target;A.test(b.nodeName)&&!b._change_attached&&(f.event.add(b,"change._change",function(a){this.parentNode&&!a.isSimulated&&f.event.simulate("change",this.parentNode,a,!0)}),b._change_attached=!0)})},handle:function(a){var b=a.target;if(this!==b||a.isSimulated||a.isTrigger||b.type!=="radio"&&b.type!=="checkbox")return a.handleObj.handler.apply(this,arguments)},teardown:function(){f.event.remove(this,"._change");return A.test(this.nodeName)}}),f.support.focusinBubbles||f.each({focus:"focusin",blur:"focusout"},function(a,b){var d=0,e=function(a){f.event.simulate(b,a.target,f.event.fix(a),!0)};f.event.special[b]={setup:function(){d++===0&&c.addEventListener(a,e,!0)},teardown:function(){--d===0&&c.removeEventListener(a,e,!0)}}}),f.fn.extend({on:function(a,c,d,e,g){var h,i;if(typeof a=="object"){typeof c!="string"&&(d=c,c=b);for(i in a)this.on(i,c,d,a[i],g);return this}d==null&&e==null?(e=c,d=c=b):e==null&&(typeof c=="string"?(e=d,d=b):(e=d,d=c,c=b));if(e===!1)e=M;else if(!e)return this;g===1&&(h=e,e=function(a){f().off(a);return h.apply(this,arguments)},e.guid=h.guid||(h.guid=f.guid++));return this.each(function(){f.event.add(this,a,e,d,c)})},one:function(a,b,c,d){return this.on.call(this,a,b,c,d,1)},off:function(a,c,d){if(a&&a.preventDefault&&a.handleObj){var e=a.handleObj;f(a.delegateTarget).off(e.namespace?e.type+"."+e.namespace:e.type,e.selector,e.handler);return this}if(typeof a=="object"){for(var g in a)this.off(g,c,a[g]);return this}if(c===!1||typeof c=="function")d=c,c=b;d===!1&&(d=M);return this.each(function(){f.event.remove(this,a,d,c)})},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},live:function(a,b,c){f(this.context).on(a,this.selector,b,c);return this},die:function(a,b){f(this.context).off(a,this.selector||"**",b);return this},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return arguments.length==1?this.off(a,"**"):this.off(b,a,c)},trigger:function(a,b){return this.each(function(){f.event.trigger(a,b,this)})},triggerHandler:function(a,b){if(this[0])return f.event.trigger(a,b,this[0],!0)},toggle:function(a){var b=arguments,c=a.guid||f.guid++,d=0,e=function(c){var e=(f._data(this,"lastToggle"+a.guid)||0)%d;f._data(this,"lastToggle"+a.guid,e+1),c.preventDefault();return b[e].apply(this,arguments)||!1};e.guid=c;while(d<b.length)b[d++].guid=c;return this.click(e)},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}}),f.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){f.fn[b]=function(a,c){c==null&&(c=a,a=null);return arguments.length>0?this.bind(b,a,c):this.trigger(b)},f.attrFn&&(f.attrFn[b]=!0),G.test(b)&&(f.event.fixHooks[b]=f.event.keyHooks),H.test(b)&&(f.event.fixHooks[b]=f.event.mouseHooks)}),function(){function x(a,b,c,e,f,g){for(var h=0,i=e.length;h<i;h++){var j=e[h];if(j){var k=!1;j=j[a];while(j){if(j[d]===c){k=e[j.sizset];break}if(j.nodeType===1){g||(j[d]=c,j.sizset=h);if(typeof b!="string"){if(j===b){k=!0;break}}else if(m.filter(b,[j]).length>0){k=j;break}}j=j[a]}e[h]=k}}}function w(a,b,c,e,f,g){for(var h=0,i=e.length;h<i;h++){var j=e[h];if(j){var k=!1;j=j[a];while(j){if(j[d]===c){k=e[j.sizset];break}j.nodeType===1&&!g&&(j[d]=c,j.sizset=h);if(j.nodeName.toLowerCase()===b){k=j;break}j=j[a]}e[h]=k}}}var a=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,d="sizcache"+(Math.random()+"").replace(".",""),e=0,g=Object.prototype.toString,h=!1,i=!0,j=/\\/g,k=/\r\n/g,l=/\W/;[0,0].sort(function(){i=!1;return 0});var m=function(b,d,e,f){e=e||[],d=d||c;var h=d;if(d.nodeType!==1&&d.nodeType!==9)return[];if(!b||typeof b!="string")return e;var i,j,k,l,n,q,r,t,u=!0,v=m.isXML(d),w=[],x=b;do{a.exec(""),i=a.exec(x);if(i){x=i[3],w.push(i[1]);if(i[2]){l=i[3];break}}}while(i);if(w.length>1&&p.exec(b))if(w.length===2&&o.relative[w[0]])j=y(w[0]+w[1],d,f);else{j=o.relative[w[0]]?[d]:m(w.shift(),d);while(w.length)b=w.shift(),o.relative[b]&&(b+=w.shift()),j=y(b,j,f)}else{!f&&w.length>1&&d.nodeType===9&&!v&&o.match.ID.test(w[0])&&!o.match.ID.test(w[w.length-1])&&(n=m.find(w.shift(),d,v),d=n.expr?m.filter(n.expr,n.set)[0]:n.set[0]);if(d){n=f?{expr:w.pop(),set:s(f)}:m.find(w.pop(),w.length===1&&(w[0]==="~"||w[0]==="+")&&d.parentNode?d.parentNode:d,v),j=n.expr?m.filter(n.expr,n.set):n.set,w.length>0?k=s(j):u=!1;while(w.length)q=w.pop(),r=q,o.relative[q]?r=w.pop():q="",r==null&&(r=d),o.relative[q](k,r,v)}else k=w=[]}k||(k=j),k||m.error(q||b);if(g.call(k)==="[object Array]")if(!u)e.push.apply(e,k);else if(d&&d.nodeType===1)for(t=0;k[t]!=null;t++)k[t]&&(k[t]===!0||k[t].nodeType===1&&m.contains(d,k[t]))&&e.push(j[t]);else for(t=0;k[t]!=null;t++)k[t]&&k[t].nodeType===1&&e.push(j[t]);else s(k,e);l&&(m(l,h,e,f),m.uniqueSort(e));return e};m.uniqueSort=function(a){if(u){h=i,a.sort(u);if(h)for(var b=1;b<a.length;b++)a[b]===a[b-1]&&a.splice(b--,1)}return a},m.matches=function(a,b){return m(a,null,null,b)},m.matchesSelector=function(a,b){return m(b,null,null,[a]).length>0},m.find=function(a,b,c){var d,e,f,g,h,i;if(!a)return[];for(e=0,f=o.order.length;e<f;e++){h=o.order[e];if(g=o.leftMatch[h].exec(a)){i=g[1],g.splice(1,1);if(i.substr(i.length-1)!=="\\"){g[1]=(g[1]||"").replace(j,""),d=o.find[h](g,b,c);if(d!=null){a=a.replace(o.match[h],"");break}}}}d||(d=typeof b.getElementsByTagName!="undefined"?b.getElementsByTagName("*"):[]);return{set:d,expr:a}},m.filter=function(a,c,d,e){var f,g,h,i,j,k,l,n,p,q=a,r=[],s=c,t=c&&c[0]&&m.isXML(c[0]);while(a&&c.length){for(h in o.filter)if((f=o.leftMatch[h].exec(a))!=null&&f[2]){k=o.filter[h],l=f[1],g=!1,f.splice(1,1);if(l.substr(l.length-1)==="\\")continue;s===r&&(r=[]);if(o.preFilter[h]){f=o.preFilter[h](f,s,d,r,e,t);if(!f)g=i=!0;else if(f===!0)continue}if(f)for(n=0;(j=s[n])!=null;n++)j&&(i=k(j,f,n,s),p=e^i,d&&i!=null?p?g=!0:s[n]=!1:p&&(r.push(j),g=!0));if(i!==b){d||(s=r),a=a.replace(o.match[h],"");if(!g)return[];break}}if(a===q)if(g==null)m.error(a);else break;q=a}return s},m.error=function(a){throw"Syntax error, unrecognized expression: "+a};var n=m.getText=function(a){var b,c,d=a.nodeType,e="";if(d){if(d===1){if(typeof a.textContent=="string")return a.textContent;if(typeof a.innerText=="string")return a.innerText.replace(k,"");for(a=a.firstChild;a;a=a.nextSibling)e+=n(a)}else if(d===3||d===4)return a.nodeValue}else for(b=0;c=a[b];b++)c.nodeType!==8&&(e+=n(c));return e},o=m.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(a){return a.getAttribute("href")},type:function(a){return a.getAttribute("type")}},relative:{"+":function(a,b){var c=typeof b=="string",d=c&&!l.test(b),e=c&&!d;d&&(b=b.toLowerCase());for(var f=0,g=a.length,h;f<g;f++)if(h=a[f]){while((h=h.previousSibling)&&h.nodeType!==1);a[f]=e||h&&h.nodeName.toLowerCase()===b?h||!1:h===b}e&&m.filter(b,a,!0)},">":function(a,b){var c,d=typeof b=="string",e=0,f=a.length;if(d&&!l.test(b)){b=b.toLowerCase();for(;e<f;e++){c=a[e];if(c){var g=c.parentNode;a[e]=g.nodeName.toLowerCase()===b?g:!1}}}else{for(;e<f;e++)c=a[e],c&&(a[e]=d?c.parentNode:c.parentNode===b);d&&m.filter(b,a,!0)}},"":function(a,b,c){var d,f=e++,g=x;typeof b=="string"&&!l.test(b)&&(b=b.toLowerCase(),d=b,g=w),g("parentNode",b,f,a,d,c)},"~":function(a,b,c){var d,f=e++,g=x;typeof b=="string"&&!l.test(b)&&(b=b.toLowerCase(),d=b,g=w),g("previousSibling",b,f,a,d,c)}},find:{ID:function(a,b,c){if(typeof b.getElementById!="undefined"&&!c){var d=b.getElementById(a[1]);return d&&d.parentNode?[d]:[]}},NAME:function(a,b){if(typeof b.getElementsByName!="undefined"){var c=[],d=b.getElementsByName(a[1]);for(var e=0,f=d.length;e<f;e++)d[e].getAttribute("name")===a[1]&&c.push(d[e]);return c.length===0?null:c}},TAG:function(a,b){if(typeof b.getElementsByTagName!="undefined")return b.getElementsByTagName(a[1])}},preFilter:{CLASS:function(a,b,c,d,e,f){a=" "+a[1].replace(j,"")+" ";if(f)return a;for(var g=0,h;(h=b[g])!=null;g++)h&&(e^(h.className&&(" "+h.className+" ").replace(/[\t\n\r]/g," ").indexOf(a)>=0)?c||d.push(h):c&&(b[g]=!1));return!1},ID:function(a){return a[1].replace(j,"")},TAG:function(a,b){return a[1].replace(j,"").toLowerCase()},CHILD:function(a){if(a[1]==="nth"){a[2]||m.error(a[0]),a[2]=a[2].replace(/^\+|\s*/g,"");var b=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(a[2]==="even"&&"2n"||a[2]==="odd"&&"2n+1"||!/\D/.test(a[2])&&"0n+"+a[2]||a[2]);a[2]=b[1]+(b[2]||1)-0,a[3]=b[3]-0}else a[2]&&m.error(a[0]);a[0]=e++;return a},ATTR:function(a,b,c,d,e,f){var g=a[1]=a[1].replace(j,"");!f&&o.attrMap[g]&&(a[1]=o.attrMap[g]),a[4]=(a[4]||a[5]||"").replace(j,""),a[2]==="~="&&(a[4]=" "+a[4]+" ");return a},PSEUDO:function(b,c,d,e,f){if(b[1]==="not")if((a.exec(b[3])||"").length>1||/^\w/.test(b[3]))b[3]=m(b[3],null,null,c);else{var g=m.filter(b[3],c,d,!0^f);d||e.push.apply(e,g);return!1}else if(o.match.POS.test(b[0])||o.match.CHILD.test(b[0]))return!0;return b},POS:function(a){a.unshift(!0);return a}},filters:{enabled:function(a){return a.disabled===!1&&a.type!=="hidden"},disabled:function(a){return a.disabled===!0},checked:function(a){return a.checked===!0},selected:function(a){a.parentNode&&a.parentNode.selectedIndex;return a.selected===!0},parent:function(a){return!!a.firstChild},empty:function(a){return!a.firstChild},has:function(a,b,c){return!!m(c[3],a).length},header:function(a){return/h\d/i.test(a.nodeName)},text:function(a){var b=a.getAttribute("type"),c=a.type;return a.nodeName.toLowerCase()==="input"&&"text"===c&&(b===c||b===null)},radio:function(a){return a.nodeName.toLowerCase()==="input"&&"radio"===a.type},checkbox:function(a){return a.nodeName.toLowerCase()==="input"&&"checkbox"===a.type},file:function(a){return a.nodeName.toLowerCase()==="input"&&"file"===a.type},password:function(a){return a.nodeName.toLowerCase()==="input"&&"password"===a.type},submit:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"submit"===a.type},image:function(a){return a.nodeName.toLowerCase()==="input"&&"image"===a.type},reset:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"reset"===a.type},button:function(a){var b=a.nodeName.toLowerCase();return b==="input"&&"button"===a.type||b==="button"},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)},focus:function(a){return a===a.ownerDocument.activeElement}},setFilters:{first:function(a,b){return b===0},last:function(a,b,c,d){return b===d.length-1},even:function(a,b){return b%2===0},odd:function(a,b){return b%2===1},lt:function(a,b,c){return b<c[3]-0},gt:function(a,b,c){return b>c[3]-0},nth:function(a,b,c){return c[3]-0===b},eq:function(a,b,c){return c[3]-0===b}},filter:{PSEUDO:function(a,b,c,d){var e=b[1],f=o.filters[e];if(f)return f(a,c,b,d);if(e==="contains")return(a.textContent||a.innerText||n([a])||"").indexOf(b[3])>=0;if(e==="not"){var g=b[3];for(var h=0,i=g.length;h<i;h++)if(g[h]===a)return!1;return!0}m.error(e)},CHILD:function(a,b){var c,e,f,g,h,i,j,k=b[1],l=a;switch(k){case"only":case"first":while(l=l.previousSibling)if(l.nodeType===1)return!1;if(k==="first")return!0;l=a;case"last":while(l=l.nextSibling)if(l.nodeType===1)return!1;return!0;case"nth":c=b[2],e=b[3];if(c===1&&e===0)return!0;f=b[0],g=a.parentNode;if(g&&(g[d]!==f||!a.nodeIndex)){i=0;for(l=g.firstChild;l;l=l.nextSibling)l.nodeType===1&&(l.nodeIndex=++i);g[d]=f}j=a.nodeIndex-e;return c===0?j===0:j%c===0&&j/c>=0}},ID:function(a,b){return a.nodeType===1&&a.getAttribute("id")===b},TAG:function(a,b){return b==="*"&&a.nodeType===1||!!a.nodeName&&a.nodeName.toLowerCase()===b},CLASS:function(a,b){return(" "+(a.className||a.getAttribute("class"))+" ").indexOf(b)>-1},ATTR:function(a,b){var c=b[1],d=m.attr?m.attr(a,c):o.attrHandle[c]?o.attrHandle[c](a):a[c]!=null?a[c]:a.getAttribute(c),e=d+"",f=b[2],g=b[4];return d==null?f==="!=":!f&&m.attr?d!=null:f==="="?e===g:f==="*="?e.indexOf(g)>=0:f==="~="?(" "+e+" ").indexOf(g)>=0:g?f==="!="?e!==g:f==="^="?e.indexOf(g)===0:f==="$="?e.substr(e.length-g.length)===g:f==="|="?e===g||e.substr(0,g.length+1)===g+"-":!1:e&&d!==!1},POS:function(a,b,c,d){var e=b[2],f=o.setFilters[e];if(f)return f(a,c,b,d)}}},p=o.match.POS,q=function(a,b){return"\\"+(b-0+1)};for(var r in o.match)o.match[r]=new RegExp(o.match[r].source+/(?![^\[]*\])(?![^\(]*\))/.source),o.leftMatch[r]=new RegExp(/(^(?:.|\r|\n)*?)/.source+o.match[r].source.replace(/\\(\d+)/g,q));var s=function(a,b){a=Array.prototype.slice.call(a,0);if(b){b.push.apply(b,a);return b}return a};try{Array.prototype.slice.call(c.documentElement.childNodes,0)[0].nodeType}catch(t){s=function(a,b){var c=0,d=b||[];if(g.call(a)==="[object Array]")Array.prototype.push.apply(d,a);else if(typeof a.length=="number")for(var e=a.length;c<e;c++)d.push(a[c]);else for(;a[c];c++)d.push(a[c]);return d}}var u,v;c.documentElement.compareDocumentPosition?u=function(a,b){if(a===b){h=!0;return 0}if(!a.compareDocumentPosition||!b.compareDocumentPosition)return a.compareDocumentPosition?-1:1;return a.compareDocumentPosition(b)&4?-1:1}:(u=function(a,b){if(a===b){h=!0;return 0}if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;var c,d,e=[],f=[],g=a.parentNode,i=b.parentNode,j=g;if(g===i)return v(a,b);if(!g)return-1;if(!i)return 1;while(j)e.unshift(j),j=j.parentNode;j=i;while(j)f.unshift(j),j=j.parentNode;c=e.length,d=f.length;for(var k=0;k<c&&k<d;k++)if(e[k]!==f[k])return v(e[k],f[k]);return k===c?v(a,f[k],-1):v(e[k],b,1)},v=function(a,b,c){if(a===b)return c;var d=a.nextSibling;while(d){if(d===b)return-1;d=d.nextSibling}return 1}),function(){var a=c.createElement("div"),d="script"+(new Date).getTime(),e=c.documentElement;a.innerHTML="<a name='"+d+"'/>",e.insertBefore(a,e.firstChild),c.getElementById(d)&&(o.find.ID=function(a,c,d){if(typeof c.getElementById!="undefined"&&!d){var e=c.getElementById(a[1]);return e?e.id===a[1]||typeof e.getAttributeNode!="undefined"&&e.getAttributeNode("id").nodeValue===a[1]?[e]:b:[]}},o.filter.ID=function(a,b){var c=typeof a.getAttributeNode!="undefined"&&a.getAttributeNode("id");return a.nodeType===1&&c&&c.nodeValue===b}),e.removeChild(a),e=a=null}(),function(){var a=c.createElement("div");a.appendChild(c.createComment("")),a.getElementsByTagName("*").length>0&&(o.find.TAG=function(a,b){var c=b.getElementsByTagName(a[1]);if(a[1]==="*"){var d=[];for(var e=0;c[e];e++)c[e].nodeType===1&&d.push(c[e]);c=d}return c}),a.innerHTML="<a href='#'></a>",a.firstChild&&typeof a.firstChild.getAttribute!="undefined"&&a.firstChild.getAttribute("href")!=="#"&&(o.attrHandle.href=function(a){return a.getAttribute("href",2)}),a=null}(),c.querySelectorAll&&function(){var a=m,b=c.createElement("div"),d="__sizzle__";b.innerHTML="<p class='TEST'></p>";if(!b.querySelectorAll||b.querySelectorAll(".TEST").length!==0){m=function(b,e,f,g){e=e||c;if(!g&&!m.isXML(e)){var h=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(b);if(h&&(e.nodeType===1||e.nodeType===9)){if(h[1])return s(e.getElementsByTagName(b),f);if(h[2]&&o.find.CLASS&&e.getElementsByClassName)return s(e.getElementsByClassName(h[2]),f)}if(e.nodeType===9){if(b==="body"&&e.body)return s([e.body],f);if(h&&h[3]){var i=e.getElementById(h[3]);if(!i||!i.parentNode)return s([],f);if(i.id===h[3])return s([i],f)}try{return s(e.querySelectorAll(b),f)}catch(j){}}else if(e.nodeType===1&&e.nodeName.toLowerCase()!=="object"){var k=e,l=e.getAttribute("id"),n=l||d,p=e.parentNode,q=/^\s*[+~]/.test(b);l?n=n.replace(/'/g,"\\$&"):e.setAttribute("id",n),q&&p&&(e=e.parentNode);try{if(!q||p)return s(e.querySelectorAll("[id='"+n+"'] "+b),f)}catch(r){}finally{l||k.removeAttribute("id")}}}return a(b,e,f,g)};for(var e in a)m[e]=a[e];b=null}}(),function(){var a=c.documentElement,b=a.matchesSelector||a.mozMatchesSelector||a.webkitMatchesSelector||a.msMatchesSelector;if(b){var d=!b.call(c.createElement("div"),"div"),e=!1;try{b.call(c.documentElement,"[test!='']:sizzle")}catch(f){e=!0}m.matchesSelector=function(a,c){c=c.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!m.isXML(a))try{if(e||!o.match.PSEUDO.test(c)&&!/!=/.test(c)){var f=b.call(a,c);if(f||!d||a.document&&a.document.nodeType!==11)return f}}catch(g){}return m(c,null,null,[a]).length>0}}}(),function(){var a=c.createElement("div");a.innerHTML="<div class='test e'></div><div class='test'></div>";if(!!a.getElementsByClassName&&a.getElementsByClassName("e").length!==0){a.lastChild.className="e";if(a.getElementsByClassName("e").length===1)return;o.order.splice(1,0,"CLASS"),o.find.CLASS=function(a,b,c){if(typeof b.getElementsByClassName!="undefined"&&!c)return b.getElementsByClassName(a[1])},a=null}}(),c.documentElement.contains?m.contains=function(a,b){return a!==b&&(a.contains?a.contains(b):!0)}:c.documentElement.compareDocumentPosition?m.contains=function(a,b){return!!(a.compareDocumentPosition(b)&16)}:m.contains=function(){return!1},m.isXML=function(a){var b=(a?a.ownerDocument||a:0).documentElement;return b?b.nodeName!=="HTML":!1};var y=function(a,b,c){var d,e=[],f="",g=b.nodeType?[b]:b;while(d=o.match.PSEUDO.exec(a))f+=d[0],a=a.replace(o.match.PSEUDO,"");a=o.relative[a]?a+"*":a;for(var h=0,i=g.length;h<i;h++)m(a,g[h],e,c);return m.filter(f,e)};m.attr=f.attr,m.selectors.attrMap={},f.find=m,f.expr=m.selectors,f.expr[":"]=f.expr.filters,f.unique=m.uniqueSort,f.text=m.getText,f.isXMLDoc=m.isXML,f.contains=m.contains}();var O=/Until$/,P=/^(?:parents|prevUntil|prevAll)/,Q=/,/,R=/^.[^:#\[\.,]*$/,S=Array.prototype.slice,T=f.expr.match.POS,U={children:!0,contents:!0,next:!0,prev:!0};f.fn.extend({find:function(a){var b=this,c,d;if(typeof a!="string")return f(a).filter(function(){for(c=0,d=b.length;c<d;c++)if(f.contains(b[c],this))return!0});var e=this.pushStack("","find",a),g,h,i;for(c=0,d=this.length;c<d;c++){g=e.length,f.find(a,this[c],e);if(c>0)for(h=g;h<e.length;h++)for(i=0;i<g;i++)if(e[i]===e[h]){e.splice(h--,1);break}}return e},has:function(a){var b=f(a);return this.filter(function(){for(var a=0,c=b.length;a<c;a++)if(f.contains(this,b[a]))return!0})},not:function(a){return this.pushStack(W(this,a,!1),"not",a)},filter:function(a){return this.pushStack(W(this,a,!0),"filter",a)},is:function(a){return!!a&&(typeof a=="string"?T.test(a)?f(a,this.context).index(this[0])>=0:f.filter(a,this).length>0:this.filter(a).length>0)},closest:function(a,b){var c=[],d,e,g=this[0];if(f.isArray(a)){var h=1;while(g&&g.ownerDocument&&g!==b){for(d=0;d<a.length;d++)f(g).is(a[d])&&c.push({selector:a[d],elem:g,level:h});g=g.parentNode,h++}return c}var i=T.test(a)||typeof a!="string"?f(a,b||this.context):0;for(d=0,e=this.length;d<e;d++){g=this[d];while(g){if(i?i.index(g)>-1:f.find.matchesSelector(g,a)){c.push(g);break}g=g.parentNode;if(!g||!g.ownerDocument||g===b||g.nodeType===11)break}}c=c.length>1?f.unique(c):c;return this.pushStack(c,"closest",a)},index:function(a){if(!a)return this[0]&&this[0].parentNode?this.prevAll().length:-1;if(typeof a=="string")return f.inArray(this[0],f(a));return f.inArray(a.jquery?a[0]:a,this)},add:function(a,b){var c=typeof a=="string"?f(a,b):f.makeArray(a&&a.nodeType?[a]:a),d=f.merge(this.get(),c);return this.pushStack(V(c[0])||V(d[0])?d:f.unique(d))},andSelf:function(){return this.add(this.prevObject)}}),f.each({parent:function(a){var b=a.parentNode;return b&&b.nodeType!==11?b:null},parents:function(a){return f.dir(a,"parentNode")},parentsUntil:function(a,b,c){return f.dir(a,"parentNode",c)},next:function(a){return f.nth(a,2,"nextSibling")},prev:function(a){return f.nth(a,2,"previousSibling")},nextAll:function(a){return f.dir(a,"nextSibling")},prevAll:function(a){return f.dir(a,"previousSibling")},nextUntil:function(a,b,c){return f.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return f.dir(a,"previousSibling",c)},siblings:function(a){return f.sibling(a.parentNode.firstChild,a)},children:function(a){return f.sibling(a.firstChild)},contents:function(a){return f.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:f.makeArray(a.childNodes)}},function(a,b){f.fn[a]=function(c,d){var e=f.map(this,b,c),g=S.call(arguments);O.test(a)||(d=c),d&&typeof d=="string"&&(e=f.filter(d,e)),e=this.length>1&&!U[a]?f.unique(e):e,(this.length>1||Q.test(d))&&P.test(a)&&(e=e.reverse());return this.pushStack(e,a,g.join(","))}}),f.extend({filter:function(a,b,c){c&&(a=":not("+a+")");return b.length===1?f.find.matchesSelector(b[0],a)?[b[0]]:[]:f.find.matches(a,b)},dir:function(a,c,d){var e=[],g=a[c];while(g&&g.nodeType!==9&&(d===b||g.nodeType!==1||!f(g).is(d)))g.nodeType===1&&e.push(g),g=g[c];return e},nth:function(a,b,c,d){b=b||1;var e=0;for(;a;a=a[c])if(a.nodeType===1&&++e===b)break;return a},sibling:function(a,b){var c=[];for(;a;a=a.nextSibling)a.nodeType===1&&a!==b&&c.push(a);return c}});var Y="abbr article aside audio canvas datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video",Z=/ jQuery\d+="(?:\d+|null)"/g,$=/^\s+/,_=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,ba=/<([\w:]+)/,bb=/<tbody/i,bc=/<|&#?\w+;/,bd=/<(?:script|style)/i,be=/<(?:script|object|embed|option|style)/i,bf=new RegExp("<(?:"+Y.replace(" ","|")+")","i"),bg=/checked\s*(?:[^=]|=\s*.checked.)/i,bh=/\/(java|ecma)script/i,bi=/^\s*<!(?:\[CDATA\[|\-\-)/,bj={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},bk=X(c);bj.optgroup=bj.option,bj.tbody=bj.tfoot=bj.colgroup=bj.caption=bj.thead,bj.th=bj.td,f.support.htmlSerialize||(bj._default=[1,"div<div>","</div>"]),f.fn.extend({text:function(a){if(f.isFunction(a))return this.each(function(b){var c=f(this);c.text(a.call(this,b,c.text()))});if(typeof a!="object"&&a!==b)return this.empty().append((this[0]&&this[0].ownerDocument||c).createTextNode(a));return f.text(this)},wrapAll:function(a){if(f.isFunction(a))return this.each(function(b){f(this).wrapAll(a.call(this,b))});if(this[0]){var b=f(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstChild&&a.firstChild.nodeType===1)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){if(f.isFunction(a))return this.each(function(b){f(this).wrapInner(a.call(this,b))});return this.each(function(){var b=f(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){return this.each(function(){f(this).wrapAll(a)})},unwrap:function(){return this.parent().each(function(){f.nodeName(this,"body")||f(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.insertBefore(a,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this)});if(arguments.length){var a=f(arguments[0]);a.push.apply(a,this.toArray());return this.pushStack(a,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this.nextSibling)});if(arguments.length){var a=this.pushStack(this,"after"
+,arguments);a.push.apply(a,f(arguments[0]).toArray());return a}},remove:function(a,b){for(var c=0,d;(d=this[c])!=null;c++)if(!a||f.filter(a,[d]).length)!b&&d.nodeType===1&&(f.cleanData(d.getElementsByTagName("*")),f.cleanData([d])),d.parentNode&&d.parentNode.removeChild(d);return this},empty:function(){for(var a=0,b;(b=this[a])!=null;a++){b.nodeType===1&&f.cleanData(b.getElementsByTagName("*"));while(b.firstChild)b.removeChild(b.firstChild)}return this},clone:function(a,b){a=a==null?!1:a,b=b==null?a:b;return this.map(function(){return f.clone(this,a,b)})},html:function(a){if(a===b)return this[0]&&this[0].nodeType===1?this[0].innerHTML.replace(Z,""):null;if(typeof a=="string"&&!bd.test(a)&&(f.support.leadingWhitespace||!$.test(a))&&!bj[(ba.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(_,"<$1></$2>");try{for(var c=0,d=this.length;c<d;c++)this[c].nodeType===1&&(f.cleanData(this[c].getElementsByTagName("*")),this[c].innerHTML=a)}catch(e){this.empty().append(a)}}else f.isFunction(a)?this.each(function(b){var c=f(this);c.html(a.call(this,b,c.html()))}):this.empty().append(a);return this},replaceWith:function(a){if(this[0]&&this[0].parentNode){if(f.isFunction(a))return this.each(function(b){var c=f(this),d=c.html();c.replaceWith(a.call(this,b,d))});typeof a!="string"&&(a=f(a).detach());return this.each(function(){var b=this.nextSibling,c=this.parentNode;f(this).remove(),b?f(b).before(a):f(c).append(a)})}return this.length?this.pushStack(f(f.isFunction(a)?a():a),"replaceWith",a):this},detach:function(a){return this.remove(a,!0)},domManip:function(a,c,d){var e,g,h,i,j=a[0],k=[];if(!f.support.checkClone&&arguments.length===3&&typeof j=="string"&&bg.test(j))return this.each(function(){f(this).domManip(a,c,d,!0)});if(f.isFunction(j))return this.each(function(e){var g=f(this);a[0]=j.call(this,e,c?g.html():b),g.domManip(a,c,d)});if(this[0]){i=j&&j.parentNode,f.support.parentNode&&i&&i.nodeType===11&&i.childNodes.length===this.length?e={fragment:i}:e=f.buildFragment(a,this,k),h=e.fragment,h.childNodes.length===1?g=h=h.firstChild:g=h.firstChild;if(g){c=c&&f.nodeName(g,"tr");for(var l=0,m=this.length,n=m-1;l<m;l++)d.call(c?bl(this[l],g):this[l],e.cacheable||m>1&&l<n?f.clone(h,!0,!0):h)}k.length&&f.each(k,br)}return this}}),f.buildFragment=function(a,b,d){var e,g,h,i,j=a[0];b&&b[0]&&(i=b[0].ownerDocument||b[0]),i.createDocumentFragment||(i=c),a.length===1&&typeof j=="string"&&j.length<512&&i===c&&j.charAt(0)==="<"&&!be.test(j)&&(f.support.checkClone||!bg.test(j))&&!f.support.unknownElems&&bf.test(j)&&(g=!0,h=f.fragments[j],h&&h!==1&&(e=h)),e||(e=i.createDocumentFragment(),f.clean(a,i,e,d)),g&&(f.fragments[j]=h?e:1);return{fragment:e,cacheable:g}},f.fragments={},f.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){f.fn[a]=function(c){var d=[],e=f(c),g=this.length===1&&this[0].parentNode;if(g&&g.nodeType===11&&g.childNodes.length===1&&e.length===1){e[b](this[0]);return this}for(var h=0,i=e.length;h<i;h++){var j=(h>0?this.clone(!0):this).get();f(e[h])[b](j),d=d.concat(j)}return this.pushStack(d,a,e.selector)}}),f.extend({clone:function(a,b,c){var d=a.cloneNode(!0),e,g,h;if((!f.support.noCloneEvent||!f.support.noCloneChecked)&&(a.nodeType===1||a.nodeType===11)&&!f.isXMLDoc(a)){bn(a,d),e=bo(a),g=bo(d);for(h=0;e[h];++h)g[h]&&bn(e[h],g[h])}if(b){bm(a,d);if(c){e=bo(a),g=bo(d);for(h=0;e[h];++h)bm(e[h],g[h])}}e=g=null;return d},clean:function(a,b,d,e){var g;b=b||c,typeof b.createElement=="undefined"&&(b=b.ownerDocument||b[0]&&b[0].ownerDocument||c);var h=[],i;for(var j=0,k;(k=a[j])!=null;j++){typeof k=="number"&&(k+="");if(!k)continue;if(typeof k=="string")if(!bc.test(k))k=b.createTextNode(k);else{k=k.replace(_,"<$1></$2>");var l=(ba.exec(k)||["",""])[1].toLowerCase(),m=bj[l]||bj._default,n=m[0],o=b.createElement("div");b===c?bk.appendChild(o):X(b).appendChild(o),o.innerHTML=m[1]+k+m[2];while(n--)o=o.lastChild;if(!f.support.tbody){var p=bb.test(k),q=l==="table"&&!p?o.firstChild&&o.firstChild.childNodes:m[1]==="<table>"&&!p?o.childNodes:[];for(i=q.length-1;i>=0;--i)f.nodeName(q[i],"tbody")&&!q[i].childNodes.length&&q[i].parentNode.removeChild(q[i])}!f.support.leadingWhitespace&&$.test(k)&&o.insertBefore(b.createTextNode($.exec(k)[0]),o.firstChild),k=o.childNodes}var r;if(!f.support.appendChecked)if(k[0]&&typeof (r=k.length)=="number")for(i=0;i<r;i++)bq(k[i]);else bq(k);k.nodeType?h.push(k):h=f.merge(h,k)}if(d){g=function(a){return!a.type||bh.test(a.type)};for(j=0;h[j];j++)if(e&&f.nodeName(h[j],"script")&&(!h[j].type||h[j].type.toLowerCase()==="text/javascript"))e.push(h[j].parentNode?h[j].parentNode.removeChild(h[j]):h[j]);else{if(h[j].nodeType===1){var s=f.grep(h[j].getElementsByTagName("script"),g);h.splice.apply(h,[j+1,0].concat(s))}d.appendChild(h[j])}}return h},cleanData:function(a){var b,c,d=f.cache,e=f.event.special,g=f.support.deleteExpando;for(var h=0,i;(i=a[h])!=null;h++){if(i.nodeName&&f.noData[i.nodeName.toLowerCase()])continue;c=i[f.expando];if(c){b=d[c];if(b&&b.events){for(var j in b.events)e[j]?f.event.remove(i,j):f.removeEvent(i,j,b.handle);b.handle&&(b.handle.elem=null)}g?delete i[f.expando]:i.removeAttribute&&i.removeAttribute(f.expando),delete d[c]}}}});var bs=/alpha\([^)]*\)/i,bt=/opacity=([^)]*)/,bu=/([A-Z]|^ms)/g,bv=/^-?\d+(?:px)?$/i,bw=/^-?\d/,bx=/^([\-+])=([\-+.\de]+)/,by={position:"absolute",visibility:"hidden",display:"block"},bz=["Left","Right"],bA=["Top","Bottom"],bB,bC,bD;f.fn.css=function(a,c){if(arguments.length===2&&c===b)return this;return f.access(this,a,c,!0,function(a,c,d){return d!==b?f.style(a,c,d):f.css(a,c)})},f.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=bB(a,"opacity","opacity");return c===""?"1":c}return a.style.opacity}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":f.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,c,d,e){if(!!a&&a.nodeType!==3&&a.nodeType!==8&&!!a.style){var g,h,i=f.camelCase(c),j=a.style,k=f.cssHooks[i];c=f.cssProps[i]||i;if(d===b){if(k&&"get"in k&&(g=k.get(a,!1,e))!==b)return g;return j[c]}h=typeof d,h==="string"&&(g=bx.exec(d))&&(d=+(g[1]+1)*+g[2]+parseFloat(f.css(a,c)),h="number");if(d==null||h==="number"&&isNaN(d))return;h==="number"&&!f.cssNumber[i]&&(d+="px");if(!k||!("set"in k)||(d=k.set(a,d))!==b)try{j[c]=d}catch(l){}}},css:function(a,c,d){var e,g;c=f.camelCase(c),g=f.cssHooks[c],c=f.cssProps[c]||c,c==="cssFloat"&&(c="float");if(g&&"get"in g&&(e=g.get(a,!0,d))!==b)return e;if(bB)return bB(a,c)},swap:function(a,b,c){var d={};for(var e in b)d[e]=a.style[e],a.style[e]=b[e];c.call(a);for(e in b)a.style[e]=d[e]}}),f.curCSS=f.css,f.each(["height","width"],function(a,b){f.cssHooks[b]={get:function(a,c,d){var e;if(c){if(a.offsetWidth!==0)return bE(a,b,d);f.swap(a,by,function(){e=bE(a,b,d)});return e}},set:function(a,b){if(!bv.test(b))return b;b=parseFloat(b);if(b>=0)return b+"px"}}}),f.support.opacity||(f.cssHooks.opacity={get:function(a,b){return bt.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?parseFloat(RegExp.$1)/100+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=f.isNumeric(b)?"alpha(opacity="+b*100+")":"",g=d&&d.filter||c.filter||"";c.zoom=1;if(b>=1&&f.trim(g.replace(bs,""))===""){c.removeAttribute("filter");if(d&&!d.filter)return}c.filter=bs.test(g)?g.replace(bs,e):g+" "+e}}),f(function(){f.support.reliableMarginRight||(f.cssHooks.marginRight={get:function(a,b){var c;f.swap(a,{display:"inline-block"},function(){b?c=bB(a,"margin-right","marginRight"):c=a.style.marginRight});return c}})}),c.defaultView&&c.defaultView.getComputedStyle&&(bC=function(a,c){var d,e,g;c=c.replace(bu,"-$1").toLowerCase();if(!(e=a.ownerDocument.defaultView))return b;if(g=e.getComputedStyle(a,null))d=g.getPropertyValue(c),d===""&&!f.contains(a.ownerDocument.documentElement,a)&&(d=f.style(a,c));return d}),c.documentElement.currentStyle&&(bD=function(a,b){var c,d,e,f=a.currentStyle&&a.currentStyle[b],g=a.style;f===null&&g&&(e=g[b])&&(f=e),!bv.test(f)&&bw.test(f)&&(c=g.left,d=a.runtimeStyle&&a.runtimeStyle.left,d&&(a.runtimeStyle.left=a.currentStyle.left),g.left=b==="fontSize"?"1em":f||0,f=g.pixelLeft+"px",g.left=c,d&&(a.runtimeStyle.left=d));return f===""?"auto":f}),bB=bC||bD,f.expr&&f.expr.filters&&(f.expr.filters.hidden=function(a){var b=a.offsetWidth,c=a.offsetHeight;return b===0&&c===0||!f.support.reliableHiddenOffsets&&(a.style&&a.style.display||f.css(a,"display"))==="none"},f.expr.filters.visible=function(a){return!f.expr.filters.hidden(a)});var bF=/%20/g,bG=/\[\]$/,bH=/\r?\n/g,bI=/#.*$/,bJ=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,bK=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,bL=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,bM=/^(?:GET|HEAD)$/,bN=/^\/\//,bO=/\?/,bP=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,bQ=/^(?:select|textarea)/i,bR=/\s+/,bS=/([?&])_=[^&]*/,bT=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,bU=f.fn.load,bV={},bW={},bX,bY,bZ=["*/"]+["*"];try{bX=e.href}catch(b$){bX=c.createElement("a"),bX.href="",bX=bX.href}bY=bT.exec(bX.toLowerCase())||[],f.fn.extend({load:function(a,c,d){if(typeof a!="string"&&bU)return bU.apply(this,arguments);if(!this.length)return this;var e=a.indexOf(" ");if(e>=0){var g=a.slice(e,a.length);a=a.slice(0,e)}var h="GET";c&&(f.isFunction(c)?(d=c,c=b):typeof c=="object"&&(c=f.param(c,f.ajaxSettings.traditional),h="POST"));var i=this;f.ajax({url:a,type:h,dataType:"html",data:c,complete:function(a,b,c){c=a.responseText,a.isResolved()&&(a.done(function(a){c=a}),i.html(g?f("<div>").append(c.replace(bP,"")).find(g):c)),d&&i.each(d,[c,b,a])}});return this},serialize:function(){return f.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?f.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||bQ.test(this.nodeName)||bK.test(this.type))}).map(function(a,b){var c=f(this).val();return c==null?null:f.isArray(c)?f.map(c,function(a,c){return{name:b.name,value:a.replace(bH,"\r\n")}}):{name:b.name,value:c.replace(bH,"\r\n")}}).get()}}),f.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){f.fn[b]=function(a){return this.bind(b,a)}}),f.each(["get","post"],function(a,c){f[c]=function(a,d,e,g){f.isFunction(d)&&(g=g||e,e=d,d=b);return f.ajax({type:c,url:a,data:d,success:e,dataType:g})}}),f.extend({getScript:function(a,c){return f.get(a,b,c,"script")},getJSON:function(a,b,c){return f.get(a,b,c,"json")},ajaxSetup:function(a,b){b?cb(a,f.ajaxSettings):(b=a,a=f.ajaxSettings),cb(a,b);return a},ajaxSettings:{url:bX,isLocal:bL.test(bY[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":bZ},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":a.String,"text html":!0,"text json":f.parseJSON,"text xml":f.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:b_(bV),ajaxTransport:b_(bW),ajax:function(a,c){function w(a,c,l,m){if(s!==2){s=2,q&&clearTimeout(q),p=b,n=m||"",v.readyState=a>0?4:0;var o,r,u,w=c,x=l?cd(d,v,l):b,y,z;if(a>=200&&a<300||a===304){if(d.ifModified){if(y=v.getResponseHeader("Last-Modified"))f.lastModified[k]=y;if(z=v.getResponseHeader("Etag"))f.etag[k]=z}if(a===304)w="notmodified",o=!0;else try{r=ce(d,x),w="success",o=!0}catch(A){w="parsererror",u=A}}else{u=w;if(!w||a)w="error",a<0&&(a=0)}v.status=a,v.statusText=""+(c||w),o?h.resolveWith(e,[r,w,v]):h.rejectWith(e,[v,w,u]),v.statusCode(j),j=b,t&&g.trigger("ajax"+(o?"Success":"Error"),[v,d,o?r:u]),i.fireWith(e,[v,w]),t&&(g.trigger("ajaxComplete",[v,d]),--f.active||f.event.trigger("ajaxStop"))}}typeof a=="object"&&(c=a,a=b),c=c||{};var d=f.ajaxSetup({},c),e=d.context||d,g=e!==d&&(e.nodeType||e instanceof f)?f(e):f.event,h=f.Deferred(),i=f.Callbacks("once memory"),j=d.statusCode||{},k,l={},m={},n,o,p,q,r,s=0,t,u,v={readyState:0,setRequestHeader:function(a,b){if(!s){var c=a.toLowerCase();a=m[c]=m[c]||a,l[a]=b}return this},getAllResponseHeaders:function(){return s===2?n:null},getResponseHeader:function(a){var c;if(s===2){if(!o){o={};while(c=bJ.exec(n))o[c[1].toLowerCase()]=c[2]}c=o[a.toLowerCase()]}return c===b?null:c},overrideMimeType:function(a){s||(d.mimeType=a);return this},abort:function(a){a=a||"abort",p&&p.abort(a),w(0,a);return this}};h.promise(v),v.success=v.done,v.error=v.fail,v.complete=i.add,v.statusCode=function(a){if(a){var b;if(s<2)for(b in a)j[b]=[j[b],a[b]];else b=a[v.status],v.then(b,b)}return this},d.url=((a||d.url)+"").replace(bI,"").replace(bN,bY[1]+"//"),d.dataTypes=f.trim(d.dataType||"*").toLowerCase().split(bR),d.crossDomain==null&&(r=bT.exec(d.url.toLowerCase()),d.crossDomain=!(!r||r[1]==bY[1]&&r[2]==bY[2]&&(r[3]||(r[1]==="http:"?80:443))==(bY[3]||(bY[1]==="http:"?80:443)))),d.data&&d.processData&&typeof d.data!="string"&&(d.data=f.param(d.data,d.traditional)),ca(bV,d,c,v);if(s===2)return!1;t=d.global,d.type=d.type.toUpperCase(),d.hasContent=!bM.test(d.type),t&&f.active++===0&&f.event.trigger("ajaxStart");if(!d.hasContent){d.data&&(d.url+=(bO.test(d.url)?"&":"?")+d.data,delete d.data),k=d.url;if(d.cache===!1){var x=f.now(),y=d.url.replace(bS,"$1_="+x);d.url=y+(y===d.url?(bO.test(d.url)?"&":"?")+"_="+x:"")}}(d.data&&d.hasContent&&d.contentType!==!1||c.contentType)&&v.setRequestHeader("Content-Type",d.contentType),d.ifModified&&(k=k||d.url,f.lastModified[k]&&v.setRequestHeader("If-Modified-Since",f.lastModified[k]),f.etag[k]&&v.setRequestHeader("If-None-Match",f.etag[k])),v.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+(d.dataTypes[0]!=="*"?", "+bZ+"; q=0.01":""):d.accepts["*"]);for(u in d.headers)v.setRequestHeader(u,d.headers[u]);if(d.beforeSend&&(d.beforeSend.call(e,v,d)===!1||s===2)){v.abort();return!1}for(u in{success:1,error:1,complete:1})v[u](d[u]);p=ca(bW,d,c,v);if(!p)w(-1,"No Transport");else{v.readyState=1,t&&g.trigger("ajaxSend",[v,d]),d.async&&d.timeout>0&&(q=setTimeout(function(){v.abort("timeout")},d.timeout));try{s=1,p.send(l,w)}catch(z){s<2?w(-1,z):f.error(z)}}return v},param:function(a,c){var d=[],e=function(a,b){b=f.isFunction(b)?b():b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};c===b&&(c=f.ajaxSettings.traditional);if(f.isArray(a)||a.jquery&&!f.isPlainObject(a))f.each(a,function(){e(this.name,this.value)});else for(var g in a)cc(g,a[g],c,e);return d.join("&").replace(bF,"+")}}),f.extend({active:0,lastModified:{},etag:{}});var cf=f.now(),cg=/(\=)\?(&|$)|\?\?/i;f.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return f.expando+"_"+cf++}}),f.ajaxPrefilter("json jsonp",function(b,c,d){var e=b.contentType==="application/x-www-form-urlencoded"&&typeof b.data=="string";if(b.dataTypes[0]==="jsonp"||b.jsonp!==!1&&(cg.test(b.url)||e&&cg.test(b.data))){var g,h=b.jsonpCallback=f.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,i=a[h],j=b.url,k=b.data,l="$1"+h+"$2";b.jsonp!==!1&&(j=j.replace(cg,l),b.url===j&&(e&&(k=k.replace(cg,l)),b.data===k&&(j+=(/\?/.test(j)?"&":"?")+b.jsonp+"="+h))),b.url=j,b.data=k,a[h]=function(a){g=[a]},d.always(function(){a[h]=i,g&&f.isFunction(i)&&a[h](g[0])}),b.converters["script json"]=function(){g||f.error(h+" was not called");return g[0]},b.dataTypes[0]="json";return"script"}}),f.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(a){f.globalEval(a);return a}}}),f.ajaxPrefilter("script",function(a){a.cache===b&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),f.ajaxTransport("script",function(a){if(a.crossDomain){var d,e=c.head||c.getElementsByTagName("head")[0]||c.documentElement;return{send:function(f,g){d=c.createElement("script"),d.async="async",a.scriptCharset&&(d.charset=a.scriptCharset),d.src=a.url,d.onload=d.onreadystatechange=function(a,c){if(c||!d.readyState||/loaded|complete/.test(d.readyState))d.onload=d.onreadystatechange=null,e&&d.parentNode&&e.removeChild(d),d=b,c||g(200,"success")},e.insertBefore(d,e.firstChild)},abort:function(){d&&d.onload(0,1)}}}});var ch=a.ActiveXObject?function(){for(var a in cj)cj[a](0,1)}:!1,ci=0,cj;f.ajaxSettings.xhr=a.ActiveXObject?function(){return!this.isLocal&&ck()||cl()}:ck,function(a){f.extend(f.support,{ajax:!!a,cors:!!a&&"withCredentials"in a})}(f.ajaxSettings.xhr()),f.support.ajax&&f.ajaxTransport(function(c){if(!c.crossDomain||f.support.cors){var d;return{send:function(e,g){var h=c.xhr(),i,j;c.username?h.open(c.type,c.url,c.async,c.username,c.password):h.open(c.type,c.url,c.async);if(c.xhrFields)for(j in c.xhrFields)h[j]=c.xhrFields[j];c.mimeType&&h.overrideMimeType&&h.overrideMimeType(c.mimeType),!c.crossDomain&&!e["X-Requested-With"]&&(e["X-Requested-With"]="XMLHttpRequest");try{for(j in e)h.setRequestHeader(j,e[j])}catch(k){}h.send(c.hasContent&&c.data||null),d=function(a,e){var j,k,l,m,n;try{if(d&&(e||h.readyState===4)){d=b,i&&(h.onreadystatechange=f.noop,ch&&delete cj[i]);if(e)h.readyState!==4&&h.abort();else{j=h.status,l=h.getAllResponseHeaders(),m={},n=h.responseXML,n&&n.documentElement&&(m.xml=n),m.text=h.responseText;try{k=h.statusText}catch(o){k=""}!j&&c.isLocal&&!c.crossDomain?j=m.text?200:404:j===1223&&(j=204)}}}catch(p){e||g(-1,p)}m&&g(j,k,m,l)},!c.async||h.readyState===4?d():(i=++ci,ch&&(cj||(cj={},f(a).unload(ch)),cj[i]=d),h.onreadystatechange=d)},abort:function(){d&&d(0,1)}}}});var cm={},cn,co,cp=/^(?:toggle|show|hide)$/,cq=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,cr,cs=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]],ct;f.fn.extend({show:function(a,b,c){var d,e;if(a||a===0)return this.animate(cw("show",3),a,b,c);for(var g=0,h=this.length;g<h;g++)d=this[g],d.style&&(e=d.style.display,!f._data(d,"olddisplay")&&e==="none"&&(e=d.style.display=""),e===""&&f.css(d,"display")==="none"&&f._data(d,"olddisplay",cx(d.nodeName)));for(g=0;g<h;g++){d=this[g];if(d.style){e=d.style.display;if(e===""||e==="none")d.style.display=f._data(d,"olddisplay")||""}}return this},hide:function(a,b,c){if(a||a===0)return this.animate(cw("hide",3),a,b,c);var d,e,g=0,h=this.length;for(;g<h;g++)d=this[g],d.style&&(e=f.css(d,"display"),e!=="none"&&!f._data(d,"olddisplay")&&f._data(d,"olddisplay",e));for(g=0;g<h;g++)this[g].style&&(this[g].style.display="none");return this},_toggle:f.fn.toggle,toggle:function(a,b,c){var d=typeof a=="boolean";f.isFunction(a)&&f.isFunction(b)?this._toggle.apply(this,arguments):a==null||d?this.each(function(){var b=d?a:f(this).is(":hidden");f(this)[b?"show":"hide"]()}):this.animate(cw("toggle",3),a,b,c);return this},fadeTo:function(a,b,c,d){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){function g(){e.queue===!1&&f._mark(this);var b=f.extend({},e),c=this.nodeType===1,d=c&&f(this).is(":hidden"),g,h,i,j,k,l,m,n,o;b.animatedProperties={};for(i in a){g=f.camelCase(i),i!==g&&(a[g]=a[i],delete a[i]),h=a[g],f.isArray(h)?(b.animatedProperties[g]=h[1],h=a[g]=h[0]):b.animatedProperties[g]=b.specialEasing&&b.specialEasing[g]||b.easing||"swing";if(h==="hide"&&d||h==="show"&&!d)return b.complete.call(this);c&&(g==="height"||g==="width")&&(b.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY],f.css(this,"display")==="inline"&&f.css(this,"float")==="none"&&(!f.support.inlineBlockNeedsLayout||cx(this.nodeName)==="inline"?this.style.display="inline-block":this.style.zoom=1))}b.overflow!=null&&(this.style.overflow="hidden");for(i in a)j=new f.fx(this,b,i),h=a[i],cp.test(h)?(o=f._data(this,"toggle"+i)||(h==="toggle"?d?"show":"hide":0),o?(f._data(this,"toggle"+i,o==="show"?"hide":"show"),j[o]()):j[h]()):(k=cq.exec(h),l=j.cur(),k?(m=parseFloat(k[2]),n=k[3]||(f.cssNumber[i]?"":"px"),n!=="px"&&(f.style(this,i,(m||1)+n),l=(m||1)/j.cur()*l,f.style(this,i,l+n)),k[1]&&(m=(k[1]==="-="?-1:1)*m+l),j.custom(l,m,n)):j.custom(l,h,""));return!0}var e=f.speed(b,c,d);if(f.isEmptyObject(a))return this.each(e.complete,[!1]);a=f.extend({},a);return e.queue===!1?this.each(g):this.queue(e.queue,g)},stop:function(a,c,d){typeof a!="string"&&(d=c,c=a,a=b),c&&a!==!1&&this.queue(a||"fx",[]);return this.each(function(){function h(a,b,c){var e=b[c];f.removeData(a,c,!0),e.stop(d)}var b,c=!1,e=f.timers,g=f._data(this);d||f._unmark(!0,this);if(a==null)for(b in g)g[b].stop&&b.indexOf(".run")===b.length-4&&h(this,g,b);else g[b=a+".run"]&&g[b].stop&&h(this,g,b);for(b=e.length;b--;)e[b].elem===this&&(a==null||e[b].queue===a)&&(d?e[b](!0):e[b].saveState(),c=!0,e.splice(b,1));(!d||!c)&&f.dequeue(this,a)})}}),f.each({slideDown:cw("show",1),slideUp:cw("hide",1),slideToggle:cw("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){f.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),f.extend({speed:function(a,b,c){var d=a&&typeof a=="object"?f.extend({},a):{complete:c||!c&&b||f.isFunction(a)&&a,duration:a,easing:c&&b||b&&!f.isFunction(b)&&b};d.duration=f.fx.off?0:typeof d.duration=="number"?d.duration:d.duration in f.fx.speeds?f.fx.speeds[d.duration]:f.fx.speeds._default;if(d.queue==null||d.queue===!0)d.queue="fx";d.old=d.complete,d.complete=function(a){f.isFunction(d.old)&&d.old.call(this),d.queue?f.dequeue(this,d.queue):a!==!1&&f._unmark(this)};return d},easing:{linear:function(a,b,c,d){return c+d*a},swing:function(a,b,c,d){return(-Math.cos(a*Math.PI)/2+.5)*d+c}},timers:[],fx:function(a,b,c){this.options=b,this.elem=a,this.prop=c,b.orig=b.orig||{}}}),f.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this),(f.fx.step[this.prop]||f.fx.step._default)(this)},cur:function(){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null))return this.elem[this.prop];var a,b=f.css(this.elem,this.prop);return isNaN(a=parseFloat(b))?!b||b==="auto"?0:b:a},custom:function(a,c,d){function h(a){return e.step(a)}var e=this,g=f.fx;this.startTime=ct||cu(),this.end=c,this.now=this.start=a,this.pos=this.state=0,this.unit=d||this.unit||(f.cssNumber[this.prop]?"":"px"),h.queue=this.options.queue,h.elem=this.elem,h.saveState=function(){e.options.hide&&f._data(e.elem,"fxshow"+e.prop)===b&&f._data(e.elem,"fxshow"+e.prop,e.start)},h()&&f.timers.push(h)&&!cr&&(cr=setInterval(g.tick,g.interval))},show:function(){var a=f._data(this.elem,"fxshow"+this.prop);this.options.orig[this.prop]=a||f.style(this.elem,this.prop),this.options.show=!0,a!==b?this.custom(this.cur(),a):this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur()),f(this.elem).show()},hide:function(){this.options.orig[this.prop]=f._data(this.elem,"fxshow"+this.prop)||f.style(this.elem,this.prop),this.options.hide=!0,this.custom(this.cur(),0)},step:function(a){var b,c,d,e=ct||cu(),g=!0,h=this.elem,i=this.options;if(a||e>=i.duration+this.startTime){this.now=this.end,this.pos=this.state=1,this.update(),i.animatedProperties[this.prop]=!0;for(b in i.animatedProperties)i.animatedProperties[b]!==!0&&(g=!1);if(g){i.overflow!=null&&!f.support.shrinkWrapBlocks&&f.each(["","X","Y"],function(a,b){h.style["overflow"+b]=i.overflow[a]}),i.hide&&f(h).hide();if(i.hide||i.show)for(b in i.animatedProperties)f.style(h,b,i.orig[b]),f.removeData(h,"fxshow"+b,!0),f.removeData(h,"toggle"+b,!0);d=i.complete,d&&(i.complete=!1,d.call(h))}return!1}i.duration==Infinity?this.now=e:(c=e-this.startTime,this.state=c/i.duration,this.pos=f.easing[i.animatedProperties[this.prop]](this.state,c,0,1,i.duration),this.now=this.start+(this.end-this.start)*this.pos),this.update();return!0}},f.extend(f.fx,{tick:function(){var a,b=f.timers,c=0;for(;c<b.length;c++)a=b[c],!a()&&b[c]===a&&b.splice(c--,1);b.length||f.fx.stop()},interval:13,stop:function(){clearInterval(cr),cr=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(a){f.style(a.elem,"opacity",a.now)},_default:function(a){a.elem.style&&a.elem.style[a.prop]!=null?a.elem.style[a.prop]=a.now+a.unit:a.elem[a.prop]=a.now}}}),f.each(["width","height"],function(a,b){f.fx.step[b]=function(a){f.style(a.elem,b,Math.max(0,a.now))}}),f.expr&&f.expr.filters&&(f.expr.filters.animated=function(a){return f.grep(f.timers,function(b){return a===b.elem}).length});var cy=/^t(?:able|d|h)$/i,cz=/^(?:body|html)$/i;"getBoundingClientRect"in c.documentElement?f.fn.offset=function(a){var b=this[0],c;if(a)return this.each(function(b){f.offset.setOffset(this,a,b)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return f.offset.bodyOffset(b);try{c=b.getBoundingClientRect()}catch(d){}var e=b.ownerDocument,g=e.documentElement;if(!c||!f.contains(g,b))return c?{top:c.top,left:c.left}:{top:0,left:0};var h=e.body,i=cA(e),j=g.clientTop||h.clientTop||0,k=g.clientLeft||h.clientLeft||0,l=i.pageYOffset||f.support.boxModel&&g.scrollTop||h.scrollTop,m=i.pageXOffset||f.support.boxModel&&g.scrollLeft||h.scrollLeft,n=c.top+l-j,o=c.left+m-k;return{top:n,left:o}}:f.fn.offset=function(a){var b=this[0];if(a)return this.each(function(b){f.offset.setOffset(this,a,b)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return f.offset.bodyOffset(b);var c,d=b.offsetParent,e=b,g=b.ownerDocument,h=g.documentElement,i=g.body,j=g.defaultView,k=j?j.getComputedStyle(b,null):b.currentStyle,l=b.offsetTop,m=b.offsetLeft;while((b=b.parentNode)&&b!==i&&b!==h){if(f.support.fixedPosition&&k.position==="fixed")break;c=j?j.getComputedStyle(b,null):b.currentStyle,l-=b.scrollTop,m-=b.scrollLeft,b===d&&(l+=b.offsetTop,m+=b.offsetLeft,f.support.doesNotAddBorder&&(!f.support.doesAddBorderForTableAndCells||!cy.test(b.nodeName))&&(l+=parseFloat(c.borderTopWidth)||0,m+=parseFloat(c.borderLeftWidth)||0),e=d,d=b.offsetParent),f.support.subtractsBorderForOverflowNotVisible&&c.overflow!=="visible"&&(l+=parseFloat(c.borderTopWidth)||0,m+=parseFloat(c.borderLeftWidth)||0),k=c}if(k.position==="relative"||k.position==="static")l+=i.offsetTop,m+=i.offsetLeft;f.support.fixedPosition&&k.position==="fixed"&&(l+=Math.max(h.scrollTop,i.scrollTop),m+=Math.max(h.scrollLeft,i.scrollLeft));return{top:l,left:m}},f.offset={bodyOffset:function(a){var b=a.offsetTop,c=a.offsetLeft;f.support.doesNotIncludeMarginInBodyOffset&&(b+=parseFloat(f.css(a,"marginTop"))||0,c+=parseFloat(f.css(a,"marginLeft"))||0);return{top:b,left:c}},setOffset:function(a,b,c){var d=f.css(a,"position");d==="static"&&(a.style.position="relative");var e=f(a),g=e.offset(),h=f.css(a,"top"),i=f.css(a,"left"),j=(d==="absolute"||d==="fixed")&&f.inArray("auto",[h,i])>-1,k={},l={},m,n;j?(l=e.position(),m=l.top,n=l.left):(m=parseFloat(h)||0,n=parseFloat(i)||0),f.isFunction(b)&&(b=b.call(a,c,g)),b.top!=null&&(k.top=b.top-g.top+m),b.left!=null&&(k.left=b.left-g.left+n),"using"in b?b.using.call(a,k):e.css(k)}},f.fn.extend({position:function(){if(!this[0])return null;var a=this[0],b=this.offsetParent(),c=this.offset(),d=cz.test(b[0].nodeName)?{top:0,left:0}:b.offset();c.top-=parseFloat(f.css(a,"marginTop"))||0,c.left-=parseFloat(f.css(a,"marginLeft"))||0,d.top+=parseFloat(f.css(b[0],"borderTopWidth"))||0,d.left+=parseFloat(f.css(b[0],"borderLeftWidth"))||0;return{top:c.top-d.top,left:c.left-d.left}},offsetParent:function(){return this.map(function(){var a=this.offsetParent||c.body;while(a&&!cz.test(a.nodeName)&&f.css(a,"position")==="static")a=a.offsetParent;return a})}}),f.each(["Left","Top"],function(a,c){var d="scroll"+c;f.fn[d]=function(c){var e,g;if(c===b){e=this[0];if(!e)return null;g=cA(e);return g?"pageXOffset"in g?g[a?"pageYOffset":"pageXOffset"]:f.support.boxModel&&g.document.documentElement[d]||g.document.body[d]:e[d]}return this.each(function(){g=cA(this),g?g.scrollTo(a?f(g).scrollLeft():c,a?c:f(g).scrollTop()):this[d]=c})}}),f.each(["Height","Width"],function(a,c){var d=c.toLowerCase();f.fn["inner"+c]=function(){var a=this[0];return a?a.style?parseFloat(f.css(a,d,"padding")):this[d]():null},f.fn["outer"+c]=function(a){var b=this[0];return b?b.style?parseFloat(f.css(b,d,a?"margin":"border")):this[d]():null},f.fn[d]=function(a){var e=this[0];if(!e)return a==null?null:this;if(f.isFunction(a))return this.each(function(b){var c=f(this);c[d](a.call(this,b,c[d]()))});if(f.isWindow(e)){var g=e.document.documentElement["client"+c],h=e.document.body;return e.document.compatMode==="CSS1Compat"&&g||h&&h["client"+c]||g}if(e.nodeType===9)return Math.max(e.documentElement["client"+c],e.body["scroll"+c],e.documentElement["scroll"+c],e.body["offset"+c],e.documentElement["offset"+c]);if(a===b){var i=f.css(e,d),j=parseFloat(i);return f.isNumeric(j)?j:i}return this.css(d,typeof a=="string"?a:a+"px")}}),a.jQuery=a.$=f})(window);
\ No newline at end of file
diff -ruN phpBB-3.0.10/mobiquo/tapatalkdetect/jquery.purr.js phpbb/mobiquo/tapatalkdetect/jquery.purr.js
--- phpBB-3.0.10/mobiquo/tapatalkdetect/jquery.purr.js	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/tapatalkdetect/jquery.purr.js	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,180 @@
+/**
+ * jquery.purr.js
+ * Copyright (c) 2008 Net Perspective (net-perspective.com)
+ * Licensed under the MIT License (http://www.opensource.org/licenses/mit-license.php)
+ * 
+ * @author R.A. Ray
+ * @projectDescription	jQuery plugin for dynamically displaying unobtrusive messages in the browser. Mimics the behavior of the MacOS program "Growl."
+ * @version 0.1.0
+ * 
+ * @requires jquery.js (tested with 1.2.6)
+ * 
+ * @param fadeInSpeed 					int - Duration of fade in animation in miliseconds
+ * 													default: 500
+ *	@param fadeOutSpeed  				int - Duration of fade out animationin miliseconds
+ 														default: 500
+ *	@param removeTimer  				int - Timeout, in miliseconds, before notice is removed once it is the top non-sticky notice in the list
+ 														default: 4000
+ *	@param isSticky 						bool - Whether the notice should fade out on its own or wait to be manually closed
+ 														default: false
+ *	@param usingTransparentPNG 	bool - Whether or not the notice is using transparent .png images in its styling
+ 														default: false
+ */
+
+( function( $ ) {
+	
+	$.purr = function ( notice, options )
+	{ 
+		// Convert notice to a jQuery object
+		notice = $( notice );
+		
+		// Add a class to denote the notice as not sticky
+		if ( !options.isSticky )
+		{
+			notice.addClass( 'not-sticky' );
+		};
+		
+		// Get the container element from the page
+		var cont = document.getElementById( 'purr-container' );
+		
+		// If the container doesn't yet exist, we need to create it
+		if ( !cont )
+		{
+			cont = '<div id="purr-container"></div>';
+		}
+		
+		// Convert cont to a jQuery object
+		cont = $( cont );
+		
+		// Add the container to the page
+		$( 'body' ).append( cont );
+			
+		notify();
+
+		function notify ()
+		{	
+			// Set up the close button
+			var close = document.createElement( 'a' );
+			$( close ).attr(	
+				{
+					className: 'close',
+					href: '#close',
+					innerHTML: 'Close'
+				}
+			)
+				.appendTo( notice )
+					.click( function ()
+						{
+							removeNotice();
+							
+							return false;
+						}
+					);
+			
+			// Add the notice to the page and keep it hidden initially
+			notice.appendTo( cont )
+				.hide();
+				
+			if ( jQuery.browser.msie && options.usingTransparentPNG )
+			{
+				// IE7 and earlier can't handle the combination of opacity and transparent pngs, so if we're using transparent pngs in our
+				// notice style, we'll just skip the fading in.
+				notice.show();
+			}
+			else
+			{
+				//Fade in the notice we just added
+				notice.fadeIn( options.fadeInSpeed );
+			}
+			
+			// Set up the removal interval for the added notice if that notice is not a sticky
+			if ( !options.isSticky )
+			{
+				var topSpotInt = setInterval( function ()
+				{
+					// Check to see if our notice is the first non-sticky notice in the list
+					if ( notice.prevAll( '.not-sticky' ).length == 0 )
+					{ 
+						// Stop checking once the condition is met
+						clearInterval( topSpotInt );
+						
+						// Call the close action after the timeout set in options
+						setTimeout( function ()
+							{
+								removeNotice();
+							}, options.removeTimer
+						);
+					}
+				}, 200 );	
+			}
+		}
+
+		function removeNotice ()
+		{
+			// IE7 and earlier can't handle the combination of opacity and transparent pngs, so if we're using transparent pngs in our
+			// notice style, we'll just skip the fading out.
+			if ( jQuery.browser.msie && options.usingTransparentPNG )
+			{
+				notice.css( { opacity: 0	} )
+					.animate( 
+						{ 
+							height: '0px' 
+						}, 
+						{ 
+							duration: options.fadeOutSpeed, 
+							complete:  function ()
+								{
+									notice.remove();
+								} 
+							} 
+					);
+			}
+			else
+			{
+				// Fade the object out before reducing its height to produce the sliding effect
+				notice.animate( 
+					{ 
+						opacity: '0'
+					}, 
+					{ 
+						duration: options.fadeOutSpeed, 
+						complete: function () 
+							{
+								notice.animate(
+									{
+										height: '0px'
+									},
+									{
+										duration: options.fadeOutSpeed,
+										complete: function ()
+											{
+												notice.remove();
+											}
+									}
+								);
+							}
+					} 
+				);
+			}
+		};
+	};
+	
+	$.fn.purr = function ( options )
+	{
+		options = options || {};
+		options.fadeInSpeed = options.fadeInSpeed || 500;
+		options.fadeOutSpeed = options.fadeOutSpeed || 500;
+		options.removeTimer = options.removeTimer || 4000;
+		options.isSticky = options.isSticky || false;
+		options.usingTransparentPNG = options.usingTransparentPNG || false;
+		
+		this.each( function() 
+			{
+				new $.purr( this, options );
+			}
+		);
+		
+		return this;
+	};
+})( jQuery );
+
diff -ruN phpBB-3.0.10/mobiquo/tapatalkdetect/notice.css phpbb/mobiquo/tapatalkdetect/notice.css
--- phpBB-3.0.10/mobiquo/tapatalkdetect/notice.css	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/tapatalkdetect/notice.css	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,42 @@
+
+		
+		#purr-container {
+			position: fixed;
+			bottom: 0;
+			right: 0;
+			z-index:2147483647;
+		}
+		
+		.notice {
+			position: relative;
+			width: 324px;
+		}
+		.notice .close	{position: absolute; top: 10px; right: 10px; display: block; width: 9px; height: 9px; text-indent: -9999px; background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAJCAIAAABv85FHAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABwSURBVBhXdY+hEQUhEEO3QfqgGCqgATwejcUikTg6uHtMGL75F5XdN8mCPd8ykPfezHLO+N47Hq21Nosxaq61yrBhv9mNClBD6MfmnAKotabAyd1a4THGYSklrXhICEF+N91jpRQ8l5xzMMbT+feTLxIJmEqZD7LgAAAAAElFTkSuQmCC) no-repeat;}
+		
+		.notice-body {
+			font-family: Arial;
+			/*margin-bottom:1px;
+			margin-right:1px;*/
+			min-height: 25px;
+			padding: 5px 5px 5px 20px;
+			background:#F9F9Cc;
+			/*xbackground: url(./purr-example/purrTop.png) no-repeat left top;*/
+			color: #000;
+			border:1px solid #ccc;
+			/*-moz-box-shadow: 5px 5px 2px #888;
+			-webkit-box-shadow: 5px 5px 2px #888;
+			box-shadow: 5px 5px 2px #888;*/
+			
+		}
+				.notice-body p		{margin: 5px 30px 0 0; font-size: 13px; line-height: 1.4em;}
+		
+			.notice-body a:link {
+			color:blue;
+			}
+			
+			
+			
+		.notice-bottom {
+			height: 22px;
+			background: url(./purr-example/purrBottom.png) no-repeat left top;
+		}
diff -ruN phpBB-3.0.10/mobiquo/tapatalkdetect.js phpbb/mobiquo/tapatalkdetect.js
--- phpBB-3.0.10/mobiquo/tapatalkdetect.js	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/tapatalkdetect.js	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,80 @@
+function detectTapatalk() {
+	if (document.cookie.indexOf("tapatalk_redirect4=false") < 0) {
+		if (!navigator.userAgent.match(/Opera/i)) {
+
+			if ((navigator.userAgent.match(/iPhone/i)) || (navigator.userAgent.match(/iPod/i))) {
+				setTapatalkCookies();
+				if (confirm("This forum has an app for iPhone and iPod Touch! Click OK to learn more about Tapatalk."))
+					window.location = "http://itunes.apple.com/us/app/tapatalk-forum-app/id307880732?mt=8";
+			} else if(navigator.userAgent.match(/iPad/i)) {
+				setTapatalkCookies();
+				if (confirm("This forum has an app for iPad! Click OK to learn more about Tapatalk."))
+					window.location = "http://itunes.apple.com/us/app/tapatalk-hd-for-ipad/id481579541?mt=8";
+			} else if(navigator.userAgent.match(/Kindle Fire/i)) {
+				setTapatalkCookies();
+				if (confirm("This forum has an app for Kindle Fire! Click OK to learn more about Tapatalk."))
+					window.location = "http://www.amazon.com/gp/mas/dl/android?p=com.quoord.tapatalkpro.activity";
+			} else if(navigator.userAgent.match(/Android/i)) {
+				setTapatalkCookies();
+				if (confirm("This forum has an app for Android. Click OK to learn more about Tapatalk."))
+					window.location = "market://details?id=com.quoord.tapatalkpro.activity";
+			} else if(navigator.userAgent.match(/BlackBerry/i)) {
+				setTapatalkCookies();
+				if (confirm("This forum has an app for BlackBerry! Click OK to learn more about Tapatalk."))	  
+					window.location = "http://appworld.blackberry.com/webstore/content/46654?lang=en";
+			} else if(window.chrome) {
+				setTapatalkCookies();
+				var script1 = document.createElement('script');
+				var script2;
+				script1.setAttribute('src','mobiquo/tapatalkdetect/jquery-1.7.min.js');
+				script1.setAttribute('type','text/javascript');
+				var loaded=false;
+				var loaded2=false;
+				var loaded3=false;
+				var loadFunction3 = function() {
+					var notice = '<div class="notice">'
+						+ '<div class="notice-body">' 
+						+ '<p>Download <a href="https://chrome.google.com/webstore/detail/plfhcjljnfjpfcbjpgnflfofmahljkjj" target="_new">Tapatalk Notifier</a> for Chrome to keep notified of new Private Messages from this forum. <br /></p>'
+						+ '</div>'
+						+ '</div>';
+					$( notice ).purr(
+						{
+							usingTransparentPNG: true,
+							removeTimer:12000
+						}
+					);	
+				}
+
+				var loadFunction = function() {
+
+					var script2=document.createElement("link");
+					script2.setAttribute("rel", "stylesheet");
+					script2.setAttribute("type", "text/css");
+					script2.setAttribute("href", 'mobiquo/tapatalkdetect/notice.css');
+					script2.media='screen';
+ 
+					document.getElementsByTagName("head")[0].appendChild(script2);
+					var script3 = document.createElement('script');
+					script3.setAttribute('src','mobiquo/tapatalkdetect/jquery.purr.js');
+					script3.setAttribute('type','text/javascript');
+					script3.onload=loadFunction3;
+					document.getElementsByTagName("head")[0].appendChild(script3);
+
+				};
+				script1.onload = loadFunction;
+				document.getElementsByTagName("head")[0].appendChild(script1);
+			}
+        }
+    }
+}
+
+function setTapatalkCookies() {
+	var date = new Date();
+	var days = 90;
+	date.setTime(date.getTime()+(days*24*60*60*1000));
+	var expires = "; expires="+ date.toGMTString();
+	var domain = "; path=/";
+	document.cookie = "tapatalk_redirect4=false" + expires + domain; 
+}
+
+detectTapatalk();
\ No newline at end of file
diff -ruN phpBB-3.0.10/mobiquo/tapatalkdetect-nochrome.js phpbb/mobiquo/tapatalkdetect-nochrome.js
--- phpBB-3.0.10/mobiquo/tapatalkdetect-nochrome.js	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/tapatalkdetect-nochrome.js	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,40 @@
+function detectTapatalk() {
+	if (document.cookie.indexOf("tapatalk_redirect4=false") < 0) {
+	
+		if (!navigator.userAgent.match(/Opera/i)) {
+
+			if ((navigator.userAgent.match(/iPhone/i)) || (navigator.userAgent.match(/iPod/i))) {
+				setTapatalkCookies();
+				if (confirm("This forum has an app for iPhone and iPod Touch! Click OK to learn more about Tapatalk."))
+					window.location = "http://itunes.apple.com/us/app/tapatalk-forum-app/id307880732?mt=8";
+			} else if(navigator.userAgent.match(/iPad/i)) {
+				setTapatalkCookies();
+				if (confirm("This forum has an app for iPad! Click OK to learn more about Tapatalk."))
+					window.location = "http://itunes.apple.com/us/app/tapatalk-hd-for-ipad/id481579541?mt=8";
+			} else if(navigator.userAgent.match(/Kindle Fire/i)) {
+				setTapatalkCookies();
+				if (confirm("This forum has an app for Kindle Fire! Click OK to learn more about Tapatalk."))
+					window.location = "http://www.amazon.com/gp/mas/dl/android?p=com.quoord.tapatalkpro.activity";
+			} else if(navigator.userAgent.match(/Android/i)) {
+				setTapatalkCookies();
+				if (confirm("This forum has an app for Android. Click OK to learn more about Tapatalk."))
+					window.location = "market://details?id=com.quoord.tapatalkpro.activity";
+			} else if(navigator.userAgent.match(/BlackBerry/i)) {
+				setTapatalkCookies();
+				if (confirm("This forum has an app for BlackBerry! Click OK to learn more about Tapatalk."))	  
+					window.location = "http://appworld.blackberry.com/webstore/content/46654?lang=en";
+			}
+		}
+	}
+}
+
+function setTapatalkCookies() {
+	var date = new Date();
+	var days = 90;
+	date.setTime(date.getTime()+(days*24*60*60*1000));
+	var expires = "; expires="+ date.toGMTString();
+	var domain = "; path=/";
+	document.cookie = "tapatalk_redirect4=false" + expires + domain; 
+}
+
+detectTapatalk();
\ No newline at end of file
diff -ruN phpBB-3.0.10/mobiquo/upload.php phpbb/mobiquo/upload.php
--- phpBB-3.0.10/mobiquo/upload.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/upload.php	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,139 @@
+<?php
+/**
+*
+* @copyright (c) 2009, 2010, 2011 Quoord Systems Limited
+* @license http://opensource.org/licenses/gpl-2.0.php GNU Public License (GPLv2)
+*
+*/
+
+define('IN_PHPBB', true);
+define('IN_MOBIQUO', true);
+define('MOBIQUO_DEBUG', 0);
+
+include('./config/config.php');
+include($phpbb_root_path . 'common.' . $phpEx);
+require('./mobiquo_common.php');
+
+include('./include/xmlrpc.inc');
+include('./include/xmlrpcs.inc');
+
+error_reporting(MOBIQUO_DEBUG);
+set_error_handler('xmlrpc_error_handler');
+
+if ($_POST['method_name'] == 'upload_attach')
+{
+    include($phpbb_root_path . 'includes/functions_posting.' . $phpEx);
+    include($phpbb_root_path . 'includes/message_parser.' . $phpEx);
+    
+    // Start session management
+    $user->session_begin();
+    $auth->acl($user->data);
+    $user->setup('posting');
+    header('Mobiquo_is_login:'.($user->data['is_registered'] ? 'true' : 'false'));
+    
+    if (!$user->data['is_registered']) trigger_error('LOGIN_EXPLAIN_POST');
+    
+    $forum_id = request_var('forum_id', 0);
+    $_POST['attachment_data'] = $_POST['group_id'] ? unserialize(base64_decode($_POST['group_id'])) : array();
+    $new_attach_position = count($_POST['attachment_data']);
+    
+    // Forum does not exist
+    if (!$forum_id) trigger_error('NO_FORUM');
+    
+    $sql = "SELECT f.* FROM " . FORUMS_TABLE . " f WHERE f.forum_id = $forum_id";
+    $result = $db->sql_query($sql);
+    $forum_data = $db->sql_fetchrow($result);
+    $db->sql_freeresult($result);
+    
+    if (!$forum_data) trigger_error('NO_FORUM');
+    if ($forum_data['forum_type'] != FORUM_POST) trigger_error('USER_CANNOT_FORUM_POST');
+    if (!$auth->acl_gets('f_read', $forum_id)) trigger_error('USER_CANNOT_READ');
+    if ($forum_data['forum_password'] && !check_forum_password($forum_id)) trigger_error('LOGIN_FORUM');
+    if (($user->data['is_bot'] || !$auth->acl_get('f_attach', $forum_id) || !$auth->acl_get('u_attach') || !$config['allow_attachments'] || @ini_get('file_uploads') == '0' || strtolower(@ini_get('file_uploads')) == 'off'))
+        trigger_error('NOT_AUTHORISED');
+    
+    if ((!$auth->acl_get('f_post', $forum_id) && !$auth->acl_gets('f_edit', 'm_edit', $forum_id) && !$auth->acl_get('f_reply', $forum_id)))
+        trigger_error('USER_CANNOT_POST');
+    
+    $_POST['add_file'] = 'Add the file';
+    
+    $message_parser = new parse_message();
+    $message_parser->get_submitted_attachment_data();
+    $message_parser->parse_attachments('fileupload', 'post', $forum_id, false, false, true);
+    $attachment_id = isset($message_parser->attachment_data[$new_attach_position]) ? $message_parser->attachment_data[0]['attach_id'] : '';
+    $group_id = base64_encode(serialize($message_parser->attachment_data));
+    $warn_msg = join("\n", $message_parser->warn_msg);
+} elseif ($_POST['method_name'] == 'upload_avatar')
+{
+    require($phpbb_root_path . 'includes/functions_user.' . $phpEx);
+    
+    $user->session_begin();
+    $auth->acl($user->data);
+    $user->setup('ucp');
+    $user->add_lang('posting');
+    header('Mobiquo_is_login:'.($user->data['is_registered'] ? 'true' : 'false'));
+    
+    $status = true;
+    $error = array();
+    if (!$user->data['is_registered']) {
+        trigger_error('LOGIN_EXPLAIN_POST');
+    } else {
+        include($phpbb_root_path . 'includes/functions_display.' . $phpEx);
+        
+        if (!avatar_process_user($error))
+        {
+            $status = false;
+            // Replace "error" strings with their real, localised form
+            $error = preg_replace('#^([A-Z_]+)$#e', "(!empty(\$user->lang['\\1'])) ? \$user->lang['\\1'] : '\\1'", $error);
+    
+            if (!$config['allow_avatar'] && $user->data['user_avatar_type'])
+            {
+                $error[] = $user->lang['AVATAR_NOT_ALLOWED'];
+            }
+            else if ((($user->data['user_avatar_type'] == AVATAR_UPLOAD) && !$config['allow_avatar_upload']) ||
+             (($user->data['user_avatar_type'] == AVATAR_REMOTE) && !$config['allow_avatar_remote']) ||
+             (($user->data['user_avatar_type'] == AVATAR_GALLERY) && !$config['allow_avatar_local']))
+            {
+                $error[] = $user->lang['AVATAR_TYPE_NOT_ALLOWED'];
+            }
+        }
+    }
+    $warn_msg = strip_tags(join("\n", $error));
+}
+
+require('./server_define.php');
+
+$rpcServer = new xmlrpc_server($server_param, false);
+$rpcServer->setDebug(1);
+$rpcServer->compress_response = 'true';
+$rpcServer->response_charset_encoding = 'UTF-8';
+$raw_data = '<?xml version="1.0"?><methodCall><methodName>' . $_POST['method_name'] . '</methodName><params></params></methodCall>';
+$response = $rpcServer->service($raw_data);
+
+
+
+function upload_attach_func() {
+    global $attachment_id, $group_id, $warn_msg;
+    
+    $xmlrpc_result = new xmlrpcval(array(
+        'attachment_id' => new xmlrpcval($attachment_id),
+        'group_id'      => new xmlrpcval($group_id),
+        'result'        => new xmlrpcval($attachment_id ? true : false, 'boolean'),
+        'result_text'   => new xmlrpcval(strip_tags($warn_msg), 'base64'),
+    ), 'struct');
+    
+    return new xmlrpcresp($xmlrpc_result);
+}
+
+function upload_avatar_func() {
+    global $status, $warn_msg;
+    
+    $xmlrpc_result = new xmlrpcval(array(
+        'result'        => new xmlrpcval($status, 'boolean'),
+        'result_text'   => new xmlrpcval($warn_msg, 'base64'),
+    ), 'struct');
+    
+    return new xmlrpcresp($xmlrpc_result);
+}
+
+exit;
\ No newline at end of file
diff -ruN phpBB-3.0.10/mobiquo/VERSION.txt phpbb/mobiquo/VERSION.txt
--- phpBB-3.0.10/mobiquo/VERSION.txt	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/VERSION.txt	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,2 @@
+3.3.1
+http://www.tapatalk.com/files/plugin/mobiquo_pb30_3_3_1.zip
diff -ruN phpBB-3.0.10/mobiquo/xmlrpcresp.php phpbb/mobiquo/xmlrpcresp.php
--- phpBB-3.0.10/mobiquo/xmlrpcresp.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/mobiquo/xmlrpcresp.php	2014-04-06 06:50:23.000000000 +0200
@@ -0,0 +1,318 @@
+<?php
+/**
+*
+* @copyright (c) 2009, 2010, 2011 Quoord Systems Limited
+* @license http://opensource.org/licenses/gpl-2.0.php GNU Public License (GPLv2)
+*
+*/
+
+defined('IN_MOBIQUO') or exit;
+
+function get_thread_func()
+{
+    global $template, $user, $auth, $phpbb_home, $config, $attachment_by_id, $forum_id, $topic_id, $support_post_thanks, $topic_data, $total_posts, $can_subscribe;
+    
+    $post_list = array();
+    foreach($template->_tpldata['postrow'] as $row)
+    {
+        $attachments = array();
+        if ($row['S_HAS_ATTACHMENTS'])
+        {
+            foreach($row['attachment'] as $attachment)
+            {
+                if(preg_match('/<img src=\".*?\/(download\/file\.php\?id=(\d+).*?)\"/is', $attachment['DISPLAY_ATTACHMENT'], $matches))
+                {
+                    $attach_id = $matches[2];
+
+                    $file_url = basic_clean($phpbb_home.$matches[1]);
+                    $thumbnail_url = '';
+
+                    if ($config['img_create_thumbnail'] && $attachment_by_id[$attach_id]['thumbnail_orig'])
+                    {
+                        $thumbnail_url = preg_replace('/file\.php\?/is', 'file.php?t=1&', $file_url);
+                    }
+
+                    unset($matches);
+
+                    if (strpos($attachment_by_id[$attach_id]['mimetype'], 'image') === 0)
+                        $content_type = 'image';
+                    else
+                        $content_type = $attachment_by_id[$attach_id]['extension'];
+
+                    $xmlrpc_attachment = new xmlrpcval(array(
+                        'filename'      => new xmlrpcval($attachment_by_id[$attach_id]['real_filename'], 'base64'),
+                        'filesize'      => new xmlrpcval($attachment_by_id[$attach_id]['filesize'], 'int'),
+                        'content_type'  => new xmlrpcval($content_type),
+                        'thumbnail_url' => new xmlrpcval($thumbnail_url),
+                        'url'           => new xmlrpcval($file_url)
+                    ), 'struct');
+                    $attachments[] = $xmlrpc_attachment;
+                }
+            }
+        }
+
+        if ($row['S_IGNORE_POST'])
+        {
+            $row['MESSAGE'] = '[color=Gray]' . $row['L_IGNORE_POST'] . '[/color]' . "[spoiler]{$row[MESSAGE]}[/spoiler]";
+        }
+
+        $can_ban_user = $auth->acl_get('m_ban') && $row['POSTER_ID'] != $user->data['user_id'];
+
+        $xmlrpc_post = array(
+            'topic_id'          => new xmlrpcval($topic_id),
+            'post_id'           => new xmlrpcval($row['POST_ID']),
+            'post_title'        => new xmlrpcval(basic_clean($row['POST_SUBJECT']), 'base64'),
+            'post_content'      => new xmlrpcval(post_html_clean($row['MESSAGE']), 'base64'),
+            'post_author_id'    => new xmlrpcval($row['POSTER_ID']),
+            'post_author_name'  => new xmlrpcval(basic_clean($row['POST_AUTHOR']), 'base64'),
+            'icon_url'          => new xmlrpcval($row['POSTER_AVATAR']),
+            'post_time'         => new xmlrpcval($row['POST_DATE'], 'dateTime.iso8601'),
+            'timestamp'         => new xmlrpcval($row['POST_TIMESTAMP'], 'string'),
+            'attachments'       => new xmlrpcval($attachments, 'array'),
+            'is_online'         => new xmlrpcval($row['S_ONLINE'], 'boolean'),
+            'can_edit'          => new xmlrpcval($row['U_EDIT'], 'boolean'),
+            'can_delete'        => new xmlrpcval($row['U_DELETE'], 'boolean'),
+            'can_approve'       => new xmlrpcval($auth->acl_get('m_approve', $forum_id) && !$row['post_approved'], 'boolean'),
+            'is_approved'       => new xmlrpcval($row['post_approved'] ? true : false, 'boolean'),
+            'can_move'          => new xmlrpcval($auth->acl_get('m_split', $forum_id), 'boolean'),
+            'can_ban'           => new xmlrpcval($can_ban_user, 'boolean'),
+            'allow_smilies'     => new xmlrpcval($row['enable_smilies'] ? true : false, 'boolean'),
+        );
+
+        if ($support_post_thanks)
+        {
+            if ((!$row['S_FIRST_POST_ONLY'] || (!$start && $row['S_ROW_COUNT']))
+                && !$row['S_GLOBAL_POST_THANKS']
+                && !$row['S_POST_ANONYMOUS']
+                && $auth->acl_get('f_thanks', $forum_id)
+                && $user->data['user_id'] != ANONYMOUS
+                && $user->data['user_id'] != $row['POSTER_ID']
+                && !$row['S_ALREADY_THANKED']
+            ) {
+                $xmlrpc_post['can_thank'] = new xmlrpcval(true, 'boolean');
+            }
+
+            if ($row['THANKS'] && $row['THANKS_POSTLIST_VIEW'] && !$row['S_POST_ANONYMOUS'] && empty($user->data['is_bot']))
+            {
+                global $thankers;
+
+                $count = 0;
+                $thank_list = array();
+                $maxcount = isset($config['thanks_number_post']) ? $config['thanks_number_post'] : (
+                            isset($config['thanks_number']) ? $config['thanks_number'] : 10);
+                foreach($thankers as $thanker)
+                {
+                    if ($count >= $maxcount) break;
+
+                    if ($thanker['post_id'] == $row['POST_ID'])
+                    {
+                        $thank_list[] = new xmlrpcval(array(
+                            'userid'    => new xmlrpcval($thanker['user_id'], 'string'),
+                            'username'  => new xmlrpcval(basic_clean($thanker['username']), 'base64'),
+                        ), 'struct');
+
+                        $count++;
+                    }
+                }
+
+                if (!empty($thank_list))
+                    $xmlrpc_post['thanks_info'] = new xmlrpcval($thank_list, 'array');
+            }
+        }
+
+        $post_list[] = new xmlrpcval($xmlrpc_post, 'struct');
+    }
+    
+    $allow_change_type = ($auth->acl_get('m_', $forum_id) || ($user->data['is_registered'] && $user->data['user_id'] == $topic_data['topic_poster'])) ? true : false;
+    $allowed = $config['max_attachments'] && $auth->acl_get('f_attach', $forum_id) && $auth->acl_get('u_attach') && $config['allow_attachments'] && @ini_get('file_uploads') != '0' && strtolower(@ini_get('file_uploads')) != 'off';
+    $max_attachment = ($auth->acl_get('a_') || $auth->acl_get('m_', $forum_id)) ? 99 : ($allowed ? $config['max_attachments'] : 0);
+    $max_png_size = ($auth->acl_get('a_') || $auth->acl_get('m_', $forum_id)) ? 10485760 : ($allowed ? ($config['max_filesize'] === '0' ? 10485760 : $config['max_filesize']) : 0);
+    $max_jpg_size = ($auth->acl_get('a_') || $auth->acl_get('m_', $forum_id)) ? 10485760 : ($allowed ? ($config['max_filesize'] === '0' ? 10485760 : $config['max_filesize']) : 0);
+    
+    $result = array(
+        'total_post_num' => new xmlrpcval($total_posts, 'int'),
+        'forum_id'       => new xmlrpcval($forum_id),
+        'forum_name'     => new xmlrpcval(basic_clean($topic_data['forum_name']), 'base64'),
+        'topic_id'       => new xmlrpcval($topic_id),
+        'topic_title'    => new xmlrpcval(basic_clean(censor_text($topic_data['topic_title'])), 'base64'),
+        'position'       => new xmlrpcval($topic_data['prev_posts'] + 1, 'int'),
+
+        'can_reply'      => new xmlrpcval($auth->acl_get('f_reply', $forum_id) && $topic_data['forum_status'] != ITEM_LOCKED && $topic_data['topic_status'] != ITEM_LOCKED, 'boolean'),
+        'can_upload'     => new xmlrpcval($allowed, 'boolean'),
+        'can_delete'     => new xmlrpcval($auth->acl_get('m_delete', $forum_id), 'boolean'),
+        'can_move'       => new xmlrpcval($auth->acl_get('m_move', $forum_id), 'boolean'),
+        'can_subscribe'  => new xmlrpcval($can_subscribe, 'boolean'),
+        'is_subscribed'  => new xmlrpcval(isset($topic_data['notify_status']) && !is_null($topic_data['notify_status']) && $topic_data['notify_status'] !== '' ? true : false, 'boolean'),
+        'can_stick'      => new xmlrpcval($allow_change_type && $auth->acl_get('f_sticky', $forum_id), 'boolean'),
+        'is_sticky'      => new xmlrpcval($topic_data['topic_type'] == POST_STICKY, 'boolean'),
+        'can_close'      => new xmlrpcval($auth->acl_get('m_lock', $forum_id) || ($auth->acl_get('f_user_lock', $forum_id) && $user->data['is_registered'] && $user->data['user_id'] == $topic_data['topic_poster']), 'boolean'),
+        'is_closed'      => new xmlrpcval($topic_data['topic_status'] == ITEM_LOCKED, 'boolean'),
+        'can_approve'    => new xmlrpcval($auth->acl_get('m_approve', $forum_id) && !$topic_data['topic_approved'], 'boolean'),
+        'is_approved'    => new xmlrpcval($topic_data['topic_approved'] ? true : false, 'boolean'),
+
+        'max_attachment' => new xmlrpcval($max_attachment, 'int'),
+        'max_png_size'   => new xmlrpcval($max_png_size, 'int'),
+        'max_jpg_size'   => new xmlrpcval($max_jpg_size, 'int'),
+
+        'posts'          => new xmlrpcval($post_list, 'array'),
+    );
+    
+    
+    
+    return new xmlrpcresp(new xmlrpcval($result, 'struct'));
+}
+
+function search_func()
+{
+    global $db, $template, $user, $auth, $config, $can_subscribe, $show_results, $include_topic_num, $total_match_count;
+    
+    $topic_list = $subscribed_tids = array();
+    
+    if($show_results == 'topics' && $user->data['user_id'])
+    {
+        $sql = 'SELECT topic_id
+            FROM ' . TOPICS_WATCH_TABLE . '
+            WHERE user_id = ' . $user->data['user_id'];
+        $result = $db->sql_query($sql);
+        
+        while ($row = $db->sql_fetchrow($result))
+        {
+            $subscribed_tids[] = (int) $row['topic_id'];
+        }
+        $db->sql_freeresult($result);
+    }
+    
+    foreach($template->_tpldata['searchresults'] as $item)
+    {
+        $forum_id = $item['FORUM_ID'];
+        
+        if($show_results == 'topics')
+        {
+            $lastpost = $item['lastpost'];
+            $isbanned = $lastpost['isbanned'];
+            
+            $return_item = array(
+                'forum_id'              => new xmlrpcval($item['FORUM_ID'], 'string'),
+                'forum_name'            => new xmlrpcval(basic_clean($item['FORUM_TITLE']), 'base64'),
+                'topic_id'              => new xmlrpcval($item['TOPIC_ID'], 'string'),
+                'topic_title'           => new xmlrpcval(basic_clean($item['TOPIC_TITLE']), 'base64'),
+                
+                'post_author_id'        => new xmlrpcval($item['LAST_POSTER_ID'], 'string'),
+                'post_author_name'      => new xmlrpcval(basic_clean($item['LAST_POST_AUTHOR']), 'base64'),
+                'post_time'             => new xmlrpcval($item['LAST_POST_TIME'], 'dateTime.iso8601'),
+                'timestamp'             => new xmlrpcval($item['LAST_POST_TIMESTAMP'], 'string'),
+                'icon_url'              => new xmlrpcval($item['LAST_POSTER_AVATAR'], 'string'),
+                'short_content'         => new xmlrpcval(basic_clean($item['LAST_POST_PREV']), 'base64'),
+                
+                // compatibility data
+                'last_reply_author_id'  => new xmlrpcval($item['LAST_POSTER_ID'], 'string'),
+              'last_reply_author_name'  => new xmlrpcval(basic_clean($item['LAST_POST_AUTHOR']), 'base64'),
+                'last_reply_time'       => new xmlrpcval($item['LAST_POST_TIME'], 'dateTime.iso8601'),
+                
+                'reply_number'          => new xmlrpcval($item['TOPIC_REPLIES'], 'int'),
+                'view_number'           => new xmlrpcval($item['TOPIC_VIEWS'], 'int'),
+                'can_subscribe'         => new xmlrpcval($can_subscribe, 'boolean'),
+                'is_approved'           => new xmlrpcval(!$item['S_TOPIC_UNAPPROVED'], 'boolean'),
+            );
+            
+            $allow_change_type = ($auth->acl_get('m_', $forum_id) || ($user->data['is_registered'] && $user->data['user_id'] == $topic_data['topic_poster']));
+            $can_close  = $auth->acl_get('m_lock', $forum_id) || ($auth->acl_get('f_user_lock', $forum_id) && $user->data['is_registered'] && $user->data['user_id'] == $item['TOPIC_AUTHOR_ID']);
+            $can_delete = $auth->acl_get('m_delete', $forum_id);
+            $can_stick  = $allow_change_type && $auth->acl_get('f_sticky', $forum_id);
+            $can_move   = $auth->acl_get('m_move', $forum_id);
+            $can_approve= $auth->acl_get('m_approve', $forum_id) && $item['S_TOPIC_UNAPPROVED'];
+            $can_ban    = $auth->acl_get('m_ban') && $item['LAST_POSTER_ID'] != $user->data['user_id'];
+            $can_rename = ($user->data['is_registered'] && ($auth->acl_get('m_edit', $forum_id) || (
+                $user->data['user_id'] == $item['TOPIC_AUTHOR_ID'] &&
+                $auth->acl_get('f_edit', $forum_id) &&
+                //!$item['post_edit_locked'] &&
+                ($item['FIRST_POST_TIMESTAMP'] > time() - ($config['edit_time'] * 60) || !$config['edit_time'])
+            )));
+            
+            $can_subscribe = ($config['email_enable'] || $config['jab_enable']) && $config['allow_topic_notify'] && $user->data['is_registered'];
+            $is_subscribed = in_array($item['TOPIC_ID'], $subscribed_tids);
+            
+            if ($can_close)     $return_item['can_close']     = new xmlrpcval(true, 'boolean');
+            if ($can_delete)    $return_item['can_delete']    = new xmlrpcval(true, 'boolean');
+            if ($can_stick)     $return_item['can_stick']     = new xmlrpcval(true, 'boolean');
+            if ($can_move)      $return_item['can_move']      = new xmlrpcval(true, 'boolean');
+            if ($can_approve)   $return_item['can_approve']   = new xmlrpcval(true, 'boolean');
+            if ($can_rename)    $return_item['can_rename']    = new xmlrpcval(true, 'boolean');
+            if ($can_ban)       $return_item['can_ban']       = new xmlrpcval(true, 'boolean');
+          //if ($is_ban)        $return_item['is_ban']        = new xmlrpcval(true, 'boolean');
+            if ($can_subscribe) $return_item['can_subscribe'] = new xmlrpcval(true, 'boolean');
+            if ($is_subscribed) $return_item['is_subscribed'] = new xmlrpcval(true, 'boolean');
+            if ($item['S_UNREAD_TOPIC'])    $return_item['new_post']  = new xmlrpcval(true, 'boolean');
+            if ($item['S_TOPIC_LOCKED'])    $return_item['is_closed'] = new xmlrpcval(true, 'boolean');
+            if ($item['S_POST_STICKY'])     $return_item['is_sticky'] = new xmlrpcval(true, 'boolean');
+            
+            $return_list[] = new xmlrpcval($return_item, 'struct');
+        }
+        else
+        {
+            $return_item = array(
+                'forum_id'          => new xmlrpcval($item['FORUM_ID'], 'string'),
+                'forum_name'        => new xmlrpcval(basic_clean($item['FORUM_TITLE']), 'base64'),
+                'topic_id'          => new xmlrpcval($item['TOPIC_ID'], 'string'),
+                'topic_title'       => new xmlrpcval(basic_clean($item['TOPIC_TITLE']), 'base64'),
+                'post_id'           => new xmlrpcval($item['POST_ID'], 'string'),
+                'post_title'        => new xmlrpcval(basic_clean($item['POST_SUBJECT']), 'base64'),
+                'post_author_id'    => new xmlrpcval($item['POST_AUTHOR_ID'], 'string'),
+                'post_author_name'  => new xmlrpcval(basic_clean($item['POST_AUTHOR']), 'base64'),
+                'post_time'         => new xmlrpcval($item['POST_DATE'], 'dateTime.iso8601'),
+                'timestamp'         => new xmlrpcval($item['POST_TIMESTAMP'], 'string'),
+                'icon_url'          => new xmlrpcval($item['POSTER_AVATAR'], 'string'),
+                'short_content'     => new xmlrpcval(basic_clean($item['MESSAGE']), 'base64'),
+                'is_approved'       => new xmlrpcval($item['POST_APPROVED'], 'boolean'),
+            );
+            
+            $can_approve = $auth->acl_get('m_approve', $forum_id) && !$item['POST_APPROVED'];
+            $can_move = $auth->acl_get('m_split', $forum_id);
+            $can_ban = $auth->acl_get('m_ban') && $item['POST_AUTHOR_ID'] != $user->data['user_id'];
+            $can_delete = ($user->data['is_registered'] && ($auth->acl_get('m_delete', $forum_id) || (
+                $user->data['user_id'] == $item['POST_AUTHOR_ID'] &&
+                $auth->acl_get('f_delete', $forum_id) &&
+                $item['TOPIC_LAST_POST_ID'] == $item['POST_ID'] &&
+                ($item['POST_TIMESTAMP'] > time() - ($config['delete_time'] * 60) || !$config['delete_time']) &&
+                // we do not want to allow removal of the last post if a moderator locked it!
+                !$item['POST_EDIT_LOCKED']
+            )));
+            
+            if ($can_approve)   $return_item['can_approve'] = new xmlrpcval(true, 'boolean');
+            if ($can_delete)    $return_item['can_delete']  = new xmlrpcval(true, 'boolean');
+            if ($can_move)      $return_item['can_move']    = new xmlrpcval(true, 'boolean');
+            if ($can_ban)       $return_item['can_ban']     = new xmlrpcval(true, 'boolean');
+          //if ($is_ban])       $return_item['is_ban']      = new xmlrpcval(true, 'boolean');
+            
+            $return_list[] = new xmlrpcval($return_item, 'struct');
+        }
+    }
+    
+    if ($include_topic_num) {
+        if($show_results == 'topics') {
+            return new xmlrpcresp(new xmlrpcval(array(
+                'result'            => new xmlrpcval(true, 'boolean'),
+                'total_topic_num'   => new xmlrpcval($total_match_count, 'int'),
+                'topics'            => new xmlrpcval($return_list, 'array'),
+            ), 'struct'));
+        } else {
+            return new xmlrpcresp(new xmlrpcval(array(
+                'result'            => new xmlrpcval(true, 'boolean'),
+                'total_post_num'    => new xmlrpcval($total_match_count, 'int'),
+                'posts'             => new xmlrpcval($return_list, 'array'),
+            ), 'struct'));
+        }
+    } else {
+        return new xmlrpcresp(new xmlrpcval($return_list, 'array'));
+    }
+}
+
+function xmlresptrue()
+{
+    $result = new xmlrpcval(array(
+        'result'        => new xmlrpcval(true, 'boolean'),
+        'result_text'   => new xmlrpcval('', 'base64')
+    ), 'struct');
+    
+    return new xmlrpcresp($result);
+}
\ No newline at end of file
diff -ruN phpBB-3.0.10/newposts.php phpbb/newposts.php
--- phpBB-3.0.10/newposts.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/newposts.php	2014-04-15 14:31:18.665429005 +0200
@@ -0,0 +1,82 @@
+<?php
+require_once("config.php");
+include("feedcreator.class.php");
+$db = mysql_connect($dbhost,$dbuser,$dbpasswd);
+mysql_select_db($dbname,$db);
+$query = "SELECT * FROM ".$table_prefix."posts WHERE forum_id NOT IN (3, 4, 5, 8, 17, 18, 28, 29, 62, 24, 25, 40, 30) ORDER BY post_id DESC LIMIT 0,10";
+$res = mysql_query($query);
+
+if ($res == FALSE)
+{
+  echo "Mysql error on query: $query";
+  die();
+  
+}
+$rss = new UniversalFeedCreator();
+$rss->title = "SpringRTS Forum RSS Feed";
+$rss->description = "Latest posts on spring forum";
+$rss->link = "http://www.springrts.com/newposts.php";
+$rss->syndicationURL = "http://www.springrts.com/".$PHP_SELF;
+
+while ( $row = mysql_fetch_array($res))
+{
+  //echo "\t\t<item>\n";
+  $item = new FeedItem();
+  $author = "";
+  $query = "SELECT username FROM ".$table_prefix."users WHERE user_id = ".$row["poster_id"];
+  $res2 = mysql_query($query);
+
+  if ($res2 == FALSE)
+  {
+    echo "Mysql error on query: $query";
+    die();
+    
+  }
+  $r2 = mysql_fetch_array($res2);
+  $author = $r2["username"];
+  $query = "SELECT topic_title FROM ".$table_prefix."topics WHERE topic_id = ".$row["topic_id"];
+  $res2 = mysql_query($query);
+
+  if ($res2 == FALSE)
+  {
+    echo "Mysql error on query: $query";
+    die();
+    
+  }
+  $r2 = mysql_fetch_array($res2);
+  $thread = $r2["topic_title"];
+  $fid = $row["forum_id"];
+  $forum = "";
+  $it = 0;
+  do {
+  $query = "SELECT forum_name,parent_id FROM ".$table_prefix."forums WHERE forum_id = ".$fid;
+  $res2 = mysql_query($query);
+
+  if ($res2 == FALSE)
+  {
+    echo "Mysql error on query: $query";
+    die();
+    
+  }
+  $r2 = mysql_fetch_array($res2);
+  $fid = $r2["parent_id"];
+  $forum = $r2["forum_name"].(($forum == "") ? "" : " -> ").$forum;
+  $it++;
+  if ($it > 100)
+  {
+    die("Too many iterations when fetching forum category");
+  }
+  }while ($fid != "0");
+  $title = "( ".$author." ) ".$forum." -> ".$thread;
+  $link = "http://springrts.com/phpbb/viewtopic.php?p=".$row["post_id"]."#p".$row["post_id"];
+  $item->title = $title;
+  $item->link = $link;
+  $item->author = $author;
+  $rss->addItem($item);
+}
+//echo "\t</channel>\n";
+//echo "</rss>\n";
+echo $rss->createFeed("RSS2.0");
+
+
+?>
diff -ruN phpBB-3.0.10/newsrss.php phpbb/newsrss.php
--- phpBB-3.0.10/newsrss.php	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/newsrss.php	2014-04-15 14:31:18.666429005 +0200
@@ -0,0 +1,61 @@
+<?php
+require_once("config.php");
+include("feedcreator.class.php");
+$db = mysql_connect($dbhost,$dbuser,$dbpasswd);
+mysql_select_db($dbname,$db);
+$query = "SELECT * FROM ".$table_prefix."topics WHERE forum_id = 2 ORDER BY topic_id DESC LIMIT 0,10";
+$res = mysql_query($query);
+
+if ($res == FALSE)
+{
+  echo "Mysql error on query: $query";
+  die();
+  
+}
+$rss = new UniversalFeedCreator();
+$rss->title = "SpringRTS News Feed";
+$rss->description = "News topics on spring forum";
+$rss->link = "http://www.springrts.com/phpbb/newsrss.php";
+$rss->syndicationURL = "http://www.springrts.com/phpbb/newsrss.php"; #.$PHP_SELF;
+
+while ( $row = mysql_fetch_array($res))
+{
+  //echo "\t\t<item>\n";
+  $item = new FeedItem();
+  $author = $row["topic_first_poster_name"];
+  $thread = $row["topic_title"];
+  $fid = $row["forum_id"];
+  $forum = "";
+  $it = 0;
+  do {
+  $query = "SELECT forum_name,parent_id FROM ".$table_prefix."forums WHERE forum_id = ".$fid;
+  $res2 = mysql_query($query);
+
+  if ($res2 == FALSE)
+  {
+    echo "Mysql error on query: $query";
+    die();
+    
+  }
+  $r2 = mysql_fetch_array($res2);
+  $fid = $r2["parent_id"];
+  $forum = $r2["forum_name"].(($forum == "") ? "" : " -> ").$forum;
+  $it++;
+  if ($it > 100)
+  {
+    die("Too many iterations when fetching forum category");
+  }
+  }while ($fid != "0");
+  $title = "( ".$author." ) ".$forum." -> ".$thread;
+  $link = "http://springrts.com/phpbb/viewtopic.php?t=".$row["topic_id"];
+  $item->title = $title;
+  $item->link = $link;
+  $item->author = $author;
+  $rss->addItem($item);
+}
+//echo "\t</channel>\n";
+//echo "</rss>\n";
+echo $rss->createFeed("RSS2.0");
+
+
+?>
diff -ruN phpBB-3.0.10/posting.php phpbb/posting.php
--- phpBB-3.0.10/posting.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/posting.php	2013-09-28 03:20:51.000000000 +0200
@@ -196,6 +196,7 @@
 {
 	login_forum_box(array(
 		'forum_id'			=> $forum_id,
+		'forum_name'		=> $post_data['forum_name'],
 		'forum_password'	=> $post_data['forum_password'])
 	);
 }
@@ -1018,7 +1019,7 @@
 					$forum_type = (int) $db->sql_fetchfield('forum_type');
 					$db->sql_freeresult($result);
 
-					if ($forum_type != FORUM_POST || !$auth->acl_get('f_post', $to_forum_id) || (!$auth->acl_get('m_approve', $to_forum_id) && !$auth->acl_get('f_noapprove', $to_forum_id)))
+					if ($forum_type != FORUM_POST || !$auth->acl_get('f_post', $to_forum_id) || !$auth->acl_get('f_noapprove', $to_forum_id))
 					{
 						$to_forum_id = 0;
 					}
@@ -1130,16 +1131,23 @@
 				$data['topic_replies'] = $post_data['topic_replies'];
 			}
 
+			// Only return the username when it is either a guest posting or we are editing a post and
+			// the username was supplied; otherwise post_data might hold the data of the post that is
+			// being quoted (which could result in the username being returned being that of the quoted
+			// post's poster, not the poster of the current post). See: PHPBB3-11769 for more information.
+			$post_author_name = ((!$user->data['is_registered'] || $mode == 'edit') && $post_data['username'] !== '') ? $post_data['username'] : '';
+
 			// The last parameter tells submit_post if search indexer has to be run
-			$redirect_url = submit_post($mode, $post_data['post_subject'], $post_data['username'], $post_data['topic_type'], $poll, $data, $update_message, ($update_message || $update_subject) ? true : false);
+			$redirect_url = submit_post($mode, $post_data['post_subject'], $post_author_name, $post_data['topic_type'], $poll, $data, $update_message, ($update_message || $update_subject) ? true : false);
 
 			if ($config['enable_post_confirm'] && !$user->data['is_registered'] && (isset($captcha) && $captcha->is_solved() === true) && ($mode == 'post' || $mode == 'reply' || $mode == 'quote'))
 			{
 				$captcha->reset();
 			}
 
-			// Check the permissions for post approval. Moderators are not affected.
-			if ((!$auth->acl_get('f_noapprove', $data['forum_id']) && !$auth->acl_get('m_approve', $data['forum_id']) && empty($data['force_approved_state'])) || (isset($data['force_approved_state']) && !$data['force_approved_state']))
+			// Check the permissions for post approval.
+			// Moderators must go through post approval like ordinary users.
+			if ((!$auth->acl_get('f_noapprove', $data['forum_id']) && empty($data['force_approved_state'])) || (isset($data['force_approved_state']) && !$data['force_approved_state']))
 			{
 				meta_refresh(10, $redirect_url);
 				$message = ($mode == 'edit') ? $user->lang['POST_EDITED_MOD'] : $user->lang['POST_STORED_MOD'];
diff -ruN phpBB-3.0.10/report.php phpbb/report.php
--- phpBB-3.0.10/report.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/report.php	2013-09-28 03:20:51.000000000 +0200
@@ -133,9 +133,28 @@
 	}
 }
 
+if ($config['enable_post_confirm'] && !$user->data['is_registered'])
+{
+	include($phpbb_root_path . 'includes/captcha/captcha_factory.' . $phpEx);
+	$captcha =& phpbb_captcha_factory::get_instance($config['captcha_plugin']);
+	$captcha->init(CONFIRM_REPORT);
+}
+
+$error	= array();
+$s_hidden_fields = '';
+
 // Submit report?
 if ($submit && $reason_id)
 {
+	if (isset($captcha))
+	{
+		$visual_confirmation_response = $captcha->validate();
+		if ($visual_confirmation_response)
+		{
+			$error[] = $visual_confirmation_response;
+		}
+	}
+
 	$sql = 'SELECT *
 		FROM ' . REPORTS_REASONS_TABLE . "
 		WHERE reason_id = $reason_id";
@@ -145,78 +164,90 @@
 
 	if (!$row || (!$report_text && strtolower($row['reason_title']) == 'other'))
 	{
-		trigger_error('EMPTY_REPORT');
+		$error[] = $user->lang('EMPTY_REPORT');
 	}
 
-	$sql_ary = array(
-		'reason_id'		=> (int) $reason_id,
-		'post_id'		=> $post_id,
-		'pm_id'			=> $pm_id,
-		'user_id'		=> (int) $user->data['user_id'],
-		'user_notify'	=> (int) $user_notify,
-		'report_closed'	=> 0,
-		'report_time'	=> (int) time(),
-		'report_text'	=> (string) $report_text
-	);
-
-	$sql = 'INSERT INTO ' . REPORTS_TABLE . ' ' . $db->sql_build_array('INSERT', $sql_ary);
-	$db->sql_query($sql);
-	$report_id = $db->sql_nextid();
-
-	if ($post_id)
+	if (!sizeof($error))
 	{
-		$sql = 'UPDATE ' . POSTS_TABLE . '
-			SET post_reported = 1
-			WHERE post_id = ' . $post_id;
-		$db->sql_query($sql);
-
-		if (!$report_data['topic_reported'])
+		if (isset($captcha))
 		{
-			$sql = 'UPDATE ' . TOPICS_TABLE . '
-				SET topic_reported = 1
-				WHERE topic_id = ' . $report_data['topic_id'] . '
-					OR topic_moved_id = ' . $report_data['topic_id'];
-			$db->sql_query($sql);
+			$captcha->reset();
 		}
 
-		$lang_return = $user->lang['RETURN_TOPIC'];
-		$lang_success = $user->lang['POST_REPORTED_SUCCESS'];
-	}
-	else
-	{
-		$sql = 'UPDATE ' . PRIVMSGS_TABLE . '
-			SET message_reported = 1
-			WHERE msg_id = ' . $pm_id;
-		$db->sql_query($sql);
-
 		$sql_ary = array(
-			'msg_id'		=> $pm_id,
-			'user_id'		=> ANONYMOUS,
-			'author_id'		=> (int) $report_data['author_id'],
-			'pm_deleted'	=> 0,
-			'pm_new'		=> 0,
-			'pm_unread'		=> 0,
-			'pm_replied'	=> 0,
-			'pm_marked'		=> 0,
-			'pm_forwarded'	=> 0,
-			'folder_id'		=> PRIVMSGS_INBOX,
+			'reason_id'		=> (int) $reason_id,
+			'post_id'		=> $post_id,
+			'pm_id'			=> $pm_id,
+			'user_id'		=> (int) $user->data['user_id'],
+			'user_notify'	=> (int) $user_notify,
+			'report_closed'	=> 0,
+			'report_time'	=> (int) time(),
+			'report_text'	=> (string) $report_text
 		);
 
-		$sql = 'INSERT INTO ' . PRIVMSGS_TO_TABLE . ' ' . $db->sql_build_array('INSERT', $sql_ary);
+		$sql = 'INSERT INTO ' . REPORTS_TABLE . ' ' . $db->sql_build_array('INSERT', $sql_ary);
 		$db->sql_query($sql);
+		$report_id = $db->sql_nextid();
 
-		$lang_return = $user->lang['RETURN_PM'];
-		$lang_success = $user->lang['PM_REPORTED_SUCCESS'];
-	}
+		if ($post_id)
+		{
+			$sql = 'UPDATE ' . POSTS_TABLE . '
+				SET post_reported = 1
+				WHERE post_id = ' . $post_id;
+			$db->sql_query($sql);
+
+			if (!$report_data['topic_reported'])
+			{
+				$sql = 'UPDATE ' . TOPICS_TABLE . '
+					SET topic_reported = 1
+					WHERE topic_id = ' . $report_data['topic_id'] . '
+						OR topic_moved_id = ' . $report_data['topic_id'];
+				$db->sql_query($sql);
+			}
+
+			$lang_return = $user->lang['RETURN_TOPIC'];
+			$lang_success = $user->lang['POST_REPORTED_SUCCESS'];
+		}
+		else
+		{
+			$sql = 'UPDATE ' . PRIVMSGS_TABLE . '
+				SET message_reported = 1
+				WHERE msg_id = ' . $pm_id;
+			$db->sql_query($sql);
+
+			$sql_ary = array(
+				'msg_id'		=> $pm_id,
+				'user_id'		=> ANONYMOUS,
+				'author_id'		=> (int) $report_data['author_id'],
+				'pm_deleted'	=> 0,
+				'pm_new'		=> 0,
+				'pm_unread'		=> 0,
+				'pm_replied'	=> 0,
+				'pm_marked'		=> 0,
+				'pm_forwarded'	=> 0,
+				'folder_id'		=> PRIVMSGS_INBOX,
+			);
+
+			$sql = 'INSERT INTO ' . PRIVMSGS_TO_TABLE . ' ' . $db->sql_build_array('INSERT', $sql_ary);
+			$db->sql_query($sql);
+
+			$lang_return = $user->lang['RETURN_PM'];
+			$lang_success = $user->lang['PM_REPORTED_SUCCESS'];
+		}
 
-	meta_refresh(3, $redirect_url);
+		meta_refresh(3, $redirect_url);
 
-	$message = $lang_success . '<br /><br />' . sprintf($lang_return, '<a href="' . $redirect_url . '">', '</a>');
-	if ($return_forum_url)
+		$message = $lang_success . '<br /><br />' . sprintf($lang_return, '<a href="' . $redirect_url . '">', '</a>');
+		if ($return_forum_url)
+		{
+			$message .= '<br /><br />' . sprintf($user->lang['RETURN_FORUM'], '<a href="' . $return_forum_url . '">', '</a>');
+		}
+		trigger_error($message);
+	}
+	else if (isset($captcha) && $captcha->is_solved() !== false)
 	{
-		$message .= '<br /><br />' . sprintf($user->lang['RETURN_FORUM'], '<a href="' . $return_forum_url . '">', '</a>');
+		$s_hidden_fields .= build_hidden_fields($captcha->get_hidden_fields());
 	}
-	trigger_error($message);
 }
 
 // Generate the reasons
@@ -224,10 +255,20 @@
 
 $page_title = ($pm_id) ? $user->lang['REPORT_MESSAGE'] : $user->lang['REPORT_POST'];
 
+if (isset($captcha) && $captcha->is_solved() === false)
+{
+	$template->assign_vars(array(
+		'S_CONFIRM_CODE'	=> true,
+		'CAPTCHA_TEMPLATE'	=> $captcha->get_template(),
+	));
+}
+
 $template->assign_vars(array(
+	'ERROR'				=> (sizeof($error)) ? implode('<br />', $error) : '',
 	'S_REPORT_POST'		=> ($pm_id) ? false : true,
 	'REPORT_TEXT'		=> $report_text,
 	'S_REPORT_ACTION'	=> append_sid("{$phpbb_root_path}report.$phpEx", 'f=' . $forum_id . '&amp;p=' . $post_id . '&amp;pm=' . $pm_id),
+	'S_HIDDEN_FIELDS'	=> (sizeof($s_hidden_fields)) ? $s_hidden_fields : null,
 
 	'S_NOTIFY'			=> $user_notify,
 	'S_CAN_NOTIFY'		=> ($user->data['is_registered']) ? true : false)
diff -ruN phpBB-3.0.10/search.php phpbb/search.php
--- phpBB-3.0.10/search.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/search.php	2013-09-28 03:20:51.000000000 +0200
@@ -469,33 +469,60 @@
 	$per_page = ($show_results == 'posts') ? $config['posts_per_page'] : $config['topics_per_page'];
 	$total_match_count = 0;
 
+	// Set limit for the $total_match_count to reduce server load
+	$total_matches_limit = 1000;
+	$found_more_search_matches = false;
+
 	if ($search_id)
 	{
 		if ($sql)
 		{
-			// only return up to 1000 ids (the last one will be removed later)
-			$result = $db->sql_query_limit($sql, 1001 - $start, $start);
+			// Only return up to $total_matches_limit+1 ids (the last one will be removed later)
+			$result = $db->sql_query_limit($sql, $total_matches_limit + 1);
 
 			while ($row = $db->sql_fetchrow($result))
 			{
 				$id_ary[] = (int) $row[$field];
 			}
 			$db->sql_freeresult($result);
-
-			$total_match_count = sizeof($id_ary) + $start;
-			$id_ary = array_slice($id_ary, 0, $per_page);
 		}
 		else if ($search_id == 'unreadposts')
 		{
-			$id_ary = array_keys(get_unread_topics($user->data['user_id'], $sql_where, $sql_sort, 1001 - $start, $start));
-
-			$total_match_count = sizeof($id_ary) + $start;
-			$id_ary = array_slice($id_ary, 0, $per_page);
+			// Only return up to $total_matches_limit+1 ids (the last one will be removed later)
+			$id_ary = array_keys(get_unread_topics($user->data['user_id'], $sql_where, $sql_sort, $total_matches_limit + 1));
 		}
 		else
 		{
 			$search_id = '';
 		}
+
+		$total_match_count = sizeof($id_ary);
+		if ($total_match_count)
+		{
+			// Limit the number to $total_matches_limit for pre-made searches
+			if ($total_match_count > $total_matches_limit)
+			{
+				$found_more_search_matches = true;
+				$total_match_count = $total_matches_limit;
+			}
+
+			// Make sure $start is set to the last page if it exceeds the amount
+			if ($start < 0)
+			{
+				$start = 0;
+			}
+			else if ($start >= $total_match_count)
+			{
+				$start = floor(($total_match_count - 1) / $per_page) * $per_page;
+			}
+
+			$id_ary = array_slice($id_ary, $start, $per_page);
+		}
+		else
+		{
+			// Set $start to 0 if no matches were found
+			$start = 0;
+		}
 	}
 
 	// make sure that some arrays are always in the same order
@@ -543,10 +570,8 @@
 	$icons = $cache->obtain_icons();
 
 	// Output header
-	if ($search_id && ($total_match_count > 1000))
+	if ($found_more_search_matches)
 	{
-		// limit the number to 1000 for pre-made searches
-		$total_match_count--;
 		$l_search_matches = sprintf($user->lang['FOUND_MORE_SEARCH_MATCHES'], $total_match_count);
 	}
 	else
@@ -578,7 +603,8 @@
 	$template->assign_vars(array(
 		'SEARCH_TITLE'		=> $l_search_title,
 		'SEARCH_MATCHES'	=> $l_search_matches,
-		'SEARCH_WORDS'		=> $search->search_query,
+		'SEARCH_WORDS'		=> $keywords,
+		'SEARCHED_QUERY'	=> $search->search_query,
 		'IGNORED_WORDS'		=> (sizeof($search->common_words)) ? implode(' ', $search->common_words) : '',
 		'PAGINATION'		=> generate_pagination($u_search, $total_match_count, $per_page, $start),
 		'PAGE_NUMBER'		=> on_page($total_match_count, $per_page, $start),
diff -ruN phpBB-3.0.10/style.php phpbb/style.php
--- phpBB-3.0.10/style.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/style.php	2013-09-28 03:20:51.000000000 +0200
@@ -216,10 +216,10 @@
 
 	// Parse Theme Data
 	$replace = array(
-		'{T_THEME_PATH}'			=> "{$phpbb_root_path}styles/" . $theme['theme_path'] . '/theme',
-		'{T_TEMPLATE_PATH}'			=> "{$phpbb_root_path}styles/" . $theme['template_path'] . '/template',
-		'{T_IMAGESET_PATH}'			=> "{$phpbb_root_path}styles/" . $theme['imageset_path'] . '/imageset',
-		'{T_IMAGESET_LANG_PATH}'	=> "{$phpbb_root_path}styles/" . $theme['imageset_path'] . '/imageset/' . $user_image_lang,
+		'{T_THEME_PATH}'			=> "{$phpbb_root_path}styles/" . rawurlencode($theme['theme_path']) . '/theme',
+		'{T_TEMPLATE_PATH}'			=> "{$phpbb_root_path}styles/" . rawurlencode($theme['template_path']) . '/template',
+		'{T_IMAGESET_PATH}'			=> "{$phpbb_root_path}styles/" . rawurlencode($theme['imageset_path']) . '/imageset',
+		'{T_IMAGESET_LANG_PATH}'	=> "{$phpbb_root_path}styles/" . rawurlencode($theme['imageset_path']) . '/imageset/' . $user_image_lang,
 		'{T_STYLESHEET_NAME}'		=> $theme['theme_name'],
 		'{S_USER_LANG}'				=> $user['user_lang']
 	);
@@ -248,7 +248,7 @@
 				$img_data = &$img_array[$img];
 				$imgsrc = ($img_data['image_lang'] ? $img_data['image_lang'] . '/' : '') . $img_data['image_filename'];
 				$imgs[$img] = array(
-					'src'		=> $phpbb_root_path . 'styles/' . $theme['imageset_path'] . '/imageset/' . $imgsrc,
+					'src'		=> $phpbb_root_path . 'styles/' . rawurlencode($theme['imageset_path']) . '/imageset/' . $imgsrc,
 					'width'		=> $img_data['image_width'],
 					'height'	=> $img_data['image_height'],
 				);
diff -ruN phpBB-3.0.10/styles/prosilver/imageset/imageset.cfg phpbb/styles/prosilver/imageset/imageset.cfg
--- phpBB-3.0.10/styles/prosilver/imageset/imageset.cfg	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/prosilver/imageset/imageset.cfg	2013-09-28 03:20:51.000000000 +0200
@@ -19,7 +19,7 @@
 # General Information about this style
 name = prosilver
 copyright = &copy; phpBB Group, 2007
-version = 3.0.10
+version = 3.0.12
 
 # Images
 img_site_logo = site_logo.gif*52*139
diff -ruN phpBB-3.0.10/styles/prosilver/style.cfg phpbb/styles/prosilver/style.cfg
--- phpBB-3.0.10/styles/prosilver/style.cfg	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/prosilver/style.cfg	2013-09-28 03:20:51.000000000 +0200
@@ -19,4 +19,4 @@
 # General Information about this style
 name = prosilver
 copyright = &copy; phpBB Group, 2007
-version = 3.0.10
\ No newline at end of file
+version = 3.0.12
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/prosilver/template/editor.js phpbb/styles/prosilver/template/editor.js
--- phpBB-3.0.10/styles/prosilver/template/editor.js	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/prosilver/template/editor.js	2013-09-28 03:20:51.000000000 +0200
@@ -219,7 +219,7 @@
 
 	// Get text selection - not only the post content :(
 	// IE9 must use the document.selection method but has the *.getSelection so we just force no IE
-	if (window.getSelection && !is_ie)
+	if (window.getSelection && !is_ie && !window.opera)
 	{
 		theSelection = window.getSelection().toString();
 	}
@@ -456,4 +456,4 @@
 	}
 
 	return caretPos;
-}
\ No newline at end of file
+}
diff -ruN phpBB-3.0.10/styles/prosilver/template/login_forum.html phpbb/styles/prosilver/template/login_forum.html
--- phpBB-3.0.10/styles/prosilver/template/login_forum.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/prosilver/template/login_forum.html	2013-09-28 03:20:51.000000000 +0200
@@ -1,31 +1,36 @@
 <!-- INCLUDE overall_header.html -->
 
-<h2 class="solo">{L_LOGIN} {FORUM_NAME}</h2>
+<!-- IF FORUM_NAME --><h2><a href="{U_VIEW_FORUM}">{FORUM_NAME}</a></h2><!-- ENDIF -->
 
 <form id="login_forum" method="post" action="{S_LOGIN_ACTION}">
 {S_FORM_TOKEN}
 <div class="panel">
 	<div class="inner"><span class="corners-top"><span></span></span>
 
-	<p>{L_LOGIN_FORUM}</p>
+	<div class="content">
+		<h2>{L_LOGIN}</h2>
 
-	<fieldset class="fields2">
-	<!-- IF LOGIN_ERROR -->
-		<dl>
-			<dt>&nbsp;</dt>
-			<dd class="error">{LOGIN_ERROR}</dd>
-		</dl>
-	<!-- ENDIF -->
-	<dl>
-		<dt><label for="password">{L_PASSWORD}:</label></dt>
-		<dd><input class="inputbox narrow" type="password" name="password" id="password" size="25" tabindex="1" /></dd>
-	</dl>
-	<dl class="fields2">
-		<dt>&nbsp;</dt>
-		<dd>{S_HIDDEN_FIELDS}<input type="submit" name="login" id="login" class="button1" value="{L_LOGIN}" tabindex="2" /></dd>
-	</dl>
-	{S_LOGIN_REDIRECT}
-	</fieldset>
+		<p>{L_LOGIN_FORUM}</p>
+
+		<fieldset class="fields1">
+			<!-- IF LOGIN_ERROR -->
+				<dl>
+					<dt>&nbsp;</dt>
+					<dd class="error">{LOGIN_ERROR}</dd>
+				</dl>
+			<!-- ENDIF -->
+
+			<dl>
+				<dt><label for="password">{L_PASSWORD}:</label></dt>
+				<dd><input type="password" tabindex="1" id="password" name="password" size="25" class="inputbox narrow" /></dd>
+			</dl>
+			{S_LOGIN_REDIRECT}
+			<dl>
+				<dt>&nbsp;</dt>
+				<dd>{S_HIDDEN_FIELDS}<input type="submit" name="login" id="login" class="button1" value="{L_LOGIN}" tabindex="2" /></dd>
+			</dl>
+		</fieldset>
+	</div>
 
 	<span class="corners-bottom"><span></span></span></div>
 </div>
diff -ruN phpBB-3.0.10/styles/prosilver/template/mcp_front.html phpbb/styles/prosilver/template/mcp_front.html
--- phpBB-3.0.10/styles/prosilver/template/mcp_front.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/prosilver/template/mcp_front.html	2013-09-28 03:20:51.000000000 +0200
@@ -119,7 +119,7 @@
 			<ul class="topiclist cplist">
 
 			<!-- BEGIN pm_report -->
-			<li class="row<!-- IF report.S_ROW_COUNT is odd --> bg1<!-- ELSE --> bg2<!-- ENDIF -->">
+			<li class="row<!-- IF pm_report.S_ROW_COUNT is odd --> bg1<!-- ELSE --> bg2<!-- ENDIF -->">
 				<dl>
 					<dt>
 						<a href="{pm_report.U_PM_DETAILS}" class="topictitle">{pm_report.PM_SUBJECT}</a> {pm_report.ATTACH_ICON_IMG}<br />
diff -ruN phpBB-3.0.10/styles/prosilver/template/mcp_topic.html phpbb/styles/prosilver/template/mcp_topic.html
--- phpBB-3.0.10/styles/prosilver/template/mcp_topic.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/prosilver/template/mcp_topic.html	2013-09-28 03:20:51.000000000 +0200
@@ -1,5 +1,6 @@
 <!-- INCLUDE mcp_header.html -->
 
+<div class="tabs-container">
 <h2><a href="{U_VIEW_TOPIC}">{L_TOPIC}: {TOPIC_TITLE}</a></h2>
 
 <script type="text/javascript">
@@ -35,6 +36,7 @@
 		</li>
 	</ul>
 </div>
+</div>
 
 <form id="mcp" method="post" action="{S_MCP_ACTION}">
 
@@ -106,7 +108,7 @@
 			<div class="inner"><span class="corners-top"><span></span></span>
 
 			<div class="postbody" id="pr{postrow.POST_ID}">
-				<ul class="profile-icons"><li class="info-icon"><a href="{postrow.U_POST_DETAILS}" title="{L_POST_DETAILS}"><span>{L_POST_DETAILS}</span></a></li><li>{L_SELECT}: <input type="checkbox" name="post_id_list[]" value="{postrow.POST_ID}"<!-- IF postrow.S_CHECKED --> checked="checked"<!-- ENDIF --> /></li></ul>
+				<ul class="profile-icons"><li class="info-icon"><a href="{postrow.U_POST_DETAILS}" title="{L_POST_DETAILS}"><span>{L_POST_DETAILS}</span></a></li><li><label for="post_id_list_select_{postrow.POST_ID}">{L_SELECT}: <input type="checkbox" id="post_id_list_select_{postrow.POST_ID}" name="post_id_list[]" value="{postrow.POST_ID}"<!-- IF postrow.S_CHECKED --> checked="checked"<!-- ENDIF --> /></label></li></ul>
 
 				<h3><a href="{postrow.U_POST_DETAILS}">{postrow.POST_SUBJECT}</a></h3>
 				<p class="author"><a href="#pr{postrow.POST_ID}">{postrow.MINI_POST_IMG}</a> {L_POSTED} {postrow.POST_DATE} {L_POST_BY_AUTHOR} <strong>{postrow.POST_AUTHOR_FULL}</strong><!-- IF postrow.U_MCP_DETAILS --> [ <a href="{postrow.U_MCP_DETAILS}">{L_POST_DETAILS}</a> ]<!-- ENDIF --></p>
@@ -158,6 +160,7 @@
 		<!-- IF S_CAN_DELETE --><option value="delete_post">{L_DELETE_POSTS}</option><!-- ENDIF -->
 		<!-- IF S_CAN_MERGE --><option value="merge_posts"<!-- IF S_MERGE_VIEW --> selected="selected"<!-- ENDIF -->>{L_MERGE_POSTS}</option><!-- ENDIF -->
 		<!-- IF S_CAN_SPLIT --><option value="split_all"<!-- IF S_SPLIT_VIEW --> selected="selected"<!-- ENDIF -->>{L_SPLIT_POSTS}</option><option value="split_beyond">{L_SPLIT_AFTER}</option><!-- ENDIF -->
+		<!-- IF S_CAN_SYNC --><option value="resync">{L_RESYNC}</option><!-- ENDIF -->
 	</select>&nbsp;
 	<input class="button1" type="submit" name="mcp_topic_submit" value="{L_SUBMIT}" />
 	<div><a href="#" onclick="marklist('mcp', 'post', true); return false;">{L_MARK_ALL}</a> :: <a href="#" onclick="marklist('mcp', 'post', false); return false;">{L_UNMARK_ALL}</a></div>
diff -ruN phpBB-3.0.10/styles/prosilver/template/memberlist_body.html phpbb/styles/prosilver/template/memberlist_body.html
--- phpBB-3.0.10/styles/prosilver/template/memberlist_body.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/prosilver/template/memberlist_body.html	2013-09-28 03:20:51.000000000 +0200
@@ -80,7 +80,7 @@
 	<span class="corners-bottom"><span></span></span></div>
 </div>
 <!-- ENDIF -->
-<div class="forumbg">
+<div class="forumbg forumbg-table">
 	<div class="inner"><span class="corners-top"><span></span></span>
 
 	<table class="table1" cellspacing="1">
diff -ruN phpBB-3.0.10/styles/prosilver/template/memberlist_leaders.html phpbb/styles/prosilver/template/memberlist_leaders.html
--- phpBB-3.0.10/styles/prosilver/template/memberlist_leaders.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/prosilver/template/memberlist_leaders.html	2013-09-28 03:20:51.000000000 +0200
@@ -4,7 +4,7 @@
 
 <form method="post" action="{S_MODE_ACTION}">
 
-<div class="forumbg">
+<div class="forumbg forumbg-table">
 	<div class="inner"><span class="corners-top"><span></span></span>
 
 	<table class="table1" cellspacing="1">
@@ -37,7 +37,7 @@
 	<span class="corners-bottom"><span></span></span></div>
 </div>
 
-<div class="forumbg">
+<div class="forumbg forumbg-table">
 	<div class="inner"><span class="corners-top"><span></span></span>
 	 
 	<table class="table1" cellspacing="1">
diff -ruN phpBB-3.0.10/styles/prosilver/template/memberlist_search.html phpbb/styles/prosilver/template/memberlist_search.html
--- phpBB-3.0.10/styles/prosilver/template/memberlist_search.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/prosilver/template/memberlist_search.html	2013-09-28 03:20:51.000000000 +0200
@@ -75,6 +75,10 @@
 		<dt><label for="msn">{L_MSNM}:</label></dt>
 		<dd><input type="text" name="msn" id="msn" value="{MSNM}" class="inputbox" /></dd>
 	</dl>
+	<dl>
+		<dt><label for="jabber">{L_JABBER}:</label></dt>
+		<dd><input type="text" name="jabber" id="jabber" value="{JABBER}" class="inputbox" /></dd>
+	</dl>
 	</fieldset>
 
 	<fieldset class="fields1 column2">
diff -ruN phpBB-3.0.10/styles/prosilver/template/memberlist_view.html phpbb/styles/prosilver/template/memberlist_view.html
--- phpBB-3.0.10/styles/prosilver/template/memberlist_view.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/prosilver/template/memberlist_view.html	2013-09-28 03:20:51.000000000 +0200
@@ -69,7 +69,7 @@
 		<!-- IF U_JABBER and S_JABBER_ENABLED --><dt>{L_JABBER}:</dt> <dd><a href="{U_JABBER}" onclick="popup(this.href, 550, 320); return false;">{L_SEND_JABBER_MESSAGE}</a></dd><!-- ELSEIF USER_JABBER --><dt>{L_JABBER}:</dt> <dd>{USER_JABBER}</dd><!-- ENDIF -->
 		<!-- IF S_PROFILE_FIELD1 -->
 			<!-- NOTE: Use a construct like this to include admin defined profile fields. Replace FIELD1 with the name of your field. -->
-			<dt>{postrow.PROFILE_FIELD1_NAME}:</dt> <dd>{postrow.PROFILE_FIELD1_VALUE}</dd>
+			<dt>{PROFILE_FIELD1_NAME}:</dt> <dd>{PROFILE_FIELD1_VALUE}</dd>
 		<!-- ENDIF -->
 		</dl>
 	</div>
diff -ruN phpBB-3.0.10/styles/prosilver/template/overall_footer.html phpbb/styles/prosilver/template/overall_footer.html
--- phpBB-3.0.10/styles/prosilver/template/overall_footer.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/prosilver/template/overall_footer.html	2013-09-28 03:20:51.000000000 +0200
@@ -19,7 +19,7 @@
 		<span class="corners-bottom"><span></span></span></div>
 	</div>
 
-	<div class="copyright">Powered by <a href="http://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Group
+	<div class="copyright">{CREDIT_LINE}
 		<!-- IF TRANSLATION_INFO --><br />{TRANSLATION_INFO}<!-- ENDIF -->
 		<!-- IF DEBUG_OUTPUT --><br />{DEBUG_OUTPUT}<!-- ENDIF -->
 		<!-- IF U_ACP --><br /><strong><a href="{U_ACP}">{L_ACP}</a></strong><!-- ENDIF -->
diff -ruN phpBB-3.0.10/styles/prosilver/template/overall_header.html phpbb/styles/prosilver/template/overall_header.html
--- phpBB-3.0.10/styles/prosilver/template/overall_header.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/prosilver/template/overall_header.html	2013-09-28 03:20:51.000000000 +0200
@@ -28,10 +28,6 @@
 	Based on style:   prosilver (this is the default phpBB3 style)
 	Original author:  Tom Beddard ( http://www.subBlue.com/ )
 	Modified by:
-
-	NOTE: This page was generated by phpBB, the free open-source bulletin board package.
-	      The phpBB Group is not responsible for the content of this page and forum. For more information
-	      about phpBB please visit http://www.phpbb.com
 -->
 
 <script type="text/javascript">
diff -ruN phpBB-3.0.10/styles/prosilver/template/posting_editor.html phpbb/styles/prosilver/template/posting_editor.html
--- phpBB-3.0.10/styles/prosilver/template/posting_editor.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/prosilver/template/posting_editor.html	2013-09-28 03:20:51.000000000 +0200
@@ -17,7 +17,7 @@
 					<dd>
 						<!-- BEGIN to_recipient -->
 							<!-- IF not to_recipient.S_FIRST_ROW and to_recipient.S_ROW_COUNT mod 2 eq 0 --></dd><dd><!-- ENDIF -->
-							<!-- IF to_recipient.IS_GROUP --><a href="{to_recipient.U_VIEW}"><strong>{to_recipient.NAME}</strong></a>&nbsp;<!-- ELSE -->{to_recipient.NAME_FULL}&nbsp;<!-- ENDIF -->
+							<!-- IF to_recipient.IS_GROUP --><a href="{to_recipient.U_VIEW}"><strong>{to_recipient.NAME}</strong></a><!-- ELSE -->{to_recipient.NAME_FULL}<!-- ENDIF -->&nbsp;
 							<!-- IF not S_EDIT_POST --><input type="submit" name="remove_{to_recipient.TYPE}[{to_recipient.UG_ID}]" value="x" class="button2" />&nbsp;<!-- ENDIF -->
 						<!-- END to_recipient -->
 					</dd>
@@ -29,7 +29,7 @@
 					<dd>
 						<!-- BEGIN bcc_recipient -->
 							<!-- IF not bcc_recipient.S_FIRST_ROW and bcc_recipient.S_ROW_COUNT mod 2 eq 0 --></dd><dd><!-- ENDIF -->
-							<!-- IF bcc_recipient.IS_GROUP --><a href="{bcc_recipient.U_VIEW}"><strong>{bcc_recipient.NAME}</strong></a><!-- ELSE -->{bcc_recipient.NAME_FULL}&nbsp;<!-- ENDIF -->
+							<!-- IF bcc_recipient.IS_GROUP --><a href="{bcc_recipient.U_VIEW}"><strong>{bcc_recipient.NAME}</strong></a><!-- ELSE -->{bcc_recipient.NAME_FULL}<!-- ENDIF -->&nbsp;
 							<!-- IF not S_EDIT_POST --><input type="submit" name="remove_{bcc_recipient.TYPE}[{bcc_recipient.UG_ID}]" value="x" class="button2" />&nbsp;<!-- ENDIF -->
 						<!-- END bcc_recipient -->
 					</dd>
@@ -37,10 +37,10 @@
 			<!-- ENDIF -->
 			<!-- IF not S_EDIT_POST -->
 			<dl class="pmlist">
-				<dt><textarea id="username_list" name="username_list" class="inputbox" cols="50" rows="2"></textarea></dt>
+				<dt><textarea id="username_list" name="username_list" class="inputbox" cols="50" rows="2" tabindex="1"></textarea></dt>
 				<dd><span><a href="{U_FIND_USERNAME}" onclick="find_username(this.href); return false;">{L_FIND_USERNAME}</a></span></dd>
-				<dd><input type="submit" name="add_to" value="{L_ADD}" class="button2" /></dd>
-				<dd><input type="submit" name="add_bcc" value="{L_ADD_BCC}" class="button2" /></dd>
+				<dd><input type="submit" name="add_to" value="{L_ADD}" class="button2" tabindex="1" /></dd>
+				<dd><input type="submit" name="add_bcc" value="{L_ADD_BCC}" class="button2" tabindex="1" /></dd>
 			</dl>
 			<!-- ENDIF -->
 		<!-- ELSE -->
@@ -50,7 +50,7 @@
 					<dd>
 						<!-- BEGIN to_recipient -->
 							<!-- IF not to_recipient.S_FIRST_ROW and to_recipient.S_ROW_COUNT mod 2 eq 0 --></dd><dd><!-- ENDIF -->
-							<!-- IF to_recipient.IS_GROUP --><a href="{to_recipient.U_VIEW}"><strong>{to_recipient.NAME}</strong></a><!-- ELSE -->{to_recipient.NAME_FULL}&nbsp;<!-- ENDIF -->
+							<!-- IF to_recipient.IS_GROUP --><a href="{to_recipient.U_VIEW}"><strong>{to_recipient.NAME}</strong></a><!-- ELSE -->{to_recipient.NAME_FULL}<!-- ENDIF -->&nbsp;
 							<!-- IF not S_EDIT_POST --><input type="submit" name="remove_{to_recipient.TYPE}[{to_recipient.UG_ID}]" value="x" class="button2" />&nbsp;<!-- ENDIF -->
 						<!-- END to_recipient -->
 					</dd>
@@ -87,8 +87,8 @@
 	<dl>
 		<dt><label for="icon">{L_ICON}:</label></dt>
 		<dd>
-			<label for="icon"><input type="radio" name="icon" id="icon" value="0" checked="checked" /> <!-- IF S_SHOW_TOPIC_ICONS -->{L_NO_TOPIC_ICON}<!-- ELSE -->{L_NO_PM_ICON}<!-- ENDIF --></label>
-			<!-- BEGIN topic_icon --><label for="icon-{topic_icon.ICON_ID}"><input type="radio" name="icon" id="icon-{topic_icon.ICON_ID}" value="{topic_icon.ICON_ID}" {topic_icon.S_ICON_CHECKED} /><img src="{topic_icon.ICON_IMG}" width="{topic_icon.ICON_WIDTH}" height="{topic_icon.ICON_HEIGHT}" alt="" title="" /></label> <!-- END topic_icon -->
+			<label for="icon"><input type="radio" name="icon" id="icon" value="0" checked="checked" tabindex="1" /> <!-- IF S_SHOW_TOPIC_ICONS -->{L_NO_TOPIC_ICON}<!-- ELSE -->{L_NO_PM_ICON}<!-- ENDIF --></label>
+			<!-- BEGIN topic_icon --><label for="icon-{topic_icon.ICON_ID}"><input type="radio" name="icon" id="icon-{topic_icon.ICON_ID}" value="{topic_icon.ICON_ID}" {topic_icon.S_ICON_CHECKED} tabindex="1" /><img src="{topic_icon.ICON_IMG}" width="{topic_icon.ICON_WIDTH}" height="{topic_icon.ICON_HEIGHT}" alt="" title="" /></label> <!-- END topic_icon -->
 		</dd>
 	</dl>
 	<!-- ENDIF -->
@@ -165,7 +165,7 @@
 
 				<dt><label for="comment_list_{attach_row.ASSOC_INDEX}">{L_FILE_COMMENT}:</label></dt>
 				<dd><textarea name="comment_list[{attach_row.ASSOC_INDEX}]" id="comment_list_{attach_row.ASSOC_INDEX}" rows="1" cols="35" class="inputbox">{attach_row.FILE_COMMENT}</textarea></dd>
-				<dd><a href="{attach_row.U_VIEW_ATTACHMENT}" class="{S_CONTENT_FLOW_END}">{attach_row.FILENAME}</a></dd>
+				<dd><a href="{attach_row.U_VIEW_ATTACHMENT}">{attach_row.FILENAME}</a></dd>
 				<dd style="margin-top: 5px;">
 					<!-- IF S_INLINE_ATTACHMENT_OPTIONS --><input type="button" value="{L_PLACE_INLINE}" onclick="attach_inline({attach_row.ASSOC_INDEX}, '{attach_row.A_FILENAME}');" class="button2" />&nbsp; <!-- ENDIF -->
 					<input type="submit" name="delete_file[{attach_row.ASSOC_INDEX}]" value="{L_DELETE_FILE}" class="button2" />
diff -ruN phpBB-3.0.10/styles/prosilver/template/report_body.html phpbb/styles/prosilver/template/report_body.html
--- phpBB-3.0.10/styles/prosilver/template/report_body.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/prosilver/template/report_body.html	2013-09-28 03:20:51.000000000 +0200
@@ -10,6 +10,7 @@
 		<p><!-- IF S_REPORT_POST -->{L_REPORT_POST_EXPLAIN}<!-- ELSE -->{L_REPORT_MESSAGE_EXPLAIN}<!-- ENDIF --></p>
 		
 		<fieldset>
+		<!-- IF ERROR --><dl><dd class="error">{ERROR}</dd></dl><!-- ENDIF -->
 		<dl class="fields2">
 			<dt><label for="reason_id">{L_REASON}:</label></dt>
 			<dd><select name="reason_id" id="reason_id" class="full"><!-- BEGIN reason --><option value="{reason.ID}"<!-- IF reason.S_SELECTED --> selected="selected"<!-- ENDIF -->>{reason.DESCRIPTION}</option><!-- END reason --></select></dd>
@@ -27,6 +28,9 @@
 			<dt><label for="report_text">{L_MORE_INFO}:</label><br /><span>{L_CAN_LEAVE_BLANK}</span></dt>
 			<dd><textarea name="report_text" id="report_text" rows="10" cols="76" class="inputbox">{REPORT_TEXT}</textarea></dd>
 		</dl>
+		<!-- IF CAPTCHA_TEMPLATE -->
+			<!-- INCLUDE {CAPTCHA_TEMPLATE} -->
+		<!-- ENDIF -->
 		</fieldset>
 	</div>
 
diff -ruN phpBB-3.0.10/styles/prosilver/template/search_body.html phpbb/styles/prosilver/template/search_body.html
--- phpBB-3.0.10/styles/prosilver/template/search_body.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/prosilver/template/search_body.html	2013-09-28 03:20:51.000000000 +0200
@@ -98,7 +98,7 @@
 </form>
 
 <!-- IF .recentsearch -->
-<div class="forumbg">
+<div class="forumbg forumbg-table">
 	<div class="inner"><span class="corners-top"><span></span></span>
 
 	<table class="table1" cellspacing="1">
diff -ruN phpBB-3.0.10/styles/prosilver/template/search_results.html phpbb/styles/prosilver/template/search_results.html
--- phpBB-3.0.10/styles/prosilver/template/search_results.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/prosilver/template/search_results.html	2013-09-28 03:20:51.000000000 +0200
@@ -1,6 +1,7 @@
 <!-- INCLUDE overall_header.html -->
 
 <h2><!-- IF SEARCH_TITLE -->{SEARCH_TITLE}<!-- ELSE -->{SEARCH_MATCHES}<!-- ENDIF --><!-- IF SEARCH_WORDS -->: <a href="{U_SEARCH_WORDS}">{SEARCH_WORDS}</a><!-- ENDIF --></h2>
+<!-- IF SEARCHED_QUERY --> <p>{L_SEARCHED_QUERY}: <strong>{SEARCHED_QUERY}</strong></p><!-- ENDIF -->
 <!-- IF IGNORED_WORDS --> <p>{L_IGNORED_TERMS}: <strong>{IGNORED_WORDS}</strong></p><!-- ENDIF -->
 
 <!-- IF SEARCH_TOPIC -->
diff -ruN phpBB-3.0.10/styles/prosilver/template/simple_footer.html phpbb/styles/prosilver/template/simple_footer.html
--- phpBB-3.0.10/styles/prosilver/template/simple_footer.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/prosilver/template/simple_footer.html	2013-09-28 03:20:51.000000000 +0200
@@ -1,6 +1,6 @@
 	</div>
 
-	<div class="copyright">Powered by <a href="http://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Group
+	<div class="copyright">{CREDIT_LINE}
 		<!-- IF TRANSLATION_INFO --><br />{TRANSLATION_INFO}<!-- ENDIF -->
 		<!-- IF DEBUG_OUTPUT --><br />{DEBUG_OUTPUT}<!-- ENDIF -->
 	</div>
diff -ruN phpBB-3.0.10/styles/prosilver/template/template.cfg phpbb/styles/prosilver/template/template.cfg
--- phpBB-3.0.10/styles/prosilver/template/template.cfg	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/prosilver/template/template.cfg	2013-09-28 03:20:51.000000000 +0200
@@ -19,7 +19,12 @@
 # General Information about this template
 name = prosilver
 copyright = &copy; phpBB Group, 2007
-version = 3.0.10
+version = 3.0.12
 
 # Defining a different template bitfield
 template_bitfield = lNg=
+
+# Template inheritance
+# See http://blog.phpbb.com/2008/07/31/templating-just-got-easier/
+# Set value to empty to ignore template inheritance
+inherit_from = prosilver
diff -ruN phpBB-3.0.10/styles/prosilver/template/ucp_groups_manage.html phpbb/styles/prosilver/template/ucp_groups_manage.html
--- phpBB-3.0.10/styles/prosilver/template/ucp_groups_manage.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/prosilver/template/ucp_groups_manage.html	2013-09-28 03:20:51.000000000 +0200
@@ -6,19 +6,18 @@
 
 <div class="panel">
 	<div class="inner"><span class="corners-top"><span></span></span>
-	
+
+	<!-- IF S_ERROR -->
+	<fieldset>
+		<p class="error">{ERROR_MSG}</p>
+	</fieldset>
+	<!-- ENDIF -->
+
 	<p>{L_GROUPS_EXPLAIN}</p>
 
 	<!-- IF S_EDIT -->
 		<h3>{L_GROUP_DETAILS}</h3>
-	
-		<!-- IF S_ERROR -->
-		<div class="errorbox">
-			<h3>{L_WARNING}</h3>
-			<p>{ERROR_MSG}</p>
-		</div>
-		<!-- ENDIF -->
-	
+
 		<fieldset>
 		<dl>
 			<dt><label for="group_name">{L_GROUP_NAME}:</label></dt>
@@ -55,7 +54,7 @@
 	<fieldset>
 	<dl>
 		<dt><label for="group_colour">{L_GROUP_COLOR}:</label><br /><span>{L_GROUP_COLOR_EXPLAIN}</span></dt>
-		<dd><input name="group_colour" type="text" id="group_colour" value="{GROUP_COLOUR}" size="7" maxlength="7" class="inputbox narrow" /> <span style="background-color: {GROUP_COLOUR};">&nbsp;&nbsp;&nbsp;</span> [ <a href="{U_SWATCH}" onclick="popup(this.href, 636, 150, '_swatch'); return false;">{L_COLOUR_SWATCH}</a> ]</dd>
+		<dd><input name="group_colour" type="text" id="group_colour" value="{GROUP_COLOUR}" size="6" maxlength="6" class="inputbox narrow" /> <span style="background-color: {GROUP_COLOUR};">&nbsp;&nbsp;&nbsp;</span> [ <a href="{U_SWATCH}" onclick="popup(this.href, 636, 150, '_swatch'); return false;">{L_COLOUR_SWATCH}</a> ]</dd>
 	</dl>
 	<dl>
 		<dt><label for="group_rank">{L_GROUP_RANK}:</label></dt>
diff -ruN phpBB-3.0.10/styles/prosilver/template/ucp_groups_membership.html phpbb/styles/prosilver/template/ucp_groups_membership.html
--- phpBB-3.0.10/styles/prosilver/template/ucp_groups_membership.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/prosilver/template/ucp_groups_membership.html	2013-09-28 03:20:51.000000000 +0200
@@ -93,7 +93,7 @@
 				<!-- IF pending.GROUP_DESC --><br />{pending.GROUP_DESC}<!-- ENDIF -->
 				<!-- IF not pending.GROUP_SPECIAL --><br /><i>{pending.GROUP_STATUS}</i><!-- ENDIF -->
 				</dt>
-				<dd class="mark"><input type="radio" name="selected" value="{pending.GROUP_ID}" <!-- IF pending.GROUP_SPECIAL -->disabled="diabled"<!-- ENDIF --> /></dd>
+				<dd class="mark"><input type="radio" name="selected" value="{pending.GROUP_ID}" <!-- IF pending.GROUP_SPECIAL -->disabled="disabled"<!-- ENDIF --> /></dd>
 			</dl>
 		</li>
 		<!-- END pending -->
diff -ruN phpBB-3.0.10/styles/prosilver/template/ucp_main_front.html phpbb/styles/prosilver/template/ucp_main_front.html
--- phpBB-3.0.10/styles/prosilver/template/ucp_main_front.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/prosilver/template/ucp_main_front.html	2013-09-28 03:20:51.000000000 +0200
@@ -34,8 +34,8 @@
 		<dt>{L_JOINED}:</dt> <dd>{JOINED}</dd>
 		<dt>{L_VISITED}:</dt> <dd>{LAST_VISIT_YOU}</dd>
 		<dt>{L_TOTAL_POSTS}:</dt> <dd><!-- IF POSTS_PCT -->{POSTS}<!-- IF S_DISPLAY_SEARCH --> | <strong><a href="{U_SEARCH_USER}">{L_SEARCH_YOUR_POSTS}</a></strong><!-- ENDIF --><br />({POSTS_DAY} / {POSTS_PCT})<!-- ELSE -->{POSTS}<!-- ENDIF --></dd>
-		<!-- IF ACTIVE_FORUM --><dt>{L_ACTIVE_IN_FORUM}:</dt> <dd><strong><a href="{U_ACTIVE_FORUM}">{ACTIVE_FORUM}</a></strong><br />({ACTIVE_FORUM_POSTS} / {ACTIVE_FORUM_PCT})</dd><!-- ENDIF -->
-		<!-- IF ACTIVE_TOPIC --><dt>{L_ACTIVE_IN_TOPIC}:</dt> <dd><strong><a href="{U_ACTIVE_TOPIC}">{ACTIVE_TOPIC}</a></strong><br />({ACTIVE_TOPIC_POSTS} / {ACTIVE_TOPIC_PCT})</dd><!-- ENDIF -->
+		<!-- IF ACTIVE_FORUM != '' --><dt>{L_ACTIVE_IN_FORUM}:</dt> <dd><strong><a href="{U_ACTIVE_FORUM}">{ACTIVE_FORUM}</a></strong><br />({ACTIVE_FORUM_POSTS} / {ACTIVE_FORUM_PCT})</dd><!-- ENDIF -->
+		<!-- IF ACTIVE_TOPIC != '' --><dt>{L_ACTIVE_IN_TOPIC}:</dt> <dd><strong><a href="{U_ACTIVE_TOPIC}">{ACTIVE_TOPIC}</a></strong><br />({ACTIVE_TOPIC_POSTS} / {ACTIVE_TOPIC_PCT})</dd><!-- ENDIF -->
 		<!-- IF WARNINGS --><dt>{L_YOUR_WARNINGS}:</dt> <dd class="error">{WARNING_IMG} [{WARNINGS}]</dd><!-- ENDIF -->
 	</dl>
 
diff -ruN phpBB-3.0.10/styles/prosilver/template/ucp_pm_history.html phpbb/styles/prosilver/template/ucp_pm_history.html
--- phpBB-3.0.10/styles/prosilver/template/ucp_pm_history.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/prosilver/template/ucp_pm_history.html	2013-09-28 03:20:51.000000000 +0200
@@ -24,7 +24,7 @@
 			<h3><a href="{history_row.U_VIEW_MESSAGE}" <!-- IF history_row.S_CURRENT_MSG -->class="current"<!-- ENDIF -->>{history_row.SUBJECT}</a></h3>
 			<p class="author">{history_row.MINI_POST_IMG} {L_SENT_AT}: <strong>{history_row.SENT_DATE}</strong><br />
 				{L_MESSAGE_BY_AUTHOR} {history_row.MESSAGE_AUTHOR_FULL}</p>
-			<div class="content">{history_row.MESSAGE}</div>
+			<div class="content"><!-- IF history_row.MESSAGE -->{history_row.MESSAGE}<!-- ELSE --><span class="error">{L_MESSAGE_REMOVED_FROM_OUTBOX}</span><!-- ENDIF --></div>
 			<div id="message_{history_row.MSG_ID}" style="display: none;">{history_row.DECODED_MESSAGE}</div>
 		</div>
 
diff -ruN phpBB-3.0.10/styles/prosilver/template/ucp_pm_message_header.html phpbb/styles/prosilver/template/ucp_pm_message_header.html
--- phpBB-3.0.10/styles/prosilver/template/ucp_pm_message_header.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/prosilver/template/ucp_pm_message_header.html	2013-09-28 03:20:51.000000000 +0200
@@ -1,25 +1,22 @@
 <h2>{L_TITLE}<!-- IF CUR_FOLDER_NAME -->: {CUR_FOLDER_NAME}<!-- ENDIF --></h2>
 
-<div class="panel clearfix pm-panel-header<!-- IF S_VIEW_MESSAGE --> pm<!-- ENDIF -->">
+<form id="viewfolder" method="post" action="{S_PM_ACTION}">
+
+<div class="panel">
 	<div class="inner"><span class="corners-top"><span></span></span>
 
 	<!-- IF FOLDER_STATUS and FOLDER_MAX_MESSAGES neq 0 --><p>{FOLDER_STATUS}</p><!-- ENDIF -->
-
 	<!-- IF U_POST_REPLY_PM or U_POST_NEW_TOPIC or U_FORWARD_PM -->
 		<div class="buttons">
-			<!-- IF U_POST_REPLY_PM --><div class="pmreply-icon clearfix"><a title="{L_POST_REPLY_PM}" href="{U_POST_REPLY_PM}"><span></span>{L_POST_REPLY_PM}</a></div>
+			<!-- IF U_POST_REPLY_PM --><div class="pmreply-icon"><a title="{L_POST_REPLY_PM}" href="{U_POST_REPLY_PM}"><span></span>{L_POST_REPLY_PM}</a></div>
 			<!-- ELSEIF U_POST_NEW_TOPIC --><div class="newpm-icon"><a href="{U_POST_NEW_TOPIC}" accesskey="n" title="{L_UCP_PM_COMPOSE}"><span></span>{L_UCP_PM_COMPOSE}</a></div><!-- ENDIF -->
 			<!-- IF U_FORWARD_PM --><div class="forwardpm-icon"><a title="{L_POST_FORWARD_PM}" href="{U_FORWARD_PM}"><span></span>{L_FORWARD_PM}</a></div><!-- ENDIF -->
+			<!-- IF U_POST_REPLY_PM and S_PM_RECIPIENTS gt 1 --><div class="reply-all"><a class="left" title="{L_REPLY_TO_ALL}" href="{U_POST_REPLY_ALL}">{L_REPLY_TO_ALL}</a></div><!-- ENDIF -->			
 		</div>
-
-		<!-- IF U_POST_REPLY_PM and S_PM_RECIPIENTS gt 1 -->
-			<div class="reply-all"><a title="{L_REPLY_TO_ALL}" href="{U_POST_REPLY_ALL}">&raquo; {L_REPLY_TO_ALL}</a></div>
-		<!-- ENDIF -->
-
 	<!-- ENDIF -->
 
-		<!-- IF TOTAL_MESSAGES or S_VIEW_MESSAGE -->
-	<ul class="linklist pm-return-to">
+	<!-- IF TOTAL_MESSAGES or S_VIEW_MESSAGE -->
+	<ul class="linklist">
 		<li class="rightside pagination">
 			<!-- IF S_VIEW_MESSAGE --><a class="{S_CONTENT_FLOW_BEGIN}" href="{U_CURRENT_FOLDER}">{L_RETURN_TO} {CUR_FOLDER_NAME}</a><!-- ENDIF -->
 			<!-- IF FOLDER_CUR_MESSAGES neq 0 -->
@@ -28,8 +25,4 @@
 			<!-- ENDIF -->
 		</li>
 	</ul>
-		<!-- ENDIF -->
-	</div>
-</div>
-
-<form id="viewfolder" method="post" action="{S_PM_ACTION}">
+	<!-- ENDIF -->
diff -ruN phpBB-3.0.10/styles/prosilver/template/ucp_pm_viewfolder.html phpbb/styles/prosilver/template/ucp_pm_viewfolder.html
--- phpBB-3.0.10/styles/prosilver/template/ucp_pm_viewfolder.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/prosilver/template/ucp_pm_viewfolder.html	2013-09-28 03:20:51.000000000 +0200
@@ -2,7 +2,6 @@
 
 <!-- IF not PROMPT -->
 	<!-- INCLUDE ucp_pm_message_header.html -->
-	<div class="panel pm-panel-message"><div>
 <!-- ENDIF -->
 
 <!-- IF PROMPT -->
diff -ruN phpBB-3.0.10/styles/prosilver/template/ucp_pm_viewmessage.html phpbb/styles/prosilver/template/ucp_pm_viewmessage.html
--- phpBB-3.0.10/styles/prosilver/template/ucp_pm_viewmessage.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/prosilver/template/ucp_pm_viewmessage.html	2013-09-28 03:20:51.000000000 +0200
@@ -1,18 +1,21 @@
-	<!-- INCLUDE ucp_header.html -->
+<!-- INCLUDE ucp_header.html -->
 
 <!-- INCLUDE ucp_pm_message_header.html -->
 
+	<span class="corners-bottom"><span></span></span></div>
+</div>
+
 
 <!-- IF S_DISPLAY_HISTORY and (U_VIEW_PREVIOUS_HISTORY or U_VIEW_NEXT_HISTORY) -->
-	<fieldset class="display-options clearfix bg1 pm-message-nav">
+	<fieldset class="display-options clearfix">
 		<!-- IF U_VIEW_PREVIOUS_HISTORY --><a href="{U_VIEW_PREVIOUS_HISTORY}" class="left-box {S_CONTENT_FLOW_BEGIN}">{L_VIEW_PREVIOUS_HISTORY}</a><!-- ENDIF -->
 		<!-- IF U_VIEW_NEXT_HISTORY --><a href="{U_VIEW_NEXT_HISTORY}" class="right-box {S_CONTENT_FLOW_END}">{L_VIEW_NEXT_HISTORY}</a><!-- ENDIF -->
 	</fieldset>
 <!-- ENDIF -->
 
 
-<div id="post-{MESSAGE_ID}" class="panel clearfix post pm-panel-message pm<!-- IF S_POST_UNAPPROVED or S_POST_REPORTED --> reported<!-- ENDIF --><!-- IF S_ONLINE --> online<!-- ENDIF -->">
-<div>
+<div id="post-{MESSAGE_ID}" class="post pm<!-- IF S_POST_UNAPPROVED or S_POST_REPORTED --> reported<!-- ENDIF --><!-- IF S_ONLINE --> online<!-- ENDIF -->">
+<div class="inner"><span class="corners-top"><span></span></span>
 
 	<div class="postbody">
 
diff -ruN phpBB-3.0.10/styles/prosilver/template/ucp_pm_viewmessage_print.html phpbb/styles/prosilver/template/ucp_pm_viewmessage_print.html
--- phpBB-3.0.10/styles/prosilver/template/ucp_pm_viewmessage_print.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/prosilver/template/ucp_pm_viewmessage_print.html	2013-09-28 03:20:51.000000000 +0200
@@ -23,10 +23,9 @@
 
 	<div id="page-header">
 		<h1>{SITENAME}</h1>
-		<p>{SITE_DESCRIPTION}<br /><a href="{U_FORUM}">{U_FORUM}</a></p>
+		<p>{SITE_DESCRIPTION}</p>
 
-		<h2>{TOPIC_TITLE}</h2>
-		<p><a href="{U_TOPIC}">{U_TOPIC}</a></p>
+		<h2>{L_PRIVATE_MESSAGING}</h2>
 	</div>
 
 	<div id="page-body">
@@ -49,7 +48,7 @@
 
 	<div id="page-footer">
 		<div class="page-number">{S_TIMEZONE}<br />{PAGE_NUMBER}</div>
-		<div class="copyright">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</div>
+		<div class="copyright">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />https://www.phpbb.com/</div>
 	</div>
 </div>
 
diff -ruN phpBB-3.0.10/styles/prosilver/template/ucp_prefs_personal.html phpbb/styles/prosilver/template/ucp_prefs_personal.html
--- phpBB-3.0.10/styles/prosilver/template/ucp_prefs_personal.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/prosilver/template/ucp_prefs_personal.html	2013-09-28 03:20:51.000000000 +0200
@@ -63,11 +63,13 @@
 			<label for="popuppm0"><input type="radio" name="popuppm" id="popuppm0" value="0"<!-- IF not S_POPUP_PM --> checked="checked"<!-- ENDIF --> /> {L_NO}</label>
 		</dd>
 	</dl>
-	<dl>
-		<dt><label for="lang">{L_BOARD_LANGUAGE}:</label></dt>
-		<dd><select name="lang" id="lang">{S_LANG_OPTIONS}</select></dd>
-	</dl>
-	<!-- IF S_STYLE_OPTIONS -->
+	<!-- IF S_MORE_LANGUAGES -->
+		<dl>
+			<dt><label for="lang">{L_BOARD_LANGUAGE}:</label></dt>
+			<dd><select name="lang" id="lang">{S_LANG_OPTIONS}</select></dd>
+		</dl>
+	<!-- ENDIF -->
+	<!-- IF S_STYLE_OPTIONS and S_MORE_STYLES -->
 		<dl>
 			<dt><label for="style">{L_BOARD_STYLE}:</label></dt>
 			<dd><select name="style" id="style">{S_STYLE_OPTIONS}</select></dd>
diff -ruN phpBB-3.0.10/styles/prosilver/template/ucp_profile_reg_details.html phpbb/styles/prosilver/template/ucp_profile_reg_details.html
--- phpBB-3.0.10/styles/prosilver/template/ucp_profile_reg_details.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/prosilver/template/ucp_profile_reg_details.html	2013-09-28 03:20:51.000000000 +0200
@@ -45,7 +45,7 @@
 
 	<fieldset>
 	<dl>
-		<dt><label for="cur_password">{L_CURRENT_PASSWORD}:</label><br /><span>{L_CURRENT_PASSWORD_EXPLAIN}</span></dt>
+		<dt><label for="cur_password">{L_CURRENT_PASSWORD}:</label><br /><span><!-- IF S_CHANGE_PASSWORD -->{L_CURRENT_CHANGE_PASSWORD_EXPLAIN}<!-- ELSE -->{L_CURRENT_PASSWORD_EXPLAIN}<!-- ENDIF --></span></dt>
 		<dd><input type="password" name="cur_password" id="cur_password" maxlength="255" value="{CUR_PASSWORD}" class="inputbox" title="{L_CURRENT_PASSWORD}" /></dd>
 	</dl>
 	</fieldset>
@@ -54,7 +54,7 @@
 </div>
 
 <fieldset class="submit-buttons">
-	{S_HIDDEN_FIELDS}<input type="reset" value="{L_RESET}" name="reset" class="button2" />&nbsp; 
+	{S_HIDDEN_FIELDS}<input type="reset" value="{L_RESET}" name="reset" class="button2" />&nbsp;
 	<input type="submit" name="submit" value="{L_SUBMIT}" class="button1" />
 	{S_FORM_TOKEN}
 </fieldset>
diff -ruN phpBB-3.0.10/styles/prosilver/template/viewonline_body.html phpbb/styles/prosilver/template/viewonline_body.html
--- phpBB-3.0.10/styles/prosilver/template/viewonline_body.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/prosilver/template/viewonline_body.html	2013-09-28 03:20:51.000000000 +0200
@@ -7,7 +7,7 @@
 	<li class="rightside pagination"><!-- IF PAGINATION --><a href="#" onclick="jumpto(); return false;" title="{L_JUMP_TO_PAGE}">{PAGE_NUMBER}</a> &bull; <span>{PAGINATION}</span><!-- ELSE -->{PAGE_NUMBER}<!-- ENDIF --></li>
 </ul>
 
-<div class="forumbg">
+<div class="forumbg forumbg-table">
 	<div class="inner"><span class="corners-top"><span></span></span>
 	
 	<table class="table1" cellspacing="1">
diff -ruN phpBB-3.0.10/styles/prosilver/template/viewtopic_print.html phpbb/styles/prosilver/template/viewtopic_print.html
--- phpBB-3.0.10/styles/prosilver/template/viewtopic_print.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/prosilver/template/viewtopic_print.html	2013-09-28 03:20:51.000000000 +0200
@@ -44,7 +44,7 @@
 
 	<div id="page-footer">
 		<div class="page-number">{S_TIMEZONE}<br />{PAGE_NUMBER}</div>
-		<div class="copyright">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</div>
+		<div class="copyright">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />https://www.phpbb.com/</div>
 	</div>
 </div>
 
diff -ruN phpBB-3.0.10/styles/prosilver/theme/bidi.css phpbb/styles/prosilver/theme/bidi.css
--- phpBB-3.0.10/styles/prosilver/theme/bidi.css	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/prosilver/theme/bidi.css	2013-09-28 03:20:51.000000000 +0200
@@ -591,6 +591,19 @@
 /* PM Styles
 ----------------------------------------*/
 
+/* PM panel adjustments */
+.rtl .reply-all a.right {
+	background-position: 5% 60%;
+}
+
+.rtl .reply-all a.right:hover {
+	background-position: 3% 60%;
+}
+
+.rtl .reply-all {
+	padding-left: 5px;
+}
+
 /* Defined rules list for PM options */
 .rtl ol.def-rules {
 	padding-right: 0;
diff -ruN phpBB-3.0.10/styles/prosilver/theme/colours.css phpbb/styles/prosilver/theme/colours.css
--- phpBB-3.0.10/styles/prosilver/theme/colours.css	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/prosilver/theme/colours.css	2013-09-28 03:20:51.000000000 +0200
@@ -884,12 +884,6 @@
 	color: #000000 !important;
 }
 
-/* PM panel adjustments */
-.pm-panel-header,
-#cp-main .pm-message-nav {
-	border-bottom-color: #A4B3BF;
-}
-
 /* PM marking colours */
 .pmlist li.pm_message_reported_colour, .pm_message_reported_colour {
 	border-left-color: #BC2A4D;
diff -ruN phpBB-3.0.10/styles/prosilver/theme/common.css phpbb/styles/prosilver/theme/common.css
--- phpBB-3.0.10/styles/prosilver/theme/common.css	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/prosilver/theme/common.css	2013-09-28 03:20:51.000000000 +0200
@@ -418,7 +418,19 @@
 }
 
 .forumbg table.table1 {
-	margin: 0 -2px -1px -1px;
+	margin: 0;
+}
+
+.forumbg-table > .inner {
+	margin: 0 -1px;
+}
+
+.forumbg-table > .inner > span.corners-top {
+	margin: 0 -4px -1px -4px;
+}
+
+.forumbg-table > .inner > span.corners-bottom {
+	margin: -1px -4px 0 -4px;
 }
 
 /* Misc layout styles
diff -ruN phpBB-3.0.10/styles/prosilver/theme/cp.css phpbb/styles/prosilver/theme/cp.css
--- phpBB-3.0.10/styles/prosilver/theme/cp.css	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/prosilver/theme/cp.css	2013-09-28 03:20:51.000000000 +0200
@@ -104,6 +104,22 @@
 	width: 100%;
 }
 
+.tabs-container h2 {
+	float: left;
+	margin-bottom: 0px;
+}
+
+.tabs-container #minitabs {
+	float: right;
+	margin-top: 19px;
+}
+
+.tabs-container:after {
+	display: block;
+	clear: both;
+	content: '';
+}
+
 /* CP tabbed menu
 ----------------------------------------*/
 #tabs {
@@ -349,31 +365,17 @@
 }
 
 /* PM panel adjustments */
-.pm-panel-header {
-	margin: 0; 
-	padding-bottom: 10px; 
-	border-bottom: 1px dashed #A4B3BF;
+.reply-all a.left {
+	background-position: 3px 60%;
 }
 
-.reply-all {
-	display: block; 
-	padding-top: 4px; 
-	clear: both;
-	float: left;
+.reply-all a.left:hover {
+	background-position: 0px 60%;
 }
 
-.pm-panel-message {
-	padding-top: 10px;
-}
-
-.pm-return-to {
-	padding-top: 23px;
-}
-
-#cp-main .pm-message-nav {
-	margin: 0; 
-	padding: 2px 10px 5px 10px; 
-	border-bottom: 1px dashed #A4B3BF;
+.reply-all {
+	font-size: 11px;
+	padding-top: 5px;
 }
 
 /* PM Message history */
diff -ruN phpBB-3.0.10/styles/prosilver/theme/stylesheet.css phpbb/styles/prosilver/theme/stylesheet.css
--- phpBB-3.0.10/styles/prosilver/theme/stylesheet.css	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/prosilver/theme/stylesheet.css	2013-09-28 03:20:51.000000000 +0200
@@ -3,7 +3,7 @@
 	Style name:			prosilver (the default phpBB 3.0.x style)
 	Based on style:		
 	Original author:	Tom Beddard ( http://www.subblue.com/ )
-	Modified by:		phpBB Group ( http://www.phpbb.com/ )
+	Modified by:		phpBB Group ( https://www.phpbb.com/ )
     --------------------------------------------------------------
 */
 
diff -ruN phpBB-3.0.10/styles/prosilver/theme/theme.cfg phpbb/styles/prosilver/theme/theme.cfg
--- phpBB-3.0.10/styles/prosilver/theme/theme.cfg	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/prosilver/theme/theme.cfg	2013-09-28 03:20:51.000000000 +0200
@@ -21,7 +21,7 @@
 # General Information about this theme
 name = prosilver
 copyright = &copy; phpBB Group, 2007
-version = 3.0.10
+version = 3.0.12
 
 # Some configuration options
 
diff -ruN phpBB-3.0.10/styles/prosilver/theme/tweaks.css phpbb/styles/prosilver/theme/tweaks.css
--- phpBB-3.0.10/styles/prosilver/theme/tweaks.css	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/prosilver/theme/tweaks.css	2013-09-28 03:20:51.000000000 +0200
@@ -87,10 +87,6 @@
 	float: none;
 }
 
-* html .forumbg table.table1 {
-	margin: 0 -2px 0px -1px;
-}
-
 /* Headerbar height fix for IE7 and below */
 * html #site-description p {
 	margin-bottom: 1.0em;
@@ -98,4 +94,14 @@
 
 *:first-child+html #site-description p {
 	margin-bottom: 1.0em;
+}
+
+/* #minitabs fix for IE */
+.tabs-container {
+	zoom: 1;
+}
+
+#minitabs {
+	white-space: nowrap;
+	*min-width: 50%;
 }
\ No newline at end of file
Binary files phpBB-3.0.10/styles/spring/imageset/announce_read.gif and phpbb/styles/spring/imageset/announce_read.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/announce_read_locked.gif and phpbb/styles/spring/imageset/announce_read_locked.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/announce_read_locked_mine.gif and phpbb/styles/spring/imageset/announce_read_locked_mine.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/announce_read_mine.gif and phpbb/styles/spring/imageset/announce_read_mine.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/announce_unread.gif and phpbb/styles/spring/imageset/announce_unread.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/announce_unread_locked.gif and phpbb/styles/spring/imageset/announce_unread_locked.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/announce_unread_locked_mine.gif and phpbb/styles/spring/imageset/announce_unread_locked_mine.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/announce_unread_mine.gif and phpbb/styles/spring/imageset/announce_unread_mine.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/en/button_pm_new.gif and phpbb/styles/spring/imageset/en/button_pm_new.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/en/button_pm_reply.gif and phpbb/styles/spring/imageset/en/button_pm_reply.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/en/button_topic_locked.gif and phpbb/styles/spring/imageset/en/button_topic_locked.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/en/button_topic_new.gif and phpbb/styles/spring/imageset/en/button_topic_new.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/en/button_topic_reply.gif and phpbb/styles/spring/imageset/en/button_topic_reply.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/en/icon_contact_aim.gif and phpbb/styles/spring/imageset/en/icon_contact_aim.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/en/icon_contact_email.gif and phpbb/styles/spring/imageset/en/icon_contact_email.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/en/icon_contact_icq.gif and phpbb/styles/spring/imageset/en/icon_contact_icq.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/en/icon_contact_jabber.gif and phpbb/styles/spring/imageset/en/icon_contact_jabber.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/en/icon_contact_msnm.gif and phpbb/styles/spring/imageset/en/icon_contact_msnm.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/en/icon_contact_pm.gif and phpbb/styles/spring/imageset/en/icon_contact_pm.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/en/icon_contact_www.gif and phpbb/styles/spring/imageset/en/icon_contact_www.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/en/icon_contact_yahoo.gif and phpbb/styles/spring/imageset/en/icon_contact_yahoo.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/en/icon_post_delete.gif and phpbb/styles/spring/imageset/en/icon_post_delete.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/en/icon_post_edit.gif and phpbb/styles/spring/imageset/en/icon_post_edit.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/en/icon_post_info.gif and phpbb/styles/spring/imageset/en/icon_post_info.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/en/icon_post_quote.gif and phpbb/styles/spring/imageset/en/icon_post_quote.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/en/icon_post_report.gif and phpbb/styles/spring/imageset/en/icon_post_report.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/en/icon_user_offline.gif and phpbb/styles/spring/imageset/en/icon_user_offline.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/en/icon_user_online.gif and phpbb/styles/spring/imageset/en/icon_user_online.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/en/icon_user_profile.gif and phpbb/styles/spring/imageset/en/icon_user_profile.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/en/icon_user_search.gif and phpbb/styles/spring/imageset/en/icon_user_search.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/en/icon_user_warn.gif and phpbb/styles/spring/imageset/en/icon_user_warn.gif differ
diff -ruN phpBB-3.0.10/styles/spring/imageset/en/imageset.cfg phpbb/styles/spring/imageset/en/imageset.cfg
--- phpBB-3.0.10/styles/spring/imageset/en/imageset.cfg	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/imageset/en/imageset.cfg	2014-04-06 06:50:24.000000000 +0200
@@ -0,0 +1,47 @@
+#
+# phpBB Imageset Configuration File
+#
+# @package phpBB3
+# @copyright (c) 2005 phpBB Group 
+# @license http://opensource.org/licenses/gpl-license.php GNU Public License 
+#
+#
+# At the left is the name, please do not change this
+# At the right the value is entered
+# For on/off options the valid values are on, off, 1, 0, true and false
+#
+# Values get trimmed, if you want to add a space in front or at the end of
+# the value, then enclose the value with single or double quotes. 
+# Single and double quotes do not need to be escaped.
+#
+#
+
+# Images 
+img_icon_contact_aim = icon_contact_aim.gif
+img_icon_contact_email = icon_contact_email.gif
+img_icon_contact_icq = icon_contact_icq.gif
+img_icon_contact_jabber = icon_contact_jabber.gif
+img_icon_contact_msnm = icon_contact_msnm.gif
+img_icon_contact_pm = icon_contact_pm.gif
+img_icon_contact_yahoo = icon_contact_yahoo.gif
+img_icon_contact_www = icon_contact_www.gif
+
+img_icon_post_delete = icon_post_delete.gif
+img_icon_post_edit = icon_post_edit.gif
+img_icon_post_info = icon_post_info.gif
+img_icon_post_quote = icon_post_quote.gif
+img_icon_post_report = icon_post_report.gif
+
+img_icon_user_online = icon_user_online.gif
+img_icon_user_offline = icon_user_offline.gif
+img_icon_user_profile = icon_user_profile.gif
+img_icon_user_search = icon_user_search.gif
+img_icon_user_warn = icon_user_warn.gif
+
+img_button_pm_forward =
+img_button_pm_new = button_pm_new.gif
+img_button_pm_reply = button_pm_reply.gif
+img_button_topic_locked = button_topic_locked.gif
+img_button_topic_new = button_topic_new.gif
+img_button_topic_reply = button_topic_reply.gif
+
Binary files phpBB-3.0.10/styles/spring/imageset/forum_link.gif and phpbb/styles/spring/imageset/forum_link.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/forum_read.gif and phpbb/styles/spring/imageset/forum_read.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/forum_read_locked.gif and phpbb/styles/spring/imageset/forum_read_locked.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/forum_read_subforum.gif and phpbb/styles/spring/imageset/forum_read_subforum.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/forum_unread.gif and phpbb/styles/spring/imageset/forum_unread.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/forum_unread_locked.gif and phpbb/styles/spring/imageset/forum_unread_locked.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/forum_unread_subforum.gif and phpbb/styles/spring/imageset/forum_unread_subforum.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/icon_post_target.gif and phpbb/styles/spring/imageset/icon_post_target.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/icon_post_target_unread.gif and phpbb/styles/spring/imageset/icon_post_target_unread.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/icon_topic_attach.gif and phpbb/styles/spring/imageset/icon_topic_attach.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/icon_topic_latest.gif and phpbb/styles/spring/imageset/icon_topic_latest.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/icon_topic_newest.gif and phpbb/styles/spring/imageset/icon_topic_newest.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/icon_topic_reported.gif and phpbb/styles/spring/imageset/icon_topic_reported.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/icon_topic_unapproved.gif and phpbb/styles/spring/imageset/icon_topic_unapproved.gif differ
diff -ruN phpBB-3.0.10/styles/spring/imageset/imageset.cfg phpbb/styles/spring/imageset/imageset.cfg
--- phpBB-3.0.10/styles/spring/imageset/imageset.cfg	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/imageset/imageset.cfg	2014-04-06 06:50:24.000000000 +0200
@@ -0,0 +1,100 @@
+#
+# phpBB Imageset Configuration File
+#
+# @package phpBB3
+# @copyright (c) 2005 phpBB Group
+# @license http://opensource.org/licenses/gpl-license.php GNU Public License
+#
+#
+# At the left is the name, please do not change this
+# At the right the value is entered
+# For on/off options the valid values are on, off, 1, 0, true and false
+#
+# Values get trimmed, if you want to add a space in front or at the end of
+# the value, then enclose the value with single or double quotes.
+# Single and double quotes do not need to be escaped.
+#
+#
+
+# General Information about this style
+name = subsilver2spring
+copyright = &copy; phpBB Group, 2003
+version = 3.0.10
+
+# Images
+img_site_logo = site_logo.gif*94*170
+img_upload_bar = upload_bar.gif*16*280
+img_poll_left = poll_left.gif*12*4
+img_poll_center = poll_center.gif*12*1
+img_poll_right = poll_right.gif*12*4
+img_icon_friend =
+img_icon_foe =
+
+img_forum_link = forum_link.gif*25*46
+img_forum_read = forum_read.gif*25*46
+img_forum_read_locked = forum_read_locked.gif*25*46
+img_forum_read_subforum = forum_read_subforum.gif*25*46
+img_forum_unread = forum_unread.gif*25*46
+img_forum_unread_locked = forum_unread_locked.gif*25*46
+img_forum_unread_subforum = forum_unread_subforum.gif*25*46
+
+img_topic_moved = topic_moved.gif*18*19
+
+img_topic_read = topic_read.gif*18*19
+img_topic_read_mine = topic_read_mine.gif*18*19
+img_topic_read_hot = topic_read_hot.gif*18*19
+img_topic_read_hot_mine = topic_read_hot_mine.gif*18*19
+img_topic_read_locked = topic_read_locked.gif*18*19
+img_topic_read_locked_mine = topic_read_locked_mine.gif*18*19
+
+img_topic_unread = topic_unread.gif*18*19
+img_topic_unread_mine = topic_unread_mine.gif*18*19
+img_topic_unread_hot = topic_unread_hot.gif*18*19
+img_topic_unread_hot_mine = topic_unread_hot_mine.gif*18*19
+img_topic_unread_locked = topic_unread_locked.gif*18*19
+img_topic_unread_locked_mine = topic_unread_locked_mine.gif*18*19
+
+img_sticky_read = sticky_read.gif*18*19
+img_sticky_read_mine = sticky_read_mine.gif*18*19
+img_sticky_read_locked = sticky_read_locked.gif*18*19
+img_sticky_read_locked_mine = sticky_read_locked_mine.gif*18*19
+img_sticky_unread = sticky_unread.gif*18*19
+img_sticky_unread_mine = sticky_unread_mine.gif*18*19
+img_sticky_unread_locked = sticky_unread_locked.gif*18*19
+img_sticky_unread_locked_mine = sticky_unread_locked_mine.gif*18*19
+
+img_announce_read = announce_read.gif*18*19
+img_announce_read_mine = announce_read_mine.gif*18*19
+img_announce_read_locked = announce_read_locked.gif*18*19
+img_announce_read_locked_mine = announce_read_locked_mine.gif*18*19
+img_announce_unread = announce_unread.gif*18*19
+img_announce_unread_mine = announce_unread_mine.gif*18*19
+img_announce_unread_locked = announce_unread_locked.gif*18*19
+img_announce_unread_locked_mine = announce_unread_locked_mine.gif*18*19
+
+img_global_read = announce_read.gif*18*19
+img_global_read_mine = announce_read_mine.gif*18*19
+img_global_read_locked = announce_read_locked.gif*18*19
+img_global_read_locked_mine = announce_read_locked_mine.gif*18*19
+img_global_unread = announce_unread.gif*18*19
+img_global_unread_mine = announce_unread_mine.gif*18*19
+img_global_unread_locked = announce_unread_locked.gif*18*19
+img_global_unread_locked_mine = announce_unread_locked_mine.gif*18*19
+
+img_subforum_read =
+img_subforum_unread =
+
+img_pm_read = topic_read.gif*18*19
+img_pm_unread = topic_unread.gif*18*19
+
+img_icon_back_top =
+
+img_icon_post_target = icon_post_target.gif*9*12
+img_icon_post_target_unread = icon_post_target_unread.gif*9*12
+
+img_icon_topic_attach = icon_topic_attach.gif*18*14
+img_icon_topic_latest = icon_topic_latest.gif*9*18
+img_icon_topic_newest = icon_topic_newest.gif*9*18
+img_icon_topic_reported = icon_topic_reported.gif*18*19
+img_icon_topic_unapproved = icon_topic_unapproved.gif*18*19
+
Binary files phpBB-3.0.10/styles/spring/imageset/poll_center.gif and phpbb/styles/spring/imageset/poll_center.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/poll_left.gif and phpbb/styles/spring/imageset/poll_left.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/poll_right.gif and phpbb/styles/spring/imageset/poll_right.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/site_logo.gif and phpbb/styles/spring/imageset/site_logo.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/sticky_read.gif and phpbb/styles/spring/imageset/sticky_read.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/sticky_read_locked.gif and phpbb/styles/spring/imageset/sticky_read_locked.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/sticky_read_locked_mine.gif and phpbb/styles/spring/imageset/sticky_read_locked_mine.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/sticky_read_mine.gif and phpbb/styles/spring/imageset/sticky_read_mine.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/sticky_unread.gif and phpbb/styles/spring/imageset/sticky_unread.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/sticky_unread_locked.gif and phpbb/styles/spring/imageset/sticky_unread_locked.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/sticky_unread_locked_mine.gif and phpbb/styles/spring/imageset/sticky_unread_locked_mine.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/sticky_unread_mine.gif and phpbb/styles/spring/imageset/sticky_unread_mine.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/topic_moved.gif and phpbb/styles/spring/imageset/topic_moved.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/topic_read.gif and phpbb/styles/spring/imageset/topic_read.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/topic_read_hot.gif and phpbb/styles/spring/imageset/topic_read_hot.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/topic_read_hot_mine.gif and phpbb/styles/spring/imageset/topic_read_hot_mine.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/topic_read_locked.gif and phpbb/styles/spring/imageset/topic_read_locked.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/topic_read_locked_mine.gif and phpbb/styles/spring/imageset/topic_read_locked_mine.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/topic_read_mine.gif and phpbb/styles/spring/imageset/topic_read_mine.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/topic_unread.gif and phpbb/styles/spring/imageset/topic_unread.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/topic_unread_hot.gif and phpbb/styles/spring/imageset/topic_unread_hot.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/topic_unread_hot_mine.gif and phpbb/styles/spring/imageset/topic_unread_hot_mine.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/topic_unread_locked.gif and phpbb/styles/spring/imageset/topic_unread_locked.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/topic_unread_locked_mine.gif and phpbb/styles/spring/imageset/topic_unread_locked_mine.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/topic_unread_mine.gif and phpbb/styles/spring/imageset/topic_unread_mine.gif differ
Binary files phpBB-3.0.10/styles/spring/imageset/upload_bar.gif and phpbb/styles/spring/imageset/upload_bar.gif differ
diff -ruN phpBB-3.0.10/styles/spring/style.cfg phpbb/styles/spring/style.cfg
--- phpBB-3.0.10/styles/spring/style.cfg	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/style.cfg	2014-04-15 14:31:18.669429005 +0200
@@ -0,0 +1,22 @@
+#
+# phpBB Style Configuration File
+#
+# @package phpBB3
+# @copyright (c) 2005 phpBB Group
+# @license http://opensource.org/licenses/gpl-license.php GNU Public License
+#
+#
+# At the left is the name, please do not change this
+# At the right the value is entered
+# For on/off options the valid values are on, off, 1, 0, true and false
+#
+# Values get trimmed, if you want to add a space in front or at the end of
+# the value, then enclose the value with single or double quotes.
+# Single and double quotes do not need to be escaped.
+#
+#
+
+# General Information about this style
+name = springstyle
+copyright = &copy; 2005 phpBB Group
+version = 3.0.10
diff -ruN phpBB-3.0.10/styles/spring/template/attachment.html phpbb/styles/spring/template/attachment.html
--- phpBB-3.0.10/styles/spring/template/attachment.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/attachment.html	2014-04-15 14:31:18.670429005 +0200
@@ -0,0 +1,121 @@
+
+<!-- BEGIN _file -->
+
+	<!-- IF _file.S_DENIED -->
+		<span class="genmed">[{_file.DENIED_MESSAGE}]</span><br />
+	<!-- ELSE -->
+
+		<!-- IF _file.COMMENT -->
+			<span class="gensmall"><b>{L_FILE_COMMENT}:</b> {_file.COMMENT}</span><br />
+		<!-- ENDIF -->
+
+		<!-- IF _file.S_THUMBNAIL -->
+			<a href="{_file.U_DOWNLOAD_LINK}"><img src="{_file.THUMB_IMAGE}" alt="{_file.DOWNLOAD_NAME}" /></a><br />
+			<span class="gensmall">{_file.DOWNLOAD_NAME} [ {_file.FILESIZE} {_file.SIZE_LANG} | {_file.L_DOWNLOAD_COUNT} ]</span>
+		<!-- ENDIF -->
+
+		<!-- IF _file.S_IMAGE -->
+			<img src="{_file.U_INLINE_LINK}" alt="{_file.DOWNLOAD_NAME}" /><br />
+			<span class="gensmall">{_file.DOWNLOAD_NAME} [ {_file.FILESIZE} {_file.SIZE_LANG} | {_file.L_DOWNLOAD_COUNT} ]</span>
+		<!-- ENDIF -->
+
+		<!-- IF _file.S_FILE -->
+			<span class="genmed">
+				<!-- IF _file.UPLOAD_ICON -->{_file.UPLOAD_ICON} <!-- ENDIF -->
+				<a href="{_file.U_DOWNLOAD_LINK}">{_file.DOWNLOAD_NAME}</a> [{_file.FILESIZE} {_file.SIZE_LANG}]
+			</span><br />
+			<span class="gensmall">{_file.L_DOWNLOAD_COUNT}</span>
+		<!-- ENDIF -->
+
+		<!-- IF _file.S_WM_FILE -->
+			<!-- method used here from http://alistapart.com/articles/byebyeembed / autosizing seems to not work always, this will not fix -->
+			<object width="320" height="285" classid="CLSID:6BF52A52-394A-11d3-B153-00C04F79FAA6" id="wmstream_{_file.ATTACH_ID}">
+				<param name="url" value="{_file.U_DOWNLOAD_LINK}" />
+				<param name="showcontrols" value="1" />
+				<param name="showdisplay" value="0" />
+				<param name="showstatusbar" value="0" />
+				<param name="autosize" value="1" />
+				<param name="autostart" value="0" />
+				<param name="visible" value="1" />
+				<param name="animationstart" value="0" />
+				<param name="loop" value="0" />
+				<param name="src" value="{_file.U_DOWNLOAD_LINK}" />
+				<!--[if !IE]>-->
+					<object width="320" height="285" type="video/x-ms-wmv" data="{_file.U_DOWNLOAD_LINK}">
+						<param name="src" value="{_file.U_DOWNLOAD_LINK}" />
+						<param name="controller" value="1" />
+						<param name="showcontrols" value="1" />
+						<param name="showdisplay" value="0" />
+						<param name="showstatusbar" value="0" />
+						<param name="autosize" value="1" />
+						<param name="autostart" value="0" />
+						<param name="visible" value="1" />
+						<param name="animationstart" value="0" />
+						<param name="loop" value="0" />
+					</object>
+				<!--<![endif]-->
+			</object>
+
+		<!-- ELSEIF _file.S_FLASH_FILE -->
+			<object classid="clsid:D27CDB6E-AE6D-11CF-96B8-444553540000" codebase="http://active.macromedia.com/flash2/cabs/swflash.cab#version=5,0,0,0" width="{_file.WIDTH}" height="{_file.HEIGHT}">
+				<param name="movie" value="{_file.U_VIEW_LINK}" />
+				<param name="play" value="true" />
+				<param name="loop" value="true" />
+				<param name="quality" value="high" />
+				<param name="allowScriptAccess" value="never" />
+				<param name="allowNetworking" value="internal" />
+				<embed src="{_file.U_VIEW_LINK}" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/shockwave/download/index.cgi?P1_Prod_Version=ShockwaveFlash" width="{_file.WIDTH}" height="{_file.HEIGHT}" play="true" loop="true" quality="high" allowscriptaccess="never" allownetworking="internal"></embed>
+			</object>
+		<!-- ELSEIF _file.S_QUICKTIME_FILE -->
+			<object id="qtstream_{_file.ATTACH_ID}" classid="clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B" codebase="http://www.apple.com/qtactivex/qtplugin.cab#version=6,0,2,0" width="320" height="285">
+				<param name="src" value="{_file.U_DOWNLOAD_LINK}">
+				<param name="controller" value="true">
+				<param name="autoplay" value="false" />
+				<param name="type" value="video/quicktime">
+				<embed name="qtstream_{_file.ATTACH_ID}" src="{_file.U_DOWNLOAD_LINK}" pluginspage="http://www.apple.com/quicktime/download/" enablejavascript="true" controller="true" width="320" height="285" type="video/quicktime" autoplay="false"></embed>
+			</object>
+		<!-- ELSEIF _file.S_RM_FILE -->
+			<object id="rmstream_{_file.ATTACH_ID}" classid="clsid:CFCDAA03-8BE4-11cf-B84B-0020AFBBCCFA" width="200" height="50">
+				<param name="src" value="{_file.U_DOWNLOAD_LINK}">
+				<param name="autostart" value="false">
+				<param name="controls" value="ImageWindow">
+				<param name="console" value="ctrls_{_file.ATTACH_ID}">
+				<param name="prefetch" value="false">
+				<embed name="rmstream_{_file.ATTACH_ID}" type="audio/x-pn-realaudio-plugin" src="{_file.U_DOWNLOAD_LINK}" width="0" height="0" autostart="false" controls="ImageWindow" console="ctrls_{_file.ATTACH_ID}" prefetch="false"></embed>
+			</object>
+			<br />
+			<object id="ctrls_{_file.ATTACH_ID}" classid="clsid:CFCDAA03-8BE4-11cf-B84B-0020AFBBCCFA" width="0" height="36">
+				<param name="controls" value="ControlPanel">
+				<param name="console" value="ctrls_{_file.ATTACH_ID}">
+				<embed name="ctrls_{_file.ATTACH_ID}" type="audio/x-pn-realaudio-plugin" width="200" height="36" controls="ControlPanel" console="ctrls_{_file.ATTACH_ID}"></embed>
+			</object>
+
+			<script type="text/javascript">
+			// <![CDATA[
+				if (document.rmstream_{_file.ATTACH_ID}.GetClipWidth)
+				{
+					while (!document.rmstream_{_file.ATTACH_ID}.GetClipWidth())
+					{
+					}
+
+					var width = document.rmstream_{_file.ATTACH_ID}.GetClipWidth();
+					var height = document.rmstream_{_file.ATTACH_ID}.GetClipHeight();
+
+					document.rmstream_{_file.ATTACH_ID}.width = width;
+					document.rmstream_{_file.ATTACH_ID}.height = height;
+					document.ctrls_{_file.ATTACH_ID}.width = width;
+				}
+			// ]]>
+			</script>
+		<!-- ENDIF -->
+
+		<!-- IF _file.S_WM_FILE or _file.S_RM_FILE or _file.S_FLASH_FILE or _file.S_QUICKTIME_FILE -->
+			<br />
+			<!-- IF _file.S_QUICKTIME_FILE --><a href="#" onclick="play_qt_file(document.qtstream_{_file.ATTACH_ID}); return false;">[ {L_PLAY_QUICKTIME_FILE} ]</a> <!-- ENDIF -->
+			<span class="gensmall"><a href="{_file.U_DOWNLOAD_LINK}">{_file.DOWNLOAD_NAME}</a> [ {_file.FILESIZE} {_file.SIZE_LANG} | {_file.L_DOWNLOAD_COUNT} ]</span>
+		<!-- ENDIF -->
+
+		<br />
+	<!-- ENDIF -->
+
+<!-- END _file -->
diff -ruN phpBB-3.0.10/styles/spring/template/bbcode.html phpbb/styles/spring/template/bbcode.html
--- phpBB-3.0.10/styles/spring/template/bbcode.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/bbcode.html	2014-04-15 14:31:18.670429005 +0200
@@ -0,0 +1,69 @@
+<!-- BEGIN ulist_open --><ul style="list-style-type: {LIST_TYPE}"><!-- END ulist_open -->
+<!-- BEGIN ulist_open_default --><ul><!-- END ulist_open_default -->
+<!-- BEGIN ulist_close --></ul><!-- END ulist_close -->
+
+<!-- BEGIN olist_open --><ol style="list-style-type: {LIST_TYPE}"><!-- END olist_open -->
+<!-- BEGIN olist_close --></ol><!-- END olist_close -->
+
+<!-- BEGIN listitem --><li><!-- END listitem -->
+<!-- BEGIN listitem_close --></li><!-- END listitem_close -->
+
+<!-- BEGIN quote_username_open -->
+<div class="quotetitle">{USERNAME} {L_WROTE}:</div><div class="quotecontent">
+<!-- END quote_username_open -->
+
+<!-- BEGIN quote_open -->
+<div class="quotetitle"><b>{L_QUOTE}:</b></div><div class="quotecontent">
+<!-- END quote_open -->
+
+<!-- BEGIN quote_close -->
+</div>
+<!-- END quote_close -->
+
+<!-- BEGIN code_open -->
+<div class="codetitle"><b>{L_CODE}:</b></div><div class="codecontent">
+<!-- END code_open -->
+
+<!-- BEGIN code_close -->
+</div>
+<!-- END code_close -->
+
+<!-- BEGIN inline_attachment_open -->
+<div class="attachtitle">{L_ATTACHMENT}:</div><div class="attachcontent">
+<!-- END inline_attachment_open -->
+
+<!-- BEGIN inline_attachment_close -->
+</div>
+<!-- END inline_attachment_close -->
+
+
+<!-- BEGIN b_open --><strong><!-- END b_open -->
+<!-- BEGIN b_close --></strong><!-- END b_close -->
+
+<!-- BEGIN u_open --><span style="text-decoration: underline"><!-- END u_open -->
+<!-- BEGIN u_close --></span><!-- END u_close -->
+
+<!-- BEGIN i_open --><em><!-- END i_open -->
+<!-- BEGIN i_close --></em><!-- END i_close -->
+
+<!-- BEGIN color --><span style="color: {COLOR}">{TEXT}</span><!-- END color -->
+
+<!-- BEGIN size --><span style="font-size: {SIZE}%; line-height: normal">{TEXT}</span><!-- END size -->
+
+<!-- BEGIN img --><img src="{URL}" alt="{L_IMAGE}" /><!-- END img -->
+
+<!-- BEGIN url --><a href="{URL}" class="postlink" target="_blank">{DESCRIPTION}</a><!-- END url -->
+
+<!-- BEGIN email --><a href="mailto:{EMAIL}">{DESCRIPTION}</a><!-- END email -->
+
+<!-- BEGIN flash -->
+	<object classid="clsid:D27CDB6E-AE6D-11CF-96B8-444553540000" codebase="http://active.macromedia.com/flash2/cabs/swflash.cab#version=5,0,0,0" width="{WIDTH}" height="{HEIGHT}">
+		<param name="movie" value="{URL}" />
+		<param name="play" value="false" />
+		<param name="loop" value="false" />
+		<param name="quality" value="high" />
+		<param name="allowScriptAccess" value="never" />
+		<param name="allowNetworking" value="internal" />
+		<embed src="{URL}" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/shockwave/download/index.cgi?P1_Prod_Version=ShockwaveFlash" width="{WIDTH}" height="{HEIGHT}" play="false" loop="false" quality="high" allowscriptaccess="never" allownetworking="internal"></embed>
+	</object>
+<!-- END flash -->
diff -ruN phpBB-3.0.10/styles/spring/template/breadcrumbs.html phpbb/styles/spring/template/breadcrumbs.html
--- phpBB-3.0.10/styles/spring/template/breadcrumbs.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/breadcrumbs.html	2014-04-15 14:31:18.671429005 +0200
@@ -0,0 +1,8 @@
+<table class="tablebg" width="100%" cellspacing="1" cellpadding="0" style="margin-top: 0px;">
+	<tr>
+		<td class="row1">
+			<p class="breadcrumbs"><a href="{U_INDEX}">{L_INDEX}</a><!-- BEGIN navlinks --> &#187; <a href="{navlinks.U_VIEW_FORUM}">{navlinks.FORUM_NAME}</a><!-- END navlinks --></p>
+			<p class="datetime">{S_TIMEZONE}</p>
+		</td>
+	</tr>
+	</table>
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/captcha_default.html phpbb/styles/spring/template/captcha_default.html
--- phpBB-3.0.10/styles/spring/template/captcha_default.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/captcha_default.html	2014-04-15 14:31:18.671429005 +0200
@@ -0,0 +1,17 @@
+	<tr>
+		<th colspan="2" valign="middle">{L_CONFIRM_CODE}</th>
+	</tr>
+	<!-- IF S_TYPE == 1 -->
+	<tr>
+		<td class="row3" colspan="2"><span class="gensmall">{L_CONFIRM_EXPLAIN}</span></td>
+	</tr>
+	<!-- ENDIF -->	
+	<tr>
+		<td class="row1" colspan="2" align="center"><img src="{CONFIRM_IMAGE_LINK}" alt="{L_CONFIRM_CODE}" />
+		<input type="hidden" name="confirm_id" id="confirm_id" value="{CONFIRM_ID}" /></td>
+	</tr>
+	<tr>
+		<td class="row1"><b class="genmed">{L_CONFIRM_CODE}:</b><br /><span class="gensmall">{L_CONFIRM_CODE_EXPLAIN}</span></td>
+		<td class="row2"><input class="post" type="text" name="confirm_code" size="8" maxlength="8" />
+		<!-- IF S_CONFIRM_REFRESH --><input type="submit" name="refresh_vc" id="refresh_vc" class="btnlite" value="{L_VC_REFRESH}" /><!-- ENDIF --></td>
+	</tr>
diff -ruN phpBB-3.0.10/styles/spring/template/captcha_qa.html phpbb/styles/spring/template/captcha_qa.html
--- phpBB-3.0.10/styles/spring/template/captcha_qa.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/captcha_qa.html	2014-04-15 14:31:18.671429005 +0200
@@ -0,0 +1,8 @@
+	<tr>
+		<th colspan="2" valign="middle">{L_CONFIRM_QUESTION}</th>
+	</tr>
+	<tr>
+		<td class="row1"><b class="genmed">{QA_CONFIRM_QUESTION}:</b><br /><span class="gensmall">{L_CONFIRM_QUESTION_EXPLAIN}</span></td>
+		<td class="row2"><input class="post" type="text" name="qa_answer" size="80" /></td>
+		<input type="hidden" name="qa_confirm_id" id="confirm_id" value="{QA_CONFIRM_ID}" /></td>
+	</tr>
diff -ruN phpBB-3.0.10/styles/spring/template/captcha_recaptcha.html phpbb/styles/spring/template/captcha_recaptcha.html
--- phpBB-3.0.10/styles/spring/template/captcha_recaptcha.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/captcha_recaptcha.html	2014-04-15 14:31:18.672429005 +0200
@@ -0,0 +1,36 @@
+<!-- IF S_RECAPTCHA_AVAILABLE -->
+	<tr>
+		<th colspan="2" valign="middle">{L_CONFIRM_CODE}</th>
+	</tr>
+	<tr>
+		<td class="row1"><b class="genmed">{L_CONFIRM_CODE}:</b><br /><span class="gensmall">{L_RECAPTCHA_EXPLAIN}</span></td>
+		<td class="row2">
+		<script type="text/javascript">
+		// <![CDATA[
+		var RecaptchaOptions = {
+			lang : '{LA_RECAPTCHA_LANG}',
+			theme : 'clean',
+			tabindex : <!-- IF $CAPTCHA_TAB_INDEX -->{$CAPTCHA_TAB_INDEX}<!-- ELSE -->10<!-- ENDIF -->
+		};
+		// ]]>
+		</script>
+		<script type="text/javascript" src="{RECAPTCHA_SERVER}/challenge?k={RECAPTCHA_PUBKEY}{RECAPTCHA_ERRORGET}" ></script>
+		<script type="text/javascript">
+		// <![CDATA[
+		<!-- IF S_CONTENT_DIRECTION eq 'rtl' -->
+			document.getElementById('recaptcha_table').style.direction = 'ltr';
+		<!-- ENDIF -->
+		// ]]>
+		</script>
+
+			<noscript>
+				<iframe src="{RECAPTCHA_SERVER}/noscript?k={RECAPTCHA_PUBKEY}{RECAPTCHA_ERRORGET}" height="300" width="500" frameborder="0"></iframe><br />
+				<textarea name="recaptcha_challenge_field" rows="3" cols="40"></textarea>
+				<input type="hidden" name="recaptcha_response_field" value="manual_challenge" />
+			</noscript>
+		</td>
+	</tr>
+
+<!-- ELSE -->
+{L_RECAPTCHA_NOT_AVAILABLE}
+<!-- ENDIF -->
diff -ruN phpBB-3.0.10/styles/spring/template/confirm_body.html phpbb/styles/spring/template/confirm_body.html
--- phpBB-3.0.10/styles/spring/template/confirm_body.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/confirm_body.html	2014-04-15 14:31:18.673429005 +0200
@@ -0,0 +1,28 @@
+<!-- INCLUDE overall_header.html -->
+
+<div id="pagecontent">
+
+	<form name="confirm" action="{S_CONFIRM_ACTION}" method="post">
+	
+	<table class="tablebg" width="100%" cellspacing="1">
+	<tr>
+		<th>{MESSAGE_TITLE}</th>
+	</tr>
+	<tr>
+		<td class="row1" align="center"><br /><p class="gen">{MESSAGE_TEXT}</p><br />{S_HIDDEN_FIELDS}<input type="submit" name="confirm" value="{YES_VALUE}" class="btnmain" />&nbsp;&nbsp;<input type="submit" name="cancel" value="{L_NO}" class="btnlite" /></td>
+	</tr>
+	</table>
+	
+	</form>
+	
+</div>
+
+<br clear="all" />
+
+<!-- INCLUDE breadcrumbs.html -->
+
+<br clear="all" />
+
+<div align="{S_CONTENT_FLOW_END}"><!-- INCLUDE jumpbox.html --></div>
+
+<!-- INCLUDE overall_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/custom_profile_fields.html phpbb/styles/spring/template/custom_profile_fields.html
--- phpBB-3.0.10/styles/spring/template/custom_profile_fields.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/custom_profile_fields.html	2014-04-15 14:31:18.673429005 +0200
@@ -0,0 +1,31 @@
+<!-- BEGIN dropdown -->
+	<select name="{dropdown.FIELD_IDENT}">
+		<!-- BEGIN options --><option value="{dropdown.options.OPTION_ID}"{dropdown.options.SELECTED}>{dropdown.options.VALUE}</option><!-- END options -->
+	</select>
+<!-- END dropdown -->
+
+<!-- BEGIN text -->
+	<textarea name="{text.FIELD_IDENT}" rows="{text.FIELD_ROWS}" cols="{text.FIELD_COLS}">{text.FIELD_VALUE}</textarea>
+<!-- END text -->
+
+<!-- BEGIN string -->
+	<input type="text" class="post" name="{string.FIELD_IDENT}" size="{string.FIELD_LENGTH}" maxlength="{string.FIELD_MAXLEN}" value="{string.FIELD_VALUE}" />
+<!-- END string -->
+
+<!-- BEGIN bool -->
+	<!-- IF bool.FIELD_LENGTH eq 1 -->
+		<!-- BEGIN options --><input type="radio" class="radio" name="{bool.FIELD_IDENT}" value="{bool.options.OPTION_ID}"{bool.options.CHECKED} /><span class="genmed">{bool.options.VALUE}</span>&nbsp; &nbsp;<!-- END options -->
+	<!-- ELSE -->
+		<input type="checkbox" class="radio" name="{bool.FIELD_IDENT}" value="1"<!-- IF bool.FIELD_VALUE eq 1 --> checked="checked"<!-- ENDIF --> />
+	<!-- ENDIF -->
+<!-- END bool -->
+
+<!-- BEGIN int -->
+	<input type="text" class="post" name="{int.FIELD_IDENT}" size="{int.FIELD_LENGTH}" value="{int.FIELD_VALUE}" />
+<!-- END int -->
+
+<!-- BEGIN date -->
+	<span class="genmed">{L_DAY}:</span> <select name="{date.FIELD_IDENT}_day">{date.S_DAY_OPTIONS}</select>
+	<span class="genmed">{L_MONTH}:</span> <select name="{date.FIELD_IDENT}_month">{date.S_MONTH_OPTIONS}</select>
+	<span class="genmed">{L_YEAR}:</span> <select name="{date.FIELD_IDENT}_year">{date.S_YEAR_OPTIONS}</select>
+<!-- END date -->
diff -ruN phpBB-3.0.10/styles/spring/template/editor.js phpbb/styles/spring/template/editor.js
--- phpBB-3.0.10/styles/spring/template/editor.js	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/editor.js	2014-04-15 14:31:18.675429005 +0200
@@ -0,0 +1,462 @@
+/**
+* bbCode control by subBlue design [ www.subBlue.com ]
+* Includes unixsafe colour palette selector by SHS`
+*/
+
+// Startup variables
+var imageTag = false;
+var theSelection = false;
+var bbcodeEnabled = true;
+
+// Check for Browser & Platform for PC & IE specific bits
+// More details from: http://www.mozilla.org/docs/web-developer/sniffer/browser_type.html
+var clientPC = navigator.userAgent.toLowerCase(); // Get client info
+var clientVer = parseInt(navigator.appVersion); // Get browser version
+
+var is_ie = ((clientPC.indexOf('msie') != -1) && (clientPC.indexOf('opera') == -1));
+var is_win = ((clientPC.indexOf('win') != -1) || (clientPC.indexOf('16bit') != -1));
+
+var baseHeight;
+
+/**
+* Shows the help messages in the helpline window
+*/
+function helpline(help)
+{
+	document.forms[form_name].helpbox.value = help_line[help];
+}
+
+/**
+* Fix a bug involving the TextRange object. From
+* http://www.frostjedi.com/terra/scripts/demo/caretBug.html
+*/ 
+function initInsertions() 
+{
+	var doc;
+
+	if (document.forms[form_name])
+	{
+		doc = document;
+	}
+	else 
+	{
+		doc = opener.document;
+	}
+
+	var textarea = doc.forms[form_name].elements[text_name];
+	if (is_ie && typeof(baseHeight) != 'number')
+	{	
+		textarea.focus();
+		baseHeight = doc.selection.createRange().duplicate().boundingHeight;
+
+		if (!document.forms[form_name])
+		{
+			document.body.focus();
+		}
+	}
+}
+
+/**
+* bbstyle
+*/
+function bbstyle(bbnumber)
+{	
+	if (bbnumber != -1)
+	{
+		bbfontstyle(bbtags[bbnumber], bbtags[bbnumber+1]);
+	} 
+	else 
+	{
+		insert_text('[*]');
+		document.forms[form_name].elements[text_name].focus();
+	}
+}
+
+/**
+* Apply bbcodes
+*/
+function bbfontstyle(bbopen, bbclose)
+{
+	theSelection = false;
+		
+	var textarea = document.forms[form_name].elements[text_name];
+
+	textarea.focus();
+
+	if ((clientVer >= 4) && is_ie && is_win)
+	{
+		// Get text selection
+		theSelection = document.selection.createRange().text;
+
+		if (theSelection)
+		{
+			// Add tags around selection
+			document.selection.createRange().text = bbopen + theSelection + bbclose;
+			document.forms[form_name].elements[text_name].focus();
+			theSelection = '';
+			return;
+		}
+	}
+	else if (document.forms[form_name].elements[text_name].selectionEnd && (document.forms[form_name].elements[text_name].selectionEnd - document.forms[form_name].elements[text_name].selectionStart > 0))
+	{
+		mozWrap(document.forms[form_name].elements[text_name], bbopen, bbclose);
+		document.forms[form_name].elements[text_name].focus();
+		theSelection = '';
+		return;
+	}
+	
+	//The new position for the cursor after adding the bbcode
+	var caret_pos = getCaretPosition(textarea).start;
+	var new_pos = caret_pos + bbopen.length;
+
+	// Open tag
+	insert_text(bbopen + bbclose);
+
+	// Center the cursor when we don't have a selection
+	// Gecko and proper browsers
+	if (!isNaN(textarea.selectionStart))
+	{
+		textarea.selectionStart = new_pos;
+		textarea.selectionEnd = new_pos;
+	}	
+	// IE
+	else if (document.selection)
+	{
+		var range = textarea.createTextRange(); 
+		range.move("character", new_pos); 
+		range.select();
+		storeCaret(textarea);
+	}
+
+	textarea.focus();
+	return;
+}
+
+/**
+* Insert text at position
+*/
+function insert_text(text, spaces, popup)
+{
+	var textarea;
+	
+	if (!popup) 
+	{
+		textarea = document.forms[form_name].elements[text_name];
+	} 
+	else 
+	{
+		textarea = opener.document.forms[form_name].elements[text_name];
+	}
+	if (spaces) 
+	{
+		text = ' ' + text + ' ';
+	}
+
+	// Since IE9, IE also has textarea.selectionStart, but it still needs to be treated the old way.
+	// Therefore we simply add a !is_ie here until IE fixes the text-selection completely.
+	if (!isNaN(textarea.selectionStart) && !is_ie)
+	{
+		var sel_start = textarea.selectionStart;
+		var sel_end = textarea.selectionEnd;
+
+		mozWrap(textarea, text, '');
+		textarea.selectionStart = sel_start + text.length;
+		textarea.selectionEnd = sel_end + text.length;
+	}	
+	
+	else if (textarea.createTextRange && textarea.caretPos)
+	{
+		if (baseHeight != textarea.caretPos.boundingHeight) 
+		{
+			textarea.focus();
+			storeCaret(textarea);
+		}		
+		var caret_pos = textarea.caretPos;
+		caret_pos.text = caret_pos.text.charAt(caret_pos.text.length - 1) == ' ' ? caret_pos.text + text + ' ' : caret_pos.text + text;
+		
+	}
+	else
+	{
+		textarea.value = textarea.value + text;
+	}
+	if (!popup) 
+	{
+		textarea.focus();
+	} 	
+
+}
+
+/**
+* Add inline attachment at position
+*/
+function attach_inline(index, filename)
+{
+	insert_text('[attachment=' + index + ']' + filename + '[/attachment]');
+	document.forms[form_name].elements[text_name].focus();
+}
+
+/**
+* Add quote text to message
+*/
+function addquote(post_id, username, l_wrote)
+{
+	var message_name = 'message_' + post_id;
+	var theSelection = '';
+	var divarea = false;
+
+	if (l_wrote === undefined)
+	{
+		// Backwards compatibility
+		l_wrote = 'wrote';
+	}
+
+	if (document.all)
+	{
+		divarea = document.all[message_name];
+	}
+	else
+	{
+		divarea = document.getElementById(message_name);
+	}
+
+	// Get text selection - not only the post content :(
+	// IE9 must use the document.selection method but has the *.getSelection so we just force no IE
+	if (window.getSelection && !is_ie)
+	{
+		theSelection = window.getSelection().toString();
+	}
+	else if (document.getSelection && !is_ie)
+	{
+		theSelection = document.getSelection();
+	}
+	else if (document.selection)
+	{
+		theSelection = document.selection.createRange().text;
+	}
+
+	if (theSelection == '' || typeof theSelection == 'undefined' || theSelection == null)
+	{
+		if (divarea.innerHTML)
+		{
+			theSelection = divarea.innerHTML.replace(/<br>/ig, '\n');
+			theSelection = theSelection.replace(/<br\/>/ig, '\n');
+			theSelection = theSelection.replace(/&lt\;/ig, '<');
+			theSelection = theSelection.replace(/&gt\;/ig, '>');
+			theSelection = theSelection.replace(/&amp\;/ig, '&');
+			theSelection = theSelection.replace(/&nbsp\;/ig, ' ');
+		}
+		else if (document.all)
+		{
+			theSelection = divarea.innerText;
+		}
+		else if (divarea.textContent)
+		{
+			theSelection = divarea.textContent;
+		}
+		else if (divarea.firstChild.nodeValue)
+		{
+			theSelection = divarea.firstChild.nodeValue;
+		}
+	}
+
+	if (theSelection)
+	{
+		if (bbcodeEnabled)
+		{
+			insert_text('[quote="' + username + '"]' + theSelection + '[/quote]');
+		}
+		else
+		{
+			insert_text(username + ' ' + l_wrote + ':' + '\n');
+			var lines = split_lines(theSelection);
+			for (i = 0; i < lines.length; i++)
+			{
+				insert_text('> ' + lines[i] + '\n');
+			}
+		}
+	}
+
+	return;
+}
+
+
+function split_lines(text)
+{
+	var lines = text.split('\n');
+	var splitLines = new Array();
+	var j = 0;
+	for(i = 0; i < lines.length; i++)
+	{
+		if (lines[i].length <= 80)
+		{
+			splitLines[j] = lines[i];
+			j++;
+		}
+		else
+		{
+			var line = lines[i];
+			do
+			{
+				var splitAt = line.indexOf(' ', 80);
+				
+				if (splitAt == -1)
+				{
+					splitLines[j] = line;
+					j++;
+				}
+				else
+				{
+					splitLines[j] = line.substring(0, splitAt);
+					line = line.substring(splitAt);
+					j++;
+				}
+			}
+			while(splitAt != -1);
+		}
+	}
+	return splitLines;
+}
+
+/**
+* From http://www.massless.org/mozedit/
+*/
+function mozWrap(txtarea, open, close)
+{
+	var selLength = (typeof(txtarea.textLength) == 'undefined') ? txtarea.value.length : txtarea.textLength;
+	var selStart = txtarea.selectionStart;
+	var selEnd = txtarea.selectionEnd;
+	var scrollTop = txtarea.scrollTop;
+
+	if (selEnd == 1 || selEnd == 2) 
+	{
+		selEnd = selLength;
+	}
+
+	var s1 = (txtarea.value).substring(0,selStart);
+	var s2 = (txtarea.value).substring(selStart, selEnd);
+	var s3 = (txtarea.value).substring(selEnd, selLength);
+
+	txtarea.value = s1 + open + s2 + close + s3;
+	txtarea.selectionStart = selStart + open.length;
+	txtarea.selectionEnd = selEnd + open.length;
+	txtarea.focus();
+	txtarea.scrollTop = scrollTop;
+
+	return;
+}
+
+/**
+* Insert at Caret position. Code from
+* http://www.faqts.com/knowledge_base/view.phtml/aid/1052/fid/130
+*/
+function storeCaret(textEl)
+{
+	if (textEl.createTextRange)
+	{
+		textEl.caretPos = document.selection.createRange().duplicate();
+	}
+}
+
+/**
+* Color pallette
+*/
+function colorPalette(dir, width, height)
+{
+	var r = 0, g = 0, b = 0;
+	var numberList = new Array(6);
+	var color = '';
+
+	numberList[0] = '00';
+	numberList[1] = '40';
+	numberList[2] = '80';
+	numberList[3] = 'BF';
+	numberList[4] = 'FF';
+
+	document.writeln('<table cellspacing="1" cellpadding="0" border="0">');
+
+	for (r = 0; r < 5; r++)
+	{
+		if (dir == 'h')
+		{
+			document.writeln('<tr>');
+		}
+
+		for (g = 0; g < 5; g++)
+		{
+			if (dir == 'v')
+			{
+				document.writeln('<tr>');
+			}
+			
+			for (b = 0; b < 5; b++)
+			{
+				color = String(numberList[r]) + String(numberList[g]) + String(numberList[b]);
+				document.write('<td bgcolor="#' + color + '" style="width: ' + width + 'px; height: ' + height + 'px;">');
+				document.write('<a href="#" onclick="bbfontstyle(\'[color=#' + color + ']\', \'[/color]\'); return false;"><img src="images/spacer.gif" width="' + width + '" height="' + height + '" alt="#' + color + '" title="#' + color + '" /></a>');
+				document.writeln('</td>');
+			}
+
+			if (dir == 'v')
+			{
+				document.writeln('</tr>');
+			}
+		}
+
+		if (dir == 'h')
+		{
+			document.writeln('</tr>');
+		}
+	}
+	document.writeln('</table>');
+}
+
+
+/**
+* Caret Position object
+*/
+function caretPosition()
+{
+	var start = null;
+	var end = null;
+}
+
+
+/**
+* Get the caret position in an textarea
+*/
+function getCaretPosition(txtarea)
+{
+	var caretPos = new caretPosition();
+	
+	// simple Gecko/Opera way
+	if(txtarea.selectionStart || txtarea.selectionStart == 0)
+	{
+		caretPos.start = txtarea.selectionStart;
+		caretPos.end = txtarea.selectionEnd;
+	}
+	// dirty and slow IE way
+	else if(document.selection)
+	{
+		// get current selection
+		var range = document.selection.createRange();
+
+		// a new selection of the whole textarea
+		var range_all = document.body.createTextRange();
+		range_all.moveToElementText(txtarea);
+		
+		// calculate selection start point by moving beginning of range_all to beginning of range
+		var sel_start;
+		for (sel_start = 0; range_all.compareEndPoints('StartToStart', range) < 0; sel_start++)
+		{		
+			range_all.moveStart('character', 1);
+		}
+	
+		txtarea.sel_start = sel_start;
+	
+		// we ignore the end value for IE, this is already dirty enough and we don't need it
+		caretPos.start = txtarea.sel_start;
+		caretPos.end = txtarea.sel_start;
+	}
+
+	return caretPos;
+}
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/faq_body.html phpbb/styles/spring/template/faq_body.html
--- phpBB-3.0.10/styles/spring/template/faq_body.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/faq_body.html	2014-04-15 14:31:18.675429005 +0200
@@ -0,0 +1,63 @@
+<!-- INCLUDE overall_header.html -->
+
+<a name="faqtop"></a>
+
+<div id="pagecontent">
+
+	<table class="tablebg" width="100%" cellspacing="1">
+	<tr>
+		<th>{L_FAQ_TITLE}</th>
+	</tr>
+	<tr>
+		<td class="row1">
+		<!-- BEGIN faq_block -->
+			<span class="gen"><b>{faq_block.BLOCK_TITLE}</b></span><br />
+			<!-- BEGIN faq_row -->
+				<span class="gen"><a class="postlink" href="#f{faq_block.S_ROW_COUNT}r{faq_block.faq_row.S_ROW_COUNT}">{faq_block.faq_row.FAQ_QUESTION}</a></span><br />
+			<!-- END faq_row -->
+			<br />
+		<!-- END faq_block -->
+		</td>
+	</tr>
+	<tr>
+		<td class="cat">&nbsp;</td>
+	</tr>
+	</table>
+
+	<br clear="all" />
+
+	<!-- BEGIN faq_block -->
+		<table class="tablebg" width="100%" cellspacing="1">
+		<tr> 
+			<td class="cat" align="center"><h4>{faq_block.BLOCK_TITLE}</h4></td>
+		</tr>
+		<!-- BEGIN faq_row --> 
+		<tr>
+			<!-- IF faq_block.faq_row.S_ROW_COUNT is even -->
+				<td class="row1" valign="top">
+			<!-- ELSE -->
+				<td class="row2" valign="top">
+			<!-- ENDIF -->
+				<div class="postbody"><a name="f{faq_block.S_ROW_COUNT}r{faq_block.faq_row.S_ROW_COUNT}"></a><b>&#187; {faq_block.faq_row.FAQ_QUESTION}</b></div>
+				<div class="postbody">{faq_block.faq_row.FAQ_ANSWER}</div>
+				<p class="gensmall"><a href="#faqtop">{L_BACK_TO_TOP}</a></p>
+			</td>
+		</tr>
+		<tr>
+			<td class="spacer" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
+		</tr>
+		<!-- END faq_row -->
+		</table>
+
+		<br clear="all" />
+	<!-- END faq_block -->
+
+</div>
+
+<!-- INCLUDE breadcrumbs.html -->
+
+<br clear="all" />
+
+<div align="{S_CONTENT_FLOW_END}"><!-- INCLUDE jumpbox.html --></div>
+
+<!-- INCLUDE overall_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/forumlist_body.html phpbb/styles/spring/template/forumlist_body.html
--- phpBB-3.0.10/styles/spring/template/forumlist_body.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/forumlist_body.html	2014-04-15 14:31:18.676429005 +0200
@@ -0,0 +1,74 @@
+<table class="tablebg" cellspacing="1" width="100%">
+<tr>
+	<td class="cat" colspan="5" align="{S_CONTENT_FLOW_END}"><!-- IF not S_IS_BOT and U_MARK_FORUMS --><a class="nav" href="{U_MARK_FORUMS}">{L_MARK_FORUMS_READ}</a><!-- ENDIF -->&nbsp;</td>
+</tr>
+<tr>
+	<th colspan="2">&nbsp;{L_FORUM}&nbsp;</th>
+	<th width="50">&nbsp;{L_TOPICS}&nbsp;</th>
+	<th width="50">&nbsp;{L_POSTS}&nbsp;</th>
+	<th>&nbsp;{L_LAST_POST}&nbsp;</th>
+</tr>
+<!-- BEGIN forumrow -->
+	<!-- IF forumrow.S_IS_CAT -->
+		<tr>
+			<td class="cat" colspan="2"><h4><a href="{forumrow.U_VIEWFORUM}">{forumrow.FORUM_NAME}</a></h4></td>
+			<td class="catdiv" colspan="3">&nbsp;</td>
+		</tr>
+	<!-- ELSEIF forumrow.S_IS_LINK -->
+		<tr>
+			<td class="row1" width="50" align="center">{forumrow.FORUM_FOLDER_IMG}</td>
+			<td class="row1">
+				<!-- IF forumrow.FORUM_IMAGE -->
+					<div style="float: {S_CONTENT_FLOW_BEGIN}; margin-{S_CONTENT_FLOW_END}: 5px;">{forumrow.FORUM_IMAGE}</div>
+				<!-- ENDIF -->
+				<a class="forumlink" href="{forumrow.U_VIEWFORUM}">{forumrow.FORUM_NAME}</a>
+				<p class="forumdesc">{forumrow.FORUM_DESC}</p>
+			</td>
+			<!-- IF forumrow.CLICKS -->
+				<td class="row2" colspan="3" align="center"><span class="genmed">{L_REDIRECTS}: {forumrow.CLICKS}</span></td>
+			<!-- ELSE -->
+				<td class="row2" colspan="3" align="center">&nbsp;</td>
+			<!-- ENDIF -->
+		</tr>
+	<!-- ELSE -->
+		<!-- IF forumrow.S_NO_CAT -->
+			<tr>
+				<td class="cat" colspan="2"><h4>{L_FORUM}</h4></td>
+				<td class="catdiv" colspan="3">&nbsp;</td>
+			</tr>
+		<!-- ENDIF -->
+		<tr>
+			<td class="row1" width="50" align="center">{forumrow.FORUM_FOLDER_IMG}</td>
+			<td class="row1" width="100%">
+				<!-- IF forumrow.FORUM_IMAGE -->
+					<div style="float: {S_CONTENT_FLOW_BEGIN}; margin-{S_CONTENT_FLOW_END}: 5px;">{forumrow.FORUM_IMAGE}</div>
+				<!-- ENDIF -->
+				<a class="forumlink" href="{forumrow.U_VIEWFORUM}">{forumrow.FORUM_NAME}</a>
+				<p class="forumdesc">{forumrow.FORUM_DESC}</p>
+				<!-- IF forumrow.MODERATORS -->
+					<!-- <p class="forumdesc"><strong>{forumrow.L_MODERATOR_STR}:</strong> {forumrow.MODERATORS}</p> -->
+				<!-- ENDIF -->
+				<!-- IF forumrow.SUBFORUMS and forumrow.S_LIST_SUBFORUMS -->
+					<p class="forumdesc"><strong>{forumrow.L_SUBFORUM_STR}</strong> {forumrow.SUBFORUMS}</p>
+				<!-- ENDIF -->
+			</td>
+			<td class="row2" align="center"><p class="topicdetails">{forumrow.TOPICS}</p></td>
+			<td class="row2" align="center"><p class="topicdetails">{forumrow.POSTS}</p></td>
+			<td class="row2" align="center" nowrap="nowrap">
+				<!-- IF forumrow.LAST_POST_TIME -->
+					<p class="topicdetails"><!-- IF forumrow.U_UNAPPROVED_TOPICS --><a href="{forumrow.U_UNAPPROVED_TOPICS}">{UNAPPROVED_IMG}</a>&nbsp;<!-- ENDIF -->{forumrow.LAST_POST_TIME}</p>
+					<p class="topicdetails">{forumrow.LAST_POSTER_FULL}
+						<!-- IF not S_IS_BOT --><a href="{forumrow.U_LAST_POST}">{LAST_POST_IMG}</a><!-- ENDIF -->
+					</p>
+				<!-- ELSE -->
+					<p class="topicdetails">{L_NO_POSTS}</p>
+				<!-- ENDIF -->
+			</td>
+		</tr>
+	<!-- ENDIF -->
+<!-- BEGINELSE -->
+	<tr>
+		<td class="row1" colspan="5" align="center"><p class="gensmall">{L_NO_FORUMS}</p></td>
+	</tr>
+<!-- END forumrow -->
+</table>
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/index_body.html phpbb/styles/spring/template/index_body.html
--- phpBB-3.0.10/styles/spring/template/index_body.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/index_body.html	2014-04-15 14:31:18.677429005 +0200
@@ -0,0 +1,103 @@
+<!-- INCLUDE overall_header.html -->
+
+<!-- IF U_MCP -->
+	<div id="pageheader">
+		<p class="linkmcp">[ <a href="{U_MCP}">{L_MCP}</a> ]</p>
+	</div>
+
+	<br clear="all" /><br />
+<!-- ENDIF -->
+
+<!-- INCLUDE forumlist_body.html -->
+
+<!-- IF not S_IS_BOT or U_TEAM -->
+<span class="gensmall"><!-- IF not S_IS_BOT --><a href="{U_DELETE_COOKIES}">{L_DELETE_COOKIES}</a><!-- ENDIF --><!-- IF not S_IS_BOT and U_TEAM --> | <!-- ENDIF --><!-- IF U_TEAM --><a href="{U_TEAM}">{L_THE_TEAM}</a><!-- ENDIF --></span><br />
+<!-- ENDIF -->
+
+<br clear="all" />
+
+<!-- INCLUDE breadcrumbs.html -->
+
+<!-- IF S_DISPLAY_ONLINE_LIST -->
+	<br clear="all" />
+
+	<table class="tablebg" width="100%" cellspacing="1">
+	<tr>
+		<td class="cat" colspan="2"><!-- IF U_VIEWONLINE --><h4><a href="{U_VIEWONLINE}">{L_WHO_IS_ONLINE}</a></h4><!-- ELSE --><h4>{L_WHO_IS_ONLINE}</h4><!-- ENDIF --></td>
+	</tr>
+	<tr>
+	<!-- IF LEGEND -->
+		<td class="row1" rowspan="2" align="center" valign="middle"><img src="{T_THEME_PATH}/images/whosonline.gif" alt="{L_WHO_IS_ONLINE}" /></td>
+	<!-- ELSE -->
+		<td class="row1" align="center" valign="middle"><img src="{T_THEME_PATH}/images/whosonline.gif" alt="{L_WHO_IS_ONLINE}" /></td>
+	<!-- ENDIF -->
+		<td class="row1" width="100%"><span class="genmed">{TOTAL_USERS_ONLINE} ({L_ONLINE_EXPLAIN})<br />{RECORD_USERS}<br /><br />{LOGGED_IN_USER_LIST}</span></td>
+	</tr>
+	<!-- IF LEGEND -->
+		<tr>
+			<td class="row1"><b class="gensmall">{L_LEGEND} :: {LEGEND}</b></td>
+		</tr>
+	<!-- ENDIF -->
+	</table>
+<!-- ENDIF -->
+
+<!-- IF S_DISPLAY_BIRTHDAY_LIST -->
+	<br clear="all" />
+
+	<table class="tablebg" width="100%" cellspacing="1">
+	<tr>
+		<td class="cat" colspan="2"><h4>{L_BIRTHDAYS}</h4></td>
+	</tr>
+	<tr>
+		<td class="row1" align="center" valign="middle"><img src="{T_THEME_PATH}/images/whosonline.gif" alt="{L_BIRTHDAYS}" /></td>
+		<td class="row1" width="100%"><p class="genmed"><!-- IF BIRTHDAY_LIST -->{L_CONGRATULATIONS}: <b>{BIRTHDAY_LIST}</b><!-- ELSE -->{L_NO_BIRTHDAYS}<!-- ENDIF --></p></td>
+	</tr>
+	</table>
+<!-- ENDIF -->
+
+<br clear="all" />
+
+<table class="tablebg" width="100%" cellspacing="1">
+<tr>
+	<td class="cat" colspan="2"><h4>{L_STATISTICS}</h4></td>
+</tr>
+<tr>
+	<td class="row1"><img src="{T_THEME_PATH}/images/whosonline.gif" alt="{L_STATISTICS}" /></td>
+	<td class="row1" width="100%" valign="middle"><p class="genmed">{TOTAL_POSTS} | {TOTAL_TOPICS} | {TOTAL_USERS} | {NEWEST_USER}</p></td>
+</tr>
+</table>
+
+<!-- IF not S_USER_LOGGED_IN and not S_IS_BOT -->
+	<br clear="all" />
+
+	<form method="post" action="{S_LOGIN_ACTION}">
+
+	<table class="tablebg" width="100%" cellspacing="1">
+	<tr>
+		<td class="cat"><h4><a href="{U_LOGIN_LOGOUT}">{L_LOGIN_LOGOUT}</a></h4></td>
+	</tr>
+	<tr>
+		<td class="row1" align="center"><span class="genmed">{L_USERNAME}:</span> <input class="post" type="text" name="username" size="10" />&nbsp; <span class="genmed">{L_PASSWORD}:</span> <input class="post" type="password" name="password" size="10" />&nbsp; <!-- IF S_AUTOLOGIN_ENABLED --> <span class="gensmall">{L_LOG_ME_IN}</span> <input type="checkbox" class="radio" name="autologin" /><!-- ENDIF -->&nbsp; <input type="submit" class="btnmain" name="login" value="{L_LOGIN}" /></td>
+	</tr>
+	</table>
+	{S_LOGIN_REDIRECT}
+	{S_FORM_TOKEN}
+	</form>
+<!-- ENDIF -->
+
+<br clear="all" />
+
+<table class="legend">
+<tr>
+	<td width="20" align="center">{FORUM_UNREAD_IMG}</td>
+	<td><span class="gensmall">{L_UNREAD_POSTS}</span></td>
+	<td>&nbsp;&nbsp;</td>
+	<td width="20" align="center">{FORUM_IMG}</td>
+	<td><span class="gensmall">{L_NO_UNREAD_POSTS}</span></td>
+	<td>&nbsp;&nbsp;</td>
+	<td width="20" align="center">{FORUM_LOCKED_IMG}</td>
+	<td><span class="gensmall">{L_FORUM_LOCKED}</span></td>
+</tr>
+</table>
+
+<!-- INCLUDE overall_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/index.htm phpbb/styles/spring/template/index.htm
--- phpBB-3.0.10/styles/spring/template/index.htm	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/index.htm	2014-04-15 14:31:18.679429005 +0200
@@ -0,0 +1,16 @@
+<html>
+<head>
+<title>subSilver created by subBlue Design</title>
+<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
+</head>
+
+<body bgcolor="#FFFFFF" text="#000000">
+
+<table width="100%" height="100%" cellspacing="0" cellpadding="0" border="0">
+	<tr>
+		<td align="center" valign="middle"><a href="http://www.subblue.com/" target="_new"><img src="images/created_by.jpg" width="400" height="300" alt="Created by subBlue Design" /></a></td>
+	</tr>
+</table>
+
+</body>
+</html>
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/jumpbox.html phpbb/styles/spring/template/jumpbox.html
--- phpBB-3.0.10/styles/spring/template/jumpbox.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/jumpbox.html	2014-04-15 14:31:18.680429005 +0200
@@ -0,0 +1,19 @@
+
+<!-- IF S_DISPLAY_JUMPBOX -->
+	<form method="post" name="jumpbox" action="{S_JUMPBOX_ACTION}" onsubmit="if(document.jumpbox.f.value == -1){return false;}">
+
+	<table cellspacing="0" cellpadding="0" border="0">
+	<tr>
+		<td nowrap="nowrap"><span class="gensmall"><!-- IF S_IN_MCP and S_MERGE_SELECT -->{L_SELECT_TOPICS_FROM}<!-- ELSEIF S_IN_MCP -->{L_MODERATE_FORUM}<!-- ELSE -->{L_JUMP_TO}<!-- ENDIF -->:</span>&nbsp;<select name="f" onchange="if(this.options[this.selectedIndex].value != -1){ document.forms['jumpbox'].submit() }">
+
+		<!-- BEGIN jumpbox_forums -->
+			<!-- IF jumpbox_forums.S_FORUM_COUNT eq 1 --><option value="-1">------------------</option><!-- ENDIF -->
+			<option value="{jumpbox_forums.FORUM_ID}"{jumpbox_forums.SELECTED}><!-- BEGIN level -->&nbsp; &nbsp;<!-- END level -->{jumpbox_forums.FORUM_NAME}</option>
+		<!-- END jumpbox_forums -->
+
+		</select>&nbsp;<input class="btnlite" type="submit" value="{L_GO}" /></td>
+	</tr>
+	</table>
+
+	</form>
+<!-- ENDIF -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/login_body.html phpbb/styles/spring/template/login_body.html
--- phpBB-3.0.10/styles/spring/template/login_body.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/login_body.html	2014-04-15 14:31:18.684429005 +0200
@@ -0,0 +1,108 @@
+<!-- INCLUDE overall_header.html -->
+
+<form action="{S_LOGIN_ACTION}" method="post">
+
+<table class="tablebg" width="100%" cellspacing="1">
+<tr>
+	<!-- IF not S_ADMIN_AUTH -->
+		<th colspan="2">{L_LOGIN}</th>
+	<!-- ELSE -->
+		<th>{LOGIN_EXPLAIN}</th>
+	<!-- ENDIF -->
+</tr>
+<!-- IF LOGIN_EXPLAIN && not S_ADMIN_AUTH -->
+	<tr>
+		<td class="row3" colspan="2" align="center"><span class="gensmall">{LOGIN_EXPLAIN}</span></td>
+	</tr>
+<!-- ENDIF -->
+<tr><!-- IF not S_ADMIN_AUTH and S_REGISTER_ENABLED -->
+	<td class="row1" width="50%">
+		<p class="genmed">{L_LOGIN_INFO}</p>
+
+		<p class="genmed" align="center">
+			<a href="{U_TERMS_USE}">{L_TERMS_USE}</a> | <a href="{U_PRIVACY}">{L_PRIVACY}</a>
+		</p>
+	</td>
+	<!-- ENDIF -->
+	<td <!-- IF not S_ADMIN_AUTH -->class="row2"<!-- ELSE -->class="row1"<!-- ENDIF -->>
+	
+		<table align="center" cellspacing="1" cellpadding="4" style="width: 100%;">
+		<!-- IF LOGIN_ERROR -->
+			<tr>
+				<td class="gensmall" colspan="2" align="center"><span class="error">{LOGIN_ERROR}</span></td>
+			</tr>
+		<!-- ENDIF -->
+
+		<tr>
+			<td valign="top" <!-- IF S_ADMIN_AUTH -->style="width: 50%; text-align: {S_CONTENT_FLOW_END};"<!-- ENDIF -->><b class="gensmall">{L_USERNAME}:</b></td>
+			<td><input class="post" type="text" name="{USERNAME_CREDENTIAL}" size="25" value="{USERNAME}" tabindex="1" />
+				<!-- IF not S_ADMIN_AUTH and S_REGISTER_ENABLED -->
+					<br /><a class="gensmall" href="{U_REGISTER}">{L_REGISTER}</a>
+				<!-- ENDIF -->
+			</td>
+		</tr>
+		<tr>
+			<td valign="top" <!-- IF S_ADMIN_AUTH -->style="width: 50%; text-align: {S_CONTENT_FLOW_END};"<!-- ENDIF -->><b class="gensmall">{L_PASSWORD}:</b></td>
+			<td>
+				<input class="post" type="password" name="{PASSWORD_CREDENTIAL}" size="25" tabindex="2" />
+				<!-- IF U_SEND_PASSWORD --><br /><a class="gensmall" href="{U_SEND_PASSWORD}">{L_FORGOT_PASS}</a><!-- ENDIF -->
+				<!-- IF U_RESEND_ACTIVATION and not S_ADMIN_AUTH --><br /><a class="gensmall" href="{U_RESEND_ACTIVATION}">{L_RESEND_ACTIVATION}</a><!-- ENDIF -->
+			</td>
+		</tr>
+		<!-- IF S_DISPLAY_FULL_LOGIN -->
+			<!-- IF S_AUTOLOGIN_ENABLED -->
+			<tr>
+				<td>&nbsp;</td>
+				<td><input type="checkbox" class="radio" name="autologin" tabindex="3" /> <span class="gensmall">{L_LOG_ME_IN}</span></td>
+			</tr>
+			<!-- ENDIF -->
+			<tr>
+				<td>&nbsp;</td>
+				<td><input type="checkbox" class="radio" name="viewonline" tabindex="4" /> <span class="gensmall">{L_HIDE_ME}</span></td>
+			</tr>
+		<!-- ENDIF -->
+		</table>
+	</td>
+</tr>
+
+<!-- IF CAPTCHA_TEMPLATE and S_CONFIRM_CODE -->
+</table>
+<table class="tablebg" width="100%" cellspacing="1">
+		
+	<!-- INCLUDE {CAPTCHA_TEMPLATE} -->
+<!-- ENDIF -->
+
+{S_LOGIN_REDIRECT}
+<tr>
+	<td class="cat" <!-- IF not S_ADMIN_AUTH or S_CONFIRM_CODE -->colspan="2"<!-- ENDIF --> align="center">{S_HIDDEN_FIELDS}<input type="submit" name="login" class="btnmain" value="{L_LOGIN}" tabindex="5" /></td>
+</tr>
+</table>
+{S_FORM_TOKEN}
+</form>
+
+<br clear="all" />
+
+<!-- INCLUDE breadcrumbs.html -->
+
+<br clear="all" />
+
+<div align="{S_CONTENT_FLOW_END}"><!-- INCLUDE jumpbox.html --></div>
+
+<script type="text/javascript">
+// <![CDATA[
+	(function()
+	{
+		var elements = document.getElementsByName("<!-- IF S_ADMIN_AUTH -->{PASSWORD_CREDENTIAL}<!-- ELSE -->{USERNAME_CREDENTIAL}<!-- ENDIF -->");
+		for (var i = 0; i < elements.length; ++i)
+		{
+			if (elements[i].tagName.toLowerCase() == 'input')
+			{
+				elements[i].focus();
+				break;
+			}
+		}
+	})();
+// ]]>
+</script>
+
+<!-- INCLUDE overall_footer.html -->
diff -ruN phpBB-3.0.10/styles/spring/template/login_forum.html phpbb/styles/spring/template/login_forum.html
--- phpBB-3.0.10/styles/spring/template/login_forum.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/login_forum.html	2014-04-15 14:31:18.684429005 +0200
@@ -0,0 +1,48 @@
+<!-- INCLUDE overall_header.html -->
+
+<div id="pagecontent">
+
+	<form name="login_forum" method="post" action="{S_LOGIN_ACTION}">
+	
+	<table class="tablebg" width="100%" cellspacing="1" align="center">
+	<tr> 
+		<th>{L_LOGIN}</th>
+	</tr>
+	<tr>
+		<td class="row3" align="center"><span class="gensmall">{L_LOGIN_FORUM}</span></td>
+	</tr>
+	<tr> 
+		<td class="row1" align="center">
+		
+			<table cellspacing="1" cellpadding="4" border="0">
+			<!-- IF LOGIN_ERROR -->
+				<tr>
+					<td class="gensmall" colspan="2" align="center"><span class="error">{LOGIN_ERROR}</span></td>
+				</tr>
+			<!-- ENDIF -->
+			<tr> 
+				<td class="gensmall"><b>{L_PASSWORD}:</b></td>
+				<td><input class="post" type="password" name="password" size="25" tabindex="2" /></td>
+			</tr>
+			</table>
+		</td>
+	</tr>
+	<tr> 
+		<td class="cat" colspan="2" align="center">{S_HIDDEN_FIELDS}<input type="submit" name="login" class="btnmain" value="{L_LOGIN}" tabindex="3" /></td>
+	</tr>
+	</table>
+	{S_FORM_TOKEN}
+	{S_LOGIN_REDIRECT}
+	</form>
+
+</div>
+
+<br clear="all" />
+
+<!-- INCLUDE breadcrumbs.html -->
+
+<br clear="all" />
+
+<div align="{S_CONTENT_FLOW_END}"><!-- INCLUDE jumpbox.html --></div>
+
+<!-- INCLUDE overall_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/mcp_approve.html phpbb/styles/spring/template/mcp_approve.html
--- phpBB-3.0.10/styles/spring/template/mcp_approve.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/mcp_approve.html	2014-04-15 14:31:18.686429005 +0200
@@ -0,0 +1,49 @@
+<!-- INCLUDE overall_header.html -->
+
+<div id="pagecontent">
+
+	<form name="confirm" action="{S_CONFIRM_ACTION}" method="post">
+	
+	<table class="tablebg" width="100%" cellspacing="1">
+	<tr>
+		<th>{MESSAGE_TITLE}</th>
+	</tr>
+	<tr>
+		<td class="row1" align="center">
+			<!-- IF ADDITIONAL_MSG -->
+				<span class="gen error">{ADDITIONAL_MSG}</span><br />
+			<!-- ENDIF -->
+			<!-- IF S_NOTIFY_POSTER -->
+				<input type="checkbox" class="radio" name="notify_poster" checked="checked" /><span class="gen"><!-- IF S_APPROVE -->{L_NOTIFY_POSTER_APPROVAL}<!-- ELSE -->{L_NOTIFY_POSTER_DISAPPROVAL}<!-- ENDIF --></span><br />
+			<!-- ENDIF -->
+			<!-- IF not S_APPROVE -->
+				<br />
+				<table border="0" width="90%" cellspacing="2" cellpadding="1">
+				<tr>
+					<td class="row1" width="22%"><b class="gen">{L_DISAPPROVE_REASON}:</b></td>
+					<td class="row1" width="78%"><select name="reason_id"><!-- BEGIN reason --><option value="{reason.ID}"<!-- IF reason.S_SELECTED --> selected="selected"<!-- ENDIF -->>{reason.DESCRIPTION}</option><!-- END reason --></select></td>
+				</tr>
+				<tr>
+					<td class="row1" valign="top"><span class="gen"><b>{L_MORE_INFO}:</b></span><br /><span class="gensmall">{L_CAN_LEAVE_BLANK}</span></td>
+					<td class="row1"><textarea class="post" style="width:500px" name="reason" rows="10" cols="40">{REASON}</textarea></td>
+				</tr>
+				</table>
+				<br />
+			<!-- ENDIF -->
+			<br />{S_HIDDEN_FIELDS}<span class="gen">{MESSAGE_TEXT}</span><br /><br />
+			<input type="submit" name="confirm" value="{YES_VALUE}" class="btnmain" />&nbsp;&nbsp;<input type="submit" name="cancel" value="{L_NO}" class="btnlite" /></span>
+		</td>
+	</tr>
+	</table>
+	{S_FORM_TOKEN}
+	</form>
+	
+</div>
+
+<br clear="all" />
+
+<!-- INCLUDE breadcrumbs.html -->
+
+<br clear="all" />
+
+<!-- INCLUDE overall_footer.html -->
diff -ruN phpBB-3.0.10/styles/spring/template/mcp_ban.html phpbb/styles/spring/template/mcp_ban.html
--- phpBB-3.0.10/styles/spring/template/mcp_ban.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/mcp_ban.html	2014-04-15 14:31:18.688429005 +0200
@@ -0,0 +1,109 @@
+<!-- INCLUDE mcp_header.html -->
+
+<script type="text/javascript">
+// <![CDATA[
+
+	var ban_length = new Array();
+		ban_length[-1] = '';
+	<!-- BEGIN ban_length -->
+		ban_length['{ban_length.BAN_ID}'] = '{ban_length.A_LENGTH}';
+	<!-- END ban_length -->
+
+	var ban_reason = new Array();
+		ban_reason[-1] = '';
+	<!-- BEGIN ban_reason -->
+		ban_reason['{ban_reason.BAN_ID}'] = '{ban_reason.A_REASON}';
+	<!-- END ban_reason -->
+
+	var ban_give_reason = new Array();
+		ban_give_reason[-1] = '';
+	<!-- BEGIN ban_give_reason -->
+		ban_give_reason['{ban_give_reason.BAN_ID}'] = '{ban_give_reason.A_REASON}';
+	<!-- END ban_give_reason -->
+
+	function display_details(option)
+	{
+		document.getElementById('mcp_ban').unbangivereason.value = ban_give_reason[option];
+		document.getElementById('mcp_ban').unbanreason.value = ban_reason[option];
+		document.getElementById('mcp_ban').unbanlength.value = ban_length[option];
+	}
+
+// ]]>
+</script>
+
+<form id="mcp_ban" method="post" action="{U_ACTION}">
+
+<table width="100%" class="tablebg" cellspacing="1" cellpadding="4" border="0">
+<tr>
+	<th colspan="2" nowrap="nowrap">{L_TITLE}</th>
+</tr>
+<tr>
+	<td class="row3" colspan="2">{L_EXPLAIN}</td>
+</tr>
+<tr>
+	<td class="row1" width="45%" valign="top"><b>{L_BAN_CELL}:</b></td>
+	<td class="row2">
+		<textarea name="ban" id="ban" cols="40" rows="3" class="post">{USERNAMES}</textarea>
+		<!-- IF S_USERNAME_BAN --><br />[ <a href="{U_FIND_USERNAME}" onclick="find_username(this.href); return false;">{L_FIND_USERNAME}</a> ]<!-- ENDIF -->
+	</td>
+</tr>
+<tr>
+	<td class="row1" valign="top"><b>{L_BAN_LENGTH}:</b></td>
+	<td class="row2"><select name="banlength">{S_BAN_END_OPTIONS}</select><br /><input type="text" name="banlengthother" class="post" /> {L_YEAR_MONTH_DAY}</td>
+</tr>
+<tr>
+	<td class="row1" valign="top"><b>{L_BAN_EXCLUDE}:</b><br /><span class="gensmall">{L_BAN_EXCLUDE_EXPLAIN}</span></td>
+	<td class="row2"><input type="radio" class="radio" name="banexclude" value="1" /> {L_YES} &nbsp; <input type="radio" class="radio" name="banexclude" value="0" checked="checked" /> {L_NO}</td>
+</tr>
+<tr>
+	<td class="row1" valign="top"><b>{L_BAN_REASON}:</b></td>
+	<td class="row2"><input name="banreason" type="text" class="post" maxlength="255" /></td>
+</tr>
+<tr>
+	<td class="row1" valign="top"><b>{L_BAN_GIVE_REASON}:</b></td>
+	<td class="row2"><input name="bangivereason" type="text" class="post" maxlength="255" /></td>
+</tr>
+<tr>
+	<td class="cat" colspan="2" align="center"><input type="submit" name="bansubmit" value="{L_SUBMIT}" class="btnmain" />&nbsp; <input type="reset" value="{L_RESET}" class="btnlite" />&nbsp;</td>
+</tr>
+</table>
+
+<br /><br />
+
+<table width="100%" class="tablebg" cellspacing="1" cellpadding="4" border="0">
+<tr>
+	<th colspan="2" nowrap="nowrap">{L_UNBAN_TITLE}</th>
+</tr>
+<tr>
+	<td class="row3" colspan="2">{L_UNBAN_EXPLAIN}</td>
+</tr>
+<!-- IF S_BANNED_OPTIONS -->
+	<tr>
+		<td class="row1" valign="top" width="45%"><b>{L_BAN_CELL}:</b></td>
+		<td class="row2"><select name="unban[]" multiple="multiple" size="10" style="width: 50%" onchange="if (this.selectedIndex > -1) display_details(this.options[this.selectedIndex].value); else display_details(-1);">{BANNED_OPTIONS}</select></td>
+	</tr>
+	<tr>
+		<td class="row1" valign="top"><b>{L_BAN_LENGTH}:</b></td>
+		<td class="row2"><input style="border: 0; width: 100%" type="text" name="unbanlength" readonly="readonly" /></td>
+	</tr>
+	<tr>
+		<td class="row1" valign="top"><b>{L_BAN_REASON}:</b></td>
+		<td class="row2"><textarea style="border: 0; width: 100%" name="unbanreason" readonly="readonly" rows="5" cols="80">&nbsp;</textarea></td>
+	</tr>
+	<tr>
+		<td class="row1" valign="top"><b>{L_BAN_GIVE_REASON}:</b></td>
+		<td class="row2"><textarea style="border: 0; width: 100%" name="unbangivereason" readonly="readonly" rows="5" cols="80">&nbsp;</textarea></td>
+	</tr>
+	<tr>
+		<td class="cat" colspan="2" align="center"><input type="submit" name="unbansubmit" value="{L_SUBMIT}" class="btnmain" />&nbsp; <input type="reset" value="{L_RESET}" class="btnlite" />&nbsp;</td>
+	</tr>
+<!-- ELSE -->
+	<tr>
+		<td class="row1" colspan="2"><b>{L_NO_BAN_CELL}</b></td>
+	</tr>
+<!-- ENDIF -->
+</table>
+{S_FORM_TOKEN}
+</form>
+
+<!-- INCLUDE mcp_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/mcp_footer.html phpbb/styles/spring/template/mcp_footer.html
--- phpBB-3.0.10/styles/spring/template/mcp_footer.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/mcp_footer.html	2014-04-15 14:31:18.689429005 +0200
@@ -0,0 +1,27 @@
+
+			</td>
+		</tr>
+	</table>
+
+	<!-- IF PAGINATION -->
+		<table width="80%" align="{S_CONTENT_FLOW_END}" cellspacing="1">
+		<tr>
+			<td class="nav" valign="middle" nowrap="nowrap">&nbsp;{PAGE_NUMBER}<br /></td>
+			<td class="gensmall" nowrap="nowrap">&nbsp;[ <!-- IF TOTAL_TOPICS -->{TOTAL_TOPICS}<!-- ELSEIF TOTAL_POSTS -->{TOTAL_POSTS}<!-- ELSE -->{TOTAL}<!-- ENDIF --> ]&nbsp;</td>
+			<td class="gensmall" width="100%" align="{S_CONTENT_FLOW_END}" nowrap="nowrap"><!-- INCLUDE pagination.html --></td>
+		</tr>
+		</table>
+		<br />
+	<!-- ENDIF -->
+	
+</div>
+
+<br clear="all" />
+
+<!-- INCLUDE breadcrumbs.html -->
+
+<br clear="all" />
+
+<div align="{S_CONTENT_FLOW_END}"><!-- INCLUDE jumpbox.html --></div>
+
+<!-- INCLUDE overall_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/mcp_forum.html phpbb/styles/spring/template/mcp_forum.html
--- phpBB-3.0.10/styles/spring/template/mcp_forum.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/mcp_forum.html	2014-04-15 14:31:18.691429005 +0200
@@ -0,0 +1,89 @@
+<!-- INCLUDE mcp_header.html -->
+
+<!-- IF S_MERGE_SELECT --><div style="float: {S_CONTENT_FLOW_END};"><!-- INCLUDE jumpbox.html --></div><!-- ENDIF -->
+
+<!-- IF U_VIEW_FORUM_LOGS --><a href="{U_VIEW_FORUM_LOGS}">{L_VIEW_FORUM_LOGS}</a><!-- ENDIF -->
+
+<!-- IF S_MERGE_SELECT --><br clear="{S_CONTENT_FLOW_END}" /><!-- ENDIF -->
+
+<form method="post" id="mcp" action="{S_MCP_ACTION}">
+
+<table class="tablebg" width="100%" cellspacing="1">
+<tr>
+	<td class="cat" colspan="6" align="center"><span class="gensmall">{L_DISPLAY_TOPICS}:</span> {S_SELECT_SORT_DAYS}&nbsp;<span class="gensmall">{L_SORT_BY}</span> {S_SELECT_SORT_KEY} {S_SELECT_SORT_DIR}&nbsp;<input class="btnlite" type="submit" name="sort" value="{L_GO}" /></td>
+</tr>
+<tr>
+	<th width="4%" nowrap="nowrap">&nbsp;</th>
+	<th nowrap="nowrap">&nbsp;{L_TOPICS}&nbsp;</th>
+	<th width="8%" nowrap="nowrap">&nbsp;{L_REPLIES}&nbsp;</th>
+	<th width="17%" nowrap="nowrap">&nbsp;{L_LAST_POST}&nbsp;</th>
+	<th width="5%" nowrap="nowrap">&nbsp;{L_MARK}&nbsp;</th>
+</tr>
+<!-- BEGIN topicrow -->
+	<tr>
+		<td class="row1" width="25" align="center">{topicrow.TOPIC_FOLDER_IMG}</td>
+		<!-- IF S_TOPIC_ICONS -->
+			<!-- td class="row1" width="25" align="center">{topicrow.TOPIC_ICON_IMG}</td -->
+		<!-- ENDIF -->
+		<td class="row1">
+			<!-- IF topicrow.S_SELECT_TOPIC -->
+				<span class="genmed">[ <a href="{topicrow.U_SELECT_TOPIC}">{L_SELECT_MERGE}</a> ]&nbsp;</span>
+			<!-- ENDIF -->
+			<p class="topictitle">{NEWEST_POST_IMG} {topicrow.ATTACH_ICON_IMG} <a href="{topicrow.U_VIEW_TOPIC}">{topicrow.TOPIC_TITLE}</a>
+			<!-- IF topicrow.S_TOPIC_UNAPPROVED or topicrow.S_POSTS_UNAPPROVED -->
+				<a href="{topicrow.U_MCP_QUEUE}">{topicrow.UNAPPROVED_IMG}</a>&nbsp;
+			<!-- ENDIF -->
+			<!-- IF topicrow.S_TOPIC_REPORTED and topicrow.U_MCP_REPORT -->
+				<a href="{topicrow.U_MCP_REPORT}">{REPORTED_IMG}</a>&nbsp;
+			<!-- ENDIF -->
+			<!-- IF topicrow.S_MOVED_TOPIC and S_CAN_DELETE -->
+				[ <a href="{topicrow.U_DELETE_TOPIC}">{L_DELETE_SHADOW_TOPIC}</a> ]&nbsp;
+			<!-- ENDIF -->
+			</p>
+		</td>
+		<td class="row1" width="50" align="center"><p class="topicdetails">{topicrow.REPLIES}</p></td>
+		<td class="row1" width="120" align="center"><p class="topicdetails">{topicrow.LAST_POST_TIME}</p></td>
+		<td class="row2" align="center">
+			<!-- IF not topicrow.S_MOVED_TOPIC and not S_MERGE_SELECT --><input type="checkbox" class="radio" name="topic_id_list[]" value="{topicrow.TOPIC_ID}"<!-- IF topicrow.S_TOPIC_CHECKED --> checked="checked"<!-- ENDIF --> /><!-- ELSE -->&nbsp;<!-- ENDIF -->
+		</td>
+	</tr>
+<!-- BEGINELSE -->
+	<tr>
+		<td class="row1" colspan="8" align="center"><p class="gen">{L_NO_TOPICS}</p></td>
+	</tr>
+<!-- END topicrow -->
+<!-- IF not S_MERGE_SELECT -->
+<tr>
+	<td class="cat" colspan="6" align="{S_CONTENT_FLOW_END}">
+		<select name="action">
+			<option value="" selected="selected">{L_SELECT_ACTION}</option>
+			<!-- IF S_CAN_DELETE --><option value="delete_topic">{L_DELETE}</option><!-- ENDIF -->
+			<!-- IF S_CAN_MERGE --><option value="merge_topics">{L_MERGE}</option><!-- ENDIF -->
+			<!-- IF S_CAN_MOVE --><option value="move">{L_MOVE}</option><!-- ENDIF -->
+			<!-- IF S_CAN_FORK --><option value="fork">{L_FORK}</option><!-- ENDIF -->
+			<!-- IF S_CAN_LOCK --><option value="lock">{L_LOCK}</option><option value="unlock">{L_UNLOCK}</option><!-- ENDIF -->
+			<!-- IF S_CAN_SYNC --><option value="resync">{L_RESYNC}</option><!-- ENDIF -->
+			<!-- IF S_CAN_MAKE_NORMAL --><option value="make_normal">{L_MAKE_NORMAL}</option><!-- ENDIF -->
+			<!-- IF S_CAN_MAKE_STICKY --><option value="make_sticky">{L_MAKE_STICKY}</option><!-- ENDIF -->
+			<!-- IF S_CAN_MAKE_ANNOUNCE -->
+				<option value="make_announce">{L_MAKE_ANNOUNCE}</option>
+				<option value="make_global">{L_MAKE_GLOBAL}</option>
+			<!-- ENDIF -->
+		</select>
+		<input class="btnmain" type="submit" value="{L_SUBMIT}" />
+	</td>
+</tr>
+<!-- ENDIF -->
+</table>
+{S_FORM_TOKEN}
+</form>
+
+<!-- IF not S_MERGE_SELECT -->
+<table width="100%" cellspacing="2" cellpadding="2" border="0" align="center">
+<tr>
+	<td align="{S_CONTENT_FLOW_END}" valign="top" nowrap="nowrap"><b class="gensmall"><a href="#" onclick="marklist('mcp', 'topic_id_list', true); return false;">{L_MARK_ALL}</a> :: <a href="#" onclick="marklist('mcp', 'topic_id_list', false); return false;">{L_UNMARK_ALL}</a></b></td>
+</tr>
+</table>
+<!-- ENDIF -->
+
+<!-- INCLUDE mcp_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/mcp_front.html phpbb/styles/spring/template/mcp_front.html
--- phpBB-3.0.10/styles/spring/template/mcp_front.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/mcp_front.html	2014-04-15 14:31:18.692429005 +0200
@@ -0,0 +1,155 @@
+<!-- INCLUDE mcp_header.html -->
+
+<!-- IF S_SHOW_UNAPPROVED -->
+	<form name="mcp_queue" method="post" action="{S_MCP_QUEUE_ACTION}">
+
+	<table class="tablebg" width="100%" cellspacing="1">
+	<tr>
+		<td class="row3" colspan="6" align="center"><b class="gen">{L_LATEST_UNAPPROVED}</b></td>
+	</tr>
+	<tr>
+		<th>&nbsp;{L_FORUM}&nbsp;</th>
+		<th>&nbsp;{L_TOPIC}&nbsp;</th>
+		<th>&nbsp;{L_SUBJECT}&nbsp;</th>
+		<th>&nbsp;{L_AUTHOR}&nbsp;</th>
+		<th>&nbsp;{L_POST_TIME}&nbsp;</th>
+		<th width="5%">&nbsp;{L_SELECT}&nbsp;</th>
+	</tr>
+	<!-- BEGIN unapproved -->
+		<tr>
+			<td class="row1" width="15%" valign="top"><span class="gen"><!-- IF unapproved.U_FORUM --><a href="{unapproved.U_FORUM}">{unapproved.FORUM_NAME}</a><!-- ELSE -->{unapproved.FORUM_NAME}<!-- ENDIF --></span><!-- IF unapproved.U_MCP_FORUM --><br /><span class="gensmall">[ <a href="{unapproved.U_MCP_FORUM}">{L_MODERATE}</a> ]</span><!-- ENDIF --></td>
+			<td class="row2" valign="top"><span class="gen"><a href="{unapproved.U_TOPIC}">{unapproved.TOPIC_TITLE}</a></span><br /><span class="gensmall">[ <a href="{unapproved.U_MCP_TOPIC}">{L_MODERATE}</a> ]</span></td>
+			<td class="row1" valign="top"><span class="gen">{unapproved.SUBJECT}</span><br /><span class="gensmall">[ <a href="{unapproved.U_POST_DETAILS}">{L_VIEW_DETAILS}</a> ]</span></td>
+			<td class="row2" align="center" width="15%" nowrap="nowrap" valign="top"><span class="gen">{unapproved.AUTHOR_FULL}</span></td>
+			<td class="row1" align="center" width="15%" nowrap="nowrap" valign="top"><span class="gensmall">{unapproved.POST_TIME}</span></td>
+			<td class="row2" align="center"><input type="checkbox" class="radio" name="post_id_list[]" value="{unapproved.POST_ID}" /></td>
+		</tr>
+	<!-- BEGINELSE -->
+		<tr>
+			<td class="row1" colspan="6" align="center"><span class="gen">{L_UNAPPROVED_POSTS_ZERO_TOTAL}</span></td>
+		</tr>
+	<!-- END unapproved -->
+	<!-- IF S_HAS_UNAPPROVED_POSTS -->
+		<tr>
+			<td class="row3" colspan="6"><span class="gensmall">{L_UNAPPROVED_TOTAL}</span></td>
+		</tr>
+	<!-- ENDIF -->
+	<tr>
+		<td class="cat" colspan="6" align="center">{S_HIDDEN_FIELDS}<input class="btnmain" type="submit" name="action[approve]" value="{L_APPROVE}" />&nbsp;&nbsp;<input class="btnlite" type="submit" name="action[disapprove]" value="{L_DISAPPROVE}" /></td>
+	</tr>
+	</table>
+	{S_FORM_TOKEN}
+	</form>
+	
+	<table width="100%" cellspacing="2" cellpadding="2" border="0" align="center">
+	<tr>
+		<td align="{S_CONTENT_FLOW_END}" valign="top" nowrap="nowrap"><b class="gensmall"><a href="#" onclick="marklist('mcp_queue', '', true); return false;">{L_MARK_ALL}</a> :: <a href="#" onclick="marklist('mcp_queue', '', false); return false;">{L_UNMARK_ALL}</a></b></td>
+	</tr>
+	</table>
+
+	<br clear="all" /><br />
+<!-- ENDIF -->
+
+<!-- IF S_SHOW_REPORTS -->
+	<table class="tablebg" width="100%" cellspacing="1">
+	<tr>
+		<td class="row3" colspan="5" align="center"><b class="gen">{L_LATEST_REPORTED}</b></td>
+	</tr>
+	<tr>
+		<th>&nbsp;{L_FORUM}&nbsp;</th>
+		<th>&nbsp;{L_TOPIC}&nbsp;</th>
+		<th>&nbsp;{L_SUBJECT}&nbsp;</th>
+		<th>&nbsp;{L_REPORTER}&nbsp;</th>
+		<th>&nbsp;{L_REPORT_TIME}&nbsp;</th>
+	</tr>
+	<!-- BEGIN report -->
+		<tr>
+			<td class="row1" width="15%" valign="top"><span class="gen"><!-- IF report.U_FORUM --><a href="{report.U_FORUM}">{report.FORUM_NAME}</a><!-- ELSE -->{report.FORUM_NAME}<!-- ENDIF --></span><!-- IF report.U_MCP_FORUM --><br /><span class="gensmall">[ <a href="{report.U_MCP_FORUM}">{L_MODERATE}</a> ]</span><!-- ENDIF --></td>
+			<td class="row2" valign="top"><span class="gen"><a href="{report.U_TOPIC}">{report.TOPIC_TITLE}</a></span><br /><span class="gensmall">[ <a href="{report.U_MCP_TOPIC}">{L_MODERATE}</a> ]</span></td>
+			<td class="row1" valign="top"><span class="gen">{report.SUBJECT}</span><br /><span class="gensmall">[ <a href="{report.U_POST_DETAILS}">{L_VIEW_DETAILS}</a> ]</span></td>
+			<td class="row2" align="center" width="15%" nowrap="nowrap" valign="top"><span class="gen">{report.REPORTER_FULL}</span></td>
+			<td class="row1" align="center" width="15%" nowrap="nowrap" valign="top"><span class="gensmall">{report.REPORT_TIME}</span></td>
+		</tr>
+	<!-- BEGINELSE -->
+		<tr>
+			<td class="row1" colspan="5" align="center"><span class="gen">{L_REPORTS_ZERO_TOTAL}</span></td>
+		</tr>
+	<!-- END report -->
+	<!-- IF S_HAS_REPORTS -->
+		<tr>
+			<td class="row3" colspan="5"><span class="gensmall">{L_REPORTS_TOTAL}</span></td>
+		</tr>
+	<!-- ENDIF -->
+	</table>
+
+	<br clear="all" /><br />
+<!-- ENDIF -->
+
+<!-- IF S_SHOW_PM_REPORTS -->
+	<table class="tablebg" width="100%" cellspacing="1">
+	<tr>
+		<td class="row3" colspan="6" align="center"><b class="gen">{L_LATEST_REPORTED_PMS}</b></td>
+	</tr>
+	<tr>
+		<th>&nbsp;{L_PM_SUBJECT}&nbsp;</th>
+		<th>&nbsp;{L_PM_FROM}&nbsp;</th>
+		<th>&nbsp;{L_TO} &amp; {L_BCC}&nbsp;</th>
+		<th>&nbsp;{L_SENT_AT}&nbsp;</th>
+		<th>&nbsp;{L_REPORTER}&nbsp;</th>
+		<th>&nbsp;{L_REPORT_TIME}&nbsp;</th>
+	</tr>
+	<!-- BEGIN pm_report -->
+		<tr>
+			<td class="row1" valign="top"><span class="gen">{pm_report.PM_SUBJECT}</span><br /><span class="gensmall">[ <a href="{pm_report.U_PM_DETAILS}">{L_VIEW_DETAILS}</a> ]</span></td>
+			<td class="row2" align="center" width="15%" nowrap="nowrap" valign="top"><span class="gen">{pm_report.PM_AUTHOR_FULL}</span></td>
+			<td class="row1" align="center" width="15%" nowrap="nowrap" valign="top"><span class="gen">{pm_report.RECIPIENTS}</span></td>
+			<td class="row2" align="center" width="10%" nowrap="nowrap" valign="top"><span class="gensmall">{pm_report.PM_TIME}</span></td>
+			<td class="row1" align="center" width="15%" nowrap="nowrap" valign="top"><span class="gen">{pm_report.REPORTER_FULL}</span></td>
+			<td class="row2" align="center" width="10%" nowrap="nowrap" valign="top"><span class="gensmall">{pm_report.REPORT_TIME}</span></td>
+		</tr>
+	<!-- BEGINELSE -->
+		<tr>
+			<td class="row1" colspan="6" align="center"><span class="gen">{L_PM_REPORTS_ZERO_TOTAL}</span></td>
+		</tr>
+	<!-- END pm_report -->
+	<!-- IF S_HAS_PM_REPORTS -->
+		<tr>
+			<td class="row3" colspan="6"><span class="gensmall">{L_PM_REPORTS_TOTAL}</span></td>
+		</tr>
+	<!-- ENDIF -->
+	</table>
+
+	<br clear="all" /><br />
+<!-- ENDIF -->
+
+<!-- IF S_SHOW_LOGS -->
+	<table class="tablebg" width="100%" cellspacing="1" cellpadding="4" border="0" align="{S_CONTENT_FLOW_END}">
+	<tr>
+		<td class="row3" colspan="5" align="center"><b class="gen">{L_LATEST_LOGS}</b></td>
+	</tr>
+	<tr>
+		<th width="15%" nowrap="nowrap">{L_USERNAME}</th>
+		<th width="12%" nowrap="nowrap">{L_IP}</th>
+		<th width="45%" nowrap="nowrap">{L_ACTION}</th>
+		<th nowrap="nowrap"></th>
+		<th width="18%" nowrap="nowrap">{L_TIME}</th>
+	</tr>
+	<!-- BEGIN log -->
+		<tr>
+			<td class="row1" nowrap="nowrap"><span class="gen">{log.USERNAME}</span></td>
+			<td class="row1" align="center" nowrap="nowrap"><span class="gen">{log.IP}</span></td>
+			<td class="row1"><span class="genmed">{log.ACTION}</span></td>
+			<td class="row1" align="center" nowrap="nowrap"><span class="gensmall"><!-- IF log.U_VIEW_TOPIC --><a href="{log.U_VIEW_TOPIC}">{L_VIEW_TOPIC}</a><!-- IF log.U_VIEWLOGS --> | <!-- ENDIF --><!-- ENDIF --><!-- IF log.U_VIEWLOGS --><a href="{log.U_VIEWLOGS}">{L_VIEW_TOPIC_LOGS}</a><!-- ENDIF --></span></td>
+			<td class="row1" align="center" nowrap="nowrap"><span class="gensmall">{log.TIME}</span></td>
+		</tr>
+	<!-- BEGINELSE -->
+		<tr>
+			<td class="row1" colspan="5" align="center"><span class="gen">{L_NO_ENTRIES}</span></td>
+		</tr>
+	<!-- END log -->
+	</table>
+
+	<br clear="all" />
+<!-- ENDIF -->
+
+<!-- INCLUDE mcp_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/mcp_header.html phpbb/styles/spring/template/mcp_header.html
--- phpBB-3.0.10/styles/spring/template/mcp_header.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/mcp_header.html	2014-04-15 14:31:18.693429005 +0200
@@ -0,0 +1,79 @@
+<!-- INCLUDE overall_header.html -->
+
+<div id="pageheader">
+	<!-- IF U_MCP -->
+		<p class="linkmcp">
+			[ <a href="{U_MCP}">{L_MCP}</a><!-- IF U_MCP_FORUM --> | <a href="{U_MCP_FORUM}">{L_MODERATE_FORUM}</a><!-- ENDIF -->
+			<!-- IF U_MCP_TOPIC --> | <a href="{U_MCP_TOPIC}">{L_MODERATE_TOPIC}</a><!-- ENDIF -->
+			<!-- IF U_MCP_POST --> | <a href="{U_MCP_POST}">{L_MODERATE_POST}</a><!-- ENDIF --> ]
+		</p>
+	<!-- ENDIF -->
+
+	<!-- IF TOPIC_TITLE or FORUM_NAME -->
+	<h2><!-- IF TOPIC_TITLE --><a class="titles" href="{U_VIEW_TOPIC}">{TOPIC_TITLE}</a><!-- ELSE --><a class="titles" href="{U_VIEW_FORUM}">{FORUM_NAME}</a><!-- ENDIF --></h2>
+	<!-- ENDIF -->
+</div>
+
+<br clear="all" />
+
+<div id="pagecontent">
+
+	<table width="100%" cellspacing="0" cellpadding="0" border="0">
+	<tr>
+		<td width="20%" valign="top">
+
+			<table class="tablebg" width="100%" cellspacing="1">
+			<tr>
+				<th>{L_OPTIONS}</th>
+			</tr>
+			<!-- BEGIN l_block1 -->
+				<tr>
+				<!-- IF l_block1.S_SELECTED -->
+					<td class="row1"><b class="nav">{l_block1.L_TITLE}</b>
+
+					<ul class="nav" style="margin: 0; padding: 0; list-style-type: none; line-height: 175%;">
+					<!-- BEGIN l_block2 -->
+						<li>&#187; <!-- IF l_block1.l_block2.S_SELECTED --><b>{l_block1.l_block2.L_TITLE}</b><!-- ELSE --><a href="{l_block1.l_block2.U_TITLE}">{l_block1.l_block2.L_TITLE}</a><!-- ENDIF --></li>
+					<!-- END l_block2 -->
+					</ul>
+				<!-- ELSE -->
+					<td class="row2" nowrap="nowrap" onmouseover="this.className='row1'" onmouseout="this.className='row2'" onclick="location.href=this.firstChild.href;"><a class="nav" href="{l_block1.U_TITLE}">{l_block1.L_TITLE}</a>
+				<!-- ENDIF -->
+					</td>
+				</tr>
+			<!-- END l_block1 -->
+			</table>
+
+		</td>
+		<td><img src="images/spacer.gif" width="4" alt="" /></td>
+		<td width="80%" valign="top">
+
+		<!-- IF MESSAGE -->
+			<table class="tablebg" width="100%" cellspacing="1">
+			<tr>
+				<th>{L_MESSAGE}</th>
+			</tr>
+			<tr>
+				<td class="row1" align="center"><br /><span class="gen">{MESSAGE}<br /><br /><!-- BEGIN return_links -->{return_links.MESSAGE_LINK}<br /><br /><!-- END return_links --></span></td>
+			</tr>
+			</table>
+
+			<br />
+		<!-- ENDIF -->
+
+		<!-- IF CONFIRM_MESSAGE -->
+			<form name="confirm" method="post" action="{S_CONFIRM_ACTION}">
+
+			<table class="tablebg" width="100%" cellspacing="1">
+			<tr>
+				<th>{L_PLEASE_CONFIRM}</th>
+			</tr>
+			<tr>
+				<td class="row1" align="center"><span class="gen"><br />{CONFIRM_MESSAGE}<br /><br />{S_HIDDEN_FIELDS}<input class="btnmain" type="submit" name="confirm" value="{L_YES}" />&nbsp;&nbsp;<input class="btnlite" type="submit" name="cancel" value="{L_NO}" /><br /><br /></span></td>
+			</tr>
+			</table>
+
+			</form>
+
+			<br />
+		<!-- ENDIF -->
diff -ruN phpBB-3.0.10/styles/spring/template/mcp_jumpbox.html phpbb/styles/spring/template/mcp_jumpbox.html
--- phpBB-3.0.10/styles/spring/template/mcp_jumpbox.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/mcp_jumpbox.html	2014-04-15 14:31:18.693429005 +0200
@@ -0,0 +1,18 @@
+<!-- Note: no longer in use... -->
+
+<form name="jumpbox" method="post" action="{S_JUMPBOX_ACTION}">
+
+	<span class="gensmall">{L_JUMP_TO}:</span>&nbsp;<select name="f" onChange="if(this.options[this.selectedIndex].value != -1 && this.options[this.selectedIndex].value != document.jumpbox.current_f.value){ document.forms['jumpbox'].submit() }">
+
+<!-- IF S_ENABLE_SELECT_ALL -->
+	<option value="0">{L_ALL_FORUMS}</option>
+<!-- ELSE -->
+	<option value="-1">{L_SELECT_FORUM}</option>
+<!-- ENDIF -->
+
+<!-- BEGIN options -->
+	<option value="{options.VALUE}"<!-- IF options.VALUE eq -1 --> class="disabled-option"<!-- ENDIF -->{options.SELECTED}/>{options.TEXT}</option>
+<!-- BEGINELSE -->
+<!-- END options -->
+</select>&nbsp;<input type="hidden" name="current_f" value="{S_CURRENT_FORUM}" /><input name="jumpbox" class="btnlite" type="submit" value="{L_GO}" onclick="if(document.jumpbox.f.value == -1){return false;}" />
+</form>
diff -ruN phpBB-3.0.10/styles/spring/template/mcp_logs.html phpbb/styles/spring/template/mcp_logs.html
--- phpBB-3.0.10/styles/spring/template/mcp_logs.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/mcp_logs.html	2014-04-15 14:31:18.694429005 +0200
@@ -0,0 +1,46 @@
+<!-- INCLUDE mcp_header.html -->
+
+<form method="post" name="mcp" action="{U_POST_ACTION}">
+	
+<table width="100%" cellpadding="3" cellspacing="1" border="0" class="tablebg">
+<tr>
+	<th>{L_USERNAME}</th>
+	<th>{L_IP}</th>
+	<th>{L_TIME}</th>
+	<th>{L_ACTION}</th>
+	<!-- IF S_CLEAR_ALLOWED --><th>{L_MARK}</th><!-- ENDIF -->
+</tr>
+<!-- IF S_LOGS -->
+
+	<!-- BEGIN log -->
+		<!-- IF log.S_ROW_COUNT is even --><tr class="row1"><!-- ELSE --><tr class="row2"><!-- ENDIF -->
+			<td class="genmed">{log.USERNAME}</td>
+			<td class="genmed" style="text-align: center;">{log.IP}</td>
+			<td class="genmed" style="text-align: center;">{log.DATE}</td>
+			<td class="genmed">{log.ACTION}<br />{log.DATA}</td>
+			<!-- IF S_CLEAR_ALLOWED --><td width="5%" align="center"><input type="checkbox" class="radio" name="mark[]" value="{log.ID}" /></td><!-- ENDIF -->
+		</tr>
+	<!-- END log -->
+	<tr align="center">
+		<td class="row3" colspan="<!-- IF S_CLEAR_ALLOWED -->5<!-- ELSE -->4<!-- ENDIF -->"><span class="gensmall">{L_SEARCH_KEYWORDS}:</span> <input type="text" name="keywords" value="{S_KEYWORDS}" />&nbsp;<input type="submit" class="btnlite" name="filter" value="{L_SEARCH}" /></td>
+	</tr>
+	<tr align="center">
+		<td class="row3" colspan="<!-- IF S_CLEAR_ALLOWED -->5<!-- ELSE -->4<!-- ENDIF -->"><span class="gensmall">{L_DISPLAY_LOG}:</span> {S_SELECT_SORT_DAYS}&nbsp;<span class="gensmall">{L_SORT_BY}</span> {S_SELECT_SORT_KEY} {S_SELECT_SORT_DIR}&nbsp;<input class="btnlite" type="submit" value="{L_GO}" name="sort" /></td>
+	</tr>
+	<!-- IF S_CLEAR_ALLOWED -->
+		<tr>
+			<td class="cat" colspan="5" align="center"><input class="btnlite" type="submit" name="action[del_all]" value="{L_DELETE_ALL}" />&nbsp; <input class="btnlite" type="submit" name="action[del_marked]" value="{L_DELETE_MARKED}" /></td>
+		</tr>
+	<!-- ENDIF -->
+<!-- ELSE -->
+	<tr>
+		<td class="row1" colspan="<!-- IF S_CLEAR_ALLOWED -->5<!-- ELSE -->4<!-- ENDIF -->" align="center"><span class="gen">{L_NO_ENTRIES}</span></td>
+	</tr>
+<!-- ENDIF -->
+</table>
+{S_FORM_TOKEN}
+</form>
+
+<br clear="all" /><br />
+
+<!-- INCLUDE mcp_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/mcp_message.html phpbb/styles/spring/template/mcp_message.html
--- phpBB-3.0.10/styles/spring/template/mcp_message.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/mcp_message.html	2014-04-15 14:31:18.695429005 +0200
@@ -0,0 +1,14 @@
+<!-- INCLUDE mcp_header.html -->
+
+<table class="tablebg" width="100%" cellspacing="1" cellpadding="4" border="0" align="center">
+<tr>
+	<th><b>{MESSAGE_TITLE}</b></th>
+</tr>
+<tr> 
+	<td class="row1" align="center"><br /><span class="gen">{MESSAGE_TEXT}</span><br /><br /></td>
+</tr>
+</table>
+
+<br clear="all" />
+
+<!-- INCLUDE mcp_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/mcp_move.html phpbb/styles/spring/template/mcp_move.html
--- phpBB-3.0.10/styles/spring/template/mcp_move.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/mcp_move.html	2014-04-15 14:31:18.695429005 +0200
@@ -0,0 +1,43 @@
+<!-- INCLUDE overall_header.html -->
+
+<div id="pagecontent">
+
+	<form name="confirm" action="{S_CONFIRM_ACTION}" method="post">
+	
+	<table class="tablebg" width="100%" cellspacing="1">
+	<tr>
+		<th>{MESSAGE_TITLE}</th>
+	</tr>
+	<tr>
+		<td class="row1" align="center">
+			<!-- IF ADDITIONAL_MSG -->
+				<span class="gen error">{ADDITIONAL_MSG}</span><br />
+			<!-- ENDIF -->
+			<!-- IF S_FORUM_SELECT -->
+				<span class="gen"><br />{L_SELECT_DESTINATION_FORUM}&nbsp;&nbsp;</span>
+					<select name="to_forum_id">{S_FORUM_SELECT}</select><br />
+				<!-- IF S_CAN_LEAVE_SHADOW -->
+					<input type="checkbox" class="radio" name="move_leave_shadow" checked="checked" /><span class="gen">{L_LEAVE_SHADOW}</span><br />
+				<!-- ENDIF -->
+				<br />{S_HIDDEN_FIELDS}<span class="gen">{MESSAGE_TEXT}</span><br /><br />
+				<input type="submit" name="confirm" value="{YES_VALUE}" class="btnmain" />&nbsp;&nbsp;<input type="submit" name="cancel" value="{L_NO}" class="btnlite" />
+			<!-- ELSE -->
+				<span class="gen">{L_NO_DESTINATION_FORUM}</span><br /><br />
+					{S_HIDDEN_FIELDS}
+					<input type="submit" name="cancel" value="{L_CANCEL}" class="btnlite" />
+			<!-- ENDIF -->
+		</td>
+	</tr>
+	</table>
+	{S_FORM_TOKEN}	
+	</form>
+	
+</div>
+
+<br clear="all" />
+
+<!-- INCLUDE breadcrumbs.html -->
+
+<br clear="all" />
+
+<!-- INCLUDE overall_footer.html -->
diff -ruN phpBB-3.0.10/styles/spring/template/mcp_notes_front.html phpbb/styles/spring/template/mcp_notes_front.html
--- phpBB-3.0.10/styles/spring/template/mcp_notes_front.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/mcp_notes_front.html	2014-04-15 14:31:18.696429005 +0200
@@ -0,0 +1,22 @@
+<!-- INCLUDE mcp_header.html -->
+
+<form method="post" name="mcp" action="{U_POST_ACTION}">
+
+<table class="tablebg" width="100%" cellspacing="1" cellpadding="4" border="0" align="center">
+<tr>
+	<th colspan="2"align="center">{L_SELECT_USER}</th>
+</tr>
+<tr>
+	<td class="row1" width="40%"><b class="gen">{L_FIND_USERNAME}: </b><br /><span class="gensmall">[ <a href="{U_FIND_USERNAME}" onclick="find_username(this.href); return false;">{L_FIND_USERNAME}</a> ]</span></td>
+	<td class="row2"><input type="text" class="post" name="username" size="20" /></td>
+</tr>
+<tr>
+	<td class="cat" colspan="2" align="center"><input type="submit" name="submituser" value="{L_SUBMIT}" class="btnmain" /></td>
+</tr>
+</table>
+{S_FORM_TOKEN}
+</form>
+
+<br clear="all" /><br />
+
+<!-- INCLUDE mcp_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/mcp_notes_user.html phpbb/styles/spring/template/mcp_notes_user.html
--- phpBB-3.0.10/styles/spring/template/mcp_notes_user.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/mcp_notes_user.html	2014-04-15 14:31:18.697429005 +0200
@@ -0,0 +1,125 @@
+<!-- INCLUDE mcp_header.html -->
+
+<form method="post" name="mcp" action="{U_POST_ACTION}">
+	
+<table width="100%" cellpadding="3" cellspacing="1" border="0" class="tablebg">
+<tr>
+	<th colspan="2" align="center">{USERNAME}</th>
+</tr>
+<tr> 
+	<td class="row1" align="center">
+		<table cellspacing="1" cellpadding="2" border="0">
+		<tr>
+			<td class="gen" align="center"><b>{USERNAME_FULL}</b></td>
+		</tr>
+		<!-- IF RANK_TITLE -->
+			<tr>
+				<td class="postdetails" align="center">{RANK_TITLE}</td>
+			</tr>
+		<!-- ENDIF -->
+		<!-- IF RANK_IMG -->
+			<tr>
+				<td align="center">{RANK_IMG}</td>
+			</tr>
+		<!-- ENDIF -->
+		<tr>
+			<td align="center"><!-- IF AVATAR_IMG -->{AVATAR_IMG}<!-- ELSE --><img src="{T_THEME_PATH}/images/no_avatar.gif" alt="" /><!-- ENDIF --></td>
+		</tr>
+		</table>
+	</td>
+	<td class="row1">
+		<table width="100%" cellspacing="1" cellpadding="2" border="0">
+		<tr> 
+			<td class="gen" align="{S_CONTENT_FLOW_END}" nowrap="nowrap">{L_JOINED}: </td>
+			<td width="100%"><b class="gen">{JOINED}</b></td>
+		</tr>
+		<tr> 
+			<td class="gen" align="{S_CONTENT_FLOW_END}" valign="top" nowrap="nowrap">{L_TOTAL_POSTS}: </td>
+			<td><b class="gen">{POSTS}</b></td>
+		</tr>
+		<tr> 
+			<td class="gen" align="{S_CONTENT_FLOW_END}" valign="top" nowrap="nowrap">{L_WARNINGS}: </td>
+			<td><b class="gen">{WARNINGS}</b></td>
+		</tr>
+		</table>
+	</td>
+</tr>
+</table>
+
+<br />
+
+<table width="100%" cellpadding="3" cellspacing="1" border="0" class="tablebg">
+<tr>
+	<th colspan="5" align="center">{L_FEEDBACK}</th>
+</tr>
+<!-- IF S_USER_NOTES -->
+
+	<tr align="center">
+		<td colspan="5" class="row3"><span class="gensmall">{L_SEARCH_KEYWORDS}:</span> <input type="text" name="keywords" value="{S_KEYWORDS}" />&nbsp;<input type="submit" class="btnlite" name="filter" value="{L_SEARCH}" /></td>
+	</tr>
+	<tr align="center">
+		<td colspan="5" class="row3"><span class="gensmall">{L_DISPLAY_LOG}:</span> {S_SELECT_SORT_DAYS}&nbsp;<span class="gensmall">{L_SORT_BY}:</span> {S_SELECT_SORT_KEY} {S_SELECT_SORT_DIR}&nbsp;<input class="btnlite" type="submit" value="{L_GO}" name="sort" /></td>
+	</tr>
+	<tr>
+		<th>{L_REPORT_BY}</th>
+		<th>{L_IP}</th>
+		<th>{L_TIME}</th>
+		<th>{L_ACTION}</th>
+		<th><!-- IF S_CLEAR_ALLOWED -->{L_MARK}<!-- ENDIF --></th>
+	</tr>
+
+	<!-- BEGIN usernotes -->
+		<!-- IF usernotes.S_ROW_COUNT is even --><tr class="row1"><!-- ELSE --><tr class="row2"><!-- ENDIF -->
+			<td class="gen">{usernotes.REPORT_BY}</td>
+			<td style="text-align: center;">{usernotes.IP}</td>
+			<td style="text-align: center;">{usernotes.REPORT_AT}</td>
+			<td class="gen">
+				{usernotes.ACTION}
+				<!-- IF usernotes.DATA --><br />&#187; <span class="gensmall">[ {usernotes.DATA} ]</span><!-- ENDIF -->
+			</td>
+			<td style="text-align: center;"><!-- IF S_CLEAR_ALLOWED --><input type="checkbox" class="radio" name="marknote[]" value="{usernotes.ID}" /><!-- ENDIF --></td>
+		</tr>
+	<!-- END usernotes -->
+
+	<!-- IF S_CLEAR_ALLOWED -->
+		<tr>
+			<td class="cat" colspan="5" align="center"><input class="btnlite" type="submit" name="action[del_all]" value="{L_DELETE_ALL}" />&nbsp; <input class="btnlite" type="submit" name="action[del_marked]" value="{L_DELETE_MARKED}" /></td>
+		</tr>
+	<!-- ENDIF -->
+
+<!-- ELSE -->
+	<tr>
+		<td class="row1" colspan="2" align="center"><span class="gen">{L_NO_FEEDBACK}</span></td>
+	</tr>
+<!-- ENDIF -->
+</table>
+
+<br clear="all" />
+	
+<table width="100%" cellpadding="3" cellspacing="1" border="0" class="tablebg">
+<tr>
+	<th colspan="2" align="center">{L_ADD_FEEDBACK}</th>
+</tr>
+<tr>
+	<td class="row3" align="center" colspan="2"><span class="genmed">{L_ADD_FEEDBACK_EXPLAIN}</span></td>
+</tr>
+<tr>
+	<td colspan="2" class="row1" align="center"><textarea name="usernote" rows="10" cols="76"></textarea></td>
+</tr>
+<tr>
+	<td class="cat" colspan="2" align="center"><input class="btnmain" type="submit" name="action[add_feedback]" value="{L_SUBMIT}" />&nbsp;&nbsp;<input class="btnlite" type="reset" value="{L_RESET}" /></td>
+</tr>
+</table>
+
+<table width="100%" cellspacing="0" cellpadding="0">
+<tr>
+	<td class="pagination">{PAGE_NUMBER} [ {TOTAL_REPORTS} ]</td>
+	<td align="{S_CONTENT_FLOW_END}"><span class="pagination"><!-- INCLUDE pagination.html --></span></td>
+</tr>
+</table>
+{S_FORM_TOKEN}
+</form>
+
+<br clear="all" /><br />
+
+<!-- INCLUDE mcp_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/mcp_post.html phpbb/styles/spring/template/mcp_post.html
--- phpBB-3.0.10/styles/spring/template/mcp_post.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/mcp_post.html	2014-04-15 14:31:18.698429005 +0200
@@ -0,0 +1,206 @@
+<!-- INCLUDE mcp_header.html -->
+
+<!-- IF S_MCP_REPORT -->
+	<form method="post" name="mcp_report" action="{S_CLOSE_ACTION}">
+
+	<table width="100%" cellpadding="3" cellspacing="1" border="0" class="tablebg">
+	<tr>
+		<th colspan="2" align="center"><!-- IF S_PM -->{L_PM_REPORT_DETAILS}<!-- ELSE -->{L_REPORT_DETAILS}<!-- ENDIF --></th>
+	</tr>
+	<tr>
+		<td class="row1"><b class="gen">{L_REPORT_REASON}: </b></td>
+		<td class="row2"><span class="gen">{REPORT_REASON_TITLE} &raquo; {REPORT_REASON_DESCRIPTION}</span></td>
+	</tr>
+	<tr>
+		<td class="row1" width="20%"><b class="gen">{L_REPORTER}: </b></td>
+		<td class="row2" width="80%"><span class="gen"<!-- IF REPORTER_COLOUR --> style="font-weight: bold; color: {REPORTER_COLOUR};"<!-- ENDIF -->>{REPORTER_NAME}</span> &nbsp; <span class="gen">[ <!-- IF U_VIEW_REPORTER_PROFILE --><a href="{U_VIEW_REPORTER_PROFILE}">{L_READ_PROFILE}</a><!-- ENDIF --><!-- IF S_USER_NOTES --><!-- IF U_VIEW_REPORTER_PROFILE --> | <!-- ENDIF --><a href="{U_MCP_REPORTER_NOTES}">{L_VIEW_NOTES}</a> | <a href="{U_MCP_WARN_REPORTER}">{L_WARN_USER}</a><!-- ENDIF --> ]</span></td>
+	</tr>
+	<tr>
+		<td class="row1"><b class="gen">{L_REPORTED}: </b></td>
+		<td class="row2"><span class="postdetails">{REPORT_DATE}</span></td>
+	</tr>
+	<!-- IF REPORT_TEXT -->
+		<tr>
+			<th colspan="2" align="center">{L_MORE_INFO}</th>
+		</tr>
+		<tr>
+			<td class="row1" colspan="2"><div class="gen" style="overflow: auto; width: 100%; height: 80pt; border: 1px;">{REPORT_TEXT}</div></td>
+		</tr>
+	<!-- ENDIF -->
+	<tr>
+		<td class="cat" align="center" colspan="2"><!-- IF S_POST_REPORTED --><input class="btnmain" type="submit" value="{L_CLOSE_REPORT}" name="action[close]" /><!-- ELSE -->{L_REPORT_CLOSED}<!-- ENDIF --> &nbsp; <input class="btnlite" type="submit" value="{L_DELETE_REPORT}" name="action[delete]" /></td>
+	</tr>
+	</table>
+
+	<input type="hidden" name="report_id_list[]" value="{REPORT_ID}" />
+	{S_FORM_TOKEN}
+	</form>
+
+	<br clear="all"/>
+<!-- ENDIF -->
+
+<!-- IF S_MCP_QUEUE --><form method="post" name="mcp_approve" action="{U_APPROVE_ACTION}"><!-- ELSE --><form method="post" name="mcp_report_details" action="{S_CLOSE_ACTION}"><!-- ENDIF -->
+
+<table width="100%" cellpadding="3" cellspacing="1" border="0" class="tablebg">
+<tr>
+	<th colspan="2" align="center"><!-- IF S_PM -->{L_PM}<!-- ELSE -->{L_POST_DETAILS}<!-- ENDIF --></th>
+</tr>
+<tr>
+	<td class="row3" colspan="2" align="center"><span class="gensmall"><!-- IF S_MCP_QUEUE -->{RETURN_QUEUE} | {RETURN_TOPIC_SIMPLE} | {RETURN_POST}<!-- ELSEIF S_MCP_REPORT -->{RETURN_REPORTS}<!-- IF not S_PM --> | <a href="{U_VIEW_POST}">{L_VIEW_POST}</a> | <a href="{U_VIEW_TOPIC}">{L_VIEW_TOPIC}</a> | <a href="{U_VIEW_FORUM}">{L_VIEW_FORUM}</a><!-- ENDIF --><!-- ELSE -->{RETURN_TOPIC}<!-- ENDIF --></span></td>
+</tr>
+<tr>
+	<td class="row1"><b class="gen"><!-- IF S_PM -->{L_PM_SUBJECT}<!-- ELSE -->{L_POST_SUBJECT}<!-- ENDIF -->: </b></td>
+	<td class="row2"><span class="gen">{POST_SUBJECT}</span> <!-- IF S_POST_UNAPPROVED --><span class="postapprove">{UNAPPROVED_IMG} <a href="{U_MCP_APPROVE}">{L_POST_UNAPPROVED}</a></span> <!-- ENDIF --> <!-- IF S_POST_REPORTED and not S_MCP_REPORT --><span class="postreported">{REPORTED_IMG} <a href="{U_MCP_REPORT}">{L_POST_REPORTED}</a></span><!-- ENDIF --></td>
+</tr>
+<tr>
+	<td class="row1" width="20%"><b class="gen"><!-- IF S_PM -->{L_PM_FROM}<!-- ELSE -->{L_POSTER}<!-- ENDIF -->: </b></td>
+	<td class="row2" width="80%"><span class="gen"<!-- IF POST_AUTHOR_COLOUR --> style="font-weight: bold; color: {POST_AUTHOR_COLOUR}"<!-- ENDIF -->>{POST_AUTHOR}</span><span class="gen"> &nbsp; [ <!-- IF U_POST_AUTHOR --><a href="{U_POST_AUTHOR}">{L_READ_PROFILE}</a><!-- ENDIF --><!-- IF S_USER_NOTES --><!-- IF U_POST_AUTHOR --> | <!-- ENDIF --><a href="{U_MCP_USER_NOTES}">{L_VIEW_NOTES}</a> <!-- IF U_MCP_WARN_USER -->| <a href="{U_MCP_WARN_USER}">{L_WARN_USER}</a><!-- ENDIF --><!-- ENDIF --> ]</span></td>
+</tr>
+<!-- IF S_CAN_VIEWIP -->
+	<tr>
+		<td class="row1"><b class="gen"><!-- IF S_PM -->{L_THIS_PM_IP}<!-- ELSE -->{L_THIS_POST_IP}<!-- ENDIF -->: </b></td>
+		<td class="row2"><span class="gen">
+			<!-- IF U_WHOIS -->
+				<a href="{U_WHOIS}"><!-- IF POST_IPADDR -->{POST_IPADDR}<!-- ELSE -->{POST_IP}<!-- ENDIF --></a> (<!-- IF POST_IPADDR -->{POST_IP}<!-- ELSE --><a href="{U_LOOKUP_IP}">{L_LOOKUP_IP}</a><!-- ENDIF -->)
+			<!-- ELSE -->
+				<!-- IF POST_IPADDR -->{POST_IPADDR} ({POST_IP})<!-- ELSE -->{POST_IP}<!-- IF U_LOOKUP_IP --> (<a href="{U_LOOKUP_IP}">{L_LOOKUP_IP}</a>)<!-- ENDIF --><!-- ENDIF -->
+			<!-- ENDIF -->
+		</span></td>
+	</tr>
+<!-- ENDIF -->
+<tr>
+	<td class="row1"><b class="gen"><!-- IF S_PM -->{L_SENT_AT}<!-- ELSE -->{L_POSTED}<!-- ENDIF -->: </b></td>
+	<td class="row2"><span class="postdetails">{POST_DATE}</span></td>
+</tr>
+<!-- IF S_TO_RECIPIENT -->
+	<tr>
+		<td class="row1" nowrap="nowrap" width="150"><b class="gen">{L_TO}:</b></td>
+		<td class="row2 gen">
+		<!-- BEGIN to_recipient -->
+			<!-- IF to_recipient.IS_GROUP --><span class="sep"><a href="{to_recipient.U_VIEW}">{to_recipient.NAME}</a></span><!-- ELSE -->{to_recipient.NAME_FULL}&nbsp;<!-- ENDIF -->
+		<!-- END to_recipient -->
+		</td>
+	</tr>
+<!-- ENDIF -->
+
+<!-- IF S_BCC_RECIPIENT -->
+	<tr>
+		<td class="row1" nowrap="nowrap" width="150"><b class="gen">{L_BCC}:</b></td>
+		<td class="row2 gen">
+		<!-- BEGIN bcc_recipient -->
+			<!-- IF bcc_recipient.IS_GROUP --><span class="sep"><a href="{bcc_recipient.U_VIEW}">{bcc_recipient.NAME}</a></span><!-- ELSE -->{bcc_recipient.NAME_FULL}&nbsp;<!-- ENDIF -->
+		<!-- END bcc_recipient -->
+		</td>
+	</tr>
+<!-- ENDIF -->
+<tr>
+	<th colspan="2" align="center">{L_PREVIEW}</th>
+</tr>
+<tr>
+	<td class="row1" colspan="2">
+	<!-- IF U_EDIT --><div class="gen" style="float: {S_CONTENT_FLOW_END};"><a href="{U_EDIT}">{EDIT_IMG}</a></div><!-- ENDIF -->
+
+	<div class="postbody">{POST_PREVIEW}</div>
+
+	<!-- IF S_HAS_ATTACHMENTS -->
+		<br clear="all" /><br />
+
+		<table class="tablebg" width="100%" cellspacing="1">
+		<tr>
+			<td class="row3"><b class="genmed">{L_ATTACHMENTS}: </b></td>
+		</tr>
+		<!-- BEGIN attachment -->
+			<tr>
+				<!-- IF attachment.S_ROW_COUNT is even --><td class="row2"><!-- ELSE --><td class="row1"><!-- ENDIF -->{attachment.DISPLAY_ATTACHMENT}</td>
+			</tr>
+		<!-- END attachment -->
+		</table>
+	<!-- ENDIF -->
+
+	</td>
+</tr>
+<!-- IF S_POST_UNAPPROVED and S_MCP_QUEUE -->
+	<tr>
+		<td class="cat" align="center" colspan="2"><input class="btnmain" type="submit" value="{L_APPROVE}" name="action[approve]" /> &nbsp; <input class="btnlite" type="submit" value="{L_DISAPPROVE}" name="action[disapprove]" /></td>
+	</tr>
+	<input type="hidden" name="post_id_list[]" value="{POST_ID}" />
+<!-- ENDIF -->
+</table>
+{S_FORM_TOKEN}
+</form>
+
+<!-- IF S_MCP_QUEUE -->
+	<br clear="all" />
+
+	<!-- IF S_TOPIC_REVIEW --><!-- INCLUDE posting_topic_review.html --><!-- ENDIF -->
+<!-- ELSEIF S_MCP_REPORT -->
+	<br clear="all" />
+
+	<!-- IF S_TOPIC_REVIEW --><!-- INCLUDE posting_topic_review.html --><!-- ENDIF -->
+<!-- ELSE -->
+	<!-- IF S_CAN_LOCK_POST or S_CAN_DELETE_POST or S_CAN_CHGPOSTER -->
+		<br /><a name="mod"></a>
+
+		<table width="100%" cellpadding="3" cellspacing="1" border="0" class="tablebg">
+		<tr>
+			<th colspan="2" align="center">{L_MOD_OPTIONS}</th>
+		</tr>
+		<!-- IF S_CAN_CHGPOSTER -->
+			<tr>
+				<td class="row1" valign="top"><b class="gen">{L_CHANGE_POSTER}</b></td>
+				<td class="row2"><form method="post" name="mcp_chgposter" action="{U_POST_ACTION}"><input class="post" type="text" name="username" value="" /> <input class="btnmain" type="submit" value="{L_CONFIRM}" name="action[chgposter]" /><br /><span class="gensmall">[ <a href="{U_FIND_USERNAME}" onclick="find_username(this.href); return false;">{L_FIND_USERNAME}</a> ]</span><!-- IF S_USER_SELECT --><br /><select name="u">{S_USER_SELECT}</select> <input type="submit" class="btnmain" name="action[chgposter_ip]" value="{L_CONFIRM}" /><!-- ENDIF -->{S_FORM_TOKEN}</form></td>
+			</tr>
+		<!-- ENDIF -->
+		<!-- IF S_CAN_LOCK_POST or S_CAN_DELETE_POST -->
+			<tr>
+				<td class="row1" valign="top"><b class="gen">{L_MOD_OPTIONS}</b></td>
+				<td class="row2"><form method="post" name="mcp" action="{U_MCP_ACTION}"><select name="action"><!-- IF S_CAN_LOCK_POST --><!-- IF S_POST_LOCKED --><option value="unlock_post">{L_UNLOCK_POST} [{L_UNLOCK_POST_EXPLAIN}]</option><!-- ELSE --><option value="lock_post">{L_LOCK_POST} [{L_LOCK_POST_EXPLAIN}]</option><!-- ENDIF --><!-- ENDIF --><!-- IF S_CAN_DELETE_POST --><option value="delete_post">{L_DELETE_POST}</option><!-- ENDIF --></select> <input class="btnmain" type="submit" value="{L_SUBMIT}" />	{S_FORM_TOKEN}</form></td>
+			</tr>
+		<!-- ENDIF -->
+		</table>
+	<!-- ENDIF -->
+
+	<!-- IF S_CAN_VIEWIP -->
+		<br /><a name="ip"></a>
+
+		<table width="100%" cellpadding="3" cellspacing="1" border="0" class="tablebg">
+		<tr>
+			<th colspan="2" align="center">{L_IP_INFO}</th>
+		</tr>
+		<tr>
+			<td colspan="2" class="cat"><b class="gen">{L_OTHER_USERS}</b></td>
+		</tr>
+		<!-- BEGIN userrow -->
+			<!-- IF userrow.S_ROW_COUNT is even --><tr class="row1"><!-- ELSE --><tr class="row2"><!-- ENDIF -->
+				<td><span class="gen"><!-- IF userrow.U_PROFILE --><a href="{userrow.U_PROFILE}">{userrow.USERNAME}</a><!-- ELSE -->{userrow.USERNAME}<!-- ENDIF --> [ {userrow.NUM_POSTS} {userrow.L_POST_S} ]</span></td>
+				<td align="center"><a href="{userrow.U_SEARCHPOSTS}">{SEARCH_IMG}</a></td>
+			</tr>
+		<!-- BEGINELSE -->
+			<tr class="row1">
+				<td colspan="2" align="center"><span class="gen">{L_NO_MATCHES_FOUND}</span></td>
+			</tr>
+		<!-- END userrow -->
+		<tr>
+			<td class="cat"><b class="gen">{L_IPS_POSTED_FROM}</b></td>
+			<td class="cat" width="10%" nowrap="nowrap"><!-- IF U_LOOKUP_ALL --><span class="gen">[ <a href="{U_LOOKUP_ALL}">{L_LOOKUP_ALL}</a> ]</span><!-- ENDIF --></td>
+		</tr>
+		<!-- BEGIN iprow -->
+			<!-- IF iprow.S_ROW_COUNT is even -->
+				<tr class="row1">
+			<!-- ELSE -->
+				<tr class="row2">
+			<!-- ENDIF -->
+				<td><span class="gen"><!-- IF iprow.HOSTNAME --><a href="{iprow.U_WHOIS}">{iprow.HOSTNAME}</a> ({iprow.IP})<!-- ELSE --><a href="{iprow.U_WHOIS}">{iprow.IP}</a><!-- ENDIF --> [ {iprow.NUM_POSTS} {iprow.L_POST_S} ]</span></td>
+				<td align="center"><!-- IF iprow.U_LOOKUP_IP --><span class="gen">[ <a href="{iprow.U_LOOKUP_IP}">{L_LOOKUP_IP}</a> ]</span><!-- ENDIF --></td>
+			</tr>
+		<!-- BEGINELSE -->
+			<tr class="row1">
+				<td colspan="2" align="center"><span class="gen">{L_NO_MATCHES_FOUND}</span></td>
+			</tr>
+		<!-- END iprow -->
+		</table>
+	<!-- ENDIF -->
+
+<!-- ENDIF -->
+
+<!-- INCLUDE mcp_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/mcp_queue.html phpbb/styles/spring/template/mcp_queue.html
--- phpBB-3.0.10/styles/spring/template/mcp_queue.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/mcp_queue.html	2014-04-15 14:31:18.699429005 +0200
@@ -0,0 +1,46 @@
+<!-- INCLUDE mcp_header.html -->
+
+<form name="mcp" id="mcp" method="post" action="{S_MCP_ACTION}">
+
+<table width="100%" class="tablebg" cellspacing="1" cellpadding="4" border="0">
+<tr>
+	<th colspan="4" nowrap="nowrap">{L_DISPLAY_OPTIONS}</th>
+</tr>
+<tr>
+	<td colspan="4" class="cat" align="center"><span class="gensmall">{L_DISPLAY_ITEMS}:</span> {S_SELECT_SORT_DAYS}&nbsp;<span class="gensmall">{L_SORT_BY}</span> {S_SELECT_SORT_KEY} {S_SELECT_SORT_DIR}&nbsp;<span class="gensmall">{L_FORUM}</span> <select name="f">{S_FORUM_OPTIONS}</select> &nbsp; <!-- IF TOPIC_ID --><input type="checkbox" class="radio" name="t" value="{TOPIC_ID}" checked="checked" />&nbsp; <b>{L_ONLY_TOPIC}</b> &nbsp; <!-- ENDIF --><input class="btnlite" type="submit" name="sort" value="{L_GO}" /></td>
+</tr>
+<tr> 
+	<th>&nbsp;<!-- IF S_TOPICS -->{L_TOPIC}<!-- ELSE -->{L_POST}<!-- ENDIF -->&nbsp;</th>
+	<th>&nbsp;{L_AUTHOR}&nbsp;</th>
+	<th>&nbsp;{L_POST_TIME}&nbsp;</th>
+	<th width="5%">&nbsp;{L_SELECT}&nbsp;</th>
+</tr>
+<!-- BEGIN postrow -->
+
+	<!-- IF postrow.S_ROW_COUNT is even --><tr class="row1"><!-- ELSE --><tr class="row2"><!-- ENDIF -->
+		<td style="padding: 4px;"><p class="topictitle"><a href="{postrow.U_VIEWPOST}">{postrow.POST_SUBJECT}</a></p>
+			<span class="gensmall"><!-- IF postrow.U_VIEWFORUM -->{L_FORUM}: <a href="{postrow.U_VIEWFORUM}">{postrow.FORUM_NAME}</a><!-- ELSE -->{postrow.FORUM_NAME}<!-- ENDIF --></span></td>
+		<td style="padding: 4px;" align="{S_CONTENT_FLOW_BEGIN}" valign="top" nowrap="nowrap"><span class="gen">{postrow.POST_AUTHOR_FULL}</span><br />
+			<span class="gensmall">[ <a href="{postrow.U_VIEW_DETAILS}">{L_VIEW_DETAILS}</a> ]</span></td>
+		<td class="postdetails" style="padding: 4px;" align="{S_CONTENT_FLOW_BEGIN}" valign="top" nowrap="nowrap">{postrow.POST_TIME}</td>
+		<td align="center"><input type="checkbox" class="radio" name="post_id_list[]" value="{postrow.POST_ID}" /></td>
+	</tr>
+<!-- BEGINELSE -->
+	<tr>
+		<td class="row1" colspan="4" height="30" align="center" valign="middle"><span class="gen"><!-- IF S_TOPICS -->{L_NO_TOPICS_QUEUE}<!-- ELSE -->{L_UNAPPROVED_POSTS_ZERO_TOTAL}<!-- ENDIF --></span></td>
+	</tr>
+<!-- END postrow -->
+<tr>
+	<td class="cat" colspan="4" align="center"><input class="btnmain" type="submit" name="action[approve]" value="{L_APPROVE}" />&nbsp;&nbsp;<input class="btnlite" type="submit" name="action[disapprove]" value="{L_DISAPPROVE}" /></td>
+</tr>
+</table>
+{S_FORM_TOKEN}
+</form>
+
+<table width="100%" cellspacing="2" cellpadding="2" border="0" align="center">
+<tr>
+	<td align="{S_CONTENT_FLOW_END}" valign="top" nowrap="nowrap"><b class="gensmall"><a href="#" onclick="marklist('mcp', '', true); return false;">{L_MARK_ALL}</a> :: <a href="#" onclick="marklist('mcp', '', false); return false;">{L_UNMARK_ALL}</a></b></td>
+</tr>
+</table>
+
+<!-- INCLUDE mcp_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/mcp_reports.html phpbb/styles/spring/template/mcp_reports.html
--- phpBB-3.0.10/styles/spring/template/mcp_reports.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/mcp_reports.html	2014-04-15 14:31:18.699429005 +0200
@@ -0,0 +1,67 @@
+<!-- INCLUDE mcp_header.html -->
+
+<form name="mcp" id="mcp" method="post" action="{S_MCP_ACTION}">
+
+<table width="100%" class="tablebg" cellspacing="1" cellpadding="4" border="0">
+<tr>
+	<th colspan="5" nowrap="nowrap">{L_DISPLAY_OPTIONS}</th>
+</tr>
+<tr>
+	<td colspan="5" class="cat" align="center"><span class="gensmall">{L_DISPLAY_POSTS}:</span> {S_SELECT_SORT_DAYS}&nbsp;<span class="gensmall">{L_SORT_BY}</span> {S_SELECT_SORT_KEY} {S_SELECT_SORT_DIR}<!-- IF not S_PM -->&nbsp;<span class="gensmall">{L_FORUM}</span> <select name="f">{S_FORUM_OPTIONS}</select> &nbsp; <!-- IF TOPIC_ID --><input type="checkbox" class="radio" name="t" value="{TOPIC_ID}" checked="checked" />&nbsp; <b>{L_ONLY_TOPIC}</b> &nbsp; <!-- ENDIF --><!-- ENDIF --><input class="btnlite" type="submit" name="sort" value="{L_GO}" /></td>
+</tr>
+<tr> 
+	<!-- IF S_PM -->
+	<th>&nbsp;{L_PM}&nbsp;</th>
+	<th>&nbsp;{L_TO} &amp; {L_BCC}&nbsp;</th>
+	<!-- ELSE -->
+	<th>&nbsp;{L_POST}&nbsp;</th>
+	<th>&nbsp;{L_AUTHOR}&nbsp;</th>
+	<!-- ENDIF -->
+	<th>&nbsp;{L_REPORTER}&nbsp;</th>
+	<th>&nbsp;{L_REPORT_TIME}&nbsp;</th>
+	<th width="5%">&nbsp;{L_SELECT}&nbsp;</th>
+</tr>
+<!-- BEGIN postrow -->
+
+	<!-- IF postrow.S_ROW_ is even --><tr class="row1"><!-- ELSE --><tr class="row2"><!-- ENDIF -->
+		<!-- IF S_PM -->
+		<td style="padding: 4px;"><p class="topictitle"><a href="{postrow.U_VIEW_DETAILS}">{postrow.PM_SUBJECT}</a></p>
+			<span class="gensmall">{L_PM_FROM}: {postrow.PM_AUTHOR_FULL}</span></td>
+		<td style="padding: 4px;" align="{S_CONTENT_FLOW_BEGIN}" valign="top"><span class="gen">{postrow.RECIPIENTS}</span><br />
+			<span class="gensmall">{L_SENT_AT}: {postrow.PM_TIME}</span></td>
+		<!-- ELSE -->
+		<td style="padding: 4px;"><p class="topictitle"><a href="{postrow.U_VIEWPOST}">{postrow.POST_SUBJECT}</a></p>
+			<span class="gensmall"><!-- IF postrow.U_VIEWFORUM -->{L_FORUM}: <a href="{postrow.U_VIEWFORUM}">{postrow.FORUM_NAME}</a><!-- ELSE -->{postrow.FORUM_NAME}<!-- ENDIF --></span></td>
+		<td style="padding: 4px;" align="{S_CONTENT_FLOW_BEGIN}" valign="top" nowrap="nowrap"><span class="gen">{postrow.POST_AUTHOR_FULL}</span><br />
+			<span class="gensmall">{postrow.POST_TIME}</span></td>
+		<!-- ENDIF -->
+		<td style="padding: 4px;" align="{S_CONTENT_FLOW_BEGIN}" valign="top" nowrap="nowrap"><span class="gen">{postrow.REPORTER_FULL}</span></td>
+		<td style="padding: 4px;" align="{S_CONTENT_FLOW_BEGIN}" valign="top" nowrap="nowrap"><span class="gen">{postrow.REPORT_TIME}</span><br />
+			<span class="gensmall">[ <a href="{postrow.U_VIEW_DETAILS}">{L_VIEW_DETAILS}</a> ]</span></td>
+		<td align="center"><input type="checkbox" class="radio" name="report_id_list[]" value="{postrow.REPORT_ID}" /></td>
+	</tr>
+<!-- BEGINELSE -->
+	<tr>
+		<td class="row1" colspan="5" height="30" align="center" valign="middle"><span class="gen">{L_NO_POSTS}</span></td>
+	</tr>
+<!-- END postrow -->
+<tr>
+	<td class="cat" colspan="5" align="center">
+	<!-- IF S_CLOSED -->
+		<input class="btnmain" type="submit" value="{L_DELETE_REPORTS}" name="action[delete]" />
+	<!-- ELSE -->
+		<input class="btnmain" type="submit" name="action[close]" value="{L_CLOSE_REPORTS}" /> &nbsp; <input class="btnlite" type="submit" value="{L_DELETE_REPORTS}" name="action[delete]" />
+	<!-- ENDIF -->
+	</td>
+</tr>
+</table>
+{S_FORM_TOKEN}
+</form>
+
+<table width="100%" cellspacing="2" cellpadding="2" border="0" align="center">
+<tr>
+	<td align="{S_CONTENT_FLOW_END}" valign="top" nowrap="nowrap"><b class="gensmall"><a href="#" onclick="marklist('mcp', '', true); return false;">{L_MARK_ALL}</a> :: <a href="#" onclick="marklist('mcp', '', false); return false;">{L_UNMARK_ALL}</a></b></td>
+</tr>
+</table>
+
+<!-- INCLUDE mcp_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/mcp_topic.html phpbb/styles/spring/template/mcp_topic.html
--- phpBB-3.0.10/styles/spring/template/mcp_topic.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/mcp_topic.html	2014-04-15 14:31:18.700429005 +0200
@@ -0,0 +1,151 @@
+<!-- INCLUDE mcp_header.html -->
+
+<form name="mcp" id="mcp" method="post" action="{S_MCP_ACTION}">
+
+<table class="tablebg" width="100%" cellspacing="1">
+<!-- IF S_CAN_SPLIT -->
+	<tr>
+		<th colspan="3" nowrap="nowrap">{L_SPLIT_TOPIC}</th>
+	</tr>
+	<tr>
+		<td class="row2" colspan="3" align="center"><span class="gensmall">{L_SPLIT_TOPIC_EXPLAIN}</span></td>
+	</tr>
+	<tr>
+		<td class="row1" nowrap="nowrap"><span class="gen">{L_SPLIT_SUBJECT}</span></td>
+		<td class="row2" colspan="2"><input class="post" style="width: 350px" type="text" size="35" maxlength="64" name="subject" value="{SPLIT_SUBJECT}" /></td>
+	</tr>
+	<tr>
+		<td class="row1" nowrap="nowrap"><span class="gen">{L_SPLIT_FORUM}</span></td>
+		<td class="row2" colspan="2"><select name="to_forum_id">{S_FORUM_SELECT}</select></td>
+	</tr>
+
+	<!-- IF S_SHOW_TOPIC_ICONS -->
+		<tr>
+			<td class="row1"><span class="gen">{L_TOPIC_ICON}</span></td>
+			<td class="row2" colspan="2">
+				<table width="100%" cellspacing="0" cellpadding="0" border="0">
+				<tr>
+					<td><span class="genmed nowrap"><input type="radio" class="radio" name="icon" value="0"<!-- IF not S_TOPIC_ICON --> checked="checked"<!-- ENDIF --> />{L_NO_TOPIC_ICON}</span> <!-- BEGIN topic_icon --><span class="nowrap"><input type="radio" class="radio" name="icon" value="{topic_icon.ICON_ID}"<!-- IF topic_icon.S_CHECKED --> checked="checked"<!-- ENDIF --> /><img src="{topic_icon.ICON_IMG}" width="{topic_icon.ICON_WIDTH}" height="{topic_icon.ICON_HEIGHT}" alt="" title="" hspace="2" vspace="2" /></span> <!-- END topic_icon --></td>
+				</tr>
+				</table>
+			</td>
+		</tr>
+	<!-- ENDIF -->
+<!-- ENDIF -->
+
+<!-- IF S_CAN_MERGE -->
+	<tr>
+		<th colspan="3" nowrap="nowrap">{L_MERGE_POSTS}</th>
+	</tr>
+	<tr>
+		<td class="row2" colspan="3" align="center"><span class="gensmall">{L_MERGE_TOPIC_EXPLAIN}</span></td>
+	</tr>
+	<tr>
+		<td class="row1" nowrap="nowrap"><span class="gen">{L_MERGE_TOPIC_ID}</span></td>
+		<td class="row2" colspan="2"><input class="post" type="text" size="6" name="to_topic_id" value="{TO_TOPIC_ID}" /> <a href="{U_SELECT_TOPIC}">{L_SELECT_TOPIC}</a></td>
+	</tr>
+	<!-- IF TO_TOPIC_INFO -->
+		<tr>
+			<td class="row3" colspan="3" align="center"><b class="gen">{TO_TOPIC_INFO}</b></td>
+		</tr>
+	<!-- ENDIF -->
+<!-- ENDIF -->
+<tr>
+	<th colspan="3" nowrap="nowrap">{L_DISPLAY_OPTIONS}</th>
+</tr>
+<tr>
+	<td class="row1" nowrap="nowrap"><span class="gen">{L_POSTS_PER_PAGE}</span><br /><span class="gensmall">{L_POSTS_PER_PAGE_EXPLAIN}</span></td>
+	<td class="row2" colspan="2"><input class="post" type="text" name="posts_per_page" size="6" value="{POSTS_PER_PAGE}" /></td>
+</tr>
+<tr>
+	<td class="cat" colspan="3" align="center"><span class="gensmall">{L_DISPLAY_POSTS}:</span> {S_SELECT_SORT_DAYS}&nbsp;<span class="gensmall">{L_SORT_BY}</span> {S_SELECT_SORT_KEY} {S_SELECT_SORT_DIR}&nbsp;<input class="btnlite" type="submit" name="sort" value="{L_GO}" /></td>
+</tr>
+<tr>
+	<th nowrap="nowrap" colspan="3">{L_TOPIC_REVIEW}: {TOPIC_TITLE}</th>
+</tr>
+<tr>
+	<td class="row3" colspan="3" align="center"><span class="gensmall">{RETURN_TOPIC}</span></td>
+</tr>
+<!-- BEGIN postrow -->
+
+	<!-- IF postrow.S_ROW_COUNT is even --><tr class="row1"><!-- ELSE --><tr class="row2"><!-- ENDIF -->
+
+		<td align="center"><b class="postauthor">{postrow.POST_AUTHOR_FULL}</b></td>
+		<td width="100%">
+			<table width="100%" cellspacing="0" cellpadding="0" border="0">
+			<tr valign="top">
+				<td class="gensmall" nowrap="nowrap">&nbsp;<b>{L_POST_SUBJECT}:</b>&nbsp;</td>
+				<td class="gensmall" width="100%">{postrow.POST_SUBJECT}</td>
+			</tr>
+			</table>
+		</td>
+		<td width="5%" align="center"><a href="{postrow.U_POST_DETAILS}">{INFO_IMG}</a></td>
+	</tr>
+
+	<!-- IF postrow.S_ROW_COUNT is even --><tr class="row1"><!-- ELSE --><tr class="row2"><!-- ENDIF -->
+
+		<td width="100%" valign="top" colspan="2">
+			<table width="100%" cellspacing="0" cellpadding="2" border="0">
+			<tr>
+				<td valign="top">
+					<div class="postbody">{postrow.MESSAGE}</div>
+					<!-- IF postrow.S_HAS_ATTACHMENTS -->
+						<br clear="all" /><br />
+
+						<table class="tablebg" width="100%" cellspacing="1">
+						<tr>
+							<td class="row3"><b class="genmed">{L_ATTACHMENTS}: </b></td>
+						</tr>
+						<!-- BEGIN attachment -->
+							<tr>
+								<!-- IF postrow.attachment.S_ROW_COUNT is even --><td class="row2"><!-- ELSE --><td class="row1"><!-- ENDIF -->{postrow.attachment.DISPLAY_ATTACHMENT}</td>
+							</tr>
+						<!-- END attachment -->
+						</table>
+					<!-- ENDIF -->
+
+				</td>
+			</tr>
+			<tr>
+				<td valign="bottom">
+					<table width="100%" cellspacing="0" cellpadding="0" border="0">
+					<tr valign="middle">
+						<td width="100%">
+							<!-- IF postrow.S_POST_UNAPPROVED and postrow.U_MCP_APPROVE --><span class="postapprove">{UNAPPROVED_IMG} <a href="{postrow.U_MCP_APPROVE}">{L_POST_UNAPPROVED}</a></span><br /><!-- ENDIF -->
+							<!-- IF postrow.S_POST_REPORTED and postrow.U_MCP_REPORT --><span class="postreported">{REPORTED_IMG} <a href="{postrow.U_MCP_REPORT}">{L_POST_REPORTED}</a></span><!-- ENDIF -->
+						</td>
+						<td width="10" nowrap="nowrap">{postrow.MINI_POST_IMG}</td>
+						<td class="gensmall" nowrap="nowrap"><b>{L_POSTED}:</b> {postrow.POST_DATE}</td>
+					</tr>
+					</table>
+				</td>
+			</tr>
+			</table>
+		</td>
+		<td width="5%" align="center"><input type="checkbox" class="radio" name="post_id_list[]" value="{postrow.POST_ID}"<!-- IF postrow.S_CHECKED --> checked="checked"<!-- ENDIF --> /></td>
+	</tr>
+	<tr>
+		<td class="row3" colspan="3" height="1"><img src="images/spacer.gif" width="1" height="1" alt="" /></td>
+	</tr>
+<!-- END postrow -->
+<tr>
+	<td class="cat" colspan="3" align="center"><select name="action"><option value="" selected="selected">{L_SELECT_ACTION}</option>
+		<!-- IF S_CAN_APPROVE --><option value="approve">{L_APPROVE_POSTS}</option><!-- ENDIF -->
+		<!-- IF S_CAN_LOCK --><option value="lock_post">{L_LOCK_POST_POSTS} [ {L_LOCK_POST_EXPLAIN} ]</option><option value="unlock_post">{L_UNLOCK_POST_POSTS}</option><!-- ENDIF -->
+		<!-- IF S_CAN_DELETE --><option value="delete_post">{L_DELETE_POSTS}</option><!-- ENDIF -->
+		<!-- IF S_CAN_MERGE --><option value="merge_posts"<!-- IF ACTION eq 'merge' --> selected="selected"<!-- ENDIF -->>{L_MERGE_POSTS}</option><!-- ENDIF -->
+		<!-- IF S_CAN_SPLIT --><option value="split_all"<!-- IF ACTION eq 'split' --> selected="selected"<!-- ENDIF -->>{L_SPLIT_POSTS}</option><option value="split_beyond">{L_SPLIT_AFTER}</option><!-- ENDIF -->
+	</select>&nbsp;<input class="btnmain" type="submit" name="mcp_topic_submit" value="{L_SUBMIT}" /></td>
+</tr>
+</table>
+{S_HIDDEN_FIELDS}
+{S_FORM_TOKEN}
+</form>
+
+<table width="100%" cellspacing="2" cellpadding="2" border="0" align="center">
+<tr>
+	<td align="{S_CONTENT_FLOW_END}" valign="top" nowrap="nowrap"><b class="gensmall"><a href="#" onclick="marklist('mcp', '', true); return false;">{L_MARK_ALL}</a> :: <a href="#" onclick="marklist('mcp', '', false); return false;">{L_UNMARK_ALL}</a></b></td>
+</tr>
+</table>
+
+<!-- INCLUDE mcp_footer.html -->
diff -ruN phpBB-3.0.10/styles/spring/template/mcp_viewlogs.html phpbb/styles/spring/template/mcp_viewlogs.html
--- phpBB-3.0.10/styles/spring/template/mcp_viewlogs.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/mcp_viewlogs.html	2014-04-15 14:31:18.701429005 +0200
@@ -0,0 +1,52 @@
+<!-- INCLUDE mcp_header.html -->
+
+<form method="post" name="mcp" action="{S_MCP_ACTION}">
+
+<table class="tablebg" width="100%" cellspacing="1" cellpadding="2" border="0">
+<tr>
+	<th colspan="<!-- IF S_TOPIC_ID -->4<!-- ELSE -->5<!-- ENDIF -->" nowrap="nowrap">{L_DISPLAY_OPTIONS}</th>
+</tr>
+<tr>
+	<td colspan="<!-- IF S_TOPIC_ID -->4<!-- ELSE -->5<!-- ENDIF -->" class="cat" align="center"><span class="gensmall">{L_DISPLAY_LOG}:</span> {S_SELECT_SORT_DAYS}&nbsp;<span class="gensmall">{L_SORT_BY}</span> {S_SELECT_SORT_KEY} {S_SELECT_SORT_DIR}&nbsp;<input class="btnlite" type="submit" name="sort" value="{L_GO}" /></span></td>
+</tr>
+<tr>
+	<th width="15%" nowrap="nowrap">{L_USERNAME}</th>
+	<th width="12%" nowrap="nowrap">{L_IP}</th>
+	<th width="18%" nowrap="nowrap">{L_TIME}</th>
+	<th width="45%" nowrap="nowrap">{L_ACTION}</th>
+	<!-- IF not S_TOPIC_ID -->
+		<th width="8%" nowrap="nowrap"></th>
+	<!-- ENDIF -->
+</tr>
+<!-- IF S_TOPIC_ID -->
+	<tr>
+		<td class="row3" colspan="5"><span class="gensmall">{L_LOGS_CURRENT_TOPIC} <a href="{U_VIEW_TOPIC}"><b>{TOPIC_NAME}</b></a></span></td>
+	</tr>
+<!-- ENDIF -->
+<!-- BEGIN log -->
+	<tr>
+		<td class="row1" nowrap="nowrap"><span class="gen">{log.USERNAME}</span></td>
+		<td class="row1" align="center" nowrap="nowrap"><span class="gen">{log.IP}</span></td>
+		<td class="row1" align="center" nowrap="nowrap"><span class="gensmall">{log.TIME}</span></td>
+		<td class="row1"><span class="gen">{log.ACTION}</span></td>
+		<!-- IF not S_TOPIC_ID -->
+		<td class="row1" align="center" nowrap="nowrap"><span class="gensmall"><!-- IF log.U_VIEW_TOPIC --><a href="{log.U_VIEW_TOPIC}">{L_VIEW_TOPIC}</a><!-- IF log.U_VIEWLOGS --> | <!-- ENDIF --><!-- ENDIF --><!-- IF log.U_VIEWLOGS --><a href="{log.U_VIEWLOGS}">{L_VIEW_TOPIC_LOGS}</a><!-- ENDIF --></span></td>
+		<!-- ENDIF -->
+	</tr>
+<!-- BEGINELSE -->
+	<tr>
+		<td class="row1" colspan="<!-- IF S_TOPIC_ID -->4<!-- ELSE -->5<!-- ENDIF -->" align="center"><span class="gen">{L_NO_ENTRIES}</span></td>
+	</tr>
+<!-- END log -->
+</table>
+{S_FORM_TOKEN}
+</form>
+
+<table width="100%" cellspacing="2" cellpadding="2" border="0" align="center">
+<tr>
+	<td class="nav" align="{S_CONTENT_FLOW_BEGIN}" valign="middle">{PAGE_NUMBER}</td>
+	<td align="{S_CONTENT_FLOW_END}" valign="top" nowrap="nowrap"><!-- INCLUDE pagination.html --></td>
+</tr>
+</table>
+
+<!-- INCLUDE mcp_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/mcp_warn_front.html phpbb/styles/spring/template/mcp_warn_front.html
--- phpBB-3.0.10/styles/spring/template/mcp_warn_front.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/mcp_warn_front.html	2014-04-15 14:31:18.702429005 +0200
@@ -0,0 +1,74 @@
+<!-- INCLUDE mcp_header.html -->
+
+<form method="post" name="mcp" action="{U_POST_ACTION}">
+
+<table class="tablebg" width="100%" cellspacing="1" border="0" align="center">
+<tr>
+	<th colspan="2"align="center">{L_SELECT_USER}</th>
+</tr>
+<tr>
+	<td class="row1" width="40%"><b class="gen">{L_FIND_USERNAME}: </b><br /><span class="gensmall">[ <a href="{U_FIND_USERNAME}" onclick="find_username(this.href); return false;">{L_FIND_USERNAME}</a> ]</span></td>
+	<td class="row2"><input type="text" class="post" name="username" size="20" /></td>
+</tr>
+<tr>
+	<td class="cat" colspan="2" align="center"><input type="submit" name="submituser" value="{L_SUBMIT}" class="btnmain" /></td>
+</tr>
+</table>
+{S_FORM_TOKEN}
+</form>
+
+<br clear="all" /><br />
+
+<table class="tablebg" width="100%" cellspacing="1">
+<tr>
+	<td class="row3" colspan="4" align="center"><b class="gen">{L_MOST_WARNINGS}</b></td>
+</tr>
+<tr>
+	<th>&nbsp;{L_USERNAME}&nbsp;</th>
+	<th>&nbsp;{L_WARNINGS}&nbsp;</th>
+	<th>&nbsp;{L_LATEST_WARNING_TIME}&nbsp;</th>
+	<th>&nbsp;</th>
+</tr>
+<!-- BEGIN highest -->
+	<tr>
+		<td class="row1" width="15%" valign="top"><span class="gen">{highest.USERNAME_FULL}</span></td>
+		<td class="row2" width="15%" valign="top"><span class="gen">{highest.WARNINGS}</span></td>
+		<td class="row1" width="15%" valign="top"><span class="gen">{highest.WARNING_TIME}</span></td>
+		<td class="row2" width="15%" valign="top"><span class="gen"><a href="{highest.U_NOTES}">{L_VIEW_NOTES}</a></span></td>
+	</tr>
+<!-- BEGINELSE -->
+	<tr>
+		<td class="row1" colspan="4" align="center"><span class="gen">{L_WARNINGS_ZERO_TOTAL}</span></td>
+	</tr>
+<!-- END highest -->
+</table>
+
+<br clear="all" /><br />
+
+<table class="tablebg" width="100%" cellspacing="1">
+<tr>
+	<td class="row3" colspan="4" align="center"><b class="gen">{L_LATEST_WARNINGS}</b></td>
+</tr>
+<tr>
+	<th>&nbsp;{L_USERNAME}&nbsp;</th>
+	<th>&nbsp;{L_TIME}&nbsp;</th>
+	<th>&nbsp;{L_TOTAL_WARNINGS}&nbsp;</th>
+	<th>&nbsp;</th>
+</tr>
+<!-- BEGIN latest -->
+	<tr>
+		<td class="row1" width="15%" valign="top"><span class="gen">{latest.USERNAME_FULL}</span></td>
+		<td class="row2" width="15%" valign="top"><span class="gen">{latest.WARNING_TIME}</span></td>
+		<td class="row1" width="15%" valign="top"><span class="gen">{latest.WARNINGS}</span></td>
+		<td class="row2" width="15%" valign="top"><span class="gen"><a href="{latest.U_NOTES}">{L_VIEW_NOTES}</a></span></td>
+	</tr>
+<!-- BEGINELSE -->
+	<tr>
+		<td class="row1" colspan="4" align="center"><span class="gen">{L_WARNINGS_ZERO_TOTAL}</span></td>
+	</tr>
+<!-- END latest -->
+</table>
+
+<br clear="all" /><br />
+
+<!-- INCLUDE mcp_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/mcp_warn_list.html phpbb/styles/spring/template/mcp_warn_list.html
--- phpBB-3.0.10/styles/spring/template/mcp_warn_list.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/mcp_warn_list.html	2014-04-15 14:31:18.702429005 +0200
@@ -0,0 +1,43 @@
+<!-- INCLUDE mcp_header.html -->
+
+<form method="post" name="mcp" action="{U_POST_ACTION}">
+
+<table class="tablebg" width="100%" cellspacing="1">
+<tr>
+	<td class="row3" colspan="4" align="center"><b class="gen">{L_WARNED_USERS}</b></td>
+</tr>
+<tr>
+	<th>&nbsp;{L_USERNAME}&nbsp;</th>
+	<th>&nbsp;{L_WARNINGS}&nbsp;</th>
+	<th>&nbsp;{L_LATEST_WARNING_TIME}&nbsp;</th>
+	<th>&nbsp;</th>
+</tr>
+<!-- BEGIN user -->
+	<tr>
+		<td class="row1" width="15%" valign="top"><span class="gen">{user.USERNAME_FULL}</span></td>
+		<td class="row2" width="15%" valign="top"><span class="gen">{user.WARNINGS}</span></td>
+		<td class="row1" width="15%" valign="top"><span class="gen">{user.WARNING_TIME}</span></td>
+		<td class="row2" width="15%" valign="top"><span class="gen"><a href="{user.U_NOTES}">{L_VIEW_NOTES}</a></span></td>
+	</tr>
+<!-- BEGINELSE -->
+	<tr>
+		<td class="row1" colspan="4" align="center"><span class="gen">{L_WARNINGS_ZERO_TOTAL}</span></td>
+	</tr>
+<!-- END user -->
+<tr align="center">
+	<td class="row3" colspan="4"><span class="gensmall">{L_DISPLAY_POSTS}:</span> {S_SELECT_SORT_DAYS}&nbsp;<span class="gensmall">{L_SORT_BY}</span> {S_SELECT_SORT_KEY} {S_SELECT_SORT_DIR}&nbsp;<input class="btnlite" type="submit" value="{L_GO}" name="sort" /></td>
+</tr>
+</table>
+
+<table width="100%" cellspacing="0" cellpadding="0">
+<tr>
+	<td class="pagination">{PAGE_NUMBER} [ {TOTAL_USERS} ]</td>
+	<td align="{S_CONTENT_FLOW_END}"><span class="pagination"><!-- INCLUDE pagination.html --></span></td>
+</tr>
+</table>
+{S_FORM_TOKEN}
+</form>
+
+<br clear="all" /><br />
+
+<!-- INCLUDE mcp_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/mcp_warn_post.html phpbb/styles/spring/template/mcp_warn_post.html
--- phpBB-3.0.10/styles/spring/template/mcp_warn_post.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/mcp_warn_post.html	2014-04-15 14:31:18.703429005 +0200
@@ -0,0 +1,62 @@
+<!-- INCLUDE mcp_header.html -->
+
+<table width="100%" cellpadding="3" cellspacing="1" border="0" class="tablebg">
+<tr>
+	<th colspan="2" align="center">{L_POST}</th>
+</tr>
+<tr> 
+	<td class="row1" align="center">
+		<table cellspacing="1" cellpadding="2" border="0">
+		<tr>
+			<td class="gen" align="center"><!-- IF USER_COLOR --><b style="color: #{USER_COLOR}"><!-- ELSE --><b><!-- ENDIF -->{USERNAME}</b></td>
+		</tr>
+		<!-- IF RANK_TITLE -->
+			<tr>
+				<td class="postdetails" align="center">{RANK_TITLE}</td>
+			</tr>
+		<!-- ENDIF -->
+		<!-- IF RANK_IMG -->
+			<tr>
+				<td align="center">{RANK_IMG}</td>
+			</tr>
+		<!-- ENDIF -->
+		<tr>
+			<td align="center"><!-- IF AVATAR_IMG -->{AVATAR_IMG}<!-- ELSE --><img src="{T_THEME_PATH}/images/no_avatar.gif" alt="" /><!-- ENDIF --></td>
+		</tr>
+		</table>
+	</td>
+	<td class="row1">
+		<span class="gen">{POST}</span>
+	</td>
+</tr>
+</table>
+
+<br clear="all" /><br />
+
+<form method="post" name="mcp" action="{U_POST_ACTION}">
+
+<table width="100%" cellpadding="3" cellspacing="1" border="0" class="tablebg">
+<tr>
+	<th align="center">{L_ADD_WARNING}</th>
+</tr>
+<tr>
+	<td class="row3" align="center"><span class="genmed">{L_ADD_WARNING_EXPLAIN}</span></td>
+</tr>
+<tr>
+	<td class="row1" align="center"><textarea name="warning" rows="10" cols="76">{L_WARNING_POST_DEFAULT}</textarea></td>
+</tr>
+<!-- IF S_CAN_NOTIFY -->
+<tr>
+	<td class="row1" align="center"><input type="checkbox" class="radio" name="notify_user" checked="checked" /><span class="genmed">{L_NOTIFY_USER_WARN}</span></td>
+</tr>
+<!-- ENDIF -->
+<tr>
+	<td class="cat" align="center"><input class="btnmain" type="submit" name="action[add_warning]" value="{L_SUBMIT}" />&nbsp;&nbsp;<input class="btnlite" type="reset" value="{L_RESET}" /></td>
+</tr>
+</table>
+{S_FORM_TOKEN}
+</form>
+
+<br clear="all" /><br />
+
+<!-- INCLUDE mcp_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/mcp_warn_user.html phpbb/styles/spring/template/mcp_warn_user.html
--- phpBB-3.0.10/styles/spring/template/mcp_warn_user.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/mcp_warn_user.html	2014-04-15 14:31:18.703429005 +0200
@@ -0,0 +1,75 @@
+<!-- INCLUDE mcp_header.html -->
+
+<table width="100%" cellpadding="3" cellspacing="1" border="0" class="tablebg">
+<tr>
+	<th colspan="2" align="center">{USERNAME}</th>
+</tr>
+<tr> 
+	<td class="row1" align="center">
+		<table cellspacing="1" cellpadding="2" border="0">
+		<tr>
+			<td class="gen" align="center"><b>{USERNAME_FULL}</b></td>
+		</tr>
+		<!-- IF RANK_TITLE -->
+			<tr>
+				<td class="postdetails" align="center">{RANK_TITLE}</td>
+			</tr>
+		<!-- ENDIF -->
+		<!-- IF RANK_IMG -->
+			<tr>
+				<td align="center">{RANK_IMG}</td>
+			</tr>
+		<!-- ENDIF -->
+		<tr>
+			<td align="center"><!-- IF AVATAR_IMG -->{AVATAR_IMG}<!-- ELSE --><img src="{T_THEME_PATH}/images/no_avatar.gif" alt="" /><!-- ENDIF --></td>
+		</tr>
+		</table>
+	</td>
+	<td class="row1">
+		<table width="100%" cellspacing="1" cellpadding="2" border="0">
+		<tr> 
+			<td class="gen" align="{S_CONTENT_FLOW_END}" nowrap="nowrap">{L_JOINED}: </td>
+			<td width="100%"><b class="gen">{JOINED}</b></td>
+		</tr>
+		<tr> 
+			<td class="gen" align="{S_CONTENT_FLOW_END}" valign="top" nowrap="nowrap">{L_TOTAL_POSTS}: </td>
+			<td><b class="gen">{POSTS}</b></td>
+		</tr>
+		<tr> 
+			<td class="gen" align="{S_CONTENT_FLOW_END}" valign="top" nowrap="nowrap">{L_WARNINGS}: </td>
+			<td><b class="gen">{WARNINGS}</b></td>
+		</tr>
+		</table>
+	</td>
+</tr>
+</table>
+
+<br clear="all" /><br />
+
+<form method="post" name="mcp" action="{U_POST_ACTION}">
+
+<table width="100%" cellpadding="3" cellspacing="1" border="0" class="tablebg">
+<tr>
+	<th align="center">{L_ADD_WARNING}</th>
+</tr>
+<tr>
+	<td class="row3" align="center"><span class="genmed">{L_ADD_WARNING_EXPLAIN}</span></td>
+</tr>
+<tr>
+	<td class="row1" align="center"><textarea name="warning" rows="10" cols="76"></textarea></td>
+</tr>
+<!-- IF S_CAN_NOTIFY -->
+<tr>
+	<td class="row1" align="center"><input type="checkbox" class="radio" name="notify_user" checked="checked" /><span class="genmed">{L_NOTIFY_USER_WARN}</span></td>
+</tr>
+<!-- ENDIF -->
+<tr>
+	<td class="cat" align="center"><input class="btnmain" type="submit" name="action[add_warning]" value="{L_SUBMIT}" />&nbsp;&nbsp;<input class="btnlite" type="reset" value="{L_RESET}" /></td>
+</tr>
+</table>
+{S_FORM_TOKEN}
+</form>
+
+<br clear="all" /><br />
+
+<!-- INCLUDE mcp_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/mcp_whois.html phpbb/styles/spring/template/mcp_whois.html
--- phpBB-3.0.10/styles/spring/template/mcp_whois.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/mcp_whois.html	2014-04-15 14:31:18.704429005 +0200
@@ -0,0 +1,15 @@
+<!-- INCLUDE mcp_header.html -->
+
+<table class="tablebg" width="100%" cellspacing="1">
+<tr> 
+	<th>{L_WHOIS}</th>
+</tr>
+<tr>
+	<td class="row3" align="center"><span class="gensmall">{RETURN_POST}</span></td>
+</tr>
+<tr>
+	<td class="row1"><pre>{WHOIS}</pre></td>
+</tr>
+</table>
+
+<!-- INCLUDE mcp_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/memberlist_body.html phpbb/styles/spring/template/memberlist_body.html
--- phpBB-3.0.10/styles/spring/template/memberlist_body.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/memberlist_body.html	2014-04-15 14:31:18.705429005 +0200
@@ -0,0 +1,121 @@
+<!-- IF S_IN_SEARCH_POPUP -->
+	<!-- INCLUDE simple_header.html -->
+<!-- ELSE -->
+	<!-- INCLUDE overall_header.html -->
+<!-- ENDIF -->
+
+<!-- IF S_SEARCH_USER -->	
+	<!-- INCLUDE memberlist_search.html -->	
+<!-- ENDIF -->
+
+<!-- IF S_SHOW_GROUP --><!-- INCLUDE memberlist_group.html --><!-- ENDIF -->
+
+<!-- IF not S_SHOW_GROUP -->
+	<form method="post" name="charsearch" action="{S_MODE_ACTION}">
+		<table width="100%" cellspacing="1">
+		<tr>
+			<td align="{S_CONTENT_FLOW_BEGIN}"><span class="genmed">{L_USERNAME_BEGINS_WITH}: </span>
+				<select name="first_char" onchange="this.form.submit();">
+					<!-- BEGIN first_char -->
+						<option value="{first_char.VALUE}"<!-- IF first_char.S_SELECTED --> selected="selected"<!-- ENDIF -->>{first_char.DESC}</option>
+					<!-- END first_char -->
+				</select>&nbsp;<input type="submit" name="char" value="{L_DISPLAY}" class="btnlite" /></td>
+	<!-- IF U_FIND_MEMBER and not S_SEARCH_USER -->
+			<td class="genmed" align="{S_CONTENT_FLOW_END}"><a href="{U_FIND_MEMBER}">{L_FIND_USERNAME}</a></td>
+	<!-- ELSEIF S_SEARCH_USER and U_HIDE_FIND_MEMBER and not S_IN_SEARCH_POPUP -->
+			<td class="genmed" align="{S_CONTENT_FLOW_END}"><a href="{U_HIDE_FIND_MEMBER}">{L_HIDE_MEMBER_SEARCH}</a></td>
+	<!-- ENDIF -->
+		</tr>
+		</table>
+		{S_FORM_TOKEN}
+	</form>
+<!-- ENDIF -->
+
+<!-- IF S_IN_SEARCH_POPUP -->
+	<form method="post" name="results" action="{S_MODE_ACTION}" onsubmit="insert_marked(this.user);return false">
+<!-- ELSE -->
+	<form method="post" action="{S_MODE_ACTION}">
+<!-- ENDIF -->
+<table class="tablebg" width="100%" cellspacing="1">
+<tr>
+	<th nowrap="nowrap">#</th>
+	<th nowrap="nowrap" width="25%" align="{S_CONTENT_FLOW_BEGIN}"><a href="{U_SORT_USERNAME}">{L_USERNAME}</a></th>
+	<th nowrap="nowrap" width="15%"><a href="{U_SORT_JOINED}">{L_JOINED}</a></th>
+	<th nowrap="nowrap" width="10%"><a href="{U_SORT_POSTS}">{L_POSTS}</a></th>
+	<th nowrap="nowrap" width="15%"><a href="{U_SORT_RANK}">{L_RANK}</a></th>
+	<th nowrap="nowrap" width="11%">{L_SEND_MESSAGE}</th>
+	<th nowrap="nowrap" width="11%"><a href="{U_SORT_EMAIL}">{L_EMAIL}</a></th>
+	<th nowrap="nowrap" width="11%"><a href="{U_SORT_WEBSITE}">{L_WEBSITE}</a></th>
+	<!-- IF S_IN_SEARCH_POPUP and not S_SELECT_SINGLE --><th width="2%" nowrap="nowrap">{L_MARK}</th><!-- ENDIF -->
+</tr>
+<!-- BEGIN memberrow -->
+
+	<!-- IF S_SHOW_GROUP -->
+		<!-- IF memberrow.S_FIRST_ROW and memberrow.S_GROUP_LEADER -->
+			<tr class="row3">
+				<td colspan="8"><b class="gensmall">{L_GROUP_LEADER}</b></td>
+			</tr>
+		<!-- ELSEIF not memberrow.S_GROUP_LEADER and not $S_MEMBER_HEADER -->
+			<tr class="row3">
+				<td colspan="8"><b class="gensmall">{L_GROUP_MEMBERS}</b></td>
+			</tr>
+				<!-- DEFINE $S_MEMBER_HEADER = 1 -->
+		<!-- ENDIF -->
+	<!-- ENDIF -->
+
+	<!-- IF memberrow.S_ROW_COUNT is even --><tr class="row2"><!-- ELSE -->	<tr class="row1"><!-- ENDIF -->
+
+		<td class="gen" align="center">&nbsp;{memberrow.ROW_NUMBER}&nbsp;</td>
+		<td class="genmed" align="{S_CONTENT_FLOW_BEGIN}">{memberrow.USERNAME_FULL}<!-- IF S_SELECT_SINGLE --> [&nbsp;<a href="#" onclick="insert_single('{memberrow.A_USERNAME}'); return false;">{L_SELECT}</a>&nbsp;]<!-- ENDIF --></td>
+		<td class="genmed" align="center" nowrap="nowrap">&nbsp;{memberrow.JOINED}&nbsp;</td>
+		<td class="gen" align="center">{memberrow.POSTS}</td>
+		<td class="gen" align="center"><!-- IF memberrow.RANK_IMG -->{memberrow.RANK_IMG}<!-- ELSE -->{memberrow.RANK_TITLE}<!-- ENDIF --></td>
+		<td class="gen" align="center">&nbsp;<!-- IF memberrow.U_PM --><a href="{memberrow.U_PM}">{PM_IMG}</a><!-- ENDIF -->&nbsp;</td>
+		<td class="gen" align="center">&nbsp;<!-- IF memberrow.U_EMAIL --><a href="{memberrow.U_EMAIL}">{EMAIL_IMG}</a><!-- ENDIF -->&nbsp;</td>
+		<td class="gen" align="center">&nbsp;<!-- IF memberrow.U_WWW --><a href="{memberrow.U_WWW}">{WWW_IMG}</a><!-- ENDIF -->&nbsp;</td>
+		<!-- IF memberrow.S_PROFILE_FIELD1 -->
+			<!-- Use a construct like this to include admin defined profile fields. Replace FIELD1 with the name of your field. -->
+			<td class="gen" align="center">&nbsp;{memberrow.PROFILE_FIELD1_VALUE}</td>
+		<!-- ENDIF -->
+		<!-- IF S_IN_SEARCH_POPUP and not S_SELECT_SINGLE --><td align="center"><input type="checkbox" class="radio" name="user" value="{memberrow.USERNAME}" /></td><!-- ENDIF -->
+	</tr>
+
+<!-- BEGINELSE -->
+
+	<tr>
+		<td class="row1" colspan="<!-- IF S_IN_SEARCH_POPUP -->9<!-- ELSE -->8<!-- ENDIF -->" align="center">
+			<span class="gen"><!-- IF S_SHOW_GROUP -->{L_NO_GROUP_MEMBERS}<!-- ELSE -->{L_NO_MEMBERS}<!-- ENDIF --></span>
+		</td>
+	</tr>
+
+<!-- END memberrow -->
+
+<tr>
+	<td class="cat" colspan="<!-- IF S_IN_SEARCH_POPUP -->9<!-- ELSE -->8<!-- ENDIF -->" align="center"><!-- IF S_IN_SEARCH_POPUP and not S_SELECT_SINGLE --><input class="btnlite" type="submit" value="{L_SELECT_MARKED}" /><!-- ELSE --><span class="gensmall">{L_SELECT_SORT_METHOD}:</span>&nbsp;<select name="sk">{S_MODE_SELECT}</select>&nbsp; <span class="gensmall">{L_ORDER}</span>&nbsp;<select name="sd">{S_ORDER_SELECT}</select>&nbsp; <input type="submit" name="submit" value="{L_SUBMIT}" class="btnlite" /><!-- ENDIF --></td>
+</tr>
+</table>
+{S_FORM_TOKEN}
+	
+</form>
+
+<table width="100%" cellspacing="0" cellpadding="0">
+<tr>
+	<td class="pagination">{PAGE_NUMBER} [ {TOTAL_USERS} ]</td>
+	<td align="{S_CONTENT_FLOW_END}"><!-- IF S_IN_SEARCH_POPUP and not S_SELECT_SINGLE --><b class="nav"><a href="#" onclick="marklist('results', 'user', true); return false;">{L_MARK_ALL}</a> :: <a href="#" onclick="marklist('results', 'user', false); return false;">{L_UNMARK_ALL}</a></b><br /><!-- ENDIF --><span class="pagination"><!-- INCLUDE pagination.html --></span></td>
+</tr>
+</table>
+
+
+
+<!-- IF S_IN_SEARCH_POPUP -->
+	<!-- INCLUDE simple_footer.html -->	
+<!-- ELSE -->
+	<br clear="all" />
+	
+	<!-- INCLUDE breadcrumbs.html -->
+	
+	<br clear="all" />
+	
+	<div align="{S_CONTENT_FLOW_END}"><!-- INCLUDE jumpbox.html --></div>	
+	<!-- INCLUDE overall_footer.html -->
+<!-- ENDIF -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/memberlist_email.html phpbb/styles/spring/template/memberlist_email.html
--- phpBB-3.0.10/styles/spring/template/memberlist_email.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/memberlist_email.html	2014-04-15 14:31:18.706429005 +0200
@@ -0,0 +1,73 @@
+<!-- INCLUDE overall_header.html -->
+
+<div id="pagecontent">
+
+	<form action="{S_POST_ACTION}" method="post" name="postform">
+	
+	<table class="tablebg" width="100%" cellspacing="1">
+	<tr> 
+		<th colspan="2">{L_SEND_EMAIL_USER} {USERNAME}</th>
+	</tr>
+	<!-- IF ERROR_MESSAGE -->
+		<tr>
+			<td class="row3" colspan="2" align="center"><span class="error">{ERROR_MESSAGE}</span></td>
+		</tr>
+	<!-- ENDIF -->
+	<!-- IF S_SEND_USER -->
+		<tr> 
+			<td class="row1" width="35%"><b class="genmed">{L_RECIPIENT}</b></td>
+			<td class="row2" width="65%"><b class="genmed">{USERNAME}</b></td>
+		</tr>
+		<tr> 
+			<td class="row1" width="35%"><b class="genmed">{L_SUBJECT}</b></td>
+			<td class="row2"><input class="post" type="text" name="subject" size="50" tabindex="2" value="{SUBJECT}" /></td>
+		</tr>
+	<!-- ELSE -->
+		<tr>
+			<td class="row1" width="35%"><b class="genmed">{L_EMAIL_ADDRESS}</b></td>
+			<td class="row2"><input class="post" type="text" name="email" size="50" maxlength="100" value="{EMAIL}" /></td>
+		</tr>
+		<tr> 
+			<td class="row1" width="35%"><b class="genmed">{L_REAL_NAME}</b></td>
+			<td class="row2"><input class="post" type="text" name="name" size="50" value="{NAME}" /></td>
+		</tr>
+		<tr> 
+			<td class="row1" width="35%"><b class="genmed">{L_DEST_LANG}</b><br /><span class="gensmall">{L_DEST_LANG_EXPLAIN}</span></td>
+			<td class="row2"><select name="lang">{S_LANG_OPTIONS}</select></td>
+		</tr>
+	<!-- ENDIF -->
+	<tr> 
+		<td class="row1" valign="top"><b class="genmed">{L_MESSAGE_BODY}</b><br /><span class="gensmall">{L_EMAIL_BODY_EXPLAIN}</span></td>
+		<td class="row2"><textarea class="post" name="message" rows="15" cols="76" tabindex="3">{MESSAGE}</textarea></td>
+	</tr>
+	<tr> 
+		<td class="row1" valign="top"><span class="gen"><b>{L_OPTIONS}</b></span></td>
+		<td class="row2">
+			<table cellspacing="0" cellpadding="1" border="0">
+			<tr> 
+				<td><input type="checkbox" class="radio" name="cc_email" value="1" checked="checked" /></td>
+				<td class="gen">{L_CC_EMAIL}</td>
+			</tr>
+			</table>
+		</td>
+	</tr>
+	<tr>
+		<td class="cat" colspan="2" align="center"><input type="submit" tabindex="6" name="submit" class="btnmain" value="{L_SEND_EMAIL}" /></td>
+	</tr>
+	</table>
+
+	{S_FORM_TOKEN}
+	
+	</form>
+
+</div>
+
+<br clear="all" />
+
+<!-- INCLUDE breadcrumbs.html -->
+
+<br clear="all" />
+
+<div style="float: {S_CONTENT_FLOW_END};"><!-- INCLUDE jumpbox.html --></div>
+
+<!-- INCLUDE overall_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/memberlist_group.html phpbb/styles/spring/template/memberlist_group.html
--- phpBB-3.0.10/styles/spring/template/memberlist_group.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/memberlist_group.html	2014-04-15 14:31:18.706429005 +0200
@@ -0,0 +1,17 @@
+ 
+<table class="tablebg" width="100%" cellspacing="1">
+<tr> 
+	<th colspan="3">{L_GROUP_INFORMATION}</th>
+</tr>
+<tr> 
+	<td class="row1" width="20%"><b class="genmed">{L_GROUP_NAME}:</b></td>
+	<td class="row2"><b class="gen"<!-- IF GROUP_COLOR --> style="color:#{GROUP_COLOR}"<!-- ENDIF -->>{GROUP_NAME}</b></td>
+<!-- IF AVATAR_IMG or RANK_IMG or GROUP_RANK or U_PM -->
+	<td class="row1" width="33%" rowspan="2" align="center"><!-- IF AVATAR_IMG -->{AVATAR_IMG}<br /><!-- ENDIF --><!-- IF RANK_IMG -->{RANK_IMG}<!-- ENDIF --><!-- IF GROUP_RANK --><span class="gensmall">{GROUP_RANK}</span><br /><br /><!-- ENDIF --><!-- IF U_PM --><a href="{U_PM}">{PM_IMG}</a><!-- ENDIF --></td>
+<!-- ENDIF -->
+</tr>
+<tr> 
+	<td class="row1" width="20%"><b class="genmed">{L_GROUP_DESC}:</b></td>
+	<td class="row2"><span class="gen">{GROUP_DESC}</span><p class="forumdesc">{GROUP_TYPE}</p></td>
+</tr>
+</table>
diff -ruN phpBB-3.0.10/styles/spring/template/memberlist_im.html phpbb/styles/spring/template/memberlist_im.html
--- phpBB-3.0.10/styles/spring/template/memberlist_im.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/memberlist_im.html	2014-04-15 14:31:18.707429005 +0200
@@ -0,0 +1,139 @@
+<!-- INCLUDE simple_header.html -->
+
+<br clear="all" />
+
+<!-- MSNM info from http://www.cdolive.net/ - doesn't seem to work with MSN Messenger -->
+
+<form method="post" action="{S_IM_ACTION}">
+	<table class="tablebg" width="95%" cellspacing="1" cellpadding="4" border="0" align="center">
+	<tr>
+		<th colspan="2">{L_SEND_IM}</th>
+	</tr>
+	<tr>
+		<td class="row3" colspan="2"><span class="gensmall">{L_SEND_IM_EXPLAIN}</span></td>
+	</tr>
+	<tr>
+		<td class="row1"><b class="genmed">{L_IM_RECIPIENT}: </b></td>
+		<td class="row2"><span class="gen"><b>{USERNAME}</b><!-- IF S_SEND_ICQ or S_SEND_AIM or S_SEND_MSNM or S_NO_SEND_JABBER --> [ {IM_CONTACT} ]<!-- ENDIF --></span> <!-- IF PRESENCE_IMG -->{PRESENCE_IMG}<!-- ENDIF --></td>
+	</tr>
+
+	<!-- IF S_SEND_AIM -->
+		<tr>
+			<td class="row1" colspan="2" align="center"><br /><a class="gen" href="{U_AIM_CONTACT}">{L_IM_ADD_CONTACT}</a><br /><a class="gen" href="{U_AIM_MESSAGE}">{L_IM_SEND_MESSAGE}</a><br /><br /><a class="gensmall" href="http://www.aim.com">{L_IM_DOWNLOAD_APP}</a> | <a class="gensmall" href="http://www.aim.com/products/express">{L_IM_AIM_EXPRESS}</a> </td>
+		</tr>
+		<tr>
+			<td class="cat" colspan="2" align="center">&nbsp;</td>
+		</tr>
+	<!-- ENDIF -->
+
+	<!-- IF S_SEND_MSNM -->
+		<tr>
+			<td class="row1" colspan="2" align="center">
+				<object classid="clsid:B69003B3-C55E-4B48-836C-BC5946FC3B28" codetype="application/x-oleobject" id="objMessengerApp" width="0" height="0"></object>
+				<script type="text/javascript">
+				// <![CDATA[
+					var app = document.getElementById('objMessengerApp');
+					
+					/**
+					* Check whether the browser supports this and whether MSNM is connected
+					*/
+					function msn_supported()
+					{
+						// Does the browser support the MSNM object?
+						if (app.MyStatus) 
+						{
+							// Is MSNM connected?
+							if (app.MyStatus == 1)
+							{
+								alert('{LA_IM_MSNM_CONNECT}');
+								return false;
+							}
+						}
+						else
+						{
+							alert('{LA_IM_MSNM_BROWSER}');
+							return false;
+						}
+						return true;
+					}
+
+					/**
+					* Add to your contact list
+					*/
+					function add_contact(address)
+					{
+						if (msn_supported())
+						{
+							// Could return an error while MSNM is connecting, don't want that
+							try
+							{
+								app.AddContact(0, address);
+							}
+							catch (e)
+							{
+								return;
+							}
+						}
+					}
+
+					/**
+					* Write IM to contact
+					*/
+					function im_contact(address)
+					{
+						if (msn_supported())
+						{
+							// Could return an error while MSNM is connecting, don't want that
+							try
+							{
+								app.InstantMessage(address);
+							}
+							catch (e)
+							{
+								return;
+							}
+						}
+					}
+				// ]]>
+				</script>
+	
+				<a class="gen" href="#" onclick="add_contact('{A_IM_CONTACT}'); return false;">{L_IM_ADD_CONTACT}</a><br /><a class="gen" href="#" onclick="im_contact('{A_IM_CONTACT}'); return false;">{L_IM_SEND_MESSAGE}</a>
+			</td>
+		</tr>
+		<tr>
+			<td class="cat" colspan="2" align="center">&nbsp;</td>
+		</tr>
+	<!-- ENDIF -->
+
+	<!-- IF S_SEND_JABBER -->
+		<tr>
+			<td class="row1"><b class="genmed">{L_IM_MESSAGE}: </b></td>
+			<td class="row2"><textarea class="post" name="message" rows="5" cols="45"></textarea></td>
+		</tr>
+		<tr>
+			<td class="cat" colspan="2" align="center"><input class="btnmain" name="submit" type="submit" value="{L_IM_SEND}" /></td>
+		</tr>
+	<!-- ENDIF -->
+
+	<!-- IF S_NO_SEND_JABBER -->
+		<tr>
+			<td class="row1" colspan="2"><span class="genmed">{L_IM_NO_JABBER}</span></td>
+		</tr>
+	<!-- ENDIF -->
+
+	<!-- IF S_SENT_JABBER -->
+		<tr>
+			<td class="row1" colspan="2" align="center"><span class="gen">{L_IM_SENT_JABBER}</span></td>
+		</tr>
+		<tr>
+			<td class="cat" colspan="2" align="center"></td>
+		</tr>
+	<!-- ENDIF -->
+
+	</table>
+{S_FORM_TOKEN}
+</form>
+
+<a class="nav" href="#" onclick="window.close(); return false;">{L_CLOSE_WINDOW}</a>
+
+<!-- INCLUDE simple_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/memberlist_leaders.html phpbb/styles/spring/template/memberlist_leaders.html
--- phpBB-3.0.10/styles/spring/template/memberlist_leaders.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/memberlist_leaders.html	2014-04-15 14:31:18.708429005 +0200
@@ -0,0 +1,71 @@
+<!-- INCLUDE overall_header.html -->
+
+<form method="post" action="{S_MODE_ACTION}">
+
+<table class="tablebg" width="100%" cellspacing="1">
+<tr>
+	<th nowrap="nowrap" width="20%">{L_USERNAME}</th>
+	<th nowrap="nowrap" width="25%">{L_FORUMS}</th>
+	<th nowrap="nowrap" width="20%">{L_PRIMARY_GROUP}</th>
+	<th nowrap="nowrap" width="15%">{L_RANK}</th>
+	<th nowrap="nowrap" width="11%">{L_SEND_MESSAGE}</th>
+</tr>
+<tr class="row3">
+	<td colspan="5"><b class="gensmall">{L_ADMINISTRATORS}</b></td>
+</tr>
+<!-- BEGIN admin -->
+	<!-- IF admin.S_ROW_COUNT is even --><tr class="row2"><!-- ELSE --><tr class="row1"><!-- ENDIF -->
+
+	<td class="gen" align="center"><strong>{admin.USERNAME_FULL}</strong></td>
+	<td class="gensmall" align="center">&nbsp;</td>
+	<td class="gensmall" align="center" nowrap="nowrap">&nbsp;
+		<!-- IF admin.U_GROUP -->
+			<a<!-- IF admin.GROUP_COLOR --> style="font-weight: bold; color:#{admin.GROUP_COLOR}"<!-- ENDIF --> href="{admin.U_GROUP}">{admin.GROUP_NAME}</a>
+		<!-- ELSE -->
+			{admin.GROUP_NAME}
+		<!-- ENDIF -->
+	&nbsp;</td>
+	<td class="gen" align="center"><!-- IF admin.RANK_IMG -->{admin.RANK_IMG}<!-- ELSE -->{admin.RANK_TITLE}<!-- ENDIF --></td>
+	<td class="gen" align="center">&nbsp;<!-- IF admin.U_PM --><a href="{admin.U_PM}">{PM_IMG}</a><!-- ENDIF -->&nbsp;</td>
+</tr>
+<!-- BEGINELSE -->
+	<tr>
+		<td class="row1" colspan="5" align="center"><span class="gen">{L_NO_ADMINISTRATORS}</span></td>
+	</tr>
+<!-- END admin -->
+<tr class="row3">
+	<td colspan="5"><b class="gensmall">{L_MODERATORS}</b></td>
+</tr>
+<!-- BEGIN mod -->
+	<!-- IF mod.S_ROW_COUNT is even --><tr class="row2"><!-- ELSE --><tr class="row1"><!-- ENDIF -->
+
+	<td class="gen" align="center"><strong>{mod.USERNAME_FULL}</strong></td>
+	<td align="center"><!-- IF not mod.FORUMS -->{L_ALL_FORUMS}<!-- ELSE --><select style="width: 200px;">{mod.FORUMS}</select><!-- ENDIF -->&nbsp;</td>
+	<td class="gensmall" align="center" nowrap="nowrap">&nbsp;
+		<!-- IF mod.U_GROUP -->
+			<a<!-- IF mod.GROUP_COLOR --> style="font-weight: bold; color:#{mod.GROUP_COLOR}"<!-- ENDIF --> href="{mod.U_GROUP}">{mod.GROUP_NAME}</a>
+		<!-- ELSE -->
+			{mod.GROUP_NAME}
+		<!-- ENDIF -->
+	&nbsp;</td>
+	<td class="gen" align="center"><!-- IF mod.RANK_IMG -->{mod.RANK_IMG}<!-- ELSE -->{mod.RANK_TITLE}<!-- ENDIF --></td>
+	<td class="gen" align="center">&nbsp;<!-- IF mod.U_PM --><a href="{mod.U_PM}">{PM_IMG}</a><!-- ENDIF -->&nbsp;</td>
+</tr>
+<!-- BEGINELSE -->
+	<tr>
+		<td class="row1" colspan="5" align="center"><span class="gen">{L_NO_MODERATORS}</span></td>
+	</tr>
+<!-- END mod -->
+</table>
+
+</form>
+
+<br clear="all" />
+
+<!-- INCLUDE breadcrumbs.html -->
+
+<br clear="all" />
+
+<div style="float: {S_CONTENT_FLOW_END};"><!-- INCLUDE jumpbox.html --></div>
+
+<!-- INCLUDE overall_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/memberlist_search.html phpbb/styles/spring/template/memberlist_search.html
--- phpBB-3.0.10/styles/spring/template/memberlist_search.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/memberlist_search.html	2014-04-15 14:31:18.709429005 +0200
@@ -0,0 +1,143 @@
+<!-- You should retain this javascript in your own template! -->
+
+<!-- IF S_IN_SEARCH_POPUP -->
+	<script type="text/javascript">
+	// <![CDATA[
+		function insert_user(user)
+		{
+			opener.document.forms['{S_FORM_NAME}'].{S_FIELD_NAME}.value = ( opener.document.forms['{S_FORM_NAME}'].{S_FIELD_NAME}.value.length && opener.document.forms['{S_FORM_NAME}'].{S_FIELD_NAME}.type == "textarea" ) ? opener.document.forms['{S_FORM_NAME}'].{S_FIELD_NAME}.value + "\n" + user : user;
+		}
+
+		function insert_marked(users)
+		{
+			if (typeof(users.length) == "undefined")
+			{
+				if (users.checked)
+				{
+					insert_user(users.value);
+				}
+			}
+			else if (users.length > 0)
+			{
+				for (i = 0; i < users.length; i++)
+				{
+					if (users[i].checked)
+					{
+						insert_user(users[i].value);
+					}
+				}
+			}
+
+			self.close();
+		}
+
+		function insert_single(user)
+		{
+			opener.document.forms['{S_FORM_NAME}'].{S_FIELD_NAME}.value = user;
+			self.close();
+		}		
+
+		/**
+		* Mark/unmark checklist
+		* id = ID of parent container, name = name prefix, state = state [true/false]
+		*/
+		function marklist(id, name, state)
+		{
+			var parent = document.getElementById(id);
+			if (!parent)
+			{
+				eval('parent = document.' + id);
+			}
+
+			if (!parent)
+			{
+				return;
+			}
+
+			var rb = parent.getElementsByTagName('input');
+			
+			for (var r = 0; r < rb.length; r++)
+			{
+				if (rb[r].name.substr(0, name.length) == name)
+				{
+					rb[r].checked = state;
+				}
+			}
+		}
+	// ]]>
+	</script>
+<!-- ENDIF -->
+
+<form method="post" action="{S_MODE_ACTION}" name="search">
+
+<table class="tablebg" width="100%" cellspacing="1">
+<tr>
+	<th colspan="4">{L_FIND_USERNAME}</th>
+</tr>
+<tr>
+	<td class="row3" colspan="4"><span class="gensmall">{L_FIND_USERNAME_EXPLAIN}</span></td>
+</tr>
+<tr>
+	<td class="row1"><b class="genmed">{L_USERNAME}:</b></td>
+	<td class="row2"><input class="post" type="text" name="username" value="{USERNAME}" /></td>
+	<td class="row1"><b class="genmed">{L_ICQ}:</b></td>
+	<td class="row2"><input class="post" type="text" name="icq" value="{ICQ}" /></td>
+</tr>
+<tr>
+<!-- IF S_EMAIL_SEARCH_ALLOWED -->
+	<td class="row1"><b class="genmed">{L_EMAIL}:</b></td>
+	<td class="row2"><input class="post" type="text" name="email" value="{EMAIL}" /></td>
+<!-- ELSE -->
+	<td colspan="2" class="row1">&nbsp;</td>
+<!-- ENDIF -->
+	<td class="row1"><b class="genmed">{L_AIM}:</b></td>
+	<td class="row2"><input class="post" type="text" name="aim" value="{AIM}" /></td>
+</tr>
+<tr>
+	<td class="row1"><b class="genmed">{L_JOINED}:</b></td>
+	<td class="row2"><select name="joined_select">{S_JOINED_TIME_OPTIONS}</select> <input class="post" type="text" name="joined" value="{JOINED}" /></td>
+	<td class="row1"><b class="genmed">{L_YIM}:</b></td>
+	<td class="row2"><input class="post" type="text" name="yahoo" value="{YAHOO}" /></td>
+</tr>
+<tr>
+<!-- IF S_VIEWONLINE -->
+	<td class="row1"><b class="genmed">{L_LAST_ACTIVE}:</b></td>
+	<td class="row2"><select name="active_select">{S_ACTIVE_TIME_OPTIONS}</select> <input class="post" type="text" name="active" value="{ACTIVE}" /></td>
+<!-- ELSE -->
+	<td colspan="2" class="row1">&nbsp;</td>
+<!-- ENDIF -->
+	<td class="row1"><b class="genmed">{L_MSNM}:</b></td>
+	<td class="row2"><input class="post" type="text" name="msn" value="{MSNM}" /></td>
+</tr>
+<tr>
+	<td class="row1"><b class="genmed">{L_POSTS}:</b></td>
+	<td class="row2"><select name="count_select">{S_COUNT_OPTIONS}</select> <input class="post" type="text" name="count" value="{COUNT}" /></td>
+	<td class="row1"><b class="genmed">{L_JABBER}:</b></td>
+	<td class="row2"><input class="post" type="text" name="jabber" value="{JABBER}" /></td>
+</tr>
+<tr>
+	<td class="row1"><b class="genmed">{L_SORT_BY}:</b></td>
+	<td class="row2" nowrap="nowrap"><select name="sk">{S_SORT_OPTIONS}</select> <select name="sd">{S_ORDER_SELECT}</select>&nbsp;</td>
+<!-- IF S_IP_SEARCH_ALLOWED -->
+	<td class="row1"><b class="genmed">{L_POST_IP}:</b></td>
+	<td class="row2"><input class="post" type="text" name="ip" value="{IP}" /></td>
+</tr>
+<tr>
+	<td class="row1"><b class="genmed">{L_GROUP}:</b></td>
+	<td class="row2" nowrap="nowrap"><select name="search_group_id">{S_GROUP_SELECT}</select></td>
+	<td class="row1">&nbsp;</td>
+	<td class="row2">&nbsp;</td>
+</tr>
+<!-- ELSE -->
+	<td class="row1"><b class="genmed">{L_GROUP}:</b></td>
+	<td class="row2" nowrap="nowrap"><select name="search_group_id">{S_GROUP_SELECT}</select></td>
+</tr>
+<!-- ENDIF -->
+<tr>
+	<td class="cat" colspan="4" align="center"><input class="btnmain" type="submit" name="submit" value="{L_SEARCH}" />&nbsp;&nbsp;<input class="btnlite" type="reset" value="{L_RESET}" /></td>
+</tr>
+</table>
+{S_FORM_TOKEN}
+</form>
+
+<br clear="all" />
diff -ruN phpBB-3.0.10/styles/spring/template/memberlist_view.html phpbb/styles/spring/template/memberlist_view.html
--- phpBB-3.0.10/styles/spring/template/memberlist_view.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/memberlist_view.html	2014-04-15 14:31:18.710429005 +0200
@@ -0,0 +1,207 @@
+<!-- INCLUDE overall_header.html -->
+
+<div id="pagecontent">
+
+	<form method="post" action="{S_PROFILE_ACTION}">
+
+	<table class="tablebg" width="100%" cellspacing="1">
+	<tr>
+		<th colspan="2" nowrap="nowrap">{L_VIEWING_PROFILE}</th>
+	</tr>
+	<tr>
+		<td class="cat" width="40%" align="center"><h4>{L_USER_PRESENCE}</h4></td>
+		<td class="cat" width="60%" align="center"><h4>{L_USER_FORUM}</h4></td>
+	</tr>
+	<tr>
+		<td class="row1" align="center">
+
+			<table cellspacing="1" cellpadding="2" border="0">
+			<!-- IF S_USER_INACTIVE -->
+			<tr>
+				<td align="center" style="color: red;"><b class="gen">{L_USER_IS_INACTIVE}</b><br />{L_INACTIVE_REASON}: {USER_INACTIVE_REASON}<br /><br /></td>
+			</tr>
+			<!-- ENDIF -->
+			<tr>
+				<td align="center"><!-- IF USER_COLOR --><b class="gen" style="color: {USER_COLOR}"><!-- ELSE --><b class="gen"><!-- ENDIF -->{USERNAME}</b><!-- IF U_USER_BAN --><span class="genmed"> [ <a href="{U_USER_BAN}">{L_USER_BAN}</a> ]</span><!-- ENDIF --><!-- IF U_USER_ADMIN --><span class="genmed"> [ <a href="{U_USER_ADMIN}">{L_USER_ADMIN}</a> ]</span><!-- ENDIF --></td>
+			</tr>
+			<!-- IF RANK_TITLE -->
+				<tr>
+					<td class="postdetails" align="center">{RANK_TITLE}</td>
+				</tr>
+			<!-- ENDIF -->
+			<!-- IF RANK_IMG -->
+				<tr>
+					<td align="center">{RANK_IMG}</td>
+				</tr>
+			<!-- ENDIF -->
+			<!-- IF AVATAR_IMG -->
+				<tr>
+					<td align="center">{AVATAR_IMG}</td>
+				</tr>
+			<!-- ENDIF -->
+			<!-- IF ONLINE_IMG -->
+			<tr>
+				<td align="center">{ONLINE_IMG}</td>
+			</tr>
+			<!-- ENDIF -->
+			<!-- IF U_SWITCH_PERMISSIONS -->
+				<tr>
+					<td class="genmed" align="center">[ <a href="{U_SWITCH_PERMISSIONS}">{L_USE_PERMISSIONS}</a> ]</td>
+				</tr>
+			<!-- ENDIF -->
+			<!-- IF S_USER_LOGGED_IN and S_ZEBRA -->
+				<tr>
+					<td class="genmed" align="center">[
+						<!-- IF U_REMOVE_FRIEND -->
+							<a href="{U_REMOVE_FRIEND}">{L_REMOVE_FRIEND}</a>
+						<!-- ELSEIF U_REMOVE_FOE -->
+							<a href="{U_REMOVE_FOE}">{L_REMOVE_FOE}</a>
+						<!-- ELSE -->
+							<!-- IF U_ADD_FRIEND --><a href="{U_ADD_FRIEND}">{L_ADD_FRIEND}</a><!-- ENDIF --><!-- IF U_ADD_FOE --><!-- IF U_ADD_FRIEND --> | <!-- ENDIF --><a href="{U_ADD_FOE}">{L_ADD_FOE}</a><!-- ENDIF -->
+						<!-- ENDIF -->
+					]</td>
+				</tr>
+			<!-- ENDIF -->
+			</table>
+		</td>
+		<td class="row1">
+			<table width="100%" cellspacing="1" cellpadding="2" border="0">
+			<tr>
+				<td class="gen" align="{S_CONTENT_FLOW_END}" nowrap="nowrap">{L_JOINED}: </td>
+				<td width="100%"><b class="gen">{JOINED}</b></td>
+			</tr>
+			<tr>
+				<td class="gen" align="{S_CONTENT_FLOW_END}" nowrap="nowrap">{L_VISITED}: </td>
+				<td width="100%"><b class="gen">{VISITED}</b></td>
+			</tr>
+			<!-- IF S_WARNINGS -->
+				<tr>
+					<td class="gen" align="{S_CONTENT_FLOW_END}" valign="top" nowrap="nowrap">{L_WARNINGS}: </td>
+					<td width="100%"><b class="gen">{WARNINGS}</b><!-- IF U_NOTES or U_WARN --><br /><span class="genmed"> [ <!-- IF U_NOTES --><a href="{U_NOTES}">{L_VIEW_NOTES}</a><!-- ENDIF --> <!-- IF U_WARN --><!-- IF U_NOTES --> | <!-- ENDIF --><a href="{U_WARN}">{L_WARN_USER}</a><!-- ENDIF --> ]</span><!-- ENDIF --></td>
+				</tr>
+			<!-- ENDIF -->
+			<tr>
+				<td class="gen" align="{S_CONTENT_FLOW_END}" valign="top" nowrap="nowrap">{L_TOTAL_POSTS}: </td>
+				<td><b class="gen">{POSTS}</b><span class="genmed"><!-- IF POSTS_PCT --><br />[{POSTS_PCT} / {POSTS_DAY}]<!-- ENDIF -->
+				<!-- IF POSTS_IN_QUEUE and U_MCP_QUEUE --><br />[<a href="{U_MCP_QUEUE}">{L_POSTS_IN_QUEUE}</a>]<!-- ELSEIF POSTS_IN_QUEUE --><br />[{L_POSTS_IN_QUEUE}]<!-- ENDIF -->
+				<!-- IF S_DISPLAY_SEARCH --><br /><a href="{U_SEARCH_USER}">{L_SEARCH_USER_POSTS}</a><!-- ENDIF --></span></td>
+			</tr>
+			<!-- IF S_SHOW_ACTIVITY -->
+				<tr>
+					<td class="gen" align="{S_CONTENT_FLOW_END}" valign="top" nowrap="nowrap">{L_ACTIVE_IN_FORUM}: </td>
+					<td><!-- IF ACTIVE_FORUM != '' --><b><a class="gen" href="{U_ACTIVE_FORUM}">{ACTIVE_FORUM}</a></b><br /><span class="genmed">[ {ACTIVE_FORUM_POSTS} / {ACTIVE_FORUM_PCT} ]</span><!-- ELSE --><span class="gen">-</span><!-- ENDIF --></td>
+				</tr>
+				<tr>
+					<td class="gen" align="{S_CONTENT_FLOW_END}" valign="top" nowrap="nowrap">{L_ACTIVE_IN_TOPIC}: </td>
+					<td><!-- IF ACTIVE_TOPIC != '' --><b><a class="gen" href="{U_ACTIVE_TOPIC}">{ACTIVE_TOPIC}</a></b><br /><span class="genmed">[ {ACTIVE_TOPIC_POSTS} / {ACTIVE_TOPIC_PCT} ]</span><!-- ELSE --><span class="gen">-</span><!-- ENDIF --></td>
+				</tr>
+			<!-- ENDIF -->
+			</table>
+		</td>
+	</tr>
+	<tr>
+		<td class="cat" align="center"><h4>{L_CONTACT_USER}</h4></td>
+		<td class="cat" align="center"><h4>{L_ABOUT_USER}</h4></td>
+	</tr>
+	<tr>
+		<td class="row1">
+			<table width="100%" cellspacing="1" cellpadding="2" border="0">
+			<tr>
+				<td class="gen" align="{S_CONTENT_FLOW_END}" nowrap="nowrap">{L_EMAIL_ADDRESS}: </td>
+				<td width="100%"><!-- IF U_EMAIL --><a href="{U_EMAIL}">{EMAIL_IMG}</a><!-- ENDIF --></td>
+			</tr>
+			<!-- IF U_PM -->
+				<tr>
+					<td class="gen" nowrap="nowrap" align="{S_CONTENT_FLOW_END}">{L_PM}: </td>
+					<td><a href="{U_PM}">{PM_IMG}</a></td>
+				</tr>
+			<!-- ENDIF -->
+			<tr>
+				<td class="gen" nowrap="nowrap" align="{S_CONTENT_FLOW_END}">{L_MSNM}: </td>
+				<td><!-- IF U_MSN --><a href="{U_MSN}" onclick="popup(this.href, 550, 320); return false">{MSN_IMG}</a><!-- ELSEIF USER_MSN -->{USER_MSN}<!-- ENDIF --></td>
+			</tr>
+			<tr>
+				<td class="gen" nowrap="nowrap" align="{S_CONTENT_FLOW_END}">{L_YIM}: </td>
+				<td><!-- IF U_YIM --><a href="{U_YIM}" onclick="popup(this.href, 780, 550); return false">{YIM_IMG}</a><!-- ELSEIF USER_YIM -->{USER_YIM}<!-- ENDIF --></td>
+			</tr>
+			<tr>
+				<td class="gen" nowrap="nowrap" align="{S_CONTENT_FLOW_END}">{L_AIM}: </td>
+				<td><!-- IF U_AIM --><a href="{U_AIM}" onclick="popup(this.href, 550, 320); return false">{AIM_IMG}</a><!-- ELSEIF USER_AIM -->{USER_AIM}<!-- ENDIF --></td>
+			</tr>
+			<tr>
+				<td class="gen" nowrap="nowrap" align="{S_CONTENT_FLOW_END}">{L_ICQ}: </td>
+				<td><!-- IF U_ICQ --><a href="{U_ICQ}" onclick="popup(this.href, 550, 320); return false">{ICQ_IMG}</a><!-- ELSEIF USER_ICQ -->{USER_ICQ}<!-- ENDIF --></td>
+			</tr>
+			<tr>
+				<td class="gen" nowrap="nowrap" align="{S_CONTENT_FLOW_END}">{L_JABBER}: </td>
+				<td><!-- IF U_JABBER --><a href="{U_JABBER}" onclick="popup(this.href, 550, 320); return false">{JABBER_IMG}</a><!-- ELSEIF USER_JABBER -->{USER_JABBER_IMG}<!-- ENDIF --></td>
+			</tr>
+			</table>
+		</td>
+		<td class="row1">
+			<table cellspacing="1" cellpadding="2" border="0">
+			<tr>
+				<td class="gen" align="{S_CONTENT_FLOW_END}" nowrap="nowrap">{L_USERGROUPS}: </td>
+				<td><select name="g">{S_GROUP_OPTIONS}</select> <input class="btnlite" type="submit" name="submit" value="{L_GO}" /></td>
+			</tr>
+			<tr>
+				<td class="gen" align="{S_CONTENT_FLOW_END}" nowrap="nowrap">{L_LOCATION}: </td>
+				<td><!-- IF LOCATION --><b class="genmed">{LOCATION}</b><!-- ENDIF --></td>
+			</tr>
+			<!-- IF AGE !== '' -->
+			<tr>
+				<td class="gen" align="{S_CONTENT_FLOW_END}" nowrap="nowrap">{L_AGE}: </td>
+				<td><b class="genmed">{AGE}</b></td>
+			</tr>
+			<!-- ENDIF -->
+			<tr>
+				<td class="gen" align="{S_CONTENT_FLOW_END}" nowrap="nowrap">{L_OCCUPATION}: </td>
+				<td><!-- IF OCCUPATION --><b class="genmed">{OCCUPATION}</b><!-- ENDIF --></td>
+			</tr>
+			<tr>
+				<td class="gen" align="{S_CONTENT_FLOW_END}" nowrap="nowrap">{L_INTERESTS}: </td>
+				<td><!-- IF INTERESTS --><b class="genmed">{INTERESTS}</b><!-- ENDIF --></td>
+			</tr>
+			<tr>
+				<td class="gen" align="{S_CONTENT_FLOW_END}" nowrap="nowrap">{L_WEBSITE}: </td>
+				<td><!-- IF U_WWW --><b><a class="genmed" href="{U_WWW}">{U_WWW}</a></b><!-- ENDIF --></td>
+			</tr>
+			<!-- IF S_PROFILE_FIELD1 -->
+				<!-- Use a construct like this to include admin defined profile fields. Replace FIELD1 with the name of your field. -->
+				<tr>
+					<td class="gen" align="{S_CONTENT_FLOW_END}" nowrap="nowrap">{PROFILE_FIELD1_NAME}: </td>
+					<td><b class="genmed">{PROFILE_FIELD1_VALUE}</b></td>
+				</tr>
+			<!-- ENDIF -->
+			<!-- BEGIN custom_fields -->
+				<tr>
+					<td class="gen" align="{S_CONTENT_FLOW_END}" nowrap="nowrap">{custom_fields.PROFILE_FIELD_NAME}: </td>
+					<td><b class="genmed">{custom_fields.PROFILE_FIELD_VALUE}</b></td>
+				</tr>
+			<!-- END custom_fields -->
+			</table>
+		</td>
+	</tr>
+	<!-- IF SIGNATURE -->
+		<tr>
+			<td class="cat" colspan="2" align="center"><h4>{L_SIGNATURE}</h4></td>
+		</tr>
+		<tr>
+			<td class="row1" colspan="2"><div class="postbody" style="padding: 10px;">{SIGNATURE}</div></td>
+		</tr>
+	<!-- ENDIF -->
+	</table>
+
+	</form>
+
+</div>
+
+<br clear="all" />
+
+<!-- INCLUDE breadcrumbs.html -->
+
+<br clear="all" />
+
+<div style="float: {S_CONTENT_FLOW_END};"><!-- INCLUDE jumpbox.html --></div>
+
+<!-- INCLUDE overall_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/message_body.html phpbb/styles/spring/template/message_body.html
--- phpBB-3.0.10/styles/spring/template/message_body.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/message_body.html	2014-04-15 14:31:18.710429005 +0200
@@ -0,0 +1,16 @@
+<!-- INCLUDE overall_header.html -->
+
+<table class="tablebg" width="100%" cellspacing="1">
+<tr>
+	<th>{MESSAGE_TITLE}</th>
+</tr>
+<tr> 
+	<td class="row1" align="center"><br /><p class="gen">{MESSAGE_TEXT}</p><br /></td>
+</tr>
+</table>
+
+<br clear="all" />
+
+<!-- INCLUDE breadcrumbs.html -->
+
+<!-- INCLUDE overall_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/overall_footer.html phpbb/styles/spring/template/overall_footer.html
--- phpBB-3.0.10/styles/spring/template/overall_footer.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/overall_footer.html	2014-04-15 14:31:18.711429005 +0200
@@ -0,0 +1,21 @@
+<!-- IF not S_IS_BOT -->{RUN_CRON_TASK}<!-- ENDIF -->
+</div>
+
+<div id="wrapfooter">
+	<!-- IF U_ACP --><span class="gensmall">[ <a href="{U_ACP}">{L_ACP}</a> ]</span><br /><br /><!-- ENDIF -->
+	<span class="copyright">Powered by <a href="http://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Group
+	<!-- IF TRANSLATION_INFO --><br />{TRANSLATION_INFO}<!-- ENDIF -->
+	<!-- IF DEBUG_OUTPUT --><br /><bdo dir="ltr">[ {DEBUG_OUTPUT} ]</bdo><!-- ENDIF --></span>
+</div>
+
+</td>
+<td bgcolor="#20292E" class="headertd"><img src="/images/pixel.gif" height="10" width="1" alt="" /><br /></td>
+</tr></table>
+        
+        
+</td></tr>
+
+<!-- INCLUDE ../../../../templates/footer.html -->
+<script type="text/javascript" src="{ROOT_PATH}/mobiquo/tapatalkdetect.js"></script>
+</body>
+</html>
diff -ruN phpBB-3.0.10/styles/spring/template/overall_header.html phpbb/styles/spring/template/overall_header.html
--- phpBB-3.0.10/styles/spring/template/overall_header.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/overall_header.html	2014-04-15 14:31:18.712429005 +0200
@@ -0,0 +1,209 @@
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
+<html xmlns="http://www.w3.org/1999/xhtml" dir="{S_CONTENT_DIRECTION}" lang="{S_USER_LANG}" xml:lang="{S_USER_LANG}">
+<head>
+
+<meta http-equiv="content-type" content="text/html; charset={S_CONTENT_ENCODING}" />
+<meta http-equiv="content-language" content="{S_USER_LANG}" />
+<meta http-equiv="content-style-type" content="text/css" />
+<meta http-equiv="imagetoolbar" content="no" />
+<meta name="resource-type" content="document" />
+<meta name="distribution" content="global" />
+<meta name="keywords" content="" />
+<meta name="description" content="" />
+{META}
+<title>{SITENAME} &bull; <!-- IF S_IN_MCP -->{L_MCP} &bull; <!-- ELSEIF S_IN_UCP -->{L_UCP} &bull; <!-- ENDIF -->{PAGE_TITLE}</title>
+
+<!-- IF S_ENABLE_FEEDS -->
+	<!-- IF S_ENABLE_FEEDS_OVERALL --><link rel="alternate" type="application/atom+xml" title="{L_FEED} - {SITENAME}" href="{U_FEED}" /><!-- ENDIF -->
+	<!-- IF S_ENABLE_FEEDS_NEWS --><link rel="alternate" type="application/atom+xml" title="{L_FEED} - {L_FEED_NEWS}" href="{U_FEED}?mode=news" /><!-- ENDIF -->
+	<!-- IF S_ENABLE_FEEDS_FORUMS --><link rel="alternate" type="application/atom+xml" title="{L_FEED} - {L_ALL_FORUMS}" href="{U_FEED}?mode=forums" /><!-- ENDIF -->
+	<!-- IF S_ENABLE_FEEDS_TOPICS --><link rel="alternate" type="application/atom+xml" title="{L_FEED} - {L_FEED_TOPICS_NEW}" href="{U_FEED}?mode=topics" /><!-- ENDIF -->
+	<!-- IF S_ENABLE_FEEDS_TOPICS_ACTIVE --><link rel="alternate" type="application/atom+xml" title="{L_FEED} - {L_FEED_TOPICS_ACTIVE}" href="{U_FEED}?mode=topics_active" /><!-- ENDIF -->
+	<!-- IF S_ENABLE_FEEDS_FORUM and S_FORUM_ID --><link rel="alternate" type="application/atom+xml" title="{L_FEED} - {L_FORUM} - {FORUM_NAME}" href="{U_FEED}?f={S_FORUM_ID}" /><!-- ENDIF -->
+	<!-- IF S_ENABLE_FEEDS_TOPIC and S_TOPIC_ID --><link rel="alternate" type="application/atom+xml" title="{L_FEED} - {L_TOPIC} - {TOPIC_TITLE}" href="{U_FEED}?f={S_FORUM_ID}&amp;t={S_TOPIC_ID}" /><!-- ENDIF -->
+<!-- ENDIF -->
+
+<link rel="stylesheet" href="{T_STYLESHEET_LINK}" type="text/css" />
+<link rel="stylesheet" href="/stylesv1.css" type="text/css" />
+
+<script type="text/javascript">
+// <![CDATA[
+<!-- IF S_USER_PM_POPUP and S_NEW_PM -->
+	popup('{UA_POPUP_PM}', 400, 225, '_phpbbprivmsg');
+<!-- ENDIF -->
+
+function popup(url, width, height, name)
+{
+	if (!name)
+	{
+		name = '_popup';
+	}
+
+	window.open(url.replace(/&amp;/g, '&'), name, 'height=' + height + ',resizable=yes,scrollbars=yes,width=' + width);
+	return false;
+}
+
+function jumpto()
+{
+	var page = prompt('{LA_JUMP_PAGE}:', '{ON_PAGE}');
+	var per_page = '{PER_PAGE}';
+	var base_url = '{A_BASE_URL}';
+
+	if (page !== null && !isNaN(page) && page == Math.floor(page) && page > 0)
+	{
+		if (base_url.indexOf('?') == -1)
+		{
+			document.location.href = base_url + '?start=' + ((page - 1) * per_page);
+		}
+		else
+		{
+			document.location.href = base_url.replace(/&amp;/g, '&') + '&start=' + ((page - 1) * per_page);
+		}
+	}
+}
+
+/**
+* Find a member
+*/
+function find_username(url)
+{
+	popup(url, 760, 570, '_usersearch');
+	return false;
+}
+
+/**
+* Mark/unmark checklist
+* id = ID of parent container, name = name prefix, state = state [true/false]
+*/
+function marklist(id, name, state)
+{
+	var parent = document.getElementById(id);
+	if (!parent)
+	{
+		eval('parent = document.' + id);
+	}
+
+	if (!parent)
+	{
+		return;
+	}
+
+	var rb = parent.getElementsByTagName('input');
+	
+	for (var r = 0; r < rb.length; r++)
+	{
+		if (rb[r].name.substr(0, name.length) == name)
+		{
+			rb[r].checked = state;
+		}
+	}
+}
+
+<!-- IF ._file -->
+
+	/**
+	* Play quicktime file by determining it's width/height
+	* from the displayed rectangle area
+	*
+	* Only defined if there is a file block present.
+	*/
+	function play_qt_file(obj)
+	{
+		var rectangle = obj.GetRectangle();
+
+		if (rectangle)
+		{
+			rectangle = rectangle.split(',')
+			var x1 = parseInt(rectangle[0]);
+			var x2 = parseInt(rectangle[2]);
+			var y1 = parseInt(rectangle[1]);
+			var y2 = parseInt(rectangle[3]);
+
+			var width = (x1 < 0) ? (x1 * -1) + x2 : x2 - x1;
+			var height = (y1 < 0) ? (y1 * -1) + y2 : y2 - y1;
+		}
+		else
+		{
+			var width = 200;
+			var height = 0;
+		}
+
+		obj.width = width;
+		obj.height = height + 16;
+
+		obj.SetControllerVisible(true);
+
+		obj.Play();
+	}
+<!-- ENDIF -->
+
+// ]]>
+</script>
+</head>
+<body class="{S_CONTENT_DIRECTION}">
+
+<!-- INCLUDE ../../../../templates/header.html -->
+
+<tr><td class="headertd">
+<table border="0" cellpadding="0" cellspacing="0" width="100%">
+<tr><td bgcolor="#20292E" class="headertd"><img src="/images/pixel.gif" height="10" width="1" alt=""/><br /></td>
+<td bgcolor="#C8D2DA" width="100%" class="headertd"> <!-- 4C626F -->
+
+<a name="top"></a>
+
+<div id="wrapheader">
+
+<!--	<div id="logodesc">
+		<table width="100%" cellspacing="0">
+		<tr>
+			<td><a href="{U_INDEX}">{SITE_LOGO_IMG}</a></td>
+			<td width="100%" align="center"><h1>{SITENAME}</h1><span class="gen">{SITE_DESCRIPTION}</span></td>
+		</tr>
+		</table>
+	</div> -->
+
+	<div id="menubar">
+		<table width="100%" cellspacing="0">
+		<tr>
+			<td class="genmed">
+				<!-- IF not S_IS_BOT --><a href="{U_LOGIN_LOGOUT}"><img src="{T_THEME_PATH}/images/icon_mini_login.gif" width="12" height="13" alt="*" /> {L_LOGIN_LOGOUT}</a>&nbsp;<!-- ENDIF -->
+				<!-- IF U_RESTORE_PERMISSIONS --> &nbsp;<a href="{U_RESTORE_PERMISSIONS}"><img src="{T_THEME_PATH}/images/icon_mini_login.gif" width="12" height="13" alt="*" /> {L_RESTORE_PERMISSIONS}</a><!-- ENDIF -->
+				<!-- IF S_BOARD_DISABLED and S_USER_LOGGED_IN --> &nbsp;<span style="color: red;">{L_BOARD_DISABLED}</span><!-- ENDIF -->
+				<!-- IF not S_IS_BOT -->
+					<!-- IF S_USER_LOGGED_IN -->
+						<!-- IF S_DISPLAY_PM --> &nbsp;<a href="{U_PRIVATEMSGS}"><img src="{T_THEME_PATH}/images/icon_mini_message.gif" width="12" height="13" alt="*" /> {PRIVATE_MESSAGE_INFO}<!-- IF PRIVATE_MESSAGE_INFO_UNREAD -->, {PRIVATE_MESSAGE_INFO_UNREAD}<!-- ENDIF --></a><!-- ENDIF -->
+					<!-- ELSEIF S_REGISTER_ENABLED and not (S_SHOW_COPPA or S_REGISTRATION) --> &nbsp;<a href="{U_REGISTER}"><img src="{T_THEME_PATH}/images/icon_mini_register.gif" width="12" height="13" alt="*" /> {L_REGISTER}</a>
+					<!-- ENDIF -->
+				<!-- ENDIF -->
+			</td>
+			<td class="genmed" align="{S_CONTENT_FLOW_END}">
+				<a href="{U_FAQ}"><img src="{T_THEME_PATH}/images/icon_mini_faq.gif" width="12" height="13" alt="*" /> {L_FAQ}</a>
+				<!-- IF S_DISPLAY_SEARCH -->&nbsp; &nbsp;<a href="{U_SEARCH}"><img src="{T_THEME_PATH}/images/icon_mini_search.gif" width="12" height="13" alt="*" /> {L_SEARCH}</a><!-- ENDIF -->
+				<!-- IF not S_IS_BOT -->
+					<!-- IF S_DISPLAY_MEMBERLIST -->&nbsp; &nbsp;<a href="{U_MEMBERLIST}"><img src="{T_THEME_PATH}/images/icon_mini_members.gif" width="12" height="13" alt="*" /> {L_MEMBERLIST}</a><!-- ENDIF -->
+					<!-- IF S_USER_LOGGED_IN -->&nbsp; &nbsp;<a href="{U_PROFILE}"><img src="{T_THEME_PATH}/images/icon_mini_profile.gif" width="12" height="13" alt="*" /> {L_PROFILE}</a><!-- ENDIF -->
+				<!-- ENDIF -->
+			</td>
+		</tr>
+
+		</table>
+	</div>
+
+</div>
+
+<div id="wrapcentre">
+
+	<!-- IF S_DISPLAY_SEARCH -->
+	<p class="searchbar">
+		<span style="float: {S_CONTENT_FLOW_BEGIN};"><a href="{U_SEARCH_UNANSWERED}">{L_SEARCH_UNANSWERED}</a> | <a href="{U_SEARCH_ACTIVE_TOPICS}">{L_SEARCH_ACTIVE_TOPICS}</a></span>
+		<!-- IF S_USER_LOGGED_IN or S_LOAD_UNREADS -->
+		<span style="float: {S_CONTENT_FLOW_END};"><!-- IF S_LOAD_UNREADS --><a href="{U_SEARCH_UNREAD}">{L_SEARCH_UNREAD}</a><!-- IF S_USER_LOGGED_IN --> | <!-- ENDIF --><!-- ENDIF --><!-- IF S_USER_LOGGED_IN --><a href="{U_SEARCH_NEW}">{L_SEARCH_NEW}</a> | <a href="{U_SEARCH_SELF}">{L_SEARCH_SELF}</a><!-- ENDIF --></span>
+		<!-- ENDIF -->
+	</p>
+	<!-- ENDIF -->
+
+	<br style="clear: both;" /><br />
+
+	<!-- INCLUDE breadcrumbs.html -->
+
+	<br />
diff -ruN phpBB-3.0.10/styles/spring/template/pagination.html phpbb/styles/spring/template/pagination.html
--- phpBB-3.0.10/styles/spring/template/pagination.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/pagination.html	2014-04-15 14:31:18.713429005 +0200
@@ -0,0 +1 @@
+<!-- IF PAGINATION --><b><a href="#" onclick="jumpto(); return false;" title="{L_JUMP_TO_PAGE}">{L_GOTO_PAGE}</a> <!-- IF PREVIOUS_PAGE --><a href="{PREVIOUS_PAGE}">{L_PREVIOUS}</a>&nbsp;&nbsp;<!-- ENDIF -->{PAGINATION}<!-- IF NEXT_PAGE --> &nbsp;<a href="{NEXT_PAGE}">{L_NEXT}</a><!-- ENDIF --></b><!-- ENDIF -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/posting_attach_body.html phpbb/styles/spring/template/posting_attach_body.html
--- phpBB-3.0.10/styles/spring/template/posting_attach_body.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/posting_attach_body.html	2014-04-15 14:31:18.714429005 +0200
@@ -0,0 +1,83 @@
+<tr>
+	<th colspan="2">
+		<script type="text/javascript">
+		// <![CDATA[
+			/**
+			* Show upload progress bar
+			*/
+			function popup_progress_bar()
+			{
+				close_waitscreen = 0;
+				// no scrollbars
+				popup('{UA_PROGRESS_BAR}', 400, 200, '_upload');
+			}
+		// ]]>
+		</script>
+
+		<!-- IF S_CLOSE_PROGRESS_WINDOW -->
+			<script type="text/javascript">
+			// <![CDATA[
+				close_waitscreen = 1;
+			// ]]>
+			</script>
+		<!-- ENDIF -->
+
+		{L_ADD_ATTACHMENT}
+	</th>
+</tr>
+<tr>
+	<td class="row3" colspan="2"><span class="gensmall">{L_ADD_ATTACHMENT_EXPLAIN}</span></td>
+</tr>
+
+<tr> 
+	<td class="row1"><b class="genmed">{L_FILENAME}</b></td> 
+	<td class="row2"><input type="file" name="fileupload" size="40" maxlength="{FILESIZE}" value="" class="btnfile" /></td> 
+</tr> 
+<tr> 
+	<td class="row1"><b class="genmed">{L_FILE_COMMENT}</b></td> 
+	<td class="row2">
+		<table border="0" cellspacing="0" cellpadding="2">
+		<tr>
+			<td><textarea class="post" name="filecomment" rows="3" cols="35">{FILE_COMMENT}</textarea>&nbsp;</td>
+			<td valign="top">
+				<table border="0" cellspacing="4" cellpadding="0">
+				<tr>
+					<td><input class="btnlite" type="submit" style="width:150px" name="add_file" value="{L_ADD_FILE}" onclick="popup_progress_bar();" /></td>
+				</tr>
+				</table>
+			</td>
+		</tr>
+		</table>
+	</td>
+</tr> 
+
+<!-- IF S_HAS_ATTACHMENTS -->
+	<tr>
+		<th colspan="2">{L_POSTED_ATTACHMENTS}</th>
+	</tr>
+
+	<!-- BEGIN attach_row -->
+		<tr>
+			<td class="row1"><b class="genmed">{L_FILENAME}</b></td>
+			<td class="row2"><a class="genmed" href="{attach_row.U_VIEW_ATTACHMENT}" target="_blank">{attach_row.FILENAME}</a></td> 
+		</tr>
+		<tr> 
+			<td class="row1"><b class="genmed">{L_FILE_COMMENT}</b></td> 
+			<td class="row2">{attach_row.S_HIDDEN}
+				<table border="0" cellspacing="0" cellpadding="2">
+				<tr>
+					<td><textarea class="post" name="comment_list[{attach_row.ASSOC_INDEX}]" rows="3" cols="35" wrap="virtual">{attach_row.FILE_COMMENT}</textarea>&nbsp;</td>
+					<td valign="top">
+						<table border="0" cellspacing="4" cellpadding="0">
+						<tr>
+							<td><input class="btnlite" type="submit" style="width:150px" name="delete_file[{attach_row.ASSOC_INDEX}]" value="{L_DELETE_FILE}" /></td>
+						</tr>
+						</table>
+					</td>
+				</tr>
+				</table>
+			</td>
+		</tr>
+	<!-- END attach_row -->
+
+<!-- ENDIF -->
diff -ruN phpBB-3.0.10/styles/spring/template/posting_body.html phpbb/styles/spring/template/posting_body.html
--- phpBB-3.0.10/styles/spring/template/posting_body.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/posting_body.html	2014-04-15 14:31:18.716429005 +0200
@@ -0,0 +1,413 @@
+<!-- IF S_PRIVMSGS -->
+	<!-- INCLUDE ucp_header.html -->
+<!-- ELSE -->
+	<!-- INCLUDE overall_header.html -->
+<!-- ENDIF -->
+
+<!-- IF S_FORUM_RULES -->
+	<div class="forumrules">
+		<!-- IF U_FORUM_RULES -->
+			<h3>{L_FORUM_RULES}</h3><br />
+			<a href="{U_FORUM_RULES}"><b>{L_FORUM_RULES_LINK}</b></a>
+		<!-- ELSE -->
+			<h3>{L_FORUM_RULES}</h3><br />
+			{FORUM_RULES}
+		<!-- ENDIF -->
+	</div>
+
+	<br clear="all" />
+<!-- ENDIF -->
+
+<!-- IF not S_PRIVMSGS -->
+	<div id="pageheader">
+		<h2><!-- IF TOPIC_TITLE --><a class="titles" href="{U_VIEW_TOPIC}">{TOPIC_TITLE}</a><!-- ELSE --><a class="titles" href="{U_VIEW_FORUM}">{FORUM_NAME}</a><!-- ENDIF --></h2>
+
+		<!-- IF MODERATORS -->
+			<p class="moderators">{L_MODERATORS}: {MODERATORS}</p>
+		<!-- ENDIF -->
+		<!-- IF U_MCP -->
+			<p class="linkmcp">[ <a href="{U_MCP}">{L_MCP}</a> ]</p>
+		<!-- ENDIF -->
+	</div>
+
+	<br clear="all" /><br />
+<!-- ENDIF -->
+
+<!-- IF not S_SHOW_PM_BOX -->
+	<form action="{S_POST_ACTION}" method="post" name="postform"{S_FORM_ENCTYPE}>
+<!-- ENDIF -->
+
+<!-- IF S_DRAFT_LOADED -->
+	<table class="tablebg" width="100%" cellspacing="1">
+	<tr>
+		<th align="center">{L_INFORMATION}</th>
+	</tr>
+	<tr>
+		<td class="row1" align="center"><span class="gen"><!-- IF S_PRIVMSGS -->{L_DRAFT_LOADED_PM}<!-- ELSE -->{L_DRAFT_LOADED}<!-- ENDIF --></span></td>
+	</tr>
+	</table>
+
+	<br clear="all" />
+<!-- ENDIF -->
+
+<!-- IF S_SHOW_DRAFTS -->
+	<table class="tablebg" width="100%" cellspacing="1">
+	<tr>
+		<th colspan="3" align="center">{L_LOAD_DRAFT}</th>
+	</tr>
+	<tr>
+		<td class="row1" colspan="3" align="center"><span class="gen">{L_LOAD_DRAFT_EXPLAIN}</span></td>
+	</tr>
+	<tr>
+		<th>{L_SAVE_DATE}</th>
+		<th>{L_DRAFT_TITLE}</th>
+		<th>{L_OPTIONS}</th>
+	</tr>
+	<!-- BEGIN draftrow -->
+
+		<!-- IF draftrow.S_ROW_COUNT is even --><tr class="row1"><!-- ELSE --><tr class="row2"><!-- ENDIF -->
+
+		<td class="postdetails" style="padding: 4px;">{draftrow.DATE}</td>
+		<td style="padding: 4px;"><b class="gen">{draftrow.DRAFT_SUBJECT}</b>
+			<!-- IF draftrow.S_LINK_TOPIC --><br /><span class="gensmall">{L_TOPIC}: <a href="{draftrow.U_VIEW}">{draftrow.TITLE}</a></span>
+			<!-- ELSEIF draftrow.S_LINK_FORUM --><br /><span class="gensmall">{L_FORUM}: <a href="{draftrow.U_VIEW}">{draftrow.TITLE}</a></span>
+			<!-- ELSEIF draftrow.S_LINK_PM --><br /><span class="gensmall">{L_PRIVATE_MESSAGE}</span>
+			<!-- ELSE --><br /><span class="gensmall">{L_NO_TOPIC_FORUM}</span><!-- ENDIF -->
+		</td>
+		<td style="padding: 4px;" align="center"><span class="gen"><a href="{draftrow.U_INSERT}">{L_LOAD_DRAFT}</a></span></td>
+	</tr>
+	<!-- END draftrow -->
+	</table>
+
+	<br clear="all" />
+<!-- ENDIF -->
+
+
+<!-- IF S_POST_REVIEW --><!-- INCLUDE posting_review.html --><!-- ENDIF -->
+<!-- IF S_DISPLAY_PREVIEW --><!-- INCLUDE posting_preview.html --><!-- ENDIF -->
+
+
+<!-- IF not S_PRIVMSGS and S_UNGLOBALISE -->
+	<table class="tablebg" width="100%" cellspacing="1">
+	<tr>
+		<th>{L_MOVE}</th>
+	</tr>
+	<tr>
+		<td class="spacer" colspan="2"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
+	</tr>
+	<tr>
+		<td class="row2" align="center"><span class="gen">{L_UNGLOBALISE_EXPLAIN}<br /><br />{L_SELECT_DESTINATION_FORUM}&nbsp;&nbsp;</span><select name="to_forum_id">{S_FORUM_SELECT}</select><br /><br /><input class="btnmain" type="submit" name="post" value="{L_CONFIRM}" />&nbsp;&nbsp; <input class="btnlite" type="submit" name="cancel_unglobalise" value="{L_CANCEL}" /></td>
+	</tr>
+	</table>
+
+	<br clear="all" />
+<!-- ENDIF -->
+
+<table class="tablebg" width="100%" cellspacing="1">
+<tr>
+	<th colspan="2"><b>{L_POST_A}</b></th>
+</tr>
+
+<!-- IF ERROR -->
+	<tr>
+		<td class="row2" colspan="2" align="center"><span class="genmed error">{ERROR}</span></td>
+	</tr>
+<!-- ENDIF -->
+
+<!-- IF S_DELETE_ALLOWED -->
+	<tr>
+		<td class="row1"><b class="genmed">{L_DELETE_POST}:</b></td>
+		<td class="row2"><input type="checkbox" class="radio" name="delete" /> <span class="gensmall">[ {L_DELETE_POST_WARN} ]</span></td>
+	</tr>
+<!-- ENDIF -->
+
+<!-- IF S_SHOW_TOPIC_ICONS or S_SHOW_PM_ICONS -->
+	<tr>
+		<td class="row1"><b class="genmed">{L_ICON}:</b></td>
+		<td class="row2">
+			<table width="100%" cellspacing="0" cellpadding="0" border="0">
+			<tr>
+				<td><input type="radio" class="radio" name="icon" value="0"{S_NO_ICON_CHECKED} /><span class="genmed"><!-- IF S_SHOW_TOPIC_ICONS -->{L_NO_TOPIC_ICON}<!-- ELSE -->{L_NO_PM_ICON}<!-- ENDIF --></span> <!-- BEGIN topic_icon --><span style="white-space: nowrap;"><input type="radio" class="radio" name="icon" value="{topic_icon.ICON_ID}"{topic_icon.S_ICON_CHECKED} /><img src="{topic_icon.ICON_IMG}" width="{topic_icon.ICON_WIDTH}" height="{topic_icon.ICON_HEIGHT}" alt="" title="" hspace="2" vspace="2" /></span> <!-- END topic_icon --></td>
+			</tr>
+			</table>
+		</td>
+	</tr>
+<!-- ENDIF -->
+
+<!-- IF not S_PRIVMSGS and S_DISPLAY_USERNAME -->
+	<tr>
+		<td class="row1"><b class="genmed">{L_USERNAME}:</b></td>
+		<td class="row2"><input class="post" type="text" tabindex="1" name="username" size="25" value="{USERNAME}" /></td>
+	</tr>
+<!-- ENDIF -->
+
+<!-- IF S_PRIVMSGS -->
+	<tr>
+		<td class="row1"><b class="genmed">{L_TO}:</b></td>
+		<td class="row2">
+			{S_HIDDEN_ADDRESS_FIELD}
+		<!-- BEGIN to_recipient -->
+			<span style="display: block; float: {S_CONTENT_FLOW_BEGIN};" class="nowrap genmed"><strong>
+			<!-- IF to_recipient.IS_GROUP --><a href="{to_recipient.U_VIEW}"><span class="sep">{to_recipient.NAME}</span></a><!-- ELSE -->{to_recipient.NAME_FULL}<!-- ENDIF --></strong>&nbsp;<!-- IF not S_EDIT_POST --><input class="post" type="submit" name="remove_{to_recipient.TYPE}[{to_recipient.UG_ID}]" value="{L_REMOVE}" />&nbsp;<!-- ENDIF -->
+			</span>
+		<!-- BEGINELSE -->
+			<span class="genmed">{L_NO_TO_RECIPIENT}</span>
+		<!-- END to_recipient -->
+		</td>
+	</tr>
+	<!-- IF S_ALLOW_MASS_PM -->
+	<tr>
+		<td class="row1"><b class="genmed">{L_BCC}:</b></td>
+		<td class="row2">
+		<!-- BEGIN bcc_recipient -->
+			<span class="genmed nowrap"><strong>
+			<!-- IF bcc_recipient.IS_GROUP --><a href="{bcc_recipient.U_VIEW}"><span class="sep">{bcc_recipient.NAME}</span></a><!-- ELSE -->{bcc_recipient.NAME_FULL}<!-- ENDIF --></strong>&nbsp;<!-- IF not S_EDIT_POST --><input class="post" type="submit" name="remove_{bcc_recipient.TYPE}[{bcc_recipient.UG_ID}]" value="{L_REMOVE}" />&nbsp;<!-- ENDIF -->
+			</span>
+		<!-- BEGINELSE -->
+			<span class="genmed">{L_NO_BCC_RECIPIENT}</span>
+		<!-- END bcc_recipient -->
+		</td>
+	</tr>
+	<!-- ENDIF -->
+<!-- ENDIF -->
+
+<tr>
+	<td class="row1" width="22%"><b class="genmed">{L_SUBJECT}:</b></td>
+	<td class="row2" width="78%"><input class="post" style="width:450px" type="text" name="subject" size="45" maxlength="<!-- IF S_NEW_MESSAGE -->60<!-- ELSE -->64<!-- ENDIF -->" tabindex="2" value="{SUBJECT}" /></td>
+</tr>
+<tr>
+	<td class="row1" valign="top"><b class="genmed">{L_MESSAGE_BODY}:</b><br /><span class="gensmall">{L_MESSAGE_BODY_EXPLAIN}&nbsp;</span><br /><br />
+	<!-- IF S_SMILIES_ALLOWED -->
+		<table width="100%" cellspacing="5" cellpadding="0" border="0" align="center">
+		<tr>
+			<td class="gensmall" align="center"><b>{L_SMILIES}</b></td>
+		</tr>
+		<tr>
+			<td align="center">
+				<!-- BEGIN smiley -->
+					<a href="#" onclick="insert_text('{smiley.A_SMILEY_CODE}', true); return false;" style="line-height: 20px;"><img src="{smiley.SMILEY_IMG}" width="{smiley.SMILEY_WIDTH}" height="{smiley.SMILEY_HEIGHT}" alt="{smiley.SMILEY_CODE}" title="{smiley.SMILEY_DESC}" hspace="2" vspace="2" /></a>
+				<!-- END smiley -->
+			</td>
+		</tr>
+
+		<!-- IF S_SHOW_SMILEY_LINK -->
+			<tr>
+				<td align="center"><a class="nav" href="{U_MORE_SMILIES}" onclick="popup(this.href, 300, 350, '_phpbbsmilies'); return false;">{L_MORE_SMILIES}</a></td>
+			</tr>
+		<!-- ENDIF -->
+
+		</table>
+	<!-- ENDIF -->
+	</td>
+	<td class="row2" valign="top">
+		<script type="text/javascript">
+		// <![CDATA[
+			var form_name = 'postform';
+			var text_name = 'message';
+		// ]]>
+		</script>
+
+		<table width="100%" cellspacing="0" cellpadding="0" border="0">
+		<!-- INCLUDE posting_buttons.html -->
+		<tr>
+			<td valign="top" style="width: 100%;"><textarea name="message" rows="15" cols="76" tabindex="3" onselect="storeCaret(this);" onclick="storeCaret(this);" onkeyup="storeCaret(this);" onfocus="initInsertions();" style="width: 98%; height: 270px;">{MESSAGE}</textarea></td>
+			<!-- IF S_BBCODE_ALLOWED -->
+			<td width="80" align="center" valign="top">
+				<script type="text/javascript">
+				// <![CDATA[
+					colorPalette('v', 7, 6)
+				// ]]>
+				</script>
+			</td>
+			<!-- ENDIF -->
+	 	</tr>
+		</table>
+	</td>
+</tr>
+
+<!-- IF S_INLINE_ATTACHMENT_OPTIONS -->
+	<tr>
+		<td class="row1"><b class="genmed">{L_ATTACHMENTS}:</b></td>
+		<td class="row2"><select name="attachments">{S_INLINE_ATTACHMENT_OPTIONS}</select>&nbsp;<input type="button" class="btnbbcode" accesskey="a" value="{L_PLACE_INLINE}" name="attachinline" onclick="attach_form = document.forms[form_name].elements['attachments']; attach_inline(attach_form.value, attach_form.options[attach_form.selectedIndex].text);" onmouseover="helpline('a')" onmouseout="helpline('tip')" />
+		</td>
+	</tr>
+<!-- ENDIF -->
+
+<tr>
+	<td class="row1" valign="top"><b class="genmed">{L_OPTIONS}:</b><br />
+		<table cellspacing="2" cellpadding="0" border="0">
+		<tr>
+			<td class="gensmall">{BBCODE_STATUS}</td>
+		</tr>
+		<!-- IF S_BBCODE_ALLOWED -->
+		<tr>
+			<td class="gensmall">{IMG_STATUS}</td>
+		</tr>
+		<tr>
+			<td class="gensmall">{FLASH_STATUS}</td>
+		</tr>
+		<tr>
+			<td class="gensmall">{URL_STATUS}</td>
+		</tr>
+		<!-- ENDIF -->
+		<tr>
+			<td class="gensmall">{SMILIES_STATUS}</td>
+		</tr>
+		</table>
+	</td>
+	<td class="row2">
+		<table cellpadding="1">
+		<!-- IF S_BBCODE_ALLOWED -->
+			<tr>
+				<td><input type="checkbox" class="radio" name="disable_bbcode"{S_BBCODE_CHECKED} /></td>
+				<td class="gen">{L_DISABLE_BBCODE}</td>
+			</tr>
+		<!-- ENDIF -->
+
+		<!-- IF S_SMILIES_ALLOWED -->
+			<tr>
+				<td><input type="checkbox" class="radio" name="disable_smilies"{S_SMILIES_CHECKED} /></td>
+				<td class="gen">{L_DISABLE_SMILIES}</td>
+			</tr>
+		<!-- ENDIF -->
+
+		<!-- IF S_LINKS_ALLOWED -->
+		<tr>
+			<td><input type="checkbox" class="radio" name="disable_magic_url"{S_MAGIC_URL_CHECKED} /></td>
+			<td class="gen">{L_DISABLE_MAGIC_URL}</td>
+		</tr>
+		<!-- ENDIF -->
+
+		<!-- IF S_SIG_ALLOWED -->
+			<tr>
+				<td><input type="checkbox" class="radio" name="attach_sig"{S_SIGNATURE_CHECKED} /></td>
+				<td class="gen">{L_ATTACH_SIG}</td>
+			</tr>
+		<!-- ENDIF -->
+
+		<!-- IF S_NOTIFY_ALLOWED -->
+			<tr>
+				<td><input type="checkbox" class="radio" name="notify"{S_NOTIFY_CHECKED} /></td>
+				<td class="gen">{L_NOTIFY_REPLY}</td>
+			</tr>
+		<!-- ENDIF -->
+
+		<!-- IF not S_PRIVMSGS -->
+			<!-- IF S_LOCK_TOPIC_ALLOWED -->
+				<tr>
+					<td><input type="checkbox" class="radio" name="lock_topic"{S_LOCK_TOPIC_CHECKED} /></td>
+					<td class="gen">{L_LOCK_TOPIC}</td>
+				</tr>
+			<!-- ENDIF -->
+
+			<!-- IF S_LOCK_POST_ALLOWED -->
+				<tr>
+					<td><input type="checkbox" class="radio" name="lock_post"{S_LOCK_POST_CHECKED} /></td>
+					<td class="gen">{L_LOCK_POST} [{L_LOCK_POST_EXPLAIN}]</td>
+				</tr>
+			<!-- ENDIF -->
+
+			<!-- IF S_TYPE_TOGGLE -->
+				<tr>
+					<td>&nbsp;</td>
+					<td class="gen"><!-- IF S_EDIT_POST -->{L_CHANGE_TOPIC_TO}<!-- ELSE -->{L_POST_TOPIC_AS}<!-- ENDIF -->: <!-- BEGIN topic_type --><input type="radio" class="radio" name="topic_type" value="{topic_type.VALUE}"{topic_type.S_CHECKED} />{topic_type.L_TOPIC_TYPE}&nbsp;&nbsp;<!-- END topic_type --></td>
+				</tr>
+			<!-- ENDIF -->
+		<!-- ENDIF -->
+		</table>
+	</td>
+</tr>
+
+<!-- IF S_TOPIC_TYPE_ANNOUNCE or S_TOPIC_TYPE_STICKY -->
+	<tr>
+		<td class="row1"><b class="genmed">{L_STICK_TOPIC_FOR}:</b><br /><span class="gensmall">{L_STICKY_ANNOUNCE_TIME_LIMIT}</span></td>
+		<td class="row2"><input class="post" type="text" name="topic_time_limit" size="3" maxlength="3" value="{TOPIC_TIME_LIMIT}" />&nbsp;<b class="gen">{L_DAYS}</b> <span class="gensmall">{L_STICK_TOPIC_FOR_EXPLAIN}</span></td>
+	</tr>
+<!-- ENDIF -->
+
+<!-- IF S_EDIT_REASON -->
+	<tr>
+		<td class="row1" valign="top"><b class="genmed">{L_EDIT_REASON}:</b></td>
+		<td class="row2"><input class="post" type="text" name="edit_reason" size="50" value="{EDIT_REASON}" /></td>
+	</tr>
+<!-- ENDIF -->
+
+		<!-- IF CAPTCHA_TEMPLATE and S_CONFIRM_CODE -->
+		<!-- INCLUDE {CAPTCHA_TEMPLATE} -->
+		<!-- ENDIF -->
+
+
+<!-- IF S_SHOW_ATTACH_BOX or S_SHOW_POLL_BOX -->
+	<tr>
+		<td class="cat" colspan="2" align="center">
+			<input class="btnlite" type="submit" tabindex="5" name="preview" value="{L_PREVIEW}" />
+			&nbsp; <input class="btnmain" type="submit" accesskey="s" tabindex="6" name="post" value="{L_SUBMIT}" />
+			<!-- IF S_SAVE_ALLOWED -->&nbsp; <input class="btnlite" type="submit" accesskey="k" tabindex="7" name="save" value="{L_SAVE_DRAFT}" /><!-- ENDIF -->
+			<!-- IF S_HAS_DRAFTS -->&nbsp; <input class="btnlite" type="submit" accesskey="d" tabindex="8" name="load" value="{L_LOAD_DRAFT}" /><!-- ENDIF -->
+			&nbsp; <input class="btnlite" type="submit" accesskey="c" tabindex="9" name="cancel" value="{L_CANCEL}" />
+		</td>
+	</tr>
+
+	<!-- IF S_SHOW_ATTACH_BOX --><!-- INCLUDE posting_attach_body.html --><!-- ENDIF -->
+
+	<!-- IF S_SHOW_POLL_BOX -->
+		<!-- INCLUDE posting_poll_body.html -->
+	<!-- ELSEIF S_POLL_DELETE -->
+		<tr>
+			<td class="row1"><span class="genmed"><b>{L_POLL_DELETE}:</b></span></td>
+			<td class="row2"><input type="checkbox" class="radio" name="poll_delete" /></td>
+		</tr>
+	<!-- ENDIF -->
+<!-- ENDIF -->
+
+<tr>
+	<td class="cat" colspan="2" align="center">{S_HIDDEN_FIELDS}
+		<input class="btnlite" type="submit" tabindex="10" name="preview" value="{L_PREVIEW}" />
+		&nbsp; <input class="btnmain" type="submit" accesskey="s" tabindex="11" name="post" value="{L_SUBMIT}" />
+		<!-- IF not S_SHOW_ATTACH_BOX and not S_SHOW_POLL_BOX -->
+			<!-- IF S_SAVE_ALLOWED -->&nbsp; <input class="btnlite" type="submit" accesskey="k" tabindex="12" name="save" value="{L_SAVE_DRAFT}" /><!-- ENDIF -->
+			<!-- IF S_HAS_DRAFTS -->&nbsp; <input class="btnlite" type="submit" accesskey="d" tabindex="13" name="load" value="{L_LOAD_DRAFT}" /><!-- ENDIF -->
+		<!-- ENDIF -->
+		&nbsp; <input class="btnlite" type="submit" accesskey="c" tabindex="14" name="cancel" value="{L_CANCEL}" />
+	</td>
+</tr>
+</table>
+<!-- IF not S_PRIVMSGS -->
+	{S_FORM_TOKEN}
+	</form>
+<!-- ENDIF -->
+<br clear="all" />
+
+<!-- IF S_DISPLAY_REVIEW --><!-- INCLUDE posting_topic_review.html --><!-- ENDIF -->
+<!-- IF S_DISPLAY_HISTORY --><!-- INCLUDE ucp_pm_history.html --><!-- ENDIF -->
+
+<!-- IF S_PRIVMSGS -->
+	<!-- INCLUDE ucp_footer.html -->
+<!-- ELSE -->
+
+	<!-- INCLUDE breadcrumbs.html -->
+
+
+	<!-- IF S_DISPLAY_ONLINE_LIST -->
+		<br clear="all" />
+
+		<table class="tablebg" width="100%" cellspacing="1">
+		<tr>
+			<td class="cat"><h4>{L_WHO_IS_ONLINE}</h4></td>
+		</tr>
+		<tr>
+			<td class="row1"><span class="gensmall">{LOGGED_IN_USER_LIST}</span></td>
+		</tr>
+		</table>
+	<!-- ENDIF -->
+
+	<br clear="all" />
+
+	<table width="100%" cellspacing="1">
+	<tr>
+		<td align="{S_CONTENT_FLOW_END}"><!-- INCLUDE jumpbox.html --></td>
+	</tr>
+	</table>
+
+	<!-- INCLUDE overall_footer.html -->
+<!-- ENDIF -->
diff -ruN phpBB-3.0.10/styles/spring/template/posting_buttons.html phpbb/styles/spring/template/posting_buttons.html
--- phpBB-3.0.10/styles/spring/template/posting_buttons.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/posting_buttons.html	2014-04-15 14:31:18.716429005 +0200
@@ -0,0 +1,87 @@
+<tr valign="middle" align="{S_CONTENT_FLOW_BEGIN}">
+	<td colspan="2">
+		<script type="text/javascript">
+		// <![CDATA[
+		
+		// Define the bbCode tags
+		var bbcode = new Array();
+		var bbtags = new Array('[b]','[/b]','[i]','[/i]','[u]','[/u]','[quote]','[/quote]','[code]','[/code]','[list]','[/list]','[list=]','[/list]','[img]','[/img]','[url]','[/url]','[flash=]', '[/flash]','[size=]','[/size]'<!-- BEGIN custom_tags -->, {custom_tags.BBCODE_NAME}<!-- END custom_tags -->);
+		var imageTag = false;
+		
+		// Helpline messages
+		var help_line = {
+			b: '{LA_BBCODE_B_HELP}',
+			i: '{LA_BBCODE_I_HELP}',
+			u: '{LA_BBCODE_U_HELP}',
+			q: '{LA_BBCODE_Q_HELP}',
+			c: '{LA_BBCODE_C_HELP}',
+			l: '{LA_BBCODE_L_HELP}',
+			o: '{LA_BBCODE_O_HELP}',
+			p: '{LA_BBCODE_P_HELP}',
+			w: '{LA_BBCODE_W_HELP}',
+			a: '{LA_BBCODE_A_HELP}',
+			s: '{LA_BBCODE_S_HELP}',
+			f: '{LA_BBCODE_F_HELP}',
+			y: '{LA_BBCODE_Y_HELP}',
+			d: '{LA_BBCODE_D_HELP}',
+			tip: '{L_STYLES_TIP}'
+			<!-- BEGIN custom_tags -->
+				,cb_{custom_tags.BBCODE_ID}: '{custom_tags.A_BBCODE_HELPLINE}'
+			<!-- END custom_tags -->
+		}
+
+		// ]]>
+		</script>
+		<script type="text/javascript" src="{T_SUPER_TEMPLATE_PATH}/editor.js"></script>
+
+<!-- IF S_BBCODE_ALLOWED -->
+		<input type="button" class="btnbbcode" accesskey="b" name="addbbcode0" value=" B " style="font-weight:bold; width: 30px;" onclick="bbstyle(0)" onmouseover="helpline('b')" onmouseout="helpline('tip')" />
+		<input type="button" class="btnbbcode" accesskey="i" name="addbbcode2" value=" i " style="font-style:italic; width: 30px;" onclick="bbstyle(2)" onmouseover="helpline('i')" onmouseout="helpline('tip')" />
+		<input type="button" class="btnbbcode" accesskey="u" name="addbbcode4" value=" u " style="text-decoration: underline; width: 30px;" onclick="bbstyle(4)" onmouseover="helpline('u')" onmouseout="helpline('tip')" />
+		<!-- IF S_BBCODE_QUOTE -->
+			<input type="button" class="btnbbcode" accesskey="q" name="addbbcode6" value="Quote" style="width: 50px" onclick="bbstyle(6)" onmouseover="helpline('q')" onmouseout="helpline('tip')" />
+		<!-- ENDIF -->
+		<input type="button" class="btnbbcode" accesskey="c" name="addbbcode8" value="Code" style="width: 40px" onclick="bbstyle(8)" onmouseover="helpline('c')" onmouseout="helpline('tip')" />
+		<input type="button" class="btnbbcode" accesskey="l" name="addbbcode10" value="List" style="width: 40px" onclick="bbstyle(10)" onmouseover="helpline('l')" onmouseout="helpline('tip')" />
+		<input type="button" class="btnbbcode" accesskey="o" name="addbbcode12" value="List=" style="width: 40px" onclick="bbstyle(12)" onmouseover="helpline('o')" onmouseout="helpline('tip')" />
+		<input type="button" class="btnbbcode" accesskey="y" name="addlistitem" value="[*]" style="width: 40px" onclick="bbstyle(-1)" onmouseover="helpline('e')" onmouseout="helpline('tip')" />				
+		<!-- IF S_BBCODE_IMG -->
+			<input type="button" class="btnbbcode" accesskey="p" name="addbbcode14" value="Img" style="width: 40px" onclick="bbstyle(14)" onmouseover="helpline('p')" onmouseout="helpline('tip')" />
+		<!-- ENDIF -->
+		<!-- IF S_LINKS_ALLOWED -->
+			<input type="button" class="btnbbcode" accesskey="w" name="addbbcode16" value="URL" style="text-decoration: underline; width: 40px" onclick="bbstyle(16)" onmouseover="helpline('w')" onmouseout="helpline('tip')" />
+		<!-- ENDIF -->
+		<!-- IF S_BBCODE_FLASH -->
+			<input type="button" class="btnbbcode" accesskey="d" name="addbbcode18" value="Flash" onclick="bbstyle(18)" onmouseover="helpline('d')" onmouseout="helpline('tip')" />
+		<!-- ENDIF -->
+		<span class="genmed nowrap">{L_FONT_SIZE}: <select class="gensmall" name="addbbcode20" onchange="bbfontstyle('[size=' + this.form.addbbcode20.options[this.form.addbbcode20.selectedIndex].value + ']', '[/size]');this.form.addbbcode20.selectedIndex = 2;" onmouseover="helpline('f')" onmouseout="helpline('tip')">
+			<option value="50">{L_FONT_TINY}</option>
+			<option value="85">{L_FONT_SMALL}</option>
+			<option value="100" selected="selected">{L_FONT_NORMAL}</option>
+			<!-- IF not MAX_FONT_SIZE or MAX_FONT_SIZE >= 150 -->
+				<option value="150">{L_FONT_LARGE}</option>
+				<!-- IF not MAX_FONT_SIZE or MAX_FONT_SIZE >= 200 -->
+					<option value="200">{L_FONT_HUGE}</option>
+				<!-- ENDIF -->
+			<!-- ENDIF -->
+		</select></span>
+<!-- ENDIF -->
+	</td>
+</tr>
+<!-- IF S_BBCODE_ALLOWED and .custom_tags -->
+	<tr valign="middle" align="{S_CONTENT_FLOW_BEGIN}">
+		<td colspan="2">
+		<!-- BEGIN custom_tags -->
+			<input type="button" class="btnbbcode" name="addbbcode{custom_tags.BBCODE_ID}" value="{custom_tags.BBCODE_TAG}" onclick="bbstyle({custom_tags.BBCODE_ID})"<!-- IF custom_tags.BBCODE_HELPLINE !== '' --> onmouseover="helpline('cb_{custom_tags.BBCODE_ID}')" onmouseout="helpline('tip')"<!-- ENDIF --> />
+		<!-- END custom_tags -->
+		</td>
+	</tr>
+<!-- ENDIF -->
+<!-- IF S_BBCODE_ALLOWED -->
+<tr>
+	<td<!-- IF $S_SIGNATURE or S_EDIT_DRAFT --> colspan="2"<!-- ENDIF -->><input type="text" readonly="readonly" name="helpbox" style="width:100%" class="helpline" value="{L_STYLES_TIP}" /></td>
+	<!-- IF not $S_SIGNATURE and not S_EDIT_DRAFT -->
+		<td class="genmed" align="center">{L_FONT_COLOR}</td>
+	<!-- ENDIF -->
+</tr>
+<!-- ENDIF -->
diff -ruN phpBB-3.0.10/styles/spring/template/posting_poll_body.html phpbb/styles/spring/template/posting_poll_body.html
--- phpBB-3.0.10/styles/spring/template/posting_poll_body.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/posting_poll_body.html	2014-04-15 14:31:18.717429005 +0200
@@ -0,0 +1,36 @@
+
+<tr>
+	<th colspan="2">{L_ADD_POLL}</th>
+</tr>
+<tr>
+	<td class="row3" colspan="2"><span class="gensmall">{L_ADD_POLL_EXPLAIN}</span></td>
+</tr>
+<tr>
+	<td class="row1"><b class="genmed">{L_POLL_QUESTION}:</b></td>
+	<td class="row2"><input class="post" type="text" name="poll_title" size="50" maxlength="255" value="{POLL_TITLE}" /></td>
+</tr>
+<tr>
+	<td class="row1"><b class="genmed">{L_POLL_OPTIONS}:</b><br /><span class="gensmall">{L_POLL_OPTIONS_EXPLAIN}</span></td>
+	<td class="row2"><textarea style="width:450px" name="poll_option_text" rows="5" cols="35">{POLL_OPTIONS}</textarea></td>
+</tr>
+<tr>
+	<td class="row1"><b class="genmed">{L_POLL_MAX_OPTIONS}:</b><br /><span class="gensmall">{L_POLL_MAX_OPTIONS_EXPLAIN}</span></td>
+	<td class="row2"><input class="post" type="text" name="poll_max_options" size="3" maxlength="3" value="{POLL_MAX_OPTIONS}" /></td>
+</tr>
+<tr>
+	<td class="row1"><b class="genmed">{L_POLL_FOR}:</b></td>
+	<td class="row2"><input class="post" type="text" name="poll_length" size="3" maxlength="3" value="{POLL_LENGTH}" />&nbsp;<b class="gen">{L_DAYS}</b> <span class="gensmall">{L_POLL_FOR_EXPLAIN}</span></td>
+</tr>
+<!-- IF S_POLL_VOTE_CHANGE -->
+	<tr>
+		<td class="row1"><b class="genmed">{L_POLL_VOTE_CHANGE}:</b><br /><span class="gensmall">{L_POLL_VOTE_CHANGE_EXPLAIN}</span></td>
+		<td class="row2"><input type="checkbox" class="radio" name="poll_vote_change"{VOTE_CHANGE_CHECKED} /></td>
+	</tr>
+<!-- ENDIF -->
+
+<!-- IF S_POLL_DELETE -->
+	<tr>
+		<td class="row1"><b class="genmed">{L_POLL_DELETE}:</b></td>
+		<td class="row2"><input type="checkbox" class="radio" name="poll_delete"<!-- IF S_POLL_DELETE_CHECKED --> checked="checked"<!-- ENDIF --> /></td>
+	</tr>
+<!-- ENDIF -->
diff -ruN phpBB-3.0.10/styles/spring/template/posting_preview.html phpbb/styles/spring/template/posting_preview.html
--- phpBB-3.0.10/styles/spring/template/posting_preview.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/posting_preview.html	2014-04-15 14:31:18.718429005 +0200
@@ -0,0 +1,70 @@
+
+<table class="tablebg" width="100%" cellspacing="1">
+<tr> 
+	<th>{L_PREVIEW}</th>
+</tr>
+<tr> 
+	<td class="row1">{MINI_POST_IMG}<span class="postdetails">{L_POSTED}: {POST_DATE} &nbsp;&nbsp;&nbsp; {L_POST_SUBJECT}: {PREVIEW_SUBJECT}</span></td>
+</tr>
+<!-- IF S_HAS_POLL_OPTIONS -->
+	<tr>
+		<td class="row2" colspan="2" align="center"><br clear="all" />
+			<table cellspacing="0" cellpadding="4" border="0" align="center">
+			<tr>
+				<td align="center"><span class="gen"><b>{POLL_QUESTION}</b></span><br /><span class="gensmall">{L_POLL_LENGTH}</span></td>
+			</tr>
+			<tr>
+				<td align="center">
+					<table cellspacing="0" cellpadding="2" border="0">
+					<!-- BEGIN poll_option -->
+						<tr>
+							<td>
+							<!-- IF S_IS_MULTI_CHOICE -->
+								<input type="checkbox" class="radio" name="vote_id" value="" />
+							<!-- ELSE -->
+								<input type="radio" class="radio" name="vote_id" value="" />
+							<!-- ENDIF -->
+							</td>
+							<td><span class="gen">{poll_option.POLL_OPTION_CAPTION}</span></td>
+						</tr>
+					<!-- END poll_option -->
+					</table>
+				</td>
+			</tr>
+			<tr>
+				<td align="center"><span class="gensmall">{L_MAX_VOTES}</span></td>
+			</tr>
+			</table>
+		</td>
+	</tr>
+<!-- ENDIF -->
+<tr> 
+	<td class="row1">
+		<table width="100%" border="0" cellspacing="0" cellpadding="0">
+		<tr>
+			<td><div class="postbody">{PREVIEW_MESSAGE}</div>
+			<!-- IF .attachment -->
+				<br clear="all" /><br />
+
+				<table class="tablebg" width="100%" cellspacing="1">
+				<tr>
+					<td class="row3"><b class="genmed">{L_ATTACHMENTS}: </b></td>
+				</tr>
+				<!-- BEGIN attachment -->
+					<tr>
+						<td class="row2">{attachment.DISPLAY_ATTACHMENT}</td>
+					</tr>
+				<!-- END attachment -->
+				</table>
+			<!-- ENDIF -->
+			<!-- IF PREVIEW_SIGNATURE --><span class="postbody"><br />_________________<br />{PREVIEW_SIGNATURE}</span><!-- ENDIF --></td>
+		</tr>
+		</table>
+	</td>
+</tr>
+<tr>
+	<td class="spacer"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
+</tr>
+</table>
+
+<br clear="all" />
diff -ruN phpBB-3.0.10/styles/spring/template/posting_progress_bar.html phpbb/styles/spring/template/posting_progress_bar.html
--- phpBB-3.0.10/styles/spring/template/posting_progress_bar.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/posting_progress_bar.html	2014-04-15 14:31:18.718429005 +0200
@@ -0,0 +1,44 @@
+<!-- INCLUDE simple_header.html -->
+<script type="text/javascript">
+// <![CDATA[
+	/**
+	* Close upload popup
+	*/
+	function close_popup()
+	{
+		if (opener != null)
+		{
+			if (opener.close_waitscreen != null)
+			{
+				if (opener.close_waitscreen == 1)
+				{
+					opener.close_waitscreen = 0;
+					self.close();
+					return 0;
+				}
+			}
+		}
+		setTimeout("close_popup()", 1000);
+		return 0;
+	}
+// ]]>
+</script>
+
+<table width="100%" border="0" cellspacing="0" cellpadding="10">
+<tr>
+	<td>
+		<table width="100%" border="0" cellspacing="1" cellpadding="4">
+		<tr> 
+			<td valign="top" class="row1" align="center"><br /><span class="genmed">{L_UPLOAD_IN_PROGRESS}</span><br /><br /><div style="align:center">{PROGRESS_BAR}</div><br /><br /><span class="genmed"><a href="#" onclick="window.close(); return false;">{L_CLOSE_WINDOW}</a></span><br /><br /></td>
+		</tr>
+		</table>
+	</td>
+</tr>
+</table>
+
+<script type="text/javascript">
+// <![CDATA[
+	close_popup();	
+// ]]>
+</script>
+<!-- INCLUDE simple_footer.html -->
diff -ruN phpBB-3.0.10/styles/spring/template/posting_review.html phpbb/styles/spring/template/posting_review.html
--- phpBB-3.0.10/styles/spring/template/posting_review.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/posting_review.html	2014-04-15 14:31:18.719429005 +0200
@@ -0,0 +1,99 @@
+
+<table class="tablebg" width="100%" cellspacing="1">
+<tr>
+	<th align="center">{L_POST_REVIEW}</th>
+</tr>
+<tr>
+	<td class="row1" align="center"><span class="gen">{L_POST_REVIEW_EXPLAIN}</span></td>
+</tr>
+<tr>
+	<td class="spacer"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
+</tr>
+<tr>
+	<td class="row1">
+		<table class="tablebg" width="100%" cellspacing="1">
+		<tr>
+			<th width="22%">{L_AUTHOR}</th>
+			<th>{L_MESSAGE}</th>
+		</tr>
+		<!-- BEGIN post_review_row -->
+
+			<!-- IF post_review_row.S_ROW_COUNT is even -->	<tr class="row1"><!-- ELSE --><tr class="row2"><!-- ENDIF -->
+				<!-- IF post_review_row.S_IGNORE_POST -->
+				<td colspan="2">{post_review_row.L_IGNORE_POST}</td>
+				<!-- ELSE -->
+
+				<td rowspan="2" align="{S_CONTENT_FLOW_BEGIN}" valign="top"><a id="pr{post_review_row.POST_ID}"></a>
+					<table width="150" cellspacing="0" cellpadding="4" border="0">
+					<tr>
+						<td align="center"><b class="postauthor">{post_review_row.POST_AUTHOR_FULL}</b></td>
+					</tr>
+					</table>
+				</td>
+				<td width="100%">
+					<table width="100%" cellspacing="0" cellpadding="0" border="0">
+					<tr>
+						<td>&nbsp;</td>
+						<td class="gensmall" valign="middle" nowrap="nowrap"><b>{L_POST_SUBJECT}:</b>&nbsp;</td>
+						<td class="gensmall" width="100%" valign="middle">{post_review_row.POST_SUBJECT}</td>
+						<td>&nbsp;</td>
+					</tr>
+					</table>
+				</td>
+			</tr>
+
+			<!-- IF post_review_row.S_ROW_COUNT is even --><tr class="row1"><!-- ELSE --><tr class="row2"><!-- ENDIF -->
+
+				<td valign="top">
+					<table width="100%" cellspacing="0">
+					<tr>
+						<td valign="top">
+							<table width="100%" cellspacing="0" cellpadding="2">
+							<tr>
+								<td><div class="postbody">{post_review_row.MESSAGE}</div>
+
+								<!-- IF post_review_row.S_HAS_ATTACHMENTS -->
+									<br clear="all" /><br />
+
+									<table class="tablebg" width="100%" cellspacing="1">
+									<tr>
+										<td class="row3"><b class="genmed">{L_ATTACHMENTS}: </b></td>
+									</tr>
+									<!-- BEGIN attachment -->
+										<tr>
+											<!-- IF post_review_row.attachment.S_ROW_COUNT is even --><td class="row2"><!-- ELSE --><td class="row1"><!-- ENDIF -->{post_review_row.attachment.DISPLAY_ATTACHMENT}</td>
+										</tr>
+									<!-- END attachment -->
+									</table>
+								<!-- ENDIF -->
+								
+								</td>
+							</tr>
+							</table>
+						</td>
+					</tr>
+					<tr>
+						<td>
+							<table width="100%" cellspacing="0" cellpadding="0" border="0">
+							<tr valign="middle">
+								<td width="100%">&nbsp;</td>
+								<td width="10" nowrap="nowrap"><!-- IF S_IS_BOT -->{post_review_row.MINI_POST_IMG}<!-- ELSE --><a href="{post_review_row.U_MINI_POST}">{post_review_row.MINI_POST_IMG}</a><!-- ENDIF --></td>
+								<td class="gensmall" nowrap="nowrap"><b>{L_POSTED}:</b> {post_review_row.POST_DATE}</td>
+							</tr>
+							</table>
+						</td>
+					</tr>
+					</table>
+				</td>
+			<!-- ENDIF -->
+			</tr>
+			<tr>
+				<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
+			</tr>
+		<!-- END post_review_row -->
+		</table>
+	</td>
+</tr>
+</table>
+
+<br clear="all" />
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/posting_smilies.html phpbb/styles/spring/template/posting_smilies.html
--- phpBB-3.0.10/styles/spring/template/posting_smilies.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/posting_smilies.html	2014-04-15 14:31:18.719429005 +0200
@@ -0,0 +1,25 @@
+<!-- INCLUDE simple_header.html -->
+
+<script type="text/javascript">
+// <![CDATA[
+	var form_name = 'postform';
+	var text_name = 'message';
+// ]]>
+</script>
+<script type="text/javascript" src="{T_SUPER_TEMPLATE_PATH}/editor.js"></script>
+
+<table width="100%" cellspacing="1" cellpadding="4" border="0">
+<tr>
+	<td>
+		<table class="tablebg" width="95%" cellspacing="1" cellpadding="4" border="0">
+		<tr>
+			<th>{L_SMILIES}</th>
+		</tr>
+		<tr>
+			<td class="row1" align="center" valign="middle"><!-- BEGIN smiley --> <a href="#" onclick="initInsertions(); insert_text('{smiley.A_SMILEY_CODE}', true, true); return false;"><img src="{smiley.SMILEY_IMG}" width="{smiley.SMILEY_WIDTH}" height="{smiley.SMILEY_HEIGHT}" alt="{smiley.SMILEY_CODE}" title="{smiley.SMILEY_DESC}" hspace="2" vspace="2" /></a> <!-- END smiley --><br />{PAGINATION}<br /><a class="nav" href="#" onclick="window.close(); return false;">{L_CLOSE_WINDOW}</a></td>
+		</tr>
+		</table>
+	</td>
+</tr>
+</table>
+<!-- INCLUDE simple_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/posting_topic_review.html phpbb/styles/spring/template/posting_topic_review.html
--- phpBB-3.0.10/styles/spring/template/posting_topic_review.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/posting_topic_review.html	2014-04-15 14:31:18.720429005 +0200
@@ -0,0 +1,103 @@
+<script type="text/javascript">
+// <![CDATA[
+	bbcodeEnabled = {S_BBCODE_ALLOWED};
+// ]]>
+</script>
+
+<table class="tablebg" width="100%" cellspacing="1">
+<tr>
+	<th align="center">{L_TOPIC_REVIEW} - {TOPIC_TITLE}</th>
+</tr>
+<tr>
+	<td class="row1"><div style="overflow: auto; width: 100%; height: 300px;">
+
+		<table class="tablebg" width="100%" cellspacing="1">
+		<tr>
+			<th width="22%">{L_AUTHOR}</th>
+			<th>{L_MESSAGE}</th>
+		</tr>
+		<!-- BEGIN topic_review_row -->
+
+			<!-- IF topic_review_row.S_ROW_COUNT is even --><tr class="row1"><!-- ELSE --><tr class="row2"><!-- ENDIF -->
+
+				<!-- IF topic_review_row.S_IGNORE_POST -->
+				<td colspan="2">{topic_review_row.L_IGNORE_POST}</td>
+				<!-- ELSE -->
+				<td rowspan="2" align="{S_CONTENT_FLOW_BEGIN}" valign="top"><a id="pr{topic_review_row.POST_ID}"></a>
+					<table width="150" cellspacing="0">
+					<tr>
+						<td align="center"><b class="postauthor"<!-- IF topic_review_row.POST_AUTHOR_COLOUR --> style="color: {topic_review_row.POST_AUTHOR_COLOUR}"<!-- ENDIF -->>{topic_review_row.POST_AUTHOR}</b></td>
+					</tr>
+					</table>
+				</td>
+				<td width="100%">
+					<table width="100%" cellspacing="0">
+					<tr>
+						<td>&nbsp;</td>
+						<td class="gensmall" valign="middle" nowrap="nowrap"><b>{L_POST_SUBJECT}:</b>&nbsp;</td>
+						<td class="gensmall" width="100%" valign="middle">{topic_review_row.POST_SUBJECT}</td>
+						<td valign="top" nowrap="nowrap">&nbsp;<!-- IF topic_review_row.POSTER_QUOTE and topic_review_row.DECODED_MESSAGE --><a href="#" onclick="addquote({topic_review_row.POST_ID},'{topic_review_row.POSTER_QUOTE}', '{LA_WROTE}'); return false;">{QUOTE_IMG}</a><!-- ENDIF --></td>
+					</tr>
+					</table>
+				</td>
+			</tr>
+
+			<!-- IF topic_review_row.S_ROW_COUNT is even --><tr class="row1"><!-- ELSE --><tr class="row2"><!-- ENDIF -->
+
+				<td valign="top">
+					<table width="100%" cellspacing="0">
+					<tr>
+						<td valign="top">
+							<table width="100%" cellspacing="0" cellpadding="2">
+							<tr>
+								<td>
+									<div class="postbody">{topic_review_row.MESSAGE}</div>
+
+									<!-- IF topic_review_row.S_HAS_ATTACHMENTS -->
+										<br clear="all" /><br />
+
+										<table class="tablebg" width="100%" cellspacing="1">
+										<tr>
+											<td class="row3"><b class="genmed">{L_ATTACHMENTS}: </b></td>
+										</tr>
+										<!-- BEGIN attachment -->
+											<tr>
+												<!-- IF topic_review_row.attachment.S_ROW_COUNT is even --><td class="row2"><!-- ELSE --><td class="row1"><!-- ENDIF -->{topic_review_row.attachment.DISPLAY_ATTACHMENT}</td>
+											</tr>
+										<!-- END attachment -->
+										</table>
+									<!-- ENDIF -->
+
+									<!-- IF topic_review_row.POSTER_QUOTE and topic_review_row.DECODED_MESSAGE -->
+										<div id="message_{topic_review_row.POST_ID}" style="display: none;">{topic_review_row.DECODED_MESSAGE}</div>
+									<!-- ENDIF -->
+								</td>
+							</tr>
+							</table>
+						</td>
+					</tr>
+					<tr>
+						<td>
+							<table width="100%" cellspacing="0">
+							<tr valign="middle">
+								<td width="100%" align="{S_CONTENT_FLOW_BEGIN}"><span class="gensmall"><!-- IF topic_review_row.U_MCP_DETAILS -->[ <a href="{topic_review_row.U_MCP_DETAILS}">{L_POST_DETAILS}</a> ]<!-- ENDIF --></span></td>
+								<td width="10" nowrap="nowrap"><!-- IF S_IS_BOT -->{topic_review_row.MINI_POST_IMG}<!-- ELSE --><a href="{topic_review_row.U_MINI_POST}">{topic_review_row.MINI_POST_IMG}</a><!-- ENDIF --></td>
+								<td class="gensmall" nowrap="nowrap"><b>{L_POSTED}:</b> {topic_review_row.POST_DATE}</td>
+							</tr>
+							</table>
+						</td>
+					</tr>
+					</table>
+				</td>
+				<!-- ENDIF -->
+			</tr>
+			<tr>
+				<td class="spacer" colspan="2"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
+			</tr>
+		<!-- END topic_review_row -->
+		</table>
+	</div></td>
+</tr>
+</table>
+
+<br clear="all" />
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/quickreply_editor.html phpbb/styles/spring/template/quickreply_editor.html
--- phpBB-3.0.10/styles/spring/template/quickreply_editor.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/quickreply_editor.html	2014-04-15 14:31:18.721429005 +0200
@@ -0,0 +1,27 @@
+<form method="post" action="{U_QR_ACTION}">
+
+	<table class="tablebg" width="100%" cellspacing="1">
+		<tr>
+			<th align="center" colspan="2">{L_QUICKREPLY}</th>
+		</tr>
+		<tr>
+			<td class="row1" width="22%"><b class="genmed">{L_SUBJECT}:</b></td>
+			<td  class="row2" width="78%"><input class="post" style="width:450px" type="text" name="subject" size="45" maxlength="64" tabindex="2" value="{SUBJECT}" /></td>
+		</tr>
+		<tr>
+			<td class="row1" width="22%"><b class="genmed">{L_MESSAGE}:</b></td>
+			<td class="row2" valign="top" align="left" width="78%"><textarea name="message" rows="7" cols="76" tabindex="3"  style="width: 98%; height: 130px;"></textarea> </td>
+		</tr>
+		<tr>
+			<td class="cat" colspan="2" align="center">
+				<input class="btnmain" type="submit" accesskey="s" tabindex="6" name="post" value="{L_SUBMIT}" />&nbsp;
+				<input class="btnlite" type="submit" accesskey="f" tabindex="7" name="full_editor" value="{L_FULL_EDITOR}" />
+
+				{S_FORM_TOKEN}
+				{QR_HIDDEN_FIELDS}
+			</td>
+		</tr>
+	</table>
+	
+</form>
+<br clear="all" />
diff -ruN phpBB-3.0.10/styles/spring/template/report_body.html phpbb/styles/spring/template/report_body.html
--- phpBB-3.0.10/styles/spring/template/report_body.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/report_body.html	2014-04-15 14:31:18.721429005 +0200
@@ -0,0 +1,41 @@
+<!-- INCLUDE overall_header.html -->
+
+<form method="post" id="report" action="{S_REPORT_ACTION}">
+
+<table class="tablebg" width="100%" cellspacing="1">
+<tr>
+	<th colspan="2"><!-- IF S_REPORT_POST -->{L_REPORT_POST}<!-- ELSE -->{L_REPORT_MESSAGE}<!-- ENDIF --></th>
+</tr>
+<tr>
+	<td class="row3" colspan="2"><span class="gensmall"><!-- IF S_REPORT_POST -->{L_REPORT_POST_EXPLAIN}<!-- ELSE -->{L_REPORT_MESSAGE_EXPLAIN}<!-- ENDIF --></span></td>
+</tr>
+<tr>
+	<td class="row1" width="22%"><b class="gen">{L_REASON}:</b></td>
+	<td class="row2" width="78%"><select name="reason_id">
+		<!-- BEGIN reason --><option value="{reason.ID}"<!-- IF reason.S_SELECTED --> selected="selected"<!-- ENDIF -->>{reason.TITLE} &raquo; {reason.DESCRIPTION}</option><!-- END reason -->
+	</select></td>
+</tr>
+<!-- IF S_CAN_NOTIFY -->
+	<tr>
+		<td class="row1"><span class="gen"><b>{L_REPORT_NOTIFY}:</b></span><br /><span class="gensmall">{L_REPORT_NOTIFY_EXPLAIN}</span></td>
+		<td class="row2"><span class="gen"><input type="radio" class="radio" name="notify" value="1"<!-- IF S_NOTIFY --> checked="checked"<!-- ENDIF --> />&nbsp; {L_YES} &nbsp;<input type="radio" class="radio" name="notify" value="0"<!-- IF not S_NOTIFY --> checked="checked"<!-- ENDIF --> />&nbsp; {L_NO}</span></td>
+	</tr>
+<!-- ENDIF -->
+<tr>
+	<td class="row1" valign="top"><span class="gen"><b>{L_MORE_INFO}:</b></span><br /><span class="gensmall">{L_CAN_LEAVE_BLANK}</span></td>
+	<td class="row2"><textarea class="post" name="report_text" rows="10" cols="50">{REPORT_TEXT}</textarea></td>
+</tr>
+<tr>
+	<td class="cat" colspan="2" align="center"><input type="submit" name="submit" class="btnmain" value="{L_SUBMIT}" />&nbsp;<input type="submit" name="cancel" class="btnlite" value="{L_CANCEL}" /></td>
+</tr>
+</table>
+{S_FORM_TOKEN}
+</form>
+
+<br clear="all" />
+
+<!-- INCLUDE breadcrumbs.html -->
+
+<div style="float: {S_CONTENT_FLOW_END};"><!-- INCLUDE jumpbox.html --></div>
+
+<!-- INCLUDE overall_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/search_body.html phpbb/styles/spring/template/search_body.html
--- phpBB-3.0.10/styles/spring/template/search_body.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/search_body.html	2014-04-15 14:31:18.722429005 +0200
@@ -0,0 +1,95 @@
+<!-- INCLUDE overall_header.html -->
+
+<div id="pagecontent">
+
+	<form method="get" action="{S_SEARCH_ACTION}">
+	
+	<table class="tablebg" width="100%" cellspacing="1">
+	<tr>
+		<th colspan="4">{L_SEARCH_QUERY}</th>
+	</tr>
+	<tr>
+		<td class="row1" colspan="2" width="50%"><b class="genmed">{L_SEARCH_KEYWORDS}: </b><br /><span class="gensmall">{L_SEARCH_KEYWORDS_EXPLAIN}</span></td>
+		<td class="row2" colspan="2" valign="top"><input type="text" style="width: 300px" class="post" name="keywords" size="30" /><br /><input type="radio" class="radio" name="terms" value="all" checked="checked" /> <span class="genmed">{L_SEARCH_ALL_TERMS}</span><br /><input type="radio" class="radio" name="terms" value="any" /> <span class="genmed">{L_SEARCH_ANY_TERMS}</span></td>
+	</tr>
+	<tr>
+		<td class="row1" colspan="2"><b class="genmed">{L_SEARCH_AUTHOR}:</b><br /><span class="gensmall">{L_SEARCH_AUTHOR_EXPLAIN}</span></td>
+		<td class="row2" colspan="2" valign="middle"><input type="text" style="width: 300px" class="post" name="author" size="30" /></td>
+	</tr>
+	<tr>
+		<td class="row1" colspan="2"><b class="genmed">{L_SEARCH_FORUMS}: </b><br /><span class="gensmall">{L_SEARCH_FORUMS_EXPLAIN}</span></td>
+		<td class="row2" colspan="2"><select name="fid[]" multiple="multiple" size="5">{S_FORUM_OPTIONS}</select></td>
+	</tr>
+	<tr>
+		<th colspan="4">{L_SEARCH_OPTIONS}</th>
+	</tr>
+	<tr>
+		<td class="row1" width="25%" nowrap="nowrap"><b class="genmed">{L_SEARCH_SUBFORUMS}: </b></td>
+		<td class="row2" width="25%" nowrap="nowrap"><input type="radio" class="radio" name="sc" value="1" checked="checked" /> <span class="genmed">{L_YES}</span>&nbsp;&nbsp;<input type="radio" class="radio" name="sc" value="0" /> <span class="genmed">{L_NO}</span></td>
+		<td class="row1" width="25%" nowrap="nowrap"><b class="genmed">{L_SEARCH_WITHIN}: </b></td>
+		<td class="row2" width="25%" nowrap="nowrap"><input type="radio" class="radio" name="sf" value="all" checked="checked" /> <span class="genmed">{L_SEARCH_TITLE_MSG}</span><br /><input type="radio" class="radio" name="sf" value="msgonly" /> <span class="genmed">{L_SEARCH_MSG_ONLY}</span> <br /><input type="radio" class="radio" name="sf" value="titleonly" /> <span class="genmed">{L_SEARCH_TITLE_ONLY}</span> <br /><input type="radio" class="radio" name="sf" value="firstpost" /> <span class="genmed">{L_SEARCH_FIRST_POST}</span></td>
+	</tr>
+	<tr>
+		<td class="row1"><b class="genmed">{L_RESULT_SORT}: </b></td>
+		<td class="row2" nowrap="nowrap">{S_SELECT_SORT_KEY}<br /><input type="radio" class="radio" name="sd" value="a" /> <span class="genmed">{L_SORT_ASCENDING}</span><br /><input type="radio" class="radio" name="sd" value="d" checked="checked" /> <span class="genmed">{L_SORT_DESCENDING}</span></td>
+		<td class="row1" nowrap="nowrap"><b class="genmed">{L_DISPLAY_RESULTS}: </b></td>
+		<td class="row2" nowrap="nowrap"><input type="radio" class="radio" name="sr" value="posts" checked="checked" /> <span class="genmed">{L_POSTS}</span>&nbsp;&nbsp;<input type="radio" class="radio" name="sr" value="topics" /> <span class="genmed">{L_TOPICS}</span></td>
+	</tr>
+	<tr>
+		<td class="row1" width="25%"><b class="genmed">{L_RESULT_DAYS}: </b></td>
+		<td class="row2" width="25%" nowrap="nowrap">{S_SELECT_SORT_DAYS}</td>
+		<td class="row1" nowrap="nowrap"><b class="genmed">{L_RETURN_FIRST}: </b></td>
+		<td class="row2" nowrap="nowrap"><select name="ch">{S_CHARACTER_OPTIONS}</select> <span class="genmed">{L_POST_CHARACTERS}</span></td>
+	</tr>
+	<tr>
+		<td class="cat" colspan="4" align="center">{S_HIDDEN_FIELDS}<input class="btnmain" name="submit" type="submit" value="{L_SEARCH}" />&nbsp;&nbsp;<input class="btnlite" type="reset" value="{L_RESET}" /></td>
+	</tr>
+	</table>
+	
+	</form>
+
+	<br clear="all" />
+
+	<!-- IF .recentsearch -->
+	<table class="tablebg" width="100%" cellspacing="1">
+	<tr>
+		<th colspan="2">{L_RECENT_SEARCHES}</th>
+	</tr>
+	<!-- BEGIN recentsearch -->
+		<!-- IF recentsearch.S_ROW_COUNT is even --><tr class="row2"><!-- ELSE --><tr class="row1"><!-- ENDIF -->
+
+			<td class="genmed" style="padding: 4px;" width="70%"><a href="{recentsearch.U_KEYWORDS}">{recentsearch.KEYWORDS}</a></td>
+			<td class="genmed" style="padding: 4px;" width="30%" align="center">{recentsearch.TIME}</td>
+		</tr>
+	<!-- END recentsearch -->
+	</table>
+
+	<br clear="all" />
+	<!-- ENDIF -->
+
+	</div>
+
+	<!-- INCLUDE breadcrumbs.html -->
+
+	<br clear="all" />
+
+	<div align="{S_CONTENT_FLOW_END}"><!-- INCLUDE jumpbox.html --></div>
+
+<script type="text/javascript">
+// <![CDATA[
+	(function()
+	{
+		var elements = document.getElementsByName("keywords");
+		for (var i = 0; i < elements.length; ++i)
+		{
+			if (elements[i].tagName.toLowerCase() == 'input')
+			{
+				elements[i].focus();
+				break;
+			}
+		}
+	})();
+// ]]>
+</script>
+
+<!-- INCLUDE overall_footer.html -->
diff -ruN phpBB-3.0.10/styles/spring/template/searchbox.html phpbb/styles/spring/template/searchbox.html
--- phpBB-3.0.10/styles/spring/template/searchbox.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/searchbox.html	2014-04-15 14:31:18.723429005 +0200
@@ -0,0 +1 @@
+<form method="get" name="search" action="{S_SEARCHBOX_ACTION}"><span class="gensmall">{L_SEARCH_FOR}:</span> <input class="post" type="text" name="keywords" size="20" /> <input class="btnlite" type="submit" value="{L_GO}" />{S_SEARCH_LOCAL_HIDDEN_FIELDS}</form>
diff -ruN phpBB-3.0.10/styles/spring/template/search_results.html phpbb/styles/spring/template/search_results.html
--- phpBB-3.0.10/styles/spring/template/search_results.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/search_results.html	2014-04-15 14:31:18.724429005 +0200
@@ -0,0 +1,146 @@
+<!-- INCLUDE overall_header.html -->
+
+<form method="post" action="{S_SEARCH_ACTION}">
+
+<table width="100%" cellspacing="1">
+<tr>
+	<td colspan="2"><span class="titles"><!-- IF SEARCH_TITLE -->{SEARCH_TITLE}<!-- ELSE -->{SEARCH_MATCHES}<!-- ENDIF --></span><br /></td>
+</tr>
+<tr>
+	<td class="genmed"><!-- IF SEARCH_TOPIC -->{L_SEARCHED_TOPIC}: <a href="{U_SEARCH_TOPIC}"><b>{SEARCH_TOPIC}</b></a><br /><!-- ENDIF --><!-- IF SEARCH_WORDS -->{L_SEARCHED_FOR}: <a href="{U_SEARCH_WORDS}"><b>{SEARCH_WORDS}</b></a><!-- ENDIF --><!-- IF IGNORED_WORDS --> {L_IGNORED_TERMS}: <b>{IGNORED_WORDS}</b><!-- ENDIF --></td>
+	<td align="{S_CONTENT_FLOW_END}"><!-- IF SEARCH_IN_RESULTS --><span class="genmed">{L_SEARCH_IN_RESULTS}: </span><input class="post" type="text" name="add_keywords" value="" /> <input class="btnlite" type="submit" name="submit" value="{L_GO}" /><!-- ENDIF --></td>
+</tr>
+</table>
+
+<br clear="all" />
+
+<!-- IF S_SHOW_TOPICS -->
+
+	<table class="tablebg" width="100%" cellspacing="1">
+	<tr>
+		<th width="4%" nowrap="nowrap">&nbsp;</th>
+		<th colspan="2" nowrap="nowrap">&nbsp;{L_TOPICS}&nbsp;</th>
+		<th nowrap="nowrap">&nbsp;{L_AUTHOR}&nbsp;</th>
+		<th nowrap="nowrap">&nbsp;{L_REPLIES}&nbsp;</th>
+		<th nowrap="nowrap">&nbsp;{L_VIEWS}&nbsp;</th>
+		<th nowrap="nowrap">&nbsp;{L_LAST_POST}&nbsp;</th>
+	</tr>
+	<!-- BEGIN searchresults -->
+		<tr valign="middle">
+			<td class="row1" width="25" align="center">{searchresults.TOPIC_FOLDER_IMG}</td>
+			<td class="row1" width="25" align="center">
+			<!-- IF searchresults.TOPIC_ICON_IMG -->
+				<img src="{T_ICONS_PATH}{searchresults.TOPIC_ICON_IMG}" width="{searchresults.TOPIC_ICON_IMG_WIDTH}" height="{searchresults.TOPIC_ICON_IMG_HEIGHT}" alt="" title="" />
+			<!-- ENDIF -->
+			</td>
+			<td class="row1">
+				<!-- IF searchresults.S_UNREAD_TOPIC --><a href="{searchresults.U_NEWEST_POST}">{NEWEST_POST_IMG}</a><!-- ENDIF -->
+				{searchresults.ATTACH_ICON_IMG} <a href="{searchresults.U_VIEW_TOPIC}" class="topictitle">{searchresults.TOPIC_TITLE}</a>
+				<!-- IF searchresults.S_TOPIC_UNAPPROVED or searchresults.S_POSTS_UNAPPROVED -->
+					<a href="{searchresults.U_MCP_QUEUE}">{searchresults.UNAPPROVED_IMG}</a>&nbsp;
+				<!-- ENDIF -->
+				<!-- IF searchresults.S_TOPIC_REPORTED -->
+					<a href="{searchresults.U_MCP_REPORT}">{REPORTED_IMG}</a>&nbsp;
+				<!-- ENDIF -->
+				<!-- IF searchresults.PAGINATION -->
+					<p class="gensmall"> [ {GOTO_PAGE_IMG}{L_GOTO_PAGE}: {searchresults.PAGINATION} ] </p>
+				<!-- ENDIF -->
+				<!-- IF searchresults.S_TOPIC_GLOBAL -->
+					<p class="gensmall">{L_GLOBAL}</p>
+				<!-- ELSE -->
+					<p class="gensmall">{L_IN} <a href="{searchresults.U_VIEW_FORUM}">{searchresults.FORUM_TITLE}</a></p>
+				<!-- ENDIF -->
+			</td>
+			<td class="row2" width="100" align="center"><p class="topicauthor">{searchresults.TOPIC_AUTHOR_FULL}</p></td>
+			<td class="row1" width="50" align="center"><p class="topicdetails">{searchresults.TOPIC_REPLIES}</p></td>
+			<td class="row2" width="50" align="center"><p class="topicdetails">{searchresults.TOPIC_VIEWS}</p></td>
+			<td class="row1" width="120" align="center">
+				<p class="topicdetails">{searchresults.LAST_POST_TIME}</p>
+				<p class="topicdetails">{searchresults.LAST_POST_AUTHOR_FULL}
+					<a href="{searchresults.U_LAST_POST}">{LAST_POST_IMG}</a>
+				</p>
+			</td>
+		</tr>
+	<!-- BEGINELSE -->
+		<tr valign="middle">
+			<td colspan="7" class="row3" align="center">{L_NO_SEARCH_RESULTS}</td>
+		</tr>
+	<!-- END searchresults -->
+	<tr>
+		<td class="cat" colspan="7" valign="middle" align="center"><!-- IF S_SELECT_SORT_DAYS or S_SELECT_SORT_KEY --><span class="gensmall">{L_DISPLAY_POSTS}:</span> {S_SELECT_SORT_DAYS}<!-- IF S_SELECT_SORT_KEY -->&nbsp;<span class="gensmall">{L_SORT_BY}:</span> {S_SELECT_SORT_KEY} {S_SELECT_SORT_DIR}<!-- ENDIF -->&nbsp;<input class="btnlite" type="submit" value="{L_GO}" name="sort" /><!-- ENDIF --></td>
+	</tr>
+	</table>
+
+<!-- ELSE -->
+
+	<table class="tablebg" width="100%" cellspacing="1">
+	<tr>
+		<th width="150" nowrap="nowrap">{L_AUTHOR}</th>
+		<th width="100%" nowrap="nowrap">{L_MESSAGE}</th>
+	</tr>
+
+	<!-- BEGIN searchresults -->
+		<tr class="row2">
+		<!-- IF searchresults.S_IGNORE_POST -->
+			<td class="gensmall" colspan="2" height="25" align="center">{searchresults.L_IGNORE_POST}</td>
+		<!-- ELSE -->
+				<td colspan="2" height="25"><p class="topictitle"><a name="p{searchresults.POST_ID}" id="p{searchresults.POST_ID}"></a>&nbsp;<!-- IF searchresults.FORUM_TITLE -->{L_FORUM}: <a href="{searchresults.U_VIEW_FORUM}">{searchresults.FORUM_TITLE}</a><!-- ELSE -->{L_GLOBAL}<!-- ENDIF --> &nbsp; {L_TOPIC}: <a href="{searchresults.U_VIEW_TOPIC}">{searchresults.TOPIC_TITLE}</a> </p></td>
+			</tr>
+			<tr class="row1">
+				<td width="150" align="center" valign="middle"><b class="postauthor">{searchresults.POST_AUTHOR_FULL}</b></td>
+				<td height="25">
+					<table width="100%" cellspacing="0" cellpadding="0" border="0">
+					<tr>
+						<td class="gensmall">
+							<div style="float: {S_CONTENT_FLOW_BEGIN};">
+							<!-- IF searchresults.POST_SUBJECT neq "" -->
+								&nbsp;<b>{L_POST_SUBJECT}:</b> <a href="{searchresults.U_VIEW_POST}">{searchresults.POST_SUBJECT}</a>
+							<!-- ELSE -->
+								[ <a href="{searchresults.U_VIEW_POST}">{L_JUMP_TO_POST}</a> ]
+							<!-- ENDIF -->
+							</div>
+							<div style="float: {S_CONTENT_FLOW_END};"><b>{L_POSTED}:</b> {searchresults.POST_DATE}&nbsp;</div>
+						</td>
+					</tr>
+					</table>
+				</td>
+			</tr>
+			<tr class="row1">
+				<td width="150" align="center" valign="top"><br /><span class="postdetails">{L_REPLIES}: <b>{searchresults.TOPIC_REPLIES}</b><br />{L_VIEWS}: <b>{searchresults.TOPIC_VIEWS}</b></span><br /><br /></td>
+				<td valign="top">
+					<table width="100%" cellspacing="5">
+					<tr>
+						<td class="postbody">{searchresults.MESSAGE}</td>
+					</tr>
+					</table>
+				</td>
+			</tr>
+		<!-- ENDIF -->
+		<tr>
+			<td class="spacer" colspan="2"><img src="images/spacer.gif" height="1" alt="" /></td>
+		</tr>
+	<!-- BEGINELSE -->
+		<tr valign="middle">
+			<td colspan="2" class="row3" align="center">{L_NO_SEARCH_RESULTS}</td>
+		</tr>
+	<!-- END searchresults -->
+	<tr>
+		<td class="cat" colspan="2" align="center"><!-- IF S_SELECT_SORT_KEY --><span class="gensmall">{L_SORT_BY}:</span> {S_SELECT_SORT_KEY} {S_SELECT_SORT_DIR}&nbsp;<input class="btnlite" type="submit" name="sort" value="{L_GO}" /><!-- ENDIF --></td>
+	</tr>
+	</table>
+<!-- ENDIF -->
+
+</form>
+
+<div class="gensmall" style="float: {S_CONTENT_FLOW_BEGIN};"><span class="nav">{PAGE_NUMBER}</span> [ {SEARCH_MATCHES} ]</div>
+<div class="nav" style="float: {S_CONTENT_FLOW_END};"><!-- INCLUDE pagination.html --></div>
+
+<br clear="all" /><br />
+
+<!-- INCLUDE breadcrumbs.html -->
+
+<br clear="all" />
+
+<div align="{S_CONTENT_FLOW_END}"><!-- INCLUDE jumpbox.html --></div>
+
+<!-- INCLUDE overall_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/simple_footer.html phpbb/styles/spring/template/simple_footer.html
--- phpBB-3.0.10/styles/spring/template/simple_footer.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/simple_footer.html	2014-04-15 14:31:18.724429005 +0200
@@ -0,0 +1,9 @@
+
+</div>
+
+<div id="wrapfooter">
+	<span class="copyright">Powered by <a href="http://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Group</span>
+</div>
+
+</body>
+</html>
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/simple_header.html phpbb/styles/spring/template/simple_header.html
--- phpBB-3.0.10/styles/spring/template/simple_header.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/simple_header.html	2014-04-15 14:31:18.725429005 +0200
@@ -0,0 +1,22 @@
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
+<html xmlns="http://www.w3.org/1999/xhtml" dir="{S_CONTENT_DIRECTION}" lang="{S_USER_LANG}" xml:lang="{S_USER_LANG}">
+<head>
+
+<meta http-equiv="content-type" content="text/html; charset={S_CONTENT_ENCODING}" />
+<meta http-equiv="content-language" content="{S_USER_LANG}" />
+<meta http-equiv="content-style-type" content="text/css" />
+<meta http-equiv="imagetoolbar" content="no" />
+<meta name="resource-type" content="document" />
+<meta name="distribution" content="global" />
+<meta name="keywords" content="" />
+<meta name="description" content="" />
+{META}
+<title>{SITENAME} &bull; <!-- IF S_IN_MCP -->{L_MCP} &bull; <!-- ELSEIF S_IN_UCP -->{L_UCP} &bull; <!-- ENDIF -->{PAGE_TITLE}</title>
+
+<link rel="stylesheet" href="{T_STYLESHEET_LINK}" type="text/css" />
+<meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0;">
+</head>
+
+<body class="{S_CONTENT_DIRECTION}">
+<a name="top"></a>
+<div id="wrapcentre">
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/template.cfg phpbb/styles/spring/template/template.cfg
--- phpBB-3.0.10/styles/spring/template/template.cfg	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/template.cfg	2014-04-15 14:31:18.725429005 +0200
@@ -0,0 +1,23 @@
+#
+# phpBB Template Configuration File
+#
+# @package phpBB3
+# @copyright (c) 2005 phpBB Group
+# @license http://opensource.org/licenses/gpl-license.php GNU Public License
+#
+#
+# At the left is the name, please do not change this
+# At the right the value is entered
+# For on/off options the valid values are on, off, 1, 0, true and false
+#
+# Values get trimmed, if you want to add a space in front or at the end of
+# the value, then enclose the value with single or double quotes.
+# Single and double quotes do not need to be escaped.
+#
+#
+
+# General Information about this template
+name = subsilver2spring
+copyright = &copy; phpBB Group, 2003
+version = 3.0.10
+
diff -ruN phpBB-3.0.10/styles/spring/template/ucp_agreement.html phpbb/styles/spring/template/ucp_agreement.html
--- phpBB-3.0.10/styles/spring/template/ucp_agreement.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/ucp_agreement.html	2014-04-15 14:31:18.726429004 +0200
@@ -0,0 +1,84 @@
+<!-- INCLUDE overall_header.html -->
+
+<!-- IF S_SHOW_COPPA or S_REGISTRATION -->
+
+<!-- IF S_LANG_OPTIONS -->
+<script type="text/javascript">
+// <![CDATA[
+	/**
+	* Change language
+	*/
+	function change_language(lang_iso)
+	{
+		document.forms['register'].change_lang.value = lang_iso;
+		document.forms['register'].submit();
+	}
+
+// ]]>
+</script>
+
+	<form method="post" action="{S_UCP_ACTION}" id="register">
+		<table width="100%" cellspacing="0">
+			<tr>
+				<td class="gensmall" align="{S_CONTENT_FLOW_END}">{L_LANGUAGE}: <select name="lang" id="lang" onchange="change_language(this.value); return false;" title="{L_LANGUAGE}">{S_LANG_OPTIONS}</select></td>
+			</tr>
+		</table>
+		{S_HIDDEN_FIELDS}
+	</form>
+<!-- ENDIF -->
+
+	<form method="post" action="{S_UCP_ACTION}">
+
+	<table class="tablebg" width="100%" cellspacing="1">
+	<tr>
+		<th height="25">{SITENAME} - {L_REGISTRATION}</th>
+	</tr>
+	<tr>
+		<td class="row1" align="center">
+			<table width="90%" cellspacing="2" cellpadding="2" border="0" align="center">
+			<tr>
+				<!-- IF S_SHOW_COPPA -->
+					<td class="gen" align="center"><br />{L_COPPA_BIRTHDAY}<br /><br /><a href="{U_COPPA_NO}">{L_COPPA_NO}</a> :: <a href="{U_COPPA_YES}">{L_COPPA_YES}</a><br /><br /></td>
+				<!-- ELSE -->
+					<td>
+						<span class="genmed"><br />{L_TERMS_OF_USE}<br /><br /></span>
+						<div align="center">
+							<input class="btnlite" type="submit" id="agreed" name="agreed" value="{L_AGREE}" /><br /><br />
+							<input class="btnlite" type="submit" name="not_agreed" value="{L_NOT_AGREE}" />
+						</div>
+					</td>
+				<!-- ENDIF -->
+			</tr>
+			</table>
+		</td>
+	</tr>
+	</table>
+	{S_HIDDEN_FIELDS}
+	{S_FORM_TOKEN}
+	</form>
+
+<!-- ELSEIF S_AGREEMENT -->
+
+	<table class="tablebg" width="100%" cellspacing="1">
+	<tr>
+		<th height="25">{SITENAME} - {AGREEMENT_TITLE}</th>
+	</tr>
+	<tr>
+		<td class="row1" align="center">
+			<table width="90%" cellspacing="2" cellpadding="2" border="0" align="center">
+			<tr>
+				<td>
+					<span class="genmed"><br />{AGREEMENT_TEXT}<br /><br /></span>
+					<div align="center">
+						<a href="{U_BACK}">{L_BACK}</a>
+					</div>
+				</td>
+			</tr>
+			</table>
+		</td>
+	</tr>
+	</table>
+
+<!-- ENDIF -->
+
+<!-- INCLUDE overall_footer.html -->
diff -ruN phpBB-3.0.10/styles/spring/template/ucp_attachments.html phpbb/styles/spring/template/ucp_attachments.html
--- phpBB-3.0.10/styles/spring/template/ucp_attachments.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/ucp_attachments.html	2014-04-15 14:31:18.727429004 +0200
@@ -0,0 +1,58 @@
+<!-- INCLUDE ucp_header.html -->
+
+<!-- IF S_ATTACHMENT_ROWS -->
+
+	<table class="tablebg" width="100%" cellspacing="1">
+	<tr>
+		<th nowrap="nowrap">#</th>
+		<th nowrap="nowrap" width="15%"><a href="{U_SORT_FILENAME}">{L_FILENAME}</a></th>
+		<th nowrap="nowrap" width="5%"><a href="{U_SORT_POST_TIME}">{L_POST_TIME}</a></th>
+		<th nowrap="nowrap" width="5%"><a href="{U_SORT_FILESIZE}">{L_FILESIZE}</a></th>
+		<th nowrap="nowrap" width="5%"><a href="{U_SORT_DOWNLOADS}">{L_DOWNLOADS}</a></th>
+		<th width="2%" nowrap="nowrap">{L_DELETE}</th>
+	</tr>
+	<!-- IF TOTAL_ATTACHMENTS -->
+		<tr>
+			<td class="row3" colspan="6">
+				<table width="100%" cellspacing="1">
+				<tr>
+					<td class="nav" valign="middle" nowrap="nowrap">&nbsp;{PAGE_NUMBER}<br /></td>
+					<td class="gensmall" nowrap="nowrap">&nbsp;[ {TOTAL_ATTACHMENTS} ]&nbsp;</td>
+					<td class="gensmall" width="100%" align="{S_CONTENT_FLOW_END}" nowrap="nowrap"><!-- INCLUDE pagination.html --></td>
+				</tr>
+				</table>
+			</td>
+		</tr>
+	<!-- ENDIF -->
+	<!-- BEGIN attachrow -->
+		<!-- IF attachrow.S_ROW_COUNT is even --><tr class="row2"><!-- ELSE --><tr class="row1"><!-- ENDIF -->
+
+		<td class="genmed" style="padding: 4px;" align="center" width="2%">&nbsp;{attachrow.ROW_NUMBER}&nbsp;</td>
+		<td style="padding: 4px;"><a class="gen" href="{attachrow.U_VIEW_ATTACHMENT}">{attachrow.FILENAME}</a><br /><span class="gensmall"><!-- IF attachrow.S_IN_MESSAGE --><b>{L_PM}: </b><!-- ELSE --><b>{L_TOPIC}: </b><!-- ENDIF --><a href="{attachrow.U_VIEW_TOPIC}">{attachrow.TOPIC_TITLE}</a></span></td>
+		<td class="gensmall" style="padding: 4px;" align="center" valign="middle" nowrap="nowrap">&nbsp;{attachrow.POST_TIME}&nbsp;</td>
+		<td class="genmed" style="padding: 4px;" align="center" valign="middle" nowrap="nowrap">{attachrow.SIZE}</td>
+		<td class="genmed" style="padding: 4px;" align="center">{attachrow.DOWNLOAD_COUNT}</td>
+		<td style="padding: 4px;" align="center" valign="middle"><input type="checkbox" class="radio" name="attachment[{attachrow.ATTACH_ID}]" value="1" /></td>
+	</tr>
+	<!-- END attachrow -->
+	<tr> 
+		<td class="cat" colspan="6"><div style="float: {S_CONTENT_FLOW_BEGIN};"><span class="gensmall">{L_SORT_BY}: </span><select name="sk">{S_SORT_OPTIONS}</select> <select name="sd">{S_ORDER_SELECT}</select>&nbsp;<input class="btnlite" type="submit" name="sort" value="{L_SORT}" /></div><div style="float: {S_CONTENT_FLOW_END};"><input class="btnlite" type="submit" name="delete" value="{L_DELETE_MARKED}" />&nbsp;</div></td>
+	</tr>
+	</table>
+
+	<div style="float: {S_CONTENT_FLOW_END};"><b class="gensmall"><a href="#" onclick="marklist('ucp', 'attachment', true); return false;">{L_MARK_ALL}</a> :: <a href="#" onclick="marklist('ucp', 'attachment', false); return false;">{L_UNMARK_ALL}</a></b></div>
+
+<!-- ELSE -->
+
+	<table class="tablebg" width="100%" cellspacing="1">
+	<tr>
+		<th>{L_TITLE}</th>
+	</tr>
+	<tr class="row1">
+		<td align="center"><b class="genmed">{L_UCP_NO_ATTACHMENTS}</b></td>
+	</tr>
+	</table>
+
+<!-- ENDIF -->
+
+<!-- INCLUDE ucp_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/ucp_footer.html phpbb/styles/spring/template/ucp_footer.html
--- phpBB-3.0.10/styles/spring/template/ucp_footer.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/ucp_footer.html	2014-04-15 14:31:18.727429004 +0200
@@ -0,0 +1,13 @@
+
+	<!-- IF not S_PRIVMSGS or S_SHOW_DRAFTS -->	{S_FORM_TOKEN}</form><!-- ENDIF --></td>
+</tr>
+</table>
+<!-- IF (S_SHOW_PM_BOX or S_EDIT_POST) and S_POST_ACTION -->{S_FORM_TOKEN}</form><!-- ENDIF -->
+
+<br clear="all" />
+
+<!-- INCLUDE breadcrumbs.html -->
+
+<div align="{S_CONTENT_FLOW_END}"><!-- INCLUDE jumpbox.html --></div>
+
+<!-- INCLUDE overall_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/ucp_groups_manage.html phpbb/styles/spring/template/ucp_groups_manage.html
--- phpBB-3.0.10/styles/spring/template/ucp_groups_manage.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/ucp_groups_manage.html	2014-04-15 14:31:18.729429004 +0200
@@ -0,0 +1,257 @@
+<!-- INCLUDE ucp_header.html -->
+
+<!-- IF S_EDIT -->
+
+	<!-- IF S_ERROR -->
+		<div class="errorbox">
+			<h3>{L_WARNING}</h3>
+			<p>{ERROR_MSG}</p>
+		</div>
+	<!-- ENDIF -->
+
+	<table class="tablebg" width="100%" cellspacing="1">
+	<tr>
+		<th colspan="2">{L_USERGROUPS}</th>
+	</tr>
+	<tr>
+		<td class="row1" colspan="2"><span class="genmed">{L_GROUPS_EXPLAIN}</span></td>
+	</tr>
+
+	<tr>
+		<th colspan="2">{L_GROUP_DETAILS}</th>
+	</tr>
+	<tr>
+		<td class="row1" width="35%"><label<!-- IF not S_SPECIAL_GROUP --> for="group_name"<!-- ENDIF -->>{L_GROUP_NAME}:</label></td>
+		<td class="row2"><!-- IF S_SPECIAL_GROUP --><b<!-- IF GROUP_COLOUR --> style="color: #{GROUP_COLOUR};"<!-- ENDIF -->>{GROUP_NAME}</b><!-- ENDIF --><input name="group_name" type="<!-- IF S_SPECIAL_GROUP -->hidden<!-- ELSE -->text<!-- ENDIF -->" id="group_name" value="{GROUP_INTERNAL_NAME}" /></td>
+	</tr>
+	<tr>
+		<td class="row1" width="35%"><label for="group_desc">{L_GROUP_DESC}:</label></td>
+		<td class="row2"><textarea id="group_desc" name="group_desc" rows="5" cols="45">{GROUP_DESC}</textarea>
+			<br /><input type="checkbox" class="radio" name="desc_parse_bbcode"<!-- IF S_DESC_BBCODE_CHECKED --> checked="checked"<!-- ENDIF --> /> {L_PARSE_BBCODE} &nbsp; <input type="checkbox" class="radio" name="desc_parse_smilies"<!-- IF S_DESC_SMILIES_CHECKED --> checked="checked"<!-- ENDIF --> /> {L_PARSE_SMILIES} &nbsp; <input type="checkbox" class="radio" name="desc_parse_urls"<!-- IF S_DESC_URLS_CHECKED --> checked="checked"<!-- ENDIF --> /> {L_PARSE_URLS}
+		</td>
+	</tr>
+	<!-- IF not S_SPECIAL_GROUP -->
+		<tr>
+			<td class="row1" width="35%"><label for="group_type">{L_GROUP_TYPE}:</label><br /><span>{L_GROUP_TYPE_EXPLAIN}</span></td>
+			<td class="row2">
+				<input name="group_type" type="radio" class="radio" id="group_type" value="{GROUP_TYPE_FREE}"{GROUP_FREE} /> {L_GROUP_OPEN} &nbsp;
+				<input name="group_type" type="radio" class="radio" value="{GROUP_TYPE_OPEN}"{GROUP_OPEN} /> {L_GROUP_REQUEST} &nbsp;
+				<input name="group_type" type="radio" class="radio" value="{GROUP_TYPE_CLOSED}"{GROUP_CLOSED} /> {L_GROUP_CLOSED} &nbsp;
+				<input name="group_type" type="radio" class="radio" value="{GROUP_TYPE_HIDDEN}"{GROUP_HIDDEN} /> {L_GROUP_HIDDEN}
+			</td>
+		</tr>
+	<!-- ELSE -->
+		<tr style="display:none;"><td><input name="group_type" type="hidden" value="{GROUP_TYPE_SPECIAL}" /></td></tr>
+	<!-- ENDIF -->
+
+	<tr>
+		<th colspan="2">{L_GROUP_SETTINGS_SAVE}</th>
+	</tr>
+	<tr>
+		<td class="row1" width="35%"><label for="group_colour">{L_GROUP_COLOR}:</label><br /><span>{L_GROUP_COLOR_EXPLAIN}</span></td>
+		<td class="row2"><input name="group_colour" type="text" id="group_colour" value="{GROUP_COLOUR}" size="6" maxlength="6" />&nbsp;&nbsp;<span>[ <a href="{U_SWATCH}" onclick="popup(this.href, 636, 150, '_swatch'); return false;">{L_COLOUR_SWATCH}</a> ]</span></td>
+	</tr>
+	<tr>
+		<td class="row1" width="35%"><label for="group_rank">{L_GROUP_RANK}:</label></td>
+		<td class="row2"><select name="group_rank" id="group_rank">{S_RANK_OPTIONS}</select></td>
+	</tr>
+	<tr>
+		<th colspan="2">{L_GROUP_AVATAR}</th>
+	</tr>
+	<tr>
+		<td class="row1" width="35%"><label>{L_CURRENT_IMAGE}:</label><br /><span>{L_AVATAR_EXPLAIN}</span></td>
+		<td class="row2">{AVATAR_IMAGE}<br /><br /><input type="checkbox" class="radio" name="delete" />&nbsp;<span>{L_DELETE_AVATAR}</span></td>
+	</tr>
+	<!-- IF not S_IN_AVATAR_GALLERY -->
+		<!-- IF S_UPLOAD_AVATAR_FILE -->
+			<tr>
+				<td class="row1" width="35%"><label for="uploadfile">{L_UPLOAD_AVATAR_FILE}:</label></td>
+				<td class="row2"><input type="hidden" name="MAX_FILE_SIZE" value="{AVATAR_MAX_FILESIZE}" /><input type="file" id="uploadfile" name="uploadfile" /></td>
+			</tr>
+		<!-- ENDIF -->
+		<!-- IF S_UPLOAD_AVATAR_URL -->
+			<tr>
+				<td class="row1" width="35%"><label for="uploadurl">{L_UPLOAD_AVATAR_URL}:</label><br /><span>{L_UPLOAD_AVATAR_URL_EXPLAIN}</span></td>
+				<td class="row2"><input name="uploadurl" type="text" id="uploadurl" value="" /></td>
+			</tr>
+		<!-- ENDIF -->
+		<!-- IF S_LINK_AVATAR -->
+		<tr>
+			<td class="row1" width="35%"><label for="remotelink">{L_LINK_REMOTE_AVATAR}:</label><br /><span>{L_LINK_REMOTE_AVATAR_EXPLAIN}</span></td>
+			<td class="row2"><input name="remotelink" type="text" id="remotelink" value="" /></td>
+		</tr>
+		<tr>
+			<td class="row1" width="35%"><label for="width">{L_LINK_REMOTE_SIZE}:</label><br /><span>{L_LINK_REMOTE_SIZE_EXPLAIN}</span></td>
+			<td class="row2"><input name="width" type="text" id="width" size="3" value="{AVATAR_WIDTH}" /> <span>px X </span> <input type="text" name="height" size="3" value="{AVATAR_HEIGHT}" /> <span>px</span></td>
+		</tr>
+		<!-- ENDIF -->
+		<!-- IF S_DISPLAY_GALLERY -->
+			<tr>
+				<td class="row1" width="35%"><label>{L_AVATAR_GALLERY}:</label></td>
+				<td class="row2"><input class="btnmain" type="submit" name="display_gallery" value="{L_DISPLAY_GALLERY}" /></td>
+			</tr>
+		<!-- ENDIF -->
+	<!-- ELSE -->
+
+		<tr>
+			<th colspan="2">{L_AVATAR_GALLERY}</th>
+		</tr>
+		<tr>
+			<td class="row1" width="35%"><label for="category">{L_AVATAR_CATEGORY}:</label></td>
+			<td class="row2"><select name="category" id="category">{S_CAT_OPTIONS}</select>&nbsp;<input class="btnmain" type="submit" value="{L_GO}" name="display_gallery" /></td>
+		</tr>
+		<tr>
+			<td class="row1" width="35%">
+				<table cellspacing="1">
+				<!-- BEGIN avatar_row -->
+				<tr>
+					<!-- BEGIN avatar_column -->
+						<td class="row1" style="text-align: center;"><img src="{avatar_row.avatar_column.AVATAR_IMAGE}" alt="{avatar_row.avatar_column.AVATAR_NAME}" title="{avatar_row.avatar_column.AVATAR_NAME}" /></td>
+					<!-- END avatar_column -->
+				</tr>
+				<tr>
+					<!-- BEGIN avatar_option_column -->
+						<td class="row2" style="text-align: center;"><input type="radio" class="radio" name="avatar_select" value="{avatar_row.avatar_option_column.S_OPTIONS_AVATAR}" /></td>
+					<!-- END avatar_option_column -->
+				</tr>
+				<!-- END avatar_row -->
+				</table>
+			</td>
+			<td class="row2"><input class="btnmain" type="submit" name="cancel" value="{L_CANCEL}" /></td>
+		</tr>
+
+	<!-- ENDIF -->
+
+	<tr>
+		<td class="cat" colspan="2" align="center"><input class="btnlite" type="submit" id="submit" name="update" value="{L_SUBMIT}" />&nbsp;
+		<input class="btnmain" type="reset" id="reset" name="reset" value="{L_RESET}" /></td>
+	</tr>
+	</table>
+
+<!-- ELSEIF S_LIST -->
+
+	<h1>{L_GROUP_MEMBERS}</h1>
+
+	<p>{L_GROUP_MEMBERS_EXPLAIN}</p>
+
+	<table class="tablebg" width="100%" cellspacing="1">
+	<tr>
+		<th>{L_USERNAME}</th>
+		<th>{L_GROUP_DEFAULT}</th>
+		<th>{L_JOINED}</th>
+		<th>{L_POSTS}</th>
+		<th>{L_MARK}</th>
+	</tr>
+
+	<tr>
+		<td class="row3" colspan="5"><b>{L_GROUP_LEAD}</b></td>
+	</tr>
+	<!-- BEGIN leader -->
+		<!-- IF leader.S_ROW_COUNT is even --><tr class="row1"><!-- ELSE --><tr class="row2"><!-- ENDIF -->
+			<td>{leader.USERNAME_FULL}</td>
+			<td style="text-align: center;"><!-- IF leader.S_GROUP_DEFAULT -->{L_YES}<!-- ELSE -->{L_NO}<!-- ENDIF --></td>
+			<td style="text-align: center;">{leader.JOINED}</td>
+			<td style="text-align: center;">{leader.USER_POSTS}</td>
+			<td style="text-align: center;"></td>
+		</tr>
+	<!-- END leader -->
+
+	<!-- BEGIN member -->
+		<!-- IF member.S_PENDING -->
+			<tr>
+				<td class="row3" colspan="5"><b>{L_GROUP_PENDING}</b></td>
+			</tr>
+		<!-- ELSEIF member.S_APPROVED -->
+			<tr>
+				<td class="row3" colspan="5"><b>{L_GROUP_APPROVED}</b></td>
+			</tr>
+		<!-- ELSE -->
+			<!-- IF member.S_ROW_COUNT is even --><tr class="row1"><!-- ELSE --><tr class="row2"><!-- ENDIF -->
+				<td>{member.USERNAME_FULL}</td>
+				<td style="text-align: center;"><!-- IF member.S_GROUP_DEFAULT -->{L_YES}<!-- ELSE -->{L_NO}<!-- ENDIF --></td>
+				<td style="text-align: center;">{member.JOINED}</td>
+				<td style="text-align: center;">{member.USER_POSTS}</td>
+				<td style="text-align: center;"><input type="checkbox" class="radio" name="mark[]" value="{member.USER_ID}" /></td>
+			</tr>
+		<!-- ENDIF -->
+	<!-- BEGINELSE -->
+		<tr>
+			<td class="row1" colspan="5" style="text-align: center;">{L_GROUPS_NO_MEMBERS}</td>
+		</tr>
+	<!-- END member -->
+	<tr>
+		<td class="cat" colspan="5" align="center"><div style="float: {S_CONTENT_FLOW_END};"><span class="small"><a href="#" onclick="marklist('ucp', 'mark', true); return false;">{L_MARK_ALL}</a> :: <a href="#" onclick="marklist('ucp', 'mark', false); return false;">{L_UNMARK_ALL}</a></span></div><div style="float: {S_CONTENT_FLOW_BEGIN};"><select name="action"><option class="sep" value="">{L_SELECT_OPTION}</option>{S_ACTION_OPTIONS}</select> <input class="btnmain" type="submit" name="update" value="{L_SUBMIT}" /></div></td>
+	</tr>
+	</table>
+
+	<div class="pagination" style="float: {S_CONTENT_FLOW_BEGIN};">
+		<!-- IF PAGINATION -->
+			<!-- INCLUDE pagination.html -->
+		<!-- ELSE -->
+			{S_ON_PAGE}
+		<!-- ENDIF -->
+	</div>
+
+	<br />
+	<br />
+
+	<h1>{L_ADD_USERS}</h1>
+
+	<p>{L_ADD_USERS_UCP_EXPLAIN}</p>
+
+	<table class="tablebg" width="100%" cellspacing="1">
+	<tr>
+		<th colspan="2">{L_ADD_USERS}</th>
+	</tr>
+	<tr>
+		<td class="row1"><label for="default">{L_USER_GROUP_DEFAULT}:</label><br /><span>{L_USER_GROUP_DEFAULT_EXPLAIN}</span></td>
+		<td class="row2"><input name="default" type="radio" class="radio" value="1" /> {L_YES} &nbsp; <input name="default" type="radio" class="radio" id="default" value="0" checked="checked" /> {L_NO}</td>
+	</tr>
+	<tr>
+		<td class="row1"><label for="usernames">{L_USERNAME}:</label><br /><span>{L_USERNAMES_EXPLAIN}</span></td>
+		<td class="row2"><textarea id="usernames" name="usernames" cols="40" rows="5"></textarea><br />[ <a href="{U_FIND_USERNAME}" onclick="find_username(this.href); return false;">{L_FIND_USERNAME}</a> ]</td>
+	</tr>
+	<tr>
+		<td class="cat" colspan="2" align="center"><input class="btnmain" type="submit" name="addusers" value="{L_SUBMIT}" /></td>
+	</tr>
+	</table>
+
+<!-- ELSE -->
+
+	<table class="tablebg" width="100%" cellspacing="1">
+	<tr>
+		<th colspan="3">{L_USERGROUPS}</th>
+	</tr>
+	<tr>
+		<td class="row1" colspan="3"><span class="genmed">{L_GROUPS_EXPLAIN}</span></td>
+	</tr>
+
+	<tr>
+		<th>{L_GROUP_DETAILS}</th>
+		<th colspan="2">{L_OPTIONS}</th>
+	</tr>
+	<tr>
+		<td class="row3" colspan="3"><b class="gensmall">{L_GROUP_LEADER}</b></td>
+	</tr>
+	<!-- BEGIN leader -->
+		<!-- IF leader.S_ROW_COUNT is odd --><tr class="row1"><!-- ELSE --><tr class="row2"><!-- ENDIF -->
+
+		<td><b class="genmed"<!-- IF leader.GROUP_COLOUR --> style="color: #{leader.GROUP_COLOUR};"<!-- ENDIF -->>{leader.GROUP_NAME}</b><!-- IF leader.GROUP_DESC --><p class="forumdesc">{leader.GROUP_DESC}</p><!-- ENDIF --></td>
+		<td style="text-align: center;"><a href="{leader.U_EDIT}">{L_EDIT}</a></td>
+		<td style="text-align: center;"><a href="{leader.U_LIST}">{L_GROUP_LIST}</a></td>
+
+	</tr>
+	<!-- BEGINELSE -->
+		<tr>
+			<td class="row2" align="center" colspan="3"><b class="genmed">{L_NO_LEADERS}</b></td>
+		</tr>
+	<!-- END leader -->
+
+	<tr>
+		<td class="cat" align="{S_CONTENT_FLOW_END}" colspan="3">&nbsp;</td>
+	</tr>
+	</table>
+
+<!-- ENDIF -->
+
+<!-- INCLUDE ucp_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/ucp_groups_membership.html phpbb/styles/spring/template/ucp_groups_membership.html
--- phpBB-3.0.10/styles/spring/template/ucp_groups_membership.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/ucp_groups_membership.html	2014-04-15 14:31:18.730429004 +0200
@@ -0,0 +1,93 @@
+<!-- INCLUDE ucp_header.html -->
+
+<table class="tablebg" width="100%" cellspacing="1">
+<tr>
+	<th colspan="3">{L_USERGROUPS}</th>
+</tr>
+<tr>
+	<td class="row1" colspan="3"><span class="genmed">{L_GROUPS_EXPLAIN}</span></td>
+</tr>
+
+<tr>
+	<th colspan="2">{L_GROUP_DETAILS}</th>
+	<th>{L_SELECT}</th>
+</tr>
+
+<!-- BEGIN leader -->
+	<!-- IF leader.S_FIRST_ROW -->
+		<tr>
+			<td class="row3" colspan="3"><b class="gensmall">{L_GROUP_LEADER}</b></td>
+		</tr>
+	<!-- ENDIF -->
+
+	<!-- IF leader.S_ROW_COUNT is even --><tr class="row1"><!-- ELSE --><tr class="row2"><!-- ENDIF -->
+		<td width="6%" align="center" nowrap="nowrap"><!-- IF S_CHANGE_DEFAULT --><input type="radio" class="radio" name="default"<!-- IF leader.S_GROUP_DEFAULT --> checked="checked"<!-- ENDIF --> value="{leader.GROUP_ID}" /><!-- ENDIF --></td>
+		<td>
+			<b class="genmed"><a href="{leader.U_VIEW_GROUP}"<!-- IF leader.GROUP_COLOUR --> style="color: #{leader.GROUP_COLOUR};"<!-- ENDIF -->>{leader.GROUP_NAME}</a></b>
+			<!-- IF leader.GROUP_DESC --><br /><span class="genmed">{leader.GROUP_DESC}</span><!-- ENDIF -->
+			<!-- IF not leader.GROUP_SPECIAL --><br /><i class="gensmall">{leader.GROUP_STATUS}</i><!-- ENDIF -->
+		</td>
+		<td width="6%" align="center" nowrap="nowrap"><!-- IF not leader.GROUP_SPECIAL --><input type="radio" class="radio" name="selected" value="{leader.GROUP_ID}" /><!-- ENDIF --></td>
+	</tr>
+<!-- END leader -->
+
+<!-- BEGIN member -->
+	<!-- IF member.S_FIRST_ROW -->
+		<tr>
+			<td class="row3" colspan="3"><b class="gensmall">{L_GROUP_MEMBER}</b></td>
+		</tr>
+	<!-- ENDIF -->
+
+	<!-- IF member.S_ROW_COUNT is even --><tr class="row1"><!-- ELSE --><tr class="row2"><!-- ENDIF -->
+		<td width="6%" align="center" nowrap="nowrap"><!-- IF S_CHANGE_DEFAULT --><input type="radio" class="radio" name="default"<!-- IF member.S_GROUP_DEFAULT --> checked="checked"<!-- ENDIF --> value="{member.GROUP_ID}" /><!-- ENDIF --></td>
+		<td>
+			<b class="genmed"><a href="{member.U_VIEW_GROUP}"<!-- IF member.GROUP_COLOUR --> style="color: #{member.GROUP_COLOUR};"<!-- ENDIF -->>{member.GROUP_NAME}</a></b>
+			<!-- IF member.GROUP_DESC --><br /><span class="genmed">{member.GROUP_DESC}</span><!-- ENDIF -->
+			<!-- IF not member.GROUP_SPECIAL --><br /><i class="gensmall">{member.GROUP_STATUS}</i><!-- ENDIF -->
+		</td>
+		<td width="6%" align="center" nowrap="nowrap"><!-- IF not member.GROUP_SPECIAL --><input type="radio" class="radio" name="selected" value="{member.GROUP_ID}" /><!-- ENDIF --></td>
+	</tr>
+<!-- END member -->
+
+<!-- BEGIN pending -->
+	<!-- IF pending.S_FIRST_ROW -->
+		<tr>
+			<td class="row3" colspan="3"><b class="gensmall">{L_GROUP_PENDING}</b></td>
+		</tr>
+	<!-- ENDIF -->
+
+	<!-- IF pending.S_ROW_COUNT is even --><tr class="row1"><!-- ELSE --><tr class="row2"><!-- ENDIF -->
+		<td width="6%" align="center" nowrap="nowrap">&nbsp;</td>
+		<td>
+			<b class="genmed"><a href="{pending.U_VIEW_GROUP}"<!-- IF pending.GROUP_COLOUR --> style="color: #{pending.GROUP_COLOUR};"<!-- ENDIF -->>{pending.GROUP_NAME}</a></b>
+			<!-- IF pending.GROUP_DESC --><br /><span class="genmed">{pending.GROUP_DESC}</span><!-- ENDIF -->
+			<!-- IF not pending.GROUP_SPECIAL --><br /><i class="gensmall">{pending.GROUP_STATUS}</i><!-- ENDIF -->
+		</td>
+		<td width="6%" align="center" nowrap="nowrap"><!-- IF not pending.GROUP_SPECIAL --><input type="radio" class="radio" name="selected" value="{pending.GROUP_ID}" /><!-- ENDIF --></td>
+	</tr>
+<!-- END pending -->
+
+<!-- BEGIN nonmember -->
+	<!-- IF nonmember.S_FIRST_ROW -->
+		<tr>
+			<td class="row3" colspan="3"><b class="gensmall">{L_GROUP_NONMEMBER}</b></td>
+		</tr>
+	<!-- ENDIF -->
+
+	<!-- IF nonmember.S_ROW_COUNT is even --><tr class="row1"><!-- ELSE --><tr class="row2"><!-- ENDIF -->
+		<td width="6%" align="center" nowrap="nowrap">&nbsp;</td>
+		<td>
+			<b class="genmed"><a href="{nonmember.U_VIEW_GROUP}"<!-- IF nonmember.GROUP_COLOUR --> style="color: #{nonmember.GROUP_COLOUR};"<!-- ENDIF -->>{nonmember.GROUP_NAME}</a></b>
+			<!-- IF nonmember.GROUP_DESC --><br /><span class="genmed">{nonmember.GROUP_DESC}</span><!-- ENDIF -->
+			<!-- IF not nonmember.GROUP_SPECIAL --><br /><i class="gensmall">{nonmember.GROUP_STATUS}</i><!-- ENDIF -->
+		</td>
+		<td width="6%" align="center" nowrap="nowrap"><!-- IF nonmember.S_CAN_JOIN --><input type="radio" class="radio" name="selected" value="{nonmember.GROUP_ID}" /><!-- ENDIF --></td>
+	</tr>
+<!-- END nonmember -->
+
+<tr>
+	<td class="cat" colspan="3"><!-- IF S_CHANGE_DEFAULT --><div style="float: {S_CONTENT_FLOW_BEGIN};"><input class="btnlite" type="submit" name="change_default" value="{L_CHANGE_DEFAULT_GROUP}" /></div><!-- ENDIF --><div style="float: {S_CONTENT_FLOW_END};"><span class="genmed">{L_SELECT}: </span><select name="action"><option value="join">{L_JOIN_SELECTED}</option><option value="resign">{L_RESIGN_SELECTED}</option><option value="demote">{L_DEMOTE_SELECTED}</option></select>&nbsp;<input class="btnmain" type="submit" name="submit" value="{L_SUBMIT}" />&nbsp;</div></td>
+</tr>
+</table>
+
+<!-- INCLUDE ucp_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/ucp_header.html phpbb/styles/spring/template/ucp_header.html
--- phpBB-3.0.10/styles/spring/template/ucp_header.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/ucp_header.html	2014-04-15 14:31:18.731429004 +0200
@@ -0,0 +1,163 @@
+<!-- INCLUDE overall_header.html -->
+
+
+<!-- IF S_SHOW_PM_BOX and S_POST_ACTION -->
+	<form action="{S_POST_ACTION}" method="post" name="postform"{S_FORM_ENCTYPE}>
+<!-- ENDIF -->
+<table width="100%" cellspacing="0" cellpadding="0" border="0">
+<tr>
+	<td width="20%" valign="top">
+
+<!-- IF S_SHOW_PM_BOX and S_POST_ACTION -->
+	<table class="tablebg" width="100%" cellspacing="1">
+	<tr>
+		<th>{L_PM_TO}</th>
+	</tr>
+	<!-- IF not S_ALLOW_MASS_PM -->
+	<tr>
+		<td class="row1"><b class="genmed">{L_USERNAME}:</b><br />[ <a href="{U_FIND_USERNAME}" onclick="find_username(this.href); return false;">{L_FIND_USERNAME}</a> ]</td>
+	</tr>
+	
+	<tr>
+		<td class="row2"><input class="post" type="text" name="username_list" size="20" value="" />&nbsp;<input class="post" type="submit" name="add_to" value="{L_ADD}" /></td>
+	</tr>
+	<!-- ELSE -->
+		<tr>
+			<td class="row1"><b class="genmed">{L_USERNAMES}:</b></td>
+		</tr>
+		<tr>
+			<td class="row2"><textarea name="username_list" rows="5" cols="22"></textarea><br />
+				[ <a href="{U_FIND_USERNAME}" onclick="find_username(this.href); return false;">{L_FIND_USERNAME}</a> ]
+			</td>
+		</tr>
+	<!-- ENDIF -->
+	<!-- IF S_GROUP_OPTIONS -->
+		<tr>
+			<td class="row1"><b class="genmed">{L_USERGROUPS}:</b></td>
+		</tr>
+		<tr>
+			<td class="row2"><select name="group_list[]" multiple="multiple" size="5" style="width:150px">{S_GROUP_OPTIONS}</select></td>
+		</tr>
+	<!-- ENDIF -->
+	<!-- IF S_ALLOW_MASS_PM -->
+		<tr>
+			<td class="row1"><div style="float: {S_CONTENT_FLOW_BEGIN};">&nbsp;<input class="post" type="submit" name="add_bcc" value="{L_ADD_BCC}" />&nbsp;</div><div style="float: {S_CONTENT_FLOW_END};">&nbsp;<input class="post" type="submit" name="add_to" value="{L_ADD_TO}" />&nbsp;</div></td>
+		</tr>
+	<!-- ENDIF -->
+	</table>
+	<div style="padding: 2px;"></div>
+<!-- ENDIF -->
+
+<table class="tablebg" width="100%" cellspacing="1">
+<tr>
+	<th>{L_OPTIONS}</th>
+</tr>
+
+<!-- BEGIN l_block1 -->
+	<tr>
+		<!-- IF l_block1.S_SELECTED -->
+			<td class="row1"><b class="nav">{l_block1.L_TITLE}</b>
+
+			<!-- IF S_PRIVMSGS -->
+
+				<!-- the ! at the beginning of the loop name forces the loop to be not a nested one of l_block1 (it gets parsed separately) -->
+				<!-- BEGIN !folder -->
+					<!-- IF folder.S_FIRST_ROW -->
+						<ul class="nav" style="margin: 0; padding: 0; list-style-type: none; line-height: 175%;">
+					<!-- ENDIF -->
+
+					<!-- IF folder.S_CUR_FOLDER -->
+						<li class="row2" style="padding: 1px 0;">&#187; <a href="{folder.U_FOLDER}">{folder.FOLDER_NAME}<!-- IF folder.S_UNREAD_MESSAGES --> ({folder.UNREAD_MESSAGES})<!-- ENDIF --></a></li>
+					<!-- ELSE -->
+						<li>&#187; <a href="{folder.U_FOLDER}">{folder.FOLDER_NAME}<!-- IF folder.S_UNREAD_MESSAGES --> ({folder.UNREAD_MESSAGES})<!-- ENDIF --></a></li>
+					<!-- ENDIF -->
+
+					<!-- IF folder.S_LAST_ROW -->
+						</ul>
+						<hr />
+					<!-- ENDIF -->
+				<!-- END !folder -->
+
+			<!-- ENDIF -->
+
+			<ul class="nav" style="margin: 0; padding: 0; list-style-type: none; line-height: 175%;">
+			<!-- BEGIN l_block2 -->
+				<li>&#187; <!-- IF l_block1.l_block2.S_SELECTED --><b>{l_block1.l_block2.L_TITLE}</b><!-- ELSE --><a href="{l_block1.l_block2.U_TITLE}">{l_block1.l_block2.L_TITLE}</a><!-- ENDIF --></li>
+			<!-- END l_block2 -->
+			</ul>
+		<!-- ELSE -->
+			<td class="row2" nowrap="nowrap" onmouseover="this.className='row1'" onmouseout="this.className='row2'" onclick="location.href=this.firstChild.href;"><a class="nav" href="{l_block1.U_TITLE}">{l_block1.L_TITLE}</a>
+		<!-- ENDIF -->
+		</td>
+	</tr>
+<!-- END l_block1 -->
+</table>
+
+<div style="padding: 2px;"></div>
+
+<!-- IF S_SHOW_COLOUR_LEGEND -->
+	<table class="tablebg" width="100%" cellspacing="1" cellpadding="0">
+	<tr>
+		<th colspan="2">{L_MESSAGE_COLOURS}</th>
+	</tr>
+	<!-- BEGIN pm_colour_info -->
+		<tr>
+			<!-- IF not pm_colour_info.IMG -->
+				<td class="row1 {pm_colour_info.CLASS}" width="5"><img src="images/spacer.gif" width="5" alt="{pm_colour_info.LANG}" /></td>
+			<!-- ELSE -->
+				<td class="row1" width="25" align="center">{pm_colour_info.IMG}</td>
+			<!-- ENDIF -->
+			<td class="row1"><span class="genmed">{pm_colour_info.LANG}</span></td>
+		</tr>
+	<!-- END pm_colour_info -->
+	</table>
+
+	<div style="padding: 2px;"></div>
+<!-- ENDIF -->
+
+<!-- IF S_ZEBRA_ENABLED and S_ZEBRA_FRIENDS_ENABLED -->
+	<table class="tablebg" width="100%" cellspacing="1">
+	<tr>
+		<th>{L_FRIENDS}</th>
+	</tr>
+	<tr>
+		<td class="row1" align="center">
+		
+			<b class="genmed" style="color:green">{L_FRIENDS_ONLINE}</b>
+
+			<ul class="nav" style="margin: 0; padding: 0; list-style-type: none; line-height: 175%;">
+			<!-- BEGIN friends_online -->
+				<li>{friends_online.USERNAME_FULL}
+				<!-- IF S_SHOW_PM_BOX -->
+					&nbsp;[ <input class="post" style="font-size: 90%;" type="submit" name="add_to[{friends_online.USER_ID}]" value="{L_ADD}" /> ]
+				<!-- ENDIF -->
+				</li>
+			<!-- BEGINELSE -->
+				<li>{L_NO_FRIENDS_ONLINE}</li>
+			<!-- END friends_online -->
+			</ul>
+
+			<hr />
+
+			<b class="genmed" style="color:red">{L_FRIENDS_OFFLINE}</b>
+
+			<ul class="nav" style="margin: 0; padding: 0; list-style-type: none; line-height: 175%;">
+			<!-- BEGIN friends_offline -->
+				<li>{friends_offline.USERNAME_FULL}
+				<!-- IF S_SHOW_PM_BOX -->
+					&nbsp;[ <input class="post" style="font-size: 90%;" type="submit" name="add_to[{friends_offline.USER_ID}]" value="{L_ADD}" /> ]
+				<!-- ENDIF -->
+				</li>
+			<!-- BEGINELSE -->
+				<li>{L_NO_FRIENDS_OFFLINE}</li>
+			<!-- END friends_offline -->
+			</ul>
+
+		</td>
+	</tr>
+	</table>
+<!-- ENDIF -->
+
+</td>
+<td><img src="images/spacer.gif" width="4" alt="" /></td>
+<td width="80%" valign="top"><!-- IF not S_PRIVMSGS or S_SHOW_DRAFTS --><form name="ucp" id="ucp" method="post" action="{S_UCP_ACTION}"{S_FORM_ENCTYPE}><!-- ENDIF -->
diff -ruN phpBB-3.0.10/styles/spring/template/ucp_main_bookmarks.html phpbb/styles/spring/template/ucp_main_bookmarks.html
--- phpBB-3.0.10/styles/spring/template/ucp_main_bookmarks.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/ucp_main_bookmarks.html	2014-04-15 14:31:18.732429004 +0200
@@ -0,0 +1,77 @@
+<!-- INCLUDE ucp_header.html -->
+
+<table class="tablebg" width="100%" cellspacing="1">
+<tr>
+	<th colspan="4">{L_UCP}</th>
+</tr>
+<tr>
+	<td class="row1" colspan="4" align="center"><span class="genmed">{L_BOOKMARKS_EXPLAIN}</span></td>
+</tr>
+<!-- IF .topicrow -->
+<tr>
+	<th colspan="4">{L_BOOKMARKS}</th>
+</tr>
+<!-- ENDIF -->
+
+<!-- IF S_NO_DISPLAY_BOOKMARKS -->
+	<tr class="row1">
+		<td colspan="4" align="center"><b class="genmed">{L_BOOKMARKS_DISABLED}</b></td>
+	</tr>
+<!-- ELSE -->
+
+	<!-- IF TOTAL_TOPICS -->
+		<tr>
+			<td class="row3" colspan="4">
+				<table width="100%" cellspacing="1">
+				<tr>
+					<td class="nav" valign="middle" nowrap="nowrap">&nbsp;{PAGE_NUMBER}<br /></td>
+					<td class="gensmall" nowrap="nowrap">&nbsp;[ {TOTAL_TOPICS} ]&nbsp;</td>
+					<td class="gensmall" width="100%" align="{S_CONTENT_FLOW_END}" nowrap="nowrap"><!-- INCLUDE pagination.html --></td>
+				</tr>
+				</table>
+			</td>
+		</tr>
+	<!-- ENDIF -->
+
+	<!-- BEGIN topicrow -->
+
+		<!-- IF topicrow.S_ROW_COUNT is even --><tr class="row1"><!-- ELSE --><tr class="row2"><!-- ENDIF -->
+			<td style="padding: 4px;" width="20" align="center" valign="middle">{topicrow.TOPIC_FOLDER_IMG}</td>
+		<!-- IF topicrow.S_DELETED_TOPIC -->
+			<td class="postdetails" style="padding: 4px" width="100%" colspan="2">{L_DELETED_TOPIC}</td>
+		<!-- ELSE -->
+			<td style="padding: 4px;" width="100%" valign="top">
+				<p class="topictitle"><!-- IF topicrow.S_UNREAD_TOPIC --><a href="{topicrow.U_NEWEST_POST}">{NEWEST_POST_IMG}</a> <!-- ENDIF -->{topicrow.ATTACH_ICON_IMG} <a href="{topicrow.U_VIEW_TOPIC}">{topicrow.TOPIC_TITLE}</a></p>
+				<!-- IF topicrow.S_GLOBAL_TOPIC --><span class="gensmall">{L_GLOBAL_ANNOUNCEMENT}</span><!-- ELSE --><span class="gensmall"><b>{L_FORUM}: </b><a href="{topicrow.U_VIEW_FORUM}">{topicrow.FORUM_NAME}</a></span><!-- ENDIF -->
+				<!-- IF topicrow.PAGINATION -->
+					<p class="gensmall"> [ {GOTO_PAGE_IMG}{L_GOTO_PAGE}: {topicrow.PAGINATION} ] </p>
+				<!-- ENDIF -->
+			</td>
+			<td style="padding: 4px;" align="{S_CONTENT_FLOW_BEGIN}" valign="top" nowrap="nowrap">
+				<p class="topicdetails">{topicrow.LAST_POST_TIME}</p>
+				<p class="topicdetails">{topicrow.LAST_POST_AUTHOR_FULL}
+					<a href="{topicrow.U_LAST_POST}">{LAST_POST_IMG}</a>
+				</p>
+			</td>
+		<!-- ENDIF -->
+			<td style="padding: 4px;"> <input type="checkbox" class="radio" name="t[{topicrow.TOPIC_ID}]" /> </td>
+		</tr>
+	<!-- BEGINELSE -->
+		<tr class="row1">
+			<td colspan="4" align="center"><b class="genmed">{L_NO_BOOKMARKS}</b></td>
+		</tr>
+	<!-- END topicrow -->
+
+		<!-- IF .topicrow -->
+			<tr>
+				<td class="cat" colspan="5" align="{S_CONTENT_FLOW_END}"><input class="btnlite" type="submit" name="unbookmark" value="{L_REMOVE_BOOKMARK_MARKED}" />&nbsp;</td>
+			</tr>
+		<!-- ENDIF -->
+	<!-- ENDIF -->
+</table>
+
+<!-- IF not S_NO_DISPLAY_BOOKMARKS and .topicrow -->
+	<div class="gensmall" style="float: {S_CONTENT_FLOW_END}; padding-top: 2px;"><b><a href="#" onclick="marklist('ucp', 't', true); return false;">{L_MARK_ALL}</a> :: <a href="#" onclick="marklist('ucp', 't', false); return false;">{L_UNMARK_ALL}</a></b></div>
+<!-- ENDIF -->
+
+<!-- INCLUDE ucp_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/ucp_main_drafts.html phpbb/styles/spring/template/ucp_main_drafts.html
--- phpBB-3.0.10/styles/spring/template/ucp_main_drafts.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/ucp_main_drafts.html	2014-04-15 14:31:18.733429004 +0200
@@ -0,0 +1,101 @@
+<!-- INCLUDE ucp_header.html -->
+
+<table class="tablebg" width="100%" cellspacing="1">
+<tr>
+	<th colspan="4">{L_UCP}</th>
+</tr>
+<tr>
+	<td class="row1" colspan="4" align="center"><span class="genmed">{L_DRAFTS_EXPLAIN}</span></td>
+</tr>
+
+<!-- IF ERROR -->
+	<tr>
+		<td class="row1" colspan="2" align="center"><span class="genmed error">{ERROR}</span></td>
+	</tr>
+<!-- ENDIF -->
+
+<!-- IF not S_EDIT_DRAFT -->
+
+	<!-- IF S_DRAFT_ROWS -->
+	<tr>
+		<th>{L_SAVE_DATE}</th>
+		<th>{L_DRAFT_TITLE}</th>
+		<th>{L_OPTIONS}</th>
+		<th>{L_DELETE}</th>
+	</tr>
+	<!-- ENDIF -->
+
+	<!-- BEGIN draftrow -->
+
+		<!-- IF draftrow.S_ROW_COUNT is even --><tr class="row1"><!-- ELSE --><tr class="row2"><!-- ENDIF -->
+
+		<td class="postdetails" style="padding: 4px;" nowrap="nowrap">{draftrow.DATE}</td>
+		<td style="padding: 4px;" valign="top" width="100%">
+			<p class="topictitle">{draftrow.DRAFT_SUBJECT}</p>
+			<!-- IF draftrow.S_LINK_TOPIC --><span class="gensmall">{L_TOPIC}: <a href="{draftrow.U_VIEW}">{draftrow.TITLE}</a></span>
+			<!-- ELSEIF draftrow.S_LINK_FORUM --><span class="gensmall">{L_FORUM}: <a href="{draftrow.U_VIEW}">{draftrow.TITLE}</a></span>
+			<!-- ELSEIF draftrow.S_LINK_PM --><span class="gensmall">{L_PRIVATE_MESSAGE}</span>
+			<!-- ELSE --><span class="gensmall">{L_NO_TOPIC_FORUM}</span><!-- ENDIF -->
+		</td>
+		<td style="padding: 4px;" align="center" nowrap="nowrap"><span class="genmed"><!-- IF draftrow.U_INSERT --><a href="{draftrow.U_INSERT}">{L_LOAD_DRAFT}</a><br /><!-- ENDIF --><a href="{draftrow.U_VIEW_EDIT}">{L_VIEW_EDIT}</a></span></td>
+		<td style="padding: 4px;" align="center"><input type="checkbox" class="radio" name="d[{draftrow.DRAFT_ID}]" /></td>
+	</tr>
+	<!-- BEGINELSE -->
+		<tr>
+			<td class="row1" colspan="4" align="center"><b class="genmed">{L_NO_SAVED_DRAFTS}</b></td>
+		</tr>
+	<!-- END draftrow -->
+
+	<!-- IF S_DRAFT_ROWS -->
+		<tr>
+			<td class="cat" colspan="4" align="{S_CONTENT_FLOW_END}"><input class="btnlite" type="submit" name="delete" value="{L_DELETE_MARKED}" />&nbsp;</td>
+		</tr>
+	<!-- ENDIF -->
+
+<!-- ELSEIF S_EDIT_DRAFT -->
+	<tr>
+		<td class="row1" width="22%"><b class="genmed">{L_SUBJECT}:</b></td>
+		<td class="row2"><input class="post" style="width:450px" type="text" name="subject" size="45" maxlength="64" tabindex="2" value="{DRAFT_SUBJECT}" /></td>
+	</tr>
+	<tr> 
+		<td class="row1" width="22%"><b class="genmed">{L_MESSAGE}: </b><br /><span class="gensmall">{L_EDIT_DRAFT_EXPLAIN}</span></td>
+		<td class="row2">
+			<script type="text/javascript">
+			// <![CDATA[
+				var form_name = 'ucp';
+				var text_name = 'message';
+			// ]]>
+			</script>
+			<table cellspacing="0" cellpadding="2" border="0">
+			<!-- INCLUDE posting_buttons.html -->
+			<tr>
+				<td colspan="9"><textarea class="post" name="message" rows="10" cols="70" onselect="storeCaret(this);" onclick="storeCaret(this);" onkeyup="storeCaret(this);" onfocus="initInsertions();">{DRAFT_MESSAGE}</textarea></td>
+			</tr>
+			<tr>
+				<td colspan="9">
+					<table cellspacing="0" cellpadding="0" border="0" width="100%">
+					<tr>
+						<td align="{S_CONTENT_FLOW_BEGIN}">
+							<script type="text/javascript">
+							// <![CDATA[
+								colorPalette('h', 6, 5)
+							// ]]>
+							</script>
+						</td>
+					</tr>
+					</table>
+				</td>
+			</tr>			
+			</table>
+		</td>
+	</tr>
+	<tr class="row1">
+		<td colspan="9" align="{S_CONTENT_FLOW_BEGIN}"><p class="topictitle"><a href="{S_UCP_ACTION}">{L_BACK_TO_DRAFTS}</a></p></td>
+	</tr>
+	<tr>
+		<td class="cat" colspan="2" align="center">{S_HIDDEN_FIELDS}<input class="btnmain" type="submit" name="submit" value="{L_SUBMIT}" />&nbsp;&nbsp;<input class="btnlite" type="reset" value="{L_RESET}" name="reset" /></td>
+	</tr>
+<!-- ENDIF -->
+</table>
+
+<!-- INCLUDE ucp_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/ucp_main_front.html phpbb/styles/spring/template/ucp_main_front.html
--- phpBB-3.0.10/styles/spring/template/ucp_main_front.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/ucp_main_front.html	2014-04-15 14:31:18.733429004 +0200
@@ -0,0 +1,72 @@
+<!-- INCLUDE ucp_header.html -->
+
+<table class="tablebg" width="100%" cellspacing="1">
+<tr>
+	<th colspan="3">{L_UCP}</th>
+</tr>
+<tr>
+	<td class="row1" colspan="3" align="center"><p class="genmed">{L_UCP_WELCOME}</p></td>
+</tr>
+<tr>
+	<th colspan="3">{L_IMPORTANT_NEWS}</th>
+</tr>
+
+<!-- BEGIN topicrow -->
+
+	<!-- IF topicrow.S_ROW_COUNT is even --><tr class="row1"><!-- ELSE --><tr class="row2"><!-- ENDIF -->
+		<td class="row1" width="25" align="center">{topicrow.TOPIC_FOLDER_IMG}</td>
+		<td class="row1" width="100%">
+			<p class="topictitle"><!-- IF topicrow.S_UNREAD --><a href="{topicrow.U_NEWEST_POST}">{NEWEST_POST_IMG}</a> <!-- ENDIF -->{topicrow.ATTACH_ICON_IMG} <a href="{topicrow.U_VIEW_TOPIC}">{topicrow.TOPIC_TITLE}</a></p><p class="gensmall">{topicrow.GOTO_PAGE}</p>
+		</td>
+		<td class="row1" width="120" align="center" nowrap="nowrap">
+			<p class="topicdetails">{topicrow.LAST_POST_TIME}</p>
+			<p class="topicdetails">{topicrow.LAST_POST_AUTHOR_FULL}
+				<a href="{topicrow.U_LAST_POST}">{LAST_POST_IMG}</a>
+			</p>
+		</td>
+	</tr>
+<!-- BEGINELSE -->
+	<tr class="row1">
+		<td align="center" colspan="3"><b class="gen">{L_NO_IMPORTANT_NEWS}</b></td>
+	</tr>
+<!-- END topicrow -->
+
+<tr>
+	<th colspan="3">{L_YOUR_DETAILS}</th>
+</tr>
+<tr>
+	<td class="row1" colspan="3">
+		<table width="100%" cellspacing="1" cellpadding="4">
+		<tr> 
+			<td align="{S_CONTENT_FLOW_END}" valign="top" nowrap="nowrap"><b class="genmed">{L_JOINED}: </b></td>
+			<td width="100%"><b class="gen">{JOINED}</b></td>
+		</tr>
+		<tr> 
+			<td align="{S_CONTENT_FLOW_END}" valign="top" nowrap="nowrap"><b class="genmed">{L_TOTAL_POSTS}: </b></td>
+			<td><!-- IF POSTS_PCT --><b class="gen">{POSTS}</b><br /><span class="genmed">[{POSTS_PCT} / {POSTS_DAY}]<!-- IF S_DISPLAY_SEARCH --><br /><a href="{U_SEARCH_SELF}">{L_SEARCH_YOUR_POSTS}</a><!-- ENDIF --></span><!-- ELSE --><b class="gen">{POSTS}<b><!-- ENDIF --></td>
+		</tr>
+		<!-- IF S_SHOW_ACTIVITY -->
+			<tr>
+				<td align="{S_CONTENT_FLOW_END}" valign="top" nowrap="nowrap"><b class="genmed">{L_ACTIVE_IN_FORUM}: </b></td>
+				<td><!-- IF ACTIVE_FORUM --><b><a class="gen" href="{U_ACTIVE_FORUM}">{ACTIVE_FORUM}</a></b><br /><span class="genmed">[ {ACTIVE_FORUM_POSTS} / {ACTIVE_FORUM_PCT} ]</span><!-- ELSE --><span class="gen">-</span><!-- ENDIF --></td>
+			</tr>
+			<tr>
+				<td align="{S_CONTENT_FLOW_END}" valign="top" nowrap="nowrap"><b class="genmed">{L_ACTIVE_IN_TOPIC}: </b></td>
+				<td><!-- IF ACTIVE_TOPIC --><b><a class="gen" href="{U_ACTIVE_TOPIC}">{ACTIVE_TOPIC}</a></b><br /><span class="genmed">[ {ACTIVE_TOPIC_POSTS} / {ACTIVE_TOPIC_PCT} ]</span><!-- ELSE --><span class="gen">-</span><!-- ENDIF --></td>
+			</tr>
+		<!-- ENDIF -->
+		<!-- IF WARNINGS -->
+			<tr>
+				<td align="{S_CONTENT_FLOW_END}" valign="middle" nowrap="nowrap"><b class="genmed">{L_YOUR_WARNINGS}: </b></td>
+				<td class="genmed">{WARNING_IMG} [ <b>{WARNINGS}</b> ]</td>
+			</tr>
+		<!-- ENDIF -->
+		</table>
+	</td>
+</tr>
+<tr>
+	<td class="cat" colspan="3">&nbsp;</td>
+</tr>
+</table>
+
+<!-- INCLUDE ucp_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/ucp_main_subscribed.html phpbb/styles/spring/template/ucp_main_subscribed.html
--- phpBB-3.0.10/styles/spring/template/ucp_main_subscribed.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/ucp_main_subscribed.html	2014-04-15 14:31:18.734429004 +0200
@@ -0,0 +1,84 @@
+<!-- INCLUDE ucp_header.html -->
+
+<table class="tablebg" width="100%" cellspacing="1">
+<tr>
+	<th colspan="4">{L_UCP}</th>
+</tr>
+<tr>
+	<td class="row1" colspan="4" align="center"><span class="genmed">{L_WATCHED_EXPLAIN}</span></td>
+</tr>
+<!-- IF S_FORUM_NOTIFY -->
+	<tr>
+		<th colspan="4">{L_WATCHED_FORUMS}</th>
+	</tr>
+
+	<!-- BEGIN forumrow -->
+
+		<!-- IF forumrow.S_ROW_COUNT is even --><tr class="row1"><!-- ELSE --><tr class="row2"><!-- ENDIF -->
+			<td style="padding: 4px;" width="20" align="center" valign="middle">{forumrow.FORUM_FOLDER_IMG}</td>
+			<td style="padding: 4px;" width="100%"><p class="topictitle"><a href="{forumrow.U_VIEWFORUM}">{forumrow.FORUM_NAME}</a></p></td>
+			<td class="gensmall" style="padding: 4px;" align="center" valign="middle" nowrap="nowrap"><!-- IF forumrow.LAST_POST_TIME -->{forumrow.LAST_POST_TIME}<br />{forumrow.LAST_POST_AUTHOR_FULL} <a href="{forumrow.U_LAST_POST}">{LAST_POST_IMG}</a><!-- ELSE -->{L_NO_POSTS}<!-- ENDIF --></td>
+			<td style="padding: 4px;"> <input type="checkbox" class="radio" name="f[{forumrow.FORUM_ID}]" /> </td>
+		</tr>
+	<!-- BEGINELSE -->
+		<tr class="row1">
+			<td colspan="4" align="center"><b class="genmed">{L_NO_WATCHED_FORUMS}</b></td>
+		</tr>
+	<!-- END forumrow -->
+<!-- ENDIF -->
+<!-- IF S_TOPIC_NOTIFY -->
+	<tr>
+		<th colspan="4">{L_WATCHED_TOPICS}</th>
+	</tr>
+
+	<!-- IF TOTAL_TOPICS -->
+		<tr>
+			<td class="row3" colspan="4">
+				<table width="100%" cellspacing="1">
+				<tr>
+					<td class="nav" valign="middle" nowrap="nowrap">&nbsp;{PAGE_NUMBER}<br /></td>
+					<td class="gensmall" nowrap="nowrap">&nbsp;[ {TOTAL_TOPICS} ]&nbsp;</td>
+					<td class="gensmall" width="100%" align="{S_CONTENT_FLOW_END}" nowrap="nowrap"><!-- INCLUDE pagination.html --></td>
+				</tr>
+				</table>
+			</td>
+		</tr>
+	<!-- ENDIF -->
+
+	<!-- BEGIN topicrow -->
+
+		<!-- IF topicrow.S_ROW_COUNT is even --><tr class="row1"><!-- ELSE --><tr class="row2"><!-- ENDIF -->
+			<td style="padding: 4px;" width="20" align="center" valign="middle">{topicrow.TOPIC_FOLDER_IMG}</td>
+			<td style="padding: 4px;" width="100%" valign="top">
+				<p class="topictitle"><!-- IF topicrow.S_UNREAD_TOPIC --><a href="{topicrow.U_NEWEST_POST}">{NEWEST_POST_IMG}</a> <!-- ENDIF -->{topicrow.ATTACH_ICON_IMG} <a href="{topicrow.U_VIEW_TOPIC}">{topicrow.TOPIC_TITLE}</a></p>
+				<!-- IF topicrow.S_GLOBAL_TOPIC --><span class="gensmall">{L_GLOBAL_ANNOUNCEMENT}</span><!-- ELSE --><span class="gensmall"><b>{L_FORUM}: </b><a href="{topicrow.U_VIEW_FORUM}">{topicrow.FORUM_NAME}</a></span><!-- ENDIF -->
+				<!-- IF topicrow.PAGINATION -->
+					<p class="gensmall"> [ {GOTO_PAGE_IMG}{L_GOTO_PAGE}: {topicrow.PAGINATION} ] </p>
+				<!-- ENDIF -->
+			</td>
+			<td style="padding: 4px;" align="{S_CONTENT_FLOW_BEGIN}" valign="top" nowrap="nowrap">
+				<p class="topicdetails">{topicrow.LAST_POST_TIME}</p>
+				<p class="topicdetails">{topicrow.LAST_POST_AUTHOR_FULL}
+					<a href="{topicrow.U_LAST_POST}">{LAST_POST_IMG}</a>
+				</p>
+			</td>
+			<td style="padding: 4px;"> <input type="checkbox" class="radio" name="t[{topicrow.TOPIC_ID}]" /> </td>
+		</tr>
+	<!-- BEGINELSE -->
+		<tr class="row1">
+			<td colspan="4" align="center"><b class="genmed">{L_NO_WATCHED_TOPICS}</b></td>
+		</tr>
+	<!-- END topicrow -->
+<!-- ENDIF -->
+
+<!-- IF .topicrow or .forumrow -->
+<tr>
+	<td class="cat" colspan="4" align="{S_CONTENT_FLOW_END}"><input class="btnlite" type="submit" name="unwatch" value="{L_UNWATCH_MARKED}" />&nbsp;</td>
+</tr>
+<!-- ENDIF -->
+</table>
+<!-- IF .topicrow or .forumrow -->
+<div class="gensmall" style="float: {S_CONTENT_FLOW_END}; padding-top: 2px;"><b><a href="#" onclick="marklist('ucp', 't', true); marklist('ucp', 'f', true); return false;">{L_MARK_ALL}</a> :: <a href="#" onclick="marklist('ucp', 't', false);marklist('ucp', 'f', false); return false;">{L_UNMARK_ALL}</a></b></div>
+<!-- ENDIF -->
+
+<!-- INCLUDE ucp_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/ucp_pm_history.html phpbb/styles/spring/template/ucp_pm_history.html
--- phpBB-3.0.10/styles/spring/template/ucp_pm_history.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/ucp_pm_history.html	2014-04-15 14:31:18.735429004 +0200
@@ -0,0 +1,73 @@
+<script type="text/javascript">
+// <![CDATA[
+	bbcodeEnabled = {S_BBCODE_ALLOWED};
+// ]]>
+</script>
+
+<table class="tablebg" width="100%" cellspacing="1">
+<tr>
+	<th align="center">{L_MESSAGE_HISTORY}</th>
+</tr>
+<tr>
+	<td class="row1"><div style="overflow: auto; width: 100%; height: 300px;">
+
+		<table class="tablebg" width="100%" cellspacing="1">
+		<tr>
+			<th width="22%">{L_AUTHOR}</th>
+			<th>{L_MESSAGE}</th>
+		</tr>
+	<!-- BEGIN history_row -->
+			<!-- IF history_row.S_ROW_COUNT is even --><tr class="row1"><!-- ELSE --><tr class="row2"><!-- ENDIF -->
+			<td rowspan="2" align="{S_CONTENT_FLOW_BEGIN}" valign="top"><a name="{history_row.MSG_ID}"></a>
+				<table width="150" cellspacing="0">
+				<tr>
+					<td align="center" colspan="2"><span class="postauthor">{history_row.MESSAGE_AUTHOR_FULL}</span></td>
+				</tr>
+				</table>
+			</td>
+			<td width="100%"<!-- IF history_row.S_CURRENT_MSG --> style="background-color:lightblue"<!-- ENDIF -->>
+				<div class="gensmall" style="float: {S_CONTENT_FLOW_BEGIN};"><b>{L_PM_SUBJECT}:</b>&nbsp;{history_row.SUBJECT}</div><div class="gensmall" style="float: {S_CONTENT_FLOW_END};"><b>{L_FOLDER}:</b>&nbsp;{history_row.FOLDER}</div>
+			</td>
+		</tr>
+
+		<!-- IF history_row.S_ROW_COUNT is even --><tr class="row1"><!-- ELSE --><tr class="row2"><!-- ENDIF -->
+			<td valign="top">
+				<table width="100%" cellspacing="0">
+				<tr>
+					<td valign="top">
+						<table width="100%" cellspacing="0" cellpadding="2">
+						<tr>
+							<td><div class="postbody">{history_row.MESSAGE}</div><div id="message_{history_row.MSG_ID}" style="display: none;">{history_row.DECODED_MESSAGE}</div></td>
+						</tr>
+						</table>
+					</td>
+				</tr>
+				<tr>
+					<td>
+						<table width="100%" cellspacing="0">
+						<tr valign="middle">
+							<td width="100%">&nbsp;</td>
+							<td width="10" nowrap="nowrap">{history_row.MINI_POST_IMG}</td>
+							<td class="gensmall" nowrap="nowrap"><b>{L_SENT_AT}:</b> {history_row.SENT_DATE}</td>
+						</tr>
+						</table>
+					</td>
+				</tr>
+				</table>
+			</td>
+		</tr>
+
+		<!-- IF history_row.S_ROW_COUNT is even --><tr class="row1"><!-- ELSE --><tr class="row2"><!-- ENDIF -->
+			<td class="gensmall"><a href="{history_row.U_VIEW_MESSAGE}">{L_VIEW_PM}</a></td>
+			<td><div class="gensmall" style="float: {S_CONTENT_FLOW_BEGIN};">&nbsp;<!-- IF history_row.U_PROFILE --><a href="{history_row.U_PROFILE}">{PROFILE_IMG}</a> <!-- ENDIF --> <!-- IF history_row.U_EMAIL --><a href="{history_row.U_EMAIL}">{EMAIL_IMG}</a> <!-- ENDIF -->&nbsp;</div> <div class="gensmall" style="float: {S_CONTENT_FLOW_END};"><!-- IF history_row.U_QUOTE or history_row.MESSAGE_AUTHOR_QUOTE --><a <!-- IF history_row.U_QUOTE -->href="{history_row.U_QUOTE}"<!-- ELSE -->href="#" onclick="addquote({history_row.MSG_ID}, '{history_row.MESSAGE_AUTHOR_QUOTE}', '{LA_WROTE}'); return false;"<!-- ENDIF -->>{QUOTE_IMG}</a> <!-- ENDIF --> <!-- IF history_row.U_POST_REPLY_PM --><a href="{history_row.U_POST_REPLY_PM}">{REPLY_IMG}</a><!-- ENDIF -->&nbsp;</div></td>
+		</tr>
+		<tr>
+			<td class="spacer" colspan="2"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
+		</tr>
+	<!-- END history_row -->
+		</table>
+	</div></td>
+</tr>
+</table>
+
+<br clear="all" />
diff -ruN phpBB-3.0.10/styles/spring/template/ucp_pm_message_footer.html phpbb/styles/spring/template/ucp_pm_message_footer.html
--- phpBB-3.0.10/styles/spring/template/ucp_pm_message_footer.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/ucp_pm_message_footer.html	2014-04-15 14:31:18.736429004 +0200
@@ -0,0 +1,47 @@
+
+<!-- IF not S_VIEW_MESSAGE -->
+	{S_FORM_TOKEN}
+	</form>
+<!-- ENDIF -->
+
+<table class="tablebg" width="100%" cellspacing="1" cellpadding="0">
+<tr>
+	<td class="row1">
+		<table border="0" cellspacing="0" cellpadding="0" width="100%">
+		<tr>
+			<td align="{S_CONTENT_FLOW_BEGIN}"><!-- INCLUDE pagination.html -->
+				<!-- IF S_VIEW_MESSAGE -->
+					<span class="gensmall">
+						<!-- IF U_PRINT_PM --><a href="{U_PRINT_PM}" title="{L_PRINT_PM}">{L_PRINT_PM}</a><!-- IF U_FORWARD_PM --> | <!-- ENDIF --><!-- ENDIF -->
+						<!-- IF U_FORWARD_PM --><a href="{U_FORWARD_PM}" title="{L_FORWARD_PM}">{L_FORWARD_PM}</a><!-- ENDIF -->
+						<!-- IF U_POST_REPLY_PM and S_PM_RECIPIENTS gt 1 --><!-- IF U_PRINT_PM or U_FORWARD_PM --> | <!-- ENDIF --><a title="{L_REPLY_TO_ALL}" href="{U_POST_REPLY_ALL}">{L_REPLY_TO_ALL}</a><!-- ENDIF -->
+					</span>
+				<!-- ENDIF -->
+			</td>
+			<td align="{S_CONTENT_FLOW_END}" nowrap="nowrap">
+				<!-- IF S_VIEW_MESSAGE -->
+					<!-- IF not S_SPECIAL_FOLDER -->
+						<form name="movepm" method="post" action="{S_PM_ACTION}" style="margin:0px">
+							<input type="hidden" name="marked_msg_id[]" value="{MSG_ID}" />
+							<input type="hidden" name="cur_folder_id" value="{CUR_FOLDER_ID}" />
+							<input type="hidden" name="p" value="{MSG_ID}" />
+							<select name="dest_folder">{S_TO_FOLDER_OPTIONS}</select>&nbsp;<input class="btnlite" type="submit" name="move_pm" value="{L_MOVE_TO_FOLDER}" />
+						{S_FORM_TOKEN}
+						</form>
+					<!-- ENDIF -->
+				<!-- ELSE -->
+					<form name="sortmsg" method="post" action="{S_PM_ACTION}" style="margin:0px">
+						<span class="gensmall">{L_DISPLAY_MESSAGES}:</span> {S_SELECT_SORT_DAYS} <span class="gensmall">{L_SORT_BY}</span> {S_SELECT_SORT_KEY} {S_SELECT_SORT_DIR} <input class="btnlite" type="submit" name="sort" value="{L_GO}" />
+					{S_FORM_TOKEN}
+					</form>
+				<!-- ENDIF -->
+			</td>
+		</tr>
+		</table>
+	</td>
+</tr>
+</table>
+
+<!-- IF not S_VIEW_MESSAGE -->
+	<div style="float: {S_CONTENT_FLOW_END};"><b class="gensmall"><a href="#" onclick="marklist('viewfolder', 'marked_msg_id', true); return false;">{L_MARK_ALL}</a> :: <a href="#" onclick="marklist('viewfolder', 'marked_msg_id', false); return false;">{L_UNMARK_ALL}</a></b></div>
+<!-- ENDIF -->
diff -ruN phpBB-3.0.10/styles/spring/template/ucp_pm_message_header.html phpbb/styles/spring/template/ucp_pm_message_header.html
--- phpBB-3.0.10/styles/spring/template/ucp_pm_message_header.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/ucp_pm_message_header.html	2014-04-15 14:31:18.736429004 +0200
@@ -0,0 +1,34 @@
+
+<table class="tablebg" width="100%" cellspacing="1" cellpadding="0">
+<tr>
+	<td class="row1">
+		<table border="0" cellspacing="0" cellpadding="0" width="100%">
+		<tr>
+			<td align="{S_CONTENT_FLOW_BEGIN}">
+			<!-- IF TOTAL_MESSAGES -->
+				<table width="100%" cellspacing="1">
+				<tr>
+					<td class="nav" valign="middle" nowrap="nowrap">&nbsp;{PAGE_NUMBER}<br /></td>
+					<!-- IF FOLDER_MAX_MESSAGES neq 0 -->
+						<td class="gensmall" nowrap="nowrap" width="100%">&nbsp;[ <b>{FOLDER_CUR_MESSAGES}</b>/{FOLDER_MAX_MESSAGES} {L_MESSAGES} ({FOLDER_PERCENT}%) ]&nbsp;</td>
+					<!-- ELSE -->
+						<td class="gensmall" nowrap="nowrap" width="100%">&nbsp;[ <b>{FOLDER_CUR_MESSAGES}</b> {L_MESSAGES} ]&nbsp;</td>					
+					<!-- ENDIF -->
+				</tr>
+				</table>
+			<!-- ENDIF -->
+	
+			<!-- IF S_VIEW_MESSAGE -->
+				<span class="gensmall">
+				<!-- IF S_DISPLAY_HISTORY -->
+					<!-- IF U_VIEW_PREVIOUS_HISTORY --><a href="{U_VIEW_PREVIOUS_HISTORY}">{L_VIEW_PREVIOUS_HISTORY}</a> | <!-- ENDIF --><!-- IF U_VIEW_NEXT_HISTORY --><a href="{U_VIEW_NEXT_HISTORY}">{L_VIEW_NEXT_HISTORY}</a> | <!-- ENDIF -->
+				<!-- ENDIF --><a href="{U_PREVIOUS_PM}">{L_VIEW_PREVIOUS_PM}</a> | <a href="{U_NEXT_PM}">{L_VIEW_NEXT_PM}</a>&nbsp;
+				</span>
+			<!-- ENDIF -->
+			</td>
+			<td align="{S_CONTENT_FLOW_END}"><!-- INCLUDE pagination.html --></td>
+		</tr>
+		</table>
+	</td>
+</tr>
+</table>
diff -ruN phpBB-3.0.10/styles/spring/template/ucp_pm_options.html phpbb/styles/spring/template/ucp_pm_options.html
--- phpBB-3.0.10/styles/spring/template/ucp_pm_options.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/ucp_pm_options.html	2014-04-15 14:31:18.737429004 +0200
@@ -0,0 +1,192 @@
+<!-- INCLUDE ucp_header.html -->
+
+<!-- IF ERROR_MESSAGE or NOTIFICATION_MESSAGE -->
+	<table border="0" cellspacing="0" cellpadding="0" width="100%">
+	<tr>
+		<td class="row3" align="center">
+			<!-- IF ERROR_MESSAGE --><span class="genmed error">{ERROR_MESSAGE}</span><!-- ENDIF -->
+			<!-- IF NOTIFICATION_MESSAGE --><span class="genmed error">{NOTIFICATION_MESSAGE}</span><!-- ENDIF -->
+		</td>
+	</tr>
+	</table>
+	<div style="padding: 2px;"></div>
+<!-- ENDIF -->
+
+<form name="ucp" method="post" action="{S_UCP_ACTION}">
+
+<table class="tablebg" width="100%" cellspacing="1">
+<tr>
+	<th colspan="3">{L_ADD_NEW_RULE}</th>
+</tr>
+<!-- IF S_CHECK_DEFINED -->
+	<tr>
+		<td class="row1" width="50" align="{S_CONTENT_FLOW_BEGIN}" valign="top"><b class="gen">{L_IF}:</b></td>
+		<td class="row2" align="center" valign="top"><!-- IF S_CHECK_SELECT --><select name="check_option">{S_CHECK_OPTIONS}</select><!-- ELSE --><b class="gen">{CHECK_CURRENT}</b><input type="hidden" name="check_option" value="{CHECK_OPTION}" /><!-- ENDIF --></td>
+		<td class="row1" width="50" align="{S_CONTENT_FLOW_END}" valign="top"><!-- IF S_CHECK_SELECT --><input type="submit" name="next" value="{L_NEXT_STEP}" class="btnlite" /><!-- ELSE -->&nbsp;<!-- ENDIF --></td>
+	</tr>
+<!-- ENDIF -->
+<!-- IF S_RULE_DEFINED -->
+	<tr>
+		<td class="row1" width="50" align="{S_CONTENT_FLOW_BEGIN}" valign="top"><!-- IF S_RULE_SELECT --><input type="submit" name="back[rule]" value="{L_PREVIOUS_STEP}" class="btnlite" /><!-- ELSE -->&nbsp;<!-- ENDIF --></td>
+		<td class="row2" align="center" valign="top"><!-- IF S_RULE_SELECT --><select name="rule_option">{S_RULE_OPTIONS}</select><!-- ELSE --><b class="gen">{RULE_CURRENT}</b><input type="hidden" name="rule_option" value="{RULE_OPTION}" /><!-- ENDIF --></td>
+		<td class="row1" width="50" align="{S_CONTENT_FLOW_END}" valign="top"><!-- IF S_RULE_SELECT --><input type="submit" name="next" value="{L_NEXT_STEP}" class="btnlite" /><!-- ELSE -->&nbsp;<!-- ENDIF --></td>
+	</tr>
+<!-- ENDIF -->
+	
+<!-- IF S_COND_DEFINED -->
+	<!-- IF S_COND_SELECT or COND_CURRENT -->
+		<tr>
+			<td class="row1" width="50" align="{S_CONTENT_FLOW_BEGIN}" valign="top"><!-- IF S_COND_SELECT --><input type="submit" name="back[cond]" value="{L_PREVIOUS_STEP}" class="btnlite" /><!-- ELSE -->&nbsp;<!-- ENDIF --></td>
+			<td class="row2" align="center" valign="top">
+				<!-- IF S_COND_SELECT -->
+					<!-- IF S_TEXT_CONDITION -->
+						<input type="text" name="rule_string" value="{CURRENT_STRING}" size="30" maxlength="250" class="post" />
+					<!-- ELSEIF S_USER_CONDITION -->
+						<input type="text" class="post" name="rule_string" value="{CURRENT_STRING}" size="20" />&nbsp;<span class="gensmall">[ <a href="{U_FIND_USERNAME}" onclick="find_username(this.href); return false;">{L_FIND_USERNAME}</a> ]</span>
+					<!-- ELSEIF S_GROUP_CONDITION -->
+						<input type="hidden" name="rule_string" value="{CURRENT_STRING}" /><!-- IF S_GROUP_OPTIONS --><select name="rule_group_id">{S_GROUP_OPTIONS}</select><!-- ELSE -->{L_NO_GROUPS}<!-- ENDIF -->
+					<!-- ENDIF -->
+				<!-- ELSE -->
+					<b class="gen">{COND_CURRENT}</b>
+						<input type="hidden" name="rule_string" value="{CURRENT_STRING}" /><input type="hidden" name="rule_user_id" value="{CURRENT_USER_ID}" /><input type="hidden" name="rule_group_id" value="{CURRENT_GROUP_ID}" />
+				<!-- ENDIF -->
+			</td>
+			<td class="row1" width="50" align="{S_CONTENT_FLOW_END}" valign="top"><!-- IF S_COND_SELECT --><input type="submit" name="next" value="{L_NEXT_STEP}" class="btnlite" /><!-- ELSE -->&nbsp;<!-- ENDIF --></td>
+		</tr>
+	<!-- ENDIF -->
+	<input type="hidden" name="cond_option" value="{COND_OPTION}" />
+<!-- ENDIF -->
+
+<!-- IF NONE_CONDITION --><input type="hidden" name="cond_option" value="none" /><!-- ENDIF -->
+
+<!-- IF S_ACTION_DEFINED -->
+	<tr>
+		<td class="row1" width="50" align="{S_CONTENT_FLOW_BEGIN}" valign="top"><!-- IF S_ACTION_SELECT --><input type="submit" name="back[action]" value="{L_PREVIOUS_STEP}" class="btnlite" /><!-- ELSE -->&nbsp;<!-- ENDIF --></td>
+		<td class="row2" align="center" valign="top"><!-- IF S_ACTION_SELECT --><select name="action_option">{S_ACTION_OPTIONS}</select><!-- ELSE --><b class="gen">{ACTION_CURRENT}</b><input type="hidden" name="action_option" value="{ACTION_OPTION}" /><!-- ENDIF --></td>
+		<td class="row1" width="50" align="{S_CONTENT_FLOW_END}" valign="top"><!-- IF S_ACTION_SELECT --><input type="submit" name="add_rule" value="{L_ADD_RULE}" class="btnlite" /><!-- ELSE -->&nbsp;<!-- ENDIF --></td>
+	</tr>
+<!-- ENDIF -->
+</table>
+
+<div style="padding: 2px;"></div>
+
+<table class="tablebg" width="100%" cellspacing="1">
+<tr>
+	<th colspan="6">{L_DEFINED_RULES}</th>
+</tr>
+<!-- BEGIN rule -->
+	<tr>
+		<td class="row1" width="25" align="center"><span class="gen">#{rule.COUNT}</span></td>
+		<td class="row2" width="120"><span class="gen"><strong>{L_IF}</strong> {rule.CHECK}</span></td>
+		<td class="row1" width="120"><span class="gen">{rule.RULE}</span></td>
+		<td class="row2" width="120"><span class="gen"><!-- IF rule.STRING -->{rule.STRING}<!-- ENDIF --></span></td>
+		<td class="row1"><span class="gen">{rule.ACTION}<!-- IF rule.FOLDER --> -&gt; {rule.FOLDER}<!-- ENDIF --></span></td>
+		<td class="row2" width="25"><input type="submit" name="delete_rule[{rule.RULE_ID}]" value="{L_DELETE_RULE}" class="btnlite" /></td>
+	</tr>
+<!-- BEGINELSE -->
+	<tr>
+		<td colspan="6" class="row3" align="center"><span class="gen">{L_NO_RULES_DEFINED}</span></td>
+	</tr>
+<!-- END rule -->
+</table>
+
+<div style="padding: 2px;"></div>
+
+<!-- IF S_FOLDER_OPTIONS -->
+	<table class="tablebg" width="100%" cellspacing="1">
+	<tr>
+		<th colspan="2">{L_RENAME_FOLDER}</th>
+	</tr>
+	<tr>
+		<td class="row1" width="200"><b class="gen">{L_RENAME_FOLDER}: </b></td>
+		<td class="row1"><select name="rename_folder_id">{S_FOLDER_OPTIONS}</select></td>
+	</tr>
+	<tr>
+		<td class="row1" width="200"><b class="gen">{L_NEW_FOLDER_NAME}: </b></td>
+		<td class="row1"><input type="text" class="post" name="new_folder_name" size="30" maxlength="30" /></td>
+	</tr>
+	<tr>
+		<td class="row1" align="{S_CONTENT_FLOW_END}" colspan="2"><input class="btnlite" style="width:150px" type="submit" name="rename_folder" value="{L_RENAME}" /></td>
+	</tr>
+	</table>
+
+	<div style="padding: 2px;"></div>
+<!-- ENDIF -->
+
+<!-- IF not S_MAX_FOLDER_ZERO -->
+<table class="tablebg" width="100%" cellspacing="1">
+<tr>
+	<th colspan="2">{L_ADD_FOLDER}</th>
+</tr>
+<!-- IF S_MAX_FOLDER_REACHED -->
+	<tr>
+		<td colspan="2">{L_MAX_FOLDER_REACHED}</td>
+	</tr>
+<!-- ELSE -->
+	<tr>
+		<td class="row1" width="200"><b class="gen">{L_ADD_FOLDER}: </b></td>
+		<td class="row1"><input type="text" class="post" name="foldername" size="30" maxlength="30" /></td>
+	</tr>
+	<tr>
+		<td class="row1" align="{S_CONTENT_FLOW_END}" colspan="2"><input class="btnlite" style="width:150px" type="submit" name="addfolder" value="{L_ADD}" /></td>
+	</tr>
+<!-- ENDIF -->
+</table>
+<!-- ENDIF -->
+
+<div style="padding: 2px;"></div>
+
+<!-- IF S_FOLDER_OPTIONS -->
+	<table class="tablebg" width="100%" cellspacing="1">
+	<tr>
+		<th colspan="3">{L_REMOVE_FOLDER}</th>
+	</tr>
+	<tr>
+		<td class="row1" width="200"><b class="gen">{L_REMOVE_FOLDER}: </b></td>
+		<td class="row1"><select name="remove_folder_id">{S_FOLDER_OPTIONS}</select></td>
+		<td class="row1"><b class="genmed">{L_AND}</b></td>
+	</tr>
+	<tr>
+		<td class="row2" width="200">&nbsp;</td>
+		<td class="row2" colspan="2"><input type="radio" class="radio" name="remove_action" value="1" checked="checked" />&nbsp;<span class="genmed">{L_MOVE_DELETED_MESSAGES_TO} </span>&nbsp;<select name="move_to">{S_TO_FOLDER_OPTIONS}</select></td>
+	</tr>
+	<tr>
+		<td class="row2" width="200">&nbsp;</td>
+		<td class="row2" colspan="2"><input type="radio" class="radio" name="remove_action" value="2" />&nbsp;<span class="genmed">{L_DELETE_MESSAGES_IN_FOLDER}</span></td>
+	</tr>
+	<tr>
+		<td class="row2" width="200">&nbsp;</td>
+		<td class="row2" colspan="2" align="{S_CONTENT_FLOW_END}"><input class="btnlite" style="width:150px" type="submit" name="remove_folder" value="{L_REMOVE}" /></td>
+	</tr>
+	</table>
+
+	<div style="padding: 2px;"></div>
+<!-- ENDIF -->
+
+<table class="tablebg" width="100%" cellspacing="1">
+<tr>
+	<th colspan="2">{L_FOLDER_OPTIONS}</th>
+</tr>
+<tr>
+	<td class="row1" width="200"><span><b class="genmed">{L_IF_FOLDER_FULL}: </b></span></td>
+	<td class="row1"><input type="radio" class="radio" name="full_action" value="1"{S_DELETE_CHECKED} />&nbsp;<span class="genmed">{L_DELETE_OLDEST_MESSAGES}</span></td>
+</tr>
+<tr>
+	<td class="row1" width="200">&nbsp;</td>
+	<td class="row1"><input type="radio" class="radio" name="full_action" value="2"{S_MOVE_CHECKED} />&nbsp;<span class="genmed">{L_MOVE_TO_FOLDER}: </span><select name="full_move_to">{S_FULL_FOLDER_OPTIONS}</select></td>
+</tr>
+<tr>
+	<td class="row1" width="200">&nbsp;</td>
+	<td class="row1"><input type="radio" class="radio" name="full_action" value="3"{S_HOLD_CHECKED} />&nbsp;<span class="genmed">{L_HOLD_NEW_MESSAGES}</span></td>
+</tr>
+<tr>
+	<td class="row2" width="200"><b class="genmed">{L_DEFAULT_ACTION}: </b><br /><span class="gensmall">{L_DEFAULT_ACTION_EXPLAIN}</span></td>
+	<td class="row2"><span class="genmed">{DEFAULT_ACTION}</span></td>
+</tr>
+<tr>
+	<td class="row1" colspan="2" align="{S_CONTENT_FLOW_END}"><input class="btnlite" style="width:150px" type="submit" name="fullfolder" value="{L_CHANGE}" /></td>
+</tr>
+</table>
+{S_FORM_TOKEN}
+</form>
+<!-- INCLUDE ucp_footer.html -->
diff -ruN phpBB-3.0.10/styles/spring/template/ucp_pm_popup.html phpbb/styles/spring/template/ucp_pm_popup.html
--- phpBB-3.0.10/styles/spring/template/ucp_pm_popup.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/ucp_pm_popup.html	2014-04-15 14:31:18.738429004 +0200
@@ -0,0 +1,37 @@
+<!-- INCLUDE simple_header.html -->
+
+<script type="text/javascript">
+// <![CDATA[
+/**
+* Jump to inbox
+*/
+function jump_to_inbox(url)
+{
+	opener.document.location.href = url.replace(/&amp;/g, '&');
+	window.close();
+}
+// ]]>
+</script>
+
+<table width="100%" border="0" cellspacing="0" cellpadding="10">
+<tr>
+	<td>
+		<table width="100%" border="0" cellspacing="1" cellpadding="4" class="tablebg">
+		<tr class="row1"> 
+			<td valign="top" align="center">
+				<br /><span class="gen">
+				<!-- IF S_NOT_LOGGED_IN -->
+					{L_LOGIN_CHECK_PM}
+				<!-- ELSE -->
+					{MESSAGE}<br /><br />{CLICK_TO_VIEW}
+				<!-- ENDIF -->
+				</span>
+				<br /><br /><span class="genmed"><a href="#" onclick="window.close(); return false;">{L_CLOSE_WINDOW}</a></span><br /><br />
+			</td>
+		</tr>
+		</table>
+	</td>
+</tr>
+</table>
+
+<!-- INCLUDE simple_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/ucp_pm_viewfolder.html phpbb/styles/spring/template/ucp_pm_viewfolder.html
--- phpBB-3.0.10/styles/spring/template/ucp_pm_viewfolder.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/ucp_pm_viewfolder.html	2014-04-15 14:31:18.739429004 +0200
@@ -0,0 +1,131 @@
+<!-- INCLUDE ucp_header.html -->
+
+<div id="pagecontent">
+
+<!-- IF not PROMPT -->
+	<!-- INCLUDE ucp_pm_message_header.html -->
+<!-- ENDIF -->
+
+<div style="padding: 2px;"></div>
+
+<!-- IF S_PM_ICONS -->
+	<!-- DEFINE $COLSPAN = 6 -->
+<!-- ELSE -->
+	<!-- DEFINE $COLSPAN = 5 -->
+<!-- ENDIF -->
+
+<form name="viewfolder" method="post" action="{S_PM_ACTION}" style="margin:0px">
+
+<!-- IF PROMPT -->
+	<table class="tablebg" width="100%" cellspacing="1" cellpadding="0" border="0">
+	<tr>
+		<th colspan="2" valign="middle">{L_OPTIONS}</th>
+	</tr>
+	<tr>
+		<td class="row1" width="35%">{L_DELIMITER}: </td>
+		<td class="row2"><input class="post" type="text" name="delimiter" value="," /></td>
+	</tr>
+	<tr>
+		<td class="row1" width="35%">{L_ENCLOSURE}: </td>
+		<td class="row2"><input class="post" type="text" name="enclosure" value="&#034;" /></td>
+	</tr>
+	<tr>
+		<td class="cat" colspan="2" align="center"><input type="hidden" name="export_option" value="CSV" /><input class="btnmain" type="submit" name="submit_export" value="{L_EXPORT_FOLDER}" />&nbsp;&nbsp;<input class="btnlite" type="reset" value="Reset" name="reset" /></td>
+	</tr>
+	</table>
+	{S_FORM_TOKEN}
+
+</form>
+<!-- ELSE -->
+
+	<table class="tablebg" width="100%" cellspacing="1" cellpadding="0" border="0">
+	<!-- IF NUM_NOT_MOVED or NUM_REMOVED -->
+		<tr>
+			<td class="row3" colspan="{$COLSPAN}" align="center"><span class="gen">
+				<!-- IF NUM_REMOVED -->
+				{RULE_REMOVED_MESSAGES}
+					<!-- IF NUM_NOT_MOVED --><br /><!-- ENDIF -->
+				<!-- ENDIF -->
+				<!-- IF NUM_NOT_MOVED -->
+				{NOT_MOVED_MESSAGES}<br />{RELEASE_MESSAGE_INFO}
+				<!-- ENDIF -->
+			</span></td>
+		</tr>
+	<!-- ENDIF -->
+	<tr>
+		<th colspan="<!-- IF S_PM_ICONS -->3<!-- ELSE -->2<!-- ENDIF -->">&nbsp;{L_SUBJECT}&nbsp;</th>
+		<th>&nbsp;<!-- IF S_SHOW_RECIPIENTS -->{L_RECIPIENTS}<!-- ELSE -->{L_AUTHOR}<!-- ENDIF -->&nbsp;</th>
+		<th>&nbsp;{L_SENT_AT}&nbsp;</th>
+		<th>&nbsp;{L_MARK}&nbsp;</th>
+	</tr>
+
+	<!-- BEGIN messagerow -->
+		<tr>
+			<td class="row1" width="25" align="center" nowrap="nowrap">{messagerow.FOLDER_IMG}</td>
+		<!-- IF S_PM_ICONS -->
+			<td class="row1" width="25" align="center">{messagerow.PM_ICON_IMG}</td>
+		<!-- ENDIF -->
+
+		<!-- IF messagerow.S_PM_DELETED --><td class="row3"><!-- ELSE --><td class="row1"><!-- ENDIF -->
+			<!-- IF not messagerow.PM_IMG and messagerow.PM_CLASS -->
+				<span class="{messagerow.PM_CLASS}" style="float: {S_CONTENT_FLOW_BEGIN};"><img src="images/spacer.gif" width="10" height="10" alt="" /></span>&nbsp;
+			<!-- ELSEIF messagerow.PM_IMG -->
+				{messagerow.PM_IMG}&nbsp;
+			<!-- ENDIF -->
+
+			<span class="topictitle">
+				{messagerow.ATTACH_ICON_IMG}
+				<!-- IF messagerow.S_PM_DELETED -->
+					{L_MESSAGE_REMOVED_FROM_OUTBOX}<br />
+					<a href="{messagerow.U_REMOVE_PM}" style="float: {S_CONTENT_FLOW_END};">{L_DELETE_MESSAGE}</a>
+				<!-- ELSE -->
+					<a href="{messagerow.U_VIEW_PM}">{messagerow.SUBJECT}</a>
+				<!-- ENDIF -->
+				<!-- IF messagerow.S_PM_REPORTED -->
+					<a href="{messagerow.U_MCP_REPORT}">{REPORTED_IMG}</a>&nbsp;
+				<!-- ENDIF -->
+				<!-- IF messagerow.S_AUTHOR_DELETED -->
+					<br /><em class="gensmall">{L_PM_FROM_REMOVED_AUTHOR}</em>
+				<!-- ENDIF -->
+			</span></td>
+
+			<td class="row1" width="100" align="center"><p class="topicauthor"><!-- IF S_SHOW_RECIPIENTS -->{messagerow.RECIPIENTS}<!-- ELSE -->{messagerow.MESSAGE_AUTHOR_FULL}<!-- ENDIF --></p></td>
+			<td class="row1" width="120" align="center"><p class="topicdetails">{messagerow.SENT_TIME}</p></td>
+			<td class="row1" width="20" align="center"><p class="topicdetails"><input type="checkbox" class="radio" name="marked_msg_id[]" value="{messagerow.MESSAGE_ID}" /></p></td>
+		</tr>
+	<!-- BEGINELSE -->
+		<tr>
+			<td class="row1" colspan="{$COLSPAN}" height="30" align="center" valign="middle"><span class="gen">
+			<!-- IF S_COMPOSE_PM_VIEW and S_NO_AUTH_SEND_MESSAGE -->
+				<!-- IF S_USER_NEW -->{L_USER_NEW_PERMISSION_DISALLOWED}<!-- ELSE -->{L_NO_AUTH_SEND_MESSAGE}<!-- ENDIF -->
+			<!-- ELSE -->
+				{L_NO_MESSAGES}
+			<!-- ENDIF -->
+			</span></td>
+		</tr>
+	<!-- END messagerow -->
+</table>
+
+<input type="hidden" name="cur_folder_id" value="{CUR_FOLDER_ID}" />
+
+<table border="0" cellspacing="0" cellpadding="0" width="100%">
+<tr>
+	<td class="cat">
+<!-- IF .messagerow -->
+	<div style="float: {S_CONTENT_FLOW_BEGIN};"><select name="export_option"><option value="CSV">{L_EXPORT_AS_CSV}</option><option value="CSV_EXCEL">{L_EXPORT_AS_CSV_EXCEL}</option><option value="XML">{L_EXPORT_AS_XML}</option></select>&nbsp;<input class="btnlite" type="submit" name="submit_export" value="{L_EXPORT_FOLDER}" /></div>
+	<div style="float: {S_CONTENT_FLOW_END};"><select name="mark_option">{S_MARK_OPTIONS}{S_MOVE_MARKED_OPTIONS}</select>&nbsp;<input class="btnlite" type="submit" name="submit_mark" value="{L_GO}" />&nbsp;</div>
+<!-- ENDIF -->
+	</td>
+</tr>
+</table>
+
+<div style="padding: 2px;"></div>
+<!-- INCLUDE ucp_pm_message_footer.html -->
+
+<!-- ENDIF -->
+
+<br clear="all" />
+
+</div>
+
+<!-- INCLUDE ucp_footer.html -->
diff -ruN phpBB-3.0.10/styles/spring/template/ucp_pm_viewmessage.html phpbb/styles/spring/template/ucp_pm_viewmessage.html
--- phpBB-3.0.10/styles/spring/template/ucp_pm_viewmessage.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/ucp_pm_viewmessage.html	2014-04-15 14:31:18.740429004 +0200
@@ -0,0 +1,124 @@
+<!-- INCLUDE ucp_header.html -->
+
+<div id="pagecontent">
+
+<!-- INCLUDE ucp_pm_message_header.html -->
+<div style="padding: 2px;"></div>
+
+<table class="tablebg" width="100%" cellspacing="1" cellpadding="4">
+
+<tr class="row1">
+	<td class="genmed" nowrap="nowrap" width="150"><b>{L_PM_SUBJECT}:</b></td>
+	<td class="gen">{SUBJECT}</td>
+</tr>
+
+<tr class="row1">
+	<td class="genmed" nowrap="nowrap" width="150"><b>{L_PM_FROM}:</b></td>
+	<td class="gen">{MESSAGE_AUTHOR_FULL}</td>
+</tr>
+
+<tr class="row1">
+	<td class="genmed" nowrap="nowrap" width="150"><b>{L_SENT_AT}:</b></td>
+	<td class="gen">{SENT_DATE}</td>
+</tr>
+
+<!-- IF S_TO_RECIPIENT -->
+	<tr class="row1">
+		<td class="genmed" nowrap="nowrap" width="150"><b>{L_TO}:</b></td>
+		<td class="gen">
+		<!-- BEGIN to_recipient -->
+			<!-- IF to_recipient.IS_GROUP --><span class="sep"><a href="{to_recipient.U_VIEW}">{to_recipient.NAME}</a></span><!-- ELSE -->{to_recipient.NAME_FULL}&nbsp;<!-- ENDIF -->
+		<!-- END to_recipient -->
+		</td>
+	</tr>
+<!-- ENDIF -->
+
+<!-- IF S_BCC_RECIPIENT -->
+	<tr class="row1">
+		<td class="genmed" nowrap="nowrap" width="150"><b>{L_BCC}:</b></td>
+		<td class="gen">
+		<!-- BEGIN bcc_recipient -->
+			<!-- IF bcc_recipient.IS_GROUP --><span class="sep"><a href="{bcc_recipient.U_VIEW}">{bcc_recipient.NAME}</a></span><!-- ELSE -->{bcc_recipient.NAME_FULL}&nbsp;<!-- ENDIF -->
+		<!-- END bcc_recipient -->
+		</td>
+	</tr>
+<!-- ENDIF -->
+</table>
+
+<div style="padding: 2px;"></div>
+
+<table class="tablebg" width="100%" cellspacing="1" cellpadding="0">
+
+<tr>
+	<th nowrap="nowrap">{L_MESSAGE}</th>
+</tr>
+
+<tr>
+	<td class="spacer" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
+</tr>
+
+<tr class="row1">
+	<td valign="top">
+		<table width="100%" cellspacing="5">
+		<tr>
+			<td>
+				<div class="postbody">{MESSAGE}</div>
+
+				<!-- IF S_HAS_ATTACHMENTS -->
+					<br clear="all" /><br />
+							
+					<table class="tablebg" width="100%" cellspacing="1">
+					<tr>
+						<td class="row3"><b class="genmed">{L_ATTACHMENTS}: </b></td>
+					</tr>
+					<!-- BEGIN attachment -->
+						<tr>
+							<td class="row2">{attachment.DISPLAY_ATTACHMENT}</td>
+						</tr>
+					<!-- END attachment -->
+					</table>
+				<!-- ENDIF -->
+
+				<!-- IF S_DISPLAY_NOTICE -->
+					<span class="gensmall error"><br /><br />{L_DOWNLOAD_NOTICE}</span>
+				<!-- ENDIF -->
+				<!-- IF SIGNATURE -->
+					<span class="postbody"><br />_________________<br />{SIGNATURE}</span>
+				<!-- ENDIF -->
+				<!-- IF EDITED_MESSAGE -->
+					<span class="gensmall">{EDITED_MESSAGE}</span>
+				<!-- ENDIF -->
+
+				<!-- IF not S_HAS_ATTACHMENTS --><br clear="all" /><br /><!-- ENDIF -->
+
+				<table width="100%" cellspacing="0">
+				<tr valign="middle">
+					<td class="gensmall" align="{S_CONTENT_FLOW_END}"> <!-- IF U_REPORT --><a href="{U_REPORT}">{REPORT_IMG}</a> <!-- ENDIF --><!-- IF U_DELETE --><a href="{U_DELETE}">{DELETE_IMG}</a> <!-- ENDIF --></td>
+				</tr>
+				</table>
+
+			</td>
+		</tr>
+		</table>
+	</td>
+</tr>
+
+<tr class="row1">
+	<td><div class="gensmall" style="float: {S_CONTENT_FLOW_BEGIN};">&nbsp;<!-- IF U_MESSAGE_AUTHOR --><a href="{U_MESSAGE_AUTHOR}">{PROFILE_IMG}</a> <!-- ENDIF --> <!-- IF U_EMAIL --><a href="{U_EMAIL}">{EMAIL_IMG}</a> <!-- ENDIF -->&nbsp;</div> <div class="gensmall" style="float: {S_CONTENT_FLOW_END};"><!-- IF U_EDIT --><a href="{U_EDIT}">{EDIT_IMG}</a> <!-- ENDIF --> <!-- IF U_QUOTE --><a href="{U_QUOTE}">{QUOTE_IMG}</a> <!-- ENDIF --> <!-- IF U_POST_REPLY_PM --><a href="{U_POST_REPLY_PM}">{REPLY_IMG}</a><!-- ENDIF -->&nbsp;</div></td>
+</tr>
+
+<tr>
+	<td class="spacer" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
+</tr>
+</table>
+
+<div style="padding: 2px;"></div>
+<!-- INCLUDE ucp_pm_message_footer.html -->
+
+<br clear="all" />
+
+</div>
+
+<!-- IF S_DISPLAY_HISTORY --><!-- INCLUDE ucp_pm_history.html --><!-- ENDIF -->
+
+<!-- INCLUDE ucp_footer.html -->
diff -ruN phpBB-3.0.10/styles/spring/template/ucp_pm_viewmessage_print.html phpbb/styles/spring/template/ucp_pm_viewmessage_print.html
--- phpBB-3.0.10/styles/spring/template/ucp_pm_viewmessage_print.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/ucp_pm_viewmessage_print.html	2014-04-15 14:31:18.741429004 +0200
@@ -0,0 +1,122 @@
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+<html dir="{S_CONTENT_DIRECTION}" lang="{S_USER_LANG}">
+<head>
+<meta http-equiv="Content-Type" content="text/html; charset={S_CONTENT_ENCODING}">
+<meta http-equiv="Content-Style-Type" content="text/css">
+<meta http-equiv="Content-Language" content="{S_USER_LANG}">
+<title>{SITENAME} :: {PAGE_TITLE}</title>
+
+<style type="text/css">
+<!--
+
+body {
+	font-family: Verdana,serif;
+	font-size: 10pt;
+}
+
+td {
+	font-family: Verdana,serif;
+	font-size: 10pt;
+	line-height: 150%;
+}
+
+.code,
+.quote {
+	font-size: smaller;
+	border: black solid 1px;
+}
+
+.forum {
+	font-family: Arial,Helvetica,sans-serif;
+	font-weight: bold;
+	font-size: 18pt;
+}
+
+.topic {
+	font-family: Arial,Helvetica,sans-serif;
+	font-size: 14pt;
+	font-weight: bold;
+}
+
+.gensmall {
+	font-size: 8pt;
+}
+
+hr {
+	color: #888;
+	height: 3px;
+	border-style: solid;
+}
+
+hr.sep {
+	color: #aaa;
+	height: 1px;
+	border-style: dashed;
+}
+//-->
+</style>
+
+</head>
+<body>
+
+<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
+<tr>
+	<td colspan="2" align="center"><span class="Forum">{SITENAME}</span><br /><span class="gensmall">{L_PRIVATE_MESSAGING}</span></td>
+</tr>
+<tr>
+	<td colspan="2"><br /></td>
+</tr>
+<tr>
+	<td><span class="topic">{SUBJECT}</span><br /></td>
+	<td align="{S_CONTENT_FLOW_END}" valign="bottom"><span class="gensmall">{PAGE_NUMBER}</span></td>
+</tr>
+</table>
+
+<hr width="85%" />
+
+<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
+<tr>
+	<td width="10%" nowrap="nowrap">{L_PM_FROM}:&nbsp;</td>
+	<td><b>{MESSAGE_AUTHOR}</b> [ {SENT_DATE} ]</td>
+</tr>
+	
+<!-- IF S_TO_RECIPIENT -->
+	<tr>
+		<td width="10%" nowrap="nowrap">{L_TO}:</td>
+		<td>
+		<!-- BEGIN to_recipient -->
+			<span<!-- IF to_recipient.IS_GROUP --> class="sep"<!-- ENDIF -->>{to_recipient.NAME}</span>&nbsp;
+		<!-- END to_recipient -->
+		</td>
+	</tr>
+<!-- ENDIF -->
+
+<!-- IF S_BCC_RECIPIENT -->
+	<tr>
+		<td width="10%" nowrap="nowrap">{L_BCC}:</td>
+		<td>
+		<!-- BEGIN bcc_recipient -->
+			<!-- IF bcc_recipient.COLOUR --><span style="color:{bcc_recipient.COLOUR}"><!-- ELSE --><span<!-- IF bcc_recipient.IS_GROUP --> class="sep"<!-- ENDIF -->><!-- ENDIF -->{bcc_recipient.NAME}</span>&nbsp;
+		<!-- END bcc_recipient -->
+		</td>
+	</tr>
+<!-- ENDIF -->
+<tr>
+	<td colspan="2"><hr class="sep" />{MESSAGE}</td>
+</tr>
+</table>
+
+<hr width="85%" />
+
+<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
+<tr>
+	<td><span class="gensmall">{PAGE_NUMBER}</span></td>
+	<td align="{S_CONTENT_FLOW_END}"><span class="gensmall">{S_TIMEZONE}</span></td>
+</tr>
+<tr>
+	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
+</tr>
+</table>
+
+</body>
+</html>
diff -ruN phpBB-3.0.10/styles/spring/template/ucp_prefs_personal.html phpbb/styles/spring/template/ucp_prefs_personal.html
--- phpBB-3.0.10/styles/spring/template/ucp_prefs_personal.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/ucp_prefs_personal.html	2014-04-15 14:31:18.742429004 +0200
@@ -0,0 +1,98 @@
+<!-- INCLUDE ucp_header.html -->
+
+<script type="text/javascript">
+// <![CDATA[
+	/**
+	* Set display of page element
+	* s[-1,0,1] = hide,toggle display,show
+	*/
+	function dE(n,s)
+	{
+		var e = document.getElementById(n);
+		if (!s)
+		{
+			s = (e.style.display == '') ? -1 : 1;
+		}
+		e.style.display = (s == 1) ? 'block' : 'none';
+	}
+
+	var default_dateformat = '{A_DEFAULT_DATEFORMAT}';
+// ]]>
+</script>
+
+<table class="tablebg" width="100%" cellspacing="1">
+<tr>
+	<th colspan="2" valign="middle">{L_TITLE}</th>
+</tr>
+<!-- IF ERROR -->
+	<tr>
+		<td class="row3" colspan="2" align="center"><span class="gensmall error">{ERROR}</span></td>
+	</tr>
+<!-- ENDIF -->
+<tr> 
+	<td class="row1" width="50%"><b class="genmed">{L_SHOW_EMAIL}:</b></td>
+	<td class="row2"><input type="radio" class="radio" name="viewemail" value="1"<!-- IF S_VIEW_EMAIL --> checked="checked"<!-- ENDIF --> /><span class="genmed">{L_YES}</span>&nbsp;&nbsp;<input type="radio" class="radio" name="viewemail" value="0"<!-- IF not S_VIEW_EMAIL --> checked="checked"<!-- ENDIF --> /><span class="genmed">{L_NO}</span></td>
+</tr>
+<tr> 
+	<td class="row1" width="50%"><b class="genmed">{L_ADMIN_EMAIL}:</b></td>
+	<td class="row2"><input type="radio" class="radio" name="massemail" value="1"<!-- IF S_MASS_EMAIL --> checked="checked"<!-- ENDIF --> /><span class="genmed">{L_YES}</span>&nbsp;&nbsp;<input type="radio" class="radio" name="massemail" value="0"<!-- IF not S_MASS_EMAIL --> checked="checked"<!-- ENDIF --> /><span class="genmed">{L_NO}</span></td>
+</tr>
+<tr> 
+	<td class="row1" width="50%"><b class="genmed">{L_ALLOW_PM}:</b><br /><span class="gensmall">{L_ALLOW_PM_EXPLAIN}</span></td>
+	<td class="row2"><input type="radio" class="radio" name="allowpm" value="1"<!-- IF S_ALLOW_PM --> checked="checked"<!-- ENDIF --> /><span class="genmed">{L_YES}</span>&nbsp;&nbsp;<input type="radio" class="radio" name="allowpm" value="0"<!-- IF not S_ALLOW_PM --> checked="checked"<!-- ENDIF --> /><span class="genmed">{L_NO}</span></td>
+</tr>
+<!-- IF S_CAN_HIDE_ONLINE -->
+	<tr> 
+		<td class="row1" width="50%"><b class="genmed">{L_HIDE_ONLINE}:</b><br /><span class="gensmall">{L_HIDE_ONLINE_EXPLAIN}</span></td>
+		<td class="row2"><input type="radio" class="radio" name="hideonline" value="1"<!-- IF S_HIDE_ONLINE --> checked="checked"<!-- ENDIF --> /><span class="genmed">{L_YES}</span>&nbsp;&nbsp;<input type="radio" class="radio" name="hideonline" value="0"<!-- IF not S_HIDE_ONLINE --> checked="checked"<!-- ENDIF --> /><span class="genmed">{L_NO}</span></td>
+	</tr>
+<!-- ENDIF -->
+<!-- IF S_SELECT_NOTIFY -->
+	<tr> 
+		<td class="row1" width="50%"><b class="genmed">{L_NOTIFY_METHOD}:</b><br /><span class="gensmall">{L_NOTIFY_METHOD_EXPLAIN}</span></td>
+		<td class="row2"><input type="radio" class="radio" name="notifymethod" value="0"<!-- IF S_NOTIFY_EMAIL --> checked="checked"<!-- ENDIF --> /><span class="genmed">{L_NOTIFY_METHOD_EMAIL}</span>&nbsp;&nbsp;<input type="radio" class="radio" name="notifymethod" value="1"<!-- IF S_NOTIFY_IM --> checked="checked"<!-- ENDIF --> /><span class="genmed">{L_NOTIFY_METHOD_IM}</span>&nbsp;&nbsp;<input type="radio" class="radio" name="notifymethod" value="2"<!-- IF S_NOTIFY_BOTH --> checked="checked"<!-- ENDIF --> /><span class="genmed">{L_NOTIFY_METHOD_BOTH}</span></td>
+	</tr>
+<!-- ENDIF -->
+<tr> 
+	<td class="row1" width="50%"><b class="genmed">{L_NOTIFY_ON_PM}:</b></td>
+	<td class="row2"><input type="radio" class="radio" name="notifypm" value="1"<!-- IF S_NOTIFY_PM --> checked="checked"<!-- ENDIF --> /><span class="genmed">{L_YES}</span>&nbsp;&nbsp;<input type="radio" class="radio" name="notifypm" value="0"<!-- IF not S_NOTIFY_PM --> checked="checked"<!-- ENDIF --> /><span class="genmed">{L_NO}</span></td>
+</tr>
+<tr> 
+	<td class="row1" width="50%"><b class="genmed">{L_POPUP_ON_PM}:</b></td>
+	<td class="row2"><input type="radio" class="radio" name="popuppm" value="1"<!-- IF S_POPUP_PM --> checked="checked"<!-- ENDIF --> /><span class="genmed">{L_YES}</span>&nbsp;&nbsp;<input type="radio" class="radio" name="popuppm" value="0"<!-- IF not S_POPUP_PM --> checked="checked"<!-- ENDIF --> /><span class="genmed">{L_NO}</span></td>
+</tr>
+<tr>
+	<td class="row1" width="50%"><b class="genmed">{L_BOARD_LANGUAGE}:</b></td>
+	<td class="row2"><select name="lang">{S_LANG_OPTIONS}</select></td>
+</tr>
+<!-- IF S_STYLE_OPTIONS -->
+<tr>
+	<td class="row1" width="50%"><b class="genmed">{L_BOARD_STYLE}:</b></td>
+	<td class="row2"><select name="style">{S_STYLE_OPTIONS}</select></td>
+</tr>
+<!-- ENDIF -->
+<tr>
+	<td class="row1" width="50%"><b class="genmed">{L_BOARD_TIMEZONE}:</b></td>
+	<td class="row2">
+		<select id="tz" name="tz">{S_TZ_OPTIONS}</select>
+	</td>
+</tr>
+<tr>
+	<td class="row1" width="50%"><b class="genmed">{L_BOARD_DST}:</b></td>
+	<td class="row2"><input type="radio" class="radio" name="dst" value="1"<!-- IF S_DST --> checked="checked"<!-- ENDIF --> /> <span class="genmed">{L_YES}</span>&nbsp;&nbsp;<input type="radio" class="radio" name="dst" value="0"<!-- IF not S_DST --> checked="checked"<!-- ENDIF --> /> <span class="genmed">{L_NO}</span></td>
+</tr>
+<tr>
+	<td class="row1" width="50%"><b class="genmed">{L_BOARD_DATE_FORMAT}:</b><br /><span class="gensmall">{L_BOARD_DATE_FORMAT_EXPLAIN}</span></td>
+	<td class="row2">
+		<select name="dateoptions" id="dateoptions" onchange="if(this.value=='custom'){dE('custom_date',1);}else{dE('custom_date',-1);} if (this.value == 'custom') { document.getElementById('dateformat').value = default_dateformat; } else { document.getElementById('dateformat').value = this.value; }">
+			{S_DATEFORMAT_OPTIONS}
+		</select>
+		<div id="custom_date"<!-- IF not S_CUSTOM_DATEFORMAT --> style="display:none;"<!-- ENDIF -->><input type="text" name="dateformat" id="dateformat" value="{DATE_FORMAT}" maxlength="30" class="post" style="margin-top: 3px;" /></div>
+	</td>
+</tr>
+<tr>
+	<td class="cat" colspan="2" align="center">{S_HIDDEN_FIELDS}<input class="btnmain" type="submit" name="submit" value="{L_SUBMIT}" />&nbsp;&nbsp;<input class="btnlite" type="reset" value="{L_RESET}" name="reset" /></td>
+</tr>
+</table>
+
+<!-- INCLUDE ucp_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/ucp_prefs_post.html phpbb/styles/spring/template/ucp_prefs_post.html
--- phpBB-3.0.10/styles/spring/template/ucp_prefs_post.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/ucp_prefs_post.html	2014-04-15 14:31:18.742429004 +0200
@@ -0,0 +1,33 @@
+<!-- INCLUDE ucp_header.html -->
+
+<table class="tablebg" width="100%" cellspacing="1">
+<tr>
+	<th colspan="2" valign="middle">{L_TITLE}</th>
+</tr>
+<!-- IF ERROR -->
+	<tr>
+		<td class="row3" colspan="2" align="center"><span class="gensmall error">{ERROR}</span></td>
+	</tr>
+<!-- ENDIF -->
+<tr>
+	<td class="row1" width="50%"><b class="genmed">{L_DEFAULT_BBCODE}:</b></td>
+	<td class="row2"><input type="radio" class="radio" name="bbcode" value="1"<!-- IF S_BBCODE --> checked="checked"<!-- ENDIF --> /><span class="gen">{L_YES}</span>&nbsp; &nbsp;<input type="radio" class="radio" name="bbcode" value="0"<!-- IF not S_BBCODE --> checked="checked"<!-- ENDIF --> /><span class="gen">{L_NO}</span></td>
+</tr>
+<tr>
+	<td class="row1" width="50%"><b class="genmed">{L_DEFAULT_SMILIES}:</b></td>
+	<td class="row2"><input type="radio" class="radio" name="smilies" value="1"<!-- IF S_SMILIES --> checked="checked"<!-- ENDIF --> /><span class="gen">{L_YES}</span>&nbsp; &nbsp;<input type="radio" class="radio" name="smilies" value="0"<!-- IF not S_SMILIES --> checked="checked"<!-- ENDIF --> /><span class="gen">{L_NO}</span></td>
+</tr>
+<tr>
+	<td class="row1" width="50%"><b class="genmed">{L_DEFAULT_ADD_SIG}:</b></td>
+	<td class="row2"><input type="radio" class="radio" name="sig" value="1"<!-- IF S_SIG --> checked="checked"<!-- ENDIF --> /><span class="gen">{L_YES}</span>&nbsp; &nbsp;<input type="radio" class="radio" name="sig" value="0"<!-- IF not S_SIG --> checked="checked"<!-- ENDIF --> /><span class="gen">{L_NO}</span></td>
+</tr>
+<tr>
+	<td class="row1" width="50%"><b class="genmed">{L_DEFAULT_NOTIFY}:</b></td>
+	<td class="row2"><input type="radio" class="radio" name="notify" value="1"<!-- IF S_NOTIFY --> checked="checked"<!-- ENDIF --> /><span class="gen">{L_YES}</span>&nbsp; &nbsp;<input type="radio" class="radio" name="notify" value="0"<!-- IF not S_NOTIFY --> checked="checked"<!-- ENDIF --> /><span class="gen">{L_NO}</span></td>
+</tr>
+<tr>
+	<td class="cat" colspan="2" align="center">{S_HIDDEN_FIELDS}<input class="btnmain" type="submit" name="submit" value="{L_SUBMIT}" />&nbsp;&nbsp;<input class="btnlite" type="reset" value="{L_RESET}" name="reset" /></td>
+</tr>
+</table>
+
+<!-- INCLUDE ucp_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/ucp_prefs_view.html phpbb/styles/spring/template/ucp_prefs_view.html
--- phpBB-3.0.10/styles/spring/template/ucp_prefs_view.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/ucp_prefs_view.html	2014-04-15 14:31:18.743429004 +0200
@@ -0,0 +1,73 @@
+<!-- INCLUDE ucp_header.html -->
+
+<table class="tablebg" width="100%" cellspacing="1">
+<tr>
+	<th colspan="2" valign="middle">{L_TITLE}</th>
+</tr>
+<!-- IF ERROR -->
+	<tr>
+		<td class="row3" colspan="2" align="center"><span class="gensmall error">{ERROR}</span></td>
+	</tr>
+<!-- ENDIF -->
+<tr>
+	<td class="row1" width="50%"><b class="genmed">{L_VIEW_IMAGES}:</b></td>
+	<td class="row2"><input type="radio" class="radio" name="images" value="1"<!-- IF S_IMAGES --> checked="checked"<!-- ENDIF --> /><span class="gen">{L_YES}</span>&nbsp; &nbsp;<input type="radio" class="radio" name="images" value="0"<!-- IF not S_IMAGES --> checked="checked"<!-- ENDIF --> /><span class="gen">{L_NO}</span></td>
+</tr>
+<tr>
+	<td class="row1" width="50%"><b class="genmed">{L_VIEW_FLASH}:</b></td>
+	<td class="row2"><input type="radio" class="radio" name="flash" value="1"<!-- IF S_FLASH --> checked="checked"<!-- ENDIF --> /><span class="gen">{L_YES}</span>&nbsp; &nbsp;<input type="radio" class="radio" name="flash" value="0"<!-- IF not S_FLASH --> checked="checked"<!-- ENDIF --> /><span class="gen">{L_NO}</span></td>
+</tr>
+<tr>
+	<td class="row1" width="50%"><b class="genmed">{L_VIEW_SMILIES}:</b></td>
+	<td class="row2"><input type="radio" class="radio" name="smilies" value="1"<!-- IF S_SMILIES --> checked="checked"<!-- ENDIF --> /><span class="gen">{L_YES}</span>&nbsp; &nbsp;<input type="radio" class="radio" name="smilies" value="0"<!-- IF not S_SMILIES --> checked="checked"<!-- ENDIF --> /><span class="gen">{L_NO}</span></td>
+</tr>
+<tr>
+	<td class="row1" width="50%"><b class="genmed">{L_VIEW_SIGS}:</b></td>
+	<td class="row2"><input type="radio" class="radio" name="sigs" value="1"<!-- IF S_SIGS --> checked="checked"<!-- ENDIF --> /><span class="gen">{L_YES}</span>&nbsp; &nbsp;<input type="radio" class="radio" name="sigs" value="0"<!-- IF not S_SIGS --> checked="checked"<!-- ENDIF --> /><span class="gen">{L_NO}</span></td>
+</tr>
+<tr>
+	<td class="row1" width="50%"><b class="genmed">{L_VIEW_AVATARS}:</b></td>
+	<td class="row2"><input type="radio" class="radio" name="avatars" value="1"<!-- IF S_AVATARS --> checked="checked"<!-- ENDIF --> /><span class="gen">{L_YES}</span>&nbsp; &nbsp;<input type="radio" class="radio" name="avatars" value="0"<!-- IF not S_AVATARS --> checked="checked"<!-- ENDIF --> /><span class="gen">{L_NO}</span></td>
+</tr>
+<!-- IF S_CHANGE_CENSORS -->
+	<tr>
+		<td class="row1" width="50%"><b class="genmed">{L_DISABLE_CENSORS}:</b></td>
+		<td class="row2"><input type="radio" class="radio" name="wordcensor" value="1"<!-- IF S_DISABLE_CENSORS --> checked="checked"<!-- ENDIF --> /><span class="gen">{L_YES}</span>&nbsp; &nbsp;<input type="radio" class="radio" name="wordcensor" value="0"<!-- IF not S_DISABLE_CENSORS --> checked="checked"<!-- ENDIF --> /><span class="gen">{L_NO}</span></td>
+	</tr>
+<!-- ENDIF -->
+<tr>
+	<td colspan="2" class="spacer"></td>
+</tr>
+<tr>
+	<td class="row1" width="50%"><b class="genmed">{L_VIEW_TOPICS_DAYS}:</b></td>
+	<td class="row2">{S_TOPIC_SORT_DAYS}</td>
+</tr>
+<tr>
+	<td class="row1" width="50%"><b class="genmed">{L_VIEW_TOPICS_KEY}:</b></td>
+	<td class="row2">{S_TOPIC_SORT_KEY}</td>
+</tr>
+<tr>
+	<td class="row1" width="50%"><b class="genmed">{L_VIEW_TOPICS_DIR}:</b></td>
+	<td class="row2">{S_TOPIC_SORT_DIR}</td>
+</tr>
+<tr>
+	<td colspan="2" class="spacer"></td>
+</tr>
+<tr>
+	<td class="row1" width="50%"><b class="genmed">{L_VIEW_POSTS_DAYS}:</b></td>
+	<td class="row2">{S_POST_SORT_DAYS}</td>
+</tr>
+<tr>
+	<td class="row1" width="50%"><b class="genmed">{L_VIEW_POSTS_KEY}:</b></td>
+	<td class="row2">{S_POST_SORT_KEY}</td>
+</tr>
+<tr>
+	<td class="row1" width="50%"><b class="genmed">{L_VIEW_POSTS_DIR}:</b></td>
+	<td class="row2">{S_POST_SORT_DIR}</td>
+</tr>
+<tr>
+	<td class="cat" colspan="2" align="center">{S_HIDDEN_FIELDS}<input class="btnmain" type="submit" name="submit" value="{L_SUBMIT}" />&nbsp;&nbsp;<input class="btnlite" type="reset" value="{L_RESET}" name="reset" /></td>
+</tr>
+</table>
+
+<!-- INCLUDE ucp_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/ucp_profile_avatar.html phpbb/styles/spring/template/ucp_profile_avatar.html
--- phpBB-3.0.10/styles/spring/template/ucp_profile_avatar.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/ucp_profile_avatar.html	2014-04-15 14:31:18.744429004 +0200
@@ -0,0 +1,87 @@
+<!-- INCLUDE ucp_header.html -->
+
+<table class="tablebg" width="100%" cellspacing="1">
+<tr>
+	<th colspan="2" valign="middle">{L_TITLE}</th>
+</tr>
+<!-- IF ERROR -->
+	<tr>
+		<td class="row3" colspan="2" align="center"><span class="gensmall error">{ERROR}</span></td>
+	</tr>
+<!-- ENDIF -->
+<tr> 
+	<td class="row1" width="35%"><b class="genmed">{L_CURRENT_IMAGE}: </b><br /><span class="gensmall">{L_AVATAR_EXPLAIN}</span></td>
+	<td class="row2" align="center"><br />
+		<!-- IF AVATAR -->{AVATAR}<br /><br /><input type="checkbox" class="radio" name="delete" />&nbsp;<span class="gensmall">{L_DELETE_AVATAR}</span>
+		<!-- ELSE --><img src="{T_THEME_PATH}/images/no_avatar.gif" alt="" />
+		<!-- ENDIF --></td>
+</tr>
+<!-- IF not S_AVATARS_ENABLED -->
+	<tr>
+		<td class="row3" colspan="2" align="center">{L_AVATAR_FEATURES_DISABLED}</td>
+	</tr>
+<!-- ENDIF -->
+<!-- IF S_UPLOAD_AVATAR_FILE -->
+	<tr> 
+		<td class="row1" width="35%"><b class="genmed">{L_UPLOAD_AVATAR_FILE}: </b></td>
+		<td class="row2"><input type="hidden" name="MAX_FILE_SIZE" value="{AVATAR_SIZE}" /><input class="post" type="file" name="uploadfile" /></td>
+	</tr>
+<!-- ENDIF -->
+<!-- IF S_UPLOAD_AVATAR_URL -->
+	<tr> 
+		<td class="row1" width="35%"><b class="genmed">{L_UPLOAD_AVATAR_URL}: </b><br /><span class="gensmall">{L_UPLOAD_AVATAR_URL_EXPLAIN}</span></td>
+		<td class="row2"><input class="post" type="text" name="uploadurl" size="40" value="{AVATAR_URL}" /></td>
+	</tr>
+<!-- ENDIF -->
+<!-- IF S_LINK_AVATAR -->
+	<tr> 
+		<td class="row1" width="35%"><b class="genmed">{L_LINK_REMOTE_AVATAR}: </b><br /><span class="gensmall">{L_LINK_REMOTE_AVATAR_EXPLAIN}</span></td>
+		<td class="row2"><input class="post" type="text" name="remotelink" size="40" value="{AVATAR_REMOTE}" /></td>
+	</tr>
+	<tr> 
+		<td class="row1" width="35%"><b class="genmed">{L_LINK_REMOTE_SIZE}: </b><br /><span class="gensmall">{L_LINK_REMOTE_SIZE_EXPLAIN}</span></td>
+		<td class="row2"><input class="post" type="text" name="width" size="3" value="{AVATAR_WIDTH}" /> <span class="gen">{L_PIXEL} &times; </span> <input class="post" type="text" name="height" size="3" value="{AVATAR_HEIGHT}" /> <span class="gen">{L_PIXEL}</span></td>
+	</tr>
+<!-- ENDIF -->
+<!-- IF S_DISPLAY_GALLERY -->
+	<tr> 
+		<td class="row1" width="35%"><b class="genmed">{L_AVATAR_GALLERY}: </b></td>
+		<td class="row2"><strong><a href="{U_GALLERY}">{L_DISPLAY_GALLERY}</a></strong></td>
+	</tr>
+<!-- ENDIF -->
+
+<!-- IF S_IN_AVATAR_GALLERY -->
+	<tr> 
+		<th colspan="2">{L_AVATAR_GALLERY}</th>
+	</tr>
+	<tr> 
+		<td class="cat" colspan="2" align="center" valign="middle"><span class="genmed">{L_AVATAR_CATEGORY}: </span><select name="category">{S_CAT_OPTIONS}</select>&nbsp; <input class="btnlite" tabindex="0" type="submit" value="{L_GO}" name="display_gallery" /></td>
+	</tr>
+	<tr> 
+		<td class="row1" colspan="2" align="center">
+			<table cellspacing="1" cellpadding="4" border="0">
+			<!-- BEGIN avatar_row -->
+			<tr> 
+				<!-- BEGIN avatar_column -->
+					<td class="row1" align="center"><img src="{avatar_row.avatar_column.AVATAR_IMAGE}" alt="{avatar_row.avatar_column.AVATAR_NAME}" title="{avatar_row.avatar_column.AVATAR_NAME}" /></td>
+				<!-- END avatar_column -->
+			</tr>
+			<tr>
+				<!-- BEGIN avatar_option_column -->
+					<td class="row2" align="center"><input type="radio" class="radio" name="avatar_select" value="{avatar_row.avatar_option_column.S_OPTIONS_AVATAR}" /></td>
+				<!-- END avatar_option_column -->
+			</tr>
+			<!-- END avatar_row -->
+			</table>
+		</td>
+	</tr>
+<!-- ENDIF -->
+
+<!-- IF S_DISPLAY_GALLERY or S_IN_AVATAR_GALLERY or S_LINK_AVATAR or S_UPLOAD_AVATAR_URL or S_UPLOAD_AVATAR_FILE or AVATAR -->
+	<tr>
+		<td class="cat" colspan="2" align="center">{S_HIDDEN_FIELDS}<input class="btnmain" type="submit" name="submit" value="{L_SUBMIT}" />&nbsp;&nbsp;<!-- IF S_IN_AVATAR_GALLERY --><input class="btnlite" type="submit" name="cancel" value="{L_CANCEL}" /><!-- ELSE --><input class="btnlite" type="reset" value="{L_RESET}" name="reset" /><!-- ENDIF --></td>
+	</tr>
+<!-- ENDIF -->
+</table>
+
+<!-- INCLUDE ucp_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/ucp_profile_profile_info.html phpbb/styles/spring/template/ucp_profile_profile_info.html
--- phpBB-3.0.10/styles/spring/template/ucp_profile_profile_info.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/ucp_profile_profile_info.html	2014-04-15 14:31:18.745429004 +0200
@@ -0,0 +1,72 @@
+<!-- INCLUDE ucp_header.html -->
+
+<table class="tablebg" width="100%" cellspacing="1">
+<tr>
+	<th colspan="2" valign="middle">{L_TITLE}</th>
+</tr>
+<!-- IF ERROR -->
+	<tr>
+		<td class="row3" colspan="2" align="center"><span class="gensmall error">{ERROR}</span></td>
+	</tr>
+<!-- ENDIF -->
+<tr> 
+	<td class="row1" colspan="2"><span class="gensmall">{L_PROFILE_INFO_NOTICE}</span></td>
+</tr>
+<tr> 
+	<td class="row1" width="35%"><b class="genmed">{L_UCP_ICQ}: </b></td>
+	<td class="row2"><input class="post" type="text" name="icq" size="30" maxlength="15" value="{ICQ}" /></td>
+</tr>
+<tr> 
+	<td class="row1" width="35%"><b class="genmed">{L_UCP_AIM}: </b></td>
+	<td class="row2"><input class="post" type="text" name="aim" size="30" maxlength="255" value="{AIM}" /></td>
+</tr>
+<tr> 
+	<td class="row1" width="35%"><b class="genmed">{L_UCP_MSNM}: </b></td>
+	<td class="row2"><input class="post" type="text" name="msn" size="30" maxlength="255" value="{MSN}" /></td>
+</tr>
+<tr> 
+	<td class="row1" width="35%"><b class="genmed">{L_UCP_YIM}: </b></td>
+	<td class="row2"><input class="post" type="text" name="yim" size="30" maxlength="255" value="{YIM}" /></td>
+</tr>
+<tr> 
+	<td class="row1" width="35%"><b class="genmed">{L_UCP_JABBER}: </b></td>
+	<td class="row2"><input class="post" type="text" name="jabber" size="30" maxlength="255" value="{JABBER}" /></td>
+</tr>
+<tr> 
+	<td class="row1" width="35%"><b class="genmed">{L_WEBSITE}: </b></td>
+	<td class="row2"><input class="post" type="text" name="website" size="30" maxlength="255" value="{WEBSITE}" /></td>
+</tr>
+<tr> 
+	<td class="row1" width="35%"><b class="genmed">{L_LOCATION}: </b></td>
+	<td class="row2"><input class="post" type="text" name="location" size="30" maxlength="100" value="{LOCATION}" /></td>
+</tr>
+<tr> 
+	<td class="row1" width="35%"><b class="genmed">{L_OCCUPATION}: </b></td>
+	<td class="row2"><textarea class="post" name="occupation" rows="3" cols="30">{OCCUPATION}</textarea></td>
+</tr>
+<tr> 
+	<td class="row1" width="35%"><b class="genmed">{L_INTERESTS}: </b></td>
+	<td class="row2"><textarea class="post" name="interests" rows="3" cols="30">{INTERESTS}</textarea></td>
+</tr>
+<!-- IF S_BIRTHDAYS_ENABLED -->
+	<tr> 
+		<td class="row1" width="35%"><b class="genmed">{L_BIRTHDAY}: </b><br /><span class="gensmall">{L_BIRTHDAY_EXPLAIN}</span></td>
+		<td class="row2"><span class="genmed">{L_DAY}:</span> <select name="bday_day">{S_BIRTHDAY_DAY_OPTIONS}</select> <span class="genmed">{L_MONTH}:</span> <select name="bday_month">{S_BIRTHDAY_MONTH_OPTIONS}</select> <span class="genmed">{L_YEAR}:</span> <select name="bday_year">{S_BIRTHDAY_YEAR_OPTIONS}</select></td>
+	</tr>
+<!-- ENDIF -->
+<!-- BEGIN profile_fields -->
+	<tr> 
+		<td class="row1" width="35%">
+			<b class="genmed">{profile_fields.LANG_NAME}: </b>
+			<!-- IF profile_fields.S_REQUIRED --><b>*</b><!-- ENDIF -->
+			<!-- IF profile_fields.LANG_EXPLAIN --><br /><span class="gensmall">{profile_fields.LANG_EXPLAIN}</span><!-- ENDIF -->
+		</td>
+		<td class="row2">{profile_fields.FIELD}<!-- IF profile_fields.ERROR --><br /><span class="gensmall error">{profile_fields.ERROR}</span><!-- ENDIF --></td>
+	</tr>
+<!-- END profile_fields -->
+<tr>
+	<td class="cat" colspan="2" align="center">{S_HIDDEN_FIELDS}<input class="btnmain" type="submit" name="submit" value="{L_SUBMIT}" />&nbsp;&nbsp;<input class="btnlite" type="reset" value="{L_RESET}" name="reset" /></td>
+</tr>
+</table>
+
+<!-- INCLUDE ucp_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/ucp_profile_reg_details.html phpbb/styles/spring/template/ucp_profile_reg_details.html
--- phpBB-3.0.10/styles/spring/template/ucp_profile_reg_details.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/ucp_profile_reg_details.html	2014-04-15 14:31:18.745429004 +0200
@@ -0,0 +1,53 @@
+<!-- INCLUDE ucp_header.html -->
+
+<table class="tablebg" width="100%" cellspacing="1">
+<tr>
+	<th colspan="2" valign="middle">{L_TITLE}</th>
+</tr>
+<!-- IF S_FORCE_PASSWORD -->
+	<tr>
+		<td class="row3" colspan="2" align="center"><span class="gensmall">{L_FORCE_PASSWORD_EXPLAIN}</span></td>
+	</tr>
+<!-- ENDIF -->
+<!-- IF ERROR -->
+	<tr>
+		<td class="row3" colspan="2" align="center"><span class="gensmall error">{ERROR}</span></td>
+	</tr>
+<!-- ENDIF -->
+<tr>
+	<td class="row1" width="35%"><b class="genmed">{L_USERNAME}: </b><br /><span class="gensmall">{L_USERNAME_EXPLAIN}</span></td>
+	<td class="row2"><!-- IF S_CHANGE_USERNAME --><input type="text" class="post" name="username" size="30" value="{USERNAME}" /><!-- ELSE --><b class="gen">{USERNAME}</b><!-- ENDIF --></td>
+</tr>
+<tr>
+	<td class="row1" width="35%"><b class="genmed">{L_EMAIL_ADDRESS}: </b></td>
+	<td class="row2"><!-- IF S_CHANGE_EMAIL --><input type="text" class="post" name="email" size="30" maxlength="100" value="{EMAIL}" /><!-- ELSE --><b class="gen">{EMAIL}</b><!-- ENDIF --></td>
+</tr>
+<!-- IF S_CHANGE_EMAIL -->
+	<tr>
+		<td class="row1" width="35%"><b class="genmed">{L_CONFIRM_EMAIL}: </b><br /><span class="gensmall">{L_CONFIRM_EMAIL_EXPLAIN}</span></td>
+		<td class="row2"><input type="text" class="post" name="email_confirm" size="30" maxlength="100" value="{CONFIRM_EMAIL}" /></td>
+	</tr>
+<!-- ENDIF -->
+<!-- IF S_CHANGE_PASSWORD -->
+	<tr>
+		<td class="row1" width="35%"><b class="genmed">{L_NEW_PASSWORD}: </b><br /><span class="gensmall">{L_CHANGE_PASSWORD_EXPLAIN}</span></td>
+		<td class="row2"><input type="password" class="post" name="new_password" size="30" maxlength="255" value="{NEW_PASSWORD}" /></td>
+	</tr>
+	<tr>
+		<td class="row1" width="35%"><b class="genmed">{L_CONFIRM_PASSWORD}: </b><br /><span class="gensmall">{L_CONFIRM_PASSWORD_EXPLAIN}</span></td>
+		<td class="row2"><input type="password" class="post" name="password_confirm" size="30" maxlength="255" value="{PASSWORD_CONFIRM}" /></td>
+	</tr>
+<!-- ENDIF -->
+<tr>
+	<th colspan="2">{L_CONFIRM_CHANGES}</th>
+</tr>
+<tr>
+	<td class="row1" width="35%"><b class="genmed">{L_CURRENT_PASSWORD}: </b><br /><span class="gensmall">{L_CURRENT_PASSWORD_EXPLAIN}</span></td>
+	<td class="row2"><input type="password" class="post" name="cur_password" size="30" maxlength="255" value="{CUR_PASSWORD}" /></td>
+</tr>
+<tr>
+	<td class="cat" colspan="2" align="center">{S_HIDDEN_FIELDS}<input class="btnmain" type="submit" name="submit" value="{L_SUBMIT}" />&nbsp;&nbsp;<input class="btnlite" type="reset" value="{L_RESET}" name="reset" /></td>
+</tr>
+</table>
+
+<!-- INCLUDE ucp_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/ucp_profile_signature.html phpbb/styles/spring/template/ucp_profile_signature.html
--- phpBB-3.0.10/styles/spring/template/ucp_profile_signature.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/ucp_profile_signature.html	2014-04-15 14:31:18.746429004 +0200
@@ -0,0 +1,110 @@
+<!-- INCLUDE ucp_header.html -->
+
+<!-- DEFINE $S_SIGNATURE = 1 -->
+<table class="tablebg" width="100%" cellspacing="1">
+<tr>
+	<th colspan="2">{L_TITLE}</th>
+</tr>
+<tr>
+	<td colspan="2" class="row1">{L_SIGNATURE_EXPLAIN}</td>
+</tr>
+
+<!-- IF ERROR -->
+	<tr>
+		<td class="row3" colspan="2" align="center"><span class="genmed error">{ERROR}</span></td>
+	</tr>
+<!-- ENDIF -->
+
+<tr>
+	<td colspan="2" class="row2">
+		<script type="text/javascript">
+		// <![CDATA[
+			var form_name = 'ucp';
+			var text_name = 'signature';
+		// ]]>
+		</script>
+		
+		<table cellspacing="0" cellpadding="2" border="0" width="99%">
+		<!-- INCLUDE posting_buttons.html -->
+		<tr>
+			<td colspan="2"><textarea class="post" name="signature" rows="10" cols="76" style="width: 90%;" onselect="storeCaret(this);" onclick="storeCaret(this);" onkeyup="storeCaret(this);" onfocus="initInsertions();">{SIGNATURE}</textarea></td>
+		</tr>
+		<!-- IF S_BBCODE_ALLOWED -->
+		<tr>
+			<td colspan="2">
+				<table cellspacing="0" cellpadding="0" border="0" width="100%">
+				<tr>
+					<td align="{S_CONTENT_FLOW_BEGIN}">
+						<script type="text/javascript">
+						// <![CDATA[
+							colorPalette('h', 6, 5)
+						// ]]>
+						</script>
+					</td>
+				</tr>
+				</table>
+			</td>
+		</tr>
+		<!-- ENDIF -->
+		</table>
+	</td>
+</tr>
+<tr>
+	<td class="row1" valign="top"><b class="genmed">{L_OPTIONS}</b><br />
+		<table cellspacing="2" cellpadding="0" border="0">
+		<tr>
+			<td class="gensmall">{BBCODE_STATUS}</td>
+		</tr>
+		<tr>
+			<td class="gensmall">{IMG_STATUS}</td>
+		</tr>
+		<tr>
+			<td class="gensmall">{FLASH_STATUS}</td>
+		</tr>
+		<tr>
+			<td class="gensmall">{URL_STATUS}</td>
+		</tr>
+		<tr>
+			<td class="gensmall">{SMILIES_STATUS}</td>
+		</tr>
+		</table>
+	</td>
+	<td class="row2" valign="top">
+		<table cellspacing="0" cellpadding="1" border="0">
+		<!-- IF S_BBCODE_ALLOWED -->
+			<tr>
+				<td><input type="checkbox" class="radio" name="disable_bbcode"{S_BBCODE_CHECKED} /></td>
+				<td class="gen">{L_DISABLE_BBCODE}</td>
+			</tr>
+		<!-- ENDIF -->
+		<!-- IF S_SMILIES_ALLOWED -->
+			<tr>
+				<td><input type="checkbox" class="radio" name="disable_smilies"{S_SMILIES_CHECKED} /></td>
+				<td class="gen">{L_DISABLE_SMILIES}</td>
+			</tr>
+		<!-- ENDIF -->
+		<!-- IF S_LINKS_ALLOWED -->
+			<tr>
+				<td><input type="checkbox" class="radio" name="disable_magic_url"{S_MAGIC_URL_CHECKED} /></td>
+				<td class="gen">{L_DISABLE_MAGIC_URL}</td>
+			</tr>
+		<!-- ENDIF -->
+		</table>
+	</td>
+</tr>
+
+<!-- IF SIGNATURE_PREVIEW != '' -->
+	<tr>
+		<th colspan="2" valign="middle">{L_SIGNATURE_PREVIEW}</th>
+	</tr>
+	<tr> 
+		<td class="row1" colspan="2"><div class="postbody" style="padding: 6px;">{SIGNATURE_PREVIEW}</div></td>
+	</tr>
+<!-- ENDIF -->
+
+<tr>
+	<td class="cat" colspan="2" align="center">{S_HIDDEN_FIELDS}<input class="btnlite" type="submit" name="preview" value="{L_PREVIEW}" />&nbsp;&nbsp;<input class="btnmain" type="submit" name="submit" value="{L_SUBMIT}" />&nbsp;&nbsp;<input class="btnlite" type="reset" value="{L_RESET}" name="reset" /></td>
+</tr>
+</table>
+
+<!-- INCLUDE ucp_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/ucp_register.html phpbb/styles/spring/template/ucp_register.html
--- phpBB-3.0.10/styles/spring/template/ucp_register.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/ucp_register.html	2014-04-15 14:31:18.747429004 +0200
@@ -0,0 +1,101 @@
+<!-- INCLUDE overall_header.html -->
+
+<script type="text/javascript">
+// <![CDATA[
+	/**
+	* Change language
+	*/
+	function change_language(lang_iso)
+	{
+		document.forms['register'].change_lang.value = lang_iso;
+		document.forms['register'].submit.click();
+	}
+
+// ]]>
+</script>
+
+<form name="register" method="post" action="{S_UCP_ACTION}">
+
+<table class="tablebg" width="100%" cellspacing="1">
+<tr>
+	<th colspan="2" valign="middle">{L_REGISTRATION}</th>
+</tr>
+
+<!-- IF ERROR -->
+	<tr>
+		<td class="row3" colspan="2" align="center"><span class="gensmall error">{ERROR}</span></td>
+	</tr>
+<!-- ENDIF -->
+
+<!-- IF L_REG_COND -->
+	<tr>
+		<td class="row2" colspan="2"><span class="gensmall">{L_REG_COND}</span></td>
+	</tr>
+<!-- ENDIF -->
+
+<tr>
+	<td class="row1" width="38%"><b class="genmed">{L_USERNAME}: </b><br /><span class="gensmall">{L_USERNAME_EXPLAIN}</span></td>
+	<td class="row2"><input class="post" type="text" name="username" size="25" value="{USERNAME}" /></td>
+</tr>
+<tr>
+	<td class="row1"><b class="genmed">{L_EMAIL_ADDRESS}: </b></td>
+	<td class="row2"><input class="post" type="text" name="email" size="25" maxlength="100" value="{EMAIL}" /></td>
+</tr>
+<tr>
+	<td class="row1"><b class="genmed">{L_CONFIRM_EMAIL}: </b></td>
+	<td class="row2"><input class="post" type="text" name="email_confirm" size="25" maxlength="100" value="{EMAIL_CONFIRM}" /></td>
+</tr>
+<tr>
+	<td class="row1"><b class="genmed">{L_PASSWORD}: </b><br /><span class="gensmall">{L_PASSWORD_EXPLAIN}</span></td>
+	<td class="row2"><input class="post" type="password" name="new_password" size="25" value="{PASSWORD}" /></td>
+</tr>
+<tr>
+	<td class="row1"><b class="genmed">{L_CONFIRM_PASSWORD}: </b></td>
+	<td class="row2"><input class="post" type="password" name="password_confirm" size="25" value="{PASSWORD_CONFIRM}" /></td>
+</tr>
+<tr>
+	<td class="row1"><b class="genmed">{L_LANGUAGE}: </b></td>
+	<td class="row2"><select name="lang" onchange="change_language(this.value); return false;">{S_LANG_OPTIONS}</select></td>
+</tr>
+<tr>
+	<td class="row1"><b class="genmed">{L_TIMEZONE}: </b></td>
+	<td class="row2"><select name="tz">{S_TZ_OPTIONS}</select></td>
+</tr>
+<!-- IF .profile_fields -->
+	<tr>
+		<td class="row2" colspan="2"><span class="gensmall">{L_ITEMS_REQUIRED}</span></td>
+	</tr>
+<!-- BEGIN profile_fields -->
+	<tr>
+		<td class="row1" width="35%">
+			<b class="genmed">{profile_fields.LANG_NAME}: </b>
+			<!-- IF profile_fields.S_REQUIRED --><b>*</b><!-- ENDIF -->
+			<!-- IF profile_fields.LANG_EXPLAIN --><br /><span class="gensmall">{profile_fields.LANG_EXPLAIN}</span><!-- ENDIF -->
+		</td>
+		<td class="row2">{profile_fields.FIELD}<!-- IF profile_fields.ERROR --><br /><span class="gensmall error">{profile_fields.ERROR}</span><!-- ENDIF --></td>
+	</tr>
+	
+<!-- END profile_fields -->
+<!-- ENDIF -->
+
+		<!-- IF CAPTCHA_TEMPLATE -->
+		<!-- INCLUDE {CAPTCHA_TEMPLATE} -->
+		<!-- ENDIF -->
+
+<!-- IF S_COPPA -->
+	<tr>
+		<th colspan="2" valign="middle">{L_COPPA_COMPLIANCE}</th>
+	</tr>
+	<tr>
+		<td class="row3" colspan="2"><span class="gensmall">{L_COPPA_EXPLAIN}</span></td>
+	</tr>
+<!-- ENDIF -->
+
+<tr>
+	<td class="cat" colspan="2" align="center">{S_HIDDEN_FIELDS}<input class="btnmain" type="submit" name="submit" id="submit" value="{L_SUBMIT}" />&nbsp;&nbsp;<input class="btnlite" type="reset" value="{L_RESET}" name="reset" /></td>
+</tr>
+</table>
+{S_FORM_TOKEN}
+</form>
+
+<!-- INCLUDE overall_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/ucp_remind.html phpbb/styles/spring/template/ucp_remind.html
--- phpBB-3.0.10/styles/spring/template/ucp_remind.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/ucp_remind.html	2014-04-15 14:31:18.747429004 +0200
@@ -0,0 +1,28 @@
+<!-- INCLUDE overall_header.html -->
+
+<div align="center">
+
+<form action="{S_PROFILE_ACTION}" method="post">
+
+<table class="tablebg" width="50%" cellspacing="1" cellpadding="4" border="0">
+<tr> 
+	<th colspan="2">{L_SEND_PASSWORD}</th>
+</tr>
+<tr> 
+	<td class="row1" width="38%"><b class="genmed">{L_USERNAME}: </b></td>
+	<td class="row2"><input type="text" class="post" name="username" size="25" value="{USERNAME}" /></td>
+</tr>
+<tr> 
+	<td class="row1"><b class="genmed">{L_EMAIL_ADDRESS}: </b><br /><span class="gensmall">{L_EMAIL_REMIND}</span></td>
+	<td class="row2"><input type="text" class="post" name="email" size="25" maxlength="100" value="{EMAIL}" /></td>
+</tr>
+<tr> 
+	<td class="cat" colspan="2" align="center">{S_HIDDEN_FIELDS}<input type="submit" name="submit" value="{L_SUBMIT}" class="btnmain" />&nbsp;&nbsp;<input type="reset" value="{L_RESET}" name="reset" class="btnlite" /></td>
+</tr>
+</table>
+{S_FORM_TOKEN}
+</form>
+
+</div>
+
+<!-- INCLUDE overall_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/ucp_resend.html phpbb/styles/spring/template/ucp_resend.html
--- phpBB-3.0.10/styles/spring/template/ucp_resend.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/ucp_resend.html	2014-04-15 14:31:18.748429004 +0200
@@ -0,0 +1,29 @@
+<!-- INCLUDE overall_header.html -->
+
+<div align="center">
+
+<form action="{S_PROFILE_ACTION}" method="post">
+
+<table class="tablebg" width="50%" cellspacing="1" cellpadding="4" border="0">
+<tr>
+	<th colspan="2">{L_UCP_RESEND}</th>
+</tr>
+<tr>
+	<td class="row1" width="38%"><b class="genmed">{L_USERNAME}: </b></td>
+	<td class="row2"><input type="text" class="post" name="username" size="25" value="{USERNAME}" /></td>
+</tr>
+<tr>
+	<td class="row1"><b class="genmed">{L_EMAIL_ADDRESS}: </b><br /><span class="gensmall">{L_EMAIL_REMIND}</span></td>
+	<td class="row2"><input type="text" class="post" name="email" size="25" maxlength="100" value="{EMAIL}" /></td>
+</tr>
+<tr>
+	<td class="cat" colspan="2" align="center">{S_HIDDEN_FIELDS}<input type="submit" name="submit" value="{L_SUBMIT}" class="btnmain" />&nbsp;&nbsp;<input type="reset" value="{L_RESET}" name="reset" class="btnlite" /></td>
+</tr>
+</table>
+{S_FORM_TOKEN}
+
+</form>
+
+</div>
+
+<!-- INCLUDE overall_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/ucp_zebra_foes.html phpbb/styles/spring/template/ucp_zebra_foes.html
--- phpBB-3.0.10/styles/spring/template/ucp_zebra_foes.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/ucp_zebra_foes.html	2014-04-15 14:31:18.748429004 +0200
@@ -0,0 +1,28 @@
+<!-- INCLUDE ucp_header.html -->
+
+<table class="tablebg" width="100%" cellspacing="1">
+<tr>
+	<th colspan="2" valign="middle">{L_TITLE}</th>
+</tr>
+<tr>
+	<td class="row3" colspan="2"><span class="gensmall">{L_FOES_EXPLAIN}</span></td>
+</tr>
+<!-- IF ERROR -->
+	<tr>
+		<td class="row3" colspan="2" align="center"><span class="gensmall error">{ERROR}</span></td>
+	</tr>
+<!-- ENDIF -->
+<tr>
+	<td class="row1" width="40%"><b class="genmed">{L_YOUR_FOES}:</b><br /><span class="gensmall">{L_YOUR_FOES_EXPLAIN}</span></td>
+	<td class="row2" align="center"><!-- IF S_USERNAME_OPTIONS --><select name="usernames[]" multiple="multiple" size="5">{S_USERNAME_OPTIONS}</select><!-- ELSE --><b class="genmed">{L_NO_FOES}</b><!-- ENDIF --></td>
+</tr>
+<tr>
+	<td class="row1"><b class="genmed">{L_ADD_FOES}:</b><br /><span class="gensmall">{L_ADD_FOES_EXPLAIN} [ <a href="{U_FIND_USERNAME}" onclick="find_username(this.href); return false;">{L_FIND_USERNAME}</a> ]</span></td>
+	<td class="row2" align="center"><textarea name="add" rows="5" cols="30">{USERNAMES}</textarea><br /></td>
+</tr>
+<tr>
+	<td class="cat" colspan="2" align="center">{S_HIDDEN_FIELDS}<input class="btnmain" type="submit" name="submit" value="{L_SUBMIT}" />&nbsp;&nbsp;<input class="btnlite" type="reset" value="{L_RESET}" name="reset" /></td>
+</tr>
+</table>
+
+<!-- INCLUDE ucp_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/ucp_zebra_friends.html phpbb/styles/spring/template/ucp_zebra_friends.html
--- phpBB-3.0.10/styles/spring/template/ucp_zebra_friends.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/ucp_zebra_friends.html	2014-04-15 14:31:18.749429004 +0200
@@ -0,0 +1,28 @@
+<!-- INCLUDE ucp_header.html -->
+
+<table class="tablebg" width="100%" cellspacing="1">
+<tr>
+	<th colspan="2" valign="middle">{L_TITLE}</th>
+</tr>
+<tr>
+	<td class="row3" colspan="2"><span class="gensmall">{L_FRIENDS_EXPLAIN}</span></td>
+</tr>
+<!-- IF ERROR -->
+	<tr>
+		<td class="row3" colspan="2" align="center"><span class="gensmall error">{ERROR}</span></td>
+	</tr>
+<!-- ENDIF -->
+<tr>
+	<td class="row1" width="40%"><b class="genmed">{L_YOUR_FRIENDS}:</b><br /><span class="gensmall">{L_YOUR_FRIENDS_EXPLAIN}</span></td>
+	<td class="row2" align="center"><!-- IF S_USERNAME_OPTIONS --><select name="usernames[]" multiple="multiple" size="5">{S_USERNAME_OPTIONS}</select><!-- ELSE --><b class="genmed">{L_NO_FRIENDS}</b><!-- ENDIF --></td>
+</tr>
+<tr>
+	<td class="row1"><b class="genmed">{L_ADD_FRIENDS}:</b><br /><span class="gensmall">{L_ADD_FRIENDS_EXPLAIN} [ <a href="{U_FIND_USERNAME}" onclick="find_username(this.href); return false;">{L_FIND_USERNAME}</a> ]</span></td>
+	<td class="row2" align="center"><textarea name="add" rows="5" cols="30">{USERNAMES}</textarea><br /></td>
+</tr>
+<tr>
+	<td class="cat" colspan="2" align="center">{S_HIDDEN_FIELDS}<input class="btnmain" type="submit" name="submit" value="{L_SUBMIT}" />&nbsp;&nbsp;<input class="btnlite" type="reset" value="{L_RESET}" name="reset" /></td>
+</tr>
+</table>
+
+<!-- INCLUDE ucp_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/viewforum_body.html phpbb/styles/spring/template/viewforum_body.html
--- phpBB-3.0.10/styles/spring/template/viewforum_body.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/viewforum_body.html	2014-04-15 14:31:18.751429004 +0200
@@ -0,0 +1,329 @@
+<!-- INCLUDE overall_header.html -->
+
+<!-- IF S_FORUM_RULES -->
+	<div class="forumrules">
+		<!-- IF U_FORUM_RULES -->
+			<h3>{L_FORUM_RULES}</h3><br />
+			<a href="{U_FORUM_RULES}"><b>{L_FORUM_RULES_LINK}</b></a>
+		<!-- ELSE -->
+			<h3>{L_FORUM_RULES}</h3><br />
+			{FORUM_RULES}
+		<!-- ENDIF -->
+	</div>
+
+	<br clear="all" />
+<!-- ENDIF -->
+
+<!-- IF S_DISPLAY_ACTIVE -->
+	<table class="tablebg" width="100%" cellspacing="1">
+	<tr>
+		<td class="cat" colspan="<!-- IF S_TOPIC_ICONS -->7<!-- ELSE -->6<!-- ENDIF -->"><span class="nav">{L_ACTIVE_TOPICS}</span></td>
+	</tr>
+
+	<tr>
+		<!-- IF S_TOPIC_ICONS -->
+			<th colspan="3">&nbsp;{L_TOPICS}&nbsp;</th>
+		<!-- ELSE -->
+			<th colspan="2">&nbsp;{L_TOPICS}&nbsp;</th>
+		<!-- ENDIF -->
+		<th>&nbsp;{L_AUTHOR}&nbsp;</th>
+		<th>&nbsp;{L_REPLIES}&nbsp;</th>
+		<th>&nbsp;{L_VIEWS}&nbsp;</th>
+		<th>&nbsp;{L_LAST_POST}&nbsp;</th>
+	</tr>
+
+	<!-- BEGIN topicrow -->
+
+		<tr>
+			<td class="row1" width="25" align="center">{topicrow.TOPIC_FOLDER_IMG}</td>
+			<!-- IF S_TOPIC_ICONS -->
+				<td class="row1" width="25" align="center"><!-- IF topicrow.TOPIC_ICON_IMG --><img src="{T_ICONS_PATH}{topicrow.TOPIC_ICON_IMG}" width="{topicrow.TOPIC_ICON_IMG_WIDTH}" height="{topicrow.TOPIC_ICON_IMG_HEIGHT}" alt="" title="" /><!-- ENDIF --></td>
+			<!-- ENDIF -->
+			<td class="row1">
+				<!-- IF topicrow.S_UNREAD_TOPIC --><a href="{topicrow.U_NEWEST_POST}">{NEWEST_POST_IMG}</a><!-- ENDIF -->
+				{topicrow.ATTACH_ICON_IMG} <!-- IF topicrow.S_HAS_POLL or topicrow.S_TOPIC_MOVED --><b>{topicrow.TOPIC_TYPE}</b> <!-- ENDIF --><a title="{L_POSTED}: {topicrow.FIRST_POST_TIME}" href="{topicrow.U_VIEW_TOPIC}"class="topictitle">{topicrow.TOPIC_TITLE}</a>
+				<!-- IF topicrow.S_TOPIC_UNAPPROVED or topicrow.S_POSTS_UNAPPROVED -->
+					<a href="{topicrow.U_MCP_QUEUE}">{UNAPPROVED_IMG}</a>&nbsp;
+				<!-- ENDIF -->
+				<!-- IF topicrow.S_TOPIC_REPORTED -->
+					<a href="{topicrow.U_MCP_REPORT}">{REPORTED_IMG}</a>&nbsp;
+				<!-- ENDIF -->
+				<!-- IF topicrow.PAGINATION -->
+					<p class="gensmall"> [ {GOTO_PAGE_IMG}{L_GOTO_PAGE}: {topicrow.PAGINATION} ] </p>
+				<!-- ENDIF -->
+			</td>
+			<td class="row2" width="130" align="center"><p class="topicauthor">{topicrow.TOPIC_AUTHOR_FULL}</p></td>
+			<td class="row1" width="50" align="center"><p class="topicdetails">{topicrow.REPLIES}</p></td>
+			<td class="row2" width="50" align="center"><p class="topicdetails">{topicrow.VIEWS}</p></td>
+			<td class="row1" width="140" align="center">
+				<p class="topicdetails" style="white-space: nowrap;">{topicrow.LAST_POST_TIME}</p>
+				<p class="topicdetails">{topicrow.LAST_POST_AUTHOR_FULL}
+					<!-- IF not S_IS_BOT --><a href="{topicrow.U_LAST_POST}">{LAST_POST_IMG}</a><!-- ENDIF -->
+				</p>
+			</td>
+		</tr>
+
+	<!-- BEGINELSE -->
+
+		<tr>
+			<!-- IF S_TOPIC_ICONS -->
+				<td class="row1" colspan="7" height="30" align="center" valign="middle"><span class="gen"><!-- IF not S_SORT_DAYS -->{L_NO_TOPICS}<!-- ELSE -->{L_NO_TOPICS_TIME_FRAME}<!-- ENDIF --></span></td>
+			<!-- ELSE -->
+				<td class="row1" colspan="6" height="30" align="center" valign="middle"><span class="gen"><!-- IF not S_SORT_DAYS -->{L_NO_TOPICS}<!-- ELSE -->{L_NO_TOPICS_TIME_FRAME}<!-- ENDIF --></span></td>
+			<!-- ENDIF -->
+		</tr>
+	<!-- END topicrow -->
+
+	<tr align="center">
+		<td class="cat" colspan="<!-- IF S_TOPIC_ICONS -->7<!-- ELSE -->6<!-- ENDIF -->">&nbsp;</td>
+	</tr>
+	</table>
+
+	<br clear="all" />
+<!-- ENDIF -->
+
+<!-- IF S_HAS_SUBFORUM -->
+	<!-- INCLUDE forumlist_body.html -->
+	<br clear="all" />
+<!-- ENDIF -->
+
+<!-- IF S_IS_POSTABLE or S_NO_READ_ACCESS -->
+<!--	<div id="pageheader">
+ 		<h2><a class="titles" href="{U_VIEW_FORUM}">{FORUM_NAME}</a></h2> 
+
+	</div>
+
+	<br clear="all" /><br /> -->
+<!-- ENDIF -->
+
+<div id="pagecontent">
+
+<!-- IF S_NO_READ_ACCESS -->
+	<table class="tablebg" width="100%" cellspacing="1">
+	<tr>
+		<td class="row1" height="30" align="center" valign="middle"><span class="gen">{L_NO_READ_ACCESS}</span></td>
+	</tr>
+	</table>
+
+	<!-- IF not S_USER_LOGGED_IN and not S_IS_BOT -->
+
+		<br /><br />
+
+		<form method="post" action="{S_LOGIN_ACTION}">
+
+		<table class="tablebg" width="100%" cellspacing="1">
+		<tr>
+			<td class="cat"><h4><a href="{U_LOGIN_LOGOUT}">{L_LOGIN_LOGOUT}</a></h4></td>
+		</tr>
+		<tr>
+			<td class="row1" align="center"><span class="genmed">{L_USERNAME}:</span> <input class="post" type="text" name="username" size="10" />&nbsp; <span class="genmed">{L_PASSWORD}:</span> <input class="post" type="password" name="password" size="10" /><!-- IF S_AUTOLOGIN_ENABLED -->&nbsp; <span class="gensmall">{L_LOG_ME_IN}</span> <input type="checkbox" class="radio" name="autologin" /><!-- ENDIF -->&nbsp; <input type="submit" class="btnmain" name="login" value="{L_LOGIN}" /></td>
+		</tr>
+		</table>
+		{S_LOGIN_REDIRECT}
+		</form>
+
+	<!-- ENDIF -->
+
+	<br clear="all" />
+<!-- ENDIF -->
+
+	<!-- IF S_DISPLAY_POST_INFO or TOTAL_TOPICS -->
+		<table width="100%" cellspacing="1">
+		<tr>
+			<!-- IF S_DISPLAY_POST_INFO and not S_IS_BOT -->
+				<td align="{S_CONTENT_FLOW_BEGIN}" valign="middle"><a href="{U_POST_NEW_TOPIC}">{POST_IMG}</a></td>
+			<!-- ENDIF -->
+			<!-- IF TOTAL_TOPICS -->
+				<td class="nav" valign="middle" nowrap="nowrap">&nbsp;{PAGE_NUMBER}<br /></td>
+				<td class="gensmall" nowrap="nowrap">&nbsp;[ {TOTAL_TOPICS} ]&nbsp;</td>
+				<td class="gensmall" width="100%" align="{S_CONTENT_FLOW_END}" nowrap="nowrap"><!-- INCLUDE pagination.html --></td>
+			<!-- ENDIF -->
+		</tr>
+		</table>
+	<!-- ENDIF -->
+
+	<!-- IF not S_DISPLAY_ACTIVE and (S_IS_POSTABLE or .topicrow) -->
+		<table class="tablebg" width="100%" cellspacing="1">
+		<tr>
+			<td class="cat" colspan="<!-- IF S_TOPIC_ICONS -->7<!-- ELSE -->6<!-- ENDIF -->">
+				<table width="100%" cellspacing="0">
+				<tr class="nav">
+					<td valign="middle">&nbsp;<!-- IF S_WATCH_FORUM_LINK and not S_IS_BOT --><a href="{S_WATCH_FORUM_LINK}">{S_WATCH_FORUM_TITLE}</a><!-- ENDIF --></td>
+					<td align="{S_CONTENT_FLOW_END}" valign="middle"><!-- IF not S_IS_BOT and U_MARK_TOPICS --><a href="{U_MARK_TOPICS}">{L_MARK_TOPICS_READ}</a><!-- ENDIF -->&nbsp;</td>
+				</tr>
+				</table>
+			</td>
+		</tr>
+
+		<tr>
+			<!-- IF S_TOPIC_ICONS -->
+				<th colspan="3">&nbsp;{L_TOPICS}&nbsp;</th>
+			<!-- ELSE -->
+				<th colspan="2">&nbsp;{L_TOPICS}&nbsp;</th>
+			<!-- ENDIF -->
+			<th>&nbsp;{L_AUTHOR}&nbsp;</th>
+			<th>&nbsp;{L_REPLIES}&nbsp;</th>
+			<th>&nbsp;{L_VIEWS}&nbsp;</th>
+			<th>&nbsp;{L_LAST_POST}&nbsp;</th>
+		</tr>
+
+		<!-- BEGIN topicrow -->
+
+			<!-- IF topicrow.S_TOPIC_TYPE_SWITCH eq 1 -->
+				<tr>
+					<td class="row3" colspan="<!-- IF S_TOPIC_ICONS -->7<!-- ELSE -->6<!-- ENDIF -->"><b class="gensmall">{L_ANNOUNCEMENTS}</b></td>
+				</tr>
+			<!-- ELSEIF topicrow.S_TOPIC_TYPE_SWITCH eq 0 -->
+				<tr>
+					<td class="row3" colspan="<!-- IF S_TOPIC_ICONS -->7<!-- ELSE -->6<!-- ENDIF -->"><b class="gensmall">{L_TOPICS}</b></td>
+				</tr>
+			<!-- ENDIF -->
+
+			<tr>
+				<td class="row1" width="25" align="center">{topicrow.TOPIC_FOLDER_IMG}</td>
+				<!-- IF S_TOPIC_ICONS -->
+					<td class="row1" width="25" align="center"><!-- IF topicrow.TOPIC_ICON_IMG --><img src="{T_ICONS_PATH}{topicrow.TOPIC_ICON_IMG}" width="{topicrow.TOPIC_ICON_IMG_WIDTH}" height="{topicrow.TOPIC_ICON_IMG_HEIGHT}" alt="" title="" /><!-- ENDIF --></td>
+				<!-- ENDIF -->
+				<td class="row1">
+					<!-- IF topicrow.S_UNREAD_TOPIC --><a href="{topicrow.U_NEWEST_POST}">{NEWEST_POST_IMG}</a><!-- ENDIF -->
+					{topicrow.ATTACH_ICON_IMG} <!-- IF topicrow.S_HAS_POLL or topicrow.S_TOPIC_MOVED --><b>{topicrow.TOPIC_TYPE}</b> <!-- ENDIF --><a title="{L_POSTED}: {topicrow.FIRST_POST_TIME}" href="{topicrow.U_VIEW_TOPIC}" class="topictitle">{topicrow.TOPIC_TITLE}</a>
+					<!-- IF topicrow.S_TOPIC_UNAPPROVED or topicrow.S_POSTS_UNAPPROVED -->
+						<a href="{topicrow.U_MCP_QUEUE}">{topicrow.UNAPPROVED_IMG}</a>&nbsp;
+					<!-- ENDIF -->
+					<!-- IF topicrow.S_TOPIC_REPORTED -->
+						<a href="{topicrow.U_MCP_REPORT}">{REPORTED_IMG}</a>&nbsp;
+					<!-- ENDIF -->
+					<!-- IF topicrow.PAGINATION -->
+						<p class="gensmall"> [ {GOTO_PAGE_IMG}{L_GOTO_PAGE}: {topicrow.PAGINATION} ] </p>
+					<!-- ENDIF -->
+				</td>
+				<td class="row2" width="130" align="center"><p class="topicauthor">{topicrow.TOPIC_AUTHOR_FULL}</p></td>
+				<td class="row1" width="50" align="center"><p class="topicdetails">{topicrow.REPLIES}</p></td>
+				<td class="row2" width="50" align="center"><p class="topicdetails">{topicrow.VIEWS}</p></td>
+				<td class="row1" width="140" align="center">
+					<p class="topicdetails" style="white-space: nowrap;">{topicrow.LAST_POST_TIME}</p>
+					<p class="topicdetails">{topicrow.LAST_POST_AUTHOR_FULL}
+						<!-- IF not S_IS_BOT --><a href="{topicrow.U_LAST_POST}">{LAST_POST_IMG}</a><!-- ENDIF -->
+					</p>
+				</td>
+			</tr>
+
+		<!-- BEGINELSE -->
+			<!-- IF S_IS_POSTABLE -->
+			<tr>
+				<!-- IF S_TOPIC_ICONS -->
+					<td class="row1" colspan="7" height="30" align="center" valign="middle"><span class="gen"><!-- IF not S_SORT_DAYS -->{L_NO_TOPICS}<!-- ELSE -->{L_NO_TOPICS_TIME_FRAME}<!-- ENDIF --></span></td>
+				<!-- ELSE -->
+					<td class="row1" colspan="6" height="30" align="center" valign="middle"><span class="gen"><!-- IF not S_SORT_DAYS -->{L_NO_TOPICS}<!-- ELSE -->{L_NO_TOPICS_TIME_FRAME}<!-- ENDIF --></span></td>
+				<!-- ENDIF -->
+			</tr>
+			<!-- ENDIF -->
+		<!-- END topicrow -->
+
+		<!-- IF not S_IS_BOT -->
+		<tr align="center">
+			<!-- IF S_TOPIC_ICONS -->
+				<td class="cat" colspan="7">
+			<!-- ELSE -->
+				<td class="cat" colspan="6">
+			<!-- ENDIF -->
+					<form method="post" action="{S_FORUM_ACTION}"><span class="gensmall">{L_DISPLAY_TOPICS}:</span>&nbsp;{S_SELECT_SORT_DAYS}&nbsp;<span class="gensmall">{L_SORT_BY}</span> {S_SELECT_SORT_KEY} {S_SELECT_SORT_DIR}&nbsp;<input class="btnlite" type="submit" name="sort" value="{L_GO}" /></form>
+				</td>
+		</tr>
+		<!-- ENDIF -->
+		</table>
+	<!-- ENDIF -->
+
+	<!-- IF S_DISPLAY_POST_INFO or TOTAL_TOPICS -->
+		<table width="100%" cellspacing="1">
+		<tr>
+			<!-- IF S_DISPLAY_POST_INFO and not S_IS_BOT -->
+				<td align="{S_CONTENT_FLOW_BEGIN}" valign="middle"><a href="{U_POST_NEW_TOPIC}">{POST_IMG}</a></td>
+			<!-- ENDIF -->
+			<!-- IF TOTAL_TOPICS -->
+				<td class="nav" valign="middle" nowrap="nowrap">&nbsp;{PAGE_NUMBER}<br /></td>
+				<td class="gensmall" nowrap="nowrap">&nbsp;[ {TOTAL_TOPICS} ]&nbsp;</td>
+				<td class="gensmall" width="100%" align="{S_CONTENT_FLOW_END}" nowrap="nowrap"><!-- INCLUDE pagination.html --></td>
+		<!-- IF MODERATORS -->
+			<td><p class="moderators"><!-- IF S_SINGLE_MODERATOR -->{L_MODERATOR}<!-- ELSE -->{L_MODERATORS}<!-- ENDIF -->: {MODERATORS}</p></td>
+		<!-- ENDIF -->
+		<!-- IF U_MCP -->
+			<td><p class="linkmcp">[ <a href="{U_MCP}">{L_MCP}</a> ]</p></td>
+		<!-- ENDIF -->
+			<!-- ENDIF -->
+		</tr>
+		</table>
+	<!-- ENDIF -->
+
+		<br clear="all" />
+</div>
+
+<!-- INCLUDE breadcrumbs.html -->
+
+<!-- IF S_DISPLAY_ONLINE_LIST -->
+	<br clear="all" />
+
+	<table class="tablebg" width="100%" cellspacing="1">
+	<tr>
+		<td class="cat"><h4>{L_WHO_IS_ONLINE}</h4></td>
+	</tr>
+	<tr>
+		<td class="row1"><p class="gensmall">{LOGGED_IN_USER_LIST}</p></td>
+	</tr>
+	</table>
+<!-- ENDIF -->
+
+<!-- IF S_DISPLAY_POST_INFO -->
+	<br clear="all" />
+
+	<table width="100%" cellspacing="0">
+	<tr>
+		<td align="{S_CONTENT_FLOW_BEGIN}" valign="top">
+			<table cellspacing="3" cellpadding="0" border="0">
+			<tr>
+				<td width="20" style="text-align: center;">{FOLDER_UNREAD_IMG}</td>
+				<td class="gensmall">{L_UNREAD_POSTS}</td>
+				<td>&nbsp;&nbsp;</td>
+				<td width="20" style="text-align: center;">{FOLDER_IMG}</td>
+				<td class="gensmall">{L_NO_UNREAD_POSTS}</td>
+				<td>&nbsp;&nbsp;</td>
+				<td width="20" style="text-align: center;">{FOLDER_ANNOUNCE_IMG}</td>
+				<td class="gensmall">{L_ICON_ANNOUNCEMENT}</td>
+			</tr>
+			<tr>
+				<td style="text-align: center;">{FOLDER_HOT_UNREAD_IMG}</td>
+				<td class="gensmall">{L_UNREAD_POSTS_HOT}</td>
+				<td>&nbsp;&nbsp;</td>
+				<td style="text-align: center;">{FOLDER_HOT_IMG}</td>
+				<td class="gensmall">{L_NO_UNREAD_POSTS_HOT}</td>
+				<td>&nbsp;&nbsp;</td>
+				<td style="text-align: center;">{FOLDER_STICKY_IMG}</td>
+				<td class="gensmall">{L_ICON_STICKY}</td>
+			</tr>
+			<tr>
+				<td style="text-align: center;">{FOLDER_LOCKED_UNREAD_IMG}</td>
+				<td class="gensmall">{L_UNREAD_POSTS_LOCKED}</td>
+				<td>&nbsp;&nbsp;</td>
+				<td style="text-align: center;">{FOLDER_LOCKED_IMG}</td>
+				<td class="gensmall">{L_NO_UNREAD_POSTS_LOCKED}</td>
+				<td>&nbsp;&nbsp;</td>
+				<td style="text-align: center;">{FOLDER_MOVED_IMG}</td>
+				<td class="gensmall">{L_TOPIC_MOVED}</td>
+			</tr>
+			</table>
+		</td>
+		<td align="{S_CONTENT_FLOW_END}"><span class="gensmall"><!-- BEGIN rules -->{rules.RULE}<br /><!-- END rules --></span></td>
+	</tr>
+	</table>
+<!-- ENDIF -->
+
+<br clear="all" />
+
+<table width="100%" cellspacing="0">
+<tr>
+	<td><!-- IF S_DISPLAY_SEARCHBOX --><!-- INCLUDE searchbox.html --><!-- ENDIF --></td>
+	<td align="{S_CONTENT_FLOW_END}"><!-- INCLUDE jumpbox.html --></td>
+</tr>
+</table>
+
+<!-- INCLUDE overall_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/viewonline_body.html phpbb/styles/spring/template/viewonline_body.html
--- phpBB-3.0.10/styles/spring/template/viewonline_body.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/viewonline_body.html	2014-04-15 14:31:18.751429004 +0200
@@ -0,0 +1,57 @@
+<!-- INCLUDE overall_header.html -->
+
+<h4>{TOTAL_REGISTERED_USERS_ONLINE}</h4>
+<h4>{TOTAL_GUEST_USERS_ONLINE}<!-- IF S_SWITCH_GUEST_DISPLAY --> [ <a href="{U_SWITCH_GUEST_DISPLAY}">{L_SWITCH_GUEST_DISPLAY}</a> ]<!-- ENDIF --></h4>
+<br />
+
+<!-- IF PAGINATION -->
+	<table width="100%" cellspacing="1">
+	<tr>
+		<td class="nav" valign="middle" nowrap="nowrap">&nbsp;{PAGE_NUMBER}<br /></td>
+		<td class="gensmall" width="100%" align="{S_CONTENT_FLOW_END}" nowrap="nowrap"><b><a href="#" onclick="jumpto(); return false;" title="{L_JUMP_TO_PAGE}">{L_GOTO_PAGE}</a> <!-- IF PREVIOUS_PAGE --><a href="{PREVIOUS_PAGE}">{L_PREVIOUS}</a>&nbsp;&nbsp;<!-- ENDIF -->{PAGINATION}<!-- IF NEXT_PAGE -->&nbsp;&nbsp;<a href="{NEXT_PAGE}">{L_NEXT}</a><!-- ENDIF --></b></td>
+	</tr>
+	</table>
+<!-- ENDIF -->
+
+<table class="tablebg" width="100%" cellspacing="1">
+<tr>
+	<th width="40%"><a href="{U_SORT_USERNAME}">{L_USERNAME}</a></th>
+	<th width="20%"><a href="{U_SORT_UPDATED}">{L_LAST_UPDATED}</a></th>
+	<th width="40%"><a href="{U_SORT_LOCATION}">{L_FORUM_LOCATION}</a></th>
+</tr>
+<!-- BEGIN user_row -->
+	<tr>
+		<td class="row1"><p class="gen">{user_row.USERNAME_FULL}</p><!-- IF user_row.USER_IP --><p class="gensmall">{L_IP}: <a href="{user_row.U_USER_IP}">{user_row.USER_IP}</a> &#187; <a href="{user_row.U_WHOIS}" onclick="popup(this.href, 750, 500); return false;">{L_WHOIS}</a></p><!-- ENDIF -->
+			<!-- IF user_row.USER_BROWSER -->{user_row.USER_BROWSER}<!-- ENDIF --></td>
+		<td class="row2" align="center" nowrap="nowrap"><p class="genmed">&nbsp;{user_row.LASTUPDATE}</p></td>
+		<td class="row1"><p class="genmed"><a href="{user_row.U_FORUM_LOCATION}">{user_row.FORUM_LOCATION}</a></p></td>
+	</tr>
+<!-- END user_row -->
+
+<!-- IF LEGEND -->
+	<tr>
+		<td class="row1" colspan="3"><b class="gensmall">{L_LEGEND} :: {LEGEND}</b></td>
+	</tr>
+<!-- ENDIF -->
+</table>
+
+<!-- IF PAGINATION -->
+	<table width="100%" cellspacing="1">
+	<tr>
+		<td class="nav" valign="middle" nowrap="nowrap">&nbsp;{PAGE_NUMBER}<br /></td>
+		<td class="gensmall" width="100%" align="{S_CONTENT_FLOW_END}" nowrap="nowrap"><b><a href="#" onclick="jumpto(); return false;" title="{L_JUMP_TO_PAGE}">{L_GOTO_PAGE}</a> <!-- IF PREVIOUS_PAGE --><a href="{PREVIOUS_PAGE}">{L_PREVIOUS}</a>&nbsp;&nbsp;<!-- ENDIF -->{PAGINATION}<!-- IF NEXT_PAGE -->&nbsp;&nbsp;<a href="{NEXT_PAGE}">{L_NEXT}</a><!-- ENDIF --></b></td>
+	</tr>
+	</table>
+<!-- ENDIF -->
+
+<div class="gensmall" align="{S_CONTENT_FLOW_END}">{L_ONLINE_EXPLAIN}</div>
+
+<br clear="all" />
+
+<!-- INCLUDE breadcrumbs.html -->
+
+<br clear="all" />
+
+<div align="{S_CONTENT_FLOW_END}"><!-- INCLUDE jumpbox.html --></div>
+
+<!-- INCLUDE overall_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/viewonline_whois.html phpbb/styles/spring/template/viewonline_whois.html
--- phpBB-3.0.10/styles/spring/template/viewonline_whois.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/viewonline_whois.html	2014-04-15 14:31:18.752429004 +0200
@@ -0,0 +1,12 @@
+<!-- INCLUDE simple_header.html -->
+
+<table class="tablebg" width="100%" cellspacing="1">
+<tr> 
+	<th>{L_WHOIS}</th>
+</tr>
+<tr>
+	<td class="row1"><pre>{WHOIS}</pre><br /><a class="nav" href="#" onclick="window.close(); return false;">{L_CLOSE_WINDOW}</a></td>
+</tr>
+</table>
+
+<!-- INCLUDE simple_footer.html -->
\ No newline at end of file
diff -ruN phpBB-3.0.10/styles/spring/template/viewtopic_body.html phpbb/styles/spring/template/viewtopic_body.html
--- phpBB-3.0.10/styles/spring/template/viewtopic_body.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/viewtopic_body.html	2014-04-15 14:31:18.753429004 +0200
@@ -0,0 +1,356 @@
+<!-- INCLUDE overall_header.html -->
+
+<!-- IF S_FORUM_RULES -->
+	<div class="forumrules">
+		<!-- IF U_FORUM_RULES -->
+			<h3>{L_FORUM_RULES}</h3><br />
+			<a href="{U_FORUM_RULES}"><b>{L_FORUM_RULES_LINK}</b></a>
+		<!-- ELSE -->
+			<h3>{L_FORUM_RULES}</h3><br />
+			{FORUM_RULES}
+		<!-- ENDIF -->
+	</div>
+
+	<br clear="all" />
+<!-- ENDIF -->
+
+<!-- <br clear="all" /> -->
+
+<div id="pagecontent">
+
+	<table width="100%" cellspacing="1">
+	<tr>
+		<td align="{S_CONTENT_FLOW_BEGIN}" valign="middle" nowrap="nowrap">
+		<!-- IF not S_IS_BOT -->
+			<!-- IF S_DISPLAY_POST_INFO --><a href="{U_POST_NEW_TOPIC}">{POST_IMG}</a>&nbsp;<!-- ENDIF -->
+			<!-- IF S_DISPLAY_REPLY_INFO --><a href="{U_POST_REPLY_TOPIC}">{REPLY_IMG}</a><!-- ENDIF -->
+		<!-- ENDIF -->
+		</td>
+		<!-- IF TOTAL_POSTS -->
+			<td class="nav" valign="middle" nowrap="nowrap">&nbsp;{PAGE_NUMBER}<br /></td>
+			<td class="gensmall" nowrap="nowrap">&nbsp;[ {TOTAL_POSTS} ]&nbsp;</td>
+			<td class="gensmall" width="100%" align="{S_CONTENT_FLOW_END}" nowrap="nowrap"><!-- INCLUDE pagination.html --></td>
+		<!-- ENDIF -->
+	</tr>
+	</table>
+
+	<table class="tablebg" width="100%" cellspacing="1">
+	<tr>
+		<td class="cat">
+			<table width="100%" cellspacing="0">
+			<tr>
+				<td class="nav" nowrap="nowrap">&nbsp;
+				<!-- IF not S_IS_BOT -->
+					<!-- IF U_WATCH_TOPIC --><a href="{U_WATCH_TOPIC}" title="{L_WATCH_TOPIC}">{L_WATCH_TOPIC}</a><!-- IF U_PRINT_TOPIC or U_EMAIL_TOPIC or U_BUMP_TOPIC or U_BOOKMARK_TOPIC --> | <!-- ENDIF --><!-- ENDIF -->
+					<!-- IF U_BOOKMARK_TOPIC --><a href="{U_BOOKMARK_TOPIC}" title="{L_BOOKMARK_TOPIC}">{L_BOOKMARK_TOPIC}</a><!-- IF U_PRINT_TOPIC or U_EMAIL_TOPIC or U_BUMP_TOPIC --> | <!-- ENDIF --><!-- ENDIF -->
+					<!-- IF U_PRINT_TOPIC --><a href="{U_PRINT_TOPIC}" title="{L_PRINT_TOPIC}">{L_PRINT_TOPIC}</a><!-- IF U_EMAIL_TOPIC or U_BUMP_TOPIC --> | <!-- ENDIF --><!-- ENDIF -->
+					<!-- IF U_EMAIL_TOPIC --><a href="{U_EMAIL_TOPIC}" title="{L_EMAIL_TOPIC}">{L_EMAIL_TOPIC}</a><!-- IF U_BUMP_TOPIC --> | <!-- ENDIF --><!-- ENDIF -->
+					<!-- IF U_BUMP_TOPIC --><a href="{U_BUMP_TOPIC}" title="{L_BUMP_TOPIC}">{L_BUMP_TOPIC}</a><!-- ENDIF -->
+				<!-- ENDIF -->
+				</td>
+				<td class="nav" align="{S_CONTENT_FLOW_END}" nowrap="nowrap"><a href="{U_VIEW_OLDER_TOPIC}">{L_VIEW_PREVIOUS_TOPIC}</a><!-- IF U_VIEW_UNREAD_POST and not S_IS_BOT --> | <a href="{U_VIEW_UNREAD_POST}">{L_VIEW_UNREAD_POST}</a><!-- ENDIF --> | <a href="{U_VIEW_NEWER_TOPIC}">{L_VIEW_NEXT_TOPIC}</a>&nbsp;</td>
+			</tr>
+			</table>
+		</td>
+	</tr>
+<!-- IF S_HAS_POLL -->
+	<tr>
+		<td class="row2" colspan="2" align="center"><br clear="all" />
+
+			<form method="post" action="{S_POLL_ACTION}">
+
+			<table cellspacing="0" cellpadding="4" border="0" align="center">
+			<tr>
+				<td align="center"><span class="gen"><b>{POLL_QUESTION}</b></span><br /><span class="gensmall">{L_POLL_LENGTH}</span></td>
+			</tr>
+			<tr>
+				<td align="{S_CONTENT_FLOW_BEGIN}">
+					<table cellspacing="0" cellpadding="2" border="0">
+				<!-- BEGIN poll_option -->
+					<tr>
+					<!-- IF S_CAN_VOTE -->
+						<td>
+							<!-- IF S_IS_MULTI_CHOICE -->
+								<input type="checkbox" class="radio" name="vote_id[]" value="{poll_option.POLL_OPTION_ID}"<!-- IF poll_option.POLL_OPTION_VOTED --> checked="checked"<!-- ENDIF --> />
+							<!-- ELSE -->
+								<input type="radio" class="radio" name="vote_id[]" value="{poll_option.POLL_OPTION_ID}"<!-- IF poll_option.POLL_OPTION_VOTED --> checked="checked"<!-- ENDIF --> />
+							<!-- ENDIF -->
+						</td>
+					<!-- ENDIF -->
+						<td><span class="gen">{poll_option.POLL_OPTION_CAPTION}</span></td>
+						<!-- IF S_DISPLAY_RESULTS -->
+							<td dir="ltr">{POLL_LEFT_CAP_IMG}{poll_option.POLL_OPTION_IMG}{POLL_RIGHT_CAP_IMG}</td>
+							<td class="gen" align="{S_CONTENT_FLOW_END}"><b>&nbsp;{poll_option.POLL_OPTION_PERCENT}&nbsp;</b></td>
+							<td class="gen" align="center">[ {poll_option.POLL_OPTION_RESULT} ]</td>
+							<!-- IF poll_option.POLL_OPTION_VOTED -->
+								<td class="gensmall" valign="top"><b title="{L_POLL_VOTED_OPTION}">x</b></td>
+							<!-- ENDIF -->
+						<!-- ENDIF -->
+					</tr>
+				<!-- END poll_option -->
+					</table>
+				</td>
+			</tr>
+		<!-- IF S_CAN_VOTE -->
+			<tr>
+				<td align="center"><span class="gensmall">{L_MAX_VOTES}</span><br /><br /><input type="submit" name="update" value="{L_SUBMIT_VOTE}" class="btnlite" /></td>
+			</tr>
+		<!-- ENDIF -->
+		<!-- IF S_DISPLAY_RESULTS -->
+			<tr>
+				<td class="gensmall" colspan="4" align="center"><b>{L_TOTAL_VOTES} : {TOTAL_VOTES}</b></td>
+			</tr>
+		<!-- ELSE -->
+			<tr>
+				<td align="center"><span class="gensmall"><b><a href="{U_VIEW_RESULTS}">{L_VIEW_RESULTS}</a></b></span></td>
+			</tr>
+		<!-- ENDIF -->
+			</table>
+			{S_HIDDEN_FIELDS}
+			{S_FORM_TOKEN}
+			</form>
+
+		</td>
+	</tr>
+<!-- ENDIF -->
+	</table>
+
+<!-- BEGIN postrow -->
+	<table class="tablebg" width="100%" cellspacing="1">
+	<!-- IF postrow.S_FIRST_ROW -->
+		<tr>
+			<th>{L_AUTHOR}</th>
+			<th>{L_MESSAGE}</th>
+		</tr>
+	<!-- ENDIF -->
+	<!-- IF postrow.S_ROW_COUNT is even --><tr class="row1"><!-- ELSE --><tr class="row2"><!-- ENDIF -->
+
+	<!-- IF postrow.S_IGNORE_POST -->
+			<td class="gensmall" colspan="2" height="25" align="center"><!-- IF postrow.S_FIRST_UNREAD --><a name="unread"></a><!-- ENDIF --><a name="p{postrow.POST_ID}"></a>{postrow.L_IGNORE_POST}</td>
+	<!-- ELSE -->
+
+			<td align="center" valign="middle">
+				<!-- IF postrow.S_FIRST_UNREAD --><a name="unread"></a><!-- ENDIF --><a name="p{postrow.POST_ID}"></a>
+				<b class="postauthor"<!-- IF postrow.POST_AUTHOR_COLOUR --> style="color: {postrow.POST_AUTHOR_COLOUR}"<!-- ENDIF -->>{postrow.POST_AUTHOR}</b>
+			</td>
+			<td width="100%" height="25">
+				<table width="100%" cellspacing="0">
+				<tr>
+				<!-- IF postrow.POST_ICON_IMG -->
+					<td><img src="{T_ICONS_PATH}{postrow.POST_ICON_IMG}" width="{postrow.POST_ICON_IMG_WIDTH}" height="{postrow.POST_ICON_IMG_HEIGHT}" alt="" title="" /></td>
+				<!-- ENDIF -->
+					<td class="gensmall" width="100%"><div style="float: {S_CONTENT_FLOW_BEGIN};">&nbsp;<b>{L_POST_SUBJECT}:</b> <a href="#p{postrow.POST_ID}">{postrow.POST_SUBJECT}</a></div><div style="float: {S_CONTENT_FLOW_END};"><!-- IF S_IS_BOT -->{postrow.MINI_POST_IMG}<!-- ELSE --><a href="{postrow.U_MINI_POST}">{postrow.MINI_POST_IMG}</a><!-- ENDIF --><b>{L_POSTED}:</b> {postrow.POST_DATE}&nbsp;</div></td>
+				</tr>
+				</table>
+			</td>
+		</tr>
+
+		<!-- IF postrow.S_ROW_COUNT is even --><tr class="row1"><!-- ELSE --><tr class="row2"><!-- ENDIF -->
+
+			<td valign="top" class="profile">
+				<table cellspacing="4" align="center" width="150">
+
+			<!-- IF postrow.RANK_TITLE -->
+				<tr>
+					<td class="postdetails">{postrow.RANK_TITLE}</td>
+				</tr>
+			<!-- ENDIF -->
+			<!-- IF postrow.RANK_IMG -->
+				<tr>
+					<td>{postrow.RANK_IMG}</td>
+				</tr>
+			<!-- ENDIF -->
+			<!-- IF postrow.POSTER_AVATAR -->
+				<tr>
+					<td>{postrow.POSTER_AVATAR}</td>
+				</tr>
+			<!-- ENDIF -->
+			<!-- IF not (postrow.RANK_TITLE or postrow.RANK_IMG or postrow.POSTER_AVATAR) -->
+				<tr>
+					<td></td>
+				</tr>
+			<!-- ENDIF -->
+				</table>
+
+				<span class="postdetails">
+					<!-- IF postrow.POSTER_JOINED --><br /><b>{L_JOINED}:</b> {postrow.POSTER_JOINED}<!-- ENDIF -->
+
+					<!-- IF postrow.POSTER_FROM --><br /><b>{L_LOCATION}:</b> {postrow.POSTER_FROM}<!-- ENDIF -->
+
+					<!-- IF postrow.S_PROFILE_FIELD1 -->
+						<!-- Use a construct like this to include admin defined profile fields. Replace FIELD1 with the name of your field. -->
+						<br /><b>{postrow.PROFILE_FIELD1_NAME}:</b> {postrow.PROFILE_FIELD1_VALUE}
+					<!-- ENDIF -->
+
+					<!-- BEGIN custom_fields -->
+						<br /><b>{postrow.custom_fields.PROFILE_FIELD_NAME}:</b> {postrow.custom_fields.PROFILE_FIELD_VALUE}
+					<!-- END custom_fields -->
+				</span>
+
+			</td>
+			<td valign="top">
+				<table width="100%" cellspacing="5">
+				<tr>
+					<td>
+					<!-- IF postrow.S_POST_UNAPPROVED or postrow.S_POST_REPORTED -->
+						<table width="100%" cellspacing="0">
+						<tr>
+							<td class="gensmall"><!-- IF postrow.S_POST_UNAPPROVED --><span class="postapprove">{UNAPPROVED_IMG} <a href="{postrow.U_MCP_APPROVE}">{L_POST_UNAPPROVED}</a></span><br /> <!-- ENDIF --> <!-- IF postrow.S_POST_REPORTED --><span class="postreported">{REPORTED_IMG} <a href="{postrow.U_MCP_REPORT}">{L_POST_REPORTED}</a></span><!-- ENDIF --></td>
+						</tr>
+						</table>
+
+						<br clear="all" />
+					<!-- ENDIF -->
+
+						<div class="postbody">{postrow.MESSAGE}</div>
+
+					<!-- IF postrow.S_HAS_ATTACHMENTS -->
+						<br clear="all" /><br />
+
+						<table class="tablebg" width="100%" cellspacing="1">
+						<tr>
+							<td class="row3"><b class="genmed">{L_ATTACHMENTS}: </b></td>
+						</tr>
+						<!-- BEGIN attachment -->
+							<tr>
+								<!-- IF postrow.attachment.S_ROW_COUNT is even --><td class="row2"><!-- ELSE --><td class="row1"><!-- ENDIF -->{postrow.attachment.DISPLAY_ATTACHMENT}</td>
+							</tr>
+						<!-- END attachment -->
+						</table>
+					<!-- ENDIF -->
+
+					<!-- IF postrow.S_DISPLAY_NOTICE -->
+						<span class="gensmall error"><br /><br />{L_DOWNLOAD_NOTICE}</span>
+					<!-- ENDIF -->
+					<!-- IF postrow.SIGNATURE -->
+						<div class="postbody"><br />_________________<br />{postrow.SIGNATURE}</div>
+					<!-- ENDIF -->
+
+					<!-- IF postrow.EDITED_MESSAGE or postrow.EDIT_REASON -->
+						<!-- IF postrow.EDIT_REASON -->
+							<br /><br />
+							<table class="tablebg" width="100%" cellspacing="1">
+							<tr>
+								<td class="row3"><span class="gensmall">{postrow.EDITED_MESSAGE}</span></td>
+							</tr>
+							<tr>
+								<td class="row2"><span class="genmed">{postrow.EDIT_REASON}</span></td>
+							</tr>
+							</table>
+						<!-- ELSE -->
+							<br /><br />
+							<span class="gensmall">{postrow.EDITED_MESSAGE}</span>
+						<!-- ENDIF -->
+					<!-- ENDIF -->
+
+					<!-- IF postrow.BUMPED_MESSAGE -->
+						<span class="gensmall"><br /><br />{postrow.BUMPED_MESSAGE}</span>
+					<!-- ENDIF -->
+
+					<!-- IF not postrow.S_HAS_ATTACHMENTS --><br clear="all" /><br /><!-- ENDIF -->
+					</td>
+				</tr>
+				</table>
+			</td>
+		</tr>
+
+		<!-- IF postrow.S_ROW_COUNT is even --><tr class="row1"><!-- ELSE --><tr class="row2"><!-- ENDIF -->
+
+			<td class="profile">
+						<table width="100%" cellspacing="0" style="margin: 0px;" cellpadding="0" border="0">
+						<tr valign="middle" style="margin: 0;">
+<td align="left"><strong><a href="#wrapheader">{L_BACK_TO_TOP}</a></strong></td>
+							<td align="right" style="margin: 0;">
+							<!-- IF not S_IS_BOT -->
+								<!-- IF postrow.U_REPORT --><a href="{postrow.U_REPORT}">{REPORT_IMG}</a> <!-- ENDIF --> 
+								<!-- IF postrow.U_INFO --><a href="{postrow.U_INFO}">{INFO_IMG}</a> <!-- ENDIF --> 
+								<!-- IF postrow.U_WARN --><a href="{postrow.U_WARN}">{WARN_IMG}</a> <!-- ENDIF --> 
+								<!-- IF postrow.U_DELETE --><a href="{postrow.U_DELETE}">{DELETE_IMG}</a> <!-- ENDIF -->
+							<!-- ENDIF -->
+							</td>
+						</tr>
+						</table></td>
+
+			<td><div class="gensmall" style="float: {S_CONTENT_FLOW_BEGIN};">&nbsp;<!-- IF postrow.ONLINE_IMG -->{postrow.ONLINE_IMG}<!-- ENDIF -->&nbsp;<!-- IF postrow.U_POST_AUTHOR --><a href="{postrow.U_POST_AUTHOR}">{PROFILE_IMG}</a> <!-- ENDIF --> <!-- IF postrow.U_PM --><a href="{postrow.U_PM}">{PM_IMG}</a> <!-- ENDIF --> <!-- IF postrow.U_EMAIL --><a href="{postrow.U_EMAIL}">{EMAIL_IMG}</a> <!-- ENDIF -->&nbsp;</div> <div class="gensmall" style="float: {S_CONTENT_FLOW_END};"><!-- IF not S_IS_BOT --><!-- IF postrow.U_EDIT --><a href="{postrow.U_EDIT}">{EDIT_IMG}</a> <!-- ENDIF --> <!-- IF postrow.U_QUOTE --><a href="{postrow.U_QUOTE}">{QUOTE_IMG}</a> <!-- ENDIF --> <!-- ENDIF -->&nbsp;</div></td>
+	<!-- ENDIF -->
+		</tr>
+
+	<tr>
+		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
+	</tr>
+	</table>
+<!-- END postrow -->
+
+	<!-- IF not S_IS_BOT -->
+	<table width="100%" cellspacing="1" class="tablebg">
+	<tr align="center">
+		<td class="cat"><form name="viewtopic" method="post" action="{S_TOPIC_ACTION}"><span class="gensmall">{L_DISPLAY_POSTS}:</span> {S_SELECT_SORT_DAYS}&nbsp;<span class="gensmall">{L_SORT_BY}</span> {S_SELECT_SORT_KEY} {S_SELECT_SORT_DIR}&nbsp;<input class="btnlite" type="submit" value="{L_GO}" name="sort" /></form></td>
+	</tr>
+	</table>
+	<!-- ENDIF -->
+
+	<table width="100%" cellspacing="1">
+	<tr>
+		<td align="{S_CONTENT_FLOW_BEGIN}" valign="middle" nowrap="nowrap">
+		<!-- IF not S_IS_BOT -->
+			<!-- IF S_DISPLAY_POST_INFO --><a href="{U_POST_NEW_TOPIC}">{POST_IMG}</a>&nbsp;<!-- ENDIF -->
+			<!-- IF S_DISPLAY_REPLY_INFO --><a href="{U_POST_REPLY_TOPIC}">{REPLY_IMG}</a><!-- ENDIF -->
+		<!-- ENDIF -->
+		</td>
+		<!-- IF TOTAL_POSTS -->
+			<td class="nav" valign="middle" nowrap="nowrap">&nbsp;{PAGE_NUMBER}<br /></td>
+			<td class="gensmall" nowrap="nowrap">&nbsp;[ {TOTAL_POSTS} ]&nbsp;</td>
+			<td class="gensmall" width="100%" align="{S_CONTENT_FLOW_END}" nowrap="nowrap"><!-- INCLUDE pagination.html --></td>
+		<!-- ENDIF -->
+
+<!-- IF U_MCP -->
+	<td><p class="linkmcp">[ <a href="{U_MCP}">{L_MCP}</a> ]</p></td>
+<!-- ENDIF -->
+
+
+	</tr>
+	</table>
+
+</div>
+
+<div id="pagefooter"></div>
+
+<br clear="all" />
+<!-- IF S_QUICK_REPLY -->
+<!-- INCLUDE quickreply_editor.html -->
+<!-- ENDIF -->
+
+<!-- INCLUDE breadcrumbs.html -->
+
+<!-- IF S_DISPLAY_ONLINE_LIST -->
+	<br clear="all" />
+
+	<table class="tablebg" width="100%" cellspacing="1">
+	<tr>
+		<td class="cat"><h4>{L_WHO_IS_ONLINE}</h4></td>
+	</tr>
+	<tr>
+		<td class="row1"><p class="gensmall">{LOGGED_IN_USER_LIST}</p></td>
+	</tr>
+	</table>
+<!-- ENDIF -->
+
+<br clear="all" />
+
+<table width="100%" cellspacing="1">
+<tr>
+	<td width="40%" valign="top" nowrap="nowrap" align="{S_CONTENT_FLOW_BEGIN}"><!-- IF S_TOPIC_MOD --><form method="post" action="{S_MOD_ACTION}"><span class="gensmall">{L_QUICK_MOD}:</span> {S_TOPIC_MOD} <input class="btnlite" type="submit" value="{L_GO}" /></form><!-- ENDIF --></td>
+	<td align="{S_CONTENT_FLOW_END}" valign="top" nowrap="nowrap"><span class="gensmall"><!-- BEGIN rules -->{rules.RULE}<br /><!-- END rules --></span></td>
+</tr>
+</table>
+
+<br clear="all" />
+
+<table width="100%" cellspacing="0">
+<tr>
+	<td><!-- IF S_DISPLAY_SEARCHBOX --><!-- INCLUDE searchbox.html --><!-- ENDIF --></td>
+	<td align="{S_CONTENT_FLOW_END}"><!-- INCLUDE jumpbox.html --></td>
+</tr>
+</table>
+
+<!-- INCLUDE overall_footer.html -->
diff -ruN phpBB-3.0.10/styles/spring/template/viewtopic_print.html phpbb/styles/spring/template/viewtopic_print.html
--- phpBB-3.0.10/styles/spring/template/viewtopic_print.html	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/template/viewtopic_print.html	2014-04-15 14:31:18.754429004 +0200
@@ -0,0 +1,136 @@
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+<html dir="{S_CONTENT_DIRECTION}" lang="{S_USER_LANG}">
+<head>
+<meta http-equiv="Content-Type" content="text/html; charset={S_CONTENT_ENCODING}">
+<meta http-equiv="Content-Style-Type" content="text/css">
+<meta http-equiv="Content-Language" content="{S_USER_LANG}">
+<title>{SITENAME} :: {PAGE_TITLE}</title>
+
+<style type="text/css">
+<!--
+
+body {
+	font-family: Verdana,serif;
+	font-size: 10pt;
+}
+
+img {
+	border: 0;
+}
+
+td {
+	font-family: Verdana,serif;
+	font-size: 10pt;
+	line-height: 150%;
+}
+
+.code, .codecontent, 
+.quote, .quotecontent {
+	margin: 0 5px 0 5px;
+	padding: 5px;
+	font-size: smaller;
+	border: black solid 1px;
+}
+
+.quotetitle {
+	color: black;
+	display : block;
+	font-weight: bold;
+}
+
+.forum {
+	font-family: Arial,Helvetica,sans-serif;
+	font-weight: bold;
+	font-size: 18pt;
+}
+
+.topic {
+	font-family: Arial,Helvetica,sans-serif;
+	font-size: 14pt;
+	font-weight: bold;
+}
+
+.gensmall {
+	font-size: 8pt;
+}
+
+hr {
+	color: #888;
+	height: 3px;
+	border-style: solid;
+}
+
+hr.sep {
+	color: #aaa;
+	height: 1px;
+	border-style: dashed;
+}
+//-->
+</style>
+
+</head>
+<body>
+
+<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
+<tr>
+	<td colspan="2" align="center"><span class="Forum">{SITENAME}</span><br /><span class="gensmall"><a href="{U_FORUM}">{U_FORUM}</a></span></td>
+</tr>
+<tr>
+	<td colspan="2"><br /></td>
+</tr>
+<tr>
+	<td><span class="topic">{TOPIC_TITLE}</span><br /><span class="gensmall"><a href="{U_TOPIC}">{U_TOPIC}</a></span></td>
+	<td align="{S_CONTENT_FLOW_END}" valign="bottom"><span class="gensmall">{PAGE_NUMBER}</span></td>
+</tr>
+</table>
+
+<!-- BEGIN postrow -->
+
+	<hr width="85%" />
+
+	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
+	<tr>
+		<td width="10%" nowrap="nowrap">{L_AUTHOR}:&nbsp;</td>
+		<td><b>{postrow.POST_AUTHOR}</b> [ {postrow.POST_DATE} ]</td>
+	</tr>
+	<tr>
+		<td width="10%" nowrap="nowrap">{L_POST_SUBJECT}:&nbsp;</td>
+		<td><b>{postrow.POST_SUBJECT}</b></td>
+	</tr>
+	<tr>
+		<td colspan="2"><hr class="sep" />{postrow.MESSAGE}
+
+		<!-- IF postrow.S_HAS_ATTACHMENTS -->
+			<br clear="all" /><br />
+
+			<table class="tablebg" width="100%" cellspacing="1">
+			<tr>
+				<td><b class="genmed">{L_ATTACHMENTS}: </b></td>
+			</tr>
+			<!-- BEGIN attachment -->
+				<tr>
+					<td>{postrow.attachment.DISPLAY_ATTACHMENT}</td>
+				</tr>
+			<!-- END attachment -->
+			</table>
+		<!-- ENDIF -->
+
+		</td>
+	</tr>
+	</table>
+<!-- END postrow -->
+
+<hr width="85%" />
+
+<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
+<tr>
+	<td><span class="gensmall">{PAGE_NUMBER}</span></td>
+	<td align="{S_CONTENT_FLOW_END}"><span class="gensmall">{S_TIMEZONE}</span></td>
+</tr>
+<tr>
+	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
+</tr>
+</table>
+
+</body>
+</html>
\ No newline at end of file
Binary files phpBB-3.0.10/styles/spring/theme/images/background.gif and phpbb/styles/spring/theme/images/background.gif differ
Binary files phpBB-3.0.10/styles/spring/theme/images/cellpic1.gif and phpbb/styles/spring/theme/images/cellpic1.gif differ
Binary files phpBB-3.0.10/styles/spring/theme/images/cellpic2.jpg and phpbb/styles/spring/theme/images/cellpic2.jpg differ
Binary files phpBB-3.0.10/styles/spring/theme/images/cellpic2_rtl.jpg and phpbb/styles/spring/theme/images/cellpic2_rtl.jpg differ
Binary files phpBB-3.0.10/styles/spring/theme/images/cellpic3.gif and phpbb/styles/spring/theme/images/cellpic3.gif differ
Binary files phpBB-3.0.10/styles/spring/theme/images/cellpic.gif and phpbb/styles/spring/theme/images/cellpic.gif differ
Binary files phpBB-3.0.10/styles/spring/theme/images/created_by.jpg and phpbb/styles/spring/theme/images/created_by.jpg differ
Binary files phpBB-3.0.10/styles/spring/theme/images/icon_mini_faq.gif and phpbb/styles/spring/theme/images/icon_mini_faq.gif differ
Binary files phpBB-3.0.10/styles/spring/theme/images/icon_mini_groups.gif and phpbb/styles/spring/theme/images/icon_mini_groups.gif differ
Binary files phpBB-3.0.10/styles/spring/theme/images/icon_mini_login.gif and phpbb/styles/spring/theme/images/icon_mini_login.gif differ
Binary files phpBB-3.0.10/styles/spring/theme/images/icon_mini_members.gif and phpbb/styles/spring/theme/images/icon_mini_members.gif differ
Binary files phpBB-3.0.10/styles/spring/theme/images/icon_mini_message.gif and phpbb/styles/spring/theme/images/icon_mini_message.gif differ
Binary files phpBB-3.0.10/styles/spring/theme/images/icon_mini_profile.gif and phpbb/styles/spring/theme/images/icon_mini_profile.gif differ
Binary files phpBB-3.0.10/styles/spring/theme/images/icon_mini_register.gif and phpbb/styles/spring/theme/images/icon_mini_register.gif differ
Binary files phpBB-3.0.10/styles/spring/theme/images/icon_mini_search.gif and phpbb/styles/spring/theme/images/icon_mini_search.gif differ
diff -ruN phpBB-3.0.10/styles/spring/theme/images/index.htm phpbb/styles/spring/theme/images/index.htm
--- phpBB-3.0.10/styles/spring/theme/images/index.htm	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/theme/images/index.htm	2014-04-15 15:06:06.709411377 +0200
@@ -0,0 +1,16 @@
+<html>
+<head>
+<title>subSilver created by subBlue Design</title>
+<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
+</head>
+
+<body bgcolor="#FFFFFF" text="#000000">
+
+<table width="100%" height="100%" cellspacing="0" cellpadding="0" border="0">
+	<tr>
+		<td align="center" valign="middle"><a href="http://www.subblue.com/" target="_new"><img src="created_by.jpg" width="400" height="300" alt="Created by subBlue Design" /></a></td>
+	</tr>
+</table>
+
+</body>
+</html>
\ No newline at end of file
Binary files phpBB-3.0.10/styles/spring/theme/images/no_avatar.gif and phpbb/styles/spring/theme/images/no_avatar.gif differ
Binary files phpBB-3.0.10/styles/spring/theme/images/spacer.gif and phpbb/styles/spring/theme/images/spacer.gif differ
Binary files phpBB-3.0.10/styles/spring/theme/images/whosonline.gif and phpbb/styles/spring/theme/images/whosonline.gif differ
diff -ruN phpBB-3.0.10/styles/spring/theme/stylesheet.css phpbb/styles/spring/theme/stylesheet.css
--- phpBB-3.0.10/styles/spring/theme/stylesheet.css	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/theme/stylesheet.css	2014-04-15 14:31:18.757429004 +0200
@@ -0,0 +1,691 @@
+/*  phpBB3 Style Sheet
+    --------------------------------------------------------------
+	Style name:			subsilver2
+	Based on style:		subSilver (the default phpBB 2.0.x style)
+	Original author:	Tom Beddard ( http://www.subblue.com/ )
+	Modified by:		phpBB Group ( http://www.phpbb.com/ )
+    --------------------------------------------------------------
+*/
+
+/* Layout
+ ------------ */
+* {
+	/* Reset browsers default margin, padding and font sizes */
+	margin: 0;
+	padding: 0;
+}
+
+html {
+	font-size: 100%;
+}
+
+body {
+	color: #323D4F;
+	background-color: #FFFFFF;
+	font-size: 12px; /* This sets the default font size to be equivalent to 10px */
+	margin: 0;
+}
+
+#wrapheader {
+	height: auto !important;
+	padding: 0;
+}
+
+#wrapcentre {
+	margin: 0px 5px 0 5px;
+}
+
+#wrapfooter {
+	text-align: center;
+	clear: both;
+}
+
+#wrapnav {
+	width: 100%;
+	margin: 0;
+	background-color: #ECECEC;
+	border-width: 1px;
+	border-style: solid;
+	border-color: #A9B8C2;
+}
+
+#logodesc {
+	background-color: #C1CAD2;
+	background-image: url('./images/background.gif');
+	background-repeat: repeat-x;
+	background-position: center bottom;
+	padding: 0 25px 15px 25px;
+}
+
+#menubar {
+	margin: 0 3px;
+}
+
+#datebar {
+	margin: 10px 25px 0 25px;
+}
+
+#findbar {
+	width: 100%;
+	margin: 0;
+	padding: 0;
+	border: 0;
+}
+
+.forumrules {
+	background-color: #F9CC79;
+	border-width: 1px;
+	border-style: solid;
+	border-color: #BB9860;
+	padding: 4px;
+	font-weight: normal;
+	font-size: 1.1em;
+}
+
+.forumrules h3 {
+	color: red;
+}
+
+#pageheader { }
+#pagecontent { }
+#pagefooter { }
+
+#poll { }
+#postrow { }
+#postdata { }
+
+
+/*  Text
+ --------------------- */
+h1 {
+	color: black;
+	font-family: serif;
+	font-weight: bold;
+	font-size: 1.8em;
+	text-decoration: none;
+}
+
+h2 {
+	font-family: serif;
+	font-weight: bold;
+	font-size: 1.5em;
+	text-decoration: none;
+	line-height: 120%;
+}
+
+h3 {
+	font-family: serif;
+	font-size: 1.3em;
+	font-weight: bold;
+	line-height: 120%;
+}
+
+h4 {
+	color: #EEE;
+	margin: 0;
+	font-size: 1.1em;
+	font-weight: bold;
+}
+
+p {
+	font-size: 1.1em;
+}
+
+p.moderators {
+	margin: 0;
+	float: left;
+	color: black;
+	font-weight: bold;
+}
+
+.rtl p.moderators {
+	float: right;
+}
+
+p.linkmcp {
+	margin: 0;
+	float: right;
+	white-space: nowrap;
+}
+
+.rtl p.linkmcp {
+	float: left;
+}
+
+p.breadcrumbs {
+	margin: 0;
+	float: left;
+	color: black;
+	font-weight: bold;
+	white-space: normal;
+	font-size: 1.2em;
+}
+
+.rtl p.breadcrumbs {
+	float: right;
+}
+
+p.datetime {
+	margin: 0;
+	float: right;
+	white-space: nowrap;
+	font-size: 1em;
+}
+
+.rtl p.datetime {
+	float: left;
+}
+
+p.searchbar {
+	padding: 2px 0;
+	white-space: nowrap;
+} 
+
+p.searchbarreg {
+	margin: 0;
+	float: right;
+	white-space: nowrap;
+}
+
+.rtl p.searchbarreg {
+	float: left;
+}
+
+p.forumdesc {
+	padding-bottom: 4px;
+}
+
+p.topicauthor {
+	margin: 1px 0;
+}
+
+p.topicdetails {
+	margin: 1px 0;
+}
+
+.postreported, .postreported a:link, .postreported a:visited, .postreported a:hover, .postreported a:active {
+	margin: 1px 0;
+	color: red;
+	font-weight:bold;
+}
+
+.postapprove, .postapprove a:link, .postapprove a:visited, .postapprove a:hover, .postapprove a:active {
+	color: green;
+	font-weight:bold;
+}
+
+.postapprove img, .postreported img {
+	vertical-align: bottom;
+	padding-top: 5px;
+}
+
+.postauthor {
+	color: #000000;
+}
+
+.postdetails {
+	color: #000000;
+}
+
+.postbody {
+	font-size: 1.2em;
+	line-height: 1.4em;
+	color: #000000;
+}
+
+.postbody li, ol, ul {
+	margin: 0 0 0 1.5em;
+}
+
+/* added by Tobi (23/12/07): */
+.postbody img {
+	max-width: 560px;
+}
+
+.rtl .postbody li, .rtl ol, .rtl ul {
+	margin: 0 1.5em 0 0;
+}
+
+.posthilit {
+	background-color: yellow;
+}
+
+.nav {
+	margin: 0;
+	color: black;
+	font-weight: bold;
+}
+
+.pagination {
+	padding: 4px;
+	color: black;
+	font-size: 1em;
+	font-weight: bold;
+}
+
+.cattitle {
+
+}
+
+.gen {
+	margin: 1px 1px;
+	font-size: 1.2em;
+}
+
+.genmed {
+	margin: 1px 1px;
+	font-size: 1.1em;
+}
+
+.gensmall {
+	margin: 1px 1px;
+	font-size: 1em;
+}
+
+.copyright {
+	color: #444;
+	font-weight: normal;
+}
+
+.titles {
+	font-weight: bold;
+	font-size: 1.3em;
+	text-decoration: none;
+}
+
+.error {
+	color: red;
+}
+
+
+/* Tables
+ ------------ */
+th {
+	color: #FFA34F;
+	font-size: 13px;
+	font-weight: bold;
+	text-shadow: 2px 2px 2px rgba(0,0,0,0.35);
+	background-color: #006699;
+	background-image: url('./images/cellpic3.gif');
+	background: linear-gradient(top, #E33, #911 100%);
+	background: -o-linear-gradient(top, #E33, #911 100%);
+	background: -moz-linear-gradient(top, #E33, #911 100%);
+	background: -webkit-linear-gradient(top, #E33, #911 100%);
+	background: -ms-linear-gradient(top, #E33, #911 100%);
+ 	box-shadow: inset 0px 1px rgba(255, 255, 255, 0.298), inset 0px 10px 20px rgba(255, 255, 255, 0.251), inset 0px -16px 20px rgba(0, 0, 0, 0.298);
+	border: 1px solid rgba(0,0,0,0.2);
+	border-radius: 5px 5px 0 0;
+	white-space: nowrap;
+	padding: 4px 5px;
+}
+
+.tablebg:nth-of-type(2) tr:first-child td.cat {
+#	display: none;
+	background: transparent;
+	border: 0;
+	box-shadow: none;
+}
+td {
+	padding: 2px;
+}
+td.profile {
+	padding: 4px;
+}
+
+.tablebg {
+#	background-color: #A9B8C2;
+}
+
+.rtl {
+	background: white url('./images/cellpic2_rtl.jpg') repeat-y scroll top right;
+}
+
+.cat,.catdiv {
+	padding: 5px 0 5px 10px;
+	background-color: #C7D0D7;
+	background-image: url('./images/cellpic1.gif');
+	background: linear-gradient(top, #34414A, #506673 100%);
+	background: -o-linear-gradient(top, #34414A, #506673 100%);
+	background: -moz-linear-gradient(top, #34414A, #506673 100%);
+	background: -webkit-linear-gradient(top, #34414A, #506673 100%);
+	background: -ms-linear-gradient(top, #34414A, #506673 100%);
+ 	box-shadow: inset 0px 1px rgba(255, 255, 255, 0.298), inset 0px 10px 20px rgba(255, 255, 255, 0.251), inset 0px -16px 20px rgba(0, 0, 0, 0.298);
+	border-right:  1px solid #20292E;
+	border-left:   1px solid #20292E;
+	border-bottom: 1px solid #20292E;
+	color: #EEE;
+}
+
+.cat h4 a:link {
+	color: inherit;
+	font-size: 16px;
+	font-weight:bold;
+	text-shadow: 2px 2px 2px rgba(0,0,0,0.35);
+}
+
+.row1 {
+	background-color: #ECECEC;
+	border-top: 1px solid #FFF;
+	border-left: 1px solid #FFF;
+	padding: 4px;
+}
+
+.row2 {
+	background-color: #DCE1E5;
+	border-top: 1px solid #FFF;
+	border-left: 1px solid #FFF;
+	padding: 4px;
+}
+
+.row3 {
+	background-color: #C0C8D0;
+	border-top: 1px solid #FFF;
+	border-left: 1px solid #FFF;
+	padding: 4px;
+}
+
+.spacer {
+	background-color: #D1D7DC;
+}
+
+hr {
+	height: 1px;
+	border-width: 0;
+	background-color: #D1D7DC;
+	color: #D1D7DC;
+}
+
+.legend {
+	text-align:center;
+	margin: 0 auto;
+}
+
+/* Links
+ ------------ */
+
+/* Links adjustment to correctly display an order of rtl/ltr mixed content */
+.rtl a {
+	direction: rtl;
+	unicode-bidi: embed;
+}
+
+/* CSS spec requires a:link, a:visited, a:hover and a:active rules to be specified in this order. */
+/* See http://www.phpbb.com/bugs/phpbb3/59685 */
+a:link {
+	color: #006597;
+	text-decoration: none;
+}
+
+a:visited {
+	color: #005784;
+	text-decoration: none;
+}
+
+a:hover {
+	color: #D46400;
+	text-decoration: underline;
+}
+
+a:active {
+	color: #005784;
+	text-decoration: none;
+}
+
+a.forumlink {
+	color: #069;
+	font-weight: bold;
+	font-size: 1.2em;
+}
+
+a.topictitle {
+	margin: 1px 0;
+	font-weight: bold;
+	font-size: 1.2em;
+}
+
+a.topictitle:visited {
+	color: #5493B4;
+	text-decoration: none;
+}
+
+th a,
+th a:visited {
+	color: #FFA34F !important;
+	text-decoration: none;
+}
+
+th a:hover {
+	text-decoration: underline;
+}
+
+
+/* Form Elements
+ ------------ */
+form {
+	margin: 0;
+	padding: 0;
+	border: 0;
+}
+
+input {
+	color: #333333;
+	font-size: 1.1em;
+	font-weight: normal;
+	padding: 1px;
+	border: 1px solid #A9B8C2;
+	background-color: #FAFAFA;
+}
+
+textarea {
+	background-color: #FAFAFA;
+	color: #333333;
+	font-size: 1.3em; 
+	line-height: 1.4em;
+	font-weight: normal;
+	border: 1px solid #A9B8C2;
+	padding: 2px;
+}
+
+select {
+	color: #333333;
+	background-color: #FAFAFA;
+	font-size: 1.1em;
+	font-weight: normal;
+	border: 1px solid #A9B8C2;
+	padding: 1px;
+}
+
+option {
+	padding: 0 1em 0 0;
+}
+
+option.disabled-option {
+	color: graytext;
+}
+
+.rtl option {
+	padding: 0 0 0 1em;
+}
+
+input.radio {
+	border: none;
+	background-color: transparent;
+}
+
+.post {
+	background-color: white;
+	border-style: solid;
+	border-width: 1px;
+}
+
+.btnbbcode {
+	color: #000000;
+	font-weight: normal;
+	font-size: 1.1em;
+	background-color: #EFEFEF;
+	border: 1px solid #666666;
+}
+
+.btnmain {
+	font-weight: bold;
+	background-color: #ECECEC;
+	border: 1px solid #A9B8C2;
+	cursor: pointer;
+	padding: 1px 5px;
+	font-size: 1.1em;
+}
+
+.btnlite {
+	font-weight: normal;
+	background-color: #ECECEC;
+	border: 1px solid #A9B8C2;
+	cursor: pointer;
+	padding: 1px 5px;
+	font-size: 1.1em;
+}
+
+.btnfile {
+	font-weight: normal;
+	background-color: #ECECEC;
+	border: 1px solid #A9B8C2;
+	padding: 1px 5px;
+	font-size: 1.1em;
+}
+
+.helpline {
+	background-color: #DEE3E7;
+	border-style: none;
+}
+
+
+/* BBCode
+ ------------ */
+.quotetitle, .attachtitle {
+	margin: 10px 5px 0 5px;
+	padding: 4px;
+	border-width: 1px 1px 0 1px;
+	border-style: solid;
+	border-color: #A9B8C2;
+	color: #333333;
+	background-color: #A9B8C2;
+	font-size: 0.85em;
+	font-weight: bold;
+}
+
+.quotetitle .quotetitle {
+	font-size: 1em;
+}
+
+.quotecontent, .attachcontent {
+	margin: 0 5px 10px 5px;
+	padding: 5px;
+	border-color: #A9B8C2;
+	border-width: 0 1px 1px 1px;
+	border-style: solid;
+	font-weight: normal;
+	font-size: 1em;
+	line-height: 1.4em;
+	background-color: #FAFAFA;
+	color: #4B5C77;
+}
+
+.attachcontent {
+	font-size: 0.85em;
+}
+
+.codetitle {
+	margin: 10px 5px 0 5px;
+	padding: 2px 4px;
+	border-width: 1px 1px 0 1px;
+	border-style: solid;
+	border-color: #A9B8C2;
+	color: #333333;
+	background-color: #A9B8C2;
+	font-size: 0.8em;
+}
+
+.codecontent {
+	font-family: Monaco, 'Courier New', monospace;
+	direction: ltr;
+	margin: 0 5px 10px 5px;
+	padding: 5px;
+	border-color: #A9B8C2;
+	border-width: 0 1px 1px 1px;
+	border-style: solid;
+	font-weight: normal;
+	color: #006600;
+	font-size: 0.85em;
+	background-color: #FAFAFA;
+}
+
+.syntaxbg {
+	color: #FFFFFF;
+}
+
+.syntaxcomment {
+	color: #FF8000;
+}
+
+.syntaxdefault {
+	color: #0000BB;
+}
+
+.syntaxhtml {
+	color: #000000;
+}
+
+.syntaxkeyword {
+	color: #007700;
+}
+
+.syntaxstring {
+	color: #DD0000;
+}
+
+
+/* Private messages
+ ------------------ */
+.pm_marked_colour {
+	background-color: #000000;
+}
+
+.pm_replied_colour {
+	background-color: #A9B8C2;
+}
+
+.pm_friend_colour {
+	background-color: #007700;
+}
+
+.pm_foe_colour {
+	background-color: #DD0000;
+}
+
+
+/* Misc
+ ------------ */
+img {
+	border: none;
+}
+
+.sep {
+	color: black;
+	background-color: #FFA34F;
+}
+
+table.colortable td {
+	padding: 0;
+}
+
+pre {
+	font-size: 1.1em;
+	font-family: Monaco, 'Courier New', monospace;
+}
+
+.nowrap {
+	white-space: nowrap;
+}
+
+.username-coloured {
+	font-weight: bold;
+}
diff -ruN phpBB-3.0.10/styles/spring/theme/theme.cfg phpbb/styles/spring/theme/theme.cfg
--- phpBB-3.0.10/styles/spring/theme/theme.cfg	1970-01-01 01:00:00.000000000 +0100
+++ phpbb/styles/spring/theme/theme.cfg	2014-04-15 14:31:18.757429004 +0200
@@ -0,0 +1,35 @@
+#
+# phpBB Theme Configuration File
+#
+# @package phpBB3
+# @copyright (c) 2005 phpBB Group
+# @license http://opensource.org/licenses/gpl-license.php GNU Public License
+#
+#
+# At the left is the name, please do not change this
+# At the right the value is entered
+# For on/off options the valid values are on, off, 1, 0, true and false
+#
+# Values get trimmed, if you want to add a space in front or at the end of
+# the value, then enclose the value with single or double quotes.
+# Single and double quotes do not need to be escaped.
+#
+# Available and used values:
+# parse_css_file
+#
+
+# General Information about this theme
+name = subsilver2spring
+copyright = &copy; phpBB Group, 2003
+version = 3.0.10
+
+# Some configuration options
+
+#
+# You have to turn this option on if you want to use the
+# path template variables ({T_IMAGESET_PATH} for example) within
+# your css file.
+# This is mostly the case if you want to use language specific
+# images within your css file.
+#
+parse_css_file = off
diff -ruN phpBB-3.0.10/styles/subsilver2/imageset/imageset.cfg phpbb/styles/subsilver2/imageset/imageset.cfg
--- phpBB-3.0.10/styles/subsilver2/imageset/imageset.cfg	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/subsilver2/imageset/imageset.cfg	2013-09-28 03:20:51.000000000 +0200
@@ -19,7 +19,7 @@
 # General Information about this style
 name = subsilver2
 copyright = &copy; phpBB Group, 2003
-version = 3.0.10
+version = 3.0.12
 
 # Images
 img_site_logo = site_logo.gif*94*170
diff -ruN phpBB-3.0.10/styles/subsilver2/style.cfg phpbb/styles/subsilver2/style.cfg
--- phpBB-3.0.10/styles/subsilver2/style.cfg	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/subsilver2/style.cfg	2013-09-28 03:20:51.000000000 +0200
@@ -19,4 +19,4 @@
 # General Information about this style
 name = subsilver2
 copyright = &copy; 2005 phpBB Group
-version = 3.0.10
+version = 3.0.12
diff -ruN phpBB-3.0.10/styles/subsilver2/template/captcha_default.html phpbb/styles/subsilver2/template/captcha_default.html
--- phpBB-3.0.10/styles/subsilver2/template/captcha_default.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/subsilver2/template/captcha_default.html	2013-09-28 03:20:51.000000000 +0200
@@ -12,6 +12,6 @@
 	</tr>
 	<tr>
 		<td class="row1"><b class="genmed">{L_CONFIRM_CODE}:</b><br /><span class="gensmall">{L_CONFIRM_CODE_EXPLAIN}</span></td>
-		<td class="row2"><input class="post" type="text" name="confirm_code" size="8" maxlength="8" />
+		<td class="row2"><input class="post" type="text" name="confirm_code" size="8" maxlength="8"<!-- IF $CAPTCHA_TAB_INDEX --> tabindex="{$CAPTCHA_TAB_INDEX}"<!-- ENDIF --> />
 		<!-- IF S_CONFIRM_REFRESH --><input type="submit" name="refresh_vc" id="refresh_vc" class="btnlite" value="{L_VC_REFRESH}" /><!-- ENDIF --></td>
 	</tr>
diff -ruN phpBB-3.0.10/styles/subsilver2/template/captcha_qa.html phpbb/styles/subsilver2/template/captcha_qa.html
--- phpBB-3.0.10/styles/subsilver2/template/captcha_qa.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/subsilver2/template/captcha_qa.html	2013-09-28 03:20:51.000000000 +0200
@@ -3,6 +3,6 @@
 	</tr>
 	<tr>
 		<td class="row1"><b class="genmed">{QA_CONFIRM_QUESTION}:</b><br /><span class="gensmall">{L_CONFIRM_QUESTION_EXPLAIN}</span></td>
-		<td class="row2"><input class="post" type="text" name="qa_answer" size="80" /></td>
+		<td class="row2"><input class="post" type="text" name="qa_answer" size="80"<!-- IF $CAPTCHA_TAB_INDEX --> tabindex="{$CAPTCHA_TAB_INDEX}"<!-- ENDIF --> />
 		<input type="hidden" name="qa_confirm_id" id="confirm_id" value="{QA_CONFIRM_ID}" /></td>
 	</tr>
diff -ruN phpBB-3.0.10/styles/subsilver2/template/editor.js phpbb/styles/subsilver2/template/editor.js
--- phpBB-3.0.10/styles/subsilver2/template/editor.js	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/subsilver2/template/editor.js	2013-09-28 03:20:51.000000000 +0200
@@ -221,7 +221,7 @@
 
 	// Get text selection - not only the post content :(
 	// IE9 must use the document.selection method but has the *.getSelection so we just force no IE
-	if (window.getSelection && !is_ie)
+	if (window.getSelection && !is_ie && !window.opera)
 	{
 		theSelection = window.getSelection().toString();
 	}
@@ -459,4 +459,4 @@
 	}
 
 	return caretPos;
-}
\ No newline at end of file
+}
diff -ruN phpBB-3.0.10/styles/subsilver2/template/faq_body.html phpbb/styles/subsilver2/template/faq_body.html
--- phpBB-3.0.10/styles/subsilver2/template/faq_body.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/subsilver2/template/faq_body.html	2013-09-28 03:20:51.000000000 +0200
@@ -13,7 +13,7 @@
 		<!-- BEGIN faq_block -->
 			<span class="gen"><b>{faq_block.BLOCK_TITLE}</b></span><br />
 			<!-- BEGIN faq_row -->
-				<span class="gen"><a class="postlink" href="#f{faq_block.S_ROW_COUNT}r{faq_block.faq_row.S_ROW_COUNT}">{faq_block.faq_row.FAQ_QUESTION}</a></span><br />
+				<span class="gen"><a href="#f{faq_block.S_ROW_COUNT}r{faq_block.faq_row.S_ROW_COUNT}">{faq_block.faq_row.FAQ_QUESTION}</a></span><br />
 			<!-- END faq_row -->
 			<br />
 		<!-- END faq_block -->
diff -ruN phpBB-3.0.10/styles/subsilver2/template/login_body.html phpbb/styles/subsilver2/template/login_body.html
--- phpBB-3.0.10/styles/subsilver2/template/login_body.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/subsilver2/template/login_body.html	2013-09-28 03:20:51.000000000 +0200
@@ -68,7 +68,7 @@
 <!-- IF CAPTCHA_TEMPLATE and S_CONFIRM_CODE -->
 </table>
 <table class="tablebg" width="100%" cellspacing="1">
-		
+	<!-- DEFINE $CAPTCHA_TAB_INDEX = 4 -->
 	<!-- INCLUDE {CAPTCHA_TEMPLATE} -->
 <!-- ENDIF -->
 
diff -ruN phpBB-3.0.10/styles/subsilver2/template/login_forum.html phpbb/styles/subsilver2/template/login_forum.html
--- phpBB-3.0.10/styles/subsilver2/template/login_forum.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/subsilver2/template/login_forum.html	2013-09-28 03:20:51.000000000 +0200
@@ -1,5 +1,13 @@
 <!-- INCLUDE overall_header.html -->
 
+<!-- IF FORUM_NAME -->
+	<div id="pageheader">
+		<h2><a class="titles" href="{U_VIEW_FORUM}">{FORUM_NAME}</a></h2>
+	</div>
+
+	<br clear="all" /><br />
+<!-- ENDIF -->
+
 <div id="pagecontent">
 
 	<form name="login_forum" method="post" action="{S_LOGIN_ACTION}">
diff -ruN phpBB-3.0.10/styles/subsilver2/template/mcp_topic.html phpbb/styles/subsilver2/template/mcp_topic.html
--- phpBB-3.0.10/styles/subsilver2/template/mcp_topic.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/subsilver2/template/mcp_topic.html	2013-09-28 03:20:51.000000000 +0200
@@ -135,6 +135,7 @@
 		<!-- IF S_CAN_DELETE --><option value="delete_post">{L_DELETE_POSTS}</option><!-- ENDIF -->
 		<!-- IF S_CAN_MERGE --><option value="merge_posts"<!-- IF ACTION eq 'merge' --> selected="selected"<!-- ENDIF -->>{L_MERGE_POSTS}</option><!-- ENDIF -->
 		<!-- IF S_CAN_SPLIT --><option value="split_all"<!-- IF ACTION eq 'split' --> selected="selected"<!-- ENDIF -->>{L_SPLIT_POSTS}</option><option value="split_beyond">{L_SPLIT_AFTER}</option><!-- ENDIF -->
+		<!-- IF S_CAN_SYNC --><option value="resync">{L_RESYNC}</option><!-- ENDIF -->
 	</select>&nbsp;<input class="btnmain" type="submit" name="mcp_topic_submit" value="{L_SUBMIT}" /></td>
 </tr>
 </table>
diff -ruN phpBB-3.0.10/styles/subsilver2/template/overall_footer.html phpbb/styles/subsilver2/template/overall_footer.html
--- phpBB-3.0.10/styles/subsilver2/template/overall_footer.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/subsilver2/template/overall_footer.html	2013-09-28 03:20:51.000000000 +0200
@@ -3,7 +3,7 @@
 
 <div id="wrapfooter">
 	<!-- IF U_ACP --><span class="gensmall">[ <a href="{U_ACP}">{L_ACP}</a> ]</span><br /><br /><!-- ENDIF -->
-	<span class="copyright">Powered by <a href="http://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Group
+	<span class="copyright">{CREDIT_LINE}
 	<!-- IF TRANSLATION_INFO --><br />{TRANSLATION_INFO}<!-- ENDIF -->
 	<!-- IF DEBUG_OUTPUT --><br /><bdo dir="ltr">[ {DEBUG_OUTPUT} ]</bdo><!-- ENDIF --></span>
 </div>
diff -ruN phpBB-3.0.10/styles/subsilver2/template/posting_body.html phpbb/styles/subsilver2/template/posting_body.html
--- phpBB-3.0.10/styles/subsilver2/template/posting_body.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/subsilver2/template/posting_body.html	2013-09-28 03:20:51.000000000 +0200
@@ -127,7 +127,7 @@
 		<td class="row2">
 			<table width="100%" cellspacing="0" cellpadding="0" border="0">
 			<tr>
-				<td><input type="radio" class="radio" name="icon" value="0"{S_NO_ICON_CHECKED} /><span class="genmed"><!-- IF S_SHOW_TOPIC_ICONS -->{L_NO_TOPIC_ICON}<!-- ELSE -->{L_NO_PM_ICON}<!-- ENDIF --></span> <!-- BEGIN topic_icon --><span style="white-space: nowrap;"><input type="radio" class="radio" name="icon" value="{topic_icon.ICON_ID}"{topic_icon.S_ICON_CHECKED} /><img src="{topic_icon.ICON_IMG}" width="{topic_icon.ICON_WIDTH}" height="{topic_icon.ICON_HEIGHT}" alt="" title="" hspace="2" vspace="2" /></span> <!-- END topic_icon --></td>
+				<td><input type="radio" class="radio" name="icon" value="0"{S_NO_ICON_CHECKED} tabindex="1" /><span class="genmed"><!-- IF S_SHOW_TOPIC_ICONS -->{L_NO_TOPIC_ICON}<!-- ELSE -->{L_NO_PM_ICON}<!-- ENDIF --></span> <!-- BEGIN topic_icon --><span style="white-space: nowrap;"><input type="radio" class="radio" name="icon" value="{topic_icon.ICON_ID}"{topic_icon.S_ICON_CHECKED} tabindex="1" /><img src="{topic_icon.ICON_IMG}" width="{topic_icon.ICON_WIDTH}" height="{topic_icon.ICON_HEIGHT}" alt="" title="" hspace="2" vspace="2" /></span> <!-- END topic_icon --></td>
 			</tr>
 			</table>
 		</td>
@@ -333,6 +333,7 @@
 <!-- ENDIF -->
 
 		<!-- IF CAPTCHA_TEMPLATE and S_CONFIRM_CODE -->
+		<!-- DEFINE $CAPTCHA_TAB_INDEX = 4 -->
 		<!-- INCLUDE {CAPTCHA_TEMPLATE} -->
 		<!-- ENDIF -->
 
diff -ruN phpBB-3.0.10/styles/subsilver2/template/posting_buttons.html phpbb/styles/subsilver2/template/posting_buttons.html
--- phpBB-3.0.10/styles/subsilver2/template/posting_buttons.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/subsilver2/template/posting_buttons.html	2013-09-28 03:20:51.000000000 +0200
@@ -16,6 +16,7 @@
 			q: '{LA_BBCODE_Q_HELP}',
 			c: '{LA_BBCODE_C_HELP}',
 			l: '{LA_BBCODE_L_HELP}',
+			e: '{LA_BBCODE_LISTITEM_HELP}',
 			o: '{LA_BBCODE_O_HELP}',
 			p: '{LA_BBCODE_P_HELP}',
 			w: '{LA_BBCODE_W_HELP}',
diff -ruN phpBB-3.0.10/styles/subsilver2/template/report_body.html phpbb/styles/subsilver2/template/report_body.html
--- phpBB-3.0.10/styles/subsilver2/template/report_body.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/subsilver2/template/report_body.html	2013-09-28 03:20:51.000000000 +0200
@@ -6,6 +6,11 @@
 <tr>
 	<th colspan="2"><!-- IF S_REPORT_POST -->{L_REPORT_POST}<!-- ELSE -->{L_REPORT_MESSAGE}<!-- ENDIF --></th>
 </tr>
+<!-- IF ERROR -->
+	<tr>
+		<td class="row3" colspan="2" align="center"><span class="genmed error">{ERROR}</span></td>
+	</tr>
+<!-- ENDIF -->
 <tr>
 	<td class="row3" colspan="2"><span class="gensmall"><!-- IF S_REPORT_POST -->{L_REPORT_POST_EXPLAIN}<!-- ELSE -->{L_REPORT_MESSAGE_EXPLAIN}<!-- ENDIF --></span></td>
 </tr>
@@ -25,6 +30,9 @@
 	<td class="row1" valign="top"><span class="gen"><b>{L_MORE_INFO}:</b></span><br /><span class="gensmall">{L_CAN_LEAVE_BLANK}</span></td>
 	<td class="row2"><textarea class="post" name="report_text" rows="10" cols="50">{REPORT_TEXT}</textarea></td>
 </tr>
+<!-- IF CAPTCHA_TEMPLATE -->
+			<!-- INCLUDE {CAPTCHA_TEMPLATE} -->
+<!-- ENDIF -->	
 <tr>
 	<td class="cat" colspan="2" align="center"><input type="submit" name="submit" class="btnmain" value="{L_SUBMIT}" />&nbsp;<input type="submit" name="cancel" class="btnlite" value="{L_CANCEL}" /></td>
 </tr>
diff -ruN phpBB-3.0.10/styles/subsilver2/template/simple_footer.html phpbb/styles/subsilver2/template/simple_footer.html
--- phpBB-3.0.10/styles/subsilver2/template/simple_footer.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/subsilver2/template/simple_footer.html	2013-09-28 03:20:51.000000000 +0200
@@ -2,7 +2,7 @@
 </div>
 
 <div id="wrapfooter">
-	<span class="copyright">Powered by <a href="http://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Group</span>
+	<span class="copyright">{CREDIT_LINE}</span>
 </div>
 
 </body>
diff -ruN phpBB-3.0.10/styles/subsilver2/template/template.cfg phpbb/styles/subsilver2/template/template.cfg
--- phpBB-3.0.10/styles/subsilver2/template/template.cfg	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/subsilver2/template/template.cfg	2013-09-28 03:20:51.000000000 +0200
@@ -19,5 +19,9 @@
 # General Information about this template
 name = subsilver2
 copyright = &copy; phpBB Group, 2003
-version = 3.0.10
+version = 3.0.12
 
+# Template inheritance
+# See http://blog.phpbb.com/2008/07/31/templating-just-got-easier/
+# Set value to empty to ignore template inheritance
+inherit_from = subsilver2
diff -ruN phpBB-3.0.10/styles/subsilver2/template/ucp_header.html phpbb/styles/subsilver2/template/ucp_header.html
--- phpBB-3.0.10/styles/subsilver2/template/ucp_header.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/subsilver2/template/ucp_header.html	2013-09-28 03:20:51.000000000 +0200
@@ -26,7 +26,7 @@
 			<td class="row1"><b class="genmed">{L_USERNAMES}:</b></td>
 		</tr>
 		<tr>
-			<td class="row2"><textarea name="username_list" rows="5" cols="22"></textarea><br />
+			<td class="row2"><textarea name="username_list" rows="5" cols="22" tabindex="1"></textarea><br />
 				[ <a href="{U_FIND_USERNAME}" onclick="find_username(this.href); return false;">{L_FIND_USERNAME}</a> ]
 			</td>
 		</tr>
@@ -41,7 +41,7 @@
 	<!-- ENDIF -->
 	<!-- IF S_ALLOW_MASS_PM -->
 		<tr>
-			<td class="row1"><div style="float: {S_CONTENT_FLOW_BEGIN};">&nbsp;<input class="post" type="submit" name="add_bcc" value="{L_ADD_BCC}" />&nbsp;</div><div style="float: {S_CONTENT_FLOW_END};">&nbsp;<input class="post" type="submit" name="add_to" value="{L_ADD_TO}" />&nbsp;</div></td>
+			<td class="row1"><div style="float: {S_CONTENT_FLOW_BEGIN};">&nbsp;<input class="post" type="submit" name="add_bcc" value="{L_ADD_BCC}" tabindex="1" />&nbsp;</div><div style="float: {S_CONTENT_FLOW_END};">&nbsp;<input class="post" type="submit" name="add_to" value="{L_ADD_TO}" tabindex="1" />&nbsp;</div></td>
 		</tr>
 	<!-- ENDIF -->
 	</table>
diff -ruN phpBB-3.0.10/styles/subsilver2/template/ucp_main_front.html phpbb/styles/subsilver2/template/ucp_main_front.html
--- phpBB-3.0.10/styles/subsilver2/template/ucp_main_front.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/subsilver2/template/ucp_main_front.html	2013-09-28 03:20:51.000000000 +0200
@@ -48,11 +48,11 @@
 		<!-- IF S_SHOW_ACTIVITY -->
 			<tr>
 				<td align="{S_CONTENT_FLOW_END}" valign="top" nowrap="nowrap"><b class="genmed">{L_ACTIVE_IN_FORUM}: </b></td>
-				<td><!-- IF ACTIVE_FORUM --><b><a class="gen" href="{U_ACTIVE_FORUM}">{ACTIVE_FORUM}</a></b><br /><span class="genmed">[ {ACTIVE_FORUM_POSTS} / {ACTIVE_FORUM_PCT} ]</span><!-- ELSE --><span class="gen">-</span><!-- ENDIF --></td>
+				<td><!-- IF ACTIVE_FORUM != '' --><b><a class="gen" href="{U_ACTIVE_FORUM}">{ACTIVE_FORUM}</a></b><br /><span class="genmed">[ {ACTIVE_FORUM_POSTS} / {ACTIVE_FORUM_PCT} ]</span><!-- ELSE --><span class="gen">-</span><!-- ENDIF --></td>
 			</tr>
 			<tr>
 				<td align="{S_CONTENT_FLOW_END}" valign="top" nowrap="nowrap"><b class="genmed">{L_ACTIVE_IN_TOPIC}: </b></td>
-				<td><!-- IF ACTIVE_TOPIC --><b><a class="gen" href="{U_ACTIVE_TOPIC}">{ACTIVE_TOPIC}</a></b><br /><span class="genmed">[ {ACTIVE_TOPIC_POSTS} / {ACTIVE_TOPIC_PCT} ]</span><!-- ELSE --><span class="gen">-</span><!-- ENDIF --></td>
+				<td><!-- IF ACTIVE_TOPIC != '' --><b><a class="gen" href="{U_ACTIVE_TOPIC}">{ACTIVE_TOPIC}</a></b><br /><span class="genmed">[ {ACTIVE_TOPIC_POSTS} / {ACTIVE_TOPIC_PCT} ]</span><!-- ELSE --><span class="gen">-</span><!-- ENDIF --></td>
 			</tr>
 		<!-- ENDIF -->
 		<!-- IF WARNINGS -->
diff -ruN phpBB-3.0.10/styles/subsilver2/template/ucp_pm_history.html phpbb/styles/subsilver2/template/ucp_pm_history.html
--- phpBB-3.0.10/styles/subsilver2/template/ucp_pm_history.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/subsilver2/template/ucp_pm_history.html	2013-09-28 03:20:51.000000000 +0200
@@ -37,7 +37,7 @@
 					<td valign="top">
 						<table width="100%" cellspacing="0" cellpadding="2">
 						<tr>
-							<td><div class="postbody">{history_row.MESSAGE}</div><div id="message_{history_row.MSG_ID}" style="display: none;">{history_row.DECODED_MESSAGE}</div></td>
+							<td><div class="postbody"><!-- IF history_row.MESSAGE -->{history_row.MESSAGE}<!-- ELSE --><span class="error">{L_MESSAGE_REMOVED_FROM_OUTBOX}</span><!-- ENDIF --></div><div id="message_{history_row.MSG_ID}" style="display: none;">{history_row.DECODED_MESSAGE}</div></td>
 						</tr>
 						</table>
 					</td>
diff -ruN phpBB-3.0.10/styles/subsilver2/template/ucp_pm_viewmessage_print.html phpbb/styles/subsilver2/template/ucp_pm_viewmessage_print.html
--- phpBB-3.0.10/styles/subsilver2/template/ucp_pm_viewmessage_print.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/subsilver2/template/ucp_pm_viewmessage_print.html	2013-09-28 03:20:51.000000000 +0200
@@ -114,7 +114,7 @@
 	<td align="{S_CONTENT_FLOW_END}"><span class="gensmall">{S_TIMEZONE}</span></td>
 </tr>
 <tr>
-	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
+	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />https://www.phpbb.com/</span></td>
 </tr>
 </table>
 
diff -ruN phpBB-3.0.10/styles/subsilver2/template/ucp_prefs_personal.html phpbb/styles/subsilver2/template/ucp_prefs_personal.html
--- phpBB-3.0.10/styles/subsilver2/template/ucp_prefs_personal.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/subsilver2/template/ucp_prefs_personal.html	2013-09-28 03:20:51.000000000 +0200
@@ -61,11 +61,13 @@
 	<td class="row1" width="50%"><b class="genmed">{L_POPUP_ON_PM}:</b></td>
 	<td class="row2"><input type="radio" class="radio" name="popuppm" value="1"<!-- IF S_POPUP_PM --> checked="checked"<!-- ENDIF --> /><span class="genmed">{L_YES}</span>&nbsp;&nbsp;<input type="radio" class="radio" name="popuppm" value="0"<!-- IF not S_POPUP_PM --> checked="checked"<!-- ENDIF --> /><span class="genmed">{L_NO}</span></td>
 </tr>
+<!-- IF S_MORE_LANGUAGES -->
 <tr>
 	<td class="row1" width="50%"><b class="genmed">{L_BOARD_LANGUAGE}:</b></td>
 	<td class="row2"><select name="lang">{S_LANG_OPTIONS}</select></td>
 </tr>
-<!-- IF S_STYLE_OPTIONS -->
+<!-- ENDIF -->
+<!-- IF S_STYLE_OPTIONS and S_MORE_STYLES -->
 <tr>
 	<td class="row1" width="50%"><b class="genmed">{L_BOARD_STYLE}:</b></td>
 	<td class="row2"><select name="style">{S_STYLE_OPTIONS}</select></td>
diff -ruN phpBB-3.0.10/styles/subsilver2/template/ucp_profile_reg_details.html phpbb/styles/subsilver2/template/ucp_profile_reg_details.html
--- phpBB-3.0.10/styles/subsilver2/template/ucp_profile_reg_details.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/subsilver2/template/ucp_profile_reg_details.html	2013-09-28 03:20:51.000000000 +0200
@@ -42,7 +42,7 @@
 	<th colspan="2">{L_CONFIRM_CHANGES}</th>
 </tr>
 <tr>
-	<td class="row1" width="35%"><b class="genmed">{L_CURRENT_PASSWORD}: </b><br /><span class="gensmall">{L_CURRENT_PASSWORD_EXPLAIN}</span></td>
+	<td class="row1" width="35%"><b class="genmed">{L_CURRENT_PASSWORD}: </b><br /><span class="gensmall"><!-- IF S_CHANGE_PASSWORD -->{L_CURRENT_CHANGE_PASSWORD_EXPLAIN}<!-- ELSE -->{L_CURRENT_PASSWORD_EXPLAIN}<!-- ENDIF --></span></td>
 	<td class="row2"><input type="password" class="post" name="cur_password" size="30" maxlength="255" value="{CUR_PASSWORD}" /></td>
 </tr>
 <tr>
diff -ruN phpBB-3.0.10/styles/subsilver2/template/viewforum_body.html phpbb/styles/subsilver2/template/viewforum_body.html
--- phpBB-3.0.10/styles/subsilver2/template/viewforum_body.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/subsilver2/template/viewforum_body.html	2013-09-28 03:20:51.000000000 +0200
@@ -155,7 +155,7 @@
 				<table width="100%" cellspacing="0">
 				<tr class="nav">
 					<td valign="middle">&nbsp;<!-- IF S_WATCH_FORUM_LINK and not S_IS_BOT --><a href="{S_WATCH_FORUM_LINK}">{S_WATCH_FORUM_TITLE}</a><!-- ENDIF --></td>
-					<td align="{S_CONTENT_FLOW_END}" valign="middle"><!-- IF not S_IS_BOT and U_MARK_TOPICS --><a href="{U_MARK_TOPICS}">{L_MARK_TOPICS_READ}</a><!-- ENDIF -->&nbsp;</td>
+					<td align="{S_CONTENT_FLOW_END}" valign="middle"><!-- IF not S_IS_BOT and U_MARK_TOPICS and .topicrow --><a href="{U_MARK_TOPICS}">{L_MARK_TOPICS_READ}</a><!-- ENDIF -->&nbsp;</td>
 				</tr>
 				</table>
 			</td>
diff -ruN phpBB-3.0.10/styles/subsilver2/template/viewtopic_print.html phpbb/styles/subsilver2/template/viewtopic_print.html
--- phpBB-3.0.10/styles/subsilver2/template/viewtopic_print.html	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/subsilver2/template/viewtopic_print.html	2013-09-28 03:20:51.000000000 +0200
@@ -128,7 +128,7 @@
 	<td align="{S_CONTENT_FLOW_END}"><span class="gensmall">{S_TIMEZONE}</span></td>
 </tr>
 <tr>
-	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
+	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />https://www.phpbb.com/</span></td>
 </tr>
 </table>
 
diff -ruN phpBB-3.0.10/styles/subsilver2/theme/stylesheet.css phpbb/styles/subsilver2/theme/stylesheet.css
--- phpBB-3.0.10/styles/subsilver2/theme/stylesheet.css	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/subsilver2/theme/stylesheet.css	2013-09-28 03:20:51.000000000 +0200
@@ -3,7 +3,7 @@
 	Style name:			subsilver2
 	Based on style:		subSilver (the default phpBB 2.0.x style)
 	Original author:	Tom Beddard ( http://www.subblue.com/ )
-	Modified by:		phpBB Group ( http://www.phpbb.com/ )
+	Modified by:		phpBB Group ( https://www.phpbb.com/ )
     --------------------------------------------------------------
 */
 
diff -ruN phpBB-3.0.10/styles/subsilver2/theme/theme.cfg phpbb/styles/subsilver2/theme/theme.cfg
--- phpBB-3.0.10/styles/subsilver2/theme/theme.cfg	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/styles/subsilver2/theme/theme.cfg	2013-09-28 03:20:51.000000000 +0200
@@ -21,7 +21,7 @@
 # General Information about this theme
 name = subsilver2
 copyright = &copy; phpBB Group, 2003
-version = 3.0.10
+version = 3.0.12
 
 # Some configuration options
 
diff -ruN phpBB-3.0.10/ucp.php phpbb/ucp.php
--- phpBB-3.0.10/ucp.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/ucp.php	2013-09-28 03:20:51.000000000 +0200
@@ -320,12 +320,6 @@
 	$module->set_display('main', 'subscribed', false);
 }
 
-// Do not display signature panel if not authed to do so
-if (!$auth->acl_get('u_sig'))
-{
-	$module->set_display('profile', 'signature', false);
-}
-
 // Select the active module
 $module->set_active($id, $mode);
 
diff -ruN phpBB-3.0.10/viewforum.php phpbb/viewforum.php
--- phpBB-3.0.10/viewforum.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/viewforum.php	2013-09-28 03:20:51.000000000 +0200
@@ -278,7 +278,7 @@
 	foreach ($_EXTRA_URL as $url_param)
 	{
 		$url_param = explode('=', $url_param, 2);
-		$s_hidden_fields[$url_param[0]] = $url_param[1];
+		$s_search_hidden_fields[$url_param[0]] = $url_param[1];
 	}
 }
 
diff -ruN phpBB-3.0.10/viewtopic.php phpbb/viewtopic.php
--- phpBB-3.0.10/viewtopic.php	2012-01-01 16:00:17.000000000 +0100
+++ phpbb/viewtopic.php	2013-09-28 03:20:51.000000000 +0200
@@ -146,7 +146,14 @@
 
 			if (!$row)
 			{
-				$user->setup('viewtopic');
+				$sql = 'SELECT forum_style
+					FROM ' . FORUMS_TABLE . "
+					WHERE forum_id = $forum_id";
+				$result = $db->sql_query($sql);
+				$forum_style = (int) $db->sql_fetchfield('forum_style');
+				$db->sql_freeresult($result);
+
+				$user->setup('viewtopic', $forum_style);
 				trigger_error(($view == 'next') ? 'NO_NEWER_TOPICS' : 'NO_OLDER_TOPICS');
 			}
 			else
@@ -607,7 +614,7 @@
 	foreach ($_EXTRA_URL as $url_param)
 	{
 		$url_param = explode('=', $url_param, 2);
-		$s_hidden_fields[$url_param[0]] = $url_param[1];
+		$s_search_hidden_fields[$url_param[0]] = $url_param[1];
 	}
 }
 
